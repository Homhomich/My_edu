WRMCB=function(e){var c=console;if(c&&c.log&&c.error){c.log('Error running batched script.');c.error(e);}}
;
try {
/* module-key = 'com.atlassian.confluence.plugins.drag-and-drop:plupload', location = 'js/plupload.js' */
(function(){function x(){this.returnValue=!1}function y(){this.cancelBubble=!0}var z=0,p=[],u={},v={},t={},w={"<":"lt",">":"gt","&":"amp",'"':"quot","'":"#39"},A=/[<>&\"\']/g,q=window.setTimeout,m={},h,j="application/msword,doc dot,application/pdf,pdf,application/pgp-signature,pgp,application/postscript,ps ai eps,application/rtf,rtf,application/vnd.ms-excel,xls xlb,application/vnd.ms-powerpoint,ppt pps pot,application/zip,zip,application/java-archive,jar,application/java-archive,war,application/java-archive,ear,application/x-shockwave-flash,swf swfl,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,xlsx,application/vnd.openxmlformats-officedocument.spreadsheetml.template,xltx,application/vnd.openxmlformats-officedocument.presentationml.presentation,pptx,application/vnd.openxmlformats-officedocument.presentationml.slideshow,ppsx,application/vnd.openxmlformats-officedocument.presentationml.template,potx,application/vnd.openxmlformats-officedocument.wordprocessingml.document,docx,application/vnd.openxmlformats-officedocument.wordprocessingml.template,dotx,audio/mpeg,mpga mpega mp2 mp3,audio/mp3,mp3,audio/x-wav,wav,audio/mp4,m4a,image/bmp,bmp,image/gif,gif,image/jpeg,jpeg jpg jpe,image/photoshop,psd,image/png,png,image/svg+xml,svg svgz,image/tiff,tiff tif,text/html,htm html xhtml,text/xml,xml,text/javascript,js,text/css,css,text/rtf,rtf,text/x-java-source,java,video/mpeg,mpeg mpg mpe,video/quicktime,qt mov,video/mp4,mp4,video/x-m4v,m4v,video/x-flv,flv,video/x-ms-wmv,wmv,video/avi,avi,video/webm,webm,video/vnd.rn-realvideo,rv,text/csv,csv,text/plain,asc txt text diff log,application/octet-stream,exe".split(/,/),
k,n,o;for(k=0;k<j.length;k+=2){o=j[k+1].split(/ /);for(n=0;n<o.length;n++){v[o[n]]=j[k];var r=t[j[k]]||[];r.push(o[n]);t[j[k]]=r}}j=navigator;k=j.userAgent;o=j.vendor;r=(n=/WebKit/.test(k))&&-1!==o.indexOf("Apple");o=window.opera&&window.opera.buildNumber;var j={windows:-1!==navigator.platform.indexOf("Win"),ie:!n&&!o&&/MSIE/gi.test(k)&&/Explorer/gi.test(j.appName),webkit:n,gecko:!n&&/Gecko/.test(k),safari:r,opera:!!o},c={VERSION:"@@version@@",STOPPED:1,STARTED:2,QUEUED:1,UPLOADING:2,FAILED:4,DONE:5,
GENERIC_ERROR:-100,HTTP_ERROR:-200,IO_ERROR:-300,SECURITY_ERROR:-400,INIT_ERROR:-500,FILE_SIZE_ERROR:-600,FILE_EXTENSION_ERROR:-601,IMAGE_FORMAT_ERROR:-700,IMAGE_MEMORY_ERROR:-701,IMAGE_DIMENSIONS_ERROR:-702,mimeTypes:v,mineTypeToExtensionsMap:t,ua:j,extend:function(a){c.each(arguments,function(b,g){0<g&&c.each(b,function(b,c){a[c]=b})});return a},getElement:function(a){return a&&1===a.nodeType?a:document.getElementById(a)},cleanName:function(a){var b,c;c=[/[\300-\306]/g,"A",/[\340-\346]/g,"a",/\307/g,
"C",/\347/g,"c",/[\310-\313]/g,"E",/[\350-\353]/g,"e",/[\314-\317]/g,"I",/[\354-\357]/g,"i",/\321/g,"N",/\361/g,"n",/[\322-\330]/g,"O",/[\362-\370]/g,"o",/[\331-\334]/g,"U",/[\371-\374]/g,"u"];for(b=0;b<c.length;b+=2)a=a.replace(c[b],c[b+1]);a=a.replace(/\s+/g,"_");return a=a.replace(/[^a-z0-9_\-\.]+/gi,"")},addRuntime:function(a,b){b.name=a;p[a]=b;p.push(b);return b},guid:function(){var a=(new Date).getTime().toString(32),b;for(b=0;5>b;b++)a+=Math.floor(65535*Math.random()).toString(32);return(c.guidPrefix||
"p")+a+(z++).toString(32)},buildUrl:function(a,b){var g="";c.each(b,function(a,b){g+=(g?"&":"")+encodeURIComponent(b)+"="+encodeURIComponent(a)});g&&(a+=(0<a.indexOf("?")?"&":"?")+g);return a},each:function(a,b){var c,f;if(a)if(c=a.length,void 0===c)for(f in a){if(a.hasOwnProperty(f)&&!1===b(a[f],f))break}else for(f=0;f<c&&!1!==b(a[f],f);f++);},formatSize:function(a){return void 0===a||/\D/.test(a)?c.translate("N/A"):1073741824<a?Math.round(a/1073741824,1)+" GB":1048576<a?Math.round(a/1048576,1)+
" MB":1024<a?Math.round(a/1024,1)+" KB":a+" b"},getPos:function(a,b){function c(a){var b,e=0;b=0;a&&(b=a.getBoundingClientRect(),a="CSS1Compat"===h.compatMode?h.documentElement:h.body,e=b.left+a.scrollLeft,b=b.top+a.scrollTop);return{x:e,y:b}}var f=0,d=0,e,h=document,b=b||h.body;if(a&&a.getBoundingClientRect&&0<navigator.userAgent.indexOf("MSIE")&&8!==h.documentMode)return f=c(a),d=c(b),{x:f.x-d.x,y:f.y-d.y};for(e=a;e&&e!=b&&e.nodeType;)f+=e.offsetLeft||0,d+=e.offsetTop||0,e=e.offsetParent;for(e=
a.parentNode;e&&e!=b&&e.nodeType;)f-=e.scrollLeft||0,d-=e.scrollTop||0,e=e.parentNode;return{x:f,y:d}},getSize:function(a){return{w:a.offsetWidth||a.clientWidth,h:a.offsetHeight||a.clientHeight}},parseSize:function(a){var b;"string"==typeof a&&(a=/^([0-9]+)([mgk]?)$/.exec(a.toLowerCase().replace(/[^0-9mkg]/g,"")),b=a[2],a=+a[1],"g"==b&&(a*=1073741824),"m"==b&&(a*=1048576),"k"==b&&(a*=1024));return a},xmlEncode:function(a){return a?(""+a).replace(A,function(a){return w[a]?"&"+w[a]+";":a}):a},toArray:function(a){var b,
c=[];for(b=0;b<a.length;b++)c[b]=a[b];return c},addI18n:function(a){return c.extend(u,a)},translate:function(a){return u[a]||a},isEmptyObj:function(a){if(void 0===a)return!0;for(var b in a)return!1;return!0},hasClass:function(a,b){return""==a.className?!1:RegExp("(^|\\s+)"+b+"(\\s+|$)").test(a.className)},addClass:function(a,b){c.hasClass(a,b)||(a.className=""==a.className?b:a.className.replace(/\s+$/,"")+" "+b)},removeClass:function(a,b){a.className=a.className.replace(RegExp("(^|\\s+)"+b+"(\\s+|$)"),
function(a,b,c){return" "===b&&" "===c?" ":""})},getStyle:function(a,b){if(a.currentStyle)return a.currentStyle[b];if(window.getComputedStyle)return window.getComputedStyle(a,null)[b]},addEvent:function(a,b,g,f){var d,b=b.toLowerCase();void 0===h&&(h="Plupload_"+c.guid());a.addEventListener?(d=g,a.addEventListener(b,d,!1)):a.attachEvent&&(d=function(){var a=window.event;a.target||(a.target=a.srcElement);a.preventDefault=x;a.stopPropagation=y;g(a)},a.attachEvent("on"+b,d));void 0===a[h]&&(a[h]=c.guid());
m.hasOwnProperty(a[h])||(m[a[h]]={});a=m[a[h]];a.hasOwnProperty(b)||(a[b]=[]);a[b].push({func:d,orig:g,key:f})},removeEvent:function(a,b,g){var f,d;"function"==typeof g?f=g:d=g;b=b.toLowerCase();if(a[h]&&m[a[h]]&&m[a[h]][b]){for(var g=m[a[h]][b],e=g.length-1;0<=e;e--)if(g[e].key===d||g[e].orig===f)if(a.detachEvent?a.detachEvent("on"+b,g[e].func):a.removeEventListener&&a.removeEventListener(b,g[e].func,!1),g[e].orig=null,g[e].func=null,g.splice(e,1),void 0!==f)break;g.length||delete m[a[h]][b];if(c.isEmptyObj(m[a[h]])){delete m[a[h]];
try{delete a[h]}catch(k){a[h]=void 0}}}},removeAllEvents:function(a,b){void 0!==a[h]&&a[h]&&c.each(m[a[h]],function(g,f){c.removeEvent(a,f,b)})},Uploader:function(a){function b(){var a,b=0,d;if(this.state==c.STARTED){for(d=0;d<e.length;d++)!a&&e[d].status==c.QUEUED?(a=e[d],a.status=c.UPLOADING,this.trigger("BeforeUpload",a)&&this.trigger("UploadFile",a)):b++;b==e.length&&(this.stop(),this.trigger("UploadComplete",e))}}function g(){var a,b;d.reset();for(a=0;a<e.length;a++)b=e[a],void 0!==b.size?(d.size+=
b.size,d.loaded+=b.loaded):d.size=void 0,b.status==c.DONE?d.uploaded++:b.status==c.FAILED?d.failed++:d.queued++;void 0===d.size?d.percent=0<e.length?Math.ceil(100*(d.uploaded/e.length)):0:(d.bytesPerSec=Math.ceil(d.loaded/((+new Date-h||1)/1E3)),d.percent=0<d.size?Math.ceil(100*(d.loaded/d.size)):0)}var f={},d,e=[],h;d=new c.QueueProgress;a=c.extend({chunk_size:0,multipart:!0,multi_selection:!0,file_data_name:"file",filters:[]},a);c.extend(this,{state:c.STOPPED,runtime:"",features:{},files:e,settings:a,
total:d,id:c.guid(),init:function(){function f(){var a=s[k++],b,e,d;if(a){b=a.getFeatures();if(e=i.settings.required_features){e=e.split(",");for(d=0;d<e.length;d++)if(!b[e[d]]){f();return}}a.init(i,function(c){c&&c.success?(i.features=b,i.runtime=a.name,i.trigger("Init",{runtime:a.name}),i.trigger("PostInit"),i.refresh()):f()})}else i.trigger("Error",{code:c.INIT_ERROR,message:c.translate("Init error.")})}var i=this,l,s,k=0,j;"function"==typeof a.preinit?a.preinit(i):c.each(a.preinit,function(a,
b){i.bind(b,a)});a.page_url=a.page_url||document.location.pathname.replace(/\/[^\/]+$/g,"/");/^(\w+:\/\/|\/)/.test(a.url)||(a.url=a.page_url+a.url);a.chunk_size=c.parseSize(a.chunk_size);a.max_file_size=c.parseSize(a.max_file_size);i.bind("FilesAdded",function(b,d){b.trigger("Started",d);var f,g,l=0,h;if((f=a.filters)&&f.length){h=[];c.each(f,function(a){c.each(a.extensions.split(/,/),function(a){/^\s*\*\s*$/.test(a)?h.push("\\.*"):h.push("\\."+a.replace(RegExp("["+"/^$.*+?|()[]{}\\".replace(/./g,
"\\$&")+"]","g"),"\\$&"))})});h=RegExp(h.join("|")+"$","i")}for(f=0;f<d.length;f++){g=d[f];g.loaded=0;g.percent=0;g.status=c.QUEUED;if(h&&!h.test(g.name))b.trigger("Error",{code:c.FILE_EXTENSION_ERROR,message:c.translate("File extension error."),file:g});else if(g.size!==void 0&&g.size>a.max_file_size)b.trigger("Error",{code:c.FILE_SIZE_ERROR,message:c.translate("File size error."),file:g});else{e.push(g);l++}}if(l)q(function(){i.trigger("QueueChanged");i.refresh()},1);else return false});a.unique_names&&
i.bind("UploadFile",function(a,b){var c=b.name.match(/\.([^.]+)$/),d="tmp";c&&(d=c[1]);b.target_name=b.id+"."+d});i.bind("UploadProgress",function(a,b){b.percent=b.size>0?Math.ceil(b.loaded/b.size*100):100;g()});i.bind("StateChanged",function(a){if(a.state==c.STARTED)h=+new Date;else if(a.state==c.STOPPED)for(l=a.files.length-1;l>=0;l--)if(a.files[l].status==c.UPLOADING){a.files[l].status=c.QUEUED;g()}});i.bind("QueueChanged",g);i.bind("Error",function(a,e){if(e.file){e.file.status=c.FAILED;g();a.state==
c.STARTED&&(d.queued||q(function(){b.call(i)},1))}});i.bind("FileUploaded",function(a,d){d.status=c.DONE;d.loaded=d.size;a.trigger("UploadProgress",d);q(function(){b.call(i)},1)});if(a.runtimes){s=[];j=a.runtimes.split(/\s?,\s?/);for(l=0;l<j.length;l++)p[j[l]]&&s.push(p[j[l]])}else s=p;f();"function"==typeof a.init?a.init(i):c.each(a.init,function(a,b){i.bind(b,a)})},refresh:function(){this.trigger("Refresh")},start:function(){this.state!=c.STARTED&&(this.state=c.STARTED,this.trigger("StateChanged"),
b.call(this))},stop:function(){this.state!=c.STOPPED&&(this.state=c.STOPPED,this.trigger("CancelUpload"),this.trigger("StateChanged"))},getFile:function(a){var b;for(b=e.length-1;0<=b;b--)if(e[b].id===a)return e[b]},removeFile:function(a){var b;for(b=e.length-1;0<=b;b--)if(e[b].id===a.id)return this.splice(b,1)[0]},splice:function(a,b){var f;f=e.splice(void 0===a?0:a,void 0===b?e.length:b);this.trigger("FilesRemoved",f);this.trigger("QueueChanged");f[0].status==c.UPLOADING&&this.state==c.STARTED&&
this.trigger("CancelUpload");if(!d.queued){var g=this;q(function(){g.trigger("UploadComplete")})}return f},trigger:function(a){var b=f[a.toLowerCase()],c,d;if(b){d=Array.prototype.slice.call(arguments);d[0]=this;for(c=0;c<b.length;c++)if(!1===b[c].func.apply(b[c].scope,d))return!1}return!0},hasEventListener:function(a){return!!f[a.toLowerCase()]},bind:function(a,b,c){var d,a=a.toLowerCase();d=f[a]||[];d.push({func:b,scope:c||this});f[a]=d},unbind:function(a,b){var a=a.toLowerCase(),c=f[a],d;if(c){if(void 0!==
b)for(d=c.length-1;0<=d;d--){if(c[d].func===b){c.splice(d,1);break}}else c=[];c.length||delete f[a]}},unbindAll:function(){var a=this;c.each(f,function(b,c){a.unbind(c)})},destroy:function(){this.trigger("Destroy");this.unbindAll()}})},File:function(a,b,c){this.id=a;this.name=b;this.size=c;this.status=this.percent=this.loaded=0},Runtime:function(){this.getFeatures=function(){};this.init=function(){}},QueueProgress:function(){var a=this;a.size=0;a.loaded=0;a.uploaded=0;a.failed=0;a.queued=0;a.percent=
0;a.bytesPerSec=0;a.reset=function(){a.size=a.loaded=a.uploaded=a.failed=a.queued=a.percent=a.bytesPerSec=0}},runtimes:{}};window.plupload=c})();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.drag-and-drop:plupload', location = 'js/plupload.html5.js' */
(function(s,j,f,p){function G(f,e,k,g){var b,a,d,q,m=this;var c=y[f.id],r=function(c){b=j.createElement("canvas");b.style.display="none";j.body.appendChild(b);a=b.getContext("2d");d=new Image;d.onerror=d.onabort=function(){g({success:!1})};d.onload=function(){var r,t,j,o;e.width||(e.width=d.width);e.height||(e.height=d.height);q=Math.min(e.width/d.width,e.height/d.height);if(1>q||1===q&&"image/jpeg"===k){r=Math.round(d.width*q);t=Math.round(d.height*q);b.width=r;b.height=t;a.drawImage(d,0,0,r,t);
if("image/jpeg"===k){if(j=new w(atob(c.substring(c.indexOf("base64,")+7))),j.headers&&j.headers.length&&(o=new H,o.init(j.get("exif")[0])&&(o.setExif("PixelXDimension",r),o.setExif("PixelYDimension",t),j.set("exif",o.getBinary()),m.hasEventListener("ExifData")&&m.trigger("ExifData",f,o.EXIF()),m.hasEventListener("GpsData")&&m.trigger("GpsData",f,o.GPS()))),e.quality)try{c=b.toDataURL(k,e.quality/100)}catch(s){c=b.toDataURL(k)}}else c=b.toDataURL(k);c=c.substring(c.indexOf("base64,")+7);c=atob(c);
j&&(j.headers&&j.headers.length)&&(c=j.restore(c),j.purge());b.parentNode.removeChild(b);g({success:!0,data:c})}else g({success:!1})};d.src=c},t;"FileReader"in s?(t=new FileReader,t.readAsDataURL(c),t.onload=function(){r(t.result)}):r(c.getAsDataURL())}function C(){function f(b,a){var d=k?0:-8*(a-1),q=0,m;for(m=0;m<a;m++)q|=g.charCodeAt(b+m)<<Math.abs(d+8*m);return q}function e(b,a,d){d=3===arguments.length?d:g.length-a-1;g=g.substr(0,a)+b+g.substr(d+a)}var k=!1,g;return{II:function(b){if(b===p)return k;
k=b},init:function(b){k=!1;g=b},SEGMENT:function(b,a,d){switch(arguments.length){case 1:return g.substr(b,g.length-b-1);case 2:return g.substr(b,a);case 3:e(d,b,a);break;default:return g}},BYTE:function(b){return f(b,1)},SHORT:function(b){return f(b,2)},LONG:function(b,a){if(a===p)return f(b,4);var d="",q=k?0:-24,m;for(m=0;4>m;m++)d+=String.fromCharCode(a>>Math.abs(q+8*m)&255);e(d,b,4)},SLONG:function(b){b=f(b,4);return 2147483647<b?b-4294967296:b},STRING:function(b,a){for(var d="",a=a+b;b<a;b++)d+=
String.fromCharCode(f(b,1));return d}}}function w(f){var e={65505:{app:"EXIF",name:"APP1",signature:"Exif\x00"},65506:{app:"ICC",name:"APP2",signature:"ICC_PROFILE\x00"},65517:{app:"IPTC",name:"APP13",signature:"Photoshop 3.0\x00"}},k=[],g,b,a=p,d=0;g=new C;g.init(f);if(65496===g.SHORT(0)){b=2;for(f=Math.min(1048576,f.length);b<=f;)if(a=g.SHORT(b),65488<=a&&65495>=a)b+=2;else{if(65498===a||65497===a)break;d=g.SHORT(b+2)+2;e[a]&&g.STRING(b+4,e[a].signature.length)===e[a].signature&&k.push({hex:a,app:e[a].app.toUpperCase(),
name:e[a].name.toUpperCase(),start:b,length:d,segment:g.SEGMENT(b,d)});b+=d}g.init(null);return{headers:k,restore:function(a){g.init(a);var d=new w(a);if(!d.headers)return!1;for(a=d.headers.length;0<a;a--){var c=d.headers[a-1];g.SEGMENT(c.start,c.length,"")}d.purge();b=65504==g.SHORT(2)?4+g.SHORT(4):2;a=0;for(d=k.length;a<d;a++)g.SEGMENT(b,0,k[a].segment),b+=k[a].length;return g.SEGMENT()},get:function(a){for(var d=[],c=0,b=k.length;c<b;c++)k[c].app===a.toUpperCase()&&d.push(k[c].segment);return d},
set:function(a,d){var c=[];"string"===typeof d?c.push(d):c=d;for(var b=ii=0,f=k.length;b<f&&!(k[b].app===a.toUpperCase()&&(k[b].segment=c[ii],k[b].length=c[ii].length,ii++),ii>=c.length);b++);},purge:function(){k=[];g.init(null)}}}}function H(){function f(a,d){var q=e.SHORT(a),m,c,k,h,l,j=[],n={};for(m=0;m<q;m++)if(l=a+12*m+2,k=d[e.SHORT(l)],k!==p){c=e.SHORT(l+=2);h=e.LONG(l+=2);l+=4;j=[];switch(c){case 1:case 7:4<h&&(l=e.LONG(l)+g.tiffHeader);for(c=0;c<h;c++)j[c]=e.BYTE(l+c);break;case 2:4<h&&(l=
e.LONG(l)+g.tiffHeader);n[k]=e.STRING(l,h-1);continue;case 3:2<h&&(l=e.LONG(l)+g.tiffHeader);for(c=0;c<h;c++)j[c]=e.SHORT(l+2*c);break;case 4:1<h&&(l=e.LONG(l)+g.tiffHeader);for(c=0;c<h;c++)j[c]=e.LONG(l+4*c);break;case 5:l=e.LONG(l)+g.tiffHeader;for(c=0;c<h;c++)j[c]=e.LONG(l+4*c)/e.LONG(l+4*c+4);break;case 9:l=e.LONG(l)+g.tiffHeader;for(c=0;c<h;c++)j[c]=e.SLONG(l+4*c);break;case 10:l=e.LONG(l)+g.tiffHeader;for(c=0;c<h;c++)j[c]=e.SLONG(l+4*c)/e.SLONG(l+4*c+4);break;default:continue}h=1==h?j[0]:j;
n[k]=b.hasOwnProperty(k)&&"object"!=typeof h?b[k][h]:h}return n}var e,k,g={},b;e=new C;k={tiff:{274:"Orientation",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer"},exif:{36864:"ExifVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",36867:"DateTimeOriginal",33434:"ExposureTime",33437:"FNumber",34855:"ISOSpeedRatings",37377:"ShutterSpeedValue",37378:"ApertureValue",37383:"MeteringMode",37384:"LightSource",37385:"Flash",41986:"ExposureMode",41987:"WhiteBalance",41990:"SceneCaptureType",
41988:"DigitalZoomRatio",41992:"Contrast",41993:"Saturation",41994:"Sharpness"},gps:{"0":"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude"}};b={ColorSpace:{1:"sRGB","0":"Uncalibrated"},MeteringMode:{"0":"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{1:"Daylight",2:"Fliorescent",3:"Tungsten",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",
13:"Day white fluorescent (N 4600 -5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{"0":"Flash did not fire.",1:"Flash fired.",5:"Strobe return light not detected.",7:"Strobe return light detected.",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",
16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",
79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},ExposureMode:{"0":"Auto exposure",1:"Manual exposure",2:"Auto bracket"},WhiteBalance:{"0":"Auto white balance",1:"Manual white balance"},SceneCaptureType:{"0":"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},
Contrast:{"0":"Normal",1:"Soft",2:"Hard"},Saturation:{"0":"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{"0":"Normal",1:"Soft",2:"Hard"},GPSLatitudeRef:{N:"North latitude",S:"South latitude"},GPSLongitudeRef:{E:"East longitude",W:"West longitude"}};return{init:function(a){g={tiffHeader:10};if(a===p||!a.length)return!1;e.init(a);return 65505===e.SHORT(0)&&"EXIF\x00"===e.STRING(4,5).toUpperCase()?(a=p,a=g.tiffHeader,e.II(18761==e.SHORT(a)),42!==e.SHORT(a+=2)?a=!1:(g.IFD0=g.tiffHeader+e.LONG(a+
2),a=f(g.IFD0,k.tiff),g.exifIFD="ExifIFDPointer"in a?g.tiffHeader+a.ExifIFDPointer:p,g.gpsIFD="GPSInfoIFDPointer"in a?g.tiffHeader+a.GPSInfoIFDPointer:p,a=!0),a):!1},EXIF:function(){var a;a=f(g.exifIFD,k.exif);a.ExifVersion&&(a.ExifVersion=String.fromCharCode(a.ExifVersion[0],a.ExifVersion[1],a.ExifVersion[2],a.ExifVersion[3]));return a},GPS:function(){var a;a=f(g.gpsIFD,k.gps);a.GPSVersionID&&(a.GPSVersionID=a.GPSVersionID.join("."));return a},setExif:function(a,d){if("PixelXDimension"!==a&&"PixelYDimension"!==
a)return!1;var b;b=a;var f,c,h,j=0;if("string"===typeof b)for(hex in f=k.exif,f)if(f[hex]===b){b=hex;break}f=g.exifIFD;c=e.SHORT(f);for(i=0;i<c;i++)if(h=f+12*i+2,e.SHORT(h)==b){j=h+8;break}j?(e.LONG(j,d),b=!0):b=!1;return b},getBinary:function(){return e.SEGMENT()}}}var y={},F;f.runtimes.Html5=f.addRuntime("html5",{getFeatures:function(){var h,e,k,g,b,a;e=k=b=a=!1;s.XMLHttpRequest&&(h=new XMLHttpRequest,k=!!h.upload,e=!(!h.sendAsBinary&&!h.upload));e&&(g=!!(h.sendAsBinary||s.Uint8Array&&s.ArrayBuffer),
b=!(!File||!File.prototype.getAsDataURL&&!s.FileReader||!g),a=!(!File||!File.prototype.mozSlice&&!File.prototype.webkitSlice&&!File.prototype.slice));F=f.ua.safari&&f.ua.windows&&navigator.userAgent&&0<navigator.userAgent.indexOf("Version/4");h=e;e=j.createElement("div");return{html5:h,dragdrop:"draggable"in e||"ondragstart"in e&&"ondrop"in e,jpgresize:b,pngresize:b,multipart:b||!!s.FileReader||!!s.FormData,canSendBinary:g,cantSendBlobInFormData:!(!f.ua.gecko||!s.FormData||!s.FileReader||FileReader.prototype.readAsArrayBuffer),
progress:k,chunks:a,multi_selection:!(f.ua.safari&&f.ua.windows),triggerDialog:f.ua.gecko&&s.FormData||f.ua.webkit||f.ua.windows}},init:function(h,e){function k(a){var d,b,g=[],c,e={};for(b=0;b<a.length;b++)d=a[b],e[d.name]||(e[d.name]=!0,c=f.guid(),y[c]=d,c=new f.File(c,d.fileName||d.name,d.fileSize||d.size),c.nativeFile=d,g.push(c));g.length&&h.trigger("FilesAdded",g)}var g,b;g=this.getFeatures();g.html5?(h.upload=function(a){k(a)},h.bind("Init",function(a){var d,b,g=[],c,e,t=a.settings.filters,
l,s;c=j.body;var n;d=j.createElement("div");d.id=a.id+"_html5_container";f.extend(d.style,{position:"absolute",background:h.settings.shim_bgcolor||"transparent",width:"100px",height:"100px",overflow:"hidden",zIndex:99999,opacity:h.settings.shim_bgcolor?"":0});d.className="plupload html5";h.settings.container&&(c=j.getElementById(h.settings.container),"static"===f.getStyle(c,"position")&&(c.style.position="relative"));c.appendChild(d);c=0;a:for(;c<t.length;c++){l=t[c].extensions.split(/,/);for(e=0;e<
l.length;e++){if("*"===l[e]){g=[];break a}(s=f.mimeTypes[l[e]])&&g.push(s)}}d.innerHTML='<input id="'+h.id+'_html5"  style="font-size:999px" type="file" accept="'+g.join(",")+'" '+(h.settings.multi_selection&&h.features.multi_selection?'multiple="multiple"':"")+" />";d.scrollTop=100;n=j.getElementById(h.id+"_html5");h.settings.inputFileClazz&&(n.className+=" "+h.settings.inputFileClazz);a.features.triggerDialog?f.extend(n.style,{position:"absolute",width:"100%",height:"100%"}):f.extend(n.style,{cssFloat:"right",
styleFloat:"right"});var p=function(){k(this.files);if(navigator.appVersion.indexOf("MSIE10")===-1){n=this.cloneNode(true);n.onchange=p;this.parentNode.replaceChild(n,this)}else this.value=""};n.onchange=p;if(b="string"===typeof a.settings.browse_button?j.getElementById(a.settings.browse_button):a.settings.browse_button){var o=a.settings.browse_button_hover,B=a.settings.browse_button_active;d=a.features.triggerDialog?b:d;o&&(f.addEvent(d,"mouseover",function(){f.addClass(b,o)},a.id),f.addEvent(d,
"mouseout",function(){f.removeClass(b,o)},a.id));B&&(f.addEvent(d,"mousedown",function(){f.addClass(b,B)},a.id),f.addEvent(j.body,"mouseup",function(){f.removeClass(b,B)},a.id));a.features.triggerDialog&&f.addEvent(b,"click",function(b){j.getElementById(a.id+"_html5").click();b.preventDefault()},a.id)}}),h.bind("PostInit",function(){var a=f.getElement(h.settings.drop_element),b,e=!1;a&&(F?(f.addEvent(a,"dragenter",function(){var b,d;b=j.getElementById(h.id+"_drop");b||(b=j.createElement("input"),
b.setAttribute("type","file"),b.setAttribute("id",h.id+"_drop"),b.setAttribute("multiple","multiple"),f.addEvent(b,"change",function(){k(this.files);f.removeEvent(b,"change",h.id);b.parentNode.removeChild(b)},h.id),a.appendChild(b),e=!0);f.getPos(a,j.getElementById(h.settings.container));d=f.getSize(a);"static"===f.getStyle(a,"position")&&f.extend(a.style,{position:"relative"});f.extend(b.style,{position:"absolute",display:"block",top:0,left:0,width:d.w+"px",height:d.h+"px",opacity:0})},h.id),f.addEvent(a,
"dragleave",function(){e||(b&&b.parentElement.removeChild(b),b=null);e=!1})):(f.addEvent(a,"dragover",function(a){a.preventDefault()},h.id),f.addEvent(a,"drop",function(a){if(!$(".disable-attachment-uploader").length){var c=a.dataTransfer;c&&c.files&&k(c.files)}b&&b.parentElement.removeChild(b);b=null;a.preventDefault();h.settings.stop_propagation&&(a.cancelBubble?a.cancelBubble=!0:a.stopPropagation())},h.id)))}),h.bind("Refresh",function(a){var b,e,g;if(b=j.getElementById(h.settings.browse_button))e=
f.getPos(b,j.getElementById(a.settings.container)),g=f.getSize(b),a=j.getElementById(h.id+"_html5_container"),f.extend(a.style,{top:e.y+"px",left:e.x+"px",width:g.w+"px",height:g.h+"px"}),h.features.triggerDialog&&("static"===f.getStyle(b,"position")&&f.extend(b.style,{position:"relative"}),e=parseInt(f.getStyle(b,"z-index"),10),isNaN(e)&&(e=0),f.extend(b.style,{zIndex:e}),f.extend(a.style,{zIndex:e-1}))}),h.bind("CancelUpload",function(){b&&b.abort&&b.abort()}),h.bind("UploadFile",function(a,d){function e(c){function k(){function e(c){var h=
0,m="----pluploadboundary"+f.guid(),n,r="";b=new XMLHttpRequest;b.upload&&(b.upload.onprogress=function(b){d.loaded=Math.min(d.size,q+b.loaded-h);a.trigger("UploadProgress",d)});b.onreadystatechange=function(){var e,g;if(b.readyState==4){try{e=b.status}catch(h){e=0}if(e>=400)a.trigger("Error",{code:f.HTTP_ERROR,message:f.translate("HTTP Error."),file:d,status:e,xhr:b,response:b.responseText||""});else{if(p){g={chunk:j,chunks:p,response:b.responseText,status:e};a.trigger("ChunkUploaded",d,g);q=q+z;
if(g.cancelled){d.status=f.FAILED;return}d.loaded=Math.min(d.size,(j+1)*u)}else d.loaded=d.size;a.trigger("UploadProgress",d);c=o=n=r=null;if(!p||++j>=p){d.status=f.DONE;a.trigger("FileUploaded",d,{response:b.responseText,status:e})}else k()}}};if(a.settings.multipart&&g.multipart){x.name=d.target_name||d.name;b.open("post",D,!0);f.each(a.settings.headers,function(a,c){b.setRequestHeader(c,a)});if("string"!==typeof c&&s.FormData){n=new FormData;f.each(f.extend(x,a.settings.multipart_params),function(a,
b){n.append(b,a)});n.append(a.settings.file_data_name,c);b.send(n);return}if("string"===typeof c){b.setRequestHeader("Content-Type","multipart/form-data; boundary="+m);f.each(f.extend(x,a.settings.multipart_params),function(a,b){r=r+("--"+m+'\r\nContent-Disposition: form-data; name="'+b+'"\r\n\r\n');r=r+(unescape(encodeURIComponent(a))+"\r\n")});y=f.mimeTypes[d.name.replace(/^.+\.([^.]+)/,"$1").toLowerCase()]||"application/octet-stream";r+="--"+m+'\r\nContent-Disposition: form-data; name="'+a.settings.file_data_name+
'"; filename="'+unescape(encodeURIComponent(d.name))+'"\r\nContent-Type: '+y+"\r\n\r\n"+c+"\r\n--"+m+"--\r\n";h=r.length-c.length;c=r;if(b.sendAsBinary)b.sendAsBinary(c);else if(g.canSendBinary){for(var w=new Uint8Array(c.length),v=0;v<c.length;v++)w[v]=c.charCodeAt(v)&255;b.send(w.buffer)}return}}D=f.buildUrl(a.settings.url,f.extend(x,a.settings.multipart_params));b.open("post",D,!0);b.setRequestHeader("Content-Type","application/octet-stream");c.encoding&&b.setRequestHeader("Content-Encoding",c.encoding);
f.each(a.settings.headers,function(a,c){b.setRequestHeader(c,a)});b.send(c.getData?c.getData():c)}var o,p,x,u,z,y,D=a.settings.url;if(!(d.status==f.DONE||d.status==f.FAILED||a.state==f.STOPPED)){x={name:d.target_name||d.name};if(h.chunk_size&&d.size>h.chunk_size&&(g.chunks||"string"==typeof c)){u=h.chunk_size;p=Math.ceil(d.size/u);z=Math.min(u,d.size-j*u);if("string"==typeof c)o=c.substring(j*u,j*u+z);else{var v=c,A=j*u,E=j*u+z,w;if(File.prototype.slice)try{v.slice(),o=v.slice(A,E)}catch(C){o=v.slice(A,
E-A)}else o=(w=File.prototype.webkitSlice||File.prototype.mozSlice)?w.call(v,A,E):null}x.chunk=j;x.chunks=p}else z=d.size,o=c;"string"!==typeof o&&n&&g.cantSendBlobInFormData&&g.chunks&&a.settings.chunk_size?(n.onload=function(){e(n.result)},n.readAsBinaryString(o)):e(o)}}var j=0,q=0,n="FileReader"in s?new FileReader:null;k()}var h=a.settings,c;c=y[d.id];g.jpgresize&&a.settings.resize&&/\.(png|jpg|jpeg)$/i.test(d.name)?G.call(a,d,a.settings.resize,/\.png$/i.test(d.name)?"image/png":"image/jpeg",function(a){a.success?
(d.size=a.data.length,e(a.data)):e(c)}):e(c)}),h.bind("Destroy",function(a){var b,e,g=j.body,c={inputContainer:a.id+"_html5_container",inputFile:a.id+"_html5",browseButton:a.settings.browse_button,dropElm:a.settings.drop_element};for(b in c)(e=j.getElementById(c[b]))&&f.removeAllEvents(e,a.id);f.removeAllEvents(j.body,a.id);a.settings.container&&(g=j.getElementById(a.settings.container));g.removeChild(j.getElementById(c.inputContainer))}),e({success:!0})):e({success:!1})}})})(window,document,plupload);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.drag-and-drop:plupload', location = '/includes/js/amd/shim/plupload-amd.js' */
define("plupload",function(){return plupload});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:split_aui.splitchunk.vendors--c7d6d1dc80', location = 'aui.chunk.4daa1caa519b1595efa1--ad657c8d091f03261d99.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["aui.splitchunk.vendors--c7d6d1dc80"],{"2NYx":function(t,i,o){var e,n,l;
/*!
 * jQuery UI Position 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/position/
 */n=[o("oDIA"),o("O+lX")],void 0===(l="function"==typeof(e=function(t){return function(){var i,o=Math.max,e=Math.abs,n=/left|center|right/,l=/top|center|bottom/,s=/[\+\-]\d+(\.[\d]+)?%?/,f=/^\w+/,h=/%$/,r=t.fn.position;function p(t,i,o){return[parseFloat(t[0])*(h.test(t[0])?i/100:1),parseFloat(t[1])*(h.test(t[1])?o/100:1)]}function c(i,o){return parseInt(t.css(i,o),10)||0}function a(i){var o=i[0];return 9===o.nodeType?{width:i.width(),height:i.height(),offset:{top:0,left:0}}:t.isWindow(o)?{width:i.width(),height:i.height(),offset:{top:i.scrollTop(),left:i.scrollLeft()}}:o.preventDefault?{width:0,height:0,offset:{top:o.pageY,left:o.pageX}}:{width:i.outerWidth(),height:i.outerHeight(),offset:i.offset()}}t.position={scrollbarWidth:function(){if(void 0!==i)return i;var o,e,n=t("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),l=n.children()[0];return t("body").append(n),o=l.offsetWidth,n.css("overflow","scroll"),o===(e=l.offsetWidth)&&(e=n[0].clientWidth),n.remove(),i=o-e},getScrollInfo:function(i){var o=i.isWindow||i.isDocument?"":i.element.css("overflow-x"),e=i.isWindow||i.isDocument?"":i.element.css("overflow-y"),n="scroll"===o||"auto"===o&&i.width<i.element[0].scrollWidth;return{width:"scroll"===e||"auto"===e&&i.height<i.element[0].scrollHeight?t.position.scrollbarWidth():0,height:n?t.position.scrollbarWidth():0}},getWithinInfo:function(i){var o=t(i||window),e=t.isWindow(o[0]),n=!!o[0]&&9===o[0].nodeType;return{element:o,isWindow:e,isDocument:n,offset:e||n?{left:0,top:0}:t(i).offset(),scrollLeft:o.scrollLeft(),scrollTop:o.scrollTop(),width:o.outerWidth(),height:o.outerHeight()}}},t.fn.position=function(i){if(!i||!i.of)return r.apply(this,arguments);i=t.extend({},i);var h,d,g,u,m,w,W=t(i.of),v=t.position.getWithinInfo(i.within),y=t.position.getScrollInfo(v),H=(i.collision||"flip").split(" "),x={};return w=a(W),W[0].preventDefault&&(i.at="left top"),d=w.width,g=w.height,u=w.offset,m=t.extend({},u),t.each(["my","at"],(function(){var t,o,e=(i[this]||"").split(" ");1===e.length&&(e=n.test(e[0])?e.concat(["center"]):l.test(e[0])?["center"].concat(e):["center","center"]),e[0]=n.test(e[0])?e[0]:"center",e[1]=l.test(e[1])?e[1]:"center",t=s.exec(e[0]),o=s.exec(e[1]),x[this]=[t?t[0]:0,o?o[0]:0],i[this]=[f.exec(e[0])[0],f.exec(e[1])[0]]})),1===H.length&&(H[1]=H[0]),"right"===i.at[0]?m.left+=d:"center"===i.at[0]&&(m.left+=d/2),"bottom"===i.at[1]?m.top+=g:"center"===i.at[1]&&(m.top+=g/2),h=p(x.at,d,g),m.left+=h[0],m.top+=h[1],this.each((function(){var n,l,s=t(this),f=s.outerWidth(),r=s.outerHeight(),a=c(this,"marginLeft"),w=c(this,"marginTop"),b=f+a+c(this,"marginRight")+y.width,T=r+w+c(this,"marginBottom")+y.height,L=t.extend({},m),P=p(x.my,s.outerWidth(),s.outerHeight());"right"===i.my[0]?L.left-=f:"center"===i.my[0]&&(L.left-=f/2),"bottom"===i.my[1]?L.top-=r:"center"===i.my[1]&&(L.top-=r/2),L.left+=P[0],L.top+=P[1],n={marginLeft:a,marginTop:w},t.each(["left","top"],(function(o,e){t.ui.position[H[o]]&&t.ui.position[H[o]][e](L,{targetWidth:d,targetHeight:g,elemWidth:f,elemHeight:r,collisionPosition:n,collisionWidth:b,collisionHeight:T,offset:[h[0]+P[0],h[1]+P[1]],my:i.my,at:i.at,within:v,elem:s})})),i.using&&(l=function(t){var n=u.left-L.left,l=n+d-f,h=u.top-L.top,p=h+g-r,c={target:{element:W,left:u.left,top:u.top,width:d,height:g},element:{element:s,left:L.left,top:L.top,width:f,height:r},horizontal:l<0?"left":n>0?"right":"center",vertical:p<0?"top":h>0?"bottom":"middle"};d<f&&e(n+l)<d&&(c.horizontal="center"),g<r&&e(h+p)<g&&(c.vertical="middle"),o(e(n),e(l))>o(e(h),e(p))?c.important="horizontal":c.important="vertical",i.using.call(this,t,c)}),s.offset(t.extend(L,{using:l}))}))},t.ui.position={fit:{left:function(t,i){var e,n=i.within,l=n.isWindow?n.scrollLeft:n.offset.left,s=n.width,f=t.left-i.collisionPosition.marginLeft,h=l-f,r=f+i.collisionWidth-s-l;i.collisionWidth>s?h>0&&r<=0?(e=t.left+h+i.collisionWidth-s-l,t.left+=h-e):t.left=r>0&&h<=0?l:h>r?l+s-i.collisionWidth:l:h>0?t.left+=h:r>0?t.left-=r:t.left=o(t.left-f,t.left)},top:function(t,i){var e,n=i.within,l=n.isWindow?n.scrollTop:n.offset.top,s=i.within.height,f=t.top-i.collisionPosition.marginTop,h=l-f,r=f+i.collisionHeight-s-l;i.collisionHeight>s?h>0&&r<=0?(e=t.top+h+i.collisionHeight-s-l,t.top+=h-e):t.top=r>0&&h<=0?l:h>r?l+s-i.collisionHeight:l:h>0?t.top+=h:r>0?t.top-=r:t.top=o(t.top-f,t.top)}},flip:{left:function(t,i){var o,n,l=i.within,s=l.offset.left+l.scrollLeft,f=l.width,h=l.isWindow?l.scrollLeft:l.offset.left,r=t.left-i.collisionPosition.marginLeft,p=r-h,c=r+i.collisionWidth-f-h,a="left"===i.my[0]?-i.elemWidth:"right"===i.my[0]?i.elemWidth:0,d="left"===i.at[0]?i.targetWidth:"right"===i.at[0]?-i.targetWidth:0,g=-2*i.offset[0];p<0?((o=t.left+a+d+g+i.collisionWidth-f-s)<0||o<e(p))&&(t.left+=a+d+g):c>0&&((n=t.left-i.collisionPosition.marginLeft+a+d+g-h)>0||e(n)<c)&&(t.left+=a+d+g)},top:function(t,i){var o,n,l=i.within,s=l.offset.top+l.scrollTop,f=l.height,h=l.isWindow?l.scrollTop:l.offset.top,r=t.top-i.collisionPosition.marginTop,p=r-h,c=r+i.collisionHeight-f-h,a="top"===i.my[1]?-i.elemHeight:"bottom"===i.my[1]?i.elemHeight:0,d="top"===i.at[1]?i.targetHeight:"bottom"===i.at[1]?-i.targetHeight:0,g=-2*i.offset[1];p<0?((n=t.top+a+d+g+i.collisionHeight-f-s)<0||n<e(p))&&(t.top+=a+d+g):c>0&&((o=t.top-i.collisionPosition.marginTop+a+d+g-h)>0||e(o)<c)&&(t.top+=a+d+g)}},flipfit:{left:function(){t.ui.position.flip.left.apply(this,arguments),t.ui.position.fit.left.apply(this,arguments)},top:function(){t.ui.position.flip.top.apply(this,arguments),t.ui.position.fit.top.apply(this,arguments)}}}}(),t.ui.position})?e.apply(i,n):e)||(t.exports=l)}}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:split_jquery.ui.position', location = 'aui.chunk.d4018b1ae0ce6e8d6fb5--c52e93289917138d1a5f.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["jquery.ui.position"],{"7ih8":function(i,u,n){"use strict";n.r(u);n("2NYx");u.default="jquery"}},[["7ih8","runtime","aui.splitchunk.vendors--20a97d6a33","aui.splitchunk.vendors--c7d6d1dc80","aui.splitchunk.0d131bcbf1"]]]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:split_aui.component.progressbar', location = 'aui.chunk.93b7657fd9b2317a7f5c--b1edcc52960e5cc46bf9.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["aui.component.progressbar"],{NQOw:function(t,e,a){"use strict";a.r(e),a.d(e,"progressBars",(function(){return w})),a.d(e,"ProgressBarEl",(function(){return _}));a("FStl"),a("Q0fs");var n=a("+x/D"),i=a("QFBp"),r=a("4dFR"),u=a("Ioyv"),s=a("bPPT"),c=a("KloK");function o(t,e,a){let{currentProgress:i,value:r}=a;const s=Object(n.default)(t),c=Object(n.default)(e);"number"==typeof r&&r<=1&&r>=0&&(c.trigger("aui-progress-indicator-before-update",[i,r]),s.one("transitionend webkitTransitionEnd",(function(){c.trigger("aui-progress-indicator-after-update",[i,r])})),function(t,e,a){Object(u.recomputeStyle)(t),t.css("width",100*a+"%"),e.attr("data-value",a)}(s,c,r))}function l(t){var e=Object(n.default)(t).first(),a=e.children(".aui-progress-indicator-value");e.removeAttr("data-value"),Object(u.recomputeStyle)(e),a.css("width","")}const d={indeterminate:!1,max:1,val:0};function p(t){return Object(i.isNumber)(t)&&Object(i.isFinite)(t)&&!Object(i.isNaN)(t)}function v(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const a=parseFloat(t);return p(a)?a:Number(e)}function m(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Number(parseFloat(t).toFixed(e))}function f(t){const{val:e,max:a}=t,n=function(t){return t>0?t:d.max}(a),i=function(t,e){return Math.max(0,Math.min(t,e))}(e,n),r=m(i/n,6);return{max:n,val:i,valAsFraction:r,valAsPercent:m(100*r,2)}}function b(t){const{val:e,valAsFraction:a,max:n}=f(t._data),i=t.querySelector(".aui-progress-indicator"),r=i.getAttribute("data-value");t.indeterminate?(i.removeAttribute("aria-valuenow"),l(i)):(i.setAttribute("aria-valuenow",e),i.setAttribute("aria-valuemax",n),o(i.querySelector(".aui-progress-indicator-value"),i,{currentProgress:r,value:a}))}function h(t,e){t._data.val=v(e.newValue,e.oldValue||d.val),b(t)}function g(t,e){t._data.max=v(e.newValue,e.oldValue||d.max),b(t)}const _=Object(r.default)("aui-progressbar",{template(t){t._data.max=v(t.getAttribute("max"),d.max),t._data.val=v(t.getAttribute("value"),d.val),t._data.indeterminate=t.hasAttribute("indeterminate");const{val:e,max:a,valAsFraction:n,valAsPercent:i}=f(t._data),r=t._data.indeterminate?"":'data-value="'.concat(n,'"');t.innerHTML='<div class="aui-progress-indicator"\n         '.concat(r,'\n         role="progressbar"\n         aria-valuemin="0"\n         aria-valuenow="').concat(e,'"\n         aria-valuemax="').concat(a,'"\n         tabindex="0"\n     >\n        <span class="aui-progress-indicator-value" style="width: ').concat(i,'%"></span>\n    </div>')},attached(t){b(t)},attributes:{indeterminate:{created:function(t){t.indeterminate=!0},removed:function(t){t.indeterminate=!1}},value:{value:d.val,fallback:function(t,e){if(t._updating)return!1;h(t,e)}},max:{value:d.max,fallback:function(t,e){if(t._updating)return!1;g(t,e)}}},prototype:{get _data(){return this.__data||(this._data=Object(i.defaults)({},d))},set _data(t){return this.__data=t},get indeterminate(){return this._data.indeterminate},set indeterminate(t){this._data.indeterminate=!!t,b(this)},get value(){const{val:t}=f(this._data);return t},set value(t){if(!p(t))return!1;const e={newValue:m(t,6)};this._updating=!0,this.setAttribute("value",e.newValue),this._updating=!1,h(this,e)},get max(){const{max:t}=f(this._data);return t},set max(t){if(!p(t))return!1;const e={newValue:m(t,6)};this._updating=!0,this.setAttribute("max",e.newValue),this._updating=!1,g(this,e)}}}),x={update:s.fn((function(t,e){if("string"==typeof t){let e=document.getElementById(t);e&&(t=e)}var a=Object(n.default)(t).first(),i=a.children(".aui-progress-indicator-value"),r=a.attr("data-value"),u=!r,s=parseFloat(r)||0,c=r&&s===e;if(c){c=s===100*(parseFloat(i.get(0).style.width)||0)}if(!c)return u&&i.css("width",0),o(i,a,{currentProgress:s,value:e}),a}),"AJS.progressBars.update",{sinceVersion:"7.7.0",removeInVersion:"10.0.0",extraInfo:"Use the <aui-progressbar> web component instead"}),setIndeterminate:s.fn(l,"AJS.progressBars.setIndeterminate",{sinceVersion:"7.7.0",removeInVersion:"10.0.0",extraInfo:"Use the <aui-progressbar> web component instead"})};Object(c.default)("progressBars",x);var w=x}},[["NQOw","runtime","aui.splitchunk.vendors--894c8113d9","aui.splitchunk.vendors--95c789edf5","aui.splitchunk.vendors--9c48cc20a9","aui.splitchunk.0d131bcbf1","aui.splitchunk.fbbef27525","aui.splitchunk.444efc83be","aui.splitchunk.739b9ec8cc","aui.splitchunk.056561461c","aui.splitchunk.dd803a46b4","aui.splitchunk.e54c7c7304","aui.splitchunk.8659b532c1","aui.splitchunk.9c48cc20a9"]]]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.drag-and-drop:support', location = 'js/drag-and-drop-utils.js' */
define("confluence-drag-and-drop/drag-and-drop-utils",["jquery","window","ajs"],function(d,f,e){return{defaultMimeType:"application/octet-stream",base:/^\w+:\/\/[^/?#]+/.exec(location.href),bindDragEnter:function(a,b){(b=this.isFireFox35OrLater()?this.firefox35DragEnterAndOverCallbackWrapper(b):b)&&a.addEventListener("dragenter",b,!1)},bindDragOver:function(a,b){this.isFireFox35OrLater()?b=this.firefox35DragEnterAndOverCallbackWrapper(b):d.browser.safari&&(b=this.safariDragOverCallbackWrapper(b));
b&&a.addEventListener("dragover",b,!1)},bindDragLeave:function(a,b){b&&a.addEventListener("dragleave",b,!1)},bindDrop:function(a,b){if(d.browser.mozilla){var c=this.isFireFox35OrLater()?"drop":"dragdrop";a.addEventListener(c,this.mozillaDropCallbackWrapper(b),!1)}else b&&a.addEventListener("drop",function(a){b(a);e.DragAndDropUtils.stopPropagation(a)},!1)},niceSize:function(a){for(var b=" B; kB; MB; GB; TB; PB; EB; ZB; YB".split(";"),c=0,d=b.length;c<d;c++)if(a<Math.pow(2,10*(c+1)))return(!c?a:(a/
Math.pow(2,10*c)).toFixed(2))+b[c];return(a/Math.pow(2,10*(c+1))).toFixed(2)+b[b.length-1]},safariDragOverCallbackWrapper:function(a){return function(b){if((b=b||f.event)&&"file"!==b.target.type)a&&a(b),-1!=d.inArray("public.file-url",b.dataTransfer.types)&&b.preventDefault()}},mozillaDropCallbackWrapper:function(a){return function(b){b&&(a&&a(b),b.preventDefault(),e.DragAndDropUtils.isFireFox35OrLater()?e.DragAndDropUtils.firefox35FileDataInEvent(b)&&b.stopPropagation():b.stopPropagation())}},firefox35DragEnterAndOverCallbackWrapper:function(a){return function(b){b&&
(a&&a(b),e.DragAndDropUtils.firefox35FileDataInEvent(b)&&b.preventDefault())}},firefox35FileDataInEvent:function(a){return-1!=d.inArray("application/x-moz-file",a.dataTransfer.types)},stopPropagation:function(a){if(a=a||f.event)a.stopPropagation?a.stopPropagation():a.cancelBubble=!0},preventDefault:function(a){if(a=a||f.event)a.preventDefault?a.preventDefault():a.returnValue=!1},isFireFox35OrLater:function(){return!this.isFireFox30()&&-1!=d.browser.version.indexOf("1.9.")},isFireFox30:function(){return-1!=
d.browser.version.indexOf("1.9.0")},enableDropZoneOn:function(a,b){if(!a)throw Error("Cannot enable drop zone on invalid container. Received: "+a);b=b||e.DragAndDrop.defaultDropHandler;this.bindDragEnter(a);this.bindDragOver(a);this.bindDragLeave(a);this.bindDrop(a,b)}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-drag-and-drop/drag-and-drop-utils","AJS.DragAndDropUtils");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.drag-and-drop:support', location = 'js/observable-array-list.js' */
define("confluence-drag-and-drop/observable-array-list",["ajs","jquery"],function(g,f){var e=function(){this._data=[];this._pushObservers=[]};e.prototype={push:function(a){this._data.push(a);this._notifyPushObservers(a)},length:function(){return this._data.length},remove:function(a,b){return this._remove.call(this._data,a,b)},_remove:function(a,b){var c=this.slice((b||a)+1||this.length);this.length=0>a?this.length+a:a;return this.push.apply(this,c)},shift:function(){return this._data.shift()},removeByPredicate:function(a){for(var b=
[],c=this._data.length,d=0;d<c;d++)a(this._data[d])||b.push(this._data[d]);this._data=b;return c-this._data.length},addPushObserver:function(a){if(f.isFunction(a))this._pushObservers.push(a);else throw Error("Attempting to add an observer that is not a function: "+a);},_notifyPushObservers:function(a){for(var b=0,c=this._pushObservers.length;b<c;b++)this._pushObservers[b](a)}};return e});require("confluence/module-exporter").exportModuleAsGlobal("confluence-drag-and-drop/observable-array-list","AJS.ObservableArrayList");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.drag-and-drop:support', location = 'js/upload-progress-dialog.js' */
define("confluence-drag-and-drop/upload-progress-dialog",["ajs","plupload","jquery","document"],function(c,g,b,i){var h=function(a){var d=this,e={header:"Attach files",width:600,height:400};this._options=b.extend({},e,a);this.id="drag-and-drop-progress-dialog";this._dialog=new c.Dialog(this._options.width,this._options.height,this.id);this._dialog.addHeader(this._options.header).addPanel("Panel 1",c.DragAndDrop.Templates.uploadFileStatusContainer()).addButton("Done",
function(){d.hide();d.clearRenderOutput()},"all-file-uploads-complete");this._dialog.getCurrentPanel().setPadding(0);this._$closeButton=this.find(".all-file-uploads-complete");b(i).keydown(function(a){if(27===a.which)return d._$closeButton.prop("disabled")||(d.hide(),d.clearRenderOutput()),a.stopPropagation(),!1});this._$container=this.find("#upload-statuses");this._workIdsOfFilesInProgress=[];this.cancelListeners=[];this.onShowListeners=[];this._hidden=!0;this.hasErrorMessage=!1};h.prototype={show:function(){this._hidden&&
(this._dialog.show(),this._hidden=!1,b.each(this.onShowListeners,function(a,b){b()}));this.hideCloseButton()},hide:function(){this._hidden||(this._dialog.hide(),this._hidden=!0)},isVisible:function(){return!this._hidden},_getProgressElementId:function(a){return"file-"+a+"-progress"},render:function(a){this._workIdsOfFilesInProgress.push(a.workId);var d=this._getProgressElementId(a.workId);this._$container.append(c.DragAndDrop.Templates.fileStatus({filename:a.file.name,progressElementId:d,workId:a.workId,
showCancel:a.status==g.QUEUED}));c.progressBars.update("#"+d,0);a.status==g.QUEUED?b("#file-upload-cancel-"+a.workId).click(function(c){return function(d){b.each(c,function(b,c){c(d,a)})}}(this.cancelListeners)):this.renderError(a.workId,a.errorMessage)},renderError:function(a,d){if(-1==b.inArray(a,this._workIdsOfFilesInProgress))throw Error("No file status found with id: "+a);var e=b("#file-status-block-"+a),f=c.escapeEntities(e.attr("data-filename"));e.html(aui.message.error({content:d,titleContent:f}));
this.hasErrorMessage=!0},renderInfo:function(a,d){if(-1==b.inArray(a,this._workIdsOfFilesInProgress))throw Error("No file status found with id: "+a);var e=b("#file-status-block-"+a),f=c.escapeEntities(e.attr("data-filename"));e.html(aui.message.info({content:d,titleContent:f}));this.hasErrorMessage=!0},hasErrors:function(){return this.hasErrorMessage},renderUpdateToBytesUploaded:function(a,d,e){if(-1==b.inArray(a,this._workIdsOfFilesInProgress))throw Error("No file status found with id: "+a);var f=
c.DragAndDropUtils.niceSize(d),g=b("#file-"+a+"-uploaded");g.length?g.text(f):b("#file-upload-progress-text-"+a).html(c.DragAndDrop.Templates.uploadFileStatusProgressMessage({fileId:a,uploadedSizeNice:f,totalSizeNice:c.DragAndDropUtils.niceSize(e)}));c.progressBars.update("#"+this._getProgressElementId(a),d/e)},renderComplete:function(a){if(-1==b.inArray(a,this._workIdsOfFilesInProgress))throw Error("No file status found with id: "+a);b("#cancel-or-success-placeholder-"+a).html(c.DragAndDrop.Templates.uploadFileStatusSuccessIcon())},
renderCancelled:function(a){if(-1==b.inArray(a,this._workIdsOfFilesInProgress))throw Error("No file status found with id: "+a);c.progressBars.setIndeterminate("#"+this._getProgressElementId(a));b("#file-upload-progress-text-"+a).html("Canceled.");b("#cancel-or-success-placeholder-"+a).hide()},clearRenderOutput:function(){this.showCloseButton();this._$container.empty();this._workIdsOfFilesInProgress=[];this.hasErrorMessage=!1},hideCloseButton:function(){this._$closeButton.hide()},
showCloseButton:function(){this._$closeButton.show()},find:function(a){return this._dialog.getCurPanel().page.body.parent().find(a)}};return h});require("confluence/module-exporter").exportModuleAsGlobal("confluence-drag-and-drop/upload-progress-dialog","AJS.DragAndDropProgressDialog");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.drag-and-drop:support', location = 'templates/drag-and-drop.soy' */
// This file was automatically generated from drag-and-drop.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace AJS.DragAndDrop.Templates.
 */

if (typeof AJS == 'undefined') { var AJS = {}; }
if (typeof AJS.DragAndDrop == 'undefined') { AJS.DragAndDrop = {}; }
if (typeof AJS.DragAndDrop.Templates == 'undefined') { AJS.DragAndDrop.Templates = {}; }


AJS.DragAndDrop.Templates.fileStatus = function(opt_data, opt_ignored) {
  return '<li id="file-status-block-' + soy.$$escapeHtml(opt_data.workId) + '" data-filename="' + soy.$$escapeHtml(opt_data.filename) + '"><div class="aui-group aui-group-split file-status-item"><div class="aui-item"><label>' + soy.$$escapeHtml(opt_data.filename) + '</label></div><div class="aui-item"><div id="file-upload-progress-text-' + soy.$$escapeHtml(opt_data.workId) + '" class="file-upload-progress-text">' + soy.$$escapeHtml('Waiting...') + '</div></div></div><div class="file-upload-progress-block"><div class="aui-progress-indicator" id="' + soy.$$escapeHtml(opt_data.progressElementId) + '"><span class="aui-progress-indicator-value"></span></div>' + ((opt_data.showCancel) ? '<div id="cancel-or-success-placeholder-' + soy.$$escapeHtml(opt_data.workId) + '" class="cancel-or-success-placeholder ui-state-default"><span id="file-upload-cancel-' + soy.$$escapeHtml(opt_data.workId) + '" class="aui-icon aui-icon-small aui-iconfont-remove" title="' + soy.$$escapeHtml('Cancel Upload') + '">' + soy.$$escapeHtml('Cancel') + '</span></div>' : '') + '</div></li>';
};
if (goog.DEBUG) {
  AJS.DragAndDrop.Templates.fileStatus.soyTemplateName = 'AJS.DragAndDrop.Templates.fileStatus';
}


AJS.DragAndDrop.Templates.uploadFileStatusContainer = function(opt_data, opt_ignored) {
  return '<ul id="upload-statuses"></ul>';
};
if (goog.DEBUG) {
  AJS.DragAndDrop.Templates.uploadFileStatusContainer.soyTemplateName = 'AJS.DragAndDrop.Templates.uploadFileStatusContainer';
}


AJS.DragAndDrop.Templates.uploadFileStatusSuccessIcon = function(opt_data, opt_ignored) {
  return '<span class=\'aui-icon aui-icon-small aui-iconfont-success\'></span>';
};
if (goog.DEBUG) {
  AJS.DragAndDrop.Templates.uploadFileStatusSuccessIcon.soyTemplateName = 'AJS.DragAndDrop.Templates.uploadFileStatusSuccessIcon';
}


AJS.DragAndDrop.Templates.uploadFileStatusProgressMessage = function(opt_data, opt_ignored) {
  return '<span id="file-' + soy.$$escapeHtml(opt_data.fileId) + '-uploaded">' + soy.$$escapeHtml(opt_data.uploadedSizeNice) + '</span> ' + soy.$$escapeHtml('of') + ' ' + soy.$$escapeHtml(opt_data.totalSizeNice);
};
if (goog.DEBUG) {
  AJS.DragAndDrop.Templates.uploadFileStatusProgressMessage.soyTemplateName = 'AJS.DragAndDrop.Templates.uploadFileStatusProgressMessage';
}


AJS.DragAndDrop.Templates.dropZone = function(opt_data, opt_ignored) {
  return '<div class="attachments-drop-zone"><div class="drop-zone-image"></div><div class="drop-zone-text">' + soy.$$escapeHtml('Drop files here to attach them') + '</div></div>';
};
if (goog.DEBUG) {
  AJS.DragAndDrop.Templates.dropZone.soyTemplateName = 'AJS.DragAndDrop.Templates.dropZone';
}


AJS.DragAndDrop.Templates.dragOverlay = function(opt_data, opt_ignored) {
  return '<div id="dragOverlay"><div class="overlay-blanket"></div><div class="overlay-center"><p>' + soy.$$escapeHtml('Drop files to insert them into the page') + '</p></div><span class="overlay-baseline"></span><div class="overlay-drop-zone"></div></div>';
};
if (goog.DEBUG) {
  AJS.DragAndDrop.Templates.dragOverlay.soyTemplateName = 'AJS.DragAndDrop.Templates.dragOverlay';
}


AJS.DragAndDrop.Templates.dragAndDropTip = function(opt_data, opt_ignored) {
  return '<div class="attach-tip-discovery"><span class="img"></span><div class="text"><strong>' + soy.$$escapeHtml('Tip:') + ' </strong><p>' + soy.$$escapeHtml('Drop files straight into your page to insert them directly.') + '</p><div><a class="close-tip" href="#">' + soy.$$escapeHtml('Ok, got it!') + '</a></div></div></div>';
};
if (goog.DEBUG) {
  AJS.DragAndDrop.Templates.dragAndDropTip.soyTemplateName = 'AJS.DragAndDrop.Templates.dragAndDropTip';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.drag-and-drop:support', location = 'js/upload-utils.js' */
define("confluence-drag-and-drop/upload-utils",["ajs"],function(h){return{ErrorCode:{FILE_IS_A_FOLDER_ERROR:-602},filterFiles:function(d,a,g){for(var e=[],b=0,c=0;c<a.length;c++)if(4096>=a[c].nativeFile.size){var f=new FileReader;f.onload=function(){b++;e.push(this.currentFile);b===a.length&&g(d,e)};f.onerror=function(){d.removeFile(this.currentFile);d.trigger("Error",{code:h.UploadUtils.ErrorCode.FILE_IS_A_FOLDER_ERROR,message:"File is a folder",file:this.currentFile});b++;b===a.length&&g(d,e)};
f.currentFile=a[c];f.readAsText(a[c].nativeFile)}else b++,e.push(a[c]),b===a.length&&g(d,e)}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-drag-and-drop/upload-utils","AJS.UploadUtils");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.drag-and-drop:default-drop-handler', location = 'js/default-drop-handler.js' */
define("confluence-drag-and-drop/default-drop-handler","ajs document confluence/meta jquery confluence/legacy underscore plupload window confluence/api/constants confluence/api/event confluence/message-controller".split(" "),function(c,m,i,n,j,s,k,t,u,o,v){var l={},p=false;l.initialise=function(){function l(){b=c.Editor&&c.Editor.isVisible()&&j.EditorUploadProgressDialog?j.EditorUploadProgressDialog:new c.DragAndDropProgressDialog}function q(){var b=n(".aui-blanket:visible");return b.length&&b.css("visibility")!==
"hidden"&&!n("#drag-and-drop-progress-dialog:visible").length}function r(){for(;f.files.length;)f.removeFile(f.files[0])}var b,h,f;if(!p){p=true;c.DragAndDrop.defaultDropHandler=null;h=m.getElementById("fileuploadShim");if(!h){h=m.createElement("div");h.setAttribute("id","fileuploadShim");m.body.appendChild(h)}f=new k.Uploader({runtimes:"html5",dragdrop:true,drop_element:m.body,browse_button:h.getAttribute("id"),multipart:false,stop_propagation:true,max_file_size:+i.get("global-settings-attachment-max-size")});
b=null;f.init();f.bind("FilesAdded",function(g,a){var d=c.Editor;if(q())r();else if(d&&d.isVisible()){d=d.getCurrentForm().parentElement.classList;j.Uploader&&(d.contains("ic-body")||d.contains("comment-body"))&&j.Uploader.trigger("FilesAdded",s.reject(a,function(a){return a.status===k.FAILED}))}else c.UploadUtils.filterFiles(g,a,function(a,c){var d,g;b||l();for(d=0;d<c.length;d++){g=c[d];g.status!==k.FAILED&&b.render({workId:g.id,status:g.status,file:g})}f.start()})});f.bind("BeforeUpload",function(g,
a){if(!c.Editor||!c.Editor.isVisible()){var d=c.DragAndDropUtils.base+u.CONTEXT_PATH+"/plugins/drag-and-drop/upload.action",e=i.get("page-id"),e=e!=0?{pageId:e}:{draftId:i.get("draft-id")},f=a.name.substr(a.name.lastIndexOf(".")+1);e.filename=a.name;e.size=a.size;e.mimeType=k.mimeTypes[f.toLowerCase()]||c.DragAndDropUtils.defaultMimeType;e.spaceKey=i.get("space-key");e.atl_token=i.get("atl-token");g.settings.url=k.buildUrl(d,e);b.cancelListeners.push(function(a,d){var e=g.getFile(d.workId);e&&g.removeFile(e);
b.renderInfo(d.workId,"File was manually removed from the queue.")});b.show()}});f.bind("UploadProgress",function(c,a){b.renderUpdateToBytesUploaded(a.id,a.loaded,a.size);b.hideCloseButton()});f.bind("FileUploaded",function(f,a,d){d.status===0?b.renderError(a.id,"The server is not responding. Please check that it is running."):b.renderComplete(a.id)});f.bind("Error",function(f,a){var d,e;if(q())r();else if(c.Editor&&c.Editor.isVisible())j.Uploader&&j.Uploader.trigger("Error",a);else if(a.response){try{d=
n.parseJSON(a.response);e=d.actionErrors[0]}catch(h){if(h.name==="SyntaxError")e="Invalid response received from the server.";else{a.responseText=a.response;e=v.parseError(a)}}b.renderError(a.file.id,e);o.trigger("analyticsEvent",{name:"confluence.default-drop.upload.error.server-unknown"})}else{e=a.message;if(a.code===k.FILE_SIZE_ERROR){e=c.format("is too big to upload. Files must be less than {0}.",c.DragAndDropUtils.niceSize(i.get("global-settings-attachment-max-size")));o.trigger("analyticsEvent",
{name:"confluence.default-drop.upload.error.file-size"})}else if(a.code===c.UploadUtils.ErrorCode.FILE_IS_A_FOLDER_ERROR){e="might be a folder or an unsupported file type.";o.trigger("analyticsEvent",{name:"confluence.default-drop.upload.error.file-type"})}b||l();b.render({workId:a.file.id,status:a.file.status,file:a.file,errorMessage:e});if(!b.isVisible()){b.show();b.showCloseButton()}}});f.bind("UploadComplete",function(){if(!f.total.queued&&b){b.showCloseButton();b.hasErrors()||setTimeout(function(){b.hide();
b.clearRenderOutput();t.location.reload()},1E3)}})}};return l});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:macro-browser-resources', location = 'templates/extra/jira/view-in-jira.js' */
AJS.bind("add-handler.property-panel",function(k,g){AJS.log("add-handler.property-panel: panel name \x3d "+g.name);"macro"==g.name&&g.registerButtonHandler("view-in-jira",function(a,c){if(AJS.Editor.JiraConnector.servers){a=AJS.Editor.JiraConnector.servers;c=AJS.$(c);var b=c.attr("data-macro-default-parameter");c=c.attr("data-macro-parameters")||"";var e=Confluence.MacroParameterSerializer.deserialize(c);(b=b||e.jqlQuery||e.key)||(b=c.indexOf("|"),b=0<=b?c.substring(0,b):c);c=b;b=e.server;var h=e.serverId;
e=c.match(/=|!=|~|>|<|!~| is | in /i);for(var f=null,d=0;d<a.length;d++){if(h&&a[d].id==h){f=a[d];break}if(b&&a[d].name==b||!b&&a[d].selected){f=a[d];break}}null!=f&&(a="undefined"!==typeof f.displayUrl?f.displayUrl:f.url,"/"==a.charAt(a.length-1)&&(a=a.substr(0,a.length-1)),b=tinymce.isIE?"_blank":"confluence-goto-jiralink-"+AJS.params.pageId,(e?window.open(a+"/secure/IssueNavigator.jspa?reset\x3dtrue\x26jqlQuery\x3d"+encodeURIComponent(c),b):window.open(a+"/browse/"+encodeURIComponent(c),b)).opener=
null)}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:macro-browser-resources', location = 'templates/extra/jira/show-summary.js' */
AJS.bind("init.rte",function(){function a(b,d,e){if(e=AJS.$.grep(d,function(f){return"show-summary"==f.parameterName})[0])c(b)?"false"==AJS.SummaryHelper.getParam(b,"showSummary")?e.text="Show summary":e.text="Hide summary":e.className+=" hidden";else{AJS.logError("Jira Issues Macro - Show-summary : The system cannot find SummaryButton, all buttons are: ");for(var g in d)AJS.logError(d[g].text)}}function c(b){var d=
AJS.$(b).attr("src");if(!d)return!0;b=AJS.SummaryHelper.getParam(b,"count");return-1==d.indexOf("confluence.extra.jira/jira-table")&&"true"!=b?!0:!1}AJS.Confluence||AJS.Confluence.PropertyPanel||AJS.Confluence.PropertyPanel.Macro?(AJS.Confluence.PropertyPanel.Macro.registerInitHandler(a,"jira"),AJS.Confluence.PropertyPanel.Macro.registerInitHandler(a,"jiraissues")):AJS.logError("Jira Issues Macro : can't register property panel init handler since AJS.Confluence.PropertyPanel.Macro is undefined")});
AJS.bind("add-handler.property-panel",function(a,c){"macro"==c.name&&c.registerButtonHandler("show-summary",function(b,d){b=AJS.SummaryHelper.getParam(d,"showSummary");AJS.SummaryHelper.updateMacro("jira",d,"showSummary","false"==b?"true":"false")})});
AJS.SummaryHelper=function(){return{getCurrentParams:function(a){return Confluence.MacroParameterSerializer.deserialize(a.attr("data-macro-parameters"))},getParam:function(a,c){a=AJS.$(a);return AJS.SummaryHelper.getCurrentParams(a)[c]},updateMacro:function(a,c,b,d){c=AJS.$(c);AJS.Rte.getEditor().selection.select(c[0]);AJS.Rte.BookmarkManager.storeBookmark();var e=AJS.SummaryHelper.getCurrentParams(c);e[b]=d;a={contentId:Confluence.Editor.getContentId(),macro:{name:a,params:e,defaultParameterValue:c.attr("data-macro-default-parameter")}};
tinymce.confluence.MacroUtils.insertMacro(a)}}}();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.integration.jira.jira-integration-plugin:lodash', location = '/custom-lodash/custom-lodash.js' */
/*

 Lodash (Custom Build) <https://lodash.com/>
 Build: `lodash include="bind,map,groupBy,compact,uniq,has,each,extend,filter,reject,bindAll,without,debounce,difference,forEach,take,find,chain,some,values,reduce" moduleId="jira-integration-plugin/custom-lodash"`
 Copyright JS Foundation and other contributors <https://js.foundation/>
 Released under MIT license <https://lodash.com/license>
 Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/
(function(){function va(a,b,c){switch(c.length){case 0:return a.call(b);case 1:return a.call(b,c[0]);case 2:return a.call(b,c[0],c[1]);case 3:return a.call(b,c[0],c[1],c[2])}return a.apply(b,c)}function Ic(a,b,c,d){for(var e=-1,g=null==a?0:a.length;++e<g;){var m=a[e];b(d,m,c(m),a)}return d}function C(a,b){for(var c=-1,d=null==a?0:a.length;++c<d&&!1!==b(a[c],c,a););return a}function wa(a,b){for(var c=-1,d=null==a?0:a.length,e=0,g=[];++c<d;){var m=a[c];b(m,c,a)&&(g[e++]=m)}return g}function Xa(a,b){var c;
if(c=!(null==a||!a.length)){if(b===b)a:{c=-1;for(var d=a.length;++c<d;)if(a[c]===b){a=c;break a}a=-1}else a=wb(a,Jc,0);c=-1<a}return c}function Kc(a,b,c){for(var d=-1,e=null==a?0:a.length;++d<e;)if(c(b,a[d]))return!0;return!1}function xa(a,b){for(var c=-1,d=null==a?0:a.length,e=Array(d);++c<d;)e[c]=b(a[c],c,a);return e}function W(a,b){for(var c=-1,d=b.length,e=a.length;++c<d;)a[e+c]=b[c];return a}function xb(a,b,c,d){var e=-1,g=null==a?0:a.length;for(d&&g&&(c=a[++e]);++e<g;)c=b(c,a[e],e,a);return c}
function yb(a,b){for(var c=-1,d=null==a?0:a.length;++c<d;)if(b(a[c],c,a))return!0;return!1}function wb(a,b,c,d){var e=a.length;for(c+=d?1:-1;d?c--:++c<e;)if(b(a[c],c,a))return c;return-1}function Jc(a){return a!==a}function Lc(a){return function(b){return null==b?k:b[a]}}function Mc(a,b,c,d,e){e(a,function(a,e,h){c=d?(d=!1,a):b(c,a,e,h)});return c}function ya(a){return function(b){return a(b)}}function Nc(a,b){return xa(b,function(b){return a[b]})}function zb(a,b){return a.has(b)}function Ab(a){var b=
-1,c=Array(a.size);a.forEach(function(a,e){c[++b]=[e,a]});return c}function Bb(a,b){return function(c){return a(b(c))}}function da(a,b){for(var c=-1,d=a.length,e=0,g=[];++c<d;){var m=a[c];if(m===b||"__lodash_placeholder__"===m)a[c]="__lodash_placeholder__",g[e++]=c}return g}function za(a){var b=-1,c=Array(a.size);a.forEach(function(a){c[++b]=a});return c}function f(a){if(x(a)&&!v(a)&&!(a instanceof q)){if(a instanceof E)return a;if(w.call(a,"__wrapped__"))return Cb(a)}return new E(a)}function Aa(){}
function E(a,b){this.__wrapped__=a;this.__actions__=[];this.__chain__=!!b;this.__index__=0;this.__values__=k}function q(a){this.__wrapped__=a;this.__actions__=[];this.__dir__=1;this.__filtered__=!1;this.__iteratees__=[];this.__takeCount__=4294967295;this.__views__=[]}function P(a){var b=-1,c=null==a?0:a.length;for(this.clear();++b<c;){var d=a[b];this.set(d[0],d[1])}}function J(a){var b=-1,c=null==a?0:a.length;for(this.clear();++b<c;){var d=a[b];this.set(d[0],d[1])}}function K(a){var b=-1,c=null==
a?0:a.length;for(this.clear();++b<c;){var d=a[b];this.set(d[0],d[1])}}function X(a){var b=-1,c=null==a?0:a.length;for(this.__data__=new K;++b<c;)this.add(a[b])}function F(a){this.size=(this.__data__=new J(a)).size}function Db(a,b){var c=v(a),d=!c&&Ba(a),e=!c&&!d&&ea(a),g=!c&&!d&&!e&&Ya(a);if(c=c||d||e||g){d=a.length;for(var m=String,h=-1,n=Array(d);++h<d;)n[h]=m(h);d=n}else d=[];m=d.length;for(var f in a)!b&&!w.call(a,f)||c&&("length"==f||e&&("offset"==f||"parent"==f)||g&&("buffer"==f||"byteLength"==
f||"byteOffset"==f)||fa(f,m))||d.push(f);return d}function Eb(a,b,c){var d=a[b];w.call(a,b)&&ha(d,c)&&(c!==k||b in a)||Ca(a,b,c)}function Da(a,b){for(var c=a.length;c--;)if(ha(a[c][0],b))return c;return-1}function Oc(a,b,c,d){Y(a,function(a,g,m){b(d,a,c(a),m)});return d}function Pc(a,b){return a&&ia(b,G(b),a)}function Qc(a,b){return a&&ia(b,ja(b),a)}function Ca(a,b,c){"__proto__"==b&&Ea?Ea(a,b,{configurable:!0,enumerable:!0,value:c,writable:!0}):a[b]=c}function Fa(a,b,c,d,e,g){var m,h=b&1,n=b&2,f=
b&4;c&&(m=e?c(a,d,e,g):c(a));if(m!==k)return m;if(!y(a))return a;if(d=v(a)){if(m=Rc(a),!h)return M(a,m)}else{var l=A(a),p="[object Function]"==l||"[object GeneratorFunction]"==l;if(ea(a))return Sc(a,h);if("[object Object]"==l||"[object Arguments]"==l||p&&!e){if(m=n||p?{}:Tc(a),!h)return n?Uc(a,Qc(m,a)):Vc(a,Pc(m,a))}else{if(!t[l])return e?a:{};m=Wc(a,l,h)}}g||(g=new F);if(e=g.get(a))return e;g.set(a,m);if(Fb(a))return a.forEach(function(d){m.add(Fa(d,b,c,d,a,g))}),m;if(Gb(a))return a.forEach(function(d,
e){m.set(e,Fa(d,b,c,e,a,g))}),m;n=f?n?Xc:Za:n?ja:G;var r=d?k:n(a);C(r||a,function(d,e){r&&(e=d,d=a[e]);Eb(m,e,Fa(d,b,c,e,a,g))});return m}function Hb(a,b,c,d){var e=-1,g=Xa,m=!0,h=a.length,n=[],f=b.length;if(!h)return n;c&&(b=xa(b,ya(c)));d?(g=Kc,m=!1):200<=b.length&&(g=zb,m=!1,b=new X(b));a:for(;++e<h;){var l=a[e],k=null==c?l:c(l);l=d||0!==l?l:0;if(m&&k===k){for(var r=f;r--;)if(b[r]===k)continue a;n.push(l)}else g(b,k,d)||n.push(l)}return n}function Ib(a,b){var c=[];Y(a,function(a,e,g){b(a,e,g)&&
c.push(a)});return c}function $a(a,b,c,d,e){var g=-1,m=a.length;c||(c=Yc);for(e||(e=[]);++g<m;){var h=a[g];0<b&&c(h)?1<b?$a(h,b-1,c,d,e):W(e,h):d||(e[e.length]=h)}return e}function Ga(a,b){return a&&Zc(a,b,G)}function Jb(a,b){return wa(b,function(b){return ka(a[b])})}function ab(a,b){b=bb(b,a);for(var c=0,d=b.length;null!=a&&c<d;)a=a[Z(b[c++])];return c&&c==d?a:k}function Kb(a,b,c){b=b(a);return v(a)?b:W(b,c(a))}function Q(a){if(null==a)return a===k?"[object Undefined]":"[object Null]";if(R&&R in
Object(a)){var b=w.call(a,R),c=a[R];try{a[R]=k;var d=!0}catch(g){}var e=Lb.call(a);d&&(b?a[R]=c:delete a[R]);a=e}else a=Lb.call(a);return a}function $c(a,b){return null!=a&&w.call(a,b)}function ad(a,b){return null!=a&&b in Object(a)}function Mb(a){return x(a)&&"[object Arguments]"==Q(a)}function aa(a,b,c,d,e){if(a===b)return!0;if(null==a||null==b||!x(a)&&!x(b))return a!==a&&b!==b;a:{var g=v(a),m=v(b),h=g?"[object Array]":A(a),n=m?"[object Array]":A(b);h="[object Arguments]"==h?"[object Object]":h;
n="[object Arguments]"==n?"[object Object]":n;var f="[object Object]"==h;m="[object Object]"==n;if((n=h==n)&&ea(a)){if(!ea(b)){b=!1;break a}g=!0;f=!1}if(n&&!f)e||(e=new F),b=g||Ya(a)?Nb(a,b,c,d,aa,e):bd(a,b,h,c,d,aa,e);else{if(!(c&1)&&(g=f&&w.call(a,"__wrapped__"),h=m&&w.call(b,"__wrapped__"),g||h)){a=g?a.value():a;b=h?b.value():b;e||(e=new F);b=aa(a,b,c,d,e);break a}if(n)b:if(e||(e=new F),g=c&1,h=Za(a),m=h.length,n=Za(b).length,m==n||g){for(f=m;f--;){var l=h[f];if(!(g?l in b:w.call(b,l))){b=!1;break b}}if((n=
e.get(a))&&e.get(b))b=n==b;else{n=!0;e.set(a,b);e.set(b,a);for(var p=g;++f<m;){l=h[f];var r=a[l],q=b[l];if(d)var t=g?d(q,r,l,b,a,e):d(r,q,l,a,b,e);if(t===k?r!==q&&!aa(r,q,c,d,e):!t){n=!1;break}p||(p="constructor"==l)}n&&!p&&(c=a.constructor,d=b.constructor,c!=d&&"constructor"in a&&"constructor"in b&&!("function"==typeof c&&c instanceof c&&"function"==typeof d&&d instanceof d)&&(n=!1));e["delete"](a);e["delete"](b);b=n}}else b=!1;else b=!1}}return b}function cd(a){return x(a)&&"[object Map]"==A(a)}
function dd(a,b,c,d){var e=c.length,g=e,m=!d;if(null==a)return!g;for(a=Object(a);e--;){var h=c[e];if(m&&h[2]?h[1]!==a[h[0]]:!(h[0]in a))return!1}for(;++e<g;){h=c[e];var f=h[0],z=a[f],l=h[1];if(m&&h[2]){if(z===k&&!(f in a))return!1}else{h=new F;if(d)var p=d(z,l,f,a,b,h);if(p===k?!aa(l,z,3,d,h):!p)return!1}}return!0}function ed(a){return x(a)&&"[object Set]"==A(a)}function fd(a){return x(a)&&Ha(a.length)&&!!u[Q(a)]}function Ob(a){return"function"==typeof a?a:null==a?ba:"object"==typeof a?v(a)?gd(a[0],
a[1]):hd(a):Pb(a)}function id(a,b){var c=-1,d=L(a)?Array(a.length):[];Y(a,function(a,g,m){d[++c]=b(a,g,m)});return d}function hd(a){var b=jd(a);return 1==b.length&&b[0][2]?Qb(b[0][0],b[0][1]):function(c){return c===a||dd(c,a,b)}}function gd(a,b){return cb(a)&&b===b&&!y(b)?Qb(Z(a),b):function(c){var d=db(c,a);return d===k&&d===b?Rb(c,a):aa(b,d,3)}}function kd(a){return function(b){return ab(b,a)}}function la(a,b){return eb(Sb(a,b,ba),a+"")}function Tb(a,b,c){var d=-1,e=a.length;0>b&&(b=-b>e?0:e+b);
c=c>e?e:c;0>c&&(c+=e);e=b>c?0:c-b>>>0;b>>>=0;for(c=Array(e);++d<e;)c[d]=a[d+b];return c}function ld(a,b){var c;Y(a,function(a,e,g){c=b(a,e,g);return!c});return!!c}function Ub(a){if("string"==typeof a)return a;if(v(a))return xa(a,Ub)+"";if(ma(a))return Vb?Vb.call(a):"";var b=a+"";return"0"==b&&1/a==-na?"-0":b}function Wb(a,b){a instanceof q&&(a=a.value());return xb(b,function(a,b){return b.func.apply(b.thisArg,W([a],b.args))},a)}function bb(a,b){return v(a)?a:cb(a,b)?[a]:md(Xb(a))}function Sc(a,b){if(b)return a.slice();
b=a.length;b=Yb?Yb(b):new a.constructor(b);a.copy(b);return b}function fb(a){var b=new a.constructor(a.byteLength);(new Ia(b)).set(new Ia(a));return b}function Zb(a,b,c,d){var e=-1,g=a.length,m=c.length,h=-1,f=b.length,k=H(g-m,0),l=Array(f+k);for(d=!d;++h<f;)l[h]=b[h];for(;++e<m;)if(d||e<g)l[c[e]]=a[e];for(;k--;)l[h++]=a[e++];return l}function $b(a,b,c,d){var e=-1,g=a.length,m=-1,h=c.length,f=-1,k=b.length,l=H(g-h,0),p=Array(l+k);for(d=!d;++e<l;)p[e]=a[e];for(l=e;++f<k;)p[l+f]=b[f];for(;++m<h;)if(d||
e<g)p[l+c[m]]=a[e++];return p}function M(a,b){var c=-1,d=a.length;for(b||(b=Array(d));++c<d;)b[c]=a[c];return b}function ia(a,b,c,d){var e=!c;c||(c={});for(var g=-1,m=b.length;++g<m;){var h=b[g],f=d?d(c[h],a[h],h,c,a):k;f===k&&(f=a[h]);e?Ca(c,h,f):Eb(c,h,f)}return c}function Vc(a,b){return ia(a,gb(a),b)}function Uc(a,b){return ia(a,ac(a),b)}function nd(a,b,c){function d(){return(this&&this!==B&&this instanceof d?g:a).apply(e?c:this,arguments)}var e=b&1,g=oa(a);return d}function oa(a){return function(){var b=
arguments;switch(b.length){case 0:return new a;case 1:return new a(b[0]);case 2:return new a(b[0],b[1]);case 3:return new a(b[0],b[1],b[2]);case 4:return new a(b[0],b[1],b[2],b[3]);case 5:return new a(b[0],b[1],b[2],b[3],b[4]);case 6:return new a(b[0],b[1],b[2],b[3],b[4],b[5]);case 7:return new a(b[0],b[1],b[2],b[3],b[4],b[5],b[6])}var c=Ja(a.prototype);b=a.apply(c,b);return y(b)?b:c}}function od(a,b,c){function d(){for(var g=arguments.length,m=Array(g),h=g,f=hb(d);h--;)m[h]=arguments[h];h=3>g&&m[0]!==
f&&m[g-1]!==f?[]:da(m,f);g-=h.length;return g<c?bc(a,b,Ka,d.placeholder,k,m,h,k,k,c-g):va(this&&this!==B&&this instanceof d?e:a,this,m)}var e=oa(a);return d}function Ka(a,b,c,d,e,g,m,f,n,z){function h(){for(var l=arguments.length,r=Array(l),I=l;I--;)r[I]=arguments[I];if(v){var y=hb(h),x;I=r.length;for(x=0;I--;)r[I]===y&&++x}d&&(r=Zb(r,d,e,v));g&&(r=$b(r,g,m,v));l-=x;if(v&&l<z)return y=da(r,y),bc(a,b,Ka,h.placeholder,c,r,y,f,n,z-l);y=q?c:this;I=t?y[a]:a;l=r.length;if(f){x=r.length;for(var A=S(f.length,
x),D=M(r);A--;){var C=f[A];r[A]=fa(C,x)?D[C]:k}}else u&&1<l&&r.reverse();p&&n<l&&(r.length=n);this&&this!==B&&this instanceof h&&(I=w||oa(I));return I.apply(y,r)}var p=b&128,q=b&1,t=b&2,v=b&24,u=b&512,w=t?k:oa(a);return h}function pd(a,b,c,d){function e(){for(var b=-1,f=arguments.length,k=-1,l=d.length,p=Array(l+f),r=this&&this!==B&&this instanceof e?m:a;++k<l;)p[k]=d[k];for(;f--;)p[k++]=arguments[++b];return va(r,g?c:this,p)}var g=b&1,m=oa(a);return e}function bc(a,b,c,d,e,g,m,h,n,z){var l=b&8,p=
l?m:k;m=l?k:m;var r=l?g:k;g=l?k:g;b=(b|(l?32:64))&~(l?64:32);b&4||(b&=-4);e=[a,b,e,r,p,g,m,h,n,z];c=c.apply(k,e);b:for(h=a.name+"",n=pa[h],z=w.call(pa,h)?n.length:0;z--;)if(l=n[z],p=l.func,null==p||p==a){h=l.name;break b}n=f[h];"function"==typeof n&&h in q.prototype?a===n?h=!0:(h=cc(n),h=!!h&&a===h[0]):h=!1;h&&dc(c,e);c.placeholder=d;return ec(c,a,b)}function Nb(a,b,c,d,e,g){var m=c&1,f=a.length,n=b.length;if(f!=n&&!(m&&n>f))return!1;if((n=g.get(a))&&g.get(b))return n==b;n=-1;var z=!0,l=c&2?new X:
k;g.set(a,b);for(g.set(b,a);++n<f;){var p=a[n],r=b[n];if(d)var q=m?d(r,p,n,b,a,g):d(p,r,n,a,b,g);if(q!==k){if(q)continue;z=!1;break}if(l){if(!yb(b,function(a,b){if(!l.has(b)&&(p===a||e(p,a,c,d,g)))return l.push(b)})){z=!1;break}}else if(p!==r&&!e(p,r,c,d,g)){z=!1;break}}g["delete"](a);g["delete"](b);return z}function bd(a,b,c,d,e,g,f){switch(c){case "[object DataView]":if(a.byteLength!=b.byteLength||a.byteOffset!=b.byteOffset)break;a=a.buffer;b=b.buffer;case "[object ArrayBuffer]":if(a.byteLength!=
b.byteLength||!g(new Ia(a),new Ia(b)))break;return!0;case "[object Boolean]":case "[object Date]":case "[object Number]":return ha(+a,+b);case "[object Error]":return a.name==b.name&&a.message==b.message;case "[object RegExp]":case "[object String]":return a==b+"";case "[object Map]":var m=Ab;case "[object Set]":m||(m=za);if(a.size!=b.size&&!(d&1))break;if(c=f.get(a))return c==b;d|=2;f.set(a,b);b=Nb(m(a),m(b),d,e,g,f);f["delete"](a);return b;case "[object Symbol]":if(qa)return qa.call(a)==qa.call(b)}return!1}
function fc(a){return eb(Sb(a,k,gc),a+"")}function Za(a){return Kb(a,G,gb)}function Xc(a){return Kb(a,ja,ac)}function hb(a){return(w.call(f,"placeholder")?f:a).placeholder}function D(){var a=f.iteratee||ib;a=a===ib?Ob:a;return arguments.length?a(arguments[0],arguments[1]):a}function La(a,b){a=a.__data__;var c=typeof b;return("string"==c||"number"==c||"symbol"==c||"boolean"==c?"__proto__"!==b:null===b)?a["string"==typeof b?"string":"hash"]:a.map}function jd(a){for(var b=G(a),c=b.length;c--;){var d=
b[c],e=a[d];b[c]=[d,e,e===e&&!y(e)]}return b}function T(a,b){a=null==a?k:a[b];b=!y(a)||hc&&hc in a?!1:(ka(a)?qd:rd).test(U(a));return b?a:k}function ic(a,b,c){b=bb(b,a);for(var d=-1,e=b.length,g=!1;++d<e;){var f=Z(b[d]);if(!(g=null!=a&&c(a,f)))break;a=a[f]}if(g||++d!=e)return g;e=null==a?0:a.length;return!!e&&Ha(e)&&fa(f,e)&&(v(a)||Ba(a))}function Rc(a){var b=a.length,c=new a.constructor(b);b&&"string"==typeof a[0]&&w.call(a,"index")&&(c.index=a.index,c.input=a.input);return c}function Tc(a){return"function"!=
typeof a.constructor||jb(a)?{}:Ja(jc(a))}function Wc(a,b,c){var d=a.constructor;switch(b){case "[object ArrayBuffer]":return fb(a);case "[object Boolean]":case "[object Date]":return new d(+a);case "[object DataView]":return b=c?fb(a.buffer):a.buffer,new a.constructor(b,a.byteOffset,a.byteLength);case "[object Float32Array]":case "[object Float64Array]":case "[object Int8Array]":case "[object Int16Array]":case "[object Int32Array]":case "[object Uint8Array]":case "[object Uint8ClampedArray]":case "[object Uint16Array]":case "[object Uint32Array]":return b=
c?fb(a.buffer):a.buffer,new a.constructor(b,a.byteOffset,a.length);case "[object Map]":return new d;case "[object Number]":case "[object String]":return new d(a);case "[object RegExp]":return b=new a.constructor(a.source,sd.exec(a)),b.lastIndex=a.lastIndex,b;case "[object Set]":return new d;case "[object Symbol]":return qa?Object(qa.call(a)):{}}}function Yc(a){return v(a)||Ba(a)||!!(kc&&a&&a[kc])}function fa(a,b){var c=typeof a;b=null==b?9007199254740991:b;return!!b&&("number"==c||"symbol"!=c&&td.test(a))&&
-1<a&&0==a%1&&a<b}function lc(a,b,c){if(!y(c))return!1;var d=typeof b;return("number"==d?L(c)&&fa(b,c.length):"string"==d&&b in c)?ha(c[b],a):!1}function cb(a,b){if(v(a))return!1;var c=typeof a;return"number"==c||"symbol"==c||"boolean"==c||null==a||ma(a)?!0:ud.test(a)||!vd.test(a)||null!=b&&a in Object(b)}function jb(a){var b=a&&a.constructor;return a===("function"==typeof b&&b.prototype||Ma)}function Qb(a,b){return function(c){return null==c?!1:c[a]===b&&(b!==k||a in Object(c))}}function Sb(a,b,
c){b=H(b===k?a.length-1:b,0);return function(){for(var d=arguments,e=-1,g=H(d.length-b,0),f=Array(g);++e<g;)f[e]=d[b+e];e=-1;for(g=Array(b+1);++e<b;)g[e]=d[e];g[b]=c(f);return va(a,this,g)}}function ec(a,b,c){var d=b+"";b=eb;var e=(e=d.match(wd))?e[1].split(xd):[];c=yd(e,c);if(e=c.length){var g=e-1;c[g]=(1<e?"\x26 ":"")+c[g];c=c.join(2<e?", ":" ");d=d.replace(zd,"{\n/* [wrapped with "+c+"] */\n")}return b(a,d)}function mc(a){var b=0,c=0;return function(){var d=Ad(),e=16-(d-c);c=d;if(0<e){if(800<=
++b)return arguments[0]}else b=0;return a.apply(k,arguments)}}function Z(a){if("string"==typeof a||ma(a))return a;var b=a+"";return"0"==b&&1/a==-na?"-0":b}function U(a){if(null!=a){try{return nc.call(a)}catch(b){}return a+""}return""}function yd(a,b){C(Bd,function(c){var d="_."+c[0];b&c[1]&&!Xa(a,d)&&a.push(d)});return a.sort()}function Cb(a){if(a instanceof q)return a.clone();var b=new E(a.__wrapped__,a.__chain__);b.__actions__=M(a.__actions__);b.__index__=a.__index__;b.__values__=a.__values__;return b}
function oc(a,b,c){var d=null==a?0:a.length;if(!d)return-1;c=null==c?0:N(c);0>c&&(c=H(d+c,0));return wb(a,D(b,3),c)}function gc(a){return(null==a?0:a.length)?$a(a,1):[]}function pc(a){var b=null==a?0:a.length;return b?a[b-1]:k}function kb(a){return null==a?a:Cd.call(a)}function qc(a){a=f(a);a.__chain__=!0;return a}function Na(a,b){return b(a)}function Dd(){return this}function rc(a,b){return(v(a)?C:Y)(a,D(b,3))}function Oa(a,b){if("function"!=typeof a||null!=b&&"function"!=typeof b)throw new TypeError("Expected a function");
var c=function(){var d=arguments,e=b?b.apply(this,d):d[0],g=c.cache;if(g.has(e))return g.get(e);d=a.apply(this,d);c.cache=g.set(e,d)||g;return d};c.cache=new (Oa.Cache||K);return c}function lb(a){if("function"!=typeof a)throw new TypeError("Expected a function");return function(){var b=arguments;switch(b.length){case 0:return!a.call(this);case 1:return!a.call(this,b[0]);case 2:return!a.call(this,b[0],b[1]);case 3:return!a.call(this,b[0],b[1],b[2])}return!a.apply(this,b)}}function ha(a,b){return a===
b||a!==a&&b!==b}function L(a){return null!=a&&Ha(a.length)&&!ka(a)}function Pa(a){return x(a)&&L(a)}function ka(a){if(!y(a))return!1;a=Q(a);return"[object Function]"==a||"[object GeneratorFunction]"==a||"[object AsyncFunction]"==a||"[object Proxy]"==a}function Ha(a){return"number"==typeof a&&-1<a&&0==a%1&&9007199254740991>=a}function y(a){var b=typeof a;return null!=a&&("object"==b||"function"==b)}function x(a){return null!=a&&"object"==typeof a}function sc(a){return"string"==typeof a||!v(a)&&x(a)&&
"[object String]"==Q(a)}function ma(a){return"symbol"==typeof a||x(a)&&"[object Symbol]"==Q(a)}function tc(a){if(!a)return[];if(L(a))return sc(a)?Ed.test(a)?a.match(Fd)||[]:a.split(""):M(a);if(ra&&a[ra]){a=a[ra]();for(var b,c=[];!(b=a.next()).done;)c.push(b.value);return c}b=A(a);return("[object Map]"==b?Ab:"[object Set]"==b?za:uc)(a)}function vc(a){if(!a)return 0===a?a:0;a=Qa(a);return a===na||a===-na?1.7976931348623157E308*(0>a?-1:1):a===a?a:0}function N(a){a=vc(a);var b=a%1;return a===a?b?a-b:
a:0}function Qa(a){if("number"==typeof a)return a;if(ma(a))return wc;y(a)&&(a="function"==typeof a.valueOf?a.valueOf():a,a=y(a)?a+"":a);if("string"!=typeof a)return 0===a?a:+a;a=a.replace(Gd,"");var b=Hd.test(a);return b||Id.test(a)?Jd(a.slice(2),b?2:8):Kd.test(a)?wc:+a}function Xb(a){return null==a?"":Ub(a)}function db(a,b,c){a=null==a?k:ab(a,b);return a===k?c:a}function Rb(a,b){return null!=a&&ic(a,b,ad)}function G(a){if(L(a))a=Db(a);else if(jb(a)){var b=[],c;for(c in Object(a))w.call(a,c)&&"constructor"!=
c&&b.push(c);a=b}else a=Ld(a);return a}function ja(a){if(L(a))a=Db(a,!0);else if(y(a)){var b=jb(a),c=[];for(d in a)("constructor"!=d||!b&&w.call(a,d))&&c.push(d);a=c}else{var d=[];if(null!=a)for(b in Object(a))d.push(b);a=d}return a}function uc(a){return null==a?[]:Nc(a,G(a))}function xc(a){return function(){return a}}function ba(a){return a}function ib(a){return Ob("function"==typeof a?a:Fa(a,1))}function mb(a,b,c){var d=G(b),e=Jb(b,d);null!=c||y(b)&&(e.length||!d.length)||(c=b,b=a,a=this,e=Jb(b,
G(b)));var g=!(y(c)&&"chain"in c)||!!c.chain,f=ka(a);C(e,function(c){var d=b[c];a[c]=d;f&&(a.prototype[c]=function(){var b=this.__chain__;if(g||b){var c=a(this.__wrapped__);(c.__actions__=M(this.__actions__)).push({func:d,args:arguments,thisArg:a});c.__chain__=b;return c}return d.apply(a,W([this.value()],arguments))})});return a}function nb(){}function Pb(a){return cb(a)?Lc(Z(a)):kd(a)}function ob(){return[]}function yc(){return!1}var k,na=1/0,wc=0/0,Bd=[["ary",128],["bind",1],["bindKey",2],["curry",
8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],vd=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ud=/^\w*$/,Md=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Gd=/^\s+|\s+$/g,zd=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,wd=/\{\n\/\* \[wrapped with (.+)\] \*/,xd=/,? & /,Nd=/\\(\\)?/g,sd=/\w*$/,Kd=/^[-+]0x[0-9a-f]+$/i,Hd=/^0b[01]+$/i,rd=/^\[object .+?Constructor\]$/,Id=/^0o[0-7]+$/i,td=/^(?:0|[1-9]\d*)$/,Fd=
/\ud83c[\udffb-\udfff](?=\ud83c[\udffb-\udfff])|(?:[^\ud800-\udfff][\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]?|[\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]|\ud83c[\udffb-\udfff])?(?:\u200d(?:[^\ud800-\udfff]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]|\ud83c[\udffb-\udfff])?)*/g,Ed=/[\u200d\ud800-\udfff\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff\ufe0e\ufe0f]/,
u={};u["[object Float32Array]"]=u["[object Float64Array]"]=u["[object Int8Array]"]=u["[object Int16Array]"]=u["[object Int32Array]"]=u["[object Uint8Array]"]=u["[object Uint8ClampedArray]"]=u["[object Uint16Array]"]=u["[object Uint32Array]"]=!0;u["[object Arguments]"]=u["[object Array]"]=u["[object ArrayBuffer]"]=u["[object Boolean]"]=u["[object DataView]"]=u["[object Date]"]=u["[object Error]"]=u["[object Function]"]=u["[object Map]"]=u["[object Number]"]=u["[object Object]"]=u["[object RegExp]"]=
u["[object Set]"]=u["[object String]"]=u["[object WeakMap]"]=!1;var t={};t["[object Arguments]"]=t["[object Array]"]=t["[object ArrayBuffer]"]=t["[object DataView]"]=t["[object Boolean]"]=t["[object Date]"]=t["[object Float32Array]"]=t["[object Float64Array]"]=t["[object Int8Array]"]=t["[object Int16Array]"]=t["[object Int32Array]"]=t["[object Map]"]=t["[object Number]"]=t["[object Object]"]=t["[object RegExp]"]=t["[object Set]"]=t["[object String]"]=t["[object Symbol]"]=t["[object Uint8Array]"]=
t["[object Uint8ClampedArray]"]=t["[object Uint16Array]"]=t["[object Uint32Array]"]=!0;t["[object Error]"]=t["[object Function]"]=t["[object WeakMap]"]=!1;var Jd=parseInt,zc="object"==typeof global&&global&&global.Object===Object&&global,Od="object"==typeof self&&self&&self.Object===Object&&self,B=zc||Od||Function("return this")(),pb="object"==typeof exports&&exports&&!exports.nodeType&&exports,Ra=pb&&"object"==typeof module&&module&&!module.nodeType&&module,Ac=Ra&&Ra.exports===pb,qb=Ac&&zc.process;
a:{try{var V=qb&&qb.binding&&qb.binding("util");break a}catch(a){}V=void 0}var Bc=V&&V.isMap,Cc=V&&V.isSet,Dc=V&&V.isTypedArray,rb=Array.prototype,Ma=Object.prototype,sb=B["__core-js_shared__"],nc=Function.prototype.toString,w=Ma.hasOwnProperty,hc=function(){var a=/[^.]+$/.exec(sb&&sb.keys&&sb.keys.IE_PROTO||"");return a?"Symbol(src)_1."+a:""}(),Lb=Ma.toString,qd=RegExp("^"+nc.call(w).replace(/[\\^$.*+?()[\]{}|]/g,"\\$\x26").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+
"$"),Sa=Ac?B.Buffer:k,O=B.Symbol,Ia=B.Uint8Array,Yb=Sa?Sa.allocUnsafe:k,jc=Bb(Object.getPrototypeOf,Object),Ec=Object.create,Fc=Ma.propertyIsEnumerable,Pd=rb.splice,kc=O?O.isConcatSpreadable:k,ra=O?O.iterator:k,R=O?O.toStringTag:k,Ea=function(){try{var a=T(Object,"defineProperty");a({},"",{});return a}catch(b){}}(),tb=Object.getOwnPropertySymbols,Qd=Sa?Sa.isBuffer:k,Ld=Bb(Object.keys,Object),H=Math.max,S=Math.min,Ad=Date.now,Cd=rb.reverse,ub=T(B,"DataView"),sa=T(B,"Map"),vb=T(B,"Promise"),ca=T(B,
"Set"),ta=T(B,"WeakMap"),ua=T(Object,"create"),Ta=ta&&new ta,pa={},Rd=U(ub),Sd=U(sa),Td=U(vb),Ud=U(ca),Vd=U(ta),Ua=O?O.prototype:k,qa=Ua?Ua.valueOf:k,Vb=Ua?Ua.toString:k,Ja=function(){function a(){}return function(b){if(!y(b))return{};if(Ec)return Ec(b);a.prototype=b;b=new a;a.prototype=k;return b}}();f.prototype=Aa.prototype;f.prototype.constructor=f;E.prototype=Ja(Aa.prototype);E.prototype.constructor=E;q.prototype=Ja(Aa.prototype);q.prototype.constructor=q;P.prototype.clear=function(){this.__data__=
ua?ua(null):{};this.size=0};P.prototype["delete"]=function(a){a=this.has(a)&&delete this.__data__[a];this.size-=a?1:0;return a};P.prototype.get=function(a){var b=this.__data__;return ua?(a=b[a],"__lodash_hash_undefined__"===a?k:a):w.call(b,a)?b[a]:k};P.prototype.has=function(a){var b=this.__data__;return ua?b[a]!==k:w.call(b,a)};P.prototype.set=function(a,b){var c=this.__data__;this.size+=this.has(a)?0:1;c[a]=ua&&b===k?"__lodash_hash_undefined__":b;return this};J.prototype.clear=function(){this.__data__=
[];this.size=0};J.prototype["delete"]=function(a){var b=this.__data__;a=Da(b,a);if(0>a)return!1;a==b.length-1?b.pop():Pd.call(b,a,1);--this.size;return!0};J.prototype.get=function(a){var b=this.__data__;a=Da(b,a);return 0>a?k:b[a][1]};J.prototype.has=function(a){return-1<Da(this.__data__,a)};J.prototype.set=function(a,b){var c=this.__data__,d=Da(c,a);0>d?(++this.size,c.push([a,b])):c[d][1]=b;return this};K.prototype.clear=function(){this.size=0;this.__data__={hash:new P,map:new (sa||J),string:new P}};
K.prototype["delete"]=function(a){a=La(this,a)["delete"](a);this.size-=a?1:0;return a};K.prototype.get=function(a){return La(this,a).get(a)};K.prototype.has=function(a){return La(this,a).has(a)};K.prototype.set=function(a,b){var c=La(this,a),d=c.size;c.set(a,b);this.size+=c.size==d?0:1;return this};X.prototype.add=X.prototype.push=function(a){this.__data__.set(a,"__lodash_hash_undefined__");return this};X.prototype.has=function(a){return this.__data__.has(a)};F.prototype.clear=function(){this.__data__=
new J;this.size=0};F.prototype["delete"]=function(a){var b=this.__data__;a=b["delete"](a);this.size=b.size;return a};F.prototype.get=function(a){return this.__data__.get(a)};F.prototype.has=function(a){return this.__data__.has(a)};F.prototype.set=function(a,b){var c=this.__data__;if(c instanceof J){var d=c.__data__;if(!sa||199>d.length)return d.push([a,b]),this.size=++c.size,this;c=this.__data__=new K(d)}c.set(a,b);this.size=c.size;return this};var Y=function(a,b){return function(c,d){if(null==c)return c;
if(!L(c))return a(c,d);for(var e=c.length,g=b?e:-1,f=Object(c);(b?g--:++g<e)&&!1!==d(f[g],g,f););return c}}(Ga),Zc=function(a){return function(b,c,d){var e=-1,g=Object(b);d=d(b);for(var f=d.length;f--;){var h=d[a?f:++e];if(!1===c(g[h],h,g))break}return b}}(),Gc=Ta?function(a,b){Ta.set(a,b);return a}:ba,Wd=Ea?function(a,b){return Ea(a,"toString",{configurable:!0,enumerable:!1,value:xc(b),writable:!0})}:ba,Xd=ca&&1/za(new ca([,-0]))[1]==na?function(a){return new ca(a)}:nb,cc=Ta?function(a){return Ta.get(a)}:
nb,gb=tb?function(a){if(null==a)return[];a=Object(a);return wa(tb(a),function(b){return Fc.call(a,b)})}:ob,ac=tb?function(a){for(var b=[];a;)W(b,gb(a)),a=jc(a);return b}:ob,A=Q;if(ub&&"[object DataView]"!=A(new ub(new ArrayBuffer(1)))||sa&&"[object Map]"!=A(new sa)||vb&&"[object Promise]"!=A(vb.resolve())||ca&&"[object Set]"!=A(new ca)||ta&&"[object WeakMap]"!=A(new ta))A=function(a){var b=Q(a);if(a=(a="[object Object]"==b?a.constructor:k)?U(a):"")switch(a){case Rd:return"[object DataView]";case Sd:return"[object Map]";
case Td:return"[object Promise]";case Ud:return"[object Set]";case Vd:return"[object WeakMap]"}return b};var dc=mc(Gc),eb=mc(Wd),md=function(a){a=Oa(a,function(a){500===b.size&&b.clear();return a});var b=a.cache;return a}(function(a){var b=[];46===a.charCodeAt(0)&&b.push("");a.replace(Md,function(a,d,e,g){b.push(e?g.replace(Nd,"$1"):d||a)});return b}),Yd=la(function(a,b){return Pa(a)?Hb(a,$a(b,1,Pa,!0)):[]}),Zd=la(function(a,b){return Pa(a)?Hb(a,b):[]});fc(function(a){var b=a.length,c=b?a[0]:0,d=
this.__wrapped__,e=function(b){for(var c=-1,d=a.length,e=Array(d),g=null==b;++c<d;)e[c]=g?k:db(b,a[c]);return e};if(1<b||this.__actions__.length||!(d instanceof q)||!fa(c))return this.thru(e);d=d.slice(c,+c+(b?1:0));d.__actions__.push({func:Na,args:[e],thisArg:k});return(new E(d,this.__chain__)).thru(function(a){b&&!a.length&&a.push(k);return a})});var $d=function(a){return function(b,c,d){var e=Object(b);if(!L(b)){var g=D(c,3);b=G(b);c=function(a){return g(e[a],a,e)}}c=a(b,c,d);return-1<c?e[g?b[c]:
c]:k}}(oc),ae=function(a,b){return function(c,d){var e=v(c)?Ic:Oc,g=b?b():{};return e(c,a,D(d,2),g)}}(function(a,b,c){w.call(a,c)?a[c].push(b):Ca(a,c,[b])}),Va=function(){return B.Date.now()},Wa=la(function(a,b,c){var d=1;if(c.length){var e=da(c,hb(Wa));d|=32}var g=b,f=c,h=e,n=void 0,q=void 0;c=d&2;if(!c&&"function"!=typeof a)throw new TypeError("Expected a function");b=f?f.length:0;b||(d&=-97,f=h=k);n=n===k?n:H(N(n),0);q=q===k?q:N(q);b-=h?h.length:0;if(d&64){var l=f,p=h;f=h=k}e=c?k:cc(a);l=[a,d,
g,f,h,l,p,void 0,n,q];if(e&&(p=l[1],a=e[1],d=p|a,g=128==a&&8==p||128==a&&256==p&&l[7].length<=e[8]||384==a&&e[7].length<=e[8]&&8==p,131>d||g)){a&1&&(l[2]=e[2],d|=p&1?0:4);if(p=e[3])g=l[3],l[3]=g?Zb(g,p,e[4]):p,l[4]=g?da(l[3],"__lodash_placeholder__"):e[4];if(p=e[5])g=l[5],l[5]=g?$b(g,p,e[6]):p,l[6]=g?da(l[5],"__lodash_placeholder__"):e[6];(p=e[7])&&(l[7]=p);a&128&&(l[8]=null==l[8]?e[8]:S(l[8],e[8]));null==l[9]&&(l[9]=e[9]);l[0]=e[0];l[1]=d}a=l[0];d=l[1];g=l[2];f=l[3];h=l[4];q=l[9]=l[9]===k?c?0:a.length:
H(l[9]-b,0);!q&&d&24&&(d&=-25);c=d&&1!=d?8==d||16==d?od(a,d,q):32!=d&&33!=d||h.length?Ka.apply(k,l):pd(a,d,g,f):nd(a,d,g);return ec((e?Gc:dc)(c,l),a,d)});Oa.Cache=K;var Ba=Mb(function(){return arguments}())?Mb:function(a){return x(a)&&w.call(a,"callee")&&!Fc.call(a,"callee")},v=Array.isArray,ea=Qd||yc,Gb=Bc?ya(Bc):cd,Fb=Cc?ya(Cc):ed,Ya=Dc?ya(Dc):fd,Hc=function(a){return la(function(b,c){var d=-1,e=c.length,g=1<e?c[e-1]:k,f=2<e?c[2]:k;g=3<a.length&&"function"==typeof g?(e--,g):k;f&&lc(c[0],c[1],f)&&
(g=3>e?k:g,e=1);for(b=Object(b);++d<e;)(f=c[d])&&a(b,f,d,g);return b})}(function(a,b){ia(b,ja(b),a)}),be=fc(function(a,b){C(b,function(b){b=Z(b);Ca(a,b,Wa(a[b],a))});return a});f.assignIn=Hc;f.bind=Wa;f.bindAll=be;f.chain=qc;f.compact=function(a){for(var b=-1,c=null==a?0:a.length,d=0,e=[];++b<c;){var g=a[b];g&&(e[d++]=g)}return e};f.constant=xc;f.debounce=function(a,b,c){function d(b){var c=n,d=q;n=q=k;t=b;return l=a.apply(d,c)}function e(a){var c=a-r;a-=t;return r===k||c>=b||0>c||u&&a>=x}function g(){var a=
Va();if(e(a))return f(a);var c=setTimeout;var d=a-t;a=b-(a-r);d=u?S(a,x-d):a;p=c(g,d)}function f(a){p=k;if(w&&n)return d(a);n=q=k;return l}function h(){var a=Va(),c=e(a);n=arguments;q=this;r=a;if(c){if(p===k)return t=a=r,p=setTimeout(g,b),v?d(a):l;if(u)return p=setTimeout(g,b),d(r)}p===k&&(p=setTimeout(g,b));return l}var n,q,l,p,r,t=0,v=!1,u=!1,w=!0;if("function"!=typeof a)throw new TypeError("Expected a function");b=Qa(b)||0;if(y(c)){v=!!c.leading;var x=(u="maxWait"in c)?H(Qa(c.maxWait)||0,b):x;
w="trailing"in c?!!c.trailing:w}h.cancel=function(){p!==k&&clearTimeout(p);t=0;n=r=q=p=k};h.flush=function(){return p===k?l:f(Va())};return h};f.difference=Yd;f.filter=function(a,b){return(v(a)?wa:Ib)(a,D(b,3))};f.flatten=gc;f.groupBy=ae;f.iteratee=ib;f.keys=G;f.keysIn=ja;f.map=function(a,b){return(v(a)?xa:id)(a,D(b,3))};f.memoize=Oa;f.mixin=mb;f.negate=lb;f.property=Pb;f.reject=function(a,b){return(v(a)?wa:Ib)(a,lb(D(b,3)))};f.reverse=kb;f.take=function(a,b,c){if(!a||!a.length)return[];b=c||b===
k?1:N(b);return Tb(a,0,0>b?0:b)};f.tap=function(a,b){b(a);return a};f.thru=Na;f.toArray=tc;f.uniq=function(a){if(a&&a.length)a:{var b=-1,c=Xa,d=a.length,e=!0,f=[];if(200<=d){if(c=Xd(a)){a=za(c);break a}e=!1;c=zb;var m=new X}else m=f;b:for(;++b<d;){var h=a[b],k=h;h=0!==h?h:0;if(e&&k===k){for(var q=m.length;q--;)if(m[q]===k)continue b;f.push(h)}else c(m,k,void 0)||(m!==f&&m.push(k),f.push(h))}a=f}else a=[];return a};f.values=uc;f.without=Zd;f.extend=Hc;mb(f,f);f.eq=ha;f.find=$d;f.findIndex=oc;f.forEach=
rc;f.get=db;f.has=function(a,b){return null!=a&&ic(a,b,$c)};f.hasIn=Rb;f.identity=ba;f.isArguments=Ba;f.isArray=v;f.isArrayLike=L;f.isArrayLikeObject=Pa;f.isBuffer=ea;f.isFunction=ka;f.isLength=Ha;f.isMap=Gb;f.isObject=y;f.isObjectLike=x;f.isSet=Fb;f.isString=sc;f.isSymbol=ma;f.isTypedArray=Ya;f.last=pc;f.stubArray=ob;f.stubFalse=yc;f.noop=nb;f.now=Va;f.reduce=function(a,b,c){var d=v(a)?xb:Mc,e=3>arguments.length;return d(a,D(b,4),c,e,Y)};f.some=function(a,b,c){var d=v(a)?yb:ld;c&&lc(a,b,c)&&(b=k);
return d(a,D(b,3))};f.toFinite=vc;f.toInteger=N;f.toNumber=Qa;f.toString=Xb;f.each=rc;mb(f,function(){var a={};Ga(f,function(b,c){w.call(f.prototype,c)||(a[c]=b)});return a}(),{chain:!1});f.VERSION="4.17.5";Wa.placeholder=f;C(["drop","take"],function(a,b){q.prototype[a]=function(c){c=c===k?1:H(N(c),0);var d=this.__filtered__&&!b?new q(this):this.clone();d.__filtered__?d.__takeCount__=S(c,d.__takeCount__):d.__views__.push({size:S(c,4294967295),type:a+(0>d.__dir__?"Right":"")});return d};q.prototype[a+
"Right"]=function(b){return this.reverse()[a](b).reverse()}});C(["filter","map","takeWhile"],function(a,b){var c=b+1,d=1==c||3==c;q.prototype[a]=function(a){var b=this.clone();b.__iteratees__.push({iteratee:D(a,3),type:c});b.__filtered__=b.__filtered__||d;return b}});C(["head","last"],function(a,b){var c="take"+(b?"Right":"");q.prototype[a]=function(){return this[c](1).value()[0]}});C(["initial","tail"],function(a,b){var c="drop"+(b?"":"Right");q.prototype[a]=function(){return this.__filtered__?new q(this):
this[c](1)}});q.prototype.compact=function(){return this.filter(ba)};q.prototype.find=function(a){return this.filter(a).head()};q.prototype.findLast=function(a){return this.reverse().find(a)};q.prototype.invokeMap=la(function(a,b){return"function"==typeof a?new q(this):this.map(function(c){var d=a;d=bb(d,c);c=2>d.length?c:ab(c,Tb(d,0,-1));d=null==c?c:c[Z(pc(d))];return null==d?k:va(d,c,b)})});q.prototype.reject=function(a){return this.filter(lb(D(a)))};q.prototype.slice=function(a,b){a=N(a);var c=
this;if(c.__filtered__&&(0<a||0>b))return new q(c);0>a?c=c.takeRight(-a):a&&(c=c.drop(a));b!==k&&(b=N(b),c=0>b?c.dropRight(-b):c.take(b-a));return c};q.prototype.takeRightWhile=function(a){return this.reverse().takeWhile(a).reverse()};q.prototype.toArray=function(){return this.take(4294967295)};Ga(q.prototype,function(a,b){var c=/^(?:filter|find|map|reject)|While$/.test(b),d=/^(?:head|last)$/.test(b),e=f[d?"take"+("last"==b?"Right":""):b],g=d||/^find/.test(b);e&&(f.prototype[b]=function(){var b=this.__wrapped__,
h=d?[1]:arguments,n=b instanceof q,t=h[0],l=n||v(b),p=function(a){a=e.apply(f,W([a],h));return d&&r?a[0]:a};l&&c&&"function"==typeof t&&1!=t.length&&(n=l=!1);var r=this.__chain__,u=!!this.__actions__.length;t=g&&!r;n=n&&!u;if(!g&&l)return b=n?b:new q(this),b=a.apply(b,h),b.__actions__.push({func:Na,args:[p],thisArg:k}),new E(b,r);if(t&&n)return a.apply(this,h);b=this.thru(p);return t?d?b.value()[0]:b.value():b})});C("pop push shift sort splice unshift".split(" "),function(a){var b=rb[a],c=/^(?:push|sort|unshift)$/.test(a)?
"tap":"thru",d=/^(?:pop|shift)$/.test(a);f.prototype[a]=function(){var a=arguments;if(d&&!this.__chain__){var f=this.value();return b.apply(v(f)?f:[],a)}return this[c](function(c){return b.apply(v(c)?c:[],a)})}});Ga(q.prototype,function(a,b){if(a=f[b]){var c=a.name+"";(pa[c]||(pa[c]=[])).push({name:b,func:a})}});pa[Ka(k,2).name]=[{name:"wrapper",func:k}];q.prototype.clone=function(){var a=new q(this.__wrapped__);a.__actions__=M(this.__actions__);a.__dir__=this.__dir__;a.__filtered__=this.__filtered__;
a.__iteratees__=M(this.__iteratees__);a.__takeCount__=this.__takeCount__;a.__views__=M(this.__views__);return a};q.prototype.reverse=function(){if(this.__filtered__){var a=new q(this);a.__dir__=-1;a.__filtered__=!0}else a=this.clone(),a.__dir__*=-1;return a};q.prototype.value=function(){var a=this.__wrapped__.value(),b=this.__dir__,c=v(a),d=0>b,e=c?a.length:0;var f=0;for(var k=e,h=this.__views__,n=-1,q=h.length;++n<q;){var l=h[n],p=l.size;switch(l.type){case "drop":f+=p;break;case "dropRight":k-=
p;break;case "take":k=S(k,f+p);break;case "takeRight":f=H(f,k-p)}}h=k;k=h-f;f=d?h:f-1;h=this.__iteratees__;n=h.length;q=0;l=S(k,this.__takeCount__);if(!c||!d&&e==k&&l==k)return Wb(a,this.__actions__);c=[];a:for(;k--&&q<l;){f+=b;d=-1;for(e=a[f];++d<n;){var r=h[d];p=r.iteratee;r=r.type;p=p(e);if(2==r)e=p;else if(!p)if(1==r)continue a;else break a}c[q++]=e}return c};f.prototype.chain=function(){return qc(this)};f.prototype.commit=function(){return new E(this.value(),this.__chain__)};f.prototype.next=
function(){this.__values__===k&&(this.__values__=tc(this.value()));var a=this.__index__>=this.__values__.length,b=a?k:this.__values__[this.__index__++];return{done:a,value:b}};f.prototype.plant=function(a){for(var b,c=this;c instanceof Aa;){var d=Cb(c);d.__index__=0;d.__values__=k;b?e.__wrapped__=d:b=d;var e=d;c=c.__wrapped__}e.__wrapped__=a;return b};f.prototype.reverse=function(){var a=this.__wrapped__;return a instanceof q?(this.__actions__.length&&(a=new q(this)),a=a.reverse(),a.__actions__.push({func:Na,
args:[kb],thisArg:k}),new E(a,this.__chain__)):this.thru(kb)};f.prototype.toJSON=f.prototype.valueOf=f.prototype.value=function(){return Wb(this.__wrapped__,this.__actions__)};f.prototype.first=f.prototype.head;ra&&(f.prototype[ra]=Dd);"function"==typeof define?(B.__jira_integration_plugin_lodash__=f,define("jira-integration-plugin/custom-lodash",function(){return f})):Ra?((Ra.exports=f)._=f,pb._=f):B.__jira_integration_plugin_lodash__=f}).call(this);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.integration.jira.jira-integration-plugin:fields', location = '/fields/fields.soy' */
// This file was automatically generated from fields.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace jiraIntegration.templates.fields.
 */

if (typeof jiraIntegration == 'undefined') { var jiraIntegration = {}; }
if (typeof jiraIntegration.templates == 'undefined') { jiraIntegration.templates = {}; }
if (typeof jiraIntegration.templates.fields == 'undefined') { jiraIntegration.templates.fields = {}; }


jiraIntegration.templates.fields.stringField = function(opt_data, opt_ignored) {
  return '' + jiraIntegration.templates.fields.fieldWithExtraAttributes(soy.$$augmentMap(opt_data, {extraFieldClasses: 'long-field'}));
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.stringField.soyTemplateName = 'jiraIntegration.templates.fields.stringField';
}


jiraIntegration.templates.fields.textareaField = function(opt_data, opt_ignored) {
  return '<div class="field-group jira-field' + ((opt_data.extraClasses) ? ' ' + soy.$$escapeHtml(opt_data.extraClasses) : '') + '" data-jira-type="' + soy.$$escapeHtml(opt_data.jiraType) + '"><label for="' + soy.$$escapeHtml(opt_data.name) + '">' + soy.$$escapeHtml(opt_data.labelText) + ((opt_data.isRequired) ? '<span class="aui-icon icon-required"></span>' : '') + '</label><textarea rows="3" id="' + soy.$$escapeHtml(opt_data.name) + '" class="textarea long-field" data-name="' + soy.$$escapeHtml(opt_data.name) + '" name="' + soy.$$escapeHtml(opt_data.name) + '"' + ((opt_data.extraAttributes) ? ' ' + aui.renderExtraAttributes(opt_data) : '') + '>' + soy.$$escapeHtml(opt_data.value) + '</textarea>' + jiraIntegration.templates.fields.errors(opt_data) + '</div>';
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.textareaField.soyTemplateName = 'jiraIntegration.templates.fields.textareaField';
}


jiraIntegration.templates.fields.arrayField = function(opt_data, opt_ignored) {
  return '' + jiraIntegration.templates.fields.fieldWithExtraAttributes(soy.$$augmentMap(opt_data, {extraFieldClasses: 'long-field'}));
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.arrayField.soyTemplateName = 'jiraIntegration.templates.fields.arrayField';
}


jiraIntegration.templates.fields.numberField = function(opt_data, opt_ignored) {
  return '' + jiraIntegration.templates.fields.fieldWithExtraAttributes(soy.$$augmentMap(opt_data, {extraFieldClasses: 'medium-field'}));
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.numberField.soyTemplateName = 'jiraIntegration.templates.fields.numberField';
}


jiraIntegration.templates.fields.allowedValuesField = function(opt_data, opt_ignored) {
  return '' + ((opt_data.options.length) ? jiraIntegration.templates.fields.fieldWithExtraAttributes(soy.$$augmentMap(opt_data, {type: 'select'})) : jiraIntegration.templates.fields.fieldWithExtraAttributes(soy.$$augmentMap(opt_data, {type: 'value', value: 'None'})));
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.allowedValuesField.soyTemplateName = 'jiraIntegration.templates.fields.allowedValuesField';
}


jiraIntegration.templates.fields.timeTrackingField = function(opt_data, opt_ignored) {
  return '' + jiraIntegration.templates.fields.fieldWithExtraAttributes(soy.$$augmentMap(opt_data, {extraFieldClasses: 'medium-field'}));
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.timeTrackingField.soyTemplateName = 'jiraIntegration.templates.fields.timeTrackingField';
}


jiraIntegration.templates.fields.radioField = function(opt_data, opt_ignored) {
  return '' + aui.form.radioField(soy.$$augmentMap(opt_data, {legendContent: opt_data.labelText, extraAttributes: {'data-name': opt_data.name, name: opt_data.name, 'data-jira-type': opt_data.jiraType}, extraClasses: 'jira-field'}));
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.radioField.soyTemplateName = 'jiraIntegration.templates.fields.radioField';
}


jiraIntegration.templates.fields.unrenderableTypeField = function(opt_data, opt_ignored) {
  return '<div class="field-group jira-field jira-field-unrenderable' + ((opt_data.extraClasses) ? ' ' + soy.$$escapeHtml(opt_data.extraClasses) : '') + '"><label>' + soy.$$escapeHtml(opt_data.labelText) + ((opt_data.isRequired) ? '<span class="aui-icon icon-required"></span>' : '') + '</label>' + aui.form.value({content: opt_data.reasonContent}) + jiraIntegration.templates.fields.errors(opt_data) + '</div>';
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.unrenderableTypeField.soyTemplateName = 'jiraIntegration.templates.fields.unrenderableTypeField';
}


jiraIntegration.templates.fields.dateField = function(opt_data, opt_ignored) {
  return '' + jiraIntegration.templates.fields.fieldWithExtraAttributes(soy.$$augmentMap(opt_data, {extraFieldClasses: 'medium-field'}));
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.dateField.soyTemplateName = 'jiraIntegration.templates.fields.dateField';
}


jiraIntegration.templates.fields.checkboxField = function(opt_data, opt_ignored) {
  return '' + aui.form.checkboxField(soy.$$augmentMap(opt_data, {legendContent: opt_data.labelText, extraAttributes: {'data-name': opt_data.name, name: opt_data.name, 'data-jira-type': opt_data.jiraType}, extraClasses: 'jira-field'}));
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.checkboxField.soyTemplateName = 'jiraIntegration.templates.fields.checkboxField';
}


jiraIntegration.templates.fields.select2WithIconField = function(opt_data, opt_ignored) {
  var output = '<div class="field-group jira-field' + ((opt_data.extraClasses) ? ' ' + soy.$$escapeHtml(opt_data.extraClasses) : '') + '" data-jira-type="' + soy.$$escapeHtml(opt_data.jiraType) + '"><label for="' + soy.$$escapeHtml(opt_data.name) + '">' + soy.$$escapeHtml(opt_data.labelText) + ((opt_data.isRequired) ? '<span class="aui-icon icon-required"></span>' : '') + '</label><select id="' + soy.$$escapeHtml(opt_data.name) + '" class="medium-field" name="' + soy.$$escapeHtml(opt_data.name) + '" data-name="' + soy.$$escapeHtml(opt_data.name) + '"' + ((opt_data.extraAttributes) ? ' ' + aui.renderExtraAttributes(opt_data) : '') + '>';
  var optionList112 = opt_data.options;
  var optionListLen112 = optionList112.length;
  for (var optionIndex112 = 0; optionIndex112 < optionListLen112; optionIndex112++) {
    var optionData112 = optionList112[optionIndex112];
    output += '<option value="' + soy.$$escapeHtml(optionData112.value) + '" ' + ((optionData112.selected) ? 'selected' : '') + ' data-icon-url="' + soy.$$escapeHtml(optionData112.iconUrl) + '">' + soy.$$escapeHtml(optionData112.text) + '</option>';
  }
  output += '</select>' + jiraIntegration.templates.fields.errors(opt_data) + '</div>';
  return output;
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.select2WithIconField.soyTemplateName = 'jiraIntegration.templates.fields.select2WithIconField';
}


jiraIntegration.templates.fields.select2WithIconOption = function(opt_data, opt_ignored) {
  return ((opt_data.iconUrl) ? aui.avatar.avatar({avatarImageUrl: opt_data.iconUrl, size: 'xsmall', isProject: opt_data.isProject, extraClasses: 'select-option-image', tagName: 'span'}) : '') + '<span class="select-option" title="' + soy.$$escapeHtml(opt_data.optionValue) + '">' + soy.$$escapeHtml(opt_data.optionValue) + '</span>';
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.select2WithIconOption.soyTemplateName = 'jiraIntegration.templates.fields.select2WithIconOption';
}


jiraIntegration.templates.fields.labelFieldResult = function(opt_data, opt_ignored) {
  return '' + ((opt_data.label.isNew) ? soy.$$escapeHtml(AJS.format('\x22{0}\x22 - (New label)',opt_data.label.labelName)) : soy.$$escapeHtml(opt_data.label.labelName));
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.labelFieldResult.soyTemplateName = 'jiraIntegration.templates.fields.labelFieldResult';
}


jiraIntegration.templates.fields.userOptionSelect = function(opt_data, opt_ignored) {
  var output = '';
  var userOption__soy150 = '' + soy.$$escapeHtml(opt_data.displayName) + ((! opt_data.isSystemOption) ? ' - (' + soy.$$escapeHtml(opt_data.name) + ')' : '');
  output += '<span data-value="' + soy.$$escapeHtml(opt_data.name) + '" title="' + soy.$$filterNoAutoescape(userOption__soy150) + '">' + soy.$$filterNoAutoescape(userOption__soy150) + '</span>';
  return output;
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.userOptionSelect.soyTemplateName = 'jiraIntegration.templates.fields.userOptionSelect';
}


jiraIntegration.templates.fields.sprintSelect = function(opt_data, opt_ignored) {
  return '<span title="' + soy.$$escapeHtml(opt_data.name) + '">' + soy.$$escapeHtml(opt_data.name) + '<span class="sprint-detail">' + ((opt_data.state == 'FUTURE') ? soy.$$escapeHtml(AJS.format('(Future sprint in {0})',opt_data.board)) : '') + ((opt_data.state == 'ACTIVE') ? soy.$$escapeHtml(AJS.format('(Active sprint in {0})',opt_data.board)) : '') + '</span></span>';
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.sprintSelect.soyTemplateName = 'jiraIntegration.templates.fields.sprintSelect';
}


jiraIntegration.templates.fields.epicSelect = function(opt_data, opt_ignored) {
  return '<span title="' + soy.$$escapeHtml(opt_data.name) + ' (' + soy.$$escapeHtml(opt_data.key) + ')">' + soy.$$escapeHtml(opt_data.name) + ((opt_data.key) ? '<span class="epic-detail">' + soy.$$escapeHtml(opt_data.key) + '</span>' : '') + '</span>';
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.epicSelect.soyTemplateName = 'jiraIntegration.templates.fields.epicSelect';
}


jiraIntegration.templates.fields.errors = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  var output = '';
  if (opt_data.errorTexts) {
    var errorList195 = opt_data.errorTexts;
    var errorListLen195 = errorList195.length;
    for (var errorIndex195 = 0; errorIndex195 < errorListLen195; errorIndex195++) {
      var errorData195 = errorList195[errorIndex195];
      output += '<div class="error">' + soy.$$escapeHtml(errorData195) + '</div>';
    }
  }
  return output;
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.errors.soyTemplateName = 'jiraIntegration.templates.fields.errors';
}


jiraIntegration.templates.fields.fieldWithExtraAttributes = function(opt_data, opt_ignored) {
  var output = '<div class="field-group jira-field' + ((opt_data.extraClasses) ? ' ' + soy.$$escapeHtml(opt_data.extraClasses) : '') + '" data-jira-type=' + soy.$$escapeHtml(opt_data.jiraType) + '>' + aui.form.label({forField: opt_data.name, isRequired: opt_data.isRequired, content: '' + soy.$$escapeHtml(opt_data.labelText)});
  switch (opt_data.type) {
    case 'select':
      output += aui.form.select({id: opt_data.name, name: opt_data.name, labelContent: '' + soy.$$escapeHtml(opt_data.labelText), options: opt_data.options, isRequired: opt_data.isRequired, isMultiple: opt_data.isMultiple, extraAttributes: soy.$$augmentMap({'data-name': opt_data.name}, opt_data.extraAttributes), extraClasses: opt_data.extraFieldClasses});
      break;
    case 'value':
      output += aui.form.value({id: opt_data.name, content: '' + soy.$$escapeHtml(opt_data.value)});
      break;
    default:
      output += aui.form.input({id: opt_data.name, name: opt_data.name, type: 'text', value: opt_data.value, extraAttributes: soy.$$augmentMap({'data-name': opt_data.name}, opt_data.extraAttributes), extraClasses: opt_data.extraFieldClasses});
  }
  output += jiraIntegration.templates.fields.errors(opt_data) + '</div>';
  return output;
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.fieldWithExtraAttributes.soyTemplateName = 'jiraIntegration.templates.fields.fieldWithExtraAttributes';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.integration.jira.jira-integration-plugin:fields', location = '/fields/fields.js' */
define("jira-integration-plugin/fields",["jquery","jira-integration-plugin/custom-lodash","jira-integration-plugin/label-picker"],function(h,g,W){function D(a,b,c,d){var e=b.schema.system||"customfield_"+b.schema.customId,k=b.schema.system||b.schema.custom||b.schema.customId,l=p[k],E=!(!l||l.canRender&&!l.canRender(b)),F=!(!b.operations||!b.operations.length);l=E&&F?l:X;return l.getContext({labelText:b.name,name:e,isRequired:b.required,value:c[e],errorTexts:d[e],jiraType:k,isRenderable:E,hasOperations:F,
handler:l,extraAttributes:b.required&&{"data-aui-validation-field":"",required:!0}},b,a,c)}function n(a,b,c){var d=a.name;a.value=(h.isPlainObject(a.value)?a.value.name:a.value)||c&&c.fields[d]||b&&b.defaultValue||"";return a}function t(a){return a.val()}function G(a){a=a.val();return/\d/.test(a)&&/^-?\d*\.?\d*$/.test(a)?Number(a):a||null}function H(a,b,c){var d=a.name;a.value=a.value&&a.value.join(",")||c&&c.fields[d]&&c.fields[d].join(",")||b&&b.defaultValue&&b.defaultValue.join(" ");return a}function I(a){return g.map(a.val().split(","),
h.trim)}function J(a,b,c){function d(a){return Array.isArray(a)?a.map(function(a){return a.name||a.id}):[a.name||a.id]}var e=a.name,k=a.value;c=c&&c.fields[e];e=b&&b.defaultValue;var l=k?d(k):c?d(c):e?d(e):[];a.options=g.map(b.allowedValues,function(a){return{value:a.id,text:a.name||a.value,selected:l.includes(a.name||a.id)}});b.required||"option"!==b.schema.type||a.options.unshift({value:-1,text:"None"});a.isMultiple=b.operations.includes("add");delete a.value;
return a}function x(a,b){var c=b.val(),d=function(b){var c={};c[a]=b;return c};return b.attr("multiple")?Array.isArray(c)?g.map(c,d):[d(c)]:d(c)}function K(a,b,c){var d=a.name;a.value=a.value&&a.value.name||c&&c.fields[d]&&c.fields[d].name||("assignee"===q(b)?-1:"")||b&&b.defaultValue&&b.defaultValue.name;a.extraClasses="array"===b.schema.type?"multi-user-picker":"single-user-picker";return a}function L(a,b,c){var d=a.value||c&&c.fields[a.name]||b&&b.defaultValue;a.fields=g.map(b.allowedValues,function(a){return{id:a.id,
value:a.id,labelText:a.name||a.value,isChecked:Array.isArray(d)?d.some(function(b){return b.id===a.id}):d&&d.id===a.id}});delete a.value;return a}function M(a){return a.find("input:checked").toArray().map(function(a){a=h(a);return{id:a.attr("value"),value:a.parent().find("label").text()}})}function y(a,b,c,d,e){var k=a.find("input"),l=a.attr("name");k.removeClass("text").removeClass("long-field").addClass("medium-long-field");k.auiSelect2(h.extend({minimumInputLength:1,id:l,name:l,query:function(a){r(b,
c,a.term,d).done(function(b){a.callback({results:b})})}},e));(e=k.auiSelect2("data"))&&-1!==e.id&&k.auiSelect2("val",e.id);a.find("div.aui-select2-container").addClass("jira-select2-drop-box")}function N(a,b,c,d,e){e=h.extend({},e,{multiple:"com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker"===c,formatResult:function(a){return f.fields.userOptionSelect({name:a.id,displayName:a.text,isSystemOption:!!a.isSystemOption})}});y(a,b,c,d,e)}function r(a,b,c,d){a=h.extend({restType:b,issueKey:d&&
d.key||"",term:c},a);return h.ajax({type:"POST",timeout:0,contentType:"application/json",dataType:"json",url:AJS.contextPath()+"/rest/jira-integration/latest/fields/autocomplete",data:JSON.stringify(a)})}function O(a){var b;a.id&&(b=h(a.element).attr("data-icon-url"));return f.fields.select2WithIconOption({optionValue:a.text,iconUrl:b})}function z(a){return(a=a.auiSelect2("data"))&&-1===a.id?void 0:a}function q(a){return a.schema?a.schema.system||a.schema.custom||a.schema.customId:a}function A(a){return p[q(a)]}
function P(a){return(a=Q(a))&&A(a)}function Q(a){return a.closest(".jira-field").attr("data-jira-type")}function Y(a,b){return h.ajax({type:"GET",timeout:0,url:AJS.contextPath()+"/rest/jira-integration/1.0/servers/"+a.serverId+"/projects/"+a.projectKey+"/issue-types/"+a.issueType+"/fields-meta"}).pipe(function(a){var c=[];g.each(a.fields,function(a){var d=q(a);a.required&&!b.excludedFields.includes(d)&&c.push(a)});return c})}function R(a,b,c){var d=Q(a),e=d&&A(d);(e=e&&e.behavior)&&e(a,b,d,c)}function S(a){var b=
P(a);return b&&b.getValue&&b.getValue(a)}function u(a,b){return function(c,d){c=a[c.attr("id")];d(c||b)}}var f=window.jiraIntegration.templates,v={template:f.fields.stringField,getContext:n,getValue:t},Z={template:f.fields.stringField,getContext:function(a,b,c){var d={"data-aui-validation-field":"",pattern:"([a-zA-Z][a-zA-Z0-9-+.]*://.+)|^$","data-aui-validation-pattern-msg":"Enter a valid URL scheme"};return h.extend(!0,{},n(a,b,c),{extraAttributes:d})},getValue:t},aa=
{template:f.fields.stringField,getContext:K,getInternalValue:z,getValue:function(a){a=a.val();if("-1"!==a)return{name:a}},behavior:function(a,b,c,d){var e={minimumInputLength:0,initSelection:u(b,{id:-1,text:"Automatic",isSystemOption:!0}),query:function(a){function e(b){1===a.page&&(a.element.prop("required")||b.unshift({id:"",text:"Unassigned",isSystemOption:!0}),b.unshift({id:-1,text:"Automatic",isSystemOption:!0}));
a.callback({results:b})}0<a.term.length?r(b,c,a.term,d).done(e):e([])}};N(a,b,c,d,e)}},B={template:f.fields.stringField,getContext:K,getValue:function(a){var b=function(a){return{name:a}},c=a.val();a=a.closest(".jira-field").is(".multi-user-picker");return c?a?g.map(c.split(","),b):b(c):a?[]:null},behavior:function(a,b,c,d){var e=a.find(".long-field").attr("value")||"";e={formatInputTooShort:function(){return "Find users..."},initSelection:u(b,{id:-1,text:e,isSystemOption:!1})};
N(a,b,c,d,e)}},ba={template:f.fields.arrayField,getContext:H,getValue:I,behavior:function(a,b,c,d){a=a.find("input");W.build(a,function(a){return r(b,c,a,d)})}},C={template:f.fields.textareaField,getContext:n,getValue:t},ca={template:f.fields.numberField,getContext:function(a,b,c){var d={"data-aui-validation-field":"",pattern:"(([0-9]*[.])?[0-9]+)|^$","data-aui-validation-pattern-msg":"Enter a valid number"};return h.extend(!0,{},n(a,b,c),{extraAttributes:d})},getValue:G},
T={template:f.fields.arrayField,getContext:H,getValue:I},m={template:f.fields.allowedValuesField,getContext:J,getValue:g.bind(x,null,"id"),behavior:function(a){a.find("select[multiple]").auiSelect2()}},U={template:f.fields.allowedValuesField,getContext:J,getValue:g.bind(x,null,"id")},da={template:f.fields.timeTrackingField,getContext:function(a,b,c){b={"data-aui-validation-field":"",pattern:"(([0-9]+w|[0-9]+d|[0-9]+m|[0-9]+h|[0-9]+)\\s*)*","data-aui-validation-pattern-msg":"Enter a valid time estimate (eg. 3w 4d 12h)"};
a.value=a.value&&a.value.remainingEstimate||c&&c.fields[name]&&c.fields[name].remainingEstimate||"";return h.extend(!0,{},a,{extraAttributes:b})},getValue:function(a){return{remainingEstimate:a.val()}}},V={template:f.fields.dateField,getContext:function(a,b,c){var d={"data-aui-validation-field":"",pattern:"^([0-9]{2,4}-(0?[1-9]|10|11|12)-([0-2]?[1-9]|10|20|30|31))$|^$","data-aui-validation-pattern-msg":"Enter a valid date"};return h.extend(!0,{},n(a,b,c),{extraAttributes:d})},
getValue:function(a){a=a.val();return""===a?null:a},behavior:function(a){var b=a.find("input");navigator.userAgent.match(/Trident/)&&"5.3.5">AJS.version?(a="placeholder"in document.createElement("input"),b.attr("placeholder","YYYY-MM-DD"),a||b.on("focus",function(){b.val()===b.attr("placeholder")&&b.val("")}).on("blur",function(){""===b.val()&&b.val(b.attr("placeholder"))}).blur()):WRM.require("wr!com.atlassian.auiplugin:aui-date-picker").done(function(){b.datePicker({overrideBrowserDefault:!0})})}},
ea={template:f.fields.select2WithIconField,getContext:function(a,b,c){var d=a.name,e=a.value&&a.value.id||b&&b.defaultValue&&b.defaultValue.id||"",k=a.value&&a.value.name||c&&c.fields&&c.fields[d]&&c.fields[d].name||b&&b.defaultValue&&b.defaultValue.id||"";delete a.value;a.options=g.map(b.allowedValues,function(a){return{value:a.id,text:a.name,selected:k===a.name||e===a.id,iconUrl:a.iconUrl}});return a},getValue:g.bind(x,null,"id"),behavior:function(a,b,c,d){h.fn.auiSelect2?(a=a.find("select"),a.addClass("jira-select2-drop-box"),
a.auiSelect2({hasAvatar:!0,minimumResultsForSearch:-1,formatSelection:O,formatResult:O})):AJS.log("AUI version 5.2 or greater is required as this plugin needs the .auiSelect2() jQuery plugin.")}},X={template:f.fields.unrenderableTypeField,getContext:function(a,b,c){a.reasonContent=a.isRenderable?a.hasOperations?null:c?AJS.format("{0}Edit{1} this field in Jira.",'\x3ca href\x3d"'+c.url+'"\x3e',"\x3c/a\x3e"):AJS.escapeHtml("Edit this field in Jira after creation."):c?AJS.format("{0}Edit{1} this field in Jira.",
'\x3ca href\x3d"'+c.url+'"\x3e',"\x3c/a\x3e"):AJS.escapeHtml("Edit this field in Jira after creation.");return a}},p={"com.pyxis.greenhopper.jira:gh-epic-label":v,string:v,summary:v,"com.atlassian.jira.plugin.system.customfieldtypes:textfield":v,"com.atlassian.jira.plugin.system.customfieldtypes:url":Z,environment:C,"com.atlassian.jira.plugin.system.customfieldtypes:textarea":C,description:C,"com.atlassian.jira.plugin.system.customfieldtypes:float":ca,array:T,"com.atlassian.jira.plugin.system.customfieldtypes:labels":T,
labels:ba,priority:ea,resolution:m,fixVersions:m,versions:m,components:m,security:m,"com.atlassian.jira.plugin.system.customfieldtypes:version":m,"com.atlassian.jira.plugin.system.customfieldtypes:multiversion":m,"com.atlassian.jira.plugin.system.customfieldtypes:project":m,assignee:aa,reporter:B,"com.atlassian.jira.plugin.system.customfieldtypes:userpicker":B,"com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker":B,timetracking:da,duedate:V,"com.atlassian.jira.plugin.system.customfieldtypes:datepicker":V,
"com.atlassian.jira.plugin.system.customfieldtypes:multiselect":U,"com.atlassian.jira.plugin.system.customfieldtypes:select":U,"com.pyxis.greenhopper.jira:gh-sprint":{template:f.fields.stringField,getContext:n,getInternalValue:z,getValue:G,behavior:function(a,b,c,d){var e={minimumInputLength:0,formatResult:function(a){return f.fields.sprintSelect({name:a.text,state:a.state,board:a.board})},query:function(a){r(b,c,a.term,d).done(function(b){var c=g.groupBy(b,function(a){return a.suggestion?"suggestions":
"all"});b=["suggestions","all"].filter(function(a){return c[a]&&0<c[a].length}).map(function(a){return{text:"suggestions"===a?"Suggestions":"All sprints",children:c[a]}});a.callback({results:g.compact(b)})})},initSelection:u(b,{id:-1,text:"Select a sprint"})};return y(a,b,c,d,e)}},"com.pyxis.greenhopper.jira:gh-epic-link":{template:f.fields.stringField,getContext:n,getInternalValue:z,getValue:function(a){return(a=
t(a))&&""!==a?a:void 0},behavior:function(a,b,c,d){var e={minimumInputLength:0,formatResult:function(a){return f.fields.epicSelect({name:a.text,key:a.id})},query:function(a){r(b,c,a.term,d).done(function(b){var c=g.uniq(b.map(function(a){return a.list})).map(function(a){return{text:a,children:b.filter(function(b){return b.list===a})}});a.callback({results:c})})},initSelection:u(b,{id:-1,text:"Select an epic"})};return y(a,b,c,d,e)}},"com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes":{template:f.fields.checkboxField,
getContext:L,getValue:M},"com.atlassian.jira.plugin.system.customfieldtypes:radiobuttons":{template:f.fields.radioField,getContext:L,getValue:function(a){a=M(a);return 1===a.length?a[0]:null}}},fa={ignoreFieldsWithDefaultValue:!1},w={addFieldHandler:function(a,b){g.has(p,a)&&console&&console.warn&&console.warn("Redefining handler for type "+a+".");p[a]=b},getFieldHandler:A,getFieldType:q,isKnownRestType:function(a){return p.hasOwnProperty(a)},canRender:function(a){var b=q(a);return(b=p[b])?a.operations&&
a.operations.length&&(!b.canRender||b.canRender(a)):!1},getContext:function(a,b,c,d){return D(a,b,c||{},d||{})},renderField:function(a,b,c,d){a=D(a,b,c||{},d||{});return a.handler.template(a)},getInternalJSON:function(a){var b=P(a);return b&&b.getInternalValue&&b.getInternalValue(a)||S(a)},getJSON:S,attachFieldBehavior:R,attachFieldBehaviors:function(a,b,c){a.find(".jira-field").each(function(a,e){a=h(e);R(a,b,c)})},setFieldError:function(a,b){a.find(".error").remove();b&&(b=f.fields.errors({errorTexts:b}),
a.append(b))},renderCreateRequiredFields:function(a,b,c,d,e){function f(b){d.ignoreFieldsWithDefaultValue&&(b=g.filter(b,function(a){return!a.hasDefaultValue}));var f=g.filter(b,function(a){return!w.canRender(a)});f.length?e&&e(f):(a.html(g.map(b,function(a){return w.renderField(null,a,null,null)}).join("")),w.attachFieldBehaviors(a,{serverId:c.serverId,projectKey:c.projectKey},null))}d=g.extend({},fa,d);d.requiredFields?f(d.requiredFields):Y(c,d).done(f)}};return w});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.integration.jira.jira-integration-plugin:fields', location = '/fields/label-picker.js' */
define("jira-integration-plugin/label-picker",[],function(){var d=window.jiraIntegration.templates;return{build:function(c,e){c.auiSelect2({tags:!0,multiple:!0,tokenSeparators:[","," "],createSearchChoice:function(a){return a?{id:a,text:a,isNew:!0}:null},query:function(a){e(a.term).done(function(b){a.callback({results:b})})},formatResult:function(a){return d.fields.labelFieldResult({label:{labelName:a.text,isNew:a.isNew}})},initSelection:function(a,b){a=c.auiSelect2("val").map(function(a){return{id:a,
text:a}});b(a)}})}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:split_aui.splitchunk.e8173e0382', location = 'aui.chunk.af03fab94a059f2e0c08--6cb64e7c89c7d8ec28b1.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["aui.splitchunk.e8173e0382"],{"3vMk":function(n,t,i){"use strict";i.r(t);i("rSV2"),i("YQ7q"),i("6fSn"),i("Nu/Z"),i("U8Ze")},U8Ze:function(n,t,i){"use strict";i.r(t),i.d(t,"getMessageContainer",(function(){return j})),i.d(t,"appendErrorMessages",(function(){return b})),i.d(t,"appendDescription",(function(){return m})),i.d(t,"errorMessageTemplate",(function(){return T})),i.d(t,"setFieldSpinner",(function(){return y}));var e=i("+x/D"),a=i("TmQU"),r=i("4dFR"),o=(i("tYoR"),i("bPPT"));const c="_aui-form-notification-initialised",u="data-aui-notification-wait",s="data-aui-notification-info",f="data-aui-notification-error",d=[f,"data-aui-notification-success",u,s];function l(n){p(n)||(!function(n){n.addClass(c),m(n)}(n),h(n))}function p(n){return n.hasClass(c)}function m(n,t){t=t||v(n),g(n)===s&&n.after(function(n){if(n.length>1){let t=n.map((n=>"<li>".concat(n,"</li>"))).join("");return'<div class="description"><ul>'.concat(t,"</ul></div>")}return'<div class="description">'.concat(n,"</div>")}(t))}function v(n){var t=g(n),i=t?n.attr(t):"";return""===i?i:function(n){var t;try{t=JSON.parse(n)}catch(i){t=[n]}return t}(i)}function g(n){var t;return d.some((function(i){if(n.is("["+i+"]"))return t=i,!0})),t}function h(n){const t=Object(e.default)(n);if(!p(t))return;const i=g(t);y(t,i===u);const a=v(t);a&&i===f?b(t,a):n.constructor.prototype.hasOwnProperty("jquery")||n.hasAttribute(f)||t.parent().find(".error").remove()}function T(n){let t=n.map((n=>'<li><span class="aui-icon aui-icon-small aui-iconfont-error aui-icon-notification">'.concat(n,"</span>").concat(n,"</li>"))).join("");return'<div class="error"><ul>'.concat(t,"</ul></div>")}function b(n,t){let i=j(n,"error");i.length>0&&i.remove(),n.after(T(t))}function j(n,t){return n.parent().find(".".concat(t))}function y(n,t){t&&!function(n){return n.next("aui-spinner").length>0}(n)?n.after('<aui-spinner class="form-notification-spinner" size="small"></aui-spinner>'):n.parent().find("aui-spinner").remove()}const O=Object(o.getMessageLogger)("data-aui-notification-field attribute",{deprecationType:"ATTRIBUTE",alternativeName:"HTML markup"});Object(r.default)("data-aui-notification-field",{attached:function(n){O(),l(Object(e.default)(n))},attributes:function(){const n={};return d.forEach((function(t){n[t]=h})),n}(),type:r.default.type.ATTRIBUTE}),Object(a.default)("aui/form-notification")}}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:split_aui.component.form-validation', location = 'aui.chunk.0e30fd5e4ee85f841402--48adb1d052b77f1d9571.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["aui.component.form-validation"],{defA:function(a,e,t){"use strict";t.r(e);t("3vMk");var i=t("+x/D"),n=t("U8Ze"),r=t("TmQU"),u=(t("uDDF"),t("HH5i")),c=t("JFi+"),l=["displayfield","watchfield","when","novalidate","state"],s=[];var d={register:function(a,e){var t;if("string"==typeof a)t=a;else{var n=function(a){var e=!1;return a.some((function(a){var t=-1!==i.default.inArray(a,l);return t&&(e=a),t})),e}(a);if(n)return c.warn('Validators cannot be registered with the argument "'+n+'", as it is a reserved argument.'),!1;t="[data-aui-validation-"+a.join("],[data-aui-validation-")+"]"}var r={validatorFunction:e,validatorTrigger:t};return s.push(r),r},validators:function(){return s}};Object(r.default)("aui/form-validation/validator-register",d);var o=d;function f(a){var e=a.el.value.length;let t=0===e;var i=parseInt(a.args("minlength"),10),n=parseInt(a.args("maxlength"),10);if(i&&n&&i===n&&!t&&e!==i){const e=b("exactlength",a.args,[i]);a.invalidate(e)}else if(i&&e<i&&!t){const e=b("minlength",a.args);a.invalidate(e)}else if(n&&e>n){const e=b("maxlength",a.args);a.invalidate(e)}else a.validate()}function v(a){return"password"===a.getAttribute("type")}function g(a,e){var t=a.match(e);return!!t&&a===t[0]}function m(a){var e=b("pattern",a.args);g(a.el.value,new RegExp(a.args("pattern")))?a.validate():a.invalidate(e)}function h(a){var e=b("required",a.args);a.el.value?a.validate():a.invalidate(e)}function p(a){var e=b("validnumber",a.args),t=parseInt(a.el.value,10);if(isNaN(t))a.invalidate(e);else{var i=a.args("min"),n=a.args("max");i&&t<parseInt(i,10)?a.invalidate(b("min",a.args)):n&&t>parseInt(n,10)?a.invalidate(b("max",a.args)):a.validate()}}function b(a,e,t){var i;i=void 0!==u.I18n.keys?u.I18n.keys["aui.validation.message."+a]:k[a];var n=t;t||(n=[e(a)]);var r,c=e(a+"-msg");return r=c?[c].concat(n):[i].concat(n),AJS.format.apply(null,r)}o.register(["maxlength","minlength"],f),o.register("[maxlength],[minlength]",f),o.register(["matchingfield"],(function(a){var e=a.el.value,t=document.getElementById(a.args("matchingfield")),i=t.value,n=b("matchingfield",a.args,[e,i]);(v(a.el)||v(t))&&(n=b("matchingfield-novalue",a.args)),e&&i&&i!==e?a.invalidate(n):a.validate()})),o.register(["doesnotcontain"],(function(a){var e=b("doesnotcontain",a.args);-1===a.el.value.indexOf(a.args("doesnotcontain"))?a.validate():a.invalidate(e)})),o.register(["pattern"],m),o.register("[pattern]",m),o.register(["required"],h),o.register("[required]",h),o.register(["min","max"],p),o.register("[min],[max]",p),o.register(["dateformat"],(function(a){var e=a.args("dateformat"),t=b("dateformat",a.args),i={Y:"[0-9]{4}",y:"[0-9]{2}",m:"(0?[1-9]|10|11|12)",M:"[Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec]",D:"[Mon|Tue|Wed|Thu|Fri|Sat|Sun]",d:"([0-2]?[1-9]|10|20|30|31)"},n=e.split(""),r="";n.forEach((function(a){var e=i.hasOwnProperty(a);r+=e?i[a]:a}));var u=new RegExp(r+"$","i");g(a.el.value,u)?a.validate():a.invalidate(t)})),o.register(["minchecked","maxchecked"],(function(a){var e=Object(i.default)(a.el).find(":checked").length,t=!a.args("minchecked")||e>=a.args("minchecked"),n=!a.args("maxchecked")||e<=a.args("maxchecked"),r=b("minchecked",a.args),u=b("maxchecked",a.args);t&&n?a.validate():t?n||a.invalidate(u):a.invalidate(r)}));var k={minlength:"Must be greater than or equal to {0} characters",maxlength:"Must be fewer than or equal to {0} characters",exactlength:"Must be exactly {0} characters",matchingfield:"{0} and {1} do not match.","matchingfield-novalue":"These fields do not match.",doesnotcontain:"Do not include the phrase {0} in this field",pattern:"This field does not match the required format",required:"This is a required field",validnumber:"Please enter a valid number",min:"Enter a value greater than or equal to  {0}",max:"Enter a value less than or equal to {0}",dateformat:"Enter a valid date",minchecked:"aui.validation.message.minchecked",maxchecked:"aui.validation.message.maxchecked"};Object(r.default)("aui/form-validation/basic-validators");var x=t("bPPT"),I=t("KloK"),O=t("4dFR");const T="data-aui-notification-",w="invalid",j="valid",y="validating",A="unvalidated",D="_aui-form-validation-initialised",E="_aui-internal-field-state-changed";function F(a){(function(a){return a.hasClass(D)})(a)||(!function(a){a.addClass(D),Object(n.appendDescription)(a)}(a),function(a){(function(a){var e,t=function(){a.trigger("aui-stop-typing")};a.on("keyup",(function(){clearTimeout(e),e=setTimeout(t,1500)}))})(a),function(a){var e=S(a,"when"),t=S(a,"watchfield");(t?a.add("#"+t):a).on(e,(function(){J(a)}))}(a)}(a),_(a,A))}function J(a){if(!S(a,"novalidate"))return function(a){!function(a){q(R(a),"none")}(a);var e=function(a){var e=[];return M().forEach((function(t,i){var n=t.validatorTrigger;a.is(n)&&e.push(i)})),e}(a);_(a,y);var t=function(a,e){var t=[];return e.forEach((function(e){var n=M()[e].validatorFunction,r=new i.default.Deferred;n(function(a,e){var t={validate:function(){e.resolve()},invalidate:function(t){_(a,w,t),e.reject()},args:N(a),el:a[0],$el:a};return x.prop(t,"$el",{sinceVersion:"5.9.0",removeInVersion:"10.0.0",alternativeName:"el",extraInfo:"See https://ecosystem.atlassian.net/browse/AUI-3263."}),t}(a,r)),t.push(r)})),t}(a,e),n=i.default.when.apply(i.default,t);return n.done((function(){_(a,j)})),n}(a);_(a,j)}function S(a,e){var t=a.attr("data-aui-validation-"+e);return t||(t={when:"change"}[e]),t}function M(){return o.validators()}function N(a){return function(e){return a.attr("data-aui-validation-"+e)||a.attr(e)}}function _(a,e,t){if(a.attr("data-aui-validation-state",e),e!==A){a.trigger(i.default.Event(E));var r=R(a),u={validating:"wait",invalid:"error",valid:"success"},c=u[e];e===y?function(a){setTimeout((function(){U(a)===y&&(q(a,"wait"),Object(n.setFieldSpinner)(a,!0))}),500)}(a):q(r,c,t)}}function q(a,e,t){const i=function(a){return a.is("[data-aui-notification-wait]")}(a);!function(a){P(a,"wait"),Object(n.setFieldSpinner)(a,!1),P(a,"success")}(a);var r,u;if(!("success"===e&&!i))if("none"===e)P(a,"error");else{const i=a.attr(T+e)||"[]",c=t?(r=t,u=i,JSON.parse(u).concat([r])):[];a.attr(T+e,JSON.stringify(c)),"error"===e&&Object(n.appendErrorMessages)(a,c)}}function P(a,e){a.removeAttr(T+e),"error"===e&&Object(n.getMessageContainer)(a,e).remove()}function R(a){var e=S(a,"displayfield");return void 0===e?a:Object(i.default)("#"+e)}function U(a){return a.attr("data-aui-validation-state")}function V(a,e){e.preventDefault(),a.one(E,(function(){a.trigger("submit")}))}function C(a,e){var t="[data-aui-validation-state="+e+"]";return a.find(t)}Object(i.default)(document).on("submit",(function(a){var e=a.target,t=Object(i.default)(e),n=function(a){return u=a.find("."+D),e=i.default.map(u,(function(a){return U(Object(i.default)(a))})),t=-1!==e.indexOf(w),n=-1!==e.indexOf(A),r=-1!==e.indexOf(y),t?w:n?A:r?y:j;var e,t,n,r;var u}(t);if(n===A)V(t,a),function(a){C(a,A).each((function(a,e){$.validate(Object(i.default)(e))}))}(t);else if(n===y)V(t,a);else if(n===w)a.preventDefault(),function(a){C(a,w).first().focus()}(t);else if(n===j){var r=i.default.Event("aui-valid-submit");t.trigger(r),r.isDefaultPrevented()&&a.preventDefault()}}));const $={register:o.register,validate:function(a){J(a=Object(i.default)(a))}};Object(O.default)("data-aui-validation-field",{attached:function(a){a.form&&a.form.setAttribute("novalidate","novalidate"),F(Object(i.default)(a)),O.default.init(a)},type:O.default.type.ATTRIBUTE}),Object(r.default)("aui/form-validation",$),Object(I.default)("formValidation",$)}},[["defA","runtime","aui.splitchunk.vendors--894c8113d9","aui.splitchunk.vendors--95c789edf5","aui.splitchunk.vendors--9c48cc20a9","aui.splitchunk.vendors--be1eb78c1a","aui.splitchunk.vendors--23f50a6f00","aui.splitchunk.0d131bcbf1","aui.splitchunk.fbbef27525","aui.splitchunk.444efc83be","aui.splitchunk.739b9ec8cc","aui.splitchunk.056561461c","aui.splitchunk.949297951c","aui.splitchunk.dd803a46b4","aui.splitchunk.994e478d48","aui.splitchunk.d7c46c2734","aui.splitchunk.e54c7c7304","aui.splitchunk.fb15cffa72","aui.splitchunk.56dfb54d0c","aui.splitchunk.479fe6ee76","aui.splitchunk.f673ef53ac","aui.splitchunk.9c48cc20a9","aui.splitchunk.908fe798b4","aui.splitchunk.5f851f97df","aui.splitchunk.462ee5f9ef","aui.splitchunk.26116b3cbd","aui.splitchunk.ed86a19e01","aui.splitchunk.50dca3e042","aui.splitchunk.be1eb78c1a","aui.splitchunk.23f50a6f00","aui.splitchunk.e8173e0382"]]]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.integration.jira.jira-integration-plugin:jira-create-issue-form', location = '/jira-create-issue-form/jira-create-issue-form.js' */
define("jira-integration-plugin/jira-create-issue-form",["jquery","jira-integration-plugin/custom-lodash","jira-integration-plugin/jira-create-issue-form-data","jira-integration-plugin/jira-create-issue-form-field-helper","jira-integration-plugin/fields"],function(d,f,h,g,k){function b(a){this.configuration=f.extend({},b.defaults,a);this.configuration.renderSummaryAndDescription&&this.configuration.excludedField.push("summary","description");this._init()}function p(a,c){var e={};a.find(".create-issue-required-fields").find("input, select, textarea, fieldset").not(".select2-input, .select2-focusser").each(function(a){var m=
d(this),b=m.attr("data-name");b&&(e[b]=c(m,b,a))});return e}function n(a){d(".aui-message",a).remove()}var l=window.jiraIntegration.templates;b.defaults={allowUnsupportedFields:!1,ignoreFieldsWithDefaultValue:!0,excludedField:["project","issuetype","reporter"],formClass:"jira-interation-create-issue-form",requiredFieldsOnly:!0,renderSummaryAndDescription:!1,get$unsupportedFieldMessage:function(a,c){return d(l.jiraCreateIssueForm.unsupportedFieldsMessage({unsupportedFields:a,createIssueUrl:c}))},get$unexpectedError:function(a){return d(aui.message.error({content:AJS.escapeHtml(a)}))},
get$communicationError:function(a){return d(l.jiraCreateIssueForm.communicationErrorMessage({message:a}))},get$unauthorizeMessage:function(a){return d(l.jiraCreateIssueForm.authorize({extraClasses:"jira-oauth-dialog",applicationName:a}))},get$unsupportedServerMessage:function(a){return d(l.jiraCreateIssueForm.unsupportedServerMessage({serverUrl:a}))},get$unrenderableRequiredFieldsMessage:function(a,c){var e=a.map(function(a){return AJS.escapeHtml(a.name)}).join(", ");return d(l.jiraCreateIssueForm.unrenderableRequiredFieldsMessage({names:e,
count:a.length,serverUrl:c}))},ajax:function(a){alert("JiraCreateIssueForm requires the option 'ajax(options)' to be specified and respond like jQuery.ajax.\nThis method should handle response status codes other than 200 and 500 (those are handled by us).")}};b.prototype._trigger=function(a,c){var e=this.configuration[a];e&&e.apply(this,Array.prototype.slice.call(arguments,1))};b.prototype._selectServer=function(a,c){var e=this;if(this.currentServerId!==a||c)this.currentServerId=a,this.formIsLoading(this.defaultFields.server),
h.isIssueCreationSupported(a,this.configuration.ajax).done(function(c){c?(e._loadProjectData(a),e.formLoadingCompleted(e.defaultFields.server)):(c=h.getServerById(a).displayUrl,e._handleUnsupportedServer(c))}).fail(function(a){a[0]&&a[0].authenticationUri?e._handleAuthorizeError(a[0]):e._handleAjaxError(a)})};b.prototype._bindEventListener=function(){var a=this;this.defaultFields.server.on("change",function(c){a.fieldValues=f.extend({},a.fieldValues,a._getFieldValues());a.resetForm(!0);(c=this.value)?
a._selectServer(c):(g.resetSelectField(a.defaultFields.project),a.defaultFields.project.trigger("change"));a._trigger("onServerChanged",this.value)});this.defaultFields.project.on("change",function(){var c=this.value||d(this).select2("data").value,e=d(a.defaultFields.issueType).select2("data");a.fieldValues=f.extend({},a.fieldValues,a._getFieldValues());c?(d('option[value\x3d""]',a.defaultFields.project).remove(),a._loadIssueType(a.currentServerId,c,e)):g.resetSelectField(a.defaultFields.issueType);
a._trigger("onProjectChanged",this.value)});this.defaultFields.issueType.on("change",function(){a.fieldValues=f.extend({},a.fieldValues,a._getFieldValues());a.resetForm(!0);this.value?a._loadFields(a.fieldValues):(a.$containerRequireField&&a.$containerRequireField.html(""),n(this.$form));a._trigger("onTypeChanged",this.value)})};b.prototype._getFieldValues=function(){return this._getJSON({getFieldJSON:k.getInternalJSON,$form:this.$form})};b.prototype._init=function(){this.container=d(this.configuration.container);
this.fieldValues={};if(this.container.length)this._renderForm(),this._bindEventListener(),this._loadServerData();else throw Error("container property should be defined.");};b.prototype._renderForm=function(){var a=this;this.$form=d(l.jiraCreateIssueForm.form({formClass:this.configuration.formClass})).on("aui-valid-submit",function(c){a.configuration.onSubmit&&(c.preventDefault(),a.configuration.onSubmit())}).on("focus",".fake-tabbable",function(){const a=d("div#select2-drop.select2-drop-active").children()[0];
a&&a.children.length&&a.getElementsByTagName("input")[0].focus()});this.configuration.renderSummaryAndDescription&&this._renderSummaryAndDescription();this.container.append(this.$form);this.defaultFields=this._getDefaultFields();f.each(this.defaultFields,f.bind(function(a){this.createSelect2WithIcon(d(a))},this));this.$containerRequireField=d(".create-issue-required-fields",this.container);this._trigger("onFormRendered")};b.prototype._renderSummaryAndDescription=function(){var a=d(".create-issue-default-fields",
this.$form);a.append(aui.form.textField({labelContent:"Summary",isRequired:!0,name:"summary",value:this._getSummaryFromConfiguration()}));a.append(aui.form.textareaField({labelContent:"Description",name:"description"}))};b.prototype._getDefaultFields=function(){return{server:d(".server-select",this.$form),project:d(".project-select",this.$form),issueType:d(".issuetype-select",this.$form)}};b.prototype._loadServerData=
function(){var a=this;this.formIsLoading(this.defaultFields.server);h.loadServers(a.configuration.ajax).then(function(c){a.formLoadingCompleted(a.defaultFields.server);a._loadServerDataComplete(c)})};b.prototype._loadFields=function(a){const c=this,e=f.extend({},this.getContextJSON(),a);this.formIsLoading(this.defaultFields.issueType);h.getFieldMetadata(e,c.configuration.ajax).done(function(a){const b=c._filterFields(a);c.configuration.renderSummaryAndDescription&&(a=a.find(a=>"description"===a.fieldId),
c._setDescriptionAsRequiredField(!(!a||!a.required)));a=c._unrenderableRequiredFields(b);0===a.length?(c._renderFields(b,e),c._trigger("onFieldsRendered")):c._handleUnrenderableRequiredFields(a);c._fieldTypeAnalytics(b);c.formLoadingCompleted(c.defaultFields.issueType)}).fail(f.bind(c._handleAjaxError,this))};b.prototype._loadServerDataComplete=function(a){a.length?(1===a.length&&g.hideField(this.defaultFields.server),this._hasMultiServer=1<a.length,g.fillSelectData(this.defaultFields.server,a,this.configuration.serverId||
a[0].id),this._selectServer(this.configuration.serverId||a[0].id)):this._handlerUnexpectedError("Don\u0027t have any Jira server, please check the application link configuration.")};b.prototype._loadProjectData=function(a){var c=this;this.formIsLoading(this.defaultFields.project);h.loadProjects(a,c.configuration.ajax).then(function(a){a.errors&&a.errors.length?(a=a.errors[0],a.authenticationUri?c._handleAuthorizeError(a):c._handlerUnexpectedError(a.message)):a.length?g.fillSelectData(c.defaultFields.project,a,c.configuration.projectId):
c._handlerUnexpectedError("You do not have permission to create issues on this Jira server.");c.formLoadingCompleted(c.defaultFields.project)},f.bind(c._handleAjaxError,this))};b.prototype._loadIssueType=function(a,c,e){const b=this;this.formIsLoading(this.defaultFields.issueType);h.loadIssueTypes(a,c,b.configuration.ajax).then(function(a){g.fillSelectData(b.defaultFields.issueType,a,e&&e.id);b.formLoadingCompleted(b.defaultFields.issueType)}).fail(function(a){404===a.status&&b._handleCommunicationError(AJS.format("Could not communicate with Jira (HTTP error {0})",
404));b.formHasError()})};b.prototype._fieldTypeAnalytics=function(a){var c=a.map(function(a){var c=k.getFieldType(a);return{required:a.required,restType:c,knownRestType:k.isKnownRestType(c)}}).reduce(function(a,c){c.knownRestType?a[c.required?"requiredFields":"otherFields"].push(c.restType):a[c.required?"unknownRequiredFieldsCount":"unknownOtherFieldsCount"]++;return a},{requiredFields:[],otherFields:[],unknownRequiredFieldsCount:0,unknownOtherFieldsCount:0});c=Object.keys(c).reduce(function(a,b){var e=
c[b];if(!Array.isArray(e))return a[b]=e,a;var d=e.length;a[b+".size"]=d;for(var m=0;m<d;m++)a[b+"["+m+"]"]=e[m];return a},{});AJS.trigger("analytics",{name:"jira.integration.issue.create.form.displayed",data:c})};b.prototype._renderFields=function(a,c){this.$containerRequireField.html("");var b=f.reject(a,k.canRender);!this.configuration.allowUnsupportedFields&&b.length?this._handleUnsupportedFields(b):(this.$containerRequireField.html(f.map(a,function(a){return k.renderField(null,a,c,null)}).join("")),
k.attachFieldBehaviors(this.$containerRequireField,c,null),this._trigger("onRequiredFieldsRendered",a,b))};b.prototype._setError=function(a){n(this.$form);this.$form.prepend(a);this.formLoadingCompleted();this.formHasError()};b.prototype._handleCommunicationError=function(a){a=this.configuration.get$communicationError(a);this._setError(a)};b.prototype._handlerUnexpectedError=function(a){a=this.configuration.get$unexpectedError(a);this._setError(a)};b.prototype._handleUnsupportedFields=function(a){a=
f.map(a,function(a){return AJS.escapeHtml(a.name)});a=this.configuration.get$unsupportedFieldMessage(a,this._getCreateJiraIssueUrl());n(this.$form);this.$form.prepend(a);this._trigger("onError");this.formLoadingCompleted()};b.prototype._handleUnsupportedServer=function(a){a=this.configuration.get$unsupportedServerMessage(a);this._setError(a)};b.prototype._handleAjaxError=function(a){if(500<=a.status&&600>a.status){var c=a.responseJSON.errors&&a.responseJSON.errors[0],b=c&&c.exceptionName;b&&"com.atlassian.integration.jira.JiraCommunicationException"===
b?this._handleCommunicationError(c.message):this._handlerUnexpectedError(AJS.format("Could not communicate with Jira (HTTP error {0})",a.status))}else this._handlerUnexpectedError("An unexpected response was received from Jira.");this.formHasError()};b.prototype._handleAuthorizeError=function(a){var c=this;this.formHasError();var b=this.configuration.get$unauthorizeMessage(a.applicationName);this.$form.append(b);d(".applink-authenticate",b).on("click",function(b){AppLinks.authenticateRemoteCredentials(a.authenticationUri,
function(){c.resetForm();c._selectServer(c.currentServerId,!0)},function(){c._handlerUnexpectedError(AJS.format("You have refused to permit access to {0}.",a.applicationName))});b.preventDefault()})};b.prototype._handleUnrenderableRequiredFields=function(a){a=this.configuration.get$unrenderableRequiredFieldsMessage(a,this._getCreateJiraIssueUrl());n(this.$form);this.$form.append(a);this.formLoadingCompleted()};b.prototype._getCreateJiraIssueUrl=function(){var a=this.defaultFields.project.find("option:selected").val(),
c=this.defaultFields.issueType.find("option:selected").val(),b=h.getServerById(this.currentServerId).displayUrl;b=b+"/secure/CreateIssueDetails!Init.jspa?pid\x3d"+a+"\x26issuetype\x3d"+c;a=this._getFieldValue("summary");a.length&&(b=b+"\x26summary\x3d"+encodeURIComponent(a));a=this._getFieldValue("description");a.length&&(b=b+"\x26description\x3d"+encodeURIComponent(a));return b};b.prototype._filterFields=function(a){var c=this;return f.filter(a,function(a){var b=a.schema?a.schema.system||a.schema.custom||
a.schema.customId:a;return!(c.configuration.excludedField&&c.configuration.excludedField.includes(b)||c.configuration.ignoreFieldsWithDefaultValue&&a.hasDefaultValue||c.configuration.requiredFieldsOnly&&!a.required)})};b.prototype._unrenderableRequiredFields=function(a){return a.filter(function(a){return a.required&&!k.canRender(a)})};b.prototype._getFieldValue=function(a){return(a=d("[name\x3d'"+a+"']",this.$form))?d.trim(a.val()):""};b.prototype._setDescriptionAsRequiredField=function(a){var c=
d('.field-group [name\x3d"description"]',this.$form).prev("label");c.find(".aui-icon.aui-icon-required").remove();a&&c.append(aui.icons.icon({icon:"required"}))};b.prototype._getSummaryFromConfiguration=function(){var a=this.configuration.initialSummary;delete this.configuration.initialSummary;return a};b.prototype._getJSON=function(a){if(!a.verbose)return p(a.$form,function(c,b,e){return a.getFieldJSON(c)});var c=h.getCachedFieldMetadataEntry(this.getContextJSON()).value,b=Object.keys(c.fields).reduce(function(a,
b){a[b]=k.getContext(null,c.fields[b],null,null);return a},{});return p(this.$form,function(c,e,d){var f=b[e];return{name:e,jiraType:f.jiraType,required:f.isRequired,label:f.labelText,value:a.getFieldJSON(c),index:d}})};b.prototype.resetForm=function(a){n(this.$form);d(".field-group",this.$form).show();this.configuration.renderSummaryAndDescription&&this._setDescriptionAsRequiredField(!1);this._hasMultiServer||g.hideField(this.defaultFields.server);this.$containerRequireField.html("");this.fieldValues=
a?this.fieldValues:{}};b.prototype.formHasError=function(){d(".field-group",this.$form).hide();this.$containerRequireField.html("");this._hasMultiServer&&g.showField(this.defaultFields.server);g.setFieldDisabled(d(".insert-issue-button"),!0);this._trigger("onError");this.formLoadingCompleted()};b.prototype.getCurrentServer=function(){return h.getServerById(this.currentServerId)};b.prototype.formIsLoading=function(a){a&&g.setIsLoading(a,!0);a=d(":input",d(this.$form));g.setFieldDisabled(a,!0)};b.prototype.formLoadingCompleted=
function(a){a?g.setIsLoading(a,!1):d(".aui-icon.aui-icon-wait",this.$form).remove();a=d(":input",d(this.$form));g.setFieldDisabled(a,!1)};b.prototype.createSelect2WithIcon=function(a){if(a.is(".server-select"))a.auiSelect2({minimumResultsForSearch:-1});else{var c=a.is(".project-select")?{formatSelection:this.projectSelectFormat,formatResult:this.projectSelectFormat,extraAttributes:this.defaultFields}:{formatSelection:this.issueTypeSelectFormat,formatResult:this.issueTypeSelectFormat,minimumResultsForSearch:-1,
extraAttributes:this.defaultFields};a.auiSelect2(c)}a.auiSelect2("val","")};b.prototype.projectSelectFormat=function(a){var c=this.extraAttributes.server.select2("data").id;c=h.getProjectIconUrl(c,a.id);return l.fields.select2WithIconOption({optionValue:a.text,iconUrl:c,isProject:!0})};b.prototype.issueTypeSelectFormat=function(a){var c=this.extraAttributes.server.select2("data").id,b=this.extraAttributes.project.select2("data").id;c=h.getIssueTypeIconUrl(c,b,a.id);return l.fields.select2WithIconOption({optionValue:a.text,
iconUrl:c,isProject:!1})};b.prototype.getContextJSON=function(){var a=this.defaultFields.project.val()||d(this.defaultFields.project).select2("data").value;return{serverId:this.currentServerId,projectId:a,projectKey:h.getProjectById(this.currentServerId,a).key,issueTypeId:this.defaultFields.issueType.val(),summary:this._getSummaryFromConfiguration()}};b.prototype.getJSON=function(a){return b.prototype._getJSON({getFieldJSON:k.getJSON,verbose:a,$form:this.$form})};b.prototype.renderErrors=function(a){p(this.$form,
function(c,b){c=c.closest(".jira-field");var d=function(a){return 0===a.indexOf(b)};if(a.hasOwnProperty(b)||Object.keys(a).some(d)){a.hasOwnProperty(b)||(b=Object.keys(a).filter(d)[0]);var e=Array.isArray(a[b])?a[b]:[a[b]]}k.setFieldError(c,e)})};b.prototype.submit=function(){this.$form.submit()};return b});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.integration.jira.jira-integration-plugin:jira-create-issue-form', location = '/jira-create-issue-form/jira-create-issue-form-data.js' */
define("jira-integration-plugin/jira-create-issue-form-data",["jquery"],function(e){function q(a){var c=new URL(a.avatarUrls["16x16"]);const b=c.searchParams;b.get("pid")||b.append("pid",a.id);b.get("avatarId")||(a=c.pathname.split("/"),c=a.lastIndexOf("avatar"),b.append("avatarId",a[c+1]));return b.toString()}function l(a){a=g(a.serverId,a.projectKey,a.issueTypeId);return{key:a,value:m[a]}}function k(a){if(!d[a])throw Error("Can only be called after server is loaded.");return d[a].projects}function g(a,
c,b){return a+(c?"-"+c:"")+(b?"-"+b:"")}var d={},m={},r=AJS.contextPath()+"/plugins/servlet/jira-integration/icons?serverId\x3d{0}\x26iconType\x3d{1}\x26{2}",h=[],f=function(a,c,b){return a({dataType:"json",timeout:0,url:AJS.contextPath()+"/rest/jira-integration/1.0/servers"+(c||""),statusCode:b})};const p=(a,c,b=[])=>{b=b.filter(a=>!a.subtask);const n={};b.forEach(a=>{n[a.id]=a.iconUrl});const d=q(a);h[g(c,a.id)]={iconUrl:AJS.format(r,c,"project",d),issueTypes:n};return b},t=(a,c)=>k(a).filter(function(a){return a.id===
c})[0];return{loadServers:function(a){return f(a,"").done(function(a){a.forEach(function(a){d[a.id]=a})})},loadProjects:function(a,c){var b=d[a]&&d[a].projects;return b?e.Deferred().resolve(b):f(c,"/"+a+"/projects").done(function(b){b.length&&(b.forEach(function(b){p(b,a)}),d[a].projects=b)})},loadIssueTypes:(a,c,b)=>f(b,`/${a}/projects/${c}/issue-types`,{404:!1}).then(b=>{const d=t(a,c);return b?p(d,a,b):[]}),getFieldMetadata:function(a,c){var b=l(a);return b.value?e.Deferred().resolve(b.value):
f(c,"/"+a.serverId+"/projects/"+a.projectKey+"/issue-types/"+a.issueTypeId+"/fields-meta").done(function(a){m[b.key]=a})},getCachedFieldMetadataEntry:l,getServerById:function(a){return d[a]},getProjectIconUrl:function(a,c){a=g(a,c);return h[a]?h[a].iconUrl:""},getIssueTypeIconUrl:function(a,c,b){a=g(a,c);return(a=h[a])&&a.issueTypes[b]?a.issueTypes[b]:""},getProjects:k,getProjectById:function(a,c){a=k(a);if(!a)return null;for(var b=0,d=a.length;b<d;b++){var e=a[b];if(e.id===c)return e}return null},
isIssueCreationSupported:function(a,c){if(!d[a])throw Error("Can only be called after server is loaded.");return"issueCreationSupported"in d[a]?e.Deferred().resolve(d[a].issueCreationSupported):f(c,"/"+a+"/features").then(function(b){if(b.errors)return e.Deferred().reject(b.errors);if(!Array.isArray(b))return e.Deferred().reject("Unexpected response from Jira");d[a].issueCreationSupported=-1!==b.indexOf("CREATE_ISSUE");return d[a].issueCreationSupported})}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.integration.jira.jira-integration-plugin:jira-create-issue-form', location = '/jira-create-issue-form/jira-create-issue-form-field-helper.js' */
define("jira-integration-plugin/jira-create-issue-form-field-helper",["jquery","jira-integration-plugin/custom-lodash"],function(d,g){function f(a){a=a.attr("data-placeholder");return aui.form.optionOrOptgroup({value:"",text:a,iconUrl:""})}return{fillSelectData:function(a,b,d){var e=[],c;b.forEach(function(a){var b={value:AJS.escapeHtml(a.id),text:a.name,iconUrl:a.iconUrl?a.iconUrl:a.avatarUrls?a.avatarUrls["16x16"]:""};d===a.id&&(b.selected=!0,c=a);e.push(aui.form.optionOrOptgroup(b))});c?(c.text=
c.name,a.html(e.join("")),a.auiSelect2("data",c).trigger("change")):(e.unshift(f(a)),a.html(e.join("")),a.auiSelect2("val","").trigger("change"))},resetSelectField:function(a){a.html(f(a));a.auiSelect2("val","").trigger("change")},hideField:function(a){a.parent().hide()},showField:function(a){a.parent().show()},setFieldDisabled:function(a,b){b?d.fn.disable?a.disable():a.prop("disabled",!0):d.fn.enable?a.enable():a.prop("disabled",!1)},setIsLoading:function(a,b){return b?a.after(aui.icons.icon({icon:"wait"})):
a.next(".aui-icon.aui-icon-wait").remove()}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.integration.jira.jira-integration-plugin:jira-create-issue-form', location = '/jira-create-issue-form/jira-create-issue-form.soy' */
// This file was automatically generated from jira-create-issue-form.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace jiraIntegration.templates.jiraCreateIssueForm.
 */

if (typeof jiraIntegration == 'undefined') { var jiraIntegration = {}; }
if (typeof jiraIntegration.templates == 'undefined') { jiraIntegration.templates = {}; }
if (typeof jiraIntegration.templates.jiraCreateIssueForm == 'undefined') { jiraIntegration.templates.jiraCreateIssueForm = {}; }


jiraIntegration.templates.jiraCreateIssueForm.form = function(opt_data, opt_ignored) {
  return '' + aui.form.form({extraClasses: (opt_data.formClass ? opt_data.formClass + ' ' : '') + 'jira-create-form', method: 'post', action: '#', content: '<fieldset class="create-issue-default-fields"><div class="fake-tabbable" tabindex="0" /><div class="field-group" data-jira-type="server"><label>' + soy.$$escapeHtml('Server') + '<span class="aui-icon icon-required"> required</span></label><select class="jira-select2-drop-box server-select medium-long-field" name="server" data-placeholder="' + soy.$$escapeHtml('Select a server') + '"><option disabled selected value="">' + soy.$$escapeHtml('Select a server') + '</option></select></div><div class="field-group" data-jira-type="project"><label>' + soy.$$escapeHtml('Project') + '<span class="aui-icon icon-required"> required</span></label><select class="jira-select2-drop-box project-select medium-long-field" name="project" data-placeholder="' + soy.$$escapeHtml('Select a project') + '"><option disabled selected value="">' + soy.$$escapeHtml('Select a project') + '</option></select></div><div class="field-group" data-jira-type="issuetype"><label>' + soy.$$escapeHtml('Issue Type') + '<span class="aui-icon icon-required"> required</span></label><select class="jira-select2-drop-box issuetype-select" name="issue-type" data-placeholder="' + soy.$$escapeHtml('Select an issue type') + '"><option disabled selected value="">' + soy.$$escapeHtml('Select an issue type') + '</option></select></div></fieldset><fieldset class="create-issue-required-fields"></fieldset>'});
};
if (goog.DEBUG) {
  jiraIntegration.templates.jiraCreateIssueForm.form.soyTemplateName = 'jiraIntegration.templates.jiraCreateIssueForm.form';
}


jiraIntegration.templates.jiraCreateIssueForm.unsupportedFieldsMessage = function(opt_data, opt_ignored) {
  var param28 = '';
  if (opt_data.unsupportedFields.length == 1) {
    var field__soy31 = '<strong>' + soy.$$escapeHtml(opt_data.unsupportedFields) + '</strong>';
    param28 += soy.$$filterNoAutoescape(AJS.format('The required field {0} is not available in this form. You will need to',field__soy31));
  } else {
    var fieldList__soy38 = '' + jiraIntegration.templates.jiraCreateIssueForm.buildFieldList({fields: opt_data.unsupportedFields});
    param28 += soy.$$filterNoAutoescape(AJS.format('The required fields {0} are not available in this form. You will need to',fieldList__soy38));
  }
  param28 += ' <a href="' + soy.$$escapeHtml(opt_data.createIssueUrl) + '" target="_blank">' + soy.$$escapeHtml('create your issue directly in Jira') + '</a>.';
  var output = '' + aui.message.warning({content: param28});
  return output;
};
if (goog.DEBUG) {
  jiraIntegration.templates.jiraCreateIssueForm.unsupportedFieldsMessage.soyTemplateName = 'jiraIntegration.templates.jiraCreateIssueForm.unsupportedFieldsMessage';
}


jiraIntegration.templates.jiraCreateIssueForm.buildFieldList = function(opt_data, opt_ignored) {
  var output = '';
  var joinText__soy50 = '' + ((opt_data.fields.length == 2) ? ' ' + soy.$$escapeHtml('and') + ' ' : ', ');
  var fieldList58 = opt_data.fields;
  var fieldListLen58 = fieldList58.length;
  for (var fieldIndex58 = 0; fieldIndex58 < fieldListLen58; fieldIndex58++) {
    var fieldData58 = fieldList58[fieldIndex58];
    output += ((! (fieldIndex58 == 0)) ? soy.$$escapeHtml(joinText__soy50) : '') + '<strong>' + soy.$$escapeHtml(fieldData58) + '</strong>';
  }
  return output;
};
if (goog.DEBUG) {
  jiraIntegration.templates.jiraCreateIssueForm.buildFieldList.soyTemplateName = 'jiraIntegration.templates.jiraCreateIssueForm.buildFieldList';
}


jiraIntegration.templates.jiraCreateIssueForm.authorize = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  var output = '';
  var applicationNameEscaped__soy67 = '' + soy.$$escapeHtml(opt_data.applicationName);
  output += aui.message.info({content: '' + soy.$$filterNoAutoescape(AJS.format('{0}Log in and approve{1} to retrieve data from {2}','<a class="oauth-init applink-authenticate" href="#">','</a>',applicationNameEscaped__soy67))});
  return output;
};
if (goog.DEBUG) {
  jiraIntegration.templates.jiraCreateIssueForm.authorize.soyTemplateName = 'jiraIntegration.templates.jiraCreateIssueForm.authorize';
}


jiraIntegration.templates.jiraCreateIssueForm.unsupportedServerMessage = function(opt_data, opt_ignored) {
  return '' + aui.message.warning({content: '' + soy.$$filterNoAutoescape(AJS.format('The version of selected Jira server is not supported. You may want to upgrade to at least version 5.x or {0}create issue in Jira{1}.','<a href="' + opt_data.serverUrl + '" target="_blank">','</a>'))});
};
if (goog.DEBUG) {
  jiraIntegration.templates.jiraCreateIssueForm.unsupportedServerMessage.soyTemplateName = 'jiraIntegration.templates.jiraCreateIssueForm.unsupportedServerMessage';
}


jiraIntegration.templates.jiraCreateIssueForm.unrenderableRequiredFieldsMessage = function(opt_data, opt_ignored) {
  return '' + aui.message.warning({content: '' + soy.$$filterNoAutoescape(AJS.format('The required {1,choice,1#field|1\x3cfields} \x3cstrong\x3e{0}\x3c/strong\x3e {1,choice,1#is|1\x3care} not available in this dialog. You will need to {2}create your issue directly in Jira{3}.',opt_data.names,opt_data.count,'<a href="' + opt_data.serverUrl + '" target="_blank">','</a>'))});
};
if (goog.DEBUG) {
  jiraIntegration.templates.jiraCreateIssueForm.unrenderableRequiredFieldsMessage.soyTemplateName = 'jiraIntegration.templates.jiraCreateIssueForm.unrenderableRequiredFieldsMessage';
}


jiraIntegration.templates.jiraCreateIssueForm.communicationErrorMessage = function(opt_data, opt_ignored) {
  return '' + aui.message.error({titleContent: '' + soy.$$escapeHtml('Unfortunately, we\x27ve encountered problems connecting to Jira'), content: '<p>' + soy.$$escapeHtml(opt_data.message) + '</p>'});
};
if (goog.DEBUG) {
  jiraIntegration.templates.jiraCreateIssueForm.communicationErrorMessage.soyTemplateName = 'jiraIntegration.templates.jiraCreateIssueForm.communicationErrorMessage';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:page-editor-soy', location = 'editor/page-editor.soy' */
// This file was automatically generated from page-editor.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Editor.Page.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Editor == 'undefined') { Confluence.Templates.Editor = {}; }
if (typeof Confluence.Templates.Editor.Page == 'undefined') { Confluence.Templates.Editor.Page = {}; }


Confluence.Templates.Editor.Page.saveButton = function(opt_data, opt_ignored) {
  return '<button id="rte-button-publish" class="aui-button aui-button-primary default-submit" type="submit" name="confirm" value="Save" title="' + Confluence.Templates.Editor.Page.saveButtonTitle(opt_data) + '" tabindex="101">' + Confluence.Templates.Editor.Page.saveButtonText(opt_data) + '</button>';
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.saveButton.soyTemplateName = 'Confluence.Templates.Editor.Page.saveButton';
}


Confluence.Templates.Editor.Page.saveButtonTitle = function(opt_data, opt_ignored) {
  return '' + ((opt_data.contentType == 'blogpost') ? soy.$$escapeHtml('Publish your blog post') : (opt_data.contentType == 'page') ? (opt_data.sharedDraftsEnabled) ? (opt_data.isNewPage) ? soy.$$escapeHtml('Publish changes') : soy.$$escapeHtml('Update the published page') : soy.$$escapeHtml('Save your page') : soy.$$escapeHtml('Save'));
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.saveButtonTitle.soyTemplateName = 'Confluence.Templates.Editor.Page.saveButtonTitle';
}


Confluence.Templates.Editor.Page.previewButton = function(opt_data, opt_ignored) {
  return '<button class="aui-button toolbar-item" id="rte-button-preview" title="' + soy.$$escapeHtml('Preview') + '" type="button"><span class="trigger-text">' + soy.$$escapeHtml('Preview') + '</span></button>';
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.previewButton.soyTemplateName = 'Confluence.Templates.Editor.Page.previewButton';
}


Confluence.Templates.Editor.Page.saveButtonText = function(opt_data, opt_ignored) {
  return '' + ((opt_data.sharedDraftsEnabled && (opt_data.contentType == 'blogpost' || opt_data.contentType == 'page')) ? (opt_data.isNewPage) ? soy.$$escapeHtml('Publish') : soy.$$escapeHtml('Update') : (opt_data.contentType == 'blogpost') ? soy.$$escapeHtml('Publish') : soy.$$escapeHtml('Save'));
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.saveButtonText.soyTemplateName = 'Confluence.Templates.Editor.Page.saveButtonText';
}


Confluence.Templates.Editor.Page.cancelButton = function(opt_data, opt_ignored) {
  return '' + ((opt_data.sharedDraftsEnabled && (opt_data.contentType == 'page' || opt_data.contentType == 'blogpost')) ? '<ul class="aui-buttons rte-toolbar-group-done close"><button class="aui-button shared-drafts" type="submit" id="rte-button-cancel" name="cancel" value="cancel"><span class="icon aui-icon aui-icon-small aui-iconfont-close-dialog"></span></button></ul>' : '<div class="aui-buttons cancel-button-container-shared-draft cancel-button-container-quick-edit"><button class="aui-button toolbar-item" type="submit" id="rte-button-cancel" name="cancel" value="cancel"><span class="trigger-text">' + ((opt_data.contentType == 'page' || opt_data.contentType == 'blogpost') ? soy.$$escapeHtml('Close') : soy.$$escapeHtml('Cancel')) + '</span></button></div>');
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.cancelButton.soyTemplateName = 'Confluence.Templates.Editor.Page.cancelButton';
}


Confluence.Templates.Editor.Page.quitDialogHeader = function(opt_data, opt_ignored) {
  var output = '';
  switch (opt_data.dialogType) {
    case 'delete':
    case 'revert':
      output += (opt_data.newPage) ? (opt_data.contentType == 'blogpost') ? '<h2 class="aui-dialog2-header-main">' + soy.$$escapeHtml('Delete unpublished blog post?') + '</h2>' : '<h2 class="aui-dialog2-header-main">' + soy.$$escapeHtml('Delete unpublished page?') + '</h2>' : '<h2 class="aui-dialog2-header-main">' + soy.$$escapeHtml('Revert to last published version?') + '</h2>';
      break;
    case 'publish':
    case 'update':
      output += '<h2 class="aui-dialog2-header-main">' + soy.$$escapeHtml('Publish all changes?') + '</h2>';
      break;
    case 'diff':
      output += '<h2 class="aui-dialog2-header-main">' + soy.$$escapeHtml('Unpublished changes') + '</h2>';
      break;
  }
  output += '<a class="aui-dialog2-header-close"><span class="aui-icon aui-icon-small aui-iconfont-close-dialog">' + soy.$$escapeHtml('Close') + '</span></a>';
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.quitDialogHeader.soyTemplateName = 'Confluence.Templates.Editor.Page.quitDialogHeader';
}


Confluence.Templates.Editor.Page.quitDialogContent = function(opt_data, opt_ignored) {
  var output = '';
  switch (opt_data.dialogType) {
    case 'revert':
      output += (opt_data.contributors.length == 0) ? ((opt_data.contentType == 'blogpost') ? soy.$$filterNoAutoescape('This will permanently delete all the changes you made since this blog post was last published') : soy.$$filterNoAutoescape('This will permanently delete all the changes you made since this page was last published.')) + '<div class="aui-dialog2-footer-hint"><a id="qed-show-diff-button" class="aui-button aui-button-link">' + soy.$$escapeHtml('Show changes') + '</a></div>' : soy.$$filterNoAutoescape('This will permanently delete all the changes that the following people have made since this page was last published.') + '<div class="aui-dialog2-footer-hint"><a id="qed-show-diff-button" class="aui-button aui-button-link">' + soy.$$escapeHtml('Show changes') + '</a></div>' + Confluence.Templates.Editor.Page.contributorList(opt_data);
      break;
    case 'delete':
      output += (opt_data.contributors.length == 0) ? (opt_data.contentType == 'blogpost') ? soy.$$filterNoAutoescape('Once you delete an unpublished blog post, it\x27s gone for good.') : soy.$$filterNoAutoescape('If you delete an unpublished page, it\x27s gone for good.') : ((opt_data.contentType == 'blogpost') ? soy.$$filterNoAutoescape('This will permanently delete this blog post, which you and these other people have worked on.') : soy.$$filterNoAutoescape('This will permanently delete this page, which you and these other people have worked on.')) + Confluence.Templates.Editor.Page.contributorList(opt_data);
      break;
    case 'publish':
    case 'update':
      output += soy.$$filterNoAutoescape('\x3cp\x3eThere are changes made by you and other people that haven\x27t been published yet.\x3c/p\x3e\x3cp\x3eThese people have made changes:\x3c/p\x3e') + Confluence.Templates.Editor.Page.contributorList(opt_data);
      break;
    case 'diff':
      output += '<div><div class="legend"><span class="legend-title">' + soy.$$escapeHtml('Key') + ': </span><span class="diff-html-added">' + soy.$$escapeHtml('This line was added.') + '</span><span class="diff-html-removed">' + soy.$$escapeHtml('This line was removed.') + '</span><span class="diff-html-changed">' + soy.$$escapeHtml('Formatting was changed.') + '</span></div>' + ((! opt_data.newDialog) ? '<a class="aui-button aui-button-link" id="qed-hide-diff-button">' + soy.$$escapeHtml('Show contributors') + '</a>' : '') + '<hr/><div class="wiki-content"></div></div>';
      break;
  }
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.quitDialogContent.soyTemplateName = 'Confluence.Templates.Editor.Page.quitDialogContent';
}


Confluence.Templates.Editor.Page.hiddenInputCancel = function(opt_data, opt_ignored) {
  return '<input type="hidden" name="cancel" value="cancel">';
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.hiddenInputCancel.soyTemplateName = 'Confluence.Templates.Editor.Page.hiddenInputCancel';
}


Confluence.Templates.Editor.Page.contributorList = function(opt_data, opt_ignored) {
  var output = '<ul class="contributor-list">';
  var contributorList157 = opt_data.contributors;
  var contributorListLen157 = contributorList157.length;
  for (var contributorIndex157 = 0; contributorIndex157 < contributorListLen157; contributorIndex157++) {
    var contributorData157 = contributorList157[contributorIndex157];
    output += '<li><div class="contributor-avatar"><span class="aui-avatar aui-avatar-large"><span class="aui-avatar-inner"><img src="' + soy.$$escapeHtml(contributorData157.avatarURL) + '"/></span></span></div><div class="contributor-name"><span>' + soy.$$escapeHtml(contributorData157.fullname) + '</span></div></li>';
  }
  output += '</ul>';
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.contributorList.soyTemplateName = 'Confluence.Templates.Editor.Page.contributorList';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.drag-and-drop:files-upload-analytics', location = 'js/analytics/files-upload-analytics.js' */
define("confluence-drag-and-drop/analytics/files-upload-analytics",["ajs","underscore"],function(d,e){return{triggerEvent:function(b,a,c){a&&a.length&&(a={multiple:1<a.length,number:a.length,isAllImage:void 0===c?this._isAllImages(a):c},d.trigger("analyticsEvent",{name:b,data:a}))},_isAllImages:function(b){return e.every(b,function(a){return a.nativeFile&&a.nativeFile.type&&0===a.nativeFile.type.indexOf("image/")})}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/file-item/file-item.soy' */
// This file was automatically generated from file-item.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.File.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.File == 'undefined') { Confluence.Templates.File = {}; }


Confluence.Templates.File.fileDialogListItem = function(opt_data, opt_ignored) {
  return '<li class="attached-file loading" data-attachment-id="' + soy.$$escapeHtml(opt_data.file.id) + '" data-owner-id="' + soy.$$escapeHtml(opt_data.file.ownerId) + '" data-file-name="' + soy.$$escapeHtml(opt_data.file.fileName) + '"><div class="file-container" title="' + soy.$$escapeHtml(opt_data.tooltip) + '">' + ((opt_data.file.isImage) ? '<img class="thumbnail hidden" src="' + soy.$$escapeHtml(opt_data.file.nonceUrl) + '" ><a href="' + soy.$$escapeHtml(opt_data.file.downloadUrl) + '" class="abs-icon zoom">Zoom</a><p class="hidden image-preview-throbber">&nbsp;</p>' : (opt_data.file.isPreviewable) ? '<span class="thumbnail ' + soy.$$escapeHtml(opt_data.file.iconClass) + '" ><i class="aui-icon size-48 svg-icon ' + soy.$$escapeHtml(opt_data.file.iconAUIClass) + '">File</i></span><a href="' + soy.$$escapeHtml(opt_data.file.downloadUrl) + '" class="abs-icon zoom">Zoom</a><p class="hidden image-preview-throbber">&nbsp;</p>' : '<span class="thumbnail ' + soy.$$escapeHtml(opt_data.file.iconClass) + '" ><i class="aui-icon size-48 svg-icon ' + soy.$$escapeHtml(opt_data.file.iconAUIClass) + '">File</i></span>') + '<i class="abs-icon select">Select</i></div><span class="caption filename" title="' + soy.$$escapeHtml(opt_data.file.fileName) + '">' + soy.$$filterNoAutoescape(opt_data.highlightedImageNameContent) + '</span>' + ((opt_data.highlightedParentTitleContent) ? '<span class="caption owner-title" title="' + soy.$$escapeHtml(opt_data.file.parentTitle) + '">' + soy.$$filterNoAutoescape(opt_data.highlightedParentTitleContent) + '</span>' : '') + '</li>';
};
if (goog.DEBUG) {
  Confluence.Templates.File.fileDialogListItem.soyTemplateName = 'Confluence.Templates.File.fileDialogListItem';
}


Confluence.Templates.File.fileDialogListItemPlaceHolder = function(opt_data, opt_ignored) {
  return '<li class="attached-file loading" data-attachment-id="' + soy.$$escapeHtml(opt_data.file.id) + '" data-file-name="' + soy.$$escapeHtml(opt_data.file.fileName) + '"><div class="file-container" title="' + soy.$$escapeHtml(opt_data.file.fileName) + '">' + ((opt_data.file.isImage && opt_data.file.url) ? '<img class="thumbnail" src="' + soy.$$escapeHtml(opt_data.file.url) + '">' : '<span class="thumbnail"><i class="aui-icon size-48 svg-icon ' + soy.$$escapeHtml(opt_data.file.iconAUIClass) + '">File</i></span>') + '<div id="docs-progress-bar-' + soy.$$escapeHtml(opt_data.file.fileId) + '" class="aui-progress-indicator"><span class="aui-progress-indicator-value"></span></div><div class="overlay"></div><i class="aui-icon aui-icon-small aui-iconfont-close-dialog abs-icon cancel">Cancel</i></div><span class="caption filename" title="' + soy.$$escapeHtml(opt_data.file.fileName) + '">' + soy.$$escapeHtml(opt_data.file.fileName) + '</span><span class="caption owner-title hidden" title=""></span></li>';
};
if (goog.DEBUG) {
  Confluence.Templates.File.fileDialogListItemPlaceHolder.soyTemplateName = 'Confluence.Templates.File.fileDialogListItemPlaceHolder';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/file-item/file-item-model.js' */
define("confluence-editor/files/file-item/file-item-model",["backbone","confluence/legacy","confluence/api/constants","ajs"],function(e,c,f,d){return e.Model.extend({defaults:{id:-1,ownerId:-1,fileName:"",nonceUrl:"",isImage:!1,isFilePlaceHolder:!1,isSelect:!1,thumbnailUrl:"",downloadUrl:""},initialize:function(){var a=this;this._findDownloadUrl();this._findThumbnailUrl();this.findMetadata();this.findVersion();this.findContainer();this.set("fileName",this.getFileName());this.set("nonceUrl",this.getNonceUrl());
this.set("isImage",this.isImage());this.set("isPreviewable",this.isPreviewable());this.get("isFilePlaceHolder")&&this.set("id",this.get("fileId"));this.listenTo(this,"change:link",function(){a.set("nonceUrl",a.getNonceUrl());a._findDownloadUrl()});this.set("iconAUIClass",this._parseFileNameToAuiIconClass(this.get("fileName")))},isImage:function(){return this.get("isImage")?!0:!!this.get("thumbnailUrl")},isPreviewable:function(){return"application/pdf"===(this.get("niceType")||"").toLocaleLowerCase()||
this.isImage()},getFileName:function(){return this.get("fileName")||this.get("title")||""},getDestinationUrl:function(){return d.REST.wikiLink(this.attributes).destination},getNonceUrl:function(){var a=this.get("thumbnailUrl");if(0<=a.indexOf("modificationDate"))return a;var b=this.get("lastModifiedDate"),b=b?b.date:+new Date,b=encodeURIComponent(b);a&&(a+=(a.indexOf("?")+1?"&":"?")+"nonce="+b);return a},getRelativeUrl:function(a){var b=a;if(!a)return a;0===a.indexOf(c.getBaseUrl())&&(b=a.replace(c.getBaseUrl(),
""));return f.CONTEXT_PATH+b},_findThumbnailUrl:function(){var a=this.get("_links");!this.get("thumbnailUrl")&&(a&&a.thumbnail)&&this.set("thumbnailUrl",this.getRelativeUrl(a.thumbnail))},_findDownloadUrl:function(){var a=this.get("_links");!this.get("downloadUrl")&&a&&this.set("downloadUrl",this.getRelativeUrl(a.download))},findMetadata:function(){var a=this.get("metadata");!this.get("contentType")&&a&&(this.set("niceType",a.mediaType),this.set("contentType",a.mediaType))},findVersion:function(){var a=
this.get("version");!this.get("versionNumber")&&a&&this.set("versionNumber",a.number)},findContainer:function(){var a=this.get("container");a&&(-1===this.get("ownerId")&&this.set("ownerId",a.id),this.get("parentTitle")||this.set("parentTitle",a.title))},_getFileExtension:function(a){return a.substr(a.lastIndexOf(".")+1)},_parseFileNameToAuiIconClass:function(a){return d.Confluence.FileTypesUtils.getAUIIconFromExt(this._getFileExtension(a))}})});
require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/files/file-item/file-item-model","Confluence.Editor.FileDialog.FileItemModel");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/file-item/file-item-view.js' */
define("confluence-editor/files/file-item/file-item-view","backbone confluence/templates confluence/highlighter raphael underscore wrm jquery".split(" "),function(f,g,h,i,d,j,c){return f.View.extend({template:g.File.fileDialogListItem,model:null,initialize:function(a){var b=this;this.eventListener=a.eventListener;this.model=a.model;this.showContainerInfo=a.showContainerInfo;this.highlighter=a.highlighter;this.listenTo(this.model,"change:isSelect",function(){b.$el.toggleClass("selected",b.model.get("isSelect"))})},
render:function(){var a=this.highlighter||new h,b=this.model.get("space"),e=this.model.getFileName(),a={file:this.model.attributes,tooltip:this.showContainerInfo&&b?e+" ("+b.name+")":e,highlightedImageNameContent:a.highlight(e),highlightedParentTitleContent:this.showContainerInfo?a.highlight(this.model.get("container").title):null};this.$el=c(this.template(a));this.el=this.$el[0];this.delegateEvents();this.$el.find(".file-container").tooltip({aria:true});this.$el.attr("data-destination",this.model.getDestinationUrl());
this.model.get("isImage")?this._renderLoadingSpinner():this.$el.removeClass("loading");this.model.get("isPreviewable")&&this._renderPreviewButton();return this},_renderPreviewButton:function(){this.$(".zoom").on("click",d.bind(function(a){a.preventDefault();a={src:this.model.get("downloadUrl"),thumbnail:this.model.get("nonceUrl")||this.model.get("downloadUrl"),type:this.model.get("contentType"),rank:0,title:this.model.getFileName(),id:this.model.get("id"),ownerId:this.model.get("ownerId"),version:this.model.get("versionNumber")};
this._setupAndShowPreviewer(a)},this))},_setupAndShowPreviewer:function(a){var b=d.bind(function(a,b){this.loader=require("cp/confluence/file-preview-loader");var c=this.loader.setupPreviewForSingleFile([a],b);c.on("fv.open",b.openPreviewCallback);c.on("fv.close",b.closePreviewCallback);c.open();c.showFileWhere()},this);if(!this.dfd)this.dfd=j.require("wr!com.atlassian.confluence.plugins.confluence-previews:confluence-previews-resources");this.dfd.then(d.partial(b,a,{viewMode:"simple",openPreviewCallback:function(){c("#insert-image-dialog").hide();
c(".aui-blanket").hide()},closePreviewCallback:function(){c("#insert-image-dialog").show();c(".aui-blanket").show()}}))},_renderLoadingSpinner:function(){var a=this,b=this.$el.find(".image-preview-throbber").removeClass("hidden"),c=i.spinner(b[0],8,"#666"),d=this.$el.find("img").load(function(){c();b.remove();d.removeClass("hidden");a.$el.removeClass("loading")})}})});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/files/file-item/file-item-view","Confluence.Editor.FileDialog.FileItemView");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/file-item/file-placeholder-view.js' */
define("confluence-editor/files/file-item/file-placeholder-view",["backbone","confluence/templates","underscore","ajs","jquery"],function(b,d,e,f,g){return b.View.extend({model:null,template:d.File.fileDialogListItemPlaceHolder,initialize:function(a){this.model=a.model;this.eventListener=a.eventListener;this.eventListener.on("file.placeholder.process",e.bind(this._setUploadInProgress,this))},events:{"click .cancel":"_cancelUpload"},render:function(){this.$el=g(this.template({file:this.model.attributes}));
this.el=this.$el[0];this.delegateEvents();return this},_setUploadInProgress:function(a,b){var c=this.$el.find("#docs-progress-bar-"+b||"");c.length&&(1===a&&this.$(".cancel").hide(),c.show(),f.progressBars.update(c,a))},_cancelUpload:function(){this.eventListener.trigger("uploadingfile.cancelled",this.model.get("fileId"))}})});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/files/file-item/file-placeholder-view","Confluence.Editor.FileDialog.FilePlaceHolderView");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/file-list/file-list-collection.js' */
define("confluence-editor/files/file-list/file-list-collection",["backbone","confluence-editor/files/file-item/file-item-model","underscore"],function(c,d,e){return c.Collection.extend({model:d,clearSelection:function(){this.each(function(a){a.get("isSelect")&&a.set("isSelect",!1)});this.trigger("clear.selection")},getAllSelectItems:function(){return this.filter(function(a){return a.get("isSelect")})},setSelection:function(a){e.each(a,function(a){return a.set("isSelect",!0)})},resetFiles:function(a){this.reset();
for(var b=0;b<a.length;b++)this.addFile(a[b])},addFile:function(a){a=this.add(a);this.trigger("add-file",a.at(a.length-1))},removeFile:function(a){this.remove(a);this.trigger("remove-file",a)},replaceFile:function(a,b){this.remove(a);this.add(b);this.trigger("replace-file",a,b)}})});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/files/file-list/file-list-collection","Confluence.Editor.FileDialog.FileListCollection");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/file-list/file-list-view.js' */
define("confluence-editor/files/file-list/file-list-view","backbone confluence-editor/files/file-item/file-item-view confluence-editor/files/file-item/file-item-model confluence-editor/files/file-item/file-placeholder-view confluence/api/constants jquery".split(" "),function(f,g,h,i,j,c){return f.View.extend({eventListener:null,events:{click:"_clearSelection","click li.attached-file":"_clickItem","dblclick li.attached-file":"_doubleClickItem"},initialize:function(a){var b=this;this.collection=a.collection;
if(a.eventListener){this.eventListener=a.eventListener;this.listenTo(this.eventListener,"uploadingfile.completed",this._addUploadedFile);this.listenTo(this.eventListener,"uploadingfile.cancelled",this._cancelUploadingFile)}this.listenTo(this.collection,"reset",this._clearFileList);this.listenTo(this.collection,"add-file",this._renderNewItem);this.listenTo(this.collection,"remove-file",this._removeItem);this.listenTo(this.collection,"replace-file",this._replaceItem);this.listenTo(this.collection,"change:isSelect",
function(){this.context.setSelectItems(this.collection.getAllSelectItems())});this.listenTo(this.collection,"change:link",function(a){b.collection.removeFile(a);b.collection.addFile(a)});this.updateDialogContext(a.context);this.updatePanelContext(a.panelContext)},_addUploadedFile:function(a,b){var d=this;c.get(j.CONTEXT_PATH+"/rest/api/content/"+b+"?expand=version,container,space").done(function(b){var b=new h(b),c=d.collection.get(a);c||(c=d.collection.findWhere({fileName:b.get("fileName")}));c?
d.collection.replaceFile(c,b):d.collection.addFile(b)})},_cancelUploadingFile:function(a){(a=this.collection.get(a))&&(a.get("previousUploadedFile")?this.collection.replaceFile(a,a.get("previousUploadedFile")):this.collection.removeFile(a))},render:function(){return this},resetFileList:function(a,b){b=b||{};this.$el.find(".loading-message").addClass("hidden");this.$el.find(".no-files").remove();this.collection.resetFiles(a);this.collection.length===0&&this.$fileList.before(c("<p></p>").addClass("no-files").text(this.noFileMessage));
b.shouldClearSelection&&this.collection.clearSelection();this._checkError(b.errors);this.$el.sizeToFit()},_getViewFromModel:function(a){return a.get("isFilePlaceHolder")?(new i({model:a,eventListener:this.eventListener})).render():(new g({model:a,showContainerInfo:this.showContainerInfo,highlighter:this.highlighter,eventListener:this.eventListener})).render()},_renderNewItem:function(a){if(this.$fileList&&this.$fileList.length){var b=this._getViewFromModel(a);this.$fileList.prepend(b.el);a.get("isFilePlaceHolder")||
a.set("isSelect",true)}},_removeItem:function(a){if(this.$fileList&&this.$fileList.length)(a=this._getDomElementByFileName(a.get("fileName")))&&a.remove()},_replaceItem:function(a,b){if(this.$fileList&&this.$fileList.length){var c=this._getViewFromModel(b),e=this._getDomElementByFileName(a.get("fileName"));e&&e.length?e.replaceWith(c.el):this.$fileList.prepend(c.el);b.set("isSelect",true)}},_getDomElementByFileName:function(a){var b=null;this.$fileList.find("li").each(function(){var d=c(this);d.attr("data-file-name")===
a&&(b=d)});return b},updatePanelContext:function(a){if(a){this.panelContext=a;this.errors=this.panelContext.errors||[];this.$el=this.fileContainer=this.panelContext.fileContainer;this.el=this.$el[0];this.$fileList=this.$el.find(".file-list");this.delegateEvents();this.noFileMessage=this.panelContext.noFileMessage;this.showContainerInfo=this.panelContext.showContainerInfo;this.highlighter=this.panelContext.highlighter;this.displayErrors=this.panelContext.displayErrors}},updateDialogContext:function(a){if(a){this.context=
a;this.contextOptions=this.context.options}},_checkError:function(a){(a=a||[])&&a.length&&this.displayErrors(a)},_clearSelection:function(a){a=a&&c(a.target);if(!a||!a.hasClass("close-tip")){this.collection.clearSelection();this.$el.find(".current").removeClass("current")}},_clearFileList:function(){this.$fileList&&this.$fileList.empty()},_clickItem:function(a){a.stopPropagation();a.preventDefault();var b=c(a.target);if(!b.closest(".zoom").length){a.isTrigger||this.$fileList.find(".current").removeClass("current");
a=b.closest("li").attr("data-attachment-id");(a=this.collection.get(a))&&!a.get("isFilePlaceHolder")&&a.set("isSelect",!a.get("isSelect"))}},_doubleClickItem:function(a){var a=c(a.target).closest("li"),b=a.attr("data-attachment-id");if((b=this.collection.get(b))&&!b.get("isFilePlaceHolder")){a.click();this.context.insert()}}})});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/files/file-list/file-list-view","Confluence.Editor.FileDialog.FileListView");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/base-panel/base-panel-view.js' */
define("confluence-editor/files/base-panel/base-panel-view",["backbone","ajs","jquery"],function(b,a,c){return b.View.extend({context:null,cssContainer:"",cssPanel:"",textErrorSearch:"Error searching for attachments from Confluence. The server may be unavailable.",textErrorRetrieving:"Error retrieving attachments from Confluence. The server may be unavailable.",textDefaultErrorMessage:"Could not upload the file to Confluence. The server may be unavailable.",textUploading:"Image uploading...",initialize:function(){},createPanel:function(d){this.context=
d;this.render();var a=this;if(d=this.context.getPanel(this.panelId))d.onselect=function(){a.context.clearSelection();a.focus&&a.focus()}},render:function(){return this},getPanelElement:function(){return c(this.cssPanel,this.context.baseElement)},getContainer:function(){return c(this.cssContainer)},getForm:function(){return c("form",this.getPanelElement())},clearContainer:function(){var a=this.getContainer();a.find(".loading-message").removeClass("hidden");a.find(".warning").addClass("hidden")},clearErrors:function(){this.messenger.clearMessages()},
displayErrors:function(a){this.uploader.displayErrors(a);this.getContainer().sizeToFit()},getNoFileContainer:function(){return this.getPanelElement().find(".no-files")},getFileListContainer:function(){return this.getPanelElement().find("ul.file-list")}})});
require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/files/base-panel/base-panel-view","Confluence.Editor.FileDialog.BasePanel",function(){var b=require("underscore"),a=require("backbone");require("confluence/legacy").Editor.FileDialog.eventListener=b.extend({},a.Events)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/attachments-panel/attachments-panel.soy' */
// This file was automatically generated from attachments-panel.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.File.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.File == 'undefined') { Confluence.Templates.File = {}; }


Confluence.Templates.File.uploadFileForm = function(opt_data, opt_ignored) {
  return '' + ((opt_data.hasAttachPermission) ? '<div id="upload-attachment">' + ((opt_data.isNonSupportDragDrop) ? '<form action="' + soy.$$escapeHtml("") + '/pages/attachfile.action" method="post" enctype="multipart/form-data">' : '<form>') + '<label id="upload-files-button" class="aui-button upload-files"><span class="file-upload-icon aui-icon aui-icon-small aui-iconfont-upload">' + soy.$$escapeHtml('Upload files') + '</span>&nbsp;&nbsp;' + soy.$$escapeHtml('Upload files') + ((opt_data.isNonSupportDragDrop) ? '<input name="file_0" type="file" class="upfile invisible">' : '') + '</label>' + ((opt_data.isNonSupportDragDrop) ? '<input type="hidden" name="minorEdit_0" value="true" /><input type="hidden" name="atl_token" value="' + soy.$$escapeHtml(opt_data.atlToken) + '" />' : '') + '</form>' + ((opt_data.isNonSupportDragDrop) ? '<div class="upload-in-progress hidden">' + soy.$$escapeHtml('Image uploading...') + '</div>' : '') + '</div>' : '') + ((opt_data.hasAttachPermission) ? '<div class="divider"></div>' : '');
};
if (goog.DEBUG) {
  Confluence.Templates.File.uploadFileForm.soyTemplateName = 'Confluence.Templates.File.uploadFileForm';
}


Confluence.Templates.File.attachedFilesPanel = function(opt_data, opt_ignored) {
  return '<div id="attached-files" class="scroll-wrapper">' + aui.message.warning({title: '', closeable: 'true', content: ''}) + '<div class="loading-message hidden">' + soy.$$escapeHtml('Loading...') + '</div><ul class="file-list"></ul></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.File.attachedFilesPanel.soyTemplateName = 'Confluence.Templates.File.attachedFilesPanel';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/attachments-panel/attachments-panel-view.js' */
define("confluence-editor/files/attachments-panel/attachments-panel-view","confluence-editor/files/file-list/file-list-view confluence-editor/files/file-item/file-item-model confluence-editor/files/file-list/file-list-collection confluence-editor/files/base-panel/base-panel-view confluence/templates confluence/legacy confluence/api/constants ajs confluence/meta underscore window jquery".split(" "),function(n,i,o,j,k,p,l,e,h,m,f,g){return j.extend({id:"attachments",panelId:"",cssPanel:".attachments-panel",
cssContainer:"#attached-files",textNoFileMessage:"There are no files attached to this page.",textPanelTitle:"Attached to this page",initialize:function(a){j.prototype.initialize.call(this);this.eventListener=a.eventListener;this.context=null;this.collection=new o;this.fileListView=new n({collection:this.collection,eventListener:this.eventListener});this.xhrCount=0},render:function(){var a=this;this.eventListener.trigger("AttachmentsPanelView.render",this);this.fileListView.updateDialogContext(this.context);
this.panelId=this.context.addPanel(this.textPanelTitle,this.getPanel(),"attachments-panel");this.el=this.getPanelElement();this.$el=g(this.el);this.delegateEvents();this.fileListView.updatePanelContext({fileContainer:this.getContainer(),noFileMessage:this.textNoFileMessage,showContainerInfo:false,errors:[],displayErrors:function(b){a.uploader.clearErrors();a.uploader.displayErrors(b)}});this.uploader=this.getUploaderController(this.context);this.messenger=this.uploader.getMessageHandler();this.collection.reset();
this._canAttachFiles()?this.refresh({shouldClearSelection:true}):this.refresh({errors:["You\u0027ll need to ask permission to insert files here."],shouldClearSelection:true});return this},getPanel:function(){return k.File.uploadFileForm({isNonSupportDragDrop:!this._hasXhrSupport(),atlToken:h.get("atl-token"),hasAttachPermission:this._canAttachFiles()})+k.File.attachedFilesPanel()},_overideUploaderClientForNonDragDropSupport:function(){var a=this;return{onUploadSuccess:function(b){for(var c=0;c<b.length;c++){var d=
b[c].id,e=a.collection.get(d);e&&a.collection.removeFile(e);g.get(l.CONTEXT_PATH+"/rest/api/content/"+d+"?expand=version,container,space").done(function(b){b=new i(b);a.collection.addFile(b)})}},pack:function(){a.getContainer().sizeToFit()},getDefaultErrorMessage:function(){return a.textDefaultErrorMessage},getDefaultUploadingMessage:function(){return a.textUploading},displayErrors:function(b){this.getMessageHandler().displayMessages(b);a._showErrorIconInMessageBox();this.pack()}}},getUploaderController:function(){return p.AttachmentUploader({baseElement:this.getPanelElement()},
m.bind(this._overideUploaderClientForNonDragDropSupport,this))},refresh:function(a){var b=this,c=a.shouldClearSelection?this.getPanelElement().find(".loading-message"):false,d=this.xhrCount=this.xhrCount+1;e.getJSONWrap({url:this._getUrlREST(),messageHandler:this.messenger,loadingElement:c,errorMessage:this.textErrorRetrieving,successCallback:function(c){if(d===b.xhrCount){a.data=c;b._onSuccessLoadFiles(a)}},errorCallback:m.bind(this._onErrorLoadFiles,this)})},_onSuccessLoadFiles:function(a){this.fileListView.resetFileList(a.data.results,
a)},_onErrorLoadFiles:function(){this._showErrorIconInMessageBox()},_showErrorIconInMessageBox:function(){var a=this.messenger.getMessageContainer().find("ul");a.toggleClass("one-message",a.find("li").length===1)},setUploadInProgress:function(a,b){this.eventListener.trigger("file.placeholder.process",a,b)},attachmentUploaded:function(a,b){this.eventListener.trigger("uploadingfile.completed",a,b)},attachmentUploadingCancelled:function(a){this.eventListener.trigger("uploadingfile.cancelled",a)},_hasXhrSupport:function(){var a,
b;try{a=new XMLHttpRequest;b=!(!a.sendAsBinary&&!a.upload)&&!(g.browser.mozilla&&g.browser.version.indexOf("1.9.1")>-1)}catch(c){b=false}return b},addPreviewImage:function(a){var b=require("tinymce");if(f.File&&f.FileReader&&f.FileList&&f.Blob){var c=this,b=b.isIE?1048576:5242880;a.isImage=a.nativeFile&&a.nativeFile.type&&this._isImageType(a.nativeFile.type);if(a.isImage&&a.nativeFile.size<b){var d=new FileReader;d.onload=function(){c._addFilePlaceHolderToCollection(a,d.result)};d.readAsDataURL(a.nativeFile)}else this._addFilePlaceHolderToCollection(a,
null)}},_addFilePlaceHolderToCollection:function(a,b){var c=null,d=this.collection.findWhere({fileName:a.name});if(d){this.collection.removeFile(d);d.get("isFilePlaceHolder")?d.get("previousUploadedFile")&&(c=d.get("previousUploadedFile")):c=d}c=new i({isFilePlaceHolder:true,fileName:a.name,fileId:a.id,fileNative:a.nativeFile,url:b||"",isImage:a.isImage,niceType:a.isImage?"Image":"",fileType:a.nativeFile.type,thumbnailUrl:b||"",previousUploadedFile:c});this.collection.addFile(c)},_isImageType:function(a){return e.Confluence.FileTypesUtils.isImage(a)},
_canAttachFiles:function(){return h.getBoolean("can-attach-files")},_getUrlREST:function(){var a=parseInt(h.get("attachment-source-content-id"),10);return l.CONTEXT_PATH+"/rest/api/content/"+a+"/child/attachment?expand=version,container,space"},focus:function(){this.collection.clearSelection()}})});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/files/attachments-panel/attachments-panel-view","Confluence.Editor.FileDialog.AttachmentsPanelView");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/external-panel/external-panel.soy' */
// This file was automatically generated from external-panel.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.File.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.File == 'undefined') { Confluence.Templates.File = {}; }


Confluence.Templates.File.webPanel = function(opt_data, opt_ignored) {
  return '<div class="insert-web-image"><form id="insert-web-image-form" action="#" class="aui"><fieldset class="inline"><div class="web-image-input"><label for="insert-web-image-image-url" id="insert-web-image-image-url-label">' + soy.$$escapeHtml('Image URL:') + '</label><input type="text" class="text image-url" id="insert-web-image-image-url" name="insert-web-image-image-url"></div><input type="submit" class="image-preview aui-button" value="' + soy.$$escapeHtml('Preview') + '"></fieldset></form><p class="faraway image-preview-area"></p><p class="hidden image-preview-error">' + soy.$$escapeHtml('This image couldn\x27t be loaded for preview. Please check the URL.') + '</p><p class="hidden image-preview-throbber">&nbsp;</p></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.File.webPanel.soyTemplateName = 'Confluence.Templates.File.webPanel';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/external-panel/external-panel-view.js' */
define("confluence-editor/files/external-panel/external-panel-view",["confluence-editor/files/base-panel/base-panel-view","confluence/templates","jquery","raphael","ajs"],function(c,e,d,f,g){return c.extend({id:"external",panelId:"",cssPanel:".web-image-panel",cssContainer:".insert-web-image",textPanelTitle:"Images from the web",template:e.File.searchPanel,events:{"submit form":"_submit","keyup input.image-url":"_checkAllowInsert","click input.image-url":"_checkAllowInsert",
"blur input.image-url":"_checkAllowInsert"},initialize:function(){c.prototype.initialize.call(this);this.context=null;this.token=0},render:function(){this.panelId=this.context.addPanel(this.textPanelTitle,this.getPanel(),"web-image-panel");this.container=this.getContainer();this.preview=this.container.find(".image-preview-area");this.throbber=this.container.find(".image-preview-throbber");this.killSpinner=null;this.error=this.container.find(".image-preview-error")},focus:function(){this._getImageInput().focus();
this._checkAllowInsert()},getPanel:function(){this.$el=d(e.File.webPanel());this.el=this.$el[0];this.delegateEvents();return this.el},_getImageInput:function(){return d("input.image-url",this.context.baseElement)},_submit:function(b){b.preventDefault();b.stopPropagation();var a=this,b=this._getImageInput().val();if("http://"===b)return!1;this.token++;var c=this.token;this.preview.addClass("faraway").html("");this.throbber.removeClass("hidden");this.killSpinner||(this.killSpinner=f.spinner(this.throbber[0],
60,"#666"));this.error.addClass("hidden");d("<img>").load(function(){if(c===a.token){a.killSpinner();a.killSpinner=null;a.throbber.addClass("hidden");a.preview.removeClass("faraway");a._checkAllowInsert()}}).error(function(){if(c===a.token){a.killSpinner();a.killSpinner=null;a.throbber.addClass("hidden");a.error.removeClass("hidden");a._checkAllowInsert()}}).appendTo(this.preview).attr("src",b)},_checkAllowInsert:function(){var b=this.$el.find("input.image-url").val();this.context.setSelectItems(""!==
b&&"http://"!==b?b:[])}})});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/files/external-panel/external-panel-view","Confluence.Editor.FileDialog.ExternalPanelView");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/search-panel/search-panel.soy' */
// This file was automatically generated from search-panel.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.File.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.File == 'undefined') { Confluence.Templates.File = {}; }


Confluence.Templates.File.searchPanel = function(opt_data, opt_ignored) {
  return '<div class="search-panel-wrapper"><div id="search-image"><form class="aui search-form" id="search-image-form" action="#"><fieldset class="inline"><div class="search-input"><label for="search-image" class="assistive">' + soy.$$escapeHtml('Search') + '</label><input autofocus type="text" class="text search-image-text" size="50" autocomplete="off"></div><select class="search-space select" id="search-image-space-select"><option value="">' + soy.$$escapeHtml('All Spaces') + '</option><option value="' + soy.$$escapeHtml(opt_data.spaceKey) + '">' + soy.$$escapeHtml(opt_data.spaceName) + '</option></select><button type="submit" class="aui-button search-button">' + soy.$$escapeHtml('Search') + '</button></fieldset></form></div><div id="searched-images" class="scroll-wrapper"><div class="loading-message hidden">' + soy.$$escapeHtml('Searching...') + '</div><ul class="file-list"></ul></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.File.searchPanel.soyTemplateName = 'Confluence.Templates.File.searchPanel';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/search-panel/search-panel-view.js' */
define("confluence-editor/files/search-panel/search-panel-view","confluence-editor/files/file-item/file-item-model confluence-editor/files/file-list/file-list-view confluence-editor/files/file-list/file-list-collection confluence-editor/files/base-panel/base-panel-view confluence/templates confluence/meta confluence/defaults confluence/highlighter confluence/api/constants underscore ajs jquery".split(" "),function(n,h,i,d,j,e,k,l,m,f,g,c){return d.extend({id:"search",panelId:"",cssPanel:".search-panel",
cssContainer:"#searched-images",template:j.File.searchPanel,events:{"submit form":"_submit"},initialize:function(){d.prototype.initialize.call(this);this.context=null;this.collection=new i;this.fileListView=new h({collection:this.collection})},getPanel:function(){this.$el=c(this.template({spaceKey:e.get("space-key"),spaceName:e.get("space-name")}));this.el=this.$el[0];this.delegateEvents();return this.el},render:function(){this.fileListView.updateDialogContext(this.context);this.panelId=this.context.addPanel("Search on other pages",
this.getPanel(),"search-panel");this.fileListView.updatePanelContext({fileContainer:this.getContainer(),noFileMessage:"No search results found.",showContainerInfo:true})},_submit:function(a){a.preventDefault();a.stopPropagation();if(this._getQuery()){this.clearContainer();this.collection.reset();this._loadImages().then(f.bind(this._onSuccessLoadFiles,this),f.bind(this._onErrorLoadFiles,this))}},_loadImages:function(){var a=this.getForm().find(".search-space").val(),b=this._getQuery(),
b='(title ~ "'+b+'*" OR parent.title ~ "'+b+'*") AND type = attachment';a&&a!==""&&(b=b+(" AND space.key = "+a));return c.ajax({type:"GET",dataType:"json",url:m.CONTEXT_PATH+"/rest/api/search",data:{cql:b,expand:"content.version,content.container,content.space",limit:k.maxResults}})},_onSuccessLoadFiles:function(a){a=a.results.map(function(a){return a.content});this.fileListView.highlighter=new l(this._getQuery().split(" "));this.fileListView.resetFileList(a,{shouldClearSelection:true})},_onErrorLoadFiles:function(){var a=
this.getContainer();a.find(".loading-message").addClass("hidden");a.append(c("<p class='warning'>"+c(this.textErrorSearch).text()+"</p>"))},_getSearchText:function(){return c("input.search-image-text",this.getForm())},_getQuery:function(){return this._getSearchText().val()||""},focus:function(){this.collection.clearSelection();this._getSearchText().focus()}})});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/files/search-panel/search-panel-view","Confluence.Editor.FileDialog.SearchPanelView");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/file-dialog/file-dialog.soy' */
// This file was automatically generated from file-dialog.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.File.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.File == 'undefined') { Confluence.Templates.File = {}; }


Confluence.Templates.File.helpLink = function(opt_data, opt_ignored) {
  return '<div class="dialog-help-link"><a href="' + soy.$$escapeHtml("https://docs.atlassian.com/confluence/docs-717/Display+Files+and+Images") + '" target="_blank">' + soy.$$escapeHtml('Help') + '</a></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.File.helpLink.soyTemplateName = 'Confluence.Templates.File.helpLink';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/file-dialog/file-dialog-view.js' */
define("confluence-editor/files/file-dialog/file-dialog-view","backbone ajs confluence/templates underscore jquery document window".split(" "),function(l,f,m,h,e,j,n){function k(a,d){d.forEach(function(b){a.forEach(function(a){a(b)})})}return l.View.extend({dialogId:"insert-image-dialog",ESC_KEY_CODE:27,width:840,height:530,initialize:function(a){this.urlExternalImg="";this.selectItems=[];this.submitCallback=a.submitCallback;this.cancelCallback=a.cancelCallback;var d=a.beforeShowListeners||[],b,c;
if(d&&(!d.subscribe||!d.unsubscribe)){b=d.push;c=[];Object.assign(d,{push:function(){var a=Array.prototype.slice.apply(arguments);b.apply(d,a);k(c,a)},subscribe:function(a){c.push(a);k([a],d)},unsubscribe:function(){c.length=0}})}this.beforeShowListeners=d;this.panelComponents=a.panelComponents},render:function(){this._createDialog();this.clearSelection();e(j).on("keydown.insert-image",h.bind(this._onNavigationByKey,this));return this},_createDialog:function(){var a=new f.Dialog(this.width,this.height,
this.dialogId),d="Insert files and images",b="Insert";this.dialog=a;a.addHeader(d);a.addButton(b,h.bind(this._submitDialog,this),"insert");a.addCancel("Close",h.bind(this._killDialog,this));this.el=a.popup.element;this.$el=e(this.el);this.baseElement=this.el;this.$el.attr("data-tab-default","0");this.$insertButton=this.$el.find(".dialog-button-panel .insert");e("#"+this.dialogId+" .dialog-components .dialog-title").prepend(m.File.helpLink());
this.$el.find(".dialog-button-panel").append(e("<div></div>").addClass("dialog-tip").html("Hint: type \u0022\u003cstrong\u003e!\u003c/strong\u003e\u0022 in the Editor to insert attached images on the page."));this._createPanels();this.beforeShowListeners.subscribe(function(a){typeof a==="function"&&a()});f.debug(this.beforeShowListeners.length+" beforeShow listeners registered.");e(j).on("hideLayer",h.bind(function(c,b,d){if(!(b!=="popup"||d!==a.popup)){d.remove();this.teardown();typeof this.cancelCallback==="function"&&this.cancelCallback()}},this));f.bind("remove.dialog",
h.bind(function(a,b){b.dialog.id===this.dialog.id&&this.teardown()},this));a.show();return a},_createPanels:function(){var a=this;e.each(this.panelComponents,function(){this&&typeof this.createPanel==="function"&&this.createPanel(a)})},teardown:function(){e(j).unbind(".insert-image");e(".tipsy").remove();this.undelegateEvents();this.beforeShowListeners.unsubscribe()},_killDialog:function(){this.dialog.remove();this.clearSelection();typeof this.cancelCallback==="function"&&this.cancelCallback()},_submitDialog:function(){var a=
{url:this.urlExternalImg,contentId:f.Meta.get("attachment-source-content-id"),selectItems:this.selectItems};this.dialog.remove();typeof this.submitCallback==="function"&&this.submitCallback(a)},setSelectItems:function(a){if(typeof a==="string"){this.urlExternalImg=a;this.selectItems=[]}else{this.urlExternalImg="";this.selectItems=a}a=this.selectItems.length>0||this.urlExternalImg;if(this.$insertButton){this.$insertButton.prop("disabled",!a);this.$insertButton.attr("aria-disabled",!a)}},clearSelection:function(){this.setSelectItems([])},
insert:function(){this.$insertButton&&(!this.$insertButton.is(":disabled")||!this.$insertButton.attr("aria-disabled"))&&this.$insertButton.click()},addPanel:function(a,d,b,c){var e=this.dialog.getPage(0).panel.length;this.dialog.addPanel(a,d,b,c);return e},getPanel:function(a){return this.dialog.getPanel(a)},_onNavigationByKey:function(a){if(!e("#"+this.dialog.id).is(":hidden")){var d=this.dialog.getCurrentPanel().body,b=d.find(".attached-file");if(!(b.length===0||e(j.activeElement).is("input[type=text], select, button"))){var c=
n.tinymce.VK;switch(a.which){case c.LEFT:case c.UP:case c.RIGHT:case c.DOWN:var f=a.which,g;g=b.filter(".current");g.length||(g=b.filter(".selected"));if(g.length){g=b.index(g);var h=b.length,i={};i[c.LEFT]=-1;i[c.RIGHT]=1;i[c.UP]=-4;i[c.DOWN]=4;c=g+(i[f]?i[f]:0);b=b.eq(c<0||c>=h?g:c)}else b=b.first();b.parent().find("li.attached-file.current").removeClass("current");b.addClass("current");b.length&&d.find(".scroll-wrapper").simpleScrollTo(b);a.stopPropagation();return false;case c.SPACEBAR:d.find("li.attached-file.current").click();
a.stopPropagation();return false;case c.ENTER:this.insert();a.stopPropagation();return false}}}}})});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/files/file-dialog/file-dialog-view","Confluence.Editor.FileDialog.FileDialogView");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:dictionary', location = '/includes/js/api/dictionary.js' */
define("confluence/api/dictionary",[],function(){return function(){var a={};return{get:function(b){return a[b]},put:function(b,c){return a[b]=c},reset:function(){a={}},elements:function(){return a}}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:macro-js-overrides', location = '/includes/js/macro-js-overrides.js' */
define("confluence/macro-js-overrides",["confluence/api/dictionary","underscore"],function(f,e){var a=new f;return e.extend(a,{getFunction:function(b,c){var d=a.get(b);if(d&&"function"===typeof d[c])return d[c]},assignFunction:function(b,c){a.put(b,e.extend({},a.get(b),c))}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:space-picker', location = '/js/internal/space-resolver.js' */
define("confluence-ui-components/js/internal/space-resolver",["underscore","jquery","ajs"],function(g,m,e){function p(a){return g.map(a,function(c){return"spaceKey\x3d"+encodeURI(c)}).join("\x26")}function k(a,c){var f="undefined"===typeof c;c=g.escape(f?a:c);return{id:a,text:c,idOnly:f}}var n={conf_all:"All spaces",conf_current:"Current space",conf_favorites:"Favorite spaces",
conf_global:"Site spaces",conf_personal:"Personal spaces"},q=["conf_favorites","conf_global","conf_personal"];return{getSpaceDisplayItems:function(a,c){var f={},l=[];g.each(a,function(d){var b=n[d];b?f[d]=k(d,b):l.push(d)});if(l.length){var h=e.contextPath()+"/rest/api/space?"+p(l);h=m.getJSON(h)}else h=new m.Deferred,h.resolve({results:[]});h.done(function(d){g.each(d.results,
function(b){f[b.key]=k(b.key,b.name)});d=g.map(a,function(b){return f[b]||k(b)});c(d)})},getSpaceCategoryDisplayName:function(a){return n[a]},getSpaceTypeKeys:function(){return q}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:space-picker', location = '/js/space-picker.js' */
define("confluence-ui-components/js/space-picker",["underscore","ajs","jquery","confluence-ui-components/js/internal/space-resolver"],function(g,h,k,l){function r(a){var b=t(),d=u(a);return function(c,e,f){if(2>c.term.length)return d(c);"function"===typeof e&&(c.term=e(c.term));m=v(f);return b(c)}}function n(a,b,d){var c=[];a.forEach(function(e){if(e.children){var f=n(e.children,b,d);f.length&&c.push(k.extend({},e,{children:f}))}else if(f="undefined"!==typeof e.id&&g.contains(l.getSpaceTypeKeys(),
e.id),b&&f||!b&&!f)g.contains(d,e.id)||c.push(e)});return c}function p(a,b){if(!a.length||!b.length)return a;var d=0<g.intersection(b,l.getSpaceTypeKeys()).length;a=n(a,d,b);a.length||a.push({text:"Can\u0027t filter by space types AND spaces",disabled:!0});return a}function w(a){var b=k(".select2-container-active").next("input").val().trim();b=""!==b?b.split(","):[];return p(a,b)}var x={data:null,suggestCategories:null},v=function(a){return function(b){b={id:b.spaceKey,
text:b.spaceName};return"function"===typeof a?a(b):b}},m,y=function(a){return function(b,d){b=k(b).val();""!==b&&(b=b.split(","),l.getSpaceDisplayItems(b,function(c){a.multiple||(c=c[0]);d(c)}))}},u=function(a){var b;if(a.suggestCategories)var d={text:"Select a suggestion or type to search",children:g.map(a.suggestCategories,function(c){return{id:c,text:l.getSpaceCategoryDisplayName(c)}})};return function(c){b?c.callback(b):k.getJSON(h.contextPath()+"/rest/recentlyviewed/1.0/recent/spaces").done(function(e){var f=
{results:[]};d&&f.results.push(d);0<e.length&&f.results.push({text:"Suggested spaces",children:g.map(e,function(q){return{id:q.key,text:g.escape(q.name)}})});b=f;c.callback(b)}).fail(function(){h.log("Couldn't fetch recent spaces");var e={results:[]};d&&e.results.push(d);c.callback(e)})}},t=function(){return window.Select2.query.ajax({url:h.contextPath()+"/rest/quicknav/1/search?type\x3dspacedesc\x26type\x3dpersonalspacedesc",data:function(a){return{query:a,
maxPerCategory:25}},quietMillis:250,results:function(a){a=a.contentNameMatches;if(1>=a.length)return{results:[]};a=g.map(a[0],m);return{results:[{text:"Search results",children:a}]}}})};return{build:function(a){a=g.extend({},x,a);var b={placeholder:"Select a space",formatResult:function(d,c,e){c.attr("title",k("\x3cdiv/\x3e").html(d.text).text());return k.fn.select2.defaults.formatResult.apply(this,
arguments)},escapeMarkup:function(d){return d},multiple:!0===a.multiple,containerCssClass:"space-picker-container"};a.disableMixedSpaceTypes&&(b.sortResults=w);return a.data?g.extend(b,{data:a.data}):g.extend(b,{initSelection:y(a),query:r(a)})},filterMixedTypesForValues:p}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:space-picker', location = '/js/internal/space-picker-legacy.js' */
window.Confluence.UI.Components.SpacePicker=require("confluence-ui-components/js/space-picker");require("ajs").deprecate.prop(window.Confluence.UI.Components.SpacePicker,"build",{sinceVersion:"1.4.22",extraInfo:"Use require('confluence-ui-components/js/space-picker')"});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:date-picker', location = '/includes/js/amd/shim/aui-datepicker-amd.js' */
define("aui/datepicker",function(){return AJS.DatePicker});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:date-picker', location = '/includes/js/date-picker-localisation.js' */
require(["aui/datepicker"],function(a){var b="";a&&(a.prototype.localisations.dayNames=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday",
"Saturday"],a.prototype.localisations.dayNamesMin=["Sun","Mon","Tue","Wed","Thu","Fri",
"Sat"],a.prototype.localisations.firstDay="0",a.prototype.localisations.isRTL="true"==="false",a.prototype.localisations.monthNames=["January","February","March",
"April","May","June","July","August","September","October","November",
"December"],a.prototype.localisations.showMonthAfterYear="true"==="false",a.prototype.localisations.yearSuffix=b&&"null"!==b?b:"")});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:space-page-picker', location = '/js/space-page-picker.js' */
define("confluence-ui-components/js/space-page-picker",["underscore","ajs","confluence-ui-components/js/internal/soy-templates","jquery"],function(f,k,M,l){function N(a,b,c){a=f.map(a,function(d){return b[d]});return c?a:0<a.length?a[0]:null}function H(a){return 0===a.indexOf("page:")?"data-item-id":"data-item-key"}function z(a,b,c,d){c=c?c:0===a.indexOf("~")?"content-type-personalspacedesc":"content-type-spacedesc";return A("space",a,b,"",c,d)}function I(a){var b=O[a];return A("space-cat",a,b,"",
"content-type-space-category",b)}function J(a){var b=P[a];return A("content-function",a,b,"","content-type-page",b)}function B(a,b,c,d,g){return A("page",a,b,c,d,g)}function A(a,b,c,d,g,p){return{id:Q(a,b),text:c?c:b,subText:d,className:p?g:g+" content-not-found",disabled:p?!1:!0}}function Q(){return Array.prototype.slice.apply(arguments).join(":")}function R(a){return(!a.contentType||0===a.contentType.length||0<=a.contentType.indexOf("space"))&&!1!==a.showRecentlyViewedSpaces}function S(a){return(!a.contentType||
0===a.contentType.length||0<=a.contentType.indexOf("page"))&&!1!==a.showRecentlyViewedPages}function T(a,b){b=C("SpaceCat",a,b.inputSpaceCatId,b.inputSpaceCatName?b.inputSpaceCatName:b.inputSpaceCatId);return D(a,b.id,b.name)}function U(a,b){var c=b.inputContentFunctionId||"legacy-macro-param-content-funcs";b=C("ContentFunction",a,c,b.inputContentFunctionName||c);return D(a,b.id,b.name)}function V(a,b){b=C("Space",a,b.inputSpaceId,b.inputSpaceName?b.inputSpaceName:b.inputSpaceId);return D(a,b.id,
b.name)}function W(a,b){b=C("Page",a,b.inputPageId,b.inputPageName?b.inputPageName:b.inputPageId);return D(a,b.id,b.name)}function C(a,b,c,d){if(!c){var g=b.attr("id");if(!g)return null;c=g+a}d||(d=(b.attr("name")||g)+a);return{id:c,name:d}}function D(a,b,c){var d=l("#"+b);0===d.length&&(d=l(M.Components().hiddenField({id:b,name:c})),a.after(d));return d}function v(a,b,c){a&&(b=f.filter(b,function(d){return 0===d.indexOf(c)}),b=f.map(b,function(d){return d.substring(c.length,d.length)}),a.val(b.join(",")))}
function E(a,b,c,d){c=c?f.isArray(c)?c:c.split(","):[];d=d?d.split(","):[];c=f.union(c,d);c=f.map(c,function(g){return b+g});d=(d=a.val())?d.split(","):[];c=f.union(d,c);0<c.length&&a.val(c.join(","))}function K(a,b,c){var d=b.data("select2").opts,g=d.placeholder||b.data("placeholder"),p=T(b,d),r=U(b,d),h=V(b,d),m=W(b,d);b.on("change",function(e){v(p,e.val,"space-cat:");v(r,e.val,"content-function:");v(h,e.val,"space:");v(m,e.val,"page:")});b.val("");var t="SELECT"===b["0"].tagName?b.context.multiple:
d.multiple,F=[],w=[],x=[],L=[],y={},u=a?a.split(","):[];u=f.filter(u,function(e){e=e.split(":");if(2===e.length)return!0;(0>e.length||3<=e.length||1===e.length&&"SPACE-PAGE-TRIGGER-VALUE"!==e[0]&&e[0]!==g)&&k.debug("Error value: "+e)});a=u.join(",");b.val(a);E(b,"space-cat:",d.spaceCatKeys,p?p.val():"");E(b,"content-function:",d.pageCatKeys,r?r.val():"");E(b,"space:",d.spaceKeys,h?h.val():"");E(b,"page:",d.pageIds,m?m.val():"");u=(a=b.val())?a.split(","):[];v(p,u,"space-cat:");v(r,u,"content-function:");
v(h,u,"space:");v(m,u,"page:");if(0!==u.length){f.each(u,function(e,n){n=e.split(":");2===n.length&&(e=n[0],n=n[1],"space-cat"===e?F.push(n):"content-function"===e?x.push(n):"space"===e?w.push(n):"page"===e&&L.push(n))});f.each(F,function(e){y["space-cat:"+e]=I(e)});f.each(x,function(e){y["content-function:"+e]=J(e)});var G=[];0<w.length&&(a=l.getJSON(k.contextPath()+"/rest/prototype/1/space",{spaceKey:w}).done(function(e){var n=[];f.each(e.space,function(q){y["space:"+q.key]=z(q.key,f.escape(q.name),
null,!0);n.push(q.key)});e=f.difference(w,n);f.each(e,function(q){y["space:"+q]=z(q,q,null,!1)})}).fail(function(){k.debug("Couldn't resolve spaceKeys:",w);f.each(w,function(e){y["space:"+e]=z(e,e,null,!1)})}),G.push(a));f.each(L,function(e){var n=l.getJSON(k.contextPath()+"/rest/api/content/"+e,{expand:"space"}).done(function(q){y["page:"+q.id]=B(q.id,f.escape(q.title),f.escape(q.space.name),"content-type-page",!0)}).fail(function(){k.debug("Couldn't resolve pageId:",e);y["page:"+e]=B(e,e,"",
"content-type-page",!1)});G.push(n)});l.when.apply(l,f.map(G,function(e){var n=new l.Deferred;e.always(function(){n.resolve()});return n.promise()})).done(function(){c(N(u,y,t))})}}var O={conf_all:"All spaces",conf_favorites:"Favorite spaces",conf_global:"Site spaces",conf_personal:"Personal spaces",
conf_current:"Current space"},P={"currentContent()":"Current page"},X={data:null,suggestCategories:null},Y={placeholder:"Select a space or page",multiple:!0,formatInputTooShort:function(){return "Start typing to search"},formatResult:function(a,b,c){if(a.children)return b.addClass("space-page-picker-result-category"),
l.fn.select2.defaults.formatResult.apply(this,arguments);if(a.id){b.attr("title",a.text);b.addClass("space-page-picker-result-label-with-icon");var d=l("\x3cspan/\x3e").addClass(a.className+" item-text").html(l.fn.select2.defaults.formatResult.apply(this,arguments)),g=a.subText?l("\x3cspan/\x3e").addClass("space-name").html(a.subText):l("");d=l("\x3cspan/\x3e").attr(H(a.id),a.id).append(d).append(g);return l("\x3cspan/\x3e").append(d)}b.addClass(a.className);return l.fn.select2.defaults.formatResult.apply(this,
arguments)},formatSelection:function(a,b){b.addClass("space-page-picker-selected-item");b.attr("title",a.text);var c=l("\x3cspan/\x3e").attr(H(a.id),a.id).addClass(a.className+" item-text").text(l.fn.select2.defaults.formatSelection.apply(this,arguments));b.append(c)},escapeMarkup:function(a){return a},formatResultCssClass:function(a){return a.children||a.id?"":"select2-result-space-page-separator"},containerCssClass:"space-page-picker-container",dropdownCssClass:"space-page-picker-drop"},Z=function(a,
b){!0!==a.data("select2").opts.manualInit&&K(a.val(),a,b)},aa=function(a){var b;if(a.suggestCategories)var c={text:"Suggested categories",children:f.map(a.suggestCategories,function(g){return I(g)})};if(a.suggestedContentFunctions)var d=f.map(a.suggestedContentFunctions,function(g){return J(g)});return function(g){if(b)g.callback(b);else{var p=[];b={results:[]};if(R(a)){var r=l.getJSON(k.contextPath()+"/rest/recentlyviewed/1.0/recent/spaces").done(function(h){var m=
c?[c]:[];0<h.length&&m.push({text:"Suggested spaces",children:f.map(h,function(t){return z(t.key,f.escape(t.name),null,!0)})});0<m.length&&(b.results=b.results.concat(m))}).fail(function(){k.debug("Couldn't fetch recent spaces");var h=c?[c]:[];0<h.length&&(b.results=b.results.concat(h))});p.push(r)}S(a)&&(r=l.getJSON(k.contextPath()+"/rest/recentlyviewed/1.0/recent/pages",{noTrashedContent:!0}).done(function(h){if(0<h.length||d){var m=[];
d&&(m=m.concat(d));0<h.length&&(m=m.concat(f.map(h,function(t){return B(t.id,f.escape(t.title),f.escape(t.space),"content-type-page",!0)})));b.results.push({text:"Suggested pages",children:m})}}).fail(function(){k.debug("Couldn't fetch recent pages")}),p.push(r));l.when.apply(l,f.map(p,function(h){var m=l.Deferred();h.always(function(){m.resolve()});return m})).done(function(){0===b.results.length&&(b.results=[{text:"",children:[]}]);g.callback(b)})}}},
ba=function(a){var b="";if(!a||2===a.length&&0<=a.indexOf("space")&&0<=a.indexOf("page"))b="type\x3dspacedesc\x26type\x3dpersonalspacedesc\x26type\x3dpage";else if(1===a.length&&"space"===a[0])b="type\x3dspacedesc\x26type\x3dpersonalspacedesc";else if(1===a.length&&"page"===a[0])b="type\x3dpage";else return;return window.Select2.query.ajax({url:k.contextPath()+"/rest/quicknav/1/search?"+b,data:function(c,d){return{query:c,maxPerCategory:25}},quietMillis:250,results:function(c,d){c=c.contentNameMatches;
if(1>=c.length)return{results:[]};d=[];for(var g=0;g<c.length-1;g++){for(var p=[],r=0;r<c[g].length;r++){var h=c[g][r];var m=void 0,t=h.spaceName,F=h.id,w=h.name,x=h.className;"content-type-spacedesc"===x||"content-type-personalspacedesc"===x?m=z(h.spaceKey,t,x,!0):"content-type-page"===x&&(m=B(F,w,t,x,!0));(h=m)&&p.push(h)}0<p.length&&(d=d.concat(p),d.push({id:"",text:"",subText:"",className:"",disabled:!0}))}return{results:[{text:"Search results",
children:d}]}}})},ca=function(a){var b=ba(a.contentType),c=aa(a);return function(d){2>d.term.length?c(d):b(d)}};return{build:function(a){var b=f.extend({},X,Y,a);a.data||(b=f.extend({},{initSelection:Z,query:ca(b)},b));a=l(b.orgElement);if(!a||1!==a.length)return b;a.val()||b.manualInit||a.val("SPACE-PAGE-TRIGGER-VALUE");a.addClass("select2-input");return b},setValue:function(a,b){K(a,b,function(c){b.auiSelect2("data",c)})}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:space-page-picker', location = '/js/internal/space-page-picker-legacy.js' */
window.Confluence.UI.Components.SpacePagePicker=require("confluence-ui-components/js/space-page-picker");AJS.deprecate.prop(window.Confluence.UI.Components.SpacePagePicker,"build",{sinceVersion:"1.4.34",extraInfo:"Use require('confluence-ui-components/js/space-page-picker')"});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:space-page-picker', location = '/soy/space-page-picker.soy' */
// This file was automatically generated from space-page-picker.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.UI.Components.templates.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.UI == 'undefined') { Confluence.UI = {}; }
if (typeof Confluence.UI.Components == 'undefined') { Confluence.UI.Components = {}; }
if (typeof Confluence.UI.Components.templates == 'undefined') { Confluence.UI.Components.templates = {}; }


Confluence.UI.Components.templates.hiddenField = function(opt_data, opt_ignored) {
  return '<input type="hidden" id="' + soy.$$escapeHtml(opt_data.id) + '" name="' + soy.$$escapeHtml(opt_data.name) + '" />';
};
if (goog.DEBUG) {
  Confluence.UI.Components.templates.hiddenField.soyTemplateName = 'Confluence.UI.Components.templates.hiddenField';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:page-picker', location = '/js/page-picker.js' */
define("confluence-ui-components/js/page-picker",["ajs","confluence-ui-components/js/space-page-picker"],function(b,c){return{build:function(a){a.placeholder="Select a page";a.contentType=["page"];a.showRecentlyViewedSpaces=!1;a.spaceCatKeys=[];a.spaceKeys=[];return c.build(a)}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:page-picker', location = '/js/internal/page-picker-legacy.js' */
window.Confluence.UI.Components.PagePicker=require("confluence-ui-components/js/page-picker");AJS.deprecate.prop(window.Confluence.UI.Components.PagePicker,"build",{sinceVersion:"1.4.34",extraInfo:"Use require('confluence-ui-components/js/page-picker')"});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:label-picker', location = '/js/label-picker.js' */
define("confluence-ui-components/js/label-picker",["ajs","confluence-ui-components/js/internal/soy-templates","jquery","underscore"],function(c,e,f,d){function m(a){return{id:a.name,text:a.name}}function g(a){if(!a||!a.length)return null;a=d.map(a,m);return d.sortBy(a,function(b){return b.text.toLowerCase()})}function h(a){return function(b){return f.extend({query:b,ignoreRelated:!0,maxResults:10},a)}}var k=/[;,\.\?&\[\(\)#\^\*@!<>\]]/g,n={placeholder:"Add labels",
multiple:!0,minimumInputLength:1,maximumSelectionSize:20,tokenSeparators:[" ",","],formatInputTooShort:function(a,b){return "Start typing to search for a label"},formatSelectionTooBig:function(a){return c.format("You can only input {0} labels",a)},formatResult:function(a){return e.LabelPicker().labelResult({label:{labelName:a.text,isNew:a.isNew}})},formatNoMatches:function(a){var b=d.uniq(a.match(k)).join(" ");return b?e.LabelPicker().labelInvalid({inputValue:a,
invalidCharacters:b}):this.noMatches},createSearchChoice:function(a){return!a||d.uniq(a.match(k)).join(" ")?null:{id:a,text:a,isNew:!0}},ajax:{data:h(),dataType:"json",url:c.contextPath()+"/labels/autocompletelabel.action",results:function(a){var b=a.contentNameMatches;a=g(b[0]);b=g(b[1]);a=a&&b?[{text:"Suggested",children:a},{text:"Other",children:b}]:a||b||[];return{results:a}},quietMillis:300},
dropdownCssClass:"labels-dropdown",containerCssClass:"labels-autocomplete",initSelection:function(a,b){a=a.val().split(",");a=d.map(a,function(l){return{id:l,text:l}});b(a)}};return{build:function(a){var b=f.extend({},n,a);a&&a.queryOpts&&(b.ajax.data=h(a.queryOpts),delete b.queryOpts);a&&a.noMatches||(b.noMatches=b.placeholder);return b}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:label-picker', location = '/js/internal/label-picker-legacy.js' */
window.Confluence.UI.Components.LabelPicker=require("confluence-ui-components/js/label-picker");AJS.deprecate.prop(window.Confluence.UI.Components.LabelPicker,"build",{sinceVersion:"1.4.18",extraInfo:"Use require('confluence-ui-components/js/label-picker')"});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:label-picker', location = '/soy/label-picker.soy' */
// This file was automatically generated from label-picker.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.UI.Components.LabelPicker.templates.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.UI == 'undefined') { Confluence.UI = {}; }
if (typeof Confluence.UI.Components == 'undefined') { Confluence.UI.Components = {}; }
if (typeof Confluence.UI.Components.LabelPicker == 'undefined') { Confluence.UI.Components.LabelPicker = {}; }
if (typeof Confluence.UI.Components.LabelPicker.templates == 'undefined') { Confluence.UI.Components.LabelPicker.templates = {}; }


Confluence.UI.Components.LabelPicker.templates.labelResult = function(opt_data, opt_ignored) {
  return '' + ((opt_data.label.isNew) ? soy.$$escapeHtml(AJS.format('\x22{0}\x22 - add a new label',opt_data.label.labelName)) : soy.$$escapeHtml(opt_data.label.labelName));
};
if (goog.DEBUG) {
  Confluence.UI.Components.LabelPicker.templates.labelResult.soyTemplateName = 'Confluence.UI.Components.LabelPicker.templates.labelResult';
}


Confluence.UI.Components.LabelPicker.templates.labelInvalid = function(opt_data, opt_ignored) {
  var output = '';
  var inputValueHtml__soy9 = '<b>' + soy.$$escapeHtml(opt_data.inputValue) + '</b>';
  var invalidCharactersHtml__soy13 = '<b>' + soy.$$escapeHtml(opt_data.invalidCharacters) + '</b>';
  output += soy.$$filterNoAutoescape(AJS.format('{0} contains invalid characters {1}',inputValueHtml__soy9,invalidCharactersHtml__soy13));
  return output;
};
if (goog.DEBUG) {
  Confluence.UI.Components.LabelPicker.templates.labelInvalid.soyTemplateName = 'Confluence.UI.Components.LabelPicker.templates.labelInvalid';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:include-exclude-picker', location = '/js/include-exclude-picker.js' */
define("confluence-ui-components/js/include-exclude-picker",["jquery","underscore"],function(d,e){function g(a){var b=a.charAt(0);e.contains(["-"],b)?(c=b,a=a.substring(1)):c="";return a}function f(a){a=d.extend({},a);a.children?a.children=e.map(a.children,f):(a.id=c+a.id,a.text=c+a.text);return a}function h(a){return function(b){b=g(b);return a(b)}}function k(a){return function(b){b=a?a(b):b;c&&(b.results=e.map(b.results,f));return b}}function l(a){return function(b){return a(b,g,f)}}function m(a){if("-"===
a.text.charAt(0))return"select2-search-choice-subtle"}var c="";return{build:function(a){a=d.extend({formatSelectionCssClass:m},a);a.query?a.query=l(a.query):(a.ajax=d.extend({},a.ajax),a.ajax.data=h(a.ajax.data),a.ajax.results=k(a.ajax.results));return a}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'soy/cql/cql-component.soy' */
// This file was automatically generated from cql-component.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.UI.Components.CQL.Templates.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.UI == 'undefined') { Confluence.UI = {}; }
if (typeof Confluence.UI.Components == 'undefined') { Confluence.UI.Components = {}; }
if (typeof Confluence.UI.Components.CQL == 'undefined') { Confluence.UI.Components.CQL = {}; }
if (typeof Confluence.UI.Components.CQL.Templates == 'undefined') { Confluence.UI.Components.CQL.Templates = {}; }


Confluence.UI.Components.CQL.Templates.container = function(opt_data, opt_ignored) {
  return '<div class="cql-container"><div class="cql-error-container"></div><div class="cql-fields"></div></div>';
};
if (goog.DEBUG) {
  Confluence.UI.Components.CQL.Templates.container.soyTemplateName = 'Confluence.UI.Components.CQL.Templates.container';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'soy/cql/cql-filter-field.soy' */
// This file was automatically generated from cql-filter-field.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.UI.Components.CQLFilters.Templates.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.UI == 'undefined') { Confluence.UI = {}; }
if (typeof Confluence.UI.Components == 'undefined') { Confluence.UI.Components = {}; }
if (typeof Confluence.UI.Components.CQLFilters == 'undefined') { Confluence.UI.Components.CQLFilters = {}; }
if (typeof Confluence.UI.Components.CQLFilters.Templates == 'undefined') { Confluence.UI.Components.CQLFilters.Templates = {}; }


Confluence.UI.Components.CQLFilters.Templates.baseFilterField = function(opt_data, opt_ignored) {
  var output = '<div class="cql-filter cql-field-' + soy.$$escapeHtml(opt_data.field.fieldName) + ' cql-type-' + soy.$$escapeHtml(opt_data.field.uiSupport.valueType) + '">';
  var id__soy8 = 'cql-field-' + soy.$$escapeHtml(opt_data.field.fieldName) + '-' + soy.$$escapeHtml(opt_data.counter);
  output += '<div class=\'cql-field-heading\'><label for="' + soy.$$escapeHtml(id__soy8) + '">' + soy.$$escapeHtml(opt_data.label) + ((! opt_data.field.fixed) ? '<span class="aui-icon aui-icon-small aui-iconfont-remove" title="' + soy.$$escapeHtml('Remove filter') + '"></span>' : '') + '</label></div><div class=\'cql-filter-field-input-container\'><input type="text" class="cql-field-input text" id="' + soy.$$escapeHtml(id__soy8) + '"></div></div>';
  return output;
};
if (goog.DEBUG) {
  Confluence.UI.Components.CQLFilters.Templates.baseFilterField.soyTemplateName = 'Confluence.UI.Components.CQLFilters.Templates.baseFilterField';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'soy/cql/cql-filter-select.soy' */
// This file was automatically generated from cql-filter-select.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.UI.Components.CQL.FilterSelect.Templates.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.UI == 'undefined') { Confluence.UI = {}; }
if (typeof Confluence.UI.Components == 'undefined') { Confluence.UI.Components = {}; }
if (typeof Confluence.UI.Components.CQL == 'undefined') { Confluence.UI.Components.CQL = {}; }
if (typeof Confluence.UI.Components.CQL.FilterSelect == 'undefined') { Confluence.UI.Components.CQL.FilterSelect = {}; }
if (typeof Confluence.UI.Components.CQL.FilterSelect.Templates == 'undefined') { Confluence.UI.Components.CQL.FilterSelect.Templates = {}; }


Confluence.UI.Components.CQL.FilterSelect.Templates.container = function(opt_data, opt_ignored) {
  return '<div class="cql-add-filter-container"><button type="button" class="aui-button aui-button-link">' + soy.$$escapeHtml('Add a filter') + '</button><div class="input-wrapper hidden"><input class="select2-input" type="text" /></div></div>';
};
if (goog.DEBUG) {
  Confluence.UI.Components.CQL.FilterSelect.Templates.container.soyTemplateName = 'Confluence.UI.Components.CQL.FilterSelect.Templates.container';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'soy/date-picker.soy' */
// This file was automatically generated from date-picker.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.UI.Components.DatePicker.templates.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.UI == 'undefined') { Confluence.UI = {}; }
if (typeof Confluence.UI.Components == 'undefined') { Confluence.UI.Components = {}; }
if (typeof Confluence.UI.Components.DatePicker == 'undefined') { Confluence.UI.Components.DatePicker = {}; }
if (typeof Confluence.UI.Components.DatePicker.templates == 'undefined') { Confluence.UI.Components.DatePicker.templates = {}; }


Confluence.UI.Components.DatePicker.templates.input = function(opt_data, opt_ignored) {
  return '<div class="aui-navgroup-vertical"><ul class="aui-nav"><li class="aui-nav-selected"><a href="#" role="button" data-value="">' + soy.$$escapeHtml('Any date') + '</a></li role="button"><li><a href="#" role="button" data-value="now(\'-1d\')">' + soy.$$escapeHtml('Last 24 hours') + '</a></li><li><a href="#" role="button" data-value="now(\'-1w\')">' + soy.$$escapeHtml('Last week') + '</a></li><li><a href="#" role="button" data-value="now(\'-1M\')">' + soy.$$escapeHtml('Last month') + '</a></li><li><a href="#" role="button" data-value="now(\'-1y\')">' + soy.$$escapeHtml('Last year') + '</a></li><li><a href="#" role="button" data-value="custom">' + soy.$$escapeHtml('Custom') + '</a><span class="absolute-date-pickers"><input class="from-date-picker text" type="date" /><span>&ndash;</span><input class="to-date-picker text" type="date" /></span></li></ul></div>';
};
if (goog.DEBUG) {
  Confluence.UI.Components.DatePicker.templates.input.soyTemplateName = 'Confluence.UI.Components.DatePicker.templates.input';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'soy/cql/cql-type-picker.soy' */
// This file was automatically generated from cql-type-picker.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.UI.Components.CQL.TypePicker.templates.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.UI == 'undefined') { Confluence.UI = {}; }
if (typeof Confluence.UI.Components == 'undefined') { Confluence.UI.Components = {}; }
if (typeof Confluence.UI.Components.CQL == 'undefined') { Confluence.UI.Components.CQL = {}; }
if (typeof Confluence.UI.Components.CQL.TypePicker == 'undefined') { Confluence.UI.Components.CQL.TypePicker = {}; }
if (typeof Confluence.UI.Components.CQL.TypePicker.templates == 'undefined') { Confluence.UI.Components.CQL.TypePicker.templates = {}; }


Confluence.UI.Components.CQL.TypePicker.templates.suggestions = function(opt_data, opt_ignored) {
  var output = '<div class="aui-navgroup-vertical"><ul class="aui-nav">';
  var typeList4 = opt_data.types;
  var typeListLen4 = typeList4.length;
  for (var typeIndex4 = 0; typeIndex4 < typeListLen4; typeIndex4++) {
    var typeData4 = typeList4[typeIndex4];
    output += '<li ' + ((typeIndex4 == 0) ? ' class="aui-nav-selected"' : '') + '><a href="#" role="button" data-value="' + soy.$$escapeHtml(typeData4.type) + '">' + soy.$$escapeHtml(typeData4.label) + '</a></li>';
  }
  output += '<li><a href="#" role="button" data-value="custom">' + soy.$$escapeHtml('Custom') + '</a></li></ul></div>';
  return output;
};
if (goog.DEBUG) {
  Confluence.UI.Components.CQL.TypePicker.templates.suggestions.soyTemplateName = 'Confluence.UI.Components.CQL.TypePicker.templates.suggestions';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'soy/cql/cql-space-field.soy' */
// This file was automatically generated from cql-space-field.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.UI.Components.CQL.SpaceField.templates.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.UI == 'undefined') { Confluence.UI = {}; }
if (typeof Confluence.UI.Components == 'undefined') { Confluence.UI.Components = {}; }
if (typeof Confluence.UI.Components.CQL == 'undefined') { Confluence.UI.Components.CQL = {}; }
if (typeof Confluence.UI.Components.CQL.SpaceField == 'undefined') { Confluence.UI.Components.CQL.SpaceField = {}; }
if (typeof Confluence.UI.Components.CQL.SpaceField.templates == 'undefined') { Confluence.UI.Components.CQL.SpaceField.templates = {}; }


Confluence.UI.Components.CQL.SpaceField.templates.archivedSpacesOption = function(opt_data, opt_ignored) {
  return '<span><input type="checkbox" value="true" id="search-filter-include-archived" name="includeArchivedSpaces"><label for="search-filter-include-archived">' + soy.$$escapeHtml('Search archived spaces') + '</label></span>';
};
if (goog.DEBUG) {
  Confluence.UI.Components.CQL.SpaceField.templates.archivedSpacesOption.soyTemplateName = 'Confluence.UI.Components.CQL.SpaceField.templates.archivedSpacesOption';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-soy-templates.js' */
define("confluence-ui-components/js/cql/internal/cql-soy-templates",[],function(){return{CQL:function(){return Confluence.UI.Components.CQL.Templates},Filters:function(){return Confluence.UI.Components.CQLFilters.Templates},FilterSelect:function(){return Confluence.UI.Components.CQL.FilterSelect.Templates},SpaceField:function(){return Confluence.UI.Components.CQL.SpaceField.templates},TypePicker:function(){return Confluence.UI.Components.CQL.TypePicker.templates}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-special-spaces.js' */
define("confluence-ui-components/js/cql/internal/cql-special-spaces",["underscore"],function(b){function d(a){return"search-screen"===a?b.omit(c,"conf_current"):c}var c={conf_current:"currentSpace()",conf_favorites:"favourite",conf_global:"global",conf_personal:"personal"},e=b.invert(c);return{getMap:d,getKeys:function(a){return b.keys(d(a))},getUIValue:function(a){return e[a]}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-ajax.js' */
define("confluence-ui-components/js/cql/internal/cql-ajax",["jquery","underscore","ajs"],function(b,d,e){var c;return{getFields:function(){c||(c=b.Deferred(),b.getJSON(e.contextPath()+"/rest/cql/fields?filter\x3dwithUiSupport").done(function(a){a=d.values(a);if(!a.length)throw Error("Unknown CQL field data returned from server - cannot initialise CQL fields.");a=d.union.apply(d,a);a=d.sortBy(a,"fieldName");c.resolve(a)}).fail(function(){c.reject()}));return c.promise()},parseClauses:function(a){return b.getJSON(e.contextPath()+
"/rest/cql/expressions?cql\x3d"+encodeURIComponent(a))},getTypes:function(){return b.getJSON(e.contextPath()+"/rest/cql/contenttypes?category\x3dall")},getContentTypes:function(){return b.getJSON(e.contextPath()+"/rest/cql/contenttypes?category\x3dcontent")}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-date-picker.js' */
define("confluence-ui-components/js/cql/internal/cql-date-picker",["ajs","jquery","confluence-ui-components/js/internal/soy-templates"],function(b,g,n){return{build:function(p){var c=g(n.DatePicker().input()),d=c.find(".aui-nav li"),k=c.find(".absolute-date-pickers").hide(),e=c.find(".from-date-picker"),f=c.find(".to-date-picker"),l=function(){};this.onChange=function(a){l=a;e.change(a);f.change(a)};c.on("click",".aui-nav a",function(a){a.preventDefault();a=d.filter("li.aui-nav-selected");var h=g(this).closest("li");
a[0]!==h[0]&&(d.not(h).removeClass("aui-nav-selected"),h.addClass("aui-nav-selected"),l());"custom"===g(this).data("value")?k.slideDown("fast"):k.slideUp("fast")});var m={overrideBrowserDefault:!0};b.DatePicker(e,m);b.DatePicker(f,m);e.attr("placeholder","From");e.attr("aria-label","From");f.attr("placeholder","To");f.attr("aria-label",
"To");p.replaceWith(c);return{getSelectedOption:function(){return d.filter(".aui-nav-selected").find("a").data("value")},selectOption:function(a){d.find('a[data-value\x3d"'+a+'"]').click()},getFromDate:function(){return e.val()},getToDate:function(){return f.val()},setFromDate:function(a){e.val(a);d.find("a[data-value\x3d'custom']").click()},setToDate:function(a){f.val(a);d.find("a[data-value\x3d'custom']").click()}}}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-type-picker.js' */
define("confluence-ui-components/js/cql/internal/cql-type-picker","jquery underscore ajs confluence-ui-components/js/cql/internal/cql-ajax confluence-ui-components/js/cql/internal/cql-set-value-helper confluence-ui-components/js/cql/internal/cql-soy-templates confluence-ui-components/js/include-exclude-picker".split(" "),function(q,e,u,v,x,y,z){function A(c){k=e.map(c,function(h){return{id:h.type,text:h.label}})}function w(c,h){return 0===c.length?"":1===c.length&&e.contains(e.pluck(h,"type"),c[0])?
c[0]:"custom"}var f,k=[];return{build:function(c,h){var g,l,m,n=[];f||(f=h?v.getContentTypes():v.getTypes(),f.done(A));f.done(function(){if(c.length){var b=e.pluck(k,"id");n=[].concat(k);c.forEach(function(a){""===a.type||e.contains(b,a.type)||n.push({id:a.type,text:a.label})})}else n=k});var B={query:function(b,a,d){f.done(function(){a(b.term);window.Select2.query.local({results:e.map(n,d)})(b)})},initSelection:function(b,a){b=b.val().split(",");var d="",r=e.map(b,function(p){return"-"===p.charAt(0)?
(d="-",p.substring(1)):p});f.done(function(){var p=e.filter(n,function(t){return e.contains(r,t.id)});a(e.map(p,function(t){return{id:d+t.id,text:d+t.text}}))})},multiple:!0,placeholder:"All content types"};return{setupInput:function(b){g=b;if(u.trace)g.on("change",function(){u.trace("type.field.changed")});c.length&&(b=q(y.TypePicker().suggestions({types:c})),l=b.find(".aui-nav li"),g.before(b),b.on("click",".aui-nav a",function(a){a.preventDefault();
a=q(this).closest("li");var d=l.filter(".aui-nav-selected");a[0]!==d[0]&&(d.removeClass("aui-nav-selected"),a.addClass("aui-nav-selected"),a=q(this).attr("data-value"),"custom"===a?m.slideDown("fast"):m.hide(),g.select2("val",[a],!0))}));g.auiSelect2(z.build(B));c.length&&(m=g.closest(".cql-filter").find(".select2-container"),m.hide())},setValues:function(b){if(l){var a=w(b,c),d=l.find('[data-value\x3d"'+a+'"]').parent();l.not(d).removeClass("aui-nav-selected");d.addClass("aui-nav-selected");"custom"===
a&&m.show()}var r=q.Deferred();f.done(function(){x.setValues(g,b).done(function(){r.resolve()})});return r}}},_clearCache:function(){f=null;k=[]},_getPicklistKey:w}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-field-model.js' */
define("confluence-ui-components/js/cql/internal/cql-field-model",[],function(){return{getLabel:function(a){return a.uiSupport.label.translation}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-space-expression-adjuster.js' */
define("confluence-ui-components/js/cql/internal/cql-space-expression-adjuster",["underscore","confluence-ui-components/js/cql/internal/cql-special-spaces"],function(e,f){return{convertFunctionValues:function(a){var b=a.functionValues;if(!b||!b.length)return a;var c=[];e.each(b,function(d){if("currentSpace"===d.functionName)c.push(f.getUIValue("currentSpace()"));else throw Error(d.functionName+" is not a known function");});a.values=c.concat(a.values);return a}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/filterfields/cql-autocomplete-filter-field.js' */
define("confluence-ui-components/js/cql/internal/filterfields/cql-autocomplete-filter-field",["jquery","ajs","confluence-ui-components/js/cql/internal/cql-expression-builder","confluence-ui-components/js/cql/internal/cql-set-value-helper"],function(f,d,l,m){function g(a){return{query:a,searchContext:JSON.stringify({spaceKey:d.Meta.get("space-key"),contentId:d.Meta.get("content-id")})}}function h(a){return 0===a.indexOf("http://")||0===a.indexOf("https://")?a:d.contextPath()+a}var k={placeholder:"Start typing to search",
multiple:!0,tokenSeparators:[" ",","],createSearchChoice:function(a){return a?{id:a,text:"New result: "+a,isNew:!0}:null},createSearchChoicePosition:"bottom",ajax:{data:g,results:function(a){var b=a.suggestedResults;a=a.searchResults;b=b.length?a.length?[{text:"Suggestions",children:b},{text:"Search results",children:a}]:b:a;return{results:b}},quietMillis:300},initSelection:function(a,
b){a=a.val().split(",").map(function(c){return{id:c,text:c}});b(a)}};return{build:function(a){var b;return{setupInput:function(c){b=c;var e=f.extend({},k.ajax,{url:h(a.uiSupport.dataUri)});e=f.extend({},k,{ajax:e});c.auiSelect2(e)},asCqlFunc:function(){var c=this.input.val().trim();if(c)return l.buildEqualityExpressionFromValuesString(this.fieldName,c)},setValues:function(c){return m.setValues(b,c.values)}}},_getUrl:h,_ajaxData:g}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/filterfields/cql-content-filter-field.js' */
define("confluence-ui-components/js/cql/internal/filterfields/cql-content-filter-field",["jquery","confluence-ui-components/js/page-picker","confluence-ui-components/js/cql/internal/cql-expression-builder","confluence-ui-components/js/cql/internal/cql-set-value-helper"],function(k,d,e,f){function g(b){return"page:"+b}function h(b){return"content-function:"+b.functionName+"()"}function c(b){return b.values.map(g).concat(b.functionValues.map(h))}return{build:function(){var b;return{setupInput:function(a){b=
a;a.auiSelect2(d.build({multiple:"parent"!==this.fieldName,suggestedContentFunctions:["currentContent()"]}))},asCqlFunc:function(){var a=this.input.val().trim();if(a)return a=a.replace(/[a-z\-]+:/g,""),e.buildEqualityExpressionFromValuesString(this.fieldName,a)},_addValuePrefixes:c,setValues:function(a){a=c(a);return f.setValues(b,a)}}}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/filterfields/cql-type-suggestions.js' */
define("confluence-ui-components/js/cql/internal/filterfields/cql-type-suggestions",["ajs"],function(a){var b=[{type:"",label:"All content"},{type:"page",label:"Pages"},{type:"blogpost",label:"Blog Posts"},{type:"attachment",label:"Attachments"},{type:"space",
label:"Spaces"}];return{getList:function(){return b}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/filterfields/cql-type-filter-field.js' */
define("confluence-ui-components/js/cql/internal/filterfields/cql-type-filter-field",["confluence/dark-features","confluence-ui-components/js/cql/internal/cql-type-picker","confluence-ui-components/js/cql/internal/filterfields/cql-type-suggestions"],function(f,g,h){return{build:function(k){var a;return{setupInput:function(b,c){var d=[],e=!0;if("search-screen"===c.environment&&"all"===c.searchType||f.isEnabled("cql.force.full.search.mode"))d=h.getList(),e=!1;a=g.build(d,e);a.setupInput(b)},setValues:function(b){return a.setValues(b.values)}}}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/filterfields/cql-date-filter-field.js' */
define("confluence-ui-components/js/cql/internal/filterfields/cql-date-filter-field",["ajs","underscore","confluence-ui-components/js/cql/internal/cql-date-picker"],function(e,h,k){return{build:function(l){var g=l.fieldName,b;return{setupInput:function(a){b=k.build.call(this,a)},setValues:function(a){b?(a=a.expressions,1>a.length||2<a.length?e.warn("Can't set date value with expressions.length: "+a.length):1===a.length&&1===a[0].functionValues.length&&"now"===a[0].functionValues[0].functionName?"\x3e\x3d"!==
a[0].operator?e.warn("Unsupported date picker relative date operator: "+a[0].operator):b.selectOption("now('"+a[0].functionValues[0].parameters[0]+"')"):h.each(a,function(c){if(1===c.values.length){var d=c.values[0];"\x3e\x3d"===c.operator?b.setFromDate(d):"\x3c\x3d"===c.operator&&b.setToDate(d)}})):e.warn("DatePicker not set yet, can't set values")},asCqlFunc:function(){if(b){var a=b.getSelectedOption();if(!a)return"";if("custom"===a){a=b.getFromDate();var c=b.getToDate(),d,f;a&&(d=g+' \x3e\x3d "'+
a+'"');c&&(f=g+' \x3c\x3d "'+c+'"');return d&&f?d+" and "+f:d||f||""}return g+" \x3e\x3d "+a}e.warn("DatePicker not set yet, can't get CQL")}}}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/filterfields/cql-label-filter-field.js' */
define("confluence-ui-components/js/cql/internal/filterfields/cql-label-filter-field",["jquery","ajs","confluence-ui-components/js/label-picker","confluence-ui-components/js/include-exclude-picker","confluence-ui-components/js/cql/internal/cql-set-value-helper"],function(d,e,f,g,h){return{build:function(){var c;return{setupInput:function(a,b){c=a;b=d.extend({},b.select2CustomOptions,{noMatches:"No matching labels found"});a.auiSelect2(g.build(f.build(b)))},
setValues:function(a){return h.setValues(c,a.values)}}}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/filterfields/cql-space-filter-field.js' */
define("confluence-ui-components/js/cql/internal/filterfields/cql-space-filter-field","jquery confluence-ui-components/js/space-picker confluence-ui-components/js/include-exclude-picker confluence-ui-components/js/cql/internal/cql-special-spaces confluence-ui-components/js/cql/internal/cql-space-expression-adjuster confluence-ui-components/js/cql/internal/cql-space-expression-builder confluence-ui-components/js/cql/internal/cql-set-value-helper confluence-ui-components/js/cql/internal/cql-soy-templates".split(" "),
function(f,g,h,k,l,m,n,p){return{build:function(){var b;return{setupInput:function(a,c){b=a;a.auiSelect2(h.build(g.build({multiple:!0,suggestCategories:k.getKeys(c.environment),disableMixedSpaceTypes:!0})));if("search-screen"===c.environment){var d=f(p.SpaceField().archivedSpacesOption());b.after(d);this.onChange=function(e){d.find("#search-filter-include-archived").change(e);b.change(e)}}},asCqlFunc:function(){return m.buildExpressionFromValuesString(this.input.val())},setValues:function(a){l.convertFunctionValues(a);
return n.setValues(b,a.values)}}}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/filterfields/cql-user-filter-field.js' */
define("confluence-ui-components/js/cql/internal/filterfields/cql-user-filter-field",["jquery","ajs","confluence-ui-components/js/user-group-select2"],function(b,f,g){return{build:function(){function h(a){a=a[0].result[0];return{id:a.username,text:a.title,imgSrc:a.thumbnailLink.href}}var d;return{setupInput:function(a){d=a;a.addClass("select2-input autocomplete-multiusergroup");g.bind(a.parent())},setValues:function(a){if((a=a.values)&&a[0]){var e=a.map(function(c){return b.getJSON(f.contextPath()+
"/rest/prototype/1/search/user.json?query\x3d"+encodeURI(c))});return b.when.apply(b,e).done(function(){var c=(1<e.length?arguments:[arguments]).map(h);d.auiSelect2("data",c)})}}}}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/filterfields/cql-filter-field-configs.js' */
define("confluence-ui-components/js/cql/internal/filterfields/cql-filter-field-configs","confluence-ui-components/js/cql/internal/filterfields/cql-autocomplete-filter-field confluence-ui-components/js/cql/internal/filterfields/cql-content-filter-field confluence-ui-components/js/cql/internal/filterfields/cql-type-filter-field confluence-ui-components/js/cql/internal/filterfields/cql-date-filter-field confluence-ui-components/js/cql/internal/filterfields/cql-label-filter-field confluence-ui-components/js/cql/internal/filterfields/cql-space-filter-field confluence-ui-components/js/cql/internal/filterfields/cql-user-filter-field".split(" "),
function(d,e,f,g,h,k,l){var c={contentId:e,contentType:f,date:g,label:h,space:k,user:l};return{getConfig:function(a){var b=a.uiSupport;return b.dataUri?d.build(a):c[b.valueType]?c[b.valueType].build(a):{}}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-filter-field.js' */
define("confluence-ui-components/js/cql/internal/cql-filter-field","jquery underscore ajs confluence-ui-components/js/cql/internal/cql-field-model confluence-ui-components/js/cql/internal/cql-expression-builder confluence-ui-components/js/cql/internal/filterfields/cql-filter-field-configs confluence-ui-components/js/cql/internal/cql-soy-templates".split(" "),function(e,g,t,h,k,l,m){function n(b){var d=h.getLabel(b);d=e(p().baseFilterField({label:d,field:b,counter:q++}));var c=d.find("input");d.data("fieldName",
b.fieldName);return e.extend({input:c,element:d,onChange:function(a){c.change(a)}},b)}var p=m.Filters,q=0;return{build:function(b,d){var c=b.fieldName;if(!b.uiSupport.valueType)throw Error("Can't create filter without valueType.");if(!c)throw Error("Can't create filter without fieldName.");c=l.getConfig(b);var a=n(b);a.asCql=g.bind(c.asCqlFunc||function(){return k.buildExpression(a,this.input.val())},a);var f=a.element.find("input");"function"===typeof c.setupInput&&(a.setupInput=c.setupInput,a.setupInput(f,
d.context));a.setValues=c.setValues||function(r){f.val(r.values.join(","))};a.element.find(".aui-iconfont-remove").click(function(){a.element.remove();d.removeField(a)});return a}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-filter-select.js' */
define("confluence-ui-components/js/cql/internal/cql-filter-select","jquery underscore ajs confluence-ui-components/js/cql/internal/cql-ajax confluence-ui-components/js/cql/internal/cql-field-model confluence-ui-components/js/cql/internal/cql-soy-templates".split(" "),function(k,c,b,t,l,u){var v=u.FilterSelect;return{build:function(g){function w(a){a.added&&(h.auiSelect2("val",""),n(a.added),b.debug("CQL Field selection made"),m.addClass("hidden"),d.show())}var p=g.cqlContainer,q=p.find(".cql-fields"),
n=g.onSelection;if(!n)throw Error("An onSelection callback must be provided to the FilterSelect.");var e=k(v().container()),d=e.children("button"),m=e.find(".input-wrapper"),h=e.find("input");d.click(function(a){a.preventDefault();m.removeClass("hidden");d.hide();e.find(".select2-choice").mousedown()});h.bind("select2-close",function(){b.debug("CQL Field selector closed");m.addClass("hidden");d.show();setTimeout(function(){b.log("Checking CQL Field selector focus");k(document.activeElement).closest(".cql-filter").length||
(b.debug("Setting CQL Field selector focus"),d.focus())},1)});p.append(e);t.getFields().done(function(a){"search-screen"===g.context.environment||b.DarkFeatures.isEnabled("cql.search.screen")||(a=c.reject(a,function(f){return"date"===f.type}));a=c.reject(a,function(f){return c.contains(g.ignoredFields,f.fieldName)});h.auiSelect2({id:"fieldName",data:function(){if(!q[0])throw Error("Why no cql-container?");var f=q.find(".cql-filter").map(function(){return k(this).data("fieldName")});return{results:c.reject(a,
function(r){return c.contains(f,r.fieldName)&&!c.contains(["label"],r.fieldName)}),text:l.getLabel}},formatResult:l.getLabel,formatSelection:l.getLabel,placeholder:"Add a filter"}).change(w)}).fail(function(){b.log("Couldn't fetch CQL fields - unable to initialise CQL field picker")});return h}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-space-expression-builder.js' */
define("confluence-ui-components/js/cql/internal/cql-space-expression-builder",["jquery","underscore","confluence-ui-components/js/cql/internal/cql-special-spaces","confluence-ui-components/js/cql/internal/cql-expression-builder"],function(l,e,f,g){return{buildExpressionFromValuesString:function(a){if(a=a.trim()){a=a.split(",");var h=f.getKeys(),d=[],c=[];e.each(a,function(b){"conf_current"===b?d.push("currentSpace()"):e.contains(h,b)?c.push(b):d.push(b)});a=[];if(c.length){var k=f.getMap();c=e.map(c,
function(b){return k[b]});a.push(g.buildEqualityExpressionFromValuesArray("space.type",c))}d.length&&a.push(g.buildEqualityExpressionFromValuesArray("space",d));return 1===a.length?a[0]:"("+a.join(" or ")+")"}}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-expression-builder.js' */
define("confluence-ui-components/js/cql/internal/cql-expression-builder",["jquery","underscore"],function(q,e){function f(b){return e.contains(["currentContent()","currentSpace()"],b)?b:'"'+b.replace(/"/g,'\\"')+'"'}function g(b){var a={"+":[],"-":[],"":[]};e.each(b,function(c){var d=c.charAt(0);"+"===d?a["+"].push(c.substring(1)):"-"===d?a["-"].push(c.substring(1)):a[""].push(c)});return a}function h(b,a){return e.map(a,function(c){return b+" \x3d "+f(c)}).join(" AND ")}function k(b,a,c){if(0===
a.length)return"";a=e.map(a,f);if(1===a.length)return b+(c?" \x3d ":" !\x3d ")+a[0];a=a.join(",");return b+(c?" in ":" not in ")+"("+a+")"}function l(b,a){return k(b,a,!1)}function m(b,a){return k(b,a,!0)}function n(b,a){var c=g(a);a=[];var d=h(b,c["+"]);d&&a.push(d);(d=m(b,c[""]))&&a.push(d);(b=l(b,c["-"]))&&a.push(b);return a.join(" AND ")}function p(b,a){if(a=a.trim())return a=a.split(","),a=e.map(a,function(c){return c.trim()}),n(b,a)}return{buildExpression:function(b,a){if("equality"===b.type)return p(b.fieldName,
a);if("text"===b.type)return b=b.fieldName,a=(a=a.trim())?b+" ~ "+f(a):void 0,a;throw Error("buildExpression does not yet support type: "+b.type);},buildEqualityExpressionFromValuesString:p,buildEqualityExpressionFromValuesArray:n,makeValueMap:g,makePlusCql:h,makeMinusCql:l,makeRegularCql:m}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-space-type-expression-converter.js' */
define("confluence-ui-components/js/cql/internal/cql-space-type-expression-converter",["underscore","confluence-ui-components/js/cql/internal/cql-special-spaces"],function(b,d){return{convert:function(c,a){a=b.clone(a);var e=b.map(c.values,d.getUIValue);return{field:a,values:e,negate:c.negate}}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-space-expression-aggregator.js' */
define("confluence-ui-components/js/cql/internal/cql-space-expression-aggregator",["underscore","confluence-ui-components/js/cql/internal/cql-space-type-expression-converter"],function(d,h){function g(a,b){a.values=a.values.concat(b.values);return a}return{aggregate:function(a,b){var c=d.filter(a,function(e){return"space.type"===e.field.fieldName});if(0===c.length)return a;if(1<c.length)throw Error("Only a single space.type expression is supported.");b=h.convert(c[0],b);var f=d.filter(a,function(e){return"space"===
e.field.fieldName});a=d.difference(a,c);f.length?f[0]=g(f[0],b):a.push(b);return a},combineSpaceExpressions:g}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-set-value-helper.js' */
define("confluence-ui-components/js/cql/internal/cql-set-value-helper",["jquery"],function(c){return{setValues:function(a,d){var b=c.Deferred();a.on("change",function(){b.resolve()});a.select2("val",d,!0);return b}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-date-expression-aggregator.js' */
define("confluence-ui-components/js/cql/internal/cql-date-expression-aggregator",["underscore","confluence-ui-components/js/cql/internal/cql-space-type-expression-converter"],function(f){return{aggregate:function(e){var b=[],c={};e.forEach(function(a){var d=a.field.fieldName;"date"!==a.field.type?b.push(a):c[d]?c[d].expressions.push(a):(a={field:a.field,expressions:[a]},c[d]=a,b.push(a))});return b}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-negation-converter.js' */
define("confluence-ui-components/js/cql/internal/cql-negation-converter",["jquery","underscore"],function(c,d){function b(a){a.values=d.map(a.values,function(e){return"-"+e})}return{convert:function(a){a=c.extend({},a);"equality"===a.field.type&&("!\x3d"===a.operator?(a.operator="\x3d",b(a)):"notin"===a.operator&&(a.operator="in",b(a)));return a}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-negation-aggregator.js' */
define("confluence-ui-components/js/cql/internal/cql-negation-aggregator",["underscore","confluence-ui-components/js/cql/internal/cql-negation-converter"],function(g,l){function m(e,b){if(!b.length)return e;var a=e[0];a||(a=b[0],b=g.rest(b));b.forEach(function(f){a.values=a.values.concat(f.values)});"\x3d"===a.operator&&1<a.values.length&&(a.operator="in");return[a].concat(g.rest(e))}return{aggregate:function(e){var b=[],a={},f={};e.forEach(function(c){var d=c.field.fieldName;g.contains(b,d)||(b.push(d),
a[d]=[],f[d]=[]);var h=l.convert(c);h.operator!==c.operator?f[d].push(h):a[d].push(h)});var k=[];b.forEach(function(c){c=m(a[c],f[c]);k=k.concat(c)});return k}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-ignored-field-expression-converter.js' */
define("confluence-ui-components/js/cql/internal/cql-ignored-field-expression-converter",[],function(){function c(a,b,d){b&&(a=a.filter(function(e){return-1<b.indexOf(e.field.fieldName)?d:!d}));return a}return{removeFieldsByName:function(a,b){return c(a,b,!1)},getFieldsByName:function(a,b){return c(a,b,!0)}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/cql-component.js' */
define("confluence-ui-components/js/cql/cql-component","jquery underscore ajs confluence-ui-components/js/cql/internal/cql-ajax confluence-ui-components/js/cql/internal/cql-filter-field confluence-ui-components/js/cql/internal/cql-filter-select confluence-ui-components/js/cql/internal/cql-space-expression-aggregator confluence-ui-components/js/cql/internal/cql-date-expression-aggregator confluence-ui-components/js/cql/internal/cql-negation-aggregator confluence-ui-components/js/cql/internal/cql-ignored-field-expression-converter confluence-ui-components/js/cql/internal/cql-soy-templates".split(" "),
function(e,k,g,x,I,J,K,L,M,y,N){function O(c){var f=[];k.each(c,function(n){n.forEach(function(h){h&&(h=h.asCql())&&f.push(h)})});return f.join(" and ")}function z(c,f){return k.find(c,function(n){return n.fieldName===f})}var P=N.CQL;return{build:function(c){function f(a){var b=I.build(a,A);b.onChange(B);a=a.fieldName;d[a]=d[a]||[];d[a].push(b);p.trigger("cql-field-adding",b);a=C.find(".cql-field-"+a+":last");a.length?a.after(b.element):C.append(b.element);return b}function n(a){var b=e.Deferred();
if(!a)return b.resolve(),b;var l={},Q=k.findWhere(r,{fieldName:"space"});a=K.aggregate(a,Q);a=L.aggregate(a);a=M.aggregate(a);D=y.getFieldsByName(a,c.ignoredFields);a=y.removeFieldsByName(a,c.ignoredFields);var E=[];k.each(a,function(t){var m=t.field.fieldName,F=z(r,m),q=l[m];l[m]="number"===typeof q?q+1:0;m=l[m];q=F.fieldName;(t=(d[q]&&d[q][m||0]||f(F)).setValues(t))&&E.push(t)});e.when.apply(e,E).then(function(){b.resolve()});return b}function h(a){if(a){var b=k.escape(a);a="We can\u0027t load your filters";
b=g.format("Curses! We had trouble with \u0022{0}\u0022. Try refreshing the page, but you may need to re-enter your macro parameters.",b)}else a="We couldn\u0027t load the macro",b="If you refresh your page, we\u0027ll give it another shot.";g.messages.error(".cql-error-container",{title:a,body:b,closeable:!0})}function R(a){a=e.extend({},a,{fixed:!1});a=f(a);if(0===a.element.find(".aui-nav-selected").length)if(0!==a.element.find(".select2-container-multi").length){var b=a.element.find("input.select2-input");
b.focus().click()}else b=a.element.find("a.select2-choice.select2-default"),b.length||(b=e(":input:visible",a.element).first()),b.length||g.log("Unable to focus CQL field: "+a.fieldName),b.focus().mousedown()}var G=c.context||{environment:"macro-browser"},u=c.defaultFieldNames;u||(u=c.defaultFields?c.defaultFields.split(","):[]);var p=e(P().container());c.container&&e(c.container).append(p);var C=p.find(".cql-fields"),H=c.value||c.defaultValue;if(H)var v=x.parseClauses(H);else v=new e.Deferred,v.resolve();
var d={},D={},w=new e.Deferred,B=c.onChange||function(){},A={element:p,loading:w,context:c.context||{environment:"macro-browser",searchType:"content",select2CustomOptions:c.select2CustomOptions||{}},getValue:function(){return O(d)},getIgnoredFields:function(){return D},removeField:function(a){var b=a.fieldName;d[b]=k.without(d[b],a);0===d[b].length&&(delete d[b],B())},fieldArrays:d,fieldRegistry:d},r;x.getFields().done(function(a){r=a;u.forEach(function(b){var l=z(r,b);if(!l)throw Error("Unknown fieldname: "+
b);b=e.extend({fixed:!0},l);f(b)});J.build({onSelection:R,cqlContainer:p,context:G,ignoredFields:c.ignoredFields});v.done(function(b){n(b).done(function(){w.resolve()})}).fail(function(){"search-screen"===G.environment?g.log("Error parsing CQL param from search screen URL: "+c.value):h(c.value);w.resolve()})}).fail(function(){h()});return A}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-create-content-plugin:user-select2', location = 'user-select2/avatar.soy' */
// This file was automatically generated from avatar.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace CreateContent.avatar.
 */

if (typeof CreateContent == 'undefined') { var CreateContent = {}; }
if (typeof CreateContent.avatar == 'undefined') { CreateContent.avatar = {}; }


CreateContent.avatar.avatarWithName = function(opt_data, opt_ignored) {
  return '' + aui.avatar.avatar({size: opt_data.size, avatarImageUrl: opt_data.avatarImageUrl, accessibilityText: opt_data.displayName, title: opt_data.displayName, extraAttributes: {'data-username': opt_data.userId}}) + soy.$$escapeHtml(opt_data.displayName);
};
if (goog.DEBUG) {
  CreateContent.avatar.avatarWithName.soyTemplateName = 'CreateContent.avatar.avatarWithName';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-create-content-plugin:user-select2', location = 'user-select2/user-multiselect.js' */
Confluence.Binder.autocompleteMultiUser=function(e){e=e||document.body;var c=AJS.$,k=function(){var b=c(".select2-drop-active \x3e .select2-results");0===b.children(".select2-result-selectable").length&&b.children(".select2-disabled").length&&b.append('\x3cli class\x3d"select2-no-results"\x3e'+AJS.escapeHtml("No matches found")+"\x3c/li\x3e")};c("input.autocomplete-multiuser[data-autocomplete-bound !\x3d 'true']",e).each(function(){var b=c(this);b.auiSelect2({multiple:!0,minimumInputLength:2,
formatInputTooShort:function(){return "Start typing to search for a user"},ajax:{transport:function(a){var d=a.success;delete a.success;return c.ajax.apply(c.ajax,arguments).done(d).done(k)},data:function(a){return{"max-results":6,query:a}},dataType:"json",url:Confluence.getContextPath()+"/rest/prototype/1/search/user.json",results:function(a){var d=[];c.each(a.result,function(){d.push({id:this.username,userKey:this.userKey,text:this.title,imgSrc:this.thumbnailLink.href})});
return{results:d}},quietMillis:300},formatResult:function(a){return CreateContent.avatar.avatarWithName({size:"small",displayName:a.text,userId:a.id,avatarImageUrl:a.imgSrc})},escapeMarkup:function(a){return a},formatSelection:function(a){return CreateContent.avatar.avatarWithName({size:"xsmall",displayName:a.text,userId:a.id,avatarImageUrl:a.imgSrc})},dropdownCssClass:"users-dropdown",containerCssClass:"users-autocomplete",hasAvatar:!0});if(b.data("autofill-user")){var f=AJS.Meta.get("remote-user"),
l=AJS.Meta.get("remote-user-key"),g=AJS.Meta.get("current-user-fullname"),h=AJS.Meta.get("current-user-avatar-url");f&&g&&h&&b.auiSelect2("data",[{id:f,userKey:l,text:g,imgSrc:AJS.contextPath()+h}])}})};
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-parameter-serializer.js' */
define("confluence-macro-browser/macro-parameter-serializer",["jquery"],function(h){function e(d){return d.replace(/\\/g,"\\\\").replace(/=/g,"\\=").replace(/[|]/g,"\\|")}return{serialize:function(d){var a=[],b;for(b in d)a.push(e(b)+"="+e(d[b]));return a.join("|")},deserialize:function(d){function a(f,d){for(var c=[],b=[],a,f=f||"",g=0,e=f.length;g<e;g++)a=f[g],"\\"==a?c.push(a+(g+1!=f.length?f[++g]:"")):a==d?(b.push(c.join("")),c=[]):c.push(a);b.push(c.join(""));return b}var b={};h.each(a(d||"",
"|"),function(d,e){var c=a(e,"=");2===c.length&&c[0]&&(b[c[0].replace(/\\(.)/g,"$1")]=c[1].replace(/\\(.)/g,"$1"))});return b}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-macro-browser/macro-parameter-serializer","Confluence.MacroParameterSerializer");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser-fields.js' */
define("confluence-macro-browser/macro-browser-fields",["ajs","jquery","underscore","confluence/legacy"],function(g,e,o,i){function n(j,h,l){return function(k,b){if(k.multiple)return j.string(k,b);var a=e(i.Templates.MacroBrowser.macroParameterSelect()),c=e("select",a),b=b||{};b.setValue=b.setValue||function(a){var b=!1;c.find("option").each(function(){if(this.value==a)return b=!0,!1});b?delete c.tempValue:(c.append(e("<option></option>").attr("value",a).text(a+" ("+"Not found"+
")")),c.tempValue=a);try{c.val(a)}catch(m){g.logError(m)}c.change()};a=h(a,c,b);a.updateDependencies=l;a.getData=function(a){if(a.title&&a.spaceKey||a.pageId||a.draftId){var f=c.tempValue||c.val();b.fileTypes&&(a.fileTypes=b.fileTypes);var m=g.contextPath()+(a.draftId?"/json/draftattachmentsearch.action":"/json/attachmentsearch.action");e.getJSON(m,a,function(a){if(!a.error){e("option",c).remove();a=a.attachments;if(!a||!a.length){c.append(e("<option></option>").attr("value","").html("No appropriate attachments"));
c.tempValue&&b.setValue(c.tempValue)}else{for(var d=0,m=a.length;d<m;d++)c.append(e("<option></option>").attr("value",a[d].name).text(a[d].name));f=f||c.tempValue;b.setValue(f||a[0].name)}c.attr("style","")}})}else g.log("Not enough parameters to send attachmentsearch request")};return a}}return function(j){var h=function(b,a,c){var c=c||{},d=c.setValue||function(b){a.val(b)},e=c.getValue||function(){return a.val()};a.change(c.onchange||j.paramChanged);return{paramDiv:b,input:a,setValue:d,getValue:e}},
l=function(b,a,c){if(a&&a.length)for(var d=0,e=a.length;d<e;d++)j.fields[a[d]]&&j.fields[a[d]].dependencyUpdated(b,c)},k={updateDependencies:l,username:function(b,a){var a=a||{},c=b.multiple?"autocomplete-multiuser":"autocomplete-user",d=e(i.Templates.MacroBrowser.macroParameter()),f=e("input[type='text']",d);f.addClass(c).attr("data-none-message","Not found");b.required&&f.keyup(j.processRequiredParameters);b.multiple?(i.Binder.autocompleteMultiUser(d),a.setValue=
function(a){f.val(a);for(var a=a.split(","),b=[],c=[],d=0,h=a.length;d<h;d++)b.push(function(a){return e.getJSON(g.contextPath()+"/rest/prototype/1/user/non-system/"+a).done(function(a){a&&a.name&&c.push({id:a.name,text:a.displayName,imgSrc:a.avatarUrl})}).fail(function(b){g.logError("Cannot parse user data for macro browser field with: "+b);c.push({id:a,text:g.format("Unknown User ({0})",a),imgSrc:g.contextPath()+"/images/icons/profilepics/default.png"})})}(a[d]));e.when.apply(e,o.map(b,function(a){var b=
e.Deferred();a.always(function(){b.resolve()});return b.promise()})).done(function(){c.length&&f.auiSelect2("data",c)})}):(f.bind("selected.autocomplete-content",function(c,d){if(a.onselect)a.onselect(d.selection);else a.setValue?a.setValue(d.content.username):(l(b.name,a.dependencies,f.val()),"function"===typeof a.onchange&&a.onchange.apply(f))}),g.Confluence.Binder.autocompleteUserOrGroup(d));return h(d,f,a)},spacekey:function(b,a){if(b.multiple)return k.string(b,a);var a=a||{},c=e(i.Templates.MacroBrowser.macroParameter()),
d=e("input[type='text']",c);d.addClass("autocomplete-space").attr("data-template","{key}").attr("data-none-message","Not found");b.required&&d.keyup(j.processRequiredParameters);d.bind("selected.autocomplete-content",function(c,e){if(a.onselect)a.onselect(e.selection);else a.setValue?a.setValue(e.content.key):(l(b.name,a.dependencies,d.val()),"function"===typeof a.onchange&&a.onchange.apply(d))});g.Confluence.Binder.autocompleteSpace(c);return h(c,d)},attachment:n(k,
h,l),full_attachment:n(k,h,l),"confluence-content":function(b,a){if(b.multiple)return k.string(b,a);a=a||{};b.options=b.options||{};var c=e(i.Templates.MacroBrowser.macroParameter()),d=e("input[type='text']",c).attr("data-none-message","Not found").attr("data-template","");b.required&&d.keyup(j.processRequiredParameters);a.onchange=a.onchange||function(){var c=d.val();l(b.name,a.dependencies,c)};a.setValue=a.setValue||function(b){d.val(b);"function"===typeof a.onchange&&
a.onchange.apply(d)};d.bind("selected.autocomplete-content",function(c,e){var f="";"true"==b.options.includeDatePath&&"blogpost"===e.content.type&&(f=e.content.createdDate.date.split("-"),f="/"+f[0]+"/"+f[1]+"/"+f[2].substring(0,2)+"/");var h=e.content.space&&e.content.space.key,i=h&&h!=g.Meta.get("space-key");-1!==e.content.title.indexOf(":")&&(i=!0);f=(i?h+":":"")+f+e.content.title;d.val(f);if(a.onselect)a.onselect(e.selection);else a.setValue(f,d)});b.options.spaceKey&&("@self"===b.options.spaceKey.toLowerCase()&&
(b.options.spaceKey=g.Meta.get("space-key")),d.attr("data-spacekey",b.options.spaceKey));var f=b.options.type;if("string"===typeof f)if("page"==f)d.addClass("autocomplete-page"),g.Confluence.Binder.autocompletePage(c);else if("blogpost"==f)d.addClass("autocomplete-blogpost"),g.Confluence.Binder.autocompleteBlogpost(c);else{if("attachment"===f||"full_attachment"===f)d.addClass("autocomplete-attachment"),g.Confluence.Binder.autocompleteAttachment(c)}else d.addClass("autocomplete-confluence-content"),
g.Confluence.Binder.autocompleteConfluenceContent(c);return h(c,d,a)},string:function(b,a){var c=e(i.Templates.MacroBrowser.macroParameter()),d=e("input",c);b.required&&d.keyup(j.processRequiredParameters);return h(c,d,a)},"boolean":function(b,a){var c=e(i.Templates.MacroBrowser.macroParameterBoolean()),d=e("input",c),a=a||{};a.setValue=a.setValue||function(a){(/true/i.test(a)||/true/i.test(b.defaultValue)&&!/false/i.test(a))&&d.prop("checked",!0)};return h(c,d,a)},"enum":function(b,a){if(b.multiple)return k.string(b,
a);var c=e(i.Templates.MacroBrowser.macroParameterSelect()),d=e("select",c);!b.required&&!b.defaultValue&&d.append(e("<option></option>").attr("value",""));e(b.enumValues).each(function(a,c){var g=c;if(b.enumToI18nKeyMapping){var h=[b.pluginKey,b.macroName,"param",b.name,this,"desc"].join(".");b.enumToI18nKeyMapping[c]!==h&&(g=b.enumToI18nKeyMapping[c])}d.append(e("<option></option>").attr("value",this).html(""+g))});return h(c,d,a)},_hidden:function(b,a){var c=e(i.Templates.MacroBrowser.macroParameterHidden()).hide(),
d=e("input",c);return h(c,d,a)}};return{Field:h,ParameterFields:k}}});require("confluence/module-exporter").safeRequire("confluence-macro-browser/macro-browser-fields");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser-smartfields.js' */
define("confluence-macro-browser/macro-browser-smartfields",["ajs","confluence/macro-js-overrides"],function(c,f){return function(h,d){var e=function(a){this.fileTypes=a};e.prototype.beforeParamsSet=function(a){!a.page&&(!a.date&&!a.space)&&("page"==c.params.contentType||"blogpost"==c.params.contentType?a.page=c.Editor.getCurrentTitle():"comment"==c.params.contentType&&(a.page=c.params.pageTitle));if(a.date){var b=a.date.split("/");a.page=["",b[2],b[0],b[1],a.page].join("/")}a.space&&(a.page=a.space+
":"+a.page);return a};e.prototype.beforeParamsRetrieved=function(a){if(a.page){var b=a.page.split(":");1<b.length&&(a.space=b[0],a.page=b[1]);b=a.page.split("/");1<b.length&&(a.date=[b[2],b[3],b[1]].join("/"),a.page=b[4]);(("page"==c.params.contentType||"blogpost"==c.params.contentType)&&a.page==c.Editor.getCurrentTitle()||"comment"==c.params.contentType&&a.page==c.params.pageTitle)&&delete a.page}return a};e.prototype.fields={attachment:function(a){a=d.attachment(a,{fileTypes:this.fileTypes});a.dependencyUpdated=
function(a,g){c.debug("attachment:dependencyUpdated called: "+a+", "+g);var d=e.prototype.fields._parsePageLink(g);this.getData(d)};return a},full_attachment:function(a){a=d.full_attachment(a,{fileTypes:this.fileTypes});a.dependencyUpdated=function(a,d){c.debug("attachment:dependencyUpdated called: "+a+", "+d);var f=e.prototype.fields._parsePageLink(d);this.getData(f)};return a},"confluence-content":function(a){return d["confluence-content"](a,{dependencies:["name"]})},_parsePageLink:function(a){var b=
{},a=a.split(":",2);b.spaceKey=2===a.length&&a[0]||c.Meta.get("space-key");b.title=a[a.length-1];0===b.title.indexOf("/")&&(b.postingDay=b.title.substr(1,10),b.title=b.title.substr(12));b.title===c.Editor.getCurrentTitle()&&(b.title="");b.title||(c.params.newPage?b.draftId=c.Meta.get("content-id"):b.pageId=c.params.pageId);return b}};h.activateSmartFieldsAttachmentsOnPage=function(a,b){f.put(a,new e(b))}}});require("confluence/module-exporter").safeRequire("confluence-macro-browser/macro-browser-smartfields");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser-utils.js' */
define("confluence-macro-browser/macro-browser-utils",["jquery"],function(a){return{makeDefaultKey:function(){return a.makeArray(arguments).join(".")}}});require("confluence/module-exporter").safeRequire("confluence-macro-browser/macro-browser-utils");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser-cql.js' */
define("confluence-macro-browser/macro-browser-cql",["ajs","underscore","confluence/templates","confluence-ui-components/js/cql/cql-component","jquery"],function(i,g,m,n,d){function j(b){var a=b.param;return d.extend({},b,a.options,{defaultValue:a.defaultValue||a.options.defaultValue,select2CustomOptions:b.cqlSelect2CustomOptions})}function k(b){return d(m.MacroBrowser.CQL.sections({hasRenderParameters:0<b.renderParams.length}))}return{build:function(b){var a=k(b),e=b.container;e.append(a);e.bind("cql-field-adding",
function(b,c){c.element.addClass("macro-param-div");c.element.find(".cql-field-input").addClass("macro-param-input")});e.addClass("loading");a.filter(".cql-render-heading").find("button").click(function(){var b=d(this),c=b.closest(".cql-render-heading").next(),a=c.is(":visible");a?c.slideUp(300):(c.removeClass("hidden").show(),c=d(".cql-render-heading").position().top,d(".macro-input-fields").animate({scrollTop:c},300));a=a?"Show":"Hide";
b.text(a)});var f,h={param:b.cqlParam,value:b.cqlValue,container:a.filter(".cql-filter-fields"),cqlSelect2CustomOptions:b.cqlSelect2CustomOptions},h=j(h);f=n.build(h);e.data("cqlComponent",f);var l=d.Deferred();f.loading.done(function(){var a=b.cqlParam.options.requiredFields;if(a){var c=a.split(",");g.each(f.fieldRegistry||f.fieldArrays,function(a){var d=!1;g.each(a,function(a){!d&&g.contains(c,a.fieldName)&&(b.flagRequiredParam(a.element),d=!0,a.onChange(b.paramChanged))})})}e.removeClass("loading");
l.resolve()});return{elements:a,loading:l}},_makeCqlComponentOptions:j,_renderCqlSections:k}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'soy/macro-browser-cql.soy' */
// This file was automatically generated from macro-browser-cql.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.MacroBrowser.CQL.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.MacroBrowser == 'undefined') { Confluence.Templates.MacroBrowser = {}; }
if (typeof Confluence.Templates.MacroBrowser.CQL == 'undefined') { Confluence.Templates.MacroBrowser.CQL = {}; }


Confluence.Templates.MacroBrowser.CQL.sections = function(opt_data, opt_ignored) {
  return '<div class="cql-filter-fields"></div>' + ((opt_data.hasRenderParameters) ? '<h4 class="cql-render-heading"><span>' + soy.$$escapeHtml('Options') + '</span>' + aui.buttons.button({type: 'link', text: 'Show', extraAttributes: {type: 'button'}}) + '</h4><div class="cql-render-fields hidden"></div>' : '');
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.CQL.sections.soyTemplateName = 'Confluence.Templates.MacroBrowser.CQL.sections';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser-editor.js' */
define("confluence-macro-browser/macro-browser-editor","ajs jquery confluence/legacy confluence-macro-browser/macro-browser-cql confluence/macro-js-overrides underscore".split(" "),function(r,e,q,v,s,t){return function(k){function o(d){var a=e("#macro-insert-container").find(".macro-name").val(),b,c=k,f={},g;g={};for(var h=0,l=d.formDetails.parameters.length;h<l;h++){var j=d.formDetails.parameters[h],i;if(j.type&&j.type.name==="cql")i=e(".macro-input-fields form").data("cqlComponent").getValue();
else{i=e("#macro-param-"+j.name);var n=i.val();i.attr("type")=="checkbox"&&(n=""+i.prop("checked"));i=n}if(i){j.shared&&(f[j.name]=i);if(j.hidden||!j.defaultValue||j.defaultValue!=i)g[j.name]=i}}g[""]&&(b=g[""]);e.extend(g,c.unknownParams);(h=s.getFunction(a,"beforeParamsRetrieved"))&&(g=h(g,d,f));return{name:a,bodyHtml:c.getMacroBody(),params:g,defaultParameterValue:b}}function w(d,a,b){a.pluginKey=d.pluginKey;a.macroName=d.macroName;var c=k,f,g=a.type.name;if(b){var h=b.fields&&b.fields[g];h&&typeof h!==
"function"&&(h=h[a.name]);typeof h==="function"&&(f=h.call(b,a))}if(!f){g in c.ParameterFields&&typeof c.ParameterFields[g]==="function"||(g="string");f=c.ParameterFields[g](a)}c.fields[a.name]=f;b=f.paramDiv;c=f.input;f="macro-param-"+a.name;b.attr("id","macro-param-div-"+a.name);c.addClass("macro-param-input").attr("id",f);a.hidden&&b.hide();c=d.pluginKey;if(a.displayName==k.Utils.makeDefaultKey(c,d.macroName,"param",a.name,"label"))a.displayName=a.name;if(a.description==k.Utils.makeDefaultKey(c,
d.macroName,"param",a.name,"desc"))a.description="";e("label",b).attr("for",f).text(a.displayName);a.required&&u(b);a.description&&b.append(q.Templates.MacroBrowser.macroParameterDesc({description:a.description}));return b}function u(d){var a=d.find("label"),b=a.text()+" *";a.text(b);d.addClass("required")}return{loadMacroInBrowser:function(d){if(!d||!d.formDetails){r.trigger("analytics",{name:"macro-browser.unknown-macro-error"});alert("Could not load unknown macro in the macro browser.")}else{var a=
require("tinymce"),b=k,c=d.formDetails,f=c.macroName,g=s.get(f),h=b.settings.selectedMacro,l=a.confluence.macrobrowser.editedMacroDiv;if(g&&typeof g.opener==="function"){b.close();g.opener({name:f})}else{var a=c.parameters,j=t.find(a,function(a){return a.type.name==="cql"});e("#save-warning-span").addClass("hidden");e("#macro-insert-container .macro-name").val(f);var i=e("#macro-insert-container .macro-input-fields form");i.empty();var n=d.extendedDescription||d.description;if(j)c.documentationLink&&
b.UI.setHelpLink(b.dialog,{href:c.documentationLink});else if(n||c.documentationLink){n=e(q.Templates.MacroBrowser.macroDescription({descriptionHtml:n,documentationLink:c.documentationLink}));i.append(n)}if(c.body&&c.body.bodyType!="NONE"&&l&&e(l).hasClass("editor-inline-macro")){l=d.pluginKey;if(c.body.label==k.Utils.makeDefaultKey(l,f,"body","label"))c.body.label="";if(c.body.description==k.Utils.makeDefaultKey(l,f,"body","desc"))c.body.description="";c=c.body;l=b.selectedMacroDefinition;n=k;f=
e(q.Templates.MacroBrowser.macroBody());l=l?l.body:n.settings.selectedText;e("textarea",f).val(l||"");c.label&&e("label",f).text(c.label);c.description&&f.append(q.Templates.MacroBrowser.macroParameterDesc({description:c.description}));c.hidden&&f.hide();f&&i.append(f)}var m=h?e.extend({},h.params):{},o=i;if(j){var p;g&&g.fields&&(p=e.extend({},g.fields.cqlSelect2CustomOptions));a=t.without(a,j);p=v.build({cqlParam:j,renderParams:a,cqlValue:m.cql,container:i,flagRequiredParam:u,paramChanged:k.paramChanged,
cqlSelect2CustomOptions:p});delete m.cql;o=p.elements.filter(".cql-render-fields");p.loading.done(function(){k.paramChanged();k.Preview.previewMacro(d,h);k.UI.focusOnMacroDetailsFirstInput()})}e(a).each(function(){o.append(w(d,this,g))});g&&typeof g.beforeParamsSet==="function"&&(m=g.beforeParamsSet(m,!h));e(a).each(function(){var a;a=this.name==""?b.selectedMacroDefinition?b.selectedMacroDefinition.defaultParameterValue:this.defaultValue:m[this.name];a!=null?delete m[this.name]:e(this.aliases).each(function(){if(m[this]){a=
m[this];delete m[this]}});if(a==null)a=this.defaultValue;a!=null&&b.fields[this.name].setValue(a)});b.unknownParams=m;e("a",i).click(function(){var a=window.open(this.href,"_blank");a.focus();a.opener=null;return false});e("#macro-browser-dialog:visible").length||b.showBrowserDialog();a={};e.extend(true,a,d);if(!a.formDetails)a.formDetails={};if(!a.formDetails.body)a.formDetails.body={};b.dialog.activeMetadata=a;a.formDetails.body.content=b.settings.selectedMacro?b.settings.selectedMacro.body:a.formDetails.body.bodyType&&
a.formDetails.body.bodyType.toLowerCase()==="plain_text"?b.settings.selectedText:b.settings.selectedHtml}}},getMacroParametersFromForm:function(d){return o(d).params},getMacroDefinitionFromForm:o,processRequiredParameters:function(){if(e(".macro-input-fields form").is(".loading")){r.log("Form still loading - cannot processRequiredParameters");return false}var d=e("#macro-insert-container .macro-param-div.required .macro-param-input").not(".select2-container").filter(function(){var a=e(this).val();
return a===null||a===""}).length===0,a=d?"":"disabled",b=a?"addClass":"removeClass";e("#macro-browser-dialog button.ok").prop("disabled",a);e("#macro-browser-dialog .macro-preview-header .refresh-link").prop("disabled",a)[b]("disabled");return d}}}});require("confluence/module-exporter").safeRequire("confluence-macro-browser/macro-browser-editor");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser-preview.js' */
define("confluence-macro-browser/macro-browser-preview",["jquery","ajs","confluence/legacy","confluence/macro-js-overrides"],function(e,b,m,n){return function(d){function h(){return e("#macro-insert-container .macro-preview")}function l(){h().html("")}function i(b){b?(d.UI.showPreviewSpinner(!0),f.disable()):(d.UI.showPreviewSpinner(!1),f.enable())}var f={disable:function(){e("#macro-browser-preview-link").attr("disabled",!0).addClass("disabled")},enable:function(){e("#macro-browser-preview-link").removeAttr("disabled").removeClass("disabled")}};
return{previewMacro:function(j,g){var k=d;l();if(!d.Editor.processRequiredParameters())return b.trigger("analytics",{name:"macro-browser.missing-params-error"}),b.log("previewMacro: missing required params"),!1;"object"!==typeof g&&(g=d.Editor.getMacroDefinitionFromForm(j));var a=g.params,f=n.getFunction(j.macroName,"updateMacroParametersForPreview");f&&(a=f(a));a[""]&&delete a[""];k={contentId:m.getContentId(),macroName:j.macroName,params:a,body:k.getMacroBody(),defaultParameterValue:g.defaultParameterValue,
successCallback:function(a){var c=h().find("iframe")[0],c=c.contentDocument||c.contentWindow.document;c.write(a);c.close();e(c).ready(function(){b.trigger("macro-browser.preview-ready")});e("div.error span.error",c).length&&b.logError("Error rendering macro definition : ");setTimeout(function(){i(!1)},1E3)},errorCallback:function(a){b.logError(a);i(!1)}};a=b.params.staticResourceUrlPrefix+"/blank.html";h().html('<iframe src="'+a+'" frameborder="0" name="macro-browser-preview-frame" id="macro-preview-iframe"></iframe>');
i(!0);d.Rest.fetchMacroPreviewData(k)},removePreviewContainer:l}}});require("confluence/module-exporter").safeRequire("confluence-macro-browser/macro-browser-preview");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser-model.js' */
define("confluence-macro-browser/macro-browser-model",["ajs"],function(h){return function(f){function g(a){a.title==f.Utils.makeDefaultKey(a.pluginKey,a.macroName,"label")&&(a.title=a.macroName.charAt(0).toUpperCase()+a.macroName.substring(1).replace(/-/g," "));a.description==f.Utils.makeDefaultKey(a.pluginKey,a.macroName,"desc")&&(a.description="");a.id="macro-"+(a.alternateId||a.macroName);var b=[a.macroName,a.title].concat(a.aliases||[]);a.keywordsNoDesc=b.join(",");var d=a.description&&a.description.replace(/,/g,
" ")||"";b.push(d);a.keywords=b.join(",");return a}return{loadMacros:function(a){if(a){var b=f;b.metadataList=[];b.aliasMap={};for(var d=0,i=a.length;d<i;d++){var c=a[d],c=g(c);if(c.aliases)for(var e=0,j=c.aliases.length;e<j;e++)c.aliases[e]=c.aliases[e].toLowerCase(),b.aliasMap[c.aliases[e]]=c.macroName.toLowerCase();b.metadataList.push(c)}b.metadataList.sort(function(a,b){return a.title.toLowerCase()>b.title.toLowerCase()?1:-1})}else h.log("AJS.MacroBrowser.loadModel - no macro data, aborting")},
transformMetaDataDefault:g}}});require("confluence/module-exporter").safeRequire("confluence-macro-browser/macro-browser-model");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser-rest.js' */
define("confluence-macro-browser/macro-browser-rest",["jquery","ajs","wrm","confluence/api/constants"],function(b,f,g,d){function c(a){f.logError(a)}var h=g.data.claim("confluence.macro.metadata.provider:macro-browser-metadata-resources.macro-meta-client-cache-key");return{loadMacroMetadata:function(a){a.data=a.data||{};a.data.macroMetadataClientCacheKey=h;return b.ajax({type:"GET",cache:!0,timeout:a.timeout||3E4,dataType:"json",url:(a.context||d.CONTEXT_PATH)+"/plugins/macrobrowser/browse-macros.action",
data:a.data,success:a.successCallback,error:a.errorCallback||c}).promise()},fetchMacroMetadataDetails:function(a){var e={id:a.id};a.alternateId&&(e.alternateId=a.alternateId);b.ajax({type:"GET",dataType:"json",url:(a.context||d.CONTEXT_PATH)+"/plugins/macrobrowser/browse-macros-details.action",data:e,success:a.successCallback,error:a.errorCallback||c})},fetchMacroPreviewData:function(a){if(!a.contentId||!a.macroName)return(a.errorCallback||c)("invalid parameters");b.ajax({type:"POST",contentType:"application/json; charset=utf-8",
url:(a.context||d.CONTEXT_PATH)+"/rest/tinymce/1/macro/preview",data:b.toJSON({contentId:a.contentId,macro:{name:a.macroName,body:a.body,params:a.params,defaultParameterValue:a.defaultParameterValue}}),dataType:"html",success:a.successCallback,error:a.errorCallback||c})}}});require("confluence/module-exporter").safeRequire("confluence-macro-browser/macro-browser-rest");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser-UI.js' */
define("confluence-macro-browser/macro-browser-UI",["jquery","ajs","confluence/legacy","confluence/api/constants"],function(d,e,j,o){return function(k){function m(a){return d(j.Templates.MacroBrowser.macroSummaryList({category:a}))}function p(a,b){var g=d(j.Templates.MacroBrowser.macroSummaryItem());a.icon?g.prepend("<img src='"+((a.icon.relative?e.params.staticResourceUrlPrefix:"")+a.icon.location)+"' alt='icon' width='"+a.icon.width+"' height='"+a.icon.height+"' title='"+a.title+"'/>"):g.prepend("<span class='macro-icon-holder icon-"+
a.macroName+"'></span>");d(".macro-title",g).text(a.title);d(".macro-desc",g).prepend(a.description);if("gadget"==a.macroName){var f=a.gadgetUrl;f&&(f.match("^https?://.*")||(f=o.CONTEXT_PATH+"/"+f),d(".macro-title",g).after(j.Templates.MacroBrowser.gadgetLink({url:f})))}g.click(function(d){b(d,a)});return g}function q(a,b){var d;d=b?j.Templates.Dialog.helpLink(b):j.Templates.MacroBrowser.helpLink();a.getPage(a.curpage).element.find(".dialog-title").prepend(d)}return{createDialog:function(a){for(var b=
a.macros,g=a.onClickMacroSummary,f={all:m("all")},h=0,r=b.length;h<r;h++){var i=b[h];if(i.hidden)if(k.isHiddenMacroShown(i))i.categories.push("hidden-macros");else continue;f.all.append(p(i,g).attr("id",i.id));for(var n=0,s=i.categories.length;n<s;n++){var l=i.categories[n];f[l]=f[l]||m(l);f[l].append(p(i,g).attr("id",l+"-"+i.id))}}var c=e.ConfluenceDialog({width:a.width||865,height:a.height||530,id:"macro-browser-dialog",onSubmit:a.onSubmit,onCancel:a.onCancel});c.popup.element.on("keydown",".aui-button",
function(a){a.stopPropagation()});c.getPage(0).element.attr("id","select-macro-page");c.addHeader(a.title);c.addPanel("All",f.all,"all","category-button-all").getPanel(0).setPadding(0);b=0;for(g=a.categories.length;b<g;b++)h=a.categories[b],c.addPanel(h.displayName,f[h.name]||m(h.name),h.name,"category-button-"+h.name).getPanel(b+1).setPadding(0);c.addCancel("Cancel",a.onCancel);q(c);"VANILLA"==e.Meta.get("confluence-flavour")?c.addHelpText("<a href='{0}' id='marketplace-link'><span class='icon icon-marketplace'></span>{1}</a>",
[o.CONTEXT_PATH+"/plugins/servlet/upm/marketplace/featured?category=Macros&source=macro_browser","Find more macros..."]):c.addHelpText("Hint: type \u0022\u003cstrong\u003e{\u003c/strong\u003e\u0022 in the Editor to insert macros on the page.");f=d(j.Templates.MacroBrowser.insertMacroPanel());f.find("form").submit(function(a){k.complete();a.stopPropagation();return!1});d("#macro-browser-preview-link",f).click(function(a){d(this).prop("disabled")||k.previewMacro(c.activeMetadata);a.stopPropagation();return!1});c.addPage().addPanel("X",
f,"macro-input-panel").addLink("Select macro",function(a){a.prevPage();a.searcher.focus()},"dialog-back-link").addButton("insert.name",function(){k.complete()},"ok").addCancel("Cancel",function(){return a.onCancel()}).getPanel(0).setPadding(0);c.getPage(1).element.attr("id","macro-details-page");d("#macro-browser-dialog .dialog-button-panel .ok").before("<span id='save-warning-span' class='hidden'></span>");c.searcher=j.DomFilterField({items:"#macro-browser-dialog .dialog-panel-body #category-all .macro-list-item",
formId:"macro-browser-search-form",inputId:"macro-browser-search",searcher:function(a,b){var e=null;if(""!=b){c.getCurrentPanel()!=c.getPanel(0)&&c.gotoPanel(0);var f=k.searchSummaries(b),e={};d.each(f,function(){e[this.id]=this})}a.each(function(){!e||this.id in e?d(this).show():d(this).hide()})},submitCallback:function(a,b){""!=b&&1===a.length&&a.click()}});c.page[0].header.append(c.searcher.form);c.page[0].ontabchange=function(a){a!=c.getPanel(0,0)&&c.searcher.reset()};f=d(j.Templates.MacroBrowser.missingUserMacroMetadataPanel({showAdminMessage:e.Meta.getBoolean("is-admin")}));
c.addPage().addPanel("No macro metadata",f,"missing-metadata-panel").addLink("Back",function(a){a.gotoPage(0);a.searcher.focus()},"dialog-back-link").addCancel("Cancel",function(){return a.onCancel()});c.gotoPage(2);c.addHeader("No macro metadata");c.gotoPanel(0,0);c.ready=!0;return c},showBrowserSpinner:function(a){var b=d("#macro-browser-dialog");a?b.spin("large"):b.spinStop()},
showPreviewSpinner:function(a){var b=d("#macro-browser-preview");a?b.spin("large"):b.spinStop()},updateButtonText:function(a){var b=d("#macro-browser-dialog .dialog-button-panel .ok");"edit"==a?b.text("Save"):b.text("Insert")},enableSaveButton:function(a){d("#macro-browser-dialog .dialog-button-panel .ok").prop("disabled",!a)},focusOnMacroDetailsFirstInput:function(){var a=d("#macro-insert-container").find(".macro-input-fields :input:visible:not(button,.select2-offscreen)").first();
if(a.length){if(a.hasClass("select2-input")){var b=a.closest(".select2-container").parent().find(".select2-offscreen");if("function"!==typeof b.select2){e.log("select2Hidden is not a select2 hidden input, skipping focus attempt.");return}b.select2("open");b.select2("close")}else a.focus();!k.selectedMacroDefinition&&""!==a.val()&&a.select()}else e.log("No input to focus")},setHelpLink:q}}});require("confluence/module-exporter").safeRequire("confluence-macro-browser/macro-browser-UI");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser.js' */
define("confluence-macro-browser/macro-browser","window jquery ajs confluence-macro-browser/macro-browser-utils confluence-macro-browser/macro-browser-editor confluence-macro-browser/macro-browser-fields confluence-macro-browser/macro-browser-model confluence-macro-browser/macro-browser-preview confluence-macro-browser/macro-browser-rest confluence-macro-browser/macro-browser-UI confluence-macro-browser/macro-browser-smartfields confluence-macro-browser/macro-parameter-serializer confluence/macro-js-overrides underscore".split(" "),
function(k,h,e,r,s,l,t,u,v,w,x,y,i){var a={},l=l(a);a.ParameterFields=l.ParameterFields;a.Field=l.Field;x(a,a.ParameterFields);a.Utils=r;a.Editor=s(a);a.Preview=u(a);a.Model=t(a);a.Rest=v;a.UI=w(a);var f,g=function(b,c){var d={id:b.macroName,successCallback:function(b){if(b&&b.details)b.details=a.Model.transformMetaDataDefault(b.details);a.Editor.loadMacroInBrowser(b.details,c);g.displayDetails();a.Preview.previewMacro(b.details)},errorCallback:function(){e.trigger("analytics",{name:"macro-browser.fetch-metadata-error"});
k.alert("There has been an error loading the macro browser. Please try again or see your system administrator.");g.displayDetails()}};if(b.alternateId)d.alternateId=b.alternateId;g.setUI(c,b.title);a.Rest.fetchMacroMetadataDetails(d)};g.setUI=function(b,c){var d=b=="edit"?a.editTitle:a.insertTitle;h("#macro-insert-container").hide();a.UI.updateButtonText(b);a.UI.enableSaveButton(false);a.dialog.gotoPage(1).addHeader(d.replace(/\{0\}/,c));a.dialog.show();a.UI.showBrowserSpinner(true)};g.displayDetails=function(){a.UI.showBrowserSpinner(false);a.UI.enableSaveButton(false);
h("#macro-insert-container").show();a.UI.focusOnMacroDetailsFirstInput()};a.reset=function(){f&&f.resolve&&f.resolve();f=null;a.initMacroBrowserAfterRequest=null;a.initData=null;a.hasInit=false;a.metadataList=[];a.aliasMap={};a.fields={};i.reset();a.Macros=i.elements()};a.getMacroJsOverride=i.get;a.setMacroJsOverride=i.put;a.Macros=i.elements();a.hasInit=false;a.metadataList=[];a.aliasMap={};a.fields={};a.processRequiredParameters=function(){return a.Editor.processRequiredParameters()};a.paramChanged=
function(){a.Editor.processRequiredParameters()};a.loadMacroInBrowser=function(b,c){a.Editor.loadMacroInBrowser(b,c)};a.getMacroDefinitionFromForm=function(b){a.Editor.getMacroDefinitionFromForm(b)};a.getMacroParametersFromForm=function(b){a.Editor.getMacroParametersFromForm(b)};a.previewMacro=function(b){a.Preview.previewMacro(b)};a.previewOnload=function(b){var c=i.getFunction(a.dialog.activeMetadata.macroName,"postPreview");c&&c(h("#macro-preview-iframe")[0],a.dialog.activeMetadata);e.Editor.disableFrame(b);
h(b).click(function(a){if(a.target.tagName.toLowerCase()==="a"){if((a=h(a.target).attr("href"))&&a.indexOf("#")!=0&&a.indexOf(k.location)==-1){a=k.open(a,"_blank");a.focus();a.opener=null}return false}})};a.getMacroMetadata=function(b){for(var c=0,d=a.metadataList.length;c<d;c++){var j=a.metadataList[c];if(j.macroName==b)return j}return null};a.getMetadataPromise=function(){return f};a.open=function(b){if(!b){b={};e.log("No settings to open the macro browser.")}var c=b.selectedMacro;!c&&b.presetMacroMetadata&&
(c={name:b.presetMacroMetadata.macroName});if(c&&c.name){var d=i.getFunction(c.name,"opener");if(d){d(c);return}}if(!a.hasInit){e.debug("init macro browser");a.UI.showBrowserSpinner(true);if(a.initData!==null&&h.isEmptyObject(a.initData)){e.trigger("analytics",{name:"macro-browser.init-reattempt"});e.logError("Macro browser preload failed. Trying again...");a.initMacroBrowserAfterRequest=b;a.preLoadMacro();return}if(a.initData)a.initBrowser();else{e.trigger("analytics",{name:"macro-browser.init-overlap"});
e.debug("Waiting for macro browser preloading...");a.initMacroBrowserAfterRequest=b;return}}a.openMacroBrowser(b)};a.openMacroBrowser=function(b){a.settings=b;a.selectedMacroDefinition=b.selectedMacro;var c=a.selectedMacroDefinition&&a.selectedMacroDefinition.name||b.presetMacroName;if(b.presetMacroName)b.presetMacroMetadata=a.getMacroMetadata(b.presetMacroName);var d=b.presetMacroMetadata;if(!d){var j=b.selectedMacro;if(j){var c=j.name.toLowerCase(),c=a.aliasMap[c]||c,f=i.getFunction(c,"updateSelectedMacro"),
g=i.getFunction(c,"getMacroDetailsFromSelectedMacro");f&&f(j);g&&(d=g(a.metadataList,j));d||(d=a.getMacroMetadata(c))}}j=h("#macro-browser-dialog").find("button.back");if(d){e.debug("Open macro browser to edit macro: "+d.macroName);j.hide();a.replicateSelectMacro(d,b.mode||"edit")}else if(c){j.show();a.dialog.overrideLastTab();a.dialog.gotoPage(2);a.showBrowserDialog()}else{j.show();if(b.selectedCategory){c=h("#select-macro-page .dialog-page-menu button").index(h("#category-button-"+b.selectedCategory));
c<0&&(c=0);a.dialog.overrideLastTab();a.dialog.gotoPanel(0,c)}else a.dialog.gotoPage(0);a.showBrowserDialog();a.dialog.searcher.focusAndSearch(b.searchText)}};a.showBrowserDialog=function(){a.dialog.show();a.UI.showBrowserSpinner(false)};a.complete=function(){if(h("#macro-browser-dialog .dialog-button-panel .ok").is(":visible:not(:disabled)")){var b=a.dialog.activeMetadata,c=i.getFunction(b.macroName,"manipulateMarkup");c&&c(b);b=a.Editor.getMacroDefinitionFromForm(b);a.close();if(a.settings.onComplete)a.settings.onComplete(b)}};
a.cancel=function(){a.close();if(typeof a.settings.onCancel==="function")a.settings.onCancel();return false};a.close=function(){this.unknownParams={};this.fields={};a.Preview.removePreviewContainer();this.dialog.hide()};a.replicateSelectMacro=function(a,c){g(a,c)};a.initBrowser=function(){var b=a.initData;if(!b.categories||!a.metadataList.length){e.trigger("analytics",{name:"macro-browser.init-browser-error"});k.alert("There has been an error loading the macro browser. Please try again or see your system administrator.");a.UI.showBrowserSpinner(false);
return false}a.editTitle=b.editTitle;a.insertTitle=b.insertTitle;var c;b.categories=h.map(b.categories,function(a){if(a.name=="hidden-macros"){c=a;return null}return a});b.categories.sort(function(a,b){return a.displayName.toLowerCase()>b.displayName.toLowerCase()?1:-1});c&&e.params.showHiddenUserMacros&&b.categories.push(c);a.dialog=a.UI.createDialog({title:b.title,categories:b.categories,macros:a.metadataList,onClickMacroSummary:function(a,b){a.preventDefault();g(b,"insert")},onSubmit:a.complete,
onCancel:a.cancel});return a.hasInit=true};a.searchSummaries=function(b,c){var c=h.extend({splitRegex:/[\s-]+/},c),d;d=a.metadataList;var e,f,i,g,m,k,l,p,n,o,q;if(b){e=c&&c.keywordsField||"keywords";f=c&&c.ignoreForCamelCase?"i":"";i=c&&c.matchBoundary?"\\b":"";g=c&&c.splitRegex||/\s+/;g=b.split(g);m=[];g.forEach(function(a){k=[RegExp(i+a,"i")];if(/^([A-Z][a-z]*) {2,}$/.test(this)){l=this.replace(/([A-Z][a-z]*)/g,"\\b$1[^,]*");k.push(RegExp(l,f))}m.push(k)});p=[];d.forEach(function(a){for(n=0;n<m.length;n++){q=
false;for(o=0;o<m[n].length;o++)if(m[n][o].test(a[e])){q=true;break}if(!q)return}p.push(a)});d=p}else d=[];return d};a.getMacroBody=function(){var b="";if(h("#macro-insert-container .macro-body-div textarea").length)b=h("#macro-insert-container .macro-body-div textarea").val();else if(a.selectedMacroDefinition){if(a.selectedMacroDefinition.body)b=a.selectedMacroDefinition.body}else if(a.dialog.activeMetadata)b=a.dialog.activeMetadata.formDetails.body.content;return b};a.getMacroParams=function(a){return y.deserialize(a.getAttribute("data-macro-parameters"))};
a.getMacroName=function(a){return!a.hasAttribute("data-macro-name")?void 0:a.getAttribute("data-macro-name")};a.isHiddenMacroShown=function(a){return e.params.showHiddenUserMacros&&a.pluginKey=="_-user-macro-_"};a.hasRequiredParameters=function(a){return a.anyParameterRequired};a.setWhitelist=function(b){a.whitelist=b};a.preLoadMacro=function(){a.initData=null;if(f&&f.state()==="pending")return f;f=a.Rest.loadMacroMetadata({data:a.whitelist?{whitelist:a.whitelist}:{detailed:false},successCallback:function(b){a.initData=
b;a.Model.loadMacros(b.macros);if(a.initMacroBrowserAfterRequest){a.initBrowser();a.openMacroBrowser(a.initMacroBrowserAfterRequest)}},errorCallback:function(b){e.trigger("analytics",{name:"macro-browser.preload-error"});e.logError("Error requesting macro browser metadata:");e.logError(b);a.initData={}}})};return a});require("confluence/module-exporter").exportModuleAsGlobal("confluence-macro-browser/macro-browser","AJS.MacroBrowser");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'soy/macro-browser.soy' */
// This file was automatically generated from macro-browser.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.MacroBrowser.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.MacroBrowser == 'undefined') { Confluence.Templates.MacroBrowser = {}; }


Confluence.Templates.MacroBrowser.macroSummaryList = function(opt_data, opt_ignored) {
  return '<ol id="category-' + soy.$$escapeHtml(opt_data.category) + '" class="macro-list"></ol>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.macroSummaryList.soyTemplateName = 'Confluence.Templates.MacroBrowser.macroSummaryList';
}


Confluence.Templates.MacroBrowser.macroSummaryItem = function(opt_data, opt_ignored) {
  return '<li class="macro-list-item"><h4 class="macro-title"></h4>' + Confluence.Templates.MacroBrowser.macroDescription({description: ''}) + '</li>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.macroSummaryItem.soyTemplateName = 'Confluence.Templates.MacroBrowser.macroSummaryItem';
}


Confluence.Templates.MacroBrowser.macroDescription = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  return '<div class="macro-desc">' + ((opt_data.descriptionHtml) ? soy.$$filterNoAutoescape(opt_data.descriptionHtml) : '') + ((opt_data.documentationLink) ? ' <a href="' + soy.$$escapeHtml(opt_data.documentationLink) + '" class="macro-doco-link">' + soy.$$escapeHtml('Documentation') + '</a>' : '') + '</div>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.macroDescription.soyTemplateName = 'Confluence.Templates.MacroBrowser.macroDescription';
}


Confluence.Templates.MacroBrowser.insertMacroPanel = function(opt_data, opt_ignored) {
  return '<div id="macro-insert-container"><input class="macro-name" type="hidden"/><div class="macro-input-fields dialog-panel"><form action="#" class="aui"></form></div><div class="macro-preview-container dialog-panel"><div class="macro-preview-header"><ul class="macro-preview-links"><li><a id="macro-browser-preview-link" class="refresh-link icon icon-refresh" href="#">' + soy.$$escapeHtml('Refresh') + '</a></li></ul><span>' + soy.$$escapeHtml('Preview') + '</span></div><div id="macro-browser-preview" class="macro-preview"></div></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.insertMacroPanel.soyTemplateName = 'Confluence.Templates.MacroBrowser.insertMacroPanel';
}


Confluence.Templates.MacroBrowser.missingUserMacroMetadataPanel = function(opt_data, opt_ignored) {
  return '<div id="macro-missing-metadata-container"><p>' + 'There is no metadata configured for this macro which means no configuration screen can be presented here.' + '</p>' + ((opt_data.showAdminMessage) ? '<p>' + AJS.format('If this is a user macro then you can add metadata to the template using the \x3ca href\x3d\x22{0}\x22 target\x3d\x22_blank\x22\x3eUser Macro Administration\x3c/a\x3e console.',"" + '/admin/usermacros.action') + '</p>' : '<p>' + 'You must contact an administrator to configure metadata for this macro.' + '</p>') + '</div>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.missingUserMacroMetadataPanel.soyTemplateName = 'Confluence.Templates.MacroBrowser.missingUserMacroMetadataPanel';
}


Confluence.Templates.MacroBrowser.macroParameter = function(opt_data, opt_ignored) {
  return '<div class="macro-param-div"><label></label><input type="text" class="text"/></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.macroParameter.soyTemplateName = 'Confluence.Templates.MacroBrowser.macroParameter';
}


Confluence.Templates.MacroBrowser.macroParameterBoolean = function(opt_data, opt_ignored) {
  return '<div class="checkbox macro-param-div boolean-param"><input class="checkbox" type="checkbox" value="true"/><label></label></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.macroParameterBoolean.soyTemplateName = 'Confluence.Templates.MacroBrowser.macroParameterBoolean';
}


Confluence.Templates.MacroBrowser.macroParameterSelect = function(opt_data, opt_ignored) {
  return '<div class="macro-param-div"><label></label><select class="select"></select></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.macroParameterSelect.soyTemplateName = 'Confluence.Templates.MacroBrowser.macroParameterSelect';
}


Confluence.Templates.MacroBrowser.macroParameterHidden = function(opt_data, opt_ignored) {
  return '<div class="macro-param-div"><input type="hidden"/></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.macroParameterHidden.soyTemplateName = 'Confluence.Templates.MacroBrowser.macroParameterHidden';
}


Confluence.Templates.MacroBrowser.macroParameterDesc = function(opt_data, opt_ignored) {
  return '<div class="macro-param-desc">' + soy.$$filterNoAutoescape(opt_data.description) + '</div>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.macroParameterDesc.soyTemplateName = 'Confluence.Templates.MacroBrowser.macroParameterDesc';
}


Confluence.Templates.MacroBrowser.macroBody = function(opt_data, opt_ignored) {
  return '<div class="macro-body-div"><label>' + soy.$$escapeHtml('Body text') + '</label><textarea class="monospaceInput textarea" type="text" rows="10"></textarea></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.macroBody.soyTemplateName = 'Confluence.Templates.MacroBrowser.macroBody';
}


Confluence.Templates.MacroBrowser.helpLink = function(opt_data, opt_ignored) {
  return '' + Confluence.Templates.Dialog.helpLink({href: "https://docs.atlassian.com/confluence/docs-717/Macros"});
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.helpLink.soyTemplateName = 'Confluence.Templates.MacroBrowser.helpLink';
}


Confluence.Templates.MacroBrowser.gadgetLink = function(opt_data, opt_ignored) {
  return '<a class=\'macro-uri\' href="' + soy.$$escapeHtml(opt_data.url) + '" title="' + soy.$$escapeHtml(opt_data.url) + '" target=\'_blank\'>' + soy.$$escapeHtml('Gadget URL') + '</a>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.gadgetLink.soyTemplateName = 'Confluence.Templates.MacroBrowser.gadgetLink';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser-preload.js' */
define("confluence-macro-browser/macro-browser-preload",["jquery","ajs","window"],function(a,b,c){return{macroBrowserPreload:function(){a(c).bind("render-content-loaded",function(c,d){a("#macro-preview-iframe").contents().find("body")[0]==d&&b.MacroBrowser.previewOnload(d)});b.MacroBrowser.preLoadMacro()}}});require("confluence/module-exporter").safeRequire("confluence-macro-browser/macro-browser-preload",function(a){require("ajs").toInit(a.macroBrowserPreload)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-frontend:split_vendors~moment', location = 'vendors~moment.js' */
(window.atlassianWebpackJsonpe19a4f58490c3d96a3072d1e47cd0e73=window.atlassianWebpackJsonpe19a4f58490c3d96a3072d1e47cd0e73||[]).push([[31],{107:function(e,t,n){(function(e){e.exports=function(){"use strict";var t,n;function s(){return t.apply(null,arguments)}function i(e){return e instanceof Array||"[object Array]"===Object.prototype.toString.call(e)}function r(e){return null!=e&&"[object Object]"===Object.prototype.toString.call(e)}function a(e){return void 0===e}function o(e){return"number"==typeof e||"[object Number]"===Object.prototype.toString.call(e)}function u(e){return e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)}function l(e,t){var n,s=[];for(n=0;n<e.length;++n)s.push(t(e[n],n));return s}function h(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function d(e,t){for(var n in t)h(t,n)&&(e[n]=t[n]);return h(t,"toString")&&(e.toString=t.toString),h(t,"valueOf")&&(e.valueOf=t.valueOf),e}function c(e,t,n,s){return St(e,t,n,s,!0).utc()}function f(e){return null==e._pf&&(e._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null,rfc2822:!1,weekdayMismatch:!1}),e._pf}function m(e){if(null==e._isValid){var t=f(e),s=n.call(t.parsedDateParts,(function(e){return null!=e})),i=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&s);if(e._strict&&(i=i&&0===t.charsLeftOver&&0===t.unusedTokens.length&&void 0===t.bigHour),null!=Object.isFrozen&&Object.isFrozen(e))return i;e._isValid=i}return e._isValid}function _(e){var t=c(NaN);return null!=e?d(f(t),e):f(t).userInvalidated=!0,t}n=Array.prototype.some?Array.prototype.some:function(e){for(var t=Object(this),n=t.length>>>0,s=0;s<n;s++)if(s in t&&e.call(this,t[s],s,t))return!0;return!1};var y=s.momentProperties=[];function g(e,t){var n,s,i;if(a(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),a(t._i)||(e._i=t._i),a(t._f)||(e._f=t._f),a(t._l)||(e._l=t._l),a(t._strict)||(e._strict=t._strict),a(t._tzm)||(e._tzm=t._tzm),a(t._isUTC)||(e._isUTC=t._isUTC),a(t._offset)||(e._offset=t._offset),a(t._pf)||(e._pf=f(t)),a(t._locale)||(e._locale=t._locale),y.length>0)for(n=0;n<y.length;n++)a(i=t[s=y[n]])||(e[s]=i);return e}var p=!1;function w(e){g(this,e),this._d=new Date(null!=e._d?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),!1===p&&(p=!0,s.updateOffset(this),p=!1)}function v(e){return e instanceof w||null!=e&&null!=e._isAMomentObject}function M(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function k(e){var t=+e,n=0;return 0!==t&&isFinite(t)&&(n=M(t)),n}function S(e,t,n){var s,i=Math.min(e.length,t.length),r=Math.abs(e.length-t.length),a=0;for(s=0;s<i;s++)(n&&e[s]!==t[s]||!n&&k(e[s])!==k(t[s]))&&a++;return a+r}function D(e){!1===s.suppressDeprecationWarnings&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+e)}function Y(e,t){var n=!0;return d((function(){if(null!=s.deprecationHandler&&s.deprecationHandler(null,e),n){for(var i,r=[],a=0;a<arguments.length;a++){if(i="","object"==typeof arguments[a]){for(var o in i+="\n["+a+"] ",arguments[0])i+=o+": "+arguments[0][o]+", ";i=i.slice(0,-2)}else i=arguments[a];r.push(i)}D(e+"\nArguments: "+Array.prototype.slice.call(r).join("")+"\n"+(new Error).stack),n=!1}return t.apply(this,arguments)}),t)}var O,T={};function b(e,t){null!=s.deprecationHandler&&s.deprecationHandler(e,t),T[e]||(D(t),T[e]=!0)}function x(e){return e instanceof Function||"[object Function]"===Object.prototype.toString.call(e)}function P(e,t){var n,s=d({},e);for(n in t)h(t,n)&&(r(e[n])&&r(t[n])?(s[n]={},d(s[n],e[n]),d(s[n],t[n])):null!=t[n]?s[n]=t[n]:delete s[n]);for(n in e)h(e,n)&&!h(t,n)&&r(e[n])&&(s[n]=d({},s[n]));return s}function W(e){null!=e&&this.set(e)}s.suppressDeprecationWarnings=!1,s.deprecationHandler=null,O=Object.keys?Object.keys:function(e){var t,n=[];for(t in e)h(e,t)&&n.push(t);return n};var C={};function H(e,t){var n=e.toLowerCase();C[n]=C[n+"s"]=C[t]=e}function R(e){return"string"==typeof e?C[e]||C[e.toLowerCase()]:void 0}function U(e){var t,n,s={};for(n in e)h(e,n)&&(t=R(n))&&(s[t]=e[n]);return s}var F={};function L(e,t){F[e]=t}function N(e,t,n){var s=""+Math.abs(e),i=t-s.length;return(e>=0?n?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+s}var G=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,V=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,E={},I={};function A(e,t,n,s){var i=s;"string"==typeof s&&(i=function(){return this[s]()}),e&&(I[e]=i),t&&(I[t[0]]=function(){return N(i.apply(this,arguments),t[1],t[2])}),n&&(I[n]=function(){return this.localeData().ordinal(i.apply(this,arguments),e)})}function j(e,t){return e.isValid()?(t=Z(t,e.localeData()),E[t]=E[t]||function(e){var t,n,s,i=e.match(G);for(t=0,n=i.length;t<n;t++)I[i[t]]?i[t]=I[i[t]]:i[t]=(s=i[t]).match(/\[[\s\S]/)?s.replace(/^\[|\]$/g,""):s.replace(/\\/g,"");return function(t){var s,r="";for(s=0;s<n;s++)r+=x(i[s])?i[s].call(t,e):i[s];return r}}(t),E[t](e)):e.localeData().invalidDate()}function Z(e,t){var n=5;function s(e){return t.longDateFormat(e)||e}for(V.lastIndex=0;n>=0&&V.test(e);)e=e.replace(V,s),V.lastIndex=0,n-=1;return e}var z=/\d/,$=/\d\d/,J=/\d{3}/,q=/\d{4}/,B=/[+-]?\d{6}/,Q=/\d\d?/,X=/\d\d\d\d?/,K=/\d\d\d\d\d\d?/,ee=/\d{1,3}/,te=/\d{1,4}/,ne=/[+-]?\d{1,6}/,se=/\d+/,ie=/[+-]?\d+/,re=/Z|[+-]\d\d:?\d\d/gi,ae=/Z|[+-]\d\d(?::?\d\d)?/gi,oe=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,ue={};function le(e,t,n){ue[e]=x(t)?t:function(e,s){return e&&n?n:t}}function he(e,t){return h(ue,e)?ue[e](t._strict,t._locale):new RegExp(de(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,(function(e,t,n,s,i){return t||n||s||i}))))}function de(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var ce={};function fe(e,t){var n,s=t;for("string"==typeof e&&(e=[e]),o(t)&&(s=function(e,n){n[t]=k(e)}),n=0;n<e.length;n++)ce[e[n]]=s}function me(e,t){fe(e,(function(e,n,s,i){s._w=s._w||{},t(e,s._w,s,i)}))}function _e(e,t,n){null!=t&&h(ce,e)&&ce[e](t,n._a,n,e)}function ye(e){return ge(e)?366:365}function ge(e){return e%4==0&&e%100!=0||e%400==0}A("Y",0,0,(function(){var e=this.year();return e<=9999?""+e:"+"+e})),A(0,["YY",2],0,(function(){return this.year()%100})),A(0,["YYYY",4],0,"year"),A(0,["YYYYY",5],0,"year"),A(0,["YYYYYY",6,!0],0,"year"),H("year","y"),L("year",1),le("Y",ie),le("YY",Q,$),le("YYYY",te,q),le("YYYYY",ne,B),le("YYYYYY",ne,B),fe(["YYYYY","YYYYYY"],0),fe("YYYY",(function(e,t){t[0]=2===e.length?s.parseTwoDigitYear(e):k(e)})),fe("YY",(function(e,t){t[0]=s.parseTwoDigitYear(e)})),fe("Y",(function(e,t){t[0]=parseInt(e,10)})),s.parseTwoDigitYear=function(e){return k(e)+(k(e)>68?1900:2e3)};var pe,we=ve("FullYear",!0);function ve(e,t){return function(n){return null!=n?(ke(this,e,n),s.updateOffset(this,t),this):Me(this,e)}}function Me(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function ke(e,t,n){e.isValid()&&!isNaN(n)&&("FullYear"===t&&ge(e.year())&&1===e.month()&&29===e.date()?e._d["set"+(e._isUTC?"UTC":"")+t](n,e.month(),Se(n,e.month())):e._d["set"+(e._isUTC?"UTC":"")+t](n))}function Se(e,t){if(isNaN(e)||isNaN(t))return NaN;var n,s=(t%(n=12)+n)%n;return e+=(t-s)/12,1===s?ge(e)?29:28:31-s%7%2}pe=Array.prototype.indexOf?Array.prototype.indexOf:function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1},A("M",["MM",2],"Mo",(function(){return this.month()+1})),A("MMM",0,0,(function(e){return this.localeData().monthsShort(this,e)})),A("MMMM",0,0,(function(e){return this.localeData().months(this,e)})),H("month","M"),L("month",8),le("M",Q),le("MM",Q,$),le("MMM",(function(e,t){return t.monthsShortRegex(e)})),le("MMMM",(function(e,t){return t.monthsRegex(e)})),fe(["M","MM"],(function(e,t){t[1]=k(e)-1})),fe(["MMM","MMMM"],(function(e,t,n,s){var i=n._locale.monthsParse(e,s,n._strict);null!=i?t[1]=i:f(n).invalidMonth=e}));var De=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,Ye="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),Oe="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_");function Te(e,t,n){var s,i,r,a=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],s=0;s<12;++s)r=c([2e3,s]),this._shortMonthsParse[s]=this.monthsShort(r,"").toLocaleLowerCase(),this._longMonthsParse[s]=this.months(r,"").toLocaleLowerCase();return n?"MMM"===t?-1!==(i=pe.call(this._shortMonthsParse,a))?i:null:-1!==(i=pe.call(this._longMonthsParse,a))?i:null:"MMM"===t?-1!==(i=pe.call(this._shortMonthsParse,a))||-1!==(i=pe.call(this._longMonthsParse,a))?i:null:-1!==(i=pe.call(this._longMonthsParse,a))||-1!==(i=pe.call(this._shortMonthsParse,a))?i:null}function be(e,t){var n;if(!e.isValid())return e;if("string"==typeof t)if(/^\d+$/.test(t))t=k(t);else if(!o(t=e.localeData().monthsParse(t)))return e;return n=Math.min(e.date(),Se(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,n),e}function xe(e){return null!=e?(be(this,e),s.updateOffset(this,!0),this):Me(this,"Month")}var Pe=oe,We=oe;function Ce(){function e(e,t){return t.length-e.length}var t,n,s=[],i=[],r=[];for(t=0;t<12;t++)n=c([2e3,t]),s.push(this.monthsShort(n,"")),i.push(this.months(n,"")),r.push(this.months(n,"")),r.push(this.monthsShort(n,""));for(s.sort(e),i.sort(e),r.sort(e),t=0;t<12;t++)s[t]=de(s[t]),i[t]=de(i[t]);for(t=0;t<24;t++)r[t]=de(r[t]);this._monthsRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+i.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+s.join("|")+")","i")}function He(e,t,n,s,i,r,a){var o;return e<100&&e>=0?(o=new Date(e+400,t,n,s,i,r,a),isFinite(o.getFullYear())&&o.setFullYear(e)):o=new Date(e,t,n,s,i,r,a),o}function Re(e){var t;if(e<100&&e>=0){var n=Array.prototype.slice.call(arguments);n[0]=e+400,t=new Date(Date.UTC.apply(null,n)),isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e)}else t=new Date(Date.UTC.apply(null,arguments));return t}function Ue(e,t,n){var s=7+t-n;return-(7+Re(e,0,s).getUTCDay()-t)%7+s-1}function Fe(e,t,n,s,i){var r,a,o=1+7*(t-1)+(7+n-s)%7+Ue(e,s,i);return o<=0?a=ye(r=e-1)+o:o>ye(e)?(r=e+1,a=o-ye(e)):(r=e,a=o),{year:r,dayOfYear:a}}function Le(e,t,n){var s,i,r=Ue(e.year(),t,n),a=Math.floor((e.dayOfYear()-r-1)/7)+1;return a<1?s=a+Ne(i=e.year()-1,t,n):a>Ne(e.year(),t,n)?(s=a-Ne(e.year(),t,n),i=e.year()+1):(i=e.year(),s=a),{week:s,year:i}}function Ne(e,t,n){var s=Ue(e,t,n),i=Ue(e+1,t,n);return(ye(e)-s+i)/7}function Ge(e,t){return e.slice(t,7).concat(e.slice(0,t))}A("w",["ww",2],"wo","week"),A("W",["WW",2],"Wo","isoWeek"),H("week","w"),H("isoWeek","W"),L("week",5),L("isoWeek",5),le("w",Q),le("ww",Q,$),le("W",Q),le("WW",Q,$),me(["w","ww","W","WW"],(function(e,t,n,s){t[s.substr(0,1)]=k(e)})),A("d",0,"do","day"),A("dd",0,0,(function(e){return this.localeData().weekdaysMin(this,e)})),A("ddd",0,0,(function(e){return this.localeData().weekdaysShort(this,e)})),A("dddd",0,0,(function(e){return this.localeData().weekdays(this,e)})),A("e",0,0,"weekday"),A("E",0,0,"isoWeekday"),H("day","d"),H("weekday","e"),H("isoWeekday","E"),L("day",11),L("weekday",11),L("isoWeekday",11),le("d",Q),le("e",Q),le("E",Q),le("dd",(function(e,t){return t.weekdaysMinRegex(e)})),le("ddd",(function(e,t){return t.weekdaysShortRegex(e)})),le("dddd",(function(e,t){return t.weekdaysRegex(e)})),me(["dd","ddd","dddd"],(function(e,t,n,s){var i=n._locale.weekdaysParse(e,s,n._strict);null!=i?t.d=i:f(n).invalidWeekday=e})),me(["d","e","E"],(function(e,t,n,s){t[s]=k(e)}));var Ve="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),Ee="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),Ie="Su_Mo_Tu_We_Th_Fr_Sa".split("_");function Ae(e,t,n){var s,i,r,a=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],s=0;s<7;++s)r=c([2e3,1]).day(s),this._minWeekdaysParse[s]=this.weekdaysMin(r,"").toLocaleLowerCase(),this._shortWeekdaysParse[s]=this.weekdaysShort(r,"").toLocaleLowerCase(),this._weekdaysParse[s]=this.weekdays(r,"").toLocaleLowerCase();return n?"dddd"===t?-1!==(i=pe.call(this._weekdaysParse,a))?i:null:"ddd"===t?-1!==(i=pe.call(this._shortWeekdaysParse,a))?i:null:-1!==(i=pe.call(this._minWeekdaysParse,a))?i:null:"dddd"===t?-1!==(i=pe.call(this._weekdaysParse,a))||-1!==(i=pe.call(this._shortWeekdaysParse,a))||-1!==(i=pe.call(this._minWeekdaysParse,a))?i:null:"ddd"===t?-1!==(i=pe.call(this._shortWeekdaysParse,a))||-1!==(i=pe.call(this._weekdaysParse,a))||-1!==(i=pe.call(this._minWeekdaysParse,a))?i:null:-1!==(i=pe.call(this._minWeekdaysParse,a))||-1!==(i=pe.call(this._weekdaysParse,a))||-1!==(i=pe.call(this._shortWeekdaysParse,a))?i:null}var je=oe,Ze=oe,ze=oe;function $e(){function e(e,t){return t.length-e.length}var t,n,s,i,r,a=[],o=[],u=[],l=[];for(t=0;t<7;t++)n=c([2e3,1]).day(t),s=this.weekdaysMin(n,""),i=this.weekdaysShort(n,""),r=this.weekdays(n,""),a.push(s),o.push(i),u.push(r),l.push(s),l.push(i),l.push(r);for(a.sort(e),o.sort(e),u.sort(e),l.sort(e),t=0;t<7;t++)o[t]=de(o[t]),u[t]=de(u[t]),l[t]=de(l[t]);this._weekdaysRegex=new RegExp("^("+l.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+u.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+o.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+a.join("|")+")","i")}function Je(){return this.hours()%12||12}function qe(e,t){A(e,0,0,(function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)}))}function Be(e,t){return t._meridiemParse}A("H",["HH",2],0,"hour"),A("h",["hh",2],0,Je),A("k",["kk",2],0,(function(){return this.hours()||24})),A("hmm",0,0,(function(){return""+Je.apply(this)+N(this.minutes(),2)})),A("hmmss",0,0,(function(){return""+Je.apply(this)+N(this.minutes(),2)+N(this.seconds(),2)})),A("Hmm",0,0,(function(){return""+this.hours()+N(this.minutes(),2)})),A("Hmmss",0,0,(function(){return""+this.hours()+N(this.minutes(),2)+N(this.seconds(),2)})),qe("a",!0),qe("A",!1),H("hour","h"),L("hour",13),le("a",Be),le("A",Be),le("H",Q),le("h",Q),le("k",Q),le("HH",Q,$),le("hh",Q,$),le("kk",Q,$),le("hmm",X),le("hmmss",K),le("Hmm",X),le("Hmmss",K),fe(["H","HH"],3),fe(["k","kk"],(function(e,t,n){var s=k(e);t[3]=24===s?0:s})),fe(["a","A"],(function(e,t,n){n._isPm=n._locale.isPM(e),n._meridiem=e})),fe(["h","hh"],(function(e,t,n){t[3]=k(e),f(n).bigHour=!0})),fe("hmm",(function(e,t,n){var s=e.length-2;t[3]=k(e.substr(0,s)),t[4]=k(e.substr(s)),f(n).bigHour=!0})),fe("hmmss",(function(e,t,n){var s=e.length-4,i=e.length-2;t[3]=k(e.substr(0,s)),t[4]=k(e.substr(s,2)),t[5]=k(e.substr(i)),f(n).bigHour=!0})),fe("Hmm",(function(e,t,n){var s=e.length-2;t[3]=k(e.substr(0,s)),t[4]=k(e.substr(s))})),fe("Hmmss",(function(e,t,n){var s=e.length-4,i=e.length-2;t[3]=k(e.substr(0,s)),t[4]=k(e.substr(s,2)),t[5]=k(e.substr(i))}));var Qe,Xe=ve("Hours",!0),Ke={calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},longDateFormat:{LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},invalidDate:"Invalid date",ordinal:"%d",dayOfMonthOrdinalParse:/\d{1,2}/,relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},months:Ye,monthsShort:Oe,week:{dow:0,doy:6},weekdays:Ve,weekdaysMin:Ie,weekdaysShort:Ee,meridiemParse:/[ap]\.?m?\.?/i},et={},tt={};function nt(e){return e?e.toLowerCase().replace("_","-"):e}function st(t){var n=null;if(!et[t]&&void 0!==e&&e&&e.exports)try{n=Qe._abbr,!function(){var e=new Error("Cannot find module 'undefined'");throw e.code="MODULE_NOT_FOUND",e}(),it(n)}catch(e){}return et[t]}function it(e,t){var n;return e&&((n=a(t)?at(e):rt(e,t))?Qe=n:"undefined"!=typeof console&&console.warn&&console.warn("Locale "+e+" not found. Did you forget to load it?")),Qe._abbr}function rt(e,t){if(null!==t){var n,s=Ke;if(t.abbr=e,null!=et[e])b("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),s=et[e]._config;else if(null!=t.parentLocale)if(null!=et[t.parentLocale])s=et[t.parentLocale]._config;else{if(null==(n=st(t.parentLocale)))return tt[t.parentLocale]||(tt[t.parentLocale]=[]),tt[t.parentLocale].push({name:e,config:t}),null;s=n._config}return et[e]=new W(P(s,t)),tt[e]&&tt[e].forEach((function(e){rt(e.name,e.config)})),it(e),et[e]}return delete et[e],null}function at(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return Qe;if(!i(e)){if(t=st(e))return t;e=[e]}return function(e){for(var t,n,s,i,r=0;r<e.length;){for(t=(i=nt(e[r]).split("-")).length,n=(n=nt(e[r+1]))?n.split("-"):null;t>0;){if(s=st(i.slice(0,t).join("-")))return s;if(n&&n.length>=t&&S(i,n,!0)>=t-1)break;t--}r++}return Qe}(e)}function ot(e){var t,n=e._a;return n&&-2===f(e).overflow&&(t=n[1]<0||n[1]>11?1:n[2]<1||n[2]>Se(n[0],n[1])?2:n[3]<0||n[3]>24||24===n[3]&&(0!==n[4]||0!==n[5]||0!==n[6])?3:n[4]<0||n[4]>59?4:n[5]<0||n[5]>59?5:n[6]<0||n[6]>999?6:-1,f(e)._overflowDayOfYear&&(t<0||t>2)&&(t=2),f(e)._overflowWeeks&&-1===t&&(t=7),f(e)._overflowWeekday&&-1===t&&(t=8),f(e).overflow=t),e}function ut(e,t,n){return null!=e?e:null!=t?t:n}function lt(e){var t,n,i,r,a,o=[];if(!e._d){for(i=function(e){var t=new Date(s.now());return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}(e),e._w&&null==e._a[2]&&null==e._a[1]&&function(e){var t,n,s,i,r,a,o,u;if(null!=(t=e._w).GG||null!=t.W||null!=t.E)r=1,a=4,n=ut(t.GG,e._a[0],Le(Dt(),1,4).year),s=ut(t.W,1),((i=ut(t.E,1))<1||i>7)&&(u=!0);else{r=e._locale._week.dow,a=e._locale._week.doy;var l=Le(Dt(),r,a);n=ut(t.gg,e._a[0],l.year),s=ut(t.w,l.week),null!=t.d?((i=t.d)<0||i>6)&&(u=!0):null!=t.e?(i=t.e+r,(t.e<0||t.e>6)&&(u=!0)):i=r}s<1||s>Ne(n,r,a)?f(e)._overflowWeeks=!0:null!=u?f(e)._overflowWeekday=!0:(o=Fe(n,s,i,r,a),e._a[0]=o.year,e._dayOfYear=o.dayOfYear)}(e),null!=e._dayOfYear&&(a=ut(e._a[0],i[0]),(e._dayOfYear>ye(a)||0===e._dayOfYear)&&(f(e)._overflowDayOfYear=!0),n=Re(a,0,e._dayOfYear),e._a[1]=n.getUTCMonth(),e._a[2]=n.getUTCDate()),t=0;t<3&&null==e._a[t];++t)e._a[t]=o[t]=i[t];for(;t<7;t++)e._a[t]=o[t]=null==e._a[t]?2===t?1:0:e._a[t];24===e._a[3]&&0===e._a[4]&&0===e._a[5]&&0===e._a[6]&&(e._nextDay=!0,e._a[3]=0),e._d=(e._useUTC?Re:He).apply(null,o),r=e._useUTC?e._d.getUTCDay():e._d.getDay(),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[3]=24),e._w&&void 0!==e._w.d&&e._w.d!==r&&(f(e).weekdayMismatch=!0)}}var ht=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,dt=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,ct=/Z|[+-]\d\d(?::?\d\d)?/,ft=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],mt=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],_t=/^\/?Date\((\-?\d+)/i;function yt(e){var t,n,s,i,r,a,o=e._i,u=ht.exec(o)||dt.exec(o);if(u){for(f(e).iso=!0,t=0,n=ft.length;t<n;t++)if(ft[t][1].exec(u[1])){i=ft[t][0],s=!1!==ft[t][2];break}if(null==i)return void(e._isValid=!1);if(u[3]){for(t=0,n=mt.length;t<n;t++)if(mt[t][1].exec(u[3])){r=(u[2]||" ")+mt[t][0];break}if(null==r)return void(e._isValid=!1)}if(!s&&null!=r)return void(e._isValid=!1);if(u[4]){if(!ct.exec(u[4]))return void(e._isValid=!1);a="Z"}e._f=i+(r||"")+(a||""),Mt(e)}else e._isValid=!1}var gt=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/;function pt(e){var t=parseInt(e,10);return t<=49?2e3+t:t<=999?1900+t:t}var wt={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function vt(e){var t,n,s,i,r,a,o,u=gt.exec(e._i.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,""));if(u){var l=(t=u[4],n=u[3],s=u[2],i=u[5],r=u[6],a=u[7],o=[pt(t),Oe.indexOf(n),parseInt(s,10),parseInt(i,10),parseInt(r,10)],a&&o.push(parseInt(a,10)),o);if(!function(e,t,n){return!e||Ee.indexOf(e)===new Date(t[0],t[1],t[2]).getDay()||(f(n).weekdayMismatch=!0,n._isValid=!1,!1)}(u[1],l,e))return;e._a=l,e._tzm=function(e,t,n){if(e)return wt[e];if(t)return 0;var s=parseInt(n,10),i=s%100;return(s-i)/100*60+i}(u[8],u[9],u[10]),e._d=Re.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),f(e).rfc2822=!0}else e._isValid=!1}function Mt(e){if(e._f!==s.ISO_8601)if(e._f!==s.RFC_2822){e._a=[],f(e).empty=!0;var t,n,i,r,a,o=""+e._i,u=o.length,l=0;for(i=Z(e._f,e._locale).match(G)||[],t=0;t<i.length;t++)r=i[t],(n=(o.match(he(r,e))||[])[0])&&((a=o.substr(0,o.indexOf(n))).length>0&&f(e).unusedInput.push(a),o=o.slice(o.indexOf(n)+n.length),l+=n.length),I[r]?(n?f(e).empty=!1:f(e).unusedTokens.push(r),_e(r,n,e)):e._strict&&!n&&f(e).unusedTokens.push(r);f(e).charsLeftOver=u-l,o.length>0&&f(e).unusedInput.push(o),e._a[3]<=12&&!0===f(e).bigHour&&e._a[3]>0&&(f(e).bigHour=void 0),f(e).parsedDateParts=e._a.slice(0),f(e).meridiem=e._meridiem,e._a[3]=function(e,t,n){var s;return null==n?t:null!=e.meridiemHour?e.meridiemHour(t,n):null!=e.isPM?((s=e.isPM(n))&&t<12&&(t+=12),s||12!==t||(t=0),t):t}(e._locale,e._a[3],e._meridiem),lt(e),ot(e)}else vt(e);else yt(e)}function kt(e){var t=e._i,n=e._f;return e._locale=e._locale||at(e._l),null===t||void 0===n&&""===t?_({nullInput:!0}):("string"==typeof t&&(e._i=t=e._locale.preparse(t)),v(t)?new w(ot(t)):(u(t)?e._d=t:i(n)?function(e){var t,n,s,i,r;if(0===e._f.length)return f(e).invalidFormat=!0,void(e._d=new Date(NaN));for(i=0;i<e._f.length;i++)r=0,t=g({},e),null!=e._useUTC&&(t._useUTC=e._useUTC),t._f=e._f[i],Mt(t),m(t)&&(r+=f(t).charsLeftOver,r+=10*f(t).unusedTokens.length,f(t).score=r,(null==s||r<s)&&(s=r,n=t));d(e,n||t)}(e):n?Mt(e):function(e){var t=e._i;a(t)?e._d=new Date(s.now()):u(t)?e._d=new Date(t.valueOf()):"string"==typeof t?function(e){var t=_t.exec(e._i);null===t?(yt(e),!1===e._isValid&&(delete e._isValid,vt(e),!1===e._isValid&&(delete e._isValid,s.createFromInputFallback(e)))):e._d=new Date(+t[1])}(e):i(t)?(e._a=l(t.slice(0),(function(e){return parseInt(e,10)})),lt(e)):r(t)?function(e){if(!e._d){var t=U(e._i);e._a=l([t.year,t.month,t.day||t.date,t.hour,t.minute,t.second,t.millisecond],(function(e){return e&&parseInt(e,10)})),lt(e)}}(e):o(t)?e._d=new Date(t):s.createFromInputFallback(e)}(e),m(e)||(e._d=null),e))}function St(e,t,n,s,a){var o,u={};return!0!==n&&!1!==n||(s=n,n=void 0),(r(e)&&function(e){if(Object.getOwnPropertyNames)return 0===Object.getOwnPropertyNames(e).length;var t;for(t in e)if(e.hasOwnProperty(t))return!1;return!0}(e)||i(e)&&0===e.length)&&(e=void 0),u._isAMomentObject=!0,u._useUTC=u._isUTC=a,u._l=n,u._i=e,u._f=t,u._strict=s,(o=new w(ot(kt(u))))._nextDay&&(o.add(1,"d"),o._nextDay=void 0),o}function Dt(e,t,n,s){return St(e,t,n,s,!1)}s.createFromInputFallback=Y("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged and will be removed in an upcoming major release. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",(function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))})),s.ISO_8601=function(){},s.RFC_2822=function(){};var Yt=Y("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",(function(){var e=Dt.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:_()})),Ot=Y("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",(function(){var e=Dt.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:_()}));function Tt(e,t){var n,s;if(1===t.length&&i(t[0])&&(t=t[0]),!t.length)return Dt();for(n=t[0],s=1;s<t.length;++s)t[s].isValid()&&!t[s][e](n)||(n=t[s]);return n}var bt=["year","quarter","month","week","day","hour","minute","second","millisecond"];function xt(e){var t=U(e),n=t.year||0,s=t.quarter||0,i=t.month||0,r=t.week||t.isoWeek||0,a=t.day||0,o=t.hour||0,u=t.minute||0,l=t.second||0,h=t.millisecond||0;this._isValid=function(e){for(var t in e)if(-1===pe.call(bt,t)||null!=e[t]&&isNaN(e[t]))return!1;for(var n=!1,s=0;s<bt.length;++s)if(e[bt[s]]){if(n)return!1;parseFloat(e[bt[s]])!==k(e[bt[s]])&&(n=!0)}return!0}(t),this._milliseconds=+h+1e3*l+6e4*u+1e3*o*60*60,this._days=+a+7*r,this._months=+i+3*s+12*n,this._data={},this._locale=at(),this._bubble()}function Pt(e){return e instanceof xt}function Wt(e){return e<0?-1*Math.round(-1*e):Math.round(e)}function Ct(e,t){A(e,0,0,(function(){var e=this.utcOffset(),n="+";return e<0&&(e=-e,n="-"),n+N(~~(e/60),2)+t+N(~~e%60,2)}))}Ct("Z",":"),Ct("ZZ",""),le("Z",ae),le("ZZ",ae),fe(["Z","ZZ"],(function(e,t,n){n._useUTC=!0,n._tzm=Rt(ae,e)}));var Ht=/([\+\-]|\d\d)/gi;function Rt(e,t){var n=(t||"").match(e);if(null===n)return null;var s=((n[n.length-1]||[])+"").match(Ht)||["-",0,0],i=60*s[1]+k(s[2]);return 0===i?0:"+"===s[0]?i:-i}function Ut(e,t){var n,i;return t._isUTC?(n=t.clone(),i=(v(e)||u(e)?e.valueOf():Dt(e).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+i),s.updateOffset(n,!1),n):Dt(e).local()}function Ft(e){return 15*-Math.round(e._d.getTimezoneOffset()/15)}function Lt(){return!!this.isValid()&&this._isUTC&&0===this._offset}s.updateOffset=function(){};var Nt=/^(\-|\+)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/,Gt=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Vt(e,t){var n,s,i,r,a,u,l=e,d=null;return Pt(e)?l={ms:e._milliseconds,d:e._days,M:e._months}:o(e)?(l={},t?l[t]=e:l.milliseconds=e):(d=Nt.exec(e))?(n="-"===d[1]?-1:1,l={y:0,d:k(d[2])*n,h:k(d[3])*n,m:k(d[4])*n,s:k(d[5])*n,ms:k(Wt(1e3*d[6]))*n}):(d=Gt.exec(e))?(n="-"===d[1]?-1:1,l={y:Et(d[2],n),M:Et(d[3],n),w:Et(d[4],n),d:Et(d[5],n),h:Et(d[6],n),m:Et(d[7],n),s:Et(d[8],n)}):null==l?l={}:"object"==typeof l&&("from"in l||"to"in l)&&(r=Dt(l.from),a=Dt(l.to),i=r.isValid()&&a.isValid()?(a=Ut(a,r),r.isBefore(a)?u=It(r,a):((u=It(a,r)).milliseconds=-u.milliseconds,u.months=-u.months),u):{milliseconds:0,months:0},(l={}).ms=i.milliseconds,l.M=i.months),s=new xt(l),Pt(e)&&h(e,"_locale")&&(s._locale=e._locale),s}function Et(e,t){var n=e&&parseFloat(e.replace(",","."));return(isNaN(n)?0:n)*t}function It(e,t){var n={};return n.months=t.month()-e.month()+12*(t.year()-e.year()),e.clone().add(n.months,"M").isAfter(t)&&--n.months,n.milliseconds=+t-+e.clone().add(n.months,"M"),n}function At(e,t){return function(n,s){var i;return null===s||isNaN(+s)||(b(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),i=n,n=s,s=i),jt(this,Vt(n="string"==typeof n?+n:n,s),e),this}}function jt(e,t,n,i){var r=t._milliseconds,a=Wt(t._days),o=Wt(t._months);e.isValid()&&(i=null==i||i,o&&be(e,Me(e,"Month")+o*n),a&&ke(e,"Date",Me(e,"Date")+a*n),r&&e._d.setTime(e._d.valueOf()+r*n),i&&s.updateOffset(e,a||o))}Vt.fn=xt.prototype,Vt.invalid=function(){return Vt(NaN)};var Zt=At(1,"add"),zt=At(-1,"subtract");function $t(e,t){var n=12*(t.year()-e.year())+(t.month()-e.month()),s=e.clone().add(n,"months");return-(n+(t-s<0?(t-s)/(s-e.clone().add(n-1,"months")):(t-s)/(e.clone().add(n+1,"months")-s)))||0}function Jt(e){var t;return void 0===e?this._locale._abbr:(null!=(t=at(e))&&(this._locale=t),this)}s.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",s.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var qt=Y("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",(function(e){return void 0===e?this.localeData():this.locale(e)}));function Bt(){return this._locale}function Qt(e,t){return(e%t+t)%t}function Xt(e,t,n){return e<100&&e>=0?new Date(e+400,t,n)-126227808e5:new Date(e,t,n).valueOf()}function Kt(e,t,n){return e<100&&e>=0?Date.UTC(e+400,t,n)-126227808e5:Date.UTC(e,t,n)}function en(e,t){A(0,[e,e.length],0,t)}function tn(e,t,n,s,i){var r;return null==e?Le(this,s,i).year:(t>(r=Ne(e,s,i))&&(t=r),nn.call(this,e,t,n,s,i))}function nn(e,t,n,s,i){var r=Fe(e,t,n,s,i),a=Re(r.year,0,r.dayOfYear);return this.year(a.getUTCFullYear()),this.month(a.getUTCMonth()),this.date(a.getUTCDate()),this}A(0,["gg",2],0,(function(){return this.weekYear()%100})),A(0,["GG",2],0,(function(){return this.isoWeekYear()%100})),en("gggg","weekYear"),en("ggggg","weekYear"),en("GGGG","isoWeekYear"),en("GGGGG","isoWeekYear"),H("weekYear","gg"),H("isoWeekYear","GG"),L("weekYear",1),L("isoWeekYear",1),le("G",ie),le("g",ie),le("GG",Q,$),le("gg",Q,$),le("GGGG",te,q),le("gggg",te,q),le("GGGGG",ne,B),le("ggggg",ne,B),me(["gggg","ggggg","GGGG","GGGGG"],(function(e,t,n,s){t[s.substr(0,2)]=k(e)})),me(["gg","GG"],(function(e,t,n,i){t[i]=s.parseTwoDigitYear(e)})),A("Q",0,"Qo","quarter"),H("quarter","Q"),L("quarter",7),le("Q",z),fe("Q",(function(e,t){t[1]=3*(k(e)-1)})),A("D",["DD",2],"Do","date"),H("date","D"),L("date",9),le("D",Q),le("DD",Q,$),le("Do",(function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient})),fe(["D","DD"],2),fe("Do",(function(e,t){t[2]=k(e.match(Q)[0])}));var sn=ve("Date",!0);A("DDD",["DDDD",3],"DDDo","dayOfYear"),H("dayOfYear","DDD"),L("dayOfYear",4),le("DDD",ee),le("DDDD",J),fe(["DDD","DDDD"],(function(e,t,n){n._dayOfYear=k(e)})),A("m",["mm",2],0,"minute"),H("minute","m"),L("minute",14),le("m",Q),le("mm",Q,$),fe(["m","mm"],4);var rn=ve("Minutes",!1);A("s",["ss",2],0,"second"),H("second","s"),L("second",15),le("s",Q),le("ss",Q,$),fe(["s","ss"],5);var an,on=ve("Seconds",!1);for(A("S",0,0,(function(){return~~(this.millisecond()/100)})),A(0,["SS",2],0,(function(){return~~(this.millisecond()/10)})),A(0,["SSS",3],0,"millisecond"),A(0,["SSSS",4],0,(function(){return 10*this.millisecond()})),A(0,["SSSSS",5],0,(function(){return 100*this.millisecond()})),A(0,["SSSSSS",6],0,(function(){return 1e3*this.millisecond()})),A(0,["SSSSSSS",7],0,(function(){return 1e4*this.millisecond()})),A(0,["SSSSSSSS",8],0,(function(){return 1e5*this.millisecond()})),A(0,["SSSSSSSSS",9],0,(function(){return 1e6*this.millisecond()})),H("millisecond","ms"),L("millisecond",16),le("S",ee,z),le("SS",ee,$),le("SSS",ee,J),an="SSSS";an.length<=9;an+="S")le(an,se);function un(e,t){t[6]=k(1e3*("0."+e))}for(an="S";an.length<=9;an+="S")fe(an,un);var ln=ve("Milliseconds",!1);A("z",0,0,"zoneAbbr"),A("zz",0,0,"zoneName");var hn=w.prototype;function dn(e){return e}hn.add=Zt,hn.calendar=function(e,t){var n=e||Dt(),i=Ut(n,this).startOf("day"),r=s.calendarFormat(this,i)||"sameElse",a=t&&(x(t[r])?t[r].call(this,n):t[r]);return this.format(a||this.localeData().calendar(r,this,Dt(n)))},hn.clone=function(){return new w(this)},hn.diff=function(e,t,n){var s,i,r;if(!this.isValid())return NaN;if(!(s=Ut(e,this)).isValid())return NaN;switch(i=6e4*(s.utcOffset()-this.utcOffset()),t=R(t)){case"year":r=$t(this,s)/12;break;case"month":r=$t(this,s);break;case"quarter":r=$t(this,s)/3;break;case"second":r=(this-s)/1e3;break;case"minute":r=(this-s)/6e4;break;case"hour":r=(this-s)/36e5;break;case"day":r=(this-s-i)/864e5;break;case"week":r=(this-s-i)/6048e5;break;default:r=this-s}return n?r:M(r)},hn.endOf=function(e){var t;if(void 0===(e=R(e))||"millisecond"===e||!this.isValid())return this;var n=this._isUTC?Kt:Xt;switch(e){case"year":t=n(this.year()+1,0,1)-1;break;case"quarter":t=n(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":t=n(this.year(),this.month()+1,1)-1;break;case"week":t=n(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":t=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":t=n(this.year(),this.month(),this.date()+1)-1;break;case"hour":t=this._d.valueOf(),t+=36e5-Qt(t+(this._isUTC?0:6e4*this.utcOffset()),36e5)-1;break;case"minute":t=this._d.valueOf(),t+=6e4-Qt(t,6e4)-1;break;case"second":t=this._d.valueOf(),t+=1e3-Qt(t,1e3)-1}return this._d.setTime(t),s.updateOffset(this,!0),this},hn.format=function(e){e||(e=this.isUtc()?s.defaultFormatUtc:s.defaultFormat);var t=j(this,e);return this.localeData().postformat(t)},hn.from=function(e,t){return this.isValid()&&(v(e)&&e.isValid()||Dt(e).isValid())?Vt({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()},hn.fromNow=function(e){return this.from(Dt(),e)},hn.to=function(e,t){return this.isValid()&&(v(e)&&e.isValid()||Dt(e).isValid())?Vt({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()},hn.toNow=function(e){return this.to(Dt(),e)},hn.get=function(e){return x(this[e=R(e)])?this[e]():this},hn.invalidAt=function(){return f(this).overflow},hn.isAfter=function(e,t){var n=v(e)?e:Dt(e);return!(!this.isValid()||!n.isValid())&&("millisecond"===(t=R(t)||"millisecond")?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(t).valueOf())},hn.isBefore=function(e,t){var n=v(e)?e:Dt(e);return!(!this.isValid()||!n.isValid())&&("millisecond"===(t=R(t)||"millisecond")?this.valueOf()<n.valueOf():this.clone().endOf(t).valueOf()<n.valueOf())},hn.isBetween=function(e,t,n,s){var i=v(e)?e:Dt(e),r=v(t)?t:Dt(t);return!!(this.isValid()&&i.isValid()&&r.isValid())&&("("===(s=s||"()")[0]?this.isAfter(i,n):!this.isBefore(i,n))&&(")"===s[1]?this.isBefore(r,n):!this.isAfter(r,n))},hn.isSame=function(e,t){var n,s=v(e)?e:Dt(e);return!(!this.isValid()||!s.isValid())&&("millisecond"===(t=R(t)||"millisecond")?this.valueOf()===s.valueOf():(n=s.valueOf(),this.clone().startOf(t).valueOf()<=n&&n<=this.clone().endOf(t).valueOf()))},hn.isSameOrAfter=function(e,t){return this.isSame(e,t)||this.isAfter(e,t)},hn.isSameOrBefore=function(e,t){return this.isSame(e,t)||this.isBefore(e,t)},hn.isValid=function(){return m(this)},hn.lang=qt,hn.locale=Jt,hn.localeData=Bt,hn.max=Ot,hn.min=Yt,hn.parsingFlags=function(){return d({},f(this))},hn.set=function(e,t){if("object"==typeof e)for(var n=function(e){var t=[];for(var n in e)t.push({unit:n,priority:F[n]});return t.sort((function(e,t){return e.priority-t.priority})),t}(e=U(e)),s=0;s<n.length;s++)this[n[s].unit](e[n[s].unit]);else if(x(this[e=R(e)]))return this[e](t);return this},hn.startOf=function(e){var t;if(void 0===(e=R(e))||"millisecond"===e||!this.isValid())return this;var n=this._isUTC?Kt:Xt;switch(e){case"year":t=n(this.year(),0,1);break;case"quarter":t=n(this.year(),this.month()-this.month()%3,1);break;case"month":t=n(this.year(),this.month(),1);break;case"week":t=n(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":t=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":t=n(this.year(),this.month(),this.date());break;case"hour":t=this._d.valueOf(),t-=Qt(t+(this._isUTC?0:6e4*this.utcOffset()),36e5);break;case"minute":t=this._d.valueOf(),t-=Qt(t,6e4);break;case"second":t=this._d.valueOf(),t-=Qt(t,1e3)}return this._d.setTime(t),s.updateOffset(this,!0),this},hn.subtract=zt,hn.toArray=function(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]},hn.toObject=function(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}},hn.toDate=function(){return new Date(this.valueOf())},hn.toISOString=function(e){if(!this.isValid())return null;var t=!0!==e,n=t?this.clone().utc():this;return n.year()<0||n.year()>9999?j(n,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):x(Date.prototype.toISOString)?t?this.toDate().toISOString():new Date(this.valueOf()+60*this.utcOffset()*1e3).toISOString().replace("Z",j(n,"Z")):j(n,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")},hn.inspect=function(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e="moment",t="";this.isLocal()||(e=0===this.utcOffset()?"moment.utc":"moment.parseZone",t="Z");var n="["+e+'("]',s=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i=t+'[")]';return this.format(n+s+"-MM-DD[T]HH:mm:ss.SSS"+i)},hn.toJSON=function(){return this.isValid()?this.toISOString():null},hn.toString=function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},hn.unix=function(){return Math.floor(this.valueOf()/1e3)},hn.valueOf=function(){return this._d.valueOf()-6e4*(this._offset||0)},hn.creationData=function(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}},hn.year=we,hn.isLeapYear=function(){return ge(this.year())},hn.weekYear=function(e){return tn.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)},hn.isoWeekYear=function(e){return tn.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)},hn.quarter=hn.quarters=function(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)},hn.month=xe,hn.daysInMonth=function(){return Se(this.year(),this.month())},hn.week=hn.weeks=function(e){var t=this.localeData().week(this);return null==e?t:this.add(7*(e-t),"d")},hn.isoWeek=hn.isoWeeks=function(e){var t=Le(this,1,4).week;return null==e?t:this.add(7*(e-t),"d")},hn.weeksInYear=function(){var e=this.localeData()._week;return Ne(this.year(),e.dow,e.doy)},hn.isoWeeksInYear=function(){return Ne(this.year(),1,4)},hn.date=sn,hn.day=hn.days=function(e){if(!this.isValid())return null!=e?this:NaN;var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(e=function(e,t){return"string"!=typeof e?e:isNaN(e)?"number"==typeof(e=t.weekdaysParse(e))?e:null:parseInt(e,10)}(e,this.localeData()),this.add(e-t,"d")):t},hn.weekday=function(e){if(!this.isValid())return null!=e?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return null==e?t:this.add(e-t,"d")},hn.isoWeekday=function(e){if(!this.isValid())return null!=e?this:NaN;if(null!=e){var t=function(e,t){return"string"==typeof e?t.weekdaysParse(e)%7||7:isNaN(e)?null:e}(e,this.localeData());return this.day(this.day()%7?t:t-7)}return this.day()||7},hn.dayOfYear=function(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==e?t:this.add(e-t,"d")},hn.hour=hn.hours=Xe,hn.minute=hn.minutes=rn,hn.second=hn.seconds=on,hn.millisecond=hn.milliseconds=ln,hn.utcOffset=function(e,t,n){var i,r=this._offset||0;if(!this.isValid())return null!=e?this:NaN;if(null!=e){if("string"==typeof e){if(null===(e=Rt(ae,e)))return this}else Math.abs(e)<16&&!n&&(e*=60);return!this._isUTC&&t&&(i=Ft(this)),this._offset=e,this._isUTC=!0,null!=i&&this.add(i,"m"),r!==e&&(!t||this._changeInProgress?jt(this,Vt(e-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,s.updateOffset(this,!0),this._changeInProgress=null)),this}return this._isUTC?r:Ft(this)},hn.utc=function(e){return this.utcOffset(0,e)},hn.local=function(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(Ft(this),"m")),this},hn.parseZone=function(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"==typeof this._i){var e=Rt(re,this._i);null!=e?this.utcOffset(e):this.utcOffset(0,!0)}return this},hn.hasAlignedHourOffset=function(e){return!!this.isValid()&&(e=e?Dt(e).utcOffset():0,(this.utcOffset()-e)%60==0)},hn.isDST=function(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()},hn.isLocal=function(){return!!this.isValid()&&!this._isUTC},hn.isUtcOffset=function(){return!!this.isValid()&&this._isUTC},hn.isUtc=Lt,hn.isUTC=Lt,hn.zoneAbbr=function(){return this._isUTC?"UTC":""},hn.zoneName=function(){return this._isUTC?"Coordinated Universal Time":""},hn.dates=Y("dates accessor is deprecated. Use date instead.",sn),hn.months=Y("months accessor is deprecated. Use month instead",xe),hn.years=Y("years accessor is deprecated. Use year instead",we),hn.zone=Y("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",(function(e,t){return null!=e?("string"!=typeof e&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()})),hn.isDSTShifted=Y("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",(function(){if(!a(this._isDSTShifted))return this._isDSTShifted;var e={};if(g(e,this),(e=kt(e))._a){var t=e._isUTC?c(e._a):Dt(e._a);this._isDSTShifted=this.isValid()&&S(e._a,t.toArray())>0}else this._isDSTShifted=!1;return this._isDSTShifted}));var cn=W.prototype;function fn(e,t,n,s){var i=at(),r=c().set(s,t);return i[n](r,e)}function mn(e,t,n){if(o(e)&&(t=e,e=void 0),e=e||"",null!=t)return fn(e,t,n,"month");var s,i=[];for(s=0;s<12;s++)i[s]=fn(e,s,n,"month");return i}function _n(e,t,n,s){"boolean"==typeof e?(o(t)&&(n=t,t=void 0),t=t||""):(n=t=e,e=!1,o(t)&&(n=t,t=void 0),t=t||"");var i,r=at(),a=e?r._week.dow:0;if(null!=n)return fn(t,(n+a)%7,s,"day");var u=[];for(i=0;i<7;i++)u[i]=fn(t,(i+a)%7,s,"day");return u}cn.calendar=function(e,t,n){var s=this._calendar[e]||this._calendar.sameElse;return x(s)?s.call(t,n):s},cn.longDateFormat=function(e){var t=this._longDateFormat[e],n=this._longDateFormat[e.toUpperCase()];return t||!n?t:(this._longDateFormat[e]=n.replace(/MMMM|MM|DD|dddd/g,(function(e){return e.slice(1)})),this._longDateFormat[e])},cn.invalidDate=function(){return this._invalidDate},cn.ordinal=function(e){return this._ordinal.replace("%d",e)},cn.preparse=dn,cn.postformat=dn,cn.relativeTime=function(e,t,n,s){var i=this._relativeTime[n];return x(i)?i(e,t,n,s):i.replace(/%d/i,e)},cn.pastFuture=function(e,t){var n=this._relativeTime[e>0?"future":"past"];return x(n)?n(t):n.replace(/%s/i,t)},cn.set=function(e){var t,n;for(n in e)x(t=e[n])?this[n]=t:this["_"+n]=t;this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)},cn.months=function(e,t){return e?i(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||De).test(t)?"format":"standalone"][e.month()]:i(this._months)?this._months:this._months.standalone},cn.monthsShort=function(e,t){return e?i(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[De.test(t)?"format":"standalone"][e.month()]:i(this._monthsShort)?this._monthsShort:this._monthsShort.standalone},cn.monthsParse=function(e,t,n){var s,i,r;if(this._monthsParseExact)return Te.call(this,e,t,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),s=0;s<12;s++){if(i=c([2e3,s]),n&&!this._longMonthsParse[s]&&(this._longMonthsParse[s]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[s]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),n||this._monthsParse[s]||(r="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[s]=new RegExp(r.replace(".",""),"i")),n&&"MMMM"===t&&this._longMonthsParse[s].test(e))return s;if(n&&"MMM"===t&&this._shortMonthsParse[s].test(e))return s;if(!n&&this._monthsParse[s].test(e))return s}},cn.monthsRegex=function(e){return this._monthsParseExact?(h(this,"_monthsRegex")||Ce.call(this),e?this._monthsStrictRegex:this._monthsRegex):(h(this,"_monthsRegex")||(this._monthsRegex=We),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)},cn.monthsShortRegex=function(e){return this._monthsParseExact?(h(this,"_monthsRegex")||Ce.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(h(this,"_monthsShortRegex")||(this._monthsShortRegex=Pe),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)},cn.week=function(e){return Le(e,this._week.dow,this._week.doy).week},cn.firstDayOfYear=function(){return this._week.doy},cn.firstDayOfWeek=function(){return this._week.dow},cn.weekdays=function(e,t){var n=i(this._weekdays)?this._weekdays:this._weekdays[e&&!0!==e&&this._weekdays.isFormat.test(t)?"format":"standalone"];return!0===e?Ge(n,this._week.dow):e?n[e.day()]:n},cn.weekdaysMin=function(e){return!0===e?Ge(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin},cn.weekdaysShort=function(e){return!0===e?Ge(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort},cn.weekdaysParse=function(e,t,n){var s,i,r;if(this._weekdaysParseExact)return Ae.call(this,e,t,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),s=0;s<7;s++){if(i=c([2e3,1]).day(s),n&&!this._fullWeekdaysParse[s]&&(this._fullWeekdaysParse[s]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[s]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[s]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[s]||(r="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[s]=new RegExp(r.replace(".",""),"i")),n&&"dddd"===t&&this._fullWeekdaysParse[s].test(e))return s;if(n&&"ddd"===t&&this._shortWeekdaysParse[s].test(e))return s;if(n&&"dd"===t&&this._minWeekdaysParse[s].test(e))return s;if(!n&&this._weekdaysParse[s].test(e))return s}},cn.weekdaysRegex=function(e){return this._weekdaysParseExact?(h(this,"_weekdaysRegex")||$e.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(h(this,"_weekdaysRegex")||(this._weekdaysRegex=je),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)},cn.weekdaysShortRegex=function(e){return this._weekdaysParseExact?(h(this,"_weekdaysRegex")||$e.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(h(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Ze),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)},cn.weekdaysMinRegex=function(e){return this._weekdaysParseExact?(h(this,"_weekdaysRegex")||$e.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(h(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=ze),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)},cn.isPM=function(e){return"p"===(e+"").toLowerCase().charAt(0)},cn.meridiem=function(e,t,n){return e>11?n?"pm":"PM":n?"am":"AM"},it("en",{dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10;return e+(1===k(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")}}),s.lang=Y("moment.lang is deprecated. Use moment.locale instead.",it),s.langData=Y("moment.langData is deprecated. Use moment.localeData instead.",at);var yn=Math.abs;function gn(e,t,n,s){var i=Vt(t,n);return e._milliseconds+=s*i._milliseconds,e._days+=s*i._days,e._months+=s*i._months,e._bubble()}function pn(e){return e<0?Math.floor(e):Math.ceil(e)}function wn(e){return 4800*e/146097}function vn(e){return 146097*e/4800}function Mn(e){return function(){return this.as(e)}}var kn=Mn("ms"),Sn=Mn("s"),Dn=Mn("m"),Yn=Mn("h"),On=Mn("d"),Tn=Mn("w"),bn=Mn("M"),xn=Mn("Q"),Pn=Mn("y");function Wn(e){return function(){return this.isValid()?this._data[e]:NaN}}var Cn=Wn("milliseconds"),Hn=Wn("seconds"),Rn=Wn("minutes"),Un=Wn("hours"),Fn=Wn("days"),Ln=Wn("months"),Nn=Wn("years"),Gn=Math.round,Vn={ss:44,s:45,m:45,h:22,d:26,M:11};function En(e,t,n,s,i){return i.relativeTime(t||1,!!n,e,s)}var In=Math.abs;function An(e){return(e>0)-(e<0)||+e}function jn(){if(!this.isValid())return this.localeData().invalidDate();var e,t,n=In(this._milliseconds)/1e3,s=In(this._days),i=In(this._months);e=M(n/60),t=M(e/60),n%=60,e%=60;var r=M(i/12),a=i%=12,o=s,u=t,l=e,h=n?n.toFixed(3).replace(/\.?0+$/,""):"",d=this.asSeconds();if(!d)return"P0D";var c=d<0?"-":"",f=An(this._months)!==An(d)?"-":"",m=An(this._days)!==An(d)?"-":"",_=An(this._milliseconds)!==An(d)?"-":"";return c+"P"+(r?f+r+"Y":"")+(a?f+a+"M":"")+(o?m+o+"D":"")+(u||l||h?"T":"")+(u?_+u+"H":"")+(l?_+l+"M":"")+(h?_+h+"S":"")}var Zn=xt.prototype;return Zn.isValid=function(){return this._isValid},Zn.abs=function(){var e=this._data;return this._milliseconds=yn(this._milliseconds),this._days=yn(this._days),this._months=yn(this._months),e.milliseconds=yn(e.milliseconds),e.seconds=yn(e.seconds),e.minutes=yn(e.minutes),e.hours=yn(e.hours),e.months=yn(e.months),e.years=yn(e.years),this},Zn.add=function(e,t){return gn(this,e,t,1)},Zn.subtract=function(e,t){return gn(this,e,t,-1)},Zn.as=function(e){if(!this.isValid())return NaN;var t,n,s=this._milliseconds;if("month"===(e=R(e))||"quarter"===e||"year"===e)switch(t=this._days+s/864e5,n=this._months+wn(t),e){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(t=this._days+Math.round(vn(this._months)),e){case"week":return t/7+s/6048e5;case"day":return t+s/864e5;case"hour":return 24*t+s/36e5;case"minute":return 1440*t+s/6e4;case"second":return 86400*t+s/1e3;case"millisecond":return Math.floor(864e5*t)+s;default:throw new Error("Unknown unit "+e)}},Zn.asMilliseconds=kn,Zn.asSeconds=Sn,Zn.asMinutes=Dn,Zn.asHours=Yn,Zn.asDays=On,Zn.asWeeks=Tn,Zn.asMonths=bn,Zn.asQuarters=xn,Zn.asYears=Pn,Zn.valueOf=function(){return this.isValid()?this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*k(this._months/12):NaN},Zn._bubble=function(){var e,t,n,s,i,r=this._milliseconds,a=this._days,o=this._months,u=this._data;return r>=0&&a>=0&&o>=0||r<=0&&a<=0&&o<=0||(r+=864e5*pn(vn(o)+a),a=0,o=0),u.milliseconds=r%1e3,e=M(r/1e3),u.seconds=e%60,t=M(e/60),u.minutes=t%60,n=M(t/60),u.hours=n%24,a+=M(n/24),i=M(wn(a)),o+=i,a-=pn(vn(i)),s=M(o/12),o%=12,u.days=a,u.months=o,u.years=s,this},Zn.clone=function(){return Vt(this)},Zn.get=function(e){return e=R(e),this.isValid()?this[e+"s"]():NaN},Zn.milliseconds=Cn,Zn.seconds=Hn,Zn.minutes=Rn,Zn.hours=Un,Zn.days=Fn,Zn.weeks=function(){return M(this.days()/7)},Zn.months=Ln,Zn.years=Nn,Zn.humanize=function(e){if(!this.isValid())return this.localeData().invalidDate();var t=this.localeData(),n=function(e,t,n){var s=Vt(e).abs(),i=Gn(s.as("s")),r=Gn(s.as("m")),a=Gn(s.as("h")),o=Gn(s.as("d")),u=Gn(s.as("M")),l=Gn(s.as("y")),h=i<=Vn.ss&&["s",i]||i<Vn.s&&["ss",i]||r<=1&&["m"]||r<Vn.m&&["mm",r]||a<=1&&["h"]||a<Vn.h&&["hh",a]||o<=1&&["d"]||o<Vn.d&&["dd",o]||u<=1&&["M"]||u<Vn.M&&["MM",u]||l<=1&&["y"]||["yy",l];return h[2]=t,h[3]=+e>0,h[4]=n,En.apply(null,h)}(this,!e,t);return e&&(n=t.pastFuture(+this,n)),t.postformat(n)},Zn.toISOString=jn,Zn.toString=jn,Zn.toJSON=jn,Zn.locale=Jt,Zn.localeData=Bt,Zn.toIsoString=Y("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",jn),Zn.lang=qt,A("X",0,0,"unix"),A("x",0,0,"valueOf"),le("x",ie),le("X",/[+-]?\d+(\.\d{1,3})?/),fe("X",(function(e,t,n){n._d=new Date(1e3*parseFloat(e,10))})),fe("x",(function(e,t,n){n._d=new Date(k(e))})),s.version="2.24.0",t=Dt,s.fn=hn,s.min=function(){var e=[].slice.call(arguments,0);return Tt("isBefore",e)},s.max=function(){var e=[].slice.call(arguments,0);return Tt("isAfter",e)},s.now=function(){return Date.now?Date.now():+new Date},s.utc=c,s.unix=function(e){return Dt(1e3*e)},s.months=function(e,t){return mn(e,t,"months")},s.isDate=u,s.locale=it,s.invalid=_,s.duration=Vt,s.isMoment=v,s.weekdays=function(e,t,n){return _n(e,t,n,"weekdays")},s.parseZone=function(){return Dt.apply(null,arguments).parseZone()},s.localeData=at,s.isDuration=Pt,s.monthsShort=function(e,t){return mn(e,t,"monthsShort")},s.weekdaysMin=function(e,t,n){return _n(e,t,n,"weekdaysMin")},s.defineLocale=rt,s.updateLocale=function(e,t){if(null!=t){var n,s,i=Ke;null!=(s=st(e))&&(i=s._config),t=P(i,t),(n=new W(t)).parentLocale=et[e],et[e]=n,it(e)}else null!=et[e]&&(null!=et[e].parentLocale?et[e]=et[e].parentLocale:null!=et[e]&&delete et[e]);return et[e]},s.locales=function(){return O(et)},s.weekdaysShort=function(e,t,n){return _n(e,t,n,"weekdaysShort")},s.normalizeUnits=R,s.relativeTimeRounding=function(e){return void 0===e?Gn:"function"==typeof e&&(Gn=e,!0)},s.relativeTimeThreshold=function(e,t){return void 0!==Vn[e]&&(void 0===t?Vn[e]:(Vn[e]=t,"s"===e&&(Vn.ss=t-1),!0))},s.calendarFormat=function(e,t){var n=e.diff(t,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"},s.prototype=hn,s.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"},s}()}).call(this,n(384)(e))},384:function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}}}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-frontend:split_moment', location = 'moment.js' */
(window.atlassianWebpackJsonpe19a4f58490c3d96a3072d1e47cd0e73=window.atlassianWebpackJsonpe19a4f58490c3d96a3072d1e47cd0e73||[]).push([[19],{383:function(a,e,n){"use strict";n.r(e);var c=n(107),s=n.n(c),d=n(13),t=n.n(d),o=n(12);t.a.moment=s.a,Object(o.a)("moment",()=>s.a)}},[[383,0,1,3,4,31,2]]]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:collaborative-helper', location = 'loader/collaborative-helper.js' */
define("confluence-editor/loader/collaborative-helper",["jquery","ajs","confluence/meta","confluence/legacy"],function(g,h,d,i){function b(a){var c=a||{},a=c.id||i.getContentId(),b=c.type||d.get("content-type"),c=c.editMode||d.get("edit-mode");return"collaborative"===c&&("page"===b||"blogpost"===b)&&a&&"0"!==a}var e,f=g.Deferred();return{registerPlugin:function(a){e=a;f.resolve()},isCollaborativeEditingAvailable:b,getEditorContent:function(){return f.pipe(function(){return b()&&"fake"!==d.get("collaborative-editor-status")?
e.getSynchronisedEditorContent():{content:h.Rte.getEditor().getContent()}})}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:page-editor-js', location = 'editor/page-editor-message.js' */
define("confluence-editor/editor/page-editor-message",["jquery","ajs","aui/flag","document","underscore"],function(f,i,g,h,d){var b=Object.create(null),e=Object.create(null);h.addEventListener("aui-flag-close",function(a){a&&a.target&&(b=d.filter(Object.keys(b),function(c){return!f(a.target).find("span").hasClass(c)}))});return{handleMessage:function(a,c,d){b[a]||(e[a]?delete e[a]:c&&(b[a]=g({title:c.title?c.title:"",type:c.type,close:c.close?c.close:"manual",persistent:!1,body:"<span class='"+a+
"'>"+c.message+"</span>"}),d&&d()))},closeMessages:function(a){d.each(a,function(a){b[a]&&(b[a].close(),delete b[a])})},isDisplayed:function(a){return a in b},displayedErrors:function(){return Object.keys(b)},suppressMessage:function(a){e[a]={}}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:page-editor-js', location = 'editor/page-editor-quit-dialog.js' */
define("confluence-editor/editor/page-editor-quit-dialog","jquery confluence/templates ajs confluence/meta confluence/legacy window document confluence-editor/editor/page-editor-message confluence/api/constants underscore".split(" "),function(e,n,c,d,f,B,M,o,C,D){function E(b){b.stopPropagation();b.preventDefault();c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog.show-diff-clicked"});a.showDiffButton.hide();s();a.hideDiffButton.show()}function t(b){b.stopPropagation();b.preventDefault();
c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog.hide-diff-clicked"});a.hideDiffButton.hide();a.showDiffButton.show();a.dialogEl.removeClass("aui-dialog2-xlarge").addClass("aui-dialog2-medium");k(h)}function F(b){if(l!==true){h=i?g.REVERT:g.DELETE;p();c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog.discard"});b.stopPropagation();b.preventDefault();f.Editor.UI.setButtonsState(false,a.buttonsAll);u(d.get("content-id"))}}function v(){f.Editor.Drafts.unBindUnloadMessage();
a.editorForm.append(n.Editor.Page.hiddenInputCancel()).submit()}function w(a){if(a&&a.stopPropagation){a.stopPropagation();a.preventDefault()}c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog.keep-draft-clicked",data:{contributorCount:m.length+1}});v()}function G(b){f.Editor.UI.setButtonsState(false,a.buttonsAll);j.save(b);p()}function x(b){b.stopPropagation();b.preventDefault();h=null;c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.draft-status-indicator.click"});
y(function(){a.closeButton.show();s()})}function H(b){b.stopPropagation();b.preventDefault();if(l!==true){a.closeButton.show();d.get("new-page")?k(g.DELETE):k(g.REVERT)}}function I(b){b.stopPropagation();b.preventDefault();a.dialog.hide()}function s(){a.dialogEl.removeClass("aui-dialog2-medium").addClass("aui-dialog2-xlarge");k(g.SHOW_DIFF);e.ajax({url:C.CONTEXT_PATH+"/rest/tinymce/1/content/"+d.get("page-id")+"/draft/diff",type:"GET"}).success(function(b){a.dialogContent.find(".wiki-content").html(b).children().first().hasClass("diff-context-placeholder")&&
a.dialogContent.find("hr").hide()})}function k(b){function c(){return b===g.SHOW_DIFF&&(h===g.REVERT||h===g.DELETE)}if(b===g.UPDATE||b===g.PUBLISH)q=(new Date).getTime()/1E3;var f=b;c()&&(f=h);a.dialogHeader.html(n.Editor.Page.quitDialogHeader({dialogType:f,contentType:d.get("content-type"),newPage:d.get("new-page")}));a.dialogContent.html(n.Editor.Page.quitDialogContent({dialogType:b,contributors:m,contentType:d.get("content-type"),newDialog:h==null}));a.hideDiffButton=e("#qed-hide-diff-button").click(t);
if(!d.get("new-page")){b!==g.SHOW_DIFF&&(h=b);a.showDiffButton=e("#qed-show-diff-button").click(E);a.showDiffButton.show();a.buttonsAll.push(a.showDiffButton)}if(b===g.DELETE||b===g.REVERT||c()){a.discardButton.show();a.dialogEl.addClass("aui-dialog2-warning")}else a.dialogEl.removeClass("aui-dialog2-warning");a.closeButton.show();a.dialogFooter.find("."+b).show();a.dialog.show()}function J(){p();c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog.dialog-closed"});a.dialogEl.removeClass("aui-dialog2-xlarge").addClass("aui-dialog2-medium");
f.Editor.UI.toggleSavebarBusy(false);a.dialogFooter.find(".aui-button").hide();a.dialogContent.empty()}function p(){var a=(new Date).getTime()/1E3-q;c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog."+h+".displayed",data:{displayTimeInSeconds:a,contentId:d.get("content-id")}});q=0}function u(b,g){var d=c.contextPath(),d=i?d+"/rest/synchrony/1.0/content/"+b+"/changes/unpublished":d+"/rest/api/content/"+b+"?status=draft";i&&o.suppressMessage("editor.synchrony.revert-page");g=
g||0;e.ajax({url:d,type:"DELETE",data:{draftId:b},contentType:"application/json",dataType:"json"}).done(function(){i&&o.handleMessage("collaborative-editor-discard-error",{type:"success",close:"auto",message:"Successfully reverted to the last published version"});c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog.discard-success",data:{contentId:b}});v()}).fail(function(d){if(d.status===409&&g<K){c.trigger("disable-draft-save");u(b,g+1)}else{var e=JSON.parse(d.responseText),
h="There were errors discarding your draft.",d=d.errors||"An unknown error has occurred. Please check your logs.";if(e.data&&e.data.errors&&e.data.errors[0]&&e.data.errors[0].message.key==="content.delete.published"){h="This page has already been published";d="You can no longer discard this draft because it\u0027s not a draft anymore!"}c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog.discard-error",data:{contentId:b}});c.trigger("enable-draft-save");o.handleMessage("collaborative-editor-discard-error",
{type:"error",title:i?"Can\u0027t revert to last published version":h,message:i?"We can\u0027t get the last published version of the page at the moment. Give it a few moments then try discarding the draft again.":d});a.dialog.hide();f.Editor.UI.setButtonsState(true,a.buttonsAll)}})}function L(a,c){c&&c.contributors&&(m=D.reject(c.contributors,function(a){return a.name===d.get("remote-user")}))}function y(a){f.Editor.Drafts.save({forceSave:i,skipErrorHandler:true,onSuccessHandler:a||e.noop})}var a={},i,z,g={DELETE:"delete",REVERT:"revert",PUBLISH:"publish",
UPDATE:"update",SHOW_DIFF:"diff"},m=[],r=false,j={},h,q=0,K=5,l=false,A=false;return{init:function(b){if(z=d.getBoolean("shared-drafts")&&(d.get("content-type")==="page"||d.get("content-type")==="blogpost"))if(r){j.save=b&&b.saveHandler;j.cancelErrorHandler=b&&b.cancelErrorHandler;a.publishButton.click(G)}else{i=!d.get("new-page");a.discardButton=e("#qed-discard-button").tooltip({gravity:"s",className:"quit-editor-dialog"});if(f.Editor.isLimitedModeEnabled()&&i){f.Editor.UI.setButtonState(false,a.discardButton);
a.discardButton.removeAttr("disabled")}else a.discardButton.click(F);a.saveExitButton=e("#qed-save-exit-button").click(w);a.hideDiffButton=e("#qed-hide-diff-button").click(t);a.publishButton=e("#qed-publish-button");a.closeButton=e("#qed-close-button").click(I);a.buttonsAll=[a.discardButton,a.saveExitButton,a.showDiffButton,a.hideDiffButton,a.publishButton];a.dialog=c.dialog2("#quit-editor-dialog");a.dialogEl=a.dialog.$el;a.dialogHeader=a.dialogEl.find(".aui-dialog2-header");a.dialogContent=a.dialogEl.find(".aui-dialog2-content");
a.dialogFooter=a.dialogEl.find(".aui-dialog2-footer");a.editorForm=e("#wysiwyg").closest("form");e("#rte-show-changes").on("click",x);e("#rte-show-revert").on("click",H);if(!d.get("new-page"))e("#pluggable-status").on("click","a",x);a.dialog.on("hide",J);c.bind("editor-heartbeat",L);c.bind("synchrony.history.evicted",function(){l=true;e("#qed-discard-button").attr("disabled","disabled")});c.bind("synchrony.connected",function(){A=true});r=true}},process:function(a){if(z){a.stopPropagation();a.preventDefault();
e(B).one("editor-heartbeat rte.heartbeat-error",function(c){e(this).off("editor-heartbeat rte.heartbeat-error");switch(a.target.id){case f.Editor.UI.saveButton.attr("id"):case f.Editor.UI.versionCommentInput.attr("id"):f.Editor.UI.toggleSavebarBusy(true);if(m.length===0)j.save();else{y();k(i?g.UPDATE:g.PUBLISH)}break;case f.Editor.UI.cancelButton.attr("id"):f.Editor.Drafts.save({forceSave:true,skipErrorHandler:false,onSuccessHandler:w,ignoreRelations:!(f.Editor.hasContentChanged()&&A)});var d=f.Editor.Drafts.getDraftSavingPromise();
d&&d.fail(function(a){j.cancelErrorHandler&&j.cancelErrorHandler(a)});(!c.namespace||c.namespace!=="heartbeat-error")&&f.Editor.UI.toggleSavebarBusy(true)}});f.Editor.heartbeat()}},_destroy:function(){l=r=false}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:page-editor-js', location = 'editor/page-editor.js' */
define("confluence-editor/editor/page-editor","ajs confluence/legacy jquery document window confluence/meta confluence/api/constants confluence-editor/editor/page-editor-message confluence/aui-overrides".split(" "),function(d,c,b,j,O,f,n,k,m){function B(){var a=f.getBoolean("shared-drafts"),e=f.get("content-type")==="page"||f.get("content-type")==="blogpost",b=d.params.pageId!=="0";return e&&(b||a)}function C(a){b("#editpageform").find("input[name='atl_token']").val(a);f.set("atl-token",a);f.set("atlassian-token",
a);b("#atlassian-token").attr("content",a)}var u=d.DarkFeatures.isEnabled("editor.ajax.save")&&!d.DarkFeatures.isEnabled("editor.ajax.save.disable")&&f.get("remote-user")!=="",o=[],p=[],q=[],D=false,l=1,v=false,r,E=function(a){c.Editor.UI.setButtonState(a,c.Editor.UI.saveButton);c.Editor.UI.setButtonState(a,c.Editor.UI.previewButton);c.Editor.UI.setButtonState(a,c.Editor.UI.cancelButton);b("#rte-show-changes").size()>0&&c.Editor.UI.setButtonState(a,b("#rte-show-changes"));b("#rte-show-revert").size()>
0&&c.Editor.UI.setButtonState(a,b("#rte-show-revert"))},s=function(a){var a=a||{},e=a.messageKey||"editor-error-message",c=a.message||"Something went wrong with the editor. Copy your unsaved changes and refresh the page to keep editing.",c={title:a.title,type:"error",message:c};a.close&&b.extend(c,{close:a.close});k.handleMessage(e,c,function(){a.disablePublish&&E(false)})},F=function(){return f.get("edit-mode")==="limited"},Q=function(a){var e=true;k.closeMessages(["offline-before-save-error"]);for(var b=0;b<p.length;b++){p[b](a)===false&&(e=false);if(a.isImmediatePropagationStopped())break}if(!e||
a.isDefaultPrevented()||a.isPropagationStopped())return false;a.preventDefault();G(a).done(w).fail(P)},P=function(a){var e=a||{};s({messageKey:e.messageKey||"offline-before-save-error",message:e.disablePublish?"Something went wrong with the editor. Copy your unsaved changes and refresh the page to keep editing.":"Unable to communicate with server. Saving is not possible at the moment.",disablePublish:e.disablePublish});a&&d.trigger("analytics",{name:"editor.save.error."+a.origin+"."+a.cause});c.Editor.UI.toggleSavebarBusy(false);c.Editor.Drafts.bindUnloadMessage()},G=function(a){var e=
b.Deferred();e.resolve(a);return e.promise()},H=function(){var a=function(){v=true;b(c.Editor.getCurrentForm()).submit();d.trigger("analytics",{name:"confluence.editor.close",data:{source:"publishButton"}})},e=c.Editor.Drafts.getDraftSavingPromise();e?e.always(a):a()},w=H;d.bind("rte-ready",function(){d.Meta.getBoolean("collaborative-content")||b('meta[name="ajs-collaborative-editor-status"]').attr("content","off");c.Editor.UI.saveButton.bind("click",Q)});d.bind("editor.error.message",function(a,
e){s(e)});d.bind("dismiss.editor.error.message",function(a,e){k.closeMessages([e.messageKey]);e.enablePublish&&E(true)});var R=function(){var a;for(a=0;a<o.length;a++)c.Editor.UI.cancelButton.click(o[a]);var e=b(c.Editor.getCurrentForm());for(a=0;a<q.length;a++)e.submit(q[a]);b.unbind("init.rte",this)},I=function(a,e,c,h){h.push(c);if(d.Rte&&d.Rte.BootstrapManager&&d.Rte.BootstrapManager.isInitComplete())a.bind(e,c);else if(!D){D=true;b.bind("init.rte",R)}},x=function(a,e,b){var c=null;d.Rte&&(d.Rte.BootstrapManager&&
d.Rte.BootstrapManager.isInitComplete())&&(c=function(a,e,b){a.unbind(e,b)});for(var f=b.pop();f;){c&&c(a,e,f);f=b.pop()}},J=function(a){if(g!==a){g&&g.clear();a.start(c.Editor.heartbeat);g=a}},g,K=f.getNumber("heartbeat-interval")||3E4,y,L;y={start:function(a){d.debug("Changing heartbeat to the normal scheduler");L=setInterval(a,K)},clear:function(){clearInterval(L)}};var M,N=Math.max(K/5,5E3),z,A;M={start:function(a){d.debug("Changing heartbeat to the recovery scheduler");A=0;var e=function(){a();
var b=N*Math.pow(2,A);z=setTimeout(e,Math.min(b,3E5));A++};z=setTimeout(e,N)},clear:function(){clearTimeout(z)}};return{bookmark:"",MODE_RICHTEXT:"richtext",MODE_PREVIEW:"preview",PREVIEW_OUTPUT_TYPE:"PREVIEW",currentEditMode:null,contentHasChangedSinceLastSave:false,sourceInitialValue:false,isPublishing:function(a){typeof a!=="undefined"&&(v=a);return v},isLimitedModeEnabled:F,overrideBeforeSave:function(a){G=a},overrideSave:function(a){w=a},restoreDefaultSave:function(){w=H},getNumConcurrentEditors:function(){return l},
addCancelHandler:function(a){I(c.Editor.UI.cancelButton,"click",a,o)},addSaveHandler:function(a){p.push(a)},addSubmitHandler:function(a){I(b(c.Editor.getCurrentForm()),"submit",a,q)},removeAllCancelHandlers:function(){x(c.Editor.UI.cancelButton,"click",o)},removeAllSaveHandlers:function(){x(c.Editor.UI.saveButton,"click",p)},removeAllSubmitHandlers:function(){x(b(c.Editor.getCurrentForm()),"submit",q)},hasContentChanged:function(){return!this.inRichTextMode()&&!this.contentHasChangedSinceLastSave?
false:this.editorHasContentChanged()},editorHasContentChanged:function(){if(d.Rte.getEditor()==null){d.debug("Confluence.Editor: editorHasContentChanged - No active editor present. Returning false.");return false}return d.Rte.Content.editorHasContentChanged()},isEmpty:function(){var a=b(d.Rte.getEditor().getContent()).text();return!b.trim(a)},getResumeDraftUrl:function(){var a=[];a.push(n.CONTEXT_PATH);a.push("/pages/"+(d.params.newPage?"create":"edit")+d.params.draftType+".action");a.push("?useDraft=true");
a.push("&pageId="+d.params.pageId);a.push("&contentChanged="+this.hasContentChanged());this.getCurrentForm().spaceKey&&a.push("&spaceKey="+f.get("space-key"));return a.join("")},getCurrentTitle:function(){return b("#content-title")&&b("#content-title").val()},contentFormSubmit:function(){(F()||!c.Editor.Drafts.isSharedDraftsEnabled())&&c.Editor.Drafts.unBindUnloadMessage();b(".editable-title #content-title").prop("disabled",true);return true},metadataSyncRequired:B,heartbeat:function(){var a={dataType:"json",
contentId:f.get("content-id"),draftType:f.get("content-type"),spaceKey:d.params.spaceKey,contributorsHash:f.get("contributors-hash")};r=d.safe.post(n.CONTEXT_PATH+"/json/startheartbeatactivity.action",a,function(a){if(!B()&&a){C(a.atlToken);d.Meta.set("shared-drafts",a.editMode!=="legacy");d.trigger("rte.heartbeat",a)}else if(!a||!a.atlToken||!(a.activityResponses instanceof Array)){d.trigger("rte.heartbeat-error","Invalid server response");d.logError("Unexpected server response for heartbeat:");
d.log(a)}else{f.set("contributors-hash",a.contributorsHash);d.Meta.set("shared-drafts",a.editMode!=="legacy");var i=a.activityResponses;C(a.atlToken);c.Editor.heartbeatType.normal();d.trigger("rte.heartbeat",i);l=(i.length||0)+1;if(l>1){var h=!u?b("#other-users-span"):b("#reliable-other-users-span").length===0?b("<span id='reliable-other-users-span'></span>"):b("#reliable-other-users-span");h.empty();for(var t=0;t<l-1;++t){t>0&&h.append(", ");var g=i[t];h.append(b("<a></a>").attr("href",n.CONTEXT_PATH+
"/display/~"+encodeURIComponent(g.userName)).text(g.fullName));g.lastEditMessage!=null&&h.append(" ").append(b("<span></span>").addClass("smalltext").text(g.lastEditMessage))}u&&!k.isDisplayed(["heartBeat"])&&h.html().trim()!==""&&k.handleMessage("heartBeat",{type:"info",message:d.format("This page is also being edited by {0}. Your changes will be merged with theirs when you save.","<span id='reliable-other-users-span'>"+h.html()+"</span>")});b("#heartbeat-div").hasClass("hidden")&&d.Confluence.Analytics.publish("rte.notification.concurrent-editing",{numEditors:l,
pageId:d.params.pageId,draftType:d.params.draftType})}u&&l<=1&&k.closeMessages(["heartBeat"]);m.setVisible("#heartbeat-div",l>1);b(j).trigger("resize.resizeplugin");d.trigger("editor-heartbeat",a);a=a.editMode;if(a!==f.get("edit-mode")&&!(a==="collaborative"&&f.get("edit-mode")!=="limited")){f.set("edit-mode",a);a=a==="collaborative"?"Collaborative editing was switched off, but it\u0027s back in business. Copy your changes and refresh the page to keep editing.":"Copy any changes you want to keep, then refresh the page to continue editing.";s({messageKey:"edit-mode-transition",message:a,disablePublish:true})}}},
"json").fail(function(a,b,f){(a.status>=500||a.status===0)&&c.Editor.heartbeatType.recovery();if(a.status===403||a.status===401)d.logError("Heartbeat error: Unauthorized");else if(a.status===405)d.logError("Heartbeat error: Method not allowed");else{d.logError("Server error on heartbeat request:");d.log(f)}d.trigger("rte.heartbeat-error",a)})},heartbeatType:{normal:function(){J(y)},recovery:function(){J(M)},reset:function(){g&&g.clear();g=y;g.start(c.Editor.heartbeat)},cleanup:function(){if(g){g.clear();
g=null}r&&r.abort&&r.abort()}},disableFrame:function(a){b("form",a).each(function(){b(this).unbind();this.onsubmit=function(){return false}});b("a",a).each(function(){var a=b(this),c=a.attr("href");a.unbind();if(c&&c.charAt(0)!=="#"){a.attr("target","_top");a.bind("click",function(b){b.preventDefault();a.blur()})}});b("input, img",a).each(function(){b(this).unbind()})},previewFrameOnload:function(a,e){var i=require("tinymce");c.Editor.setMode(c.Editor.MODE_PREVIEW);i.activeEditor.setProgressState(false);
c.Editor.disableFrame(a);b(".tipsy").remove();var h=b("#main",a)[0];if(f.get("content-type")!=="comment"&&b(h).find("#main-header").length===0){var g=b("#title-heading"),k=g.attr("class");b(h).prepend('<div id="preview-header"><div id="title-heading" class="'+k+'">'+g.html()+"</div></div>")}if(b(d.Rte.getEditor().getBody()).hasClass("resizable")){var n=b(e||"#previewArea iframe"),l=0,m=0,o,p=n.height();h&&function S(){var a;if(b("#editor-preview-iframe").length){a=b(h).outerHeight(true);if(l!==a){a!==
n.height()&&n.height(0).height(Math.max(a,p));l=a;m=0}else m++;m<500&&(o=setTimeout(S,500))}}();b(j).one("mode-changed.resize-editor",function(a,b){b!==c.Editor.MODE_PREVIEW&&o&&clearTimeout(o)})}else if(i.isIE||i.isOpera){i=b(O).height();g=b("#header-precursor").height()+b("#header").height()+b("#editor-precursor").height();k=b("#savebar-container").height();b("#preview iframe").height(i-g-k-4);b("#content.edit").height("auto")}},showRichText:function(a){var e=require("tinymce");m.setVisible("#wysiwyg",
a);b(".toolbar-group-preview").toggleClass("assistive",!a);b(".toolbar-group-edit").toggleClass("assistive",a);b("#main").toggleClass("active-richtext",a);e.isGecko&&a&&d.Rte.fixEditorFocus(c.Editor.bookmark)},showPreview:function(a){if(f.get("content-type")!=="comment"){var c=b("#content-title");if(c.hasClass("placeholded")){b("#preview-title-text").text("");b("#title-text").text("")}else{b("#preview-title-text").text(c.val());b("#title-text").text(c.val())}}m.setVisible("#preview",a);b(".toolbar-group-preview").toggleClass("assistive",
a);b(".toolbar-group-edit").toggleClass("assistive",!a);b("#main").toggleClass("active-preview",a);b("#full-height-container").length&&b("#full-height-container").toggleClass("active-preview",a)},setMode:function(a){d.debug("Set mode: "+a);if(a===c.Editor.MODE_RICHTEXT){this.showRichText(true);this.showPreview(false)}else if(a===c.Editor.MODE_PREVIEW){this.showPreview(true);this.showRichText(false);c.Editor.UI.spinner.removeClass("aui-icon-wait")}setTimeout(function(){var a=b(".toolbar-group-preview");
a.height(0);a.height();a.height("auto")},1);this.currentEditMode=a;b(j).trigger("mode-changed",[a])},getContentId:function(){return c.getContentId()},addErrorMessage:function(a,c,f){var h=b("#"+a),f=f?"#any-messages":"#editor-messages";h.length?h.empty():h=b("<div></div>").attr("id",a).appendTo(f);d.messages.error(h,{closeable:true,body:c})},changeMode:function(a,e){var i=require("tinymce");d.debug("Change mode: "+a);e=e||{};if(this.inRichTextMode()&&!d.Rte.BootstrapManager.isInitComplete()||this.currentEditMode===
a)return false;var h=this.currentEditMode;d.trigger("rte-changeMode",a);if(a===c.Editor.MODE_PREVIEW){var g=d.Rte.getEditor();if(i.isGecko&&h===c.Editor.MODE_RICHTEXT&&!c.Editor.bookmark)c.Editor.bookmark=i.activeEditor.selection.getBookmark();this.currentEditMode=a;i={contentId:c.getContentId(),contentType:f.get("content-type"),spaceKey:f.get("space-key"),xHtml:g.getContent(),outputType:c.Editor.PREVIEW_OUTPUT_TYPE};d.safe.ajax({type:"POST",url:n.CONTEXT_PATH+"/pages/rendercontent.action",data:i,
success:c.Editor.replysetPreviewArea,timeout:2E4,error:function(){d.trigger("rte-preview-action-selected");d.trigger("rte.preview.error",{status:0});k.closeMessages(["server-offline"]);s({messageKey:"server-offline",message:"Can\u0027t reach the server. Check you\u0027re connected to the internet and Confluence is up and running.",disablePublish:false});c.Editor.currentEditMode=h;e.errorCallback&&e.errorCallback()}}).always(function(){f.getBoolean("shared-drafts")&&(f.get("content-type")==="page"||f.get("content-type")==="blogpost")&&c.Editor.Drafts.save({skipErrorHandler:true})})}else this.setMode(a);
a===c.Editor.MODE_RICHTEXT&&b(j).trigger("resize.resizeplugin");if(h===c.Editor.MODE_PREVIEW)if(i=j.getElementById("editor-preview-iframe")){g=i.contentDocument||i.contentWindow.document;g.removeChild(g.documentElement);b(i).remove()}return false},replysetPreviewArea:function(a){var c=require("tinymce");d.trigger("rte-preview-action-selected");b("#preview-error").remove();c.activeEditor.setProgressState(true);var c=b("#previewArea"),f=b('<iframe id="editor-preview-iframe" src="about:blank" scrolling="yes" frameborder="0"></iframe>');
c.html(f);c=f[0].contentDocument||f[0].contentWindow.document;c.open();c.write(a);c.close()},inRichTextMode:function(){return this.currentEditMode===c.Editor.MODE_RICHTEXT},isNewPage:function(){return b("#createpageform, #createpagetemplate").length>0},onInit:function(){c.Editor.setMode(c.Editor.MODE_RICHTEXT);d.Rte.getEditor().on("click",function(){var a=c.Editor.UI.postingDatePicker;a&&a.hide()})},contentChangeHandler:function(){this.contentHasChangedSinceLastSave=true},getCurrentForm:function(){return d.Rte.getEditor().formElement},
setToolBarInactive:function(a){b("#rte-toolbar").toggleClass("disabled",a)},isVisible:function(){return b("#wysiwyg:visible").length>0||b("#preview:visible").length>0}}});
require("confluence/module-exporter").safeRequire("confluence-editor/editor/page-editor",function(d){var c=require("confluence/legacy"),b=require("jquery"),j=require("ajs");c.Editor=b.extend(c.Editor||{},d);j.toInit(function(b){b(document).ajaxError(function(b,c){if(405===c.status)try{var d=JSON.parse(c.responseText).reason;"undefined"!==typeof d&&"READ_ONLY"===d&&(j.log("*** READ_ONLY mode detected ***"),j.trigger("rte.heartbeat-error",null,c))}catch(m){j.logError("Cannot parse xhr.responseText: "+
m)}});j.bind("init.rte",c.Editor.onInit)});j.Editor=c.Editor});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:page-editor-js', location = 'editor/page-editor-ui.js' */
define("confluence-editor/editor/page-editor-ui","jquery confluence/templates ajs confluence/meta confluence/legacy window moment document confluence/api/constants confluence-editor/editor/page-editor-message confluence-editor/editor/page-editor-quit-dialog confluence/form-state-control".split(" "),function(b,f,c,e,d,m,r,h,t,u,n,o){return function(){var a={},k=false,j=function(c,b){for(var b=b||a.buttons,d=0;d<b.length;d++)l(c,b[d])},l=function(a,b){if(b)if(a){b.removeAttr("aria-disabled");b.removeClass("disabled");
b.is("button")&&b.removeAttr("disabled")}else{b.attr("aria-disabled","true");b.addClass("disabled");b.is("button")&&b.attr("disabled","disabled")}},p=function(a){return a.length&&a.attr("aria-disabled")!=="true"},g=function(){return e.get("new-page")},q=function(){var a="";g()||(a="Edit"+" - ");return a};a.spinner=b("#rte-spinner");var i;i=f.Editor.Page.saveButton({contentType:e.get("content-type"),sharedDraftsEnabled:e.getBoolean("shared-drafts"),isNewPage:g()});b("#rte-button-publish").replaceWith(i);
i=b("#rte-button-publish");a.saveButton=i;a.overwriteButton=b("#rte-button-overwrite");a.editButton=b("#rte-button-edit");a.previewButton=b("#rte-button-preview");a.cancelButton=b("#rte-button-cancel");a.versionCommentInput=b("#versionComment");a.watchPageCheckbox=b("#watchPage");a.watchPageToolbarGroup=b(".toolbar-group-watch-page");a.buttons=[a.saveButton,a.overwriteButton,a.editButton,a.previewButton,a.cancelButton];c.bind("editor-shared-drafts-published",function(){var b=/\(.+\)/g.exec(a.saveButton.data("tooltip"))[0];
a.saveButton.text(f.Editor.Page.saveButtonText({contentType:e.get("content-type"),sharedDraftsEnabled:e.getBoolean("shared-drafts"),isNewPage:g()})).attr("title",f.Editor.Page.saveButtonTitle({contentType:e.get("content-type"),sharedDraftsEnabled:e.getBoolean("shared-drafts"),isNewPage:g()})+b).tooltip({gravity:"s"})});c.bind("synchrony.history.evicted",function(){k=true;l(false,a.versionCommentInput);try{c.Rte.getEditor().plugins.customtoolbar.disableToolbar(true);c.Rte.getEditor().plugins.customtoolbar.toggleToolbarButtons(true,
true,true)}catch(d){}try{c.Rte.getEditor().setMode("readonly")}catch(e){}try{c.Rte.getEditor().plugins.pagelayoutplugin.disableContent()}catch(h){}try{b("input#content-title").attr("disabled","true")}catch(v){}});a.setButtonsState=j;a.setButtonState=l;a.isButtonEnabled=p;a.registerFormButton=function(b,c){a[b]=c;a.buttons.push(c)};a.postingDatePicker=null;a.isFormEnabled=function(){for(var b=0;b<a.buttons.length;b++)if(p(a.buttons[b]))return true;return false};a.toggleSavebarBusy=function(b){if(k!==
true)if(b){if(!a.isFormEnabled())return false;a.spinner.addClass("aui-icon-wait");j(false)}else{a.spinner.removeClass("aui-icon-wait");j(true)}return true};a.init=function(){function f(){b("#rte-ellipsis-menu").is(":visible")&&b("#rte-button-ellipsis").trigger("aui-button-invoke")}n.init();d.Editor.addSaveHandler(function(b){if(a.isButtonEnabled(a.saveButton)){a.toggleSavebarBusy(true);c.trigger("confluence.editor.on.save")}else{b.stopImmediatePropagation();b.preventDefault()}});c.trigger("rte.init.ui");
d.Editor.isNewPage()&&b("#content-title").focus().select();d.Editor.addCancelHandler(function(b){d.Editor.getNumConcurrentEditors()>1&&c.Confluence.Analytics.publish("rte.notification.concurrent-editing.cancel",{numEditors:d.Editor.getNumConcurrentEditors(),pageId:c.params.pageId,draftType:c.params.draftType});if(e.getBoolean("shared-drafts")&&(e.get("content-type")==="page"||e.get("content-type")==="blogpost"))if(a.isButtonEnabled(a.cancelButton))a.toggleSavebarBusy(true);else{b.stopImmediatePropagation();
b.preventDefault()}n.process(b)});e.get("content-type")==="comment"&&d.Editor.addSaveHandler(function(){var b=require("confluence/editor-notifications");if(c.Rte.Content.isEmpty()){b.notify("warning","Comment text is empty. Cannot create empty comments.");a.toggleSavebarBusy(false);return false}});(e.get("content-type")==="comment"||e.get("content-type")==="template")&&d.Editor.addCancelHandler(function(b){if(a.isFormEnabled()&&d.Editor.hasContentChanged()&&!d.Editor.isEmpty()){var s=e.get("content-type")==="comment"?"Your comment will be lost.":
"Your unsaved template changes will be lost.";if(!m.confirm(s)){b.stopImmediatePropagation();return false}}});a.versionCommentInput.on("keypress",function(a){a.keyCode===13&&n.process(a)});d.Editor.addSaveHandler(function(){d.Editor.getNumConcurrentEditors()>1&&c.Confluence.Analytics.publish("rte.notification.concurrent-editing.save",{numEditors:d.Editor.getNumConcurrentEditors(),pageId:c.params.pageId,draftType:c.params.draftType})});d.Editor.addSubmitHandler(function(a){return d.Editor.contentFormSubmit(a)});
this.currentEditMode=this.MODE_RICHTEXT;a.editButton.click(function(b){var e=require("tinymce");if(a.isFormEnabled()){d.Editor.changeMode(d.Editor.MODE_RICHTEXT);setTimeout(function(){c.Rte.getEditor().focus();e.isGecko&&d.Editor.bookmark&&c.Rte.getEditor().selection.moveToBookmark(d.Editor.bookmark)},0);k!==true&&o.enableElement(a.cancelButton)}b.preventDefault()});a.previewButton.click(function(b){b.preventDefault();if(k!==true){b=require("tinymce");if(a.isFormEnabled()&&d.Editor.currentEditMode!==
d.Editor.MODE_PREVIEW){f();j(false);a.spinner.addClass("aui-icon-wait");if(b.isGecko&&!d.Editor.bookmark)d.Editor.bookmark=b.activeEditor.selection.getBookmark();d.Editor.changeMode(d.Editor.MODE_PREVIEW,{errorCallback:function(){j(true);a.spinner.removeClass("aui-icon-wait")}});e.get("content-type")==="comment"||e.get("content-type")==="template"?o.disableElement(a.cancelButton):o.enableElement(a.cancelButton)}}});b("#rte-button-labels").bind("updateLabel",function(){var a=+e.get("num-labels")||
0,d="Labels";a===1?d=c.format("{0} Label",a):a>1&&(d=c.format("{0} Labels",a));b("#rte-button-labels").attr("data-tooltip",d)});b("#draft-status-lozenge").length&&b("#draft-status-lozenge").tooltip();var g=b("#PostingDate");if(g.length){g.attr("max",r().format("YYYY-MM-DD"));a.postingDatePicker=g.datePicker({overrideBrowserDefault:true});a.postingDatePicker.hide()}b("#wysiwygTextarea_parent .mceProgress, #wysiwygTextarea_parent .mceBlocker").on("click",
function(){c.Rte.getEditor().focus()});b(m).bind("render-content-loaded",function(c,e){var f=b("#previewArea iframe");if(f.contents().find("body")[0]==e){d.Editor.previewFrameOnload(e,f);[a.saveButton,a.overwriteButton,a.editButton,a.previewButton].forEach(function(a){l(true,a)});f.focus();m.focus();b(h).trigger("iframeAppended",f)}});if(e.get("heartbeat")){d.Editor.heartbeat();d.Editor.heartbeatType.normal();c.bind("rte-destroyed",d.Editor.heartbeatType.cleanup)}c.bind("watchpage.pageoperation",
function(){a.toggleWatchPage(false)});c.bind("unwatchpage.pageoperation",function(){a.toggleWatchPage(true)});if(e.get("new-page")&&e.get("form-name")==="inlinecommentform")h.title="Edit"+h.title;var i=h.title;if(e.get("new-page")&&b.trim(b("input#content-title").val()))h.title=q()+b("input#content-title").val()+" - "+e.get("space-name")+" - "+e.get("site-title");b("input#content-title").on("change input",function(){if(e.get("content-type")!=="template"){var a=q();h.title=b.trim(this.value)?
a+this.value+" - "+e.get("space-name")+" - "+e.get("site-title"):i}});b("body",b("#wysiwygTextarea_ifr").contents()).click(f);c.trigger("init.rte-control")};a.toggleWatchPage=function(b){if(b&&e.get("content-type")==="comment"){a.watchPageToolbarGroup.show();if(a.watchPageCheckbox.length)a.watchPageCheckbox[0].checked=false}else a.watchPageToolbarGroup.hide()};return a}});
require("confluence/module-exporter").safeRequire("confluence-editor/editor/page-editor-ui",function(b){var f=require("confluence/legacy");require("confluence/api/event").bind("init.rte",function(){var c=b();f.Editor.UI=c;c.init()})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:page-editor-js', location = 'tinymce3/plugins/insertwiki/insert-wiki-markup.soy' */
// This file was automatically generated from insert-wiki-markup.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.InsertWiki.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.InsertWiki == 'undefined') { Confluence.Templates.InsertWiki = {}; }


Confluence.Templates.InsertWiki.originalDefaultTempWikiMarkupDialog = function(opt_data, opt_ignored) {
  return '<form action=\'#\' method=\'post\' id="insert-wiki-markup-form" class="aui"><textarea class=\'monospaceInput textarea originalDefault\' id=\'insert-wiki-textarea\' name=\'wikitext\'></textarea></form>';
};
if (goog.DEBUG) {
  Confluence.Templates.InsertWiki.originalDefaultTempWikiMarkupDialog.soyTemplateName = 'Confluence.Templates.InsertWiki.originalDefaultTempWikiMarkupDialog';
}


Confluence.Templates.InsertWiki.previewWikiIframeContent = function(opt_data, opt_ignored) {
  return '<!DOCTYPE html><html class="insert-wiki-markup-dialog"><head></head><body class="wiki-content previewWiki"></body></html>';
};
if (goog.DEBUG) {
  Confluence.Templates.InsertWiki.previewWikiIframeContent.soyTemplateName = 'Confluence.Templates.InsertWiki.previewWikiIframeContent';
}


Confluence.Templates.InsertWiki.wikiMarkupDialog = function(opt_data, opt_ignored) {
  return '<p id="insert-wiki-info-title">' + soy.$$escapeHtml('Enter wiki markup or markdown below. Confluence will convert your content to editor format and insert it into your page.') + '</p><form action=\'#\' method=\'post\' id="insert-wiki-markup-form" class="aui"><h3 class="wiki-title"><span id="insert-wiki-insert-title">' + soy.$$escapeHtml('Insert') + '</span><span id="insert-wiki-preview-title">' + soy.$$escapeHtml('Preview') + '</span></h3><textarea class=\'monospaceInput textarea\' id=\'insert-wiki-textarea\' name=\'wikitext\'></textarea><!-- --><div class=\'example-container\' id=\'insert-wiki-textarea-preview\'></div></form>';
};
if (goog.DEBUG) {
  Confluence.Templates.InsertWiki.wikiMarkupDialog.soyTemplateName = 'Confluence.Templates.InsertWiki.wikiMarkupDialog';
}


Confluence.Templates.InsertWiki.wikiErrorSubDialog = function(opt_data, opt_ignored) {
  return '<p class=\'warning\'>' + soy.$$escapeHtml(opt_data.warningMessage) + '</p><p class=\'exception-report\'><span class=\'exceptionMessage\'>' + soy.$$escapeHtml(opt_data.exceptionMessage) + '</span></p>';
};
if (goog.DEBUG) {
  Confluence.Templates.InsertWiki.wikiErrorSubDialog.soyTemplateName = 'Confluence.Templates.InsertWiki.wikiErrorSubDialog';
}


Confluence.Templates.InsertWiki.wikiParserSelector = function(opt_data, opt_ignored) {
  var output = '<span class="wiki-parser-selector"><form action="#" method="post" id="d" class="aui"><select class="select medium-field" id="wiki-parser-selection-tool" name="wiki-parser-selection-tool" title="wiki parser selector"><option value="' + soy.$$escapeHtml(opt_data.DEFAULT.val) + '">' + soy.$$escapeHtml(opt_data.DEFAULT.label) + '</option>';
  var wikiLangList26 = soy.$$getMapKeys(opt_data.WIKI);
  var wikiLangListLen26 = wikiLangList26.length;
  for (var wikiLangIndex26 = 0; wikiLangIndex26 < wikiLangListLen26; wikiLangIndex26++) {
    var wikiLangData26 = wikiLangList26[wikiLangIndex26];
    output += (opt_data.WIKI[wikiLangData26].val != opt_data.DEFAULT.val) ? '<option value="' + soy.$$escapeHtml(opt_data.WIKI[wikiLangData26].val) + '">' + soy.$$escapeHtml(opt_data.WIKI[wikiLangData26].label) + '</option>' : '';
  }
  output += '</select></form></span>';
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.InsertWiki.wikiParserSelector.soyTemplateName = 'Confluence.Templates.InsertWiki.wikiParserSelector';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:page-editor-js', location = 'editor/page-editor.soy' */
// This file was automatically generated from page-editor.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Editor.Page.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Editor == 'undefined') { Confluence.Templates.Editor = {}; }
if (typeof Confluence.Templates.Editor.Page == 'undefined') { Confluence.Templates.Editor.Page = {}; }


Confluence.Templates.Editor.Page.saveButton = function(opt_data, opt_ignored) {
  return '<button id="rte-button-publish" class="aui-button aui-button-primary default-submit" type="submit" name="confirm" value="Save" title="' + Confluence.Templates.Editor.Page.saveButtonTitle(opt_data) + '" tabindex="101">' + Confluence.Templates.Editor.Page.saveButtonText(opt_data) + '</button>';
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.saveButton.soyTemplateName = 'Confluence.Templates.Editor.Page.saveButton';
}


Confluence.Templates.Editor.Page.saveButtonTitle = function(opt_data, opt_ignored) {
  return '' + ((opt_data.contentType == 'blogpost') ? soy.$$escapeHtml('Publish your blog post') : (opt_data.contentType == 'page') ? (opt_data.sharedDraftsEnabled) ? (opt_data.isNewPage) ? soy.$$escapeHtml('Publish changes') : soy.$$escapeHtml('Update the published page') : soy.$$escapeHtml('Save your page') : soy.$$escapeHtml('Save'));
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.saveButtonTitle.soyTemplateName = 'Confluence.Templates.Editor.Page.saveButtonTitle';
}


Confluence.Templates.Editor.Page.previewButton = function(opt_data, opt_ignored) {
  return '<button class="aui-button toolbar-item" id="rte-button-preview" title="' + soy.$$escapeHtml('Preview') + '" type="button"><span class="trigger-text">' + soy.$$escapeHtml('Preview') + '</span></button>';
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.previewButton.soyTemplateName = 'Confluence.Templates.Editor.Page.previewButton';
}


Confluence.Templates.Editor.Page.saveButtonText = function(opt_data, opt_ignored) {
  return '' + ((opt_data.sharedDraftsEnabled && (opt_data.contentType == 'blogpost' || opt_data.contentType == 'page')) ? (opt_data.isNewPage) ? soy.$$escapeHtml('Publish') : soy.$$escapeHtml('Update') : (opt_data.contentType == 'blogpost') ? soy.$$escapeHtml('Publish') : soy.$$escapeHtml('Save'));
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.saveButtonText.soyTemplateName = 'Confluence.Templates.Editor.Page.saveButtonText';
}


Confluence.Templates.Editor.Page.cancelButton = function(opt_data, opt_ignored) {
  return '' + ((opt_data.sharedDraftsEnabled && (opt_data.contentType == 'page' || opt_data.contentType == 'blogpost')) ? '<ul class="aui-buttons rte-toolbar-group-done close"><button class="aui-button shared-drafts" type="submit" id="rte-button-cancel" name="cancel" value="cancel"><span class="icon aui-icon aui-icon-small aui-iconfont-close-dialog"></span></button></ul>' : '<div class="aui-buttons cancel-button-container-shared-draft cancel-button-container-quick-edit"><button class="aui-button toolbar-item" type="submit" id="rte-button-cancel" name="cancel" value="cancel"><span class="trigger-text">' + ((opt_data.contentType == 'page' || opt_data.contentType == 'blogpost') ? soy.$$escapeHtml('Close') : soy.$$escapeHtml('Cancel')) + '</span></button></div>');
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.cancelButton.soyTemplateName = 'Confluence.Templates.Editor.Page.cancelButton';
}


Confluence.Templates.Editor.Page.quitDialogHeader = function(opt_data, opt_ignored) {
  var output = '';
  switch (opt_data.dialogType) {
    case 'delete':
    case 'revert':
      output += (opt_data.newPage) ? (opt_data.contentType == 'blogpost') ? '<h2 class="aui-dialog2-header-main">' + soy.$$escapeHtml('Delete unpublished blog post?') + '</h2>' : '<h2 class="aui-dialog2-header-main">' + soy.$$escapeHtml('Delete unpublished page?') + '</h2>' : '<h2 class="aui-dialog2-header-main">' + soy.$$escapeHtml('Revert to last published version?') + '</h2>';
      break;
    case 'publish':
    case 'update':
      output += '<h2 class="aui-dialog2-header-main">' + soy.$$escapeHtml('Publish all changes?') + '</h2>';
      break;
    case 'diff':
      output += '<h2 class="aui-dialog2-header-main">' + soy.$$escapeHtml('Unpublished changes') + '</h2>';
      break;
  }
  output += '<a class="aui-dialog2-header-close"><span class="aui-icon aui-icon-small aui-iconfont-close-dialog">' + soy.$$escapeHtml('Close') + '</span></a>';
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.quitDialogHeader.soyTemplateName = 'Confluence.Templates.Editor.Page.quitDialogHeader';
}


Confluence.Templates.Editor.Page.quitDialogContent = function(opt_data, opt_ignored) {
  var output = '';
  switch (opt_data.dialogType) {
    case 'revert':
      output += (opt_data.contributors.length == 0) ? ((opt_data.contentType == 'blogpost') ? soy.$$filterNoAutoescape('This will permanently delete all the changes you made since this blog post was last published') : soy.$$filterNoAutoescape('This will permanently delete all the changes you made since this page was last published.')) + '<div class="aui-dialog2-footer-hint"><a id="qed-show-diff-button" class="aui-button aui-button-link">' + soy.$$escapeHtml('Show changes') + '</a></div>' : soy.$$filterNoAutoescape('This will permanently delete all the changes that the following people have made since this page was last published.') + '<div class="aui-dialog2-footer-hint"><a id="qed-show-diff-button" class="aui-button aui-button-link">' + soy.$$escapeHtml('Show changes') + '</a></div>' + Confluence.Templates.Editor.Page.contributorList(opt_data);
      break;
    case 'delete':
      output += (opt_data.contributors.length == 0) ? (opt_data.contentType == 'blogpost') ? soy.$$filterNoAutoescape('Once you delete an unpublished blog post, it\x27s gone for good.') : soy.$$filterNoAutoescape('If you delete an unpublished page, it\x27s gone for good.') : ((opt_data.contentType == 'blogpost') ? soy.$$filterNoAutoescape('This will permanently delete this blog post, which you and these other people have worked on.') : soy.$$filterNoAutoescape('This will permanently delete this page, which you and these other people have worked on.')) + Confluence.Templates.Editor.Page.contributorList(opt_data);
      break;
    case 'publish':
    case 'update':
      output += soy.$$filterNoAutoescape('\x3cp\x3eThere are changes made by you and other people that haven\x27t been published yet.\x3c/p\x3e\x3cp\x3eThese people have made changes:\x3c/p\x3e') + Confluence.Templates.Editor.Page.contributorList(opt_data);
      break;
    case 'diff':
      output += '<div><div class="legend"><span class="legend-title">' + soy.$$escapeHtml('Key') + ': </span><span class="diff-html-added">' + soy.$$escapeHtml('This line was added.') + '</span><span class="diff-html-removed">' + soy.$$escapeHtml('This line was removed.') + '</span><span class="diff-html-changed">' + soy.$$escapeHtml('Formatting was changed.') + '</span></div>' + ((! opt_data.newDialog) ? '<a class="aui-button aui-button-link" id="qed-hide-diff-button">' + soy.$$escapeHtml('Show contributors') + '</a>' : '') + '<hr/><div class="wiki-content"></div></div>';
      break;
  }
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.quitDialogContent.soyTemplateName = 'Confluence.Templates.Editor.Page.quitDialogContent';
}


Confluence.Templates.Editor.Page.hiddenInputCancel = function(opt_data, opt_ignored) {
  return '<input type="hidden" name="cancel" value="cancel">';
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.hiddenInputCancel.soyTemplateName = 'Confluence.Templates.Editor.Page.hiddenInputCancel';
}


Confluence.Templates.Editor.Page.contributorList = function(opt_data, opt_ignored) {
  var output = '<ul class="contributor-list">';
  var contributorList157 = opt_data.contributors;
  var contributorListLen157 = contributorList157.length;
  for (var contributorIndex157 = 0; contributorIndex157 < contributorListLen157; contributorIndex157++) {
    var contributorData157 = contributorList157[contributorIndex157];
    output += '<li><div class="contributor-avatar"><span class="aui-avatar aui-avatar-large"><span class="aui-avatar-inner"><img src="' + soy.$$escapeHtml(contributorData157.avatarURL) + '"/></span></span></div><div class="contributor-name"><span>' + soy.$$escapeHtml(contributorData157.fullname) + '</span></div></li>';
  }
  output += '</ul>';
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.contributorList.soyTemplateName = 'Confluence.Templates.Editor.Page.contributorList';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:page-editor-js', location = 'insert-image-dialog/insert-image-dialog.js' */
define("confluence-editor/insert-image-dialog/insert-image-dialog",["jquery","ajs","underscore","confluence/legacy"],function(c,f,e,h){var g={beforeShowListeners:[],panelComponent:[],sizeToFit:function(){this.each(function(){var a=this,b=c(this).parent(),d=b.height();b.children().each(function(){this!==a&&c(this).is(":visible")&&(d-=c(this).outerHeight())});b=c(this).outerHeight()-c(this).height();c(this).css("height",Math.max(0,d-b)+"px")});return this},defaultInsertImageDialog:function(){f.Rte.BookmarkManager.storeBookmark();
g.insertImageDialog(function(a){var b=require("tinymce");f.Rte.BookmarkManager.restoreBookmark();var d={};if(a.url)d={url:a.url,filename:a.url,contentId:a.contentId},b.confluence.ImageUtils.insertFromProperties(d);else{var i=!0,h=1<a.selectItems.length;e.each(a.selectItems,function(a){a.isImage()?(d={filename:a.getFileName(),contentId:a.get("ownerId")},b.confluence.ImageUtils.insertFromProperties(d,h)):(i=!1,f.MacroBrowser.getMacroMetadata("view-file")?g._insertFilePlaceholderToEditor(a):g._insertLinkToEditor(a))});
require(["confluence-drag-and-drop/analytics/files-upload-analytics"],function(b){b.triggerEvent("confluence.insert-files-dialog.insert",a.selectItems,i)})}c("#comments-section").length&&f.Rte.fixEditorFocus()},function(){f.Rte.BookmarkManager.restoreBookmark()})},findPanelComponentById:function(a){for(var b=h.Editor.ImageDialog.panelComponent,d=0,c=b.length;d<c;d++)if(b[d].id==a)return b[d]},insertImageDialog:function(a,b){var d=new h.Editor.FileDialog.FileDialogView({submitCallback:a,cancelCallback:b,
beforeShowListeners:g.beforeShowListeners,panelComponents:g.panelComponent});d.render();return d},_insertLinkToEditor:function(a){var b=h.Link.fromREST(a.attributes);b.attrs["data-linked-resource-container-id"]=a.get("ownerId");b.attrs.href=a.get("downloadUrl");b.insert()},_insertFilePlaceholderToEditor:function(a){var b={name:a.get("fileName"),page:a.get("parentTitle"),space:a.get("space")?a.get("space").key:"",date:a.get("datePath"),ownerId:a.get("ownerId")};require(["confluence-editor/utils/attachments-insert-utils"],
function(a){a.insertFilePlaceholder(b)})}};return g});
require("confluence/module-exporter").safeRequire("confluence-editor/insert-image-dialog/insert-image-dialog",function(c){var f=require("jquery"),e=require("confluence/legacy");f.fn.sizeToFit=c.sizeToFit;e.Editor.ImageDialog=c;e.Editor.defaultInsertImageDialog=c.defaultInsertImageDialog;e.Editor.ImageDialog.findPanelComponentById=c.findPanelComponentById;e.Editor.insertImageDialog=c.insertImageDialog;e.Editor.ImageDialog._insertLinkToEditor=c._insertLinkToEditor;e.Editor.ImageDialog._insertFilePlaceholderToEditor=
c._insertFilePlaceholderToEditor});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:page-editor-js', location = 'panel-components/panel-components-init.js' */
define("confluence-editor/panel-components/panel-components-init",["confluence/legacy","confluence/meta"],function(a,d){return function(){if(a.Editor&&a.Editor.ImageDialog&&a.Editor.ImageDialog.panelComponent){var b=a.Editor.FileDialog.eventListener,e=a.Editor.FileDialog.ExternalPanelView,f=a.Editor.FileDialog.SearchPanelView,g=a.Editor.FileDialog.AttachmentsPanelView,c=a.Editor.ImageDialog.panelComponent;"template"!==d.get("content-type")&&(b=new g({eventListener:b}),c.push(b));c.push(new e);c.push(new f)}}});
require("confluence/module-exporter").safeRequire("confluence-editor/panel-components/panel-components-init",function(a){require("ajs").toInit(a)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:page-editor-js', location = 'drafts/page-editor-drafts.js' */
define("confluence-editor/page-editor-drafts","jquery ajs confluence/meta confluence/legacy confluence/api/constants confluence-editor/editor/page-editor-message confluence-editor/loader/collaborative-helper".split(" "),function(d,a,g,b,n,s,t){var o=false,l=false,h=false,p=null,u=g.get("remote-user")!=="",v=a.DarkFeatures.isEnabled("editor.ajax.save")&&!a.DarkFeatures.isEnabled("editor.ajax.save.disable"),q=false,m=false,i=function(a,b,g){d("<input>").attr({type:"hidden",name:a,value:b}).appendTo(g)},
k=function(){return g.getBoolean("shared-drafts")};a.bind("editor-shared-drafts-published editor-shared-drafts-discarded",function(){l=o=false});a.bind("synchrony.history.evicted",function(){q=true});a.bind("synchrony.connected",function(){m=true});return{isDraftSaved:function(){return o},isDraftManuallySaved:function(){return l},isDraftBlank:function(){return a.Rte.Content.isEmpty()&&!d.trim(b.Editor.getCurrentTitle())},isNewContent:function(){return a.Rte.getEditor()&&g.getBoolean("new-page")===
true},isDraftDirty:function(){return b.Editor.hasContentChanged()||b.Editor.Drafts.isDraftSaved()&&!b.Editor.Drafts.isDraftManuallySaved()},unloadMessage:function(){var e=function(){b.Editor.Drafts.isDraftBlank()&&!k()?b.Editor.Drafts.discardDraft(g.get("draft-id")):b.Editor.Drafts.save({skipErrorHandler:true})};if(typeof seleniumAlert!=="undefined")e();else if(b.Editor.isLimitedModeEnabled()||!k()){if(b.Editor.hasContentChanged()||b.Editor.Drafts.isDraftSaved()&&!b.Editor.Drafts.isDraftManuallySaved()){e();
return "A draft will be saved. You can resume editing this draft the next time you open the editor or view all your drafts in your profile."}}else{e();if(m&&(h||b.Editor.hasContentChanged()||q))return "We haven\u0027t finished saving your changes. If you leave before seeing the \u0027Draft saved\u0027 message, you might lose your changes."}},hasPendingChanges:function(){return h},setPendingChanges:function(a){h=a},isSharedDraftsEnabled:k,bindUnloadMessage:function(){if(!b.Editor.isLimitedModeEnabled()&&k()){a.bind("synchrony.entity.ack",function(a,b){b.pendingChanges||(h=false)});a.bind("editor.local.change",function(){h=true})}d(window).bind("beforeunload",b.Editor.Drafts.unloadMessage)},
unBindUnloadMessage:function(){d(window).unbind("beforeunload")},useDraft:function(){var e=g.get("existing-draft-id");b.Editor.Drafts.unBindUnloadMessage();var c=b.Editor.getCurrentForm();i("useDraft","true",c);i("contentChanged",""+b.Editor.hasContentChanged(),c);i("pageId",a.params.pageId,c);d("#draftId",b.Editor.getCurrentForm()).val(e);c.spaceKey||i("spaceKey",g.get("space-key"),c);c.action=n.CONTEXT_PATH+"/pages/"+(a.params.newPage?"create":"edit")+a.params.draftType+".action";c.submit()},discardDraft:function(b){return a.safe.ajax({url:n.CONTEXT_PATH+
"/rest/api/content/"+b+"?status=draft",type:"DELETE",dataType:"json",data:{},contentType:"application/json",success:function(){d("#draft-messages").remove();a.messages.success("#editor-messages",{body:"Your draft has been discarded."})},error:function(b){a.messages.error({title:"Error",body:b.errors||"An unknown error has occurred. Please check your logs."})}})},save:function(e){e=e||{};if(!q)if(b.Editor.isPublishing()||!b.Editor.editorHasContentChanged()&&!e.forceSave){a.debug("skipping draft save because:");
b.Editor.isPublishing()?a.debug("The user is publishing the page already."):!b.Editor.editorHasContentChanged()&&!e.forceSave&&a.debug("The content hasn't changed and a forceSave wasn't requested in the options.")}else{a.debug("preparing to save editor draft");var c=d("#content-title"),h=d("#newSpaceKey"),i=d("#originalVersion"),m=b.Editor.inRichTextMode(),r={draftId:g.get("draft-id"),pageId:g.get("page-id"),parentPageId:g.get("parent-page-id"),type:a.params.draftType,title:c.hasClass("placeholded")?
"":c.val(),spaceKey:h.length?h.val():encodeURIComponent(g.get("space-key"))};t.getEditorContent().pipe(function(c){d.extend(r,c);if(i.length)r.pageVersion=parseInt(i.val(),10);p=d.ajax({type:"POST",url:n.CONTEXT_PATH+"/rest/tinymce/1/drafts"+(e.ignoreRelations?"?ignoreRelations=true":""),data:d.toJSON(r),contentType:"application/json",dataType:"text json",success:function(c){if(c!=null&&(!(u&&c.draftId===0)||!v)){b.Editor.contentHasChangedSinceLastSave=false;m&&a.Rte.Content.editorResetContentChanged();
o=true;l=!!e.manualSave;g.set("draft-id",c.draftId+"");d("#draftId",b.Editor.getCurrentForm()).val(c.draftId);d("#draft-error").remove();if(!g.get("collaborative-content")){var h=d("#draft-status"),f;if(!(f=c.time)){var j=new Date;f=j.getHours();var j=j.getMinutes(),i=f>11?"PM":"AM";f=f%12;f=(f==0?"12":f)+":"+(j<10?"0":"")+j+" "+i}j=l?a.format("Draft saved at {0}",f):a.format("Draft autosaved at {0}",f);i=a.params.newPage?j:"<a id='view-diff-link-heartbeat' class='view-diff-link' href='#'>"+
j+"</a>";h.attr("data-tooltip",j);h.html(i)}if(d.isFunction(e.onSuccessHandler))e.onSuccessHandler(c);b.Editor.Drafts.lastSaveTime=f;a.trigger("rte-draft-saved",{draftId:c.draftId})}},error:function(c,g){var f;f=function(){b.Editor.addErrorMessage("draft-error",b.Editor.Drafts.lastSaveTime?a.format("Error saving draft. Last draft saved at {0}",b.Editor.Drafts.lastSaveTime):"Error saving draft. No draft has been saved.",true)};if(!e.skipErrorHandler&&!k()){if(c.status===400)if(c.responseText.indexOf("Legacy drafts deprecated")>=
0)s.handleMessage("legacy-draft-deprecated",{type:"error",message:"Collaborative editing is here! That means we need a little help from you to restart your editing session. All you need to do is copy the content, edit this page again, then paste it in and save."});else if(c.responseText.indexOf("Unsupported character found in content: ")>=0){f=c.responseJSON.message.split("Unsupported character found in content: ")[1];s.handleMessage("utf8-validation-failed",{title:"Unsupported character",type:"error",message:a.format("We can\u0027\u0027t save because the {0} character isn\u0027\u0027t supported by your database.\u003cbr\u003e\u003cbr\u003eRemove this character or use a Confluence symbol or emoticon instead. \u003ca href = \u0022https://confluence.atlassian.com/x/BYfsNg\u0022 target=\u0022_blank\u0022\u003eLearn more\u003c/a\u003e",f)})}else f();else f();if(d.isFunction(e.onErrorHandler))e.onErrorHandler(g)}},
timeout:3E4}).always(function(){p=null})})}},getDraftSavingPromise:function(){return p}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/page-editor-drafts","Confluence.Editor.Drafts");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:page-editor-js', location = 'editor/page-editor-permissions.js' */
define("confluence-editor/editor/page-editor-permissions",["ajs","jquery"],function(a,d){var c={updateEditPageRestrictions:function(c,b,f,i){var e=d("#rte-button-restrictions"),j=e.find(".icon"),g="",h="";c||b?(j.removeClass("aui-iconfont-locked aui-iconfont-unlocked icon-red").addClass(c?"aui-iconfont-locked icon-red":"aui-iconfont-unlocked icon-red"),g="Restrictions apply",h="Edit page restrictions. Current status: Restrictions apply"):(j.removeClass("aui-iconfont-locked aui-iconfont-unlocked icon-red").addClass("aui-iconfont-unlocked"),
f?(g="Restrictions apply",h="Edit page restrictions. Current status: Restrictions apply"):(g="Unrestricted",h="Edit page restrictions. Current status: Unrestricted"));e.attr("data-tooltip",g);e.attr("aria-label",h);e.data("explicit-restrictions",c);e.data("inherited-restrictions",b);e.data("restrictionsHash",i)},handleHeartbeat:function(k,b){if("undefined"!==typeof b.restrictionsHash){var f=d("#rte-button-restrictions");if(f.data("restrictionsHash")!==
b.restrictionsHash)if(d("#update-page-restrictions-dialog").is(":visible")&&a.PagePermissions.updateRestrictionsDialog)a.PagePermissions.updateRestrictionsDialog(),f.data("restrictionsHash",b.restrictionsHash);else{var i=""!==b.restrictionsHash,e=b.hasViewRestrictions,f=!!f.data("inherited-restrictions");c.updateEditPageRestrictions(e,f,i,b.restrictionsHash)}}},init:function(){a.bind("editor-heartbeat",c.handleHeartbeat);a.bind("edit-page-restrictions-updated",function(a,b){c.updateEditPageRestrictions(b.hasExplicitRestrictions,
b.hasInheritedRestrictions,b.hasAnyExplicitRestrictions,b.restrictionsHash)})}};return c});require("confluence/module-exporter").safeRequire("confluence-editor/editor/page-editor-permissions",function(a){var d=require("ajs"),c=require("jquery");d.PagePermissions=d.PagePermissions||{};c.extend(d.PagePermissions,{updateEditPageRestrictions:a.updateEditPageRestrictions});d.toInit(a.init)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:draft-changes-js', location = '/includes/js/draft-changes.js' */
define("confluence/draft-changes","jquery ajs window confluence/legacy confluence/api/ajax confluence/api/event confluence/api/logger confluence/analytics-support confluence/dark-features confluence/meta confluence/aui-overrides wrm/context-path".split(" "),function(b,d,q,c,v,r,n,k,s,j,t,l){return{init:function(){var a,p=function(a){var c="Are you sure you want to discard these unpublished changes?",f=b("#draft-"+a),h;if(confirm(c)){c=l()+"/rest/api/content/"+a+"?status=draft";h=b.ajax;h({url:c,type:"DELETE",data:{draftId:a},
contentType:"application/json",dataType:"json",success:function(a){if(a&&a.actionErrors){for(var b=["<ul>"],a=a.actionErrors,c=0;c<a.length;c++){n.log("error: "+a[c]);b.push("<li>"+a[c]+"</li>")}b.push("</ul>");d.messages.error("#errors",{title:"Error",body:"There were errors discarding your draft."+" "+b.join("\n")})}else{b=f.closest("table");a=b.closest(".drafts-container");f.remove();b.find("tbody tr").length===0&&a.append('<span id="no-drafts-message">'+
"No drafts found."+"</span>")}},error:function(a){d.messages.error("#errors",{title:"There were errors discarding your draft.",body:a.errors||"An unknown error has occurred. Please check your logs."})}});return true}return false};b("body").on("click",".view-diff-link",function(u){var o=this.id,f=b(this);if(!a){var h=o==="view-diff-link-notification";a=new d.Dialog(860,530,"view-diff-draft-dialog");var e="Unpublished Changes for \u0027{0}\u0027";a.addHeader(e.replace(/\{0\}/,""));e=b(c.Templates.DraftChanges.dialogContent());
a.addPanel("Diff",e);if(h){a.addButton("Edit",function(){a.hide();c.Editor&&c.Editor.Drafts?c.Editor.Drafts.useDraft():q.location=b(this).attr("data-href")},"resume-diff-link");a.addButton("Discard",function(){if(s.isEnabled("editor.ajax.save")&&j.get("remote-user")!==""){c.Editor.SafeSave.Draft.discardDraft(d.params.pageId,j.get("existing-draft-id")).done(c.Editor.SafeSave.Draft.onSuccessDiscardDraft).fail(c.Editor.SafeSave.Draft.onErrorDiscardDraft);a.hide()}else if(c.Editor&&
c.Editor.Drafts){a.hide();c.Editor.Drafts.discardDraft(j.get("existing-draft-id"));k.publish("rte.notification.draft.discard")}else{var g=b(this).data("draftid");p(g)&&a.hide()}},"discard-diff-link")}a.addCancel("Close",function(){a.hide();return false});e.removeClass("hidden")}a.addHeader("Loading");b("#diff-view").html("<tr><td id='draft-changes-waiting-icon'>Loading...</td></tr>");var m,e=f.attr("class"),i=/draftPageId:([^ ]*)/.exec(e),f=i?i[1]:j.get("page-id"),
h=(i=/username:([^ ]*)/.exec(e))?i[1]:j.get("remote-user");m=(i=/draftId:([^ ]*)/.exec(e))?i[1]:null;b.ajax({url:l()+"/draftchanges/viewdraftchanges.action",type:"GET",dataType:"json",data:{pageId:f,username:h},success:function(g){if(g.actionErrors){for(var e="",g=g.actionErrors,f=0;f<g.length;f++){n.log("error: "+g[f]);e=e+"<div>"+g[f]+"</div>"}b("#diff-view").html(e)}else{b("#diff-view").html(g.htmlDiff);e=d.format("Unpublished Changes for \u0027\u0027{0}\u0027\u0027",d.escapeHtml(g.title));a.addHeader(e);a.popup.element.find(".dialog-title").prepend(c.Templates.DraftChanges.helpLink());
b(".resume-diff-link").attr("data-href",l()+"/pages/resumedraft.action?draftId="+m);b(".discard-diff-link").data("draftid",m);t.setVisible("#merge-warning",g.isMergeRequired)}},error:function(a){a=a.errors||"An unknown error has occurred. Please check your logs";b("#diff-view").html(a)}});a.show();r.trigger("analytics",{name:"confluence.editor.view-diff-dialog.open",data:{elementTriggerId:o}});u.stopPropagation();return false});b(".drafts-by-space li.draft-actions-list-item").on("click",".discard-draft-link",
function(a){a.preventDefault();k.publish("confluence.draft-list.discard");a=b(this).data("draftid");p(a)}).on("click",".resume-draft-link",function(){k.publish("confluence.drafts.referrer",{referrerPage:"drafts",lozengeType:"Draft"})})}}});require("confluence/module-exporter").safeRequire("confluence/draft-changes",function(b){require("ajs").toInit(b.init)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:draft-changes-js', location = '/includes/soy/draft-changes-dialog.soy' */
// This file was automatically generated from draft-changes-dialog.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.DraftChanges.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.DraftChanges == 'undefined') { Confluence.Templates.DraftChanges = {}; }


Confluence.Templates.DraftChanges.dialogContent = function(opt_data, opt_ignored) {
  return '<div id="draft-changes-dialog" class="hidden"><div id="diff-view" class="wiki-content"></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.DraftChanges.dialogContent.soyTemplateName = 'Confluence.Templates.DraftChanges.dialogContent';
}


Confluence.Templates.DraftChanges.helpLink = function(opt_data, opt_ignored) {
  return '' + Confluence.Templates.Dialog.helpLink({href: "https://docs.atlassian.com/confluence/docs-717/Drafts#viewchange"});
};
if (goog.DEBUG) {
  Confluence.Templates.DraftChanges.helpLink.soyTemplateName = 'Confluence.Templates.DraftChanges.helpLink';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:proxy-js', location = '/jira/proxy.js' */
AppLinks=AJS.$.extend(window.AppLinks||{},{makeRequest:function(a){var b=contextPath||AJS.contextPath();if(a.processData)a.appId?a.data=AJS.$.extend(a.data||{},{appId:a.appId}):a.appType&&(a.data=AJS.$.extend(a.data||{},{appType:a.appType})),a.data=AJS.$.extend(a.data||{},{path:a.url});else{var d=a.url;a=AJS.$.extend(a,{beforeSend:function(c){a.appId?c.setRequestHeader("X-AppId",a.appId):a.appType&&c.setRequestHeader("X-AppType",a.appType);c.setRequestHeader("X-AppPath",d)}})}a=AJS.$.extend(a,{url:b+
"/plugins/servlet/applinks/proxy"});return AJS.$.ajax(a)},createProxyGetUrl:function(a){var b="";a.includeContext&&(b=contextPath||AJS.contextPath());b+="/plugins/servlet/applinks/proxy";if(a.appId)b+="?appId\x3d"+encodeURIComponent(a.appId);else if(a.appType)b+="?appType\x3d"+encodeURIComponent(a.appType);else return AJS.log("You need to specify an appType or appId"),"";a.path&&(b+="\x26path\x3d"+encodeURIComponent(a.path));return b}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:jqlHelper', location = '/jira/jqlhelper.js' */
AJS.JQLHelper=function(){var m=/^\s*((key|issuekey)\s*=\s*)?"*([A-Z]+)([0-9]+)?([A-Z]+)?-([0-9]+)"*\s*$/i,h=/\s*([A-Z][A-Z]+)-[0-9]+\s*/,n=/(issue|searchrequest)-xml/i,k=/\/(i#)?browse\/([\x00-\x19\x21-\x22\x24\x27-\x3E\x40-\x7F]+-[0-9]+$)/i,p=/\/jira\.issueviews:issue-xml\/([\x00-\x19\x21-\x22\x24\x27-\x3E\x40-\x7F]+-[0-9]+)\//,l=/(jqlQuery|jql)\s*=([^&]+)/i,e=/(\?|&)(requestId|filter)=([^&]+)/i,f=/(searchrequest-xml\/)([0-9]+)\/SearchRequest/i,q=/=|!=|~|>|<|!~| is | in | was | changed /i,g=function(a){var b=
"",c=k.exec(a);c?b="key\x3d"+c[2]:(c=l.exec(a))?b=c[2]:(a=h.exec(a))&&(b="key\x3d"+a[0]);return b=b.replace(/\+/g," ")},r=function(a,b){var c;a=decodeURIComponent(a);AJS.JQLHelper.getJqlQueryFromJiraFilter(a,b,function(d){d.jql&&(c=d.jql)});return c};return{isSingleKeyJQLExp:function(a){return m.exec(a)},isMultipleSingleKeyJQLExp:function(a){a=a.split(",");for(var b in a){var c=AJS.$.trim(a[b]);if(!AJS.JQLHelper.isSingleKeyJQLExp(c))return!1}return!0},isIssueUrlOrXmlUrl:function(a){return k.test(a)||
n.test(a)||l.test(a)||p.test(a)?!0:!1},isFilterUrl:function(a){return e.test(a)||f.test(a)},getFilterFromFilterUrl:function(a){if(e.test(a))return a=e.exec(a),a[2]+"\x3d"+a[3];if(f.test(a))return"filter\x3d"+f.exec(a)[2]},getJqlQueryFromJiraFilter:function(a,b,c,d){a=(e.exec(a)||f.exec(a))[2];b="/rest/jiraanywhere/1.0/jira/appLink/"+b+"/filter/"+a;AJS.$.ajax({async:!1,dataType:"json",url:Confluence.getContextPath()+b,success:c,error:d})},findServerIndexFromUrl:function(a,b){if("undefined"!==typeof b||
0<b.length)for(var c=a.toLowerCase(),d=0;d<b.length;d++)if(0==c.indexOf(b[d].url.toLowerCase())&&"/"==a.charAt(b[d].url.length))return d;return-1},getJqlQueryFromUrl:g,getJqlAndServerIndexFromUrl:function(a,b){var c={};c.serverIndex=this.findServerIndexFromUrl(a,b);c.jqlQuery=g(a);return c},checkQueryType:function(a){if(AJS.Editor.JiraAnalytics&&a&&0!=AJS.$.trim(a).length)return 0!=a.indexOf("http")?AJS.Editor.JiraAnalytics.linkTypes.jqlDirect:-1!=a.indexOf("jira.issueviews:searchrequest-xml")||-1!=
a.indexOf("jira.issueviews:issue-xml")?AJS.Editor.JiraAnalytics.linkTypes.xml:-1!=a.indexOf("jira.issueviews:searchrequest-rss")?AJS.Editor.JiraAnalytics.linkTypes.rss:-1!=a.indexOf("filter\x3d")||-1!=a.indexOf("filter\\\x3d")?AJS.Editor.JiraAnalytics.linkTypes.filter:AJS.Editor.JiraAnalytics.linkTypes.jql},convertToJQL:function(a,b){if(""!==AJS.$.trim(a))if(0===a.indexOf("http")&&this.isFilterUrl(a))var c=r(a,b);else 0===a.indexOf("http")&&this.isIssueUrlOrXmlUrl(a)?(a=g(decodeURIComponent(a)),0<
a.length&&(c=a)):c=0!==a.indexOf("http")&&a.match(q)?a:a.match(h)?"key\x3d"+a:'summary ~ "'+a+'" OR description ~ "'+a+'"';return c}}}();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.components:editor-notifications', location = '/includes/js/editor-notifications.js' */
define("confluence/editor-notifications",[],function(){var a;return{notify:function(b,c,d){var e=require("aui/flag");void 0!==a&&"true"!==a.getAttribute("aria-hidden")&&a.close();void 0===d&&(d="error"===b?"manual":"auto");a=e({type:b,body:c,close:d})}}});require("confluence/module-exporter").safeRequire("confluence/editor-notifications",function(a){var b=require("confluence/api/event"),c=require("confluence/legacy");b.bind("init.rte",function(){c.EditorNotification=a})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:legacy-editor-global-AVOID-IF-POSSIBLE', location = '/includes/js/amd/shim/confluence-editor-amd.js' */
define("confluence-editor/legacy",["confluence/legacy"],function(a){"undefined"===typeof a&&(a={});"undefined"===typeof a.Editor&&(a.Editor={});return a.Editor});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:attachments-insert-utils-resources', location = 'utils/attachments-insert-utils.js' */
define("confluence-editor/utils/attachments-insert-utils",["underscore","confluence/meta","jquery"],function(c,b,d){return{insertFilePlaceholder:function(a,e,f){var g=require("tinymce");a.height="comment"===b.get("content-type")?"150":"250";a.ownerId&&a.ownerId===b.get("content-id")&&(delete a.page,delete a.space,delete a.date);a=c.omit(c.pick(a,"name","page","space","date","height"),function(a){return!a});a={contentId:b.get("content-id")||"0",macro:{name:"view-file",params:a}};g.confluence.MacroUtils.insertMacro(a,
e).done(function(a){f&&d(a).click()})}}});require("confluence/module-exporter").safeRequire("confluence-editor/utils/attachments-insert-utils");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-internationalisation', location = 'i18n/translations.i18n.js' */
define("confluence-editor/i18n/translations.i18n",["ajs"],function(a){return{popup_blocked:"The browser has blocked a popup opened by the Editor.",ctrl_key:"Ctrl",shift_key:"Shift",Close:"Close",searchreplace:{search_desc:"Find",replace_desc:"Find/Replace"},searchreplace_dlg:{allreplacedplural:"{0} replacements were made",
allreplacedsingular:"1 replacement was made",notfound:"No replacements were made",findlabel:"Find",replacelabel:"Replace",findnext:"Next",findprevious:"Previous",replace:"Replace",replaceall:"Replace all",
close:"Close"},advhr:{advhr_desc:"tinymce.advhr.advhr_desc"},emotions:{emotions_desc:"Emoticons"},emotions_dlg:{title:"Insert emoticon",desc:"Emoticons",smile:"Smile :)",sad:"Sad :(",tongue:"Tongue :p",biggrin:"Big grin :D",
wink:"Wink ;)",thumbs_up:"Thumbs up (y)",thumbs_down:"Thumbs down (n)",information:"Info (i)",check:"Tick (/)",error:"Error (x)",warning:"Warning (!)",add:"Plus (+)",forbidden:"Minus (-)",help_16:"Question mark (?)",
lightbulb_on:"Lightbulb on (on)",lightbulb:"Lightbulb off (off)",star_yellow:"Yellow star (*y)",star_red:"Red star (*r)",star_green:"Green star (*g)",star_blue:"Blue star (*b)",heart:"Heart \u003c3",broken_heart:"Broken heart \u003c/3"},confluence:{conf_macro_browser:"Macro",
conf_macro_browser_desc:"Insert macro",conf_image:"Image",confimage_desc:"Insert image",conf_file:"Files and images",confifile_desc:"Insert files and images",conf_link:"Link",conflink_desc:"Insert link",conf_table:"Table",
conf_wikimarkup:"Markup",conf_wikimarkup_desc:"Insert markup",conf_wikimarkup_errors:"Wiki markup conversion errors",conf_wikimarkup_timeout:"The server took too long to convert the wiki markup. This may only be a temporary problem so you could try again.",conf_wikimarkup_hint:"Hint: you can also enter wiki markup directly in the editor, where it will be formatted as you type.",conf_wikimarkup_markdown_label:"Markdown",
conf_wikimarkup_confluence_label:"Confluence wiki",conf_shortcuts_help_desc:"Keyboard shortcuts help",conf_insert_button_title:"Insert"},table:{desc:"Insert table",row_before_desc:"Insert row above",row_after_desc:"Insert row below",delete_row_desc:"Delete row",
numbering_column_desc:"Insert numbering column",responsive:"Responsive",responsive_tooltip:"Table columns get wider as you add content. Drag column borders to set width relative to each other and the page.",fixed_width:"Fixed width",fixed_width_tooltip:"Drag column borders to set width. The table always appears at the width you set.",col_before_desc:"Insert column left",col_after_desc:"Insert column right",col_copy_desc:"Copy column",
col_paste_desc:"Paste column left",col_cut_desc:"Cut column",delete_col_desc:"Delete column",split_cells_desc:"Split merged cells",merge_cells_desc:"Merge cells",row_desc:"tinymce.table.row_desc",cell_desc:"tinymce.table.cell_desc",props_desc:"tinymce.table.props_desc",paste_row_before_desc:"Paste row above",
paste_row_after_desc:"Paste row after",cut_row_desc:"Cut row",copy_row_desc:"Copy row",del:"Delete table",row:"Row",col:"Column",cell:"Cell",row_highlight:"Heading row",col_highlight:"Heading column",selection_highlight:"Change cell color",
invalid_table_field:"Rows and columns must both be numbers greater than zero.",table_more_heading:"Table settings",cell_background_color:"Background color : {0}",cut_row_desc_shortcut:"Ctrl+Shift+X",copy_row_desc_shortcut:"Ctrl+Shift+C",paste_row_before_desc_shortcut:"Ctrl+Shift+V",row_before_desc_shortcut:"Alt+\u2191",
row_after_desc_shortcut:"Alt+\u2193"},advanced:{style_select:"tinymce.advanced.style_select",font_size:"tinymce.advanced.font_size",fontdefault:"tinymce.advanced.fontdefault",block:"Format",paragraph:"Paragraph",pre:"Preformatted",h1:"Heading 1",h2:"Heading 2",h3:"Heading 3",
h4:"Heading 4",h5:"Heading 5",h6:"Heading 6",blockquote:"Quote",code:"tinymce.advanced.code",samp:"tinymce.advanced.samp",dt:"tinymce.advanced.dt",dd:"tinymce.advanced.dd",bold_desc:"Bold",italic_desc:"Italic",underline_desc:"Underline",
striketrough_desc:"Strikethrough",justifyleft_desc:"Align left",justifycenter_desc:"Align center",justifyright_desc:"Align right",justifyfull_desc:"Align full",bullist_desc:"Bullet list",numlist_desc:"Numbered list",tasklist_desc:"Task list",
outdent_desc:"Outdent",indent_desc:"Indent",undo_desc:"Undo",redo_desc:"Redo",link_desc:"tinymce.advanced.link_desc",unlink_desc:"Unlink",image_desc:"tinymce.advanced.image_desc",cleanup_desc:"tinymce.advanced.cleanup_desc",code_desc:"tinymce.advanced.code_desc",
sub_desc:"Subscript",sup_desc:"Superscript",hr_desc:"Horizontal rule",removeformat_desc:"tinymce.advanced.removeformat_desc",custom1_desc:"tinymce.advanced.custom1_desc",forecolor_desc:"Select text color",backcolor_desc:"tinymce.advanced.backcolor_desc",charmap_desc:"Symbol",visualaid_desc:"tinymce.advanced.visualaid_desc",
anchor_desc:"tinymce.advanced.anchor_desc",cut_desc:"tinymce.advanced.cut_desc",copy_desc:"tinymce.advanced.copy_desc",paste_desc:"tinymce.advanced.paste_desc",image_props_desc:"tinymce.advanced.image_props_desc",newdocument_desc:"tinymce.advanced.newdocument_desc",help_desc:"Help",blockquote_desc:"tinymce.advanced.blockquote_desc",path:"tinymce.advanced.path",
newdocument:"tinymce.advanced.newdocument",toolbar_focus:"tinymce.advanced.toolbar_focus",more_colors:"tinymce.advanced.more_colors",paragraph_shortcut:"Ctrl+0",pre_shortcut:"Ctrl+7",h1_shortcut:"Ctrl+1",h2_shortcut:"Ctrl+2",h3_shortcut:"Ctrl+3",h4_shortcut:"Ctrl+4",
h5_shortcut:"Ctrl+5",h6_shortcut:"Ctrl+6",blockquote_shortcut:"Ctrl+8",bullist_shortcut:"Ctrl+Shift+B",numlist_shortcut:"Ctrl+Shift+N",tasklist_shortcut:"[ then ]",undo_shortcut:"Ctrl+Z",redo_shortcut:"Ctrl+Y"},
colorpicker:{more_colors:"More colors",title:"Select a color",picker_tab:"Picker",picker_title:"Color picker",palette_title:"tinymce.colorpicker.palette_title",named_tab:"tinymce.colorpicker.named_tab",named_title:"tinymce.colorpicker.named_title",color:"Color",name:"tinymce.colorpicker.name",
apply:"tinymce.colorpicker.apply"},hints:{drafts:"Hint: Confluence saves drafts automatically. If you ever lose a window, recover your work from the \u0022Username -\u003e Drafts\u0022 menu.",dnd:"Hint: you can drag and drop images and Office files from your computer right into this editor.",insert_link_recently_viewed:"Hint: type \u0022\u003cstrong\u003e[\u003c/strong\u003e\u0022 to see a list of suggested pages and insert a link.",insert_link_search:"Hint: type \u0022\u003cstrong\u003e[\u003c/strong\u003e\u0022 and part of a page title to find and link to that page.",insert_link_end:"Hint: press \u003cstrong\u003eCtrl+Shift+K\u003c/strong\u003e after a word to find and link to relevant pages. Press it again for more suggestions.",insert_link_newpage:"Hint: type \u0022\u003cstrong\u003e[\u003c/strong\u003e\u0022 and the title of a new page you wish to create, to see an insert link suggestion.",insert_link_user_mention:"Hint: you can mention somebody in Confluence by typing \u0022\u003cstrong\u003e@\u003c/strong\u003e\u0022 and then their name.",
insert_image_on_page:"Hint: type \u0022\u003cstrong\u003e!\u003c/strong\u003e\u0022 to see images attached to the page and insert one of them.",insert_image_search:"Hint: type \u0022\u003cstrong\u003e!\u003c/strong\u003e\u0022 and part of an image name to find and insert the image.",insert_image_end:"Hint: press \u003cstrong\u003eCtrl+Shift+M\u003c/strong\u003e after a word to find and insert relevant images.",insert_wikimarkup:"Hint: the Editor will automatically convert wiki markup as you type it.",insert_wikimarkup_dialog:"Hint: press \u003cstrong\u003eCtrl+Shift+D\u003c/strong\u003e to open the Wiki Markup dialog.",insert_link:"Hint: press \u003cstrong\u003eCtrl+K\u003c/strong\u003e to open the link browser.",insert_image:"Hint: press \u003cstrong\u003eCtrl+M\u003c/strong\u003e to open the image browser.",insert_macro:"Hint: press \u003cstrong\u003eCtrl+Shift+A\u003c/strong\u003e to open the macro browser.",
insert_macro_toc:"Hint: Let Confluence generate you a table of contents for this page. Use \u0022Insert -\u003e Table of contents\u0022",insert_bullet_list:"Hint: press \u003cstrong\u003eCtrl+Shift+B\u003c/strong\u003e to start a bullet list.",insert_numbered_list:"Hint: press \u003cstrong\u003eCtrl+Shift+N\u003c/strong\u003e to start a numbered list.",insert_heading:"Hint: press \u003cstrong\u003eCtrl+1\u003c/strong\u003e to create a heading level 1, \u003cstrong\u003eCtrl+2\u003c/strong\u003e for heading level 2 and so on.",insert_table:"Hint: press \u003cstrong\u003eCtrl+Shift+I\u003c/strong\u003e to insert a table.",table_rows_copy:"Hint: press \u003cstrong\u003eCtrl+Shift+C\u003c/strong\u003e to copy a row and \u003cstrong\u003eCtrl+Shift+V\u003c/strong\u003e to paste a row in a table.",table_rows_cut:"Hint: press \u003cstrong\u003eCtrl+Shift+X\u003c/strong\u003e to cut a row and \u003cstrong\u003eCtrl+Shift+V\u003c/strong\u003e to paste a row in a table.",insert_newline:"Hint: Type \u003cstrong\u003eShift+Enter\u003c/strong\u003e to insert a new paragraph without spacing",
autoformat_heading1:"Hint: Type \u0022\u003cstrong\u003eh1. Title\u003c/strong\u003e\u0022 to quickly insert a Heading 1.",autoformat_heading3:"Hint: Type \u0022\u003cstrong\u003eh3. Title\u003c/strong\u003e\u0022 to quickly insert a Heading 3.",autoformat_code:"Hint: Type \u0022\u003cstrong\u003e{{code}}\u003c/strong\u003e\u0022 to quickly insert monospaced text."},auiwindowmanager:{cancel:"Cancel",ok:"OK"},propertypanel:{links_goto:"Go to link",links_edit:"Edit",links_unlink:"Unlink",
links_goto_disabled_tooltip:"This link goes to content on the page you are editing",links_edit_tooltip:"Edit link in a dialogue",links_unlink_tooltip:"Replace link with the text it contains",images_small:"Small",images_medium:"Medium",images_large:"Large",images_original:"Original",
images_border:"Border",images_link_create:"Link",images_link_edit:"Edit link",images_link_remove:"Unlink",images_link_create_tooltip:"Link this image to other content",images_link_edit_tooltip:"Edit the link for this image",images_link_remove_tooltip:"Remove the link for this image",
images_sizing_tooltip:"Resize image to a specific width",images_small_tooltip:"Resize image to small and link to the original",images_medium_tooltip:"Resize image to medium and link to the original",images_large_tooltip:"Resize image to large and link to the original",images_original_tooltip:"Reset image size to original",images_thumbnail_tooltip:"tinymce.propertypanel.images.thumbnail.tooltip",
images_border_tooltip:"Display a border around image"},toolbar:{insert_files_shortcut_tooltip:"Ctrl+M"},a11ychecker:{btn_tooltip:"Check accessibility"},base64image:{warning:"We couldn\u0027t paste your image. Try downloading the file first."}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/i18n/translations.i18n","TinyMCELang");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-frontend:split_vendors~react~react-dom~table-styles-editor', location = 'vendors~react~react-dom~table-styles-editor.js' */
(window.atlassianWebpackJsonpe19a4f58490c3d96a3072d1e47cd0e73=window.atlassianWebpackJsonpe19a4f58490c3d96a3072d1e47cd0e73||[]).push([[5],{148:function(e,t,r){"use strict";
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var n=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,u=Object.prototype.propertyIsEnumerable;function c(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},r=0;r<10;r++)t["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach((function(e){n[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var r,i,f=c(e),l=1;l<arguments.length;l++){for(var a in r=Object(arguments[l]))o.call(r,a)&&(f[a]=r[a]);if(n){i=n(r);for(var s=0;s<i.length;s++)u.call(r,i[s])&&(f[i[s]]=r[i[s]])}}return f}},386:function(e,t,r){"use strict";
/** @license React v16.8.1
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n=r(148),o="function"==typeof Symbol&&Symbol.for,u=o?Symbol.for("react.element"):60103,c=o?Symbol.for("react.portal"):60106,i=o?Symbol.for("react.fragment"):60107,f=o?Symbol.for("react.strict_mode"):60108,l=o?Symbol.for("react.profiler"):60114,a=o?Symbol.for("react.provider"):60109,s=o?Symbol.for("react.context"):60110,p=o?Symbol.for("react.concurrent_mode"):60111,y=o?Symbol.for("react.forward_ref"):60112,d=o?Symbol.for("react.suspense"):60113,v=o?Symbol.for("react.memo"):60115,m=o?Symbol.for("react.lazy"):60116,b="function"==typeof Symbol&&Symbol.iterator;function h(e,t,r,n,o,u,c,i){if(!e){if(e=void 0,void 0===t)e=Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var f=[r,n,o,u,c,i],l=0;(e=Error(t.replace(/%s/g,(function(){return f[l++]})))).name="Invariant Violation"}throw e.framesToPop=1,e}}function g(e){for(var t=arguments.length-1,r="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=0;n<t;n++)r+="&args[]="+encodeURIComponent(arguments[n+1]);h(!1,"Minified React error #"+e+"; visit %s for the full message or use the non-minified dev environment for full errors and additional helpful warnings. ",r)}var S={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_={};function w(e,t,r){this.props=e,this.context=t,this.refs=_,this.updater=r||S}function j(){}function k(e,t,r){this.props=e,this.context=t,this.refs=_,this.updater=r||S}w.prototype.isReactComponent={},w.prototype.setState=function(e,t){"object"!=typeof e&&"function"!=typeof e&&null!=e&&g("85"),this.updater.enqueueSetState(this,e,t,"setState")},w.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},j.prototype=w.prototype;var O=k.prototype=new j;O.constructor=k,n(O,w.prototype),O.isPureReactComponent=!0;var $={current:null},x={current:null},C=Object.prototype.hasOwnProperty,P={key:!0,ref:!0,__self:!0,__source:!0};function E(e,t,r){var n=void 0,o={},c=null,i=null;if(null!=t)for(n in void 0!==t.ref&&(i=t.ref),void 0!==t.key&&(c=""+t.key),t)C.call(t,n)&&!P.hasOwnProperty(n)&&(o[n]=t[n]);var f=arguments.length-2;if(1===f)o.children=r;else if(1<f){for(var l=Array(f),a=0;a<f;a++)l[a]=arguments[a+2];o.children=l}if(e&&e.defaultProps)for(n in f=e.defaultProps)void 0===o[n]&&(o[n]=f[n]);return{$$typeof:u,type:e,key:c,ref:i,props:o,_owner:x.current}}function R(e){return"object"==typeof e&&null!==e&&e.$$typeof===u}var A=/\/+/g,I=[];function q(e,t,r,n){if(I.length){var o=I.pop();return o.result=e,o.keyPrefix=t,o.func=r,o.context=n,o.count=0,o}return{result:e,keyPrefix:t,func:r,context:n,count:0}}function M(e){e.result=null,e.keyPrefix=null,e.func=null,e.context=null,e.count=0,10>I.length&&I.push(e)}function U(e,t,r){return null==e?0:function e(t,r,n,o){var i=typeof t;"undefined"!==i&&"boolean"!==i||(t=null);var f=!1;if(null===t)f=!0;else switch(i){case"string":case"number":f=!0;break;case"object":switch(t.$$typeof){case u:case c:f=!0}}if(f)return n(o,t,""===r?"."+F(t,0):r),1;if(f=0,r=""===r?".":r+":",Array.isArray(t))for(var l=0;l<t.length;l++){var a=r+F(i=t[l],l);f+=e(i,a,n,o)}else if(null===t||"object"!=typeof t?a=null:a="function"==typeof(a=b&&t[b]||t["@@iterator"])?a:null,"function"==typeof a)for(t=a.call(t),l=0;!(i=t.next()).done;)f+=e(i=i.value,a=r+F(i,l++),n,o);else"object"===i&&g("31","[object Object]"===(n=""+t)?"object with keys {"+Object.keys(t).join(", ")+"}":n,"");return f}(e,"",t,r)}function F(e,t){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+(""+e).replace(/[=:]/g,(function(e){return t[e]}))}(e.key):t.toString(36)}function L(e,t){e.func.call(e.context,t,e.count++)}function N(e,t,r){var n=e.result,o=e.keyPrefix;e=e.func.call(e.context,t,e.count++),Array.isArray(e)?T(e,n,r,(function(e){return e})):null!=e&&(R(e)&&(e=function(e,t){return{$$typeof:u,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(e,o+(!e.key||t&&t.key===e.key?"":(""+e.key).replace(A,"$&/")+"/")+r)),n.push(e))}function T(e,t,r,n,o){var u="";null!=r&&(u=(""+r).replace(A,"$&/")+"/"),U(e,N,t=q(t,u,n,o)),M(t)}function V(){var e=$.current;return null===e&&g("307"),e}var D={Children:{map:function(e,t,r){if(null==e)return e;var n=[];return T(e,n,null,t,r),n},forEach:function(e,t,r){if(null==e)return e;U(e,L,t=q(null,null,t,r)),M(t)},count:function(e){return U(e,(function(){return null}),null)},toArray:function(e){var t=[];return T(e,t,null,(function(e){return e})),t},only:function(e){return R(e)||g("143"),e}},createRef:function(){return{current:null}},Component:w,PureComponent:k,createContext:function(e,t){return void 0===t&&(t=null),(e={$$typeof:s,_calculateChangedBits:t,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:a,_context:e},e.Consumer=e},forwardRef:function(e){return{$$typeof:y,render:e}},lazy:function(e){return{$$typeof:m,_ctor:e,_status:-1,_result:null}},memo:function(e,t){return{$$typeof:v,type:e,compare:void 0===t?null:t}},useCallback:function(e,t){return V().useCallback(e,t)},useContext:function(e,t){return V().useContext(e,t)},useEffect:function(e,t){return V().useEffect(e,t)},useImperativeHandle:function(e,t,r){return V().useImperativeHandle(e,t,r)},useDebugValue:function(){},useLayoutEffect:function(e,t){return V().useLayoutEffect(e,t)},useMemo:function(e,t){return V().useMemo(e,t)},useReducer:function(e,t,r){return V().useReducer(e,t,r)},useRef:function(e){return V().useRef(e)},useState:function(e){return V().useState(e)},Fragment:i,StrictMode:f,Suspense:d,createElement:E,cloneElement:function(e,t,r){null==e&&g("267",e);var o=void 0,c=n({},e.props),i=e.key,f=e.ref,l=e._owner;if(null!=t){void 0!==t.ref&&(f=t.ref,l=x.current),void 0!==t.key&&(i=""+t.key);var a=void 0;for(o in e.type&&e.type.defaultProps&&(a=e.type.defaultProps),t)C.call(t,o)&&!P.hasOwnProperty(o)&&(c[o]=void 0===t[o]&&void 0!==a?a[o]:t[o])}if(1===(o=arguments.length-2))c.children=r;else if(1<o){a=Array(o);for(var s=0;s<o;s++)a[s]=arguments[s+2];c.children=a}return{$$typeof:u,type:e.type,key:i,ref:f,props:c,_owner:l}},createFactory:function(e){var t=E.bind(null,e);return t.type=e,t},isValidElement:R,version:"16.8.1",unstable_ConcurrentMode:p,unstable_Profiler:l,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:{ReactCurrentDispatcher:$,ReactCurrentOwner:x,assign:n}},W={default:D},z=W&&D||W;e.exports=z.default||z},66:function(e,t,r){"use strict";e.exports=r(386)}}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-frontend:split_vendors~table-styles-editor', location = 'vendors~table-styles-editor.js' */
(window.atlassianWebpackJsonpe19a4f58490c3d96a3072d1e47cd0e73=window.atlassianWebpackJsonpe19a4f58490c3d96a3072d1e47cd0e73||[]).push([[34],{2:function(t,e,n){!function(t,e,n){"use strict";e=e&&e.hasOwnProperty("default")?e.default:e;var r="default"in n?n.default:n;function a(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function o(t){for(var o=arguments.length,i=new Array(o>1?o-1:0),c=1;c<o;c++)i[c-1]=arguments[c];var l=0,u={};i=i.map((function(t){if(n.isValidElement(t)){var e="!PLACEHOLDER_".concat(++l,"!");return u[e]=t,e}return t}));var f=e.apply(void 0,[t].concat(a(i))).split(/(!PLACEHOLDER_\d+!)/g);if(1===f.length)return f.join("");var d=f.map((function(t,e){return r.createElement(n.Fragment,{key:e},e%2?u[t]:t)}));return r.createElement(n.Fragment,null,d)}var i={getText:function(){return console.warn('Call to "getText" function was not replaced with either raw translation or call to "format" function. Have you included the "jsI18n" transformation in Web Resource Manager?'),o.apply(void 0,arguments)}};t.I18n=i,t.format=o,Object.defineProperty(t,"__esModule",{value:!0})}(e,n(393),n(66))}}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-frontend:split_table-styles-editor', location = 'table-styles-editor.js' */
(window.atlassianWebpackJsonpe19a4f58490c3d96a3072d1e47cd0e73=window.atlassianWebpackJsonpe19a4f58490c3d96a3072d1e47cd0e73||[]).push([[23],{393:function(e,t){e.exports=WRM.format},394:function(e,t,l){},395:function(e,t,l){},403:function(e,t,l){"use strict";l.r(t);var c=l(12),f=l(2);const a={"000000":"Black 100%","172b4d":"Dark grey 100%","42526e":"Medium grey 100%","7a869a":"Medium grey 85%",c1c7d0:"Medium grey 45%",f4f5f7:"Light grey 100%",clear:"Clear fill",bf2600:"Dark red 100%",de350b:"Dark red 85%",ff5630:"Medium red 100%",ff7452:"Medium red 85%",ff8f73:"Medium red 65%",ffbdad:"Light red 100%",ffebe6:"Light red 35%",ff8b00:"Dark orange 100%",ff991f:"Dark orange 85%",ffab00:"Medium orange 100%",ffc400:"Medium yellow 100%",ffe380:"Medium yellow 45%",fff0b3:"Light yellow 100%",fffae6:"Light yellow 35%","006644":"Dark green 100%","00875a":"Dark green 85%","36b37e":"Medium green 100%","57d9a3":"Medium green 65%","79f2c0":"Medium green 45%",abf5d1:"Light green 100%",e3fcef:"Light green 35%","008da6":"Dark teal 100%","00a3bf":"Dark teal 85%","00b8d9":"Medium teal 100%","00c7e6":"Medium teal 85%","79e2f2":"Medium teal 45%",b3f5ff:"Light teal 100%",e6fcff:"Light teal 35%","0747a6":"Dark blue 100%","0052cc":"Dark blue 85%","0065ff":"Medium blue 100%","2684ff":"Medium blue 85%","4c9aff":"Medium blue 65%",b3d4ff:"Light blue 100%",deebff:"Light blue 35%",403294:"Dark purple 100%","5243aa":"Dark purple 85%","6554c0":"Medium purple 100%","8777d9":"Medium purple 85%","998dd9":"Medium purple 65%",c0b6f2:"Light purple 100%",eae6ff:"Light purple 35%"},n=["bf2600","ff8b00","006644","008da6","0747a6","403294","000000","de350b","ff991f","00875a","00a3bf","0052cc","5243aa","172b4d","ff5630","ffab00","36b37e","00b8d9","0065ff","6554c0","42526e","ff7452","ffc400","57d9a3","00c7e6","2684ff","8777d9","7a869a","ff8f73","ffe380","79f2c0","79e2f2","4c9aff","998dd9","c1c7d0","ffbdad","fff0b3","abf5d1","b3f5ff","b3d4ff","c0b6f2","f4f5f7","ffebe6","fffae6","e3fcef","e6fcff","deebff","eae6ff","clear"];l(394),l(395);Object(c.a)("confluence/table-color-names",()=>({colorNames:a,colorValues:n}))}},[[403,0,3,5,34,2]]]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-frontend:split_locale', location = 'locale.js' */
(window.atlassianWebpackJsonpe19a4f58490c3d96a3072d1e47cd0e73=window.atlassianWebpackJsonpe19a4f58490c3d96a3072d1e47cd0e73||[]).push([[18],{150:function(e,r){e.exports=require("confluence/meta")},402:function(e,r,t){"use strict";t.r(r);var n={};t.r(n),t.d(n,"getUserLocale",(function(){return i}));var c=t(12),o=t(150),a=t.n(o);const i=()=>a.a.get("user-locale").replace("_","-").match(/^([a-zA-Z]{2,5}(-[a-zA-Z]+)?)/)[0];function u(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function s(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}Object(c.a)("confluence/locale",()=>function(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?u(Object(t),!0).forEach((function(r){s(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):u(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}({},n))}},[[402,0,3,2]]]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-editor-v4:editor-resources-v4-src', location = 'build/editor.js' */
!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="","undefined"!=typeof AJS&&(n.p=AJS.contextPath()+"/download/resources/com.atlassian.confluence.plugins.confluence-editor-v4:assets-5dc3b292-a7c8-4cba-8b43-5de026983fb8/"),n(n.s=0)}({"./node_modules/@atlassian/aui-template/src/template.js":function(e,t,n){var r;"undefined"!=typeof self&&self,void 0===(r=function(){return function(){var e=/\{([^\}]+)\}/g,t=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g,n=function(e,n,r,o){var i=r;return n.replace(t,(function(e,t,n,r,a){t=t||r,i&&(t+":html"in i?(i=i[t+":html"],o=!0):t in i&&(i=i[t]),a&&"function"==typeof i&&(i=i()))})),null!=i&&i!==r||(i=e),i=String(i),o||(i=a.escape(i)),i},r=function(t){return this.template=this.template.replace(e,(function(e,r){return n(e,r,t,!0)})),this},o=function(t){return this.template=this.template.replace(e,(function(e,r){return n(e,r,t)})),this},i=function(){return this.template},a=function(e){function t(){return t.template}return t.template=String(e),t.toString=t.valueOf=i,t.fill=o,t.fillHtml=r,t},c={},u=[];a.load=function(e){if(e=String(e),!c.hasOwnProperty(e)){u.length>=1e3&&delete c[u.shift()],u.push(e);var t=function(e){return document.querySelector('script[title="'+e+'"]')}(e);t&&(c[e]=t.text)}return this(c[e])};var l={"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&#39;","`":"&#96;"},s=new RegExp("["+Object.keys(l).join("")+"]","g");return a.escape=function(e){return String(e||"").replace(s,(function(e){return l[e]}))},a}()}.call(t,n,t,e))||(e.exports=r)},"./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/confcharmap/charmap.css":function(e,t,n){(e.exports=n("./node_modules/css-loader/dist/runtime/api.js")(!1)).push([e.i,"#charmap-picker{border:0;font-size:16px;font-family:Arial,Helvetica,FreeSans,sans-serif;padding:2px;text-align:center}#charmap-view{padding-right:1em;text-align:left;vertical-align:top}#charmap-info{text-align:center;vertical-align:top;width:100%}#charmap-info>table{border:0;height:100px;padding:0;width:100%}#code-value{font-size:3em}#code-name{font-size:13px}#code-name,#code-value{color:#666;text-align:center}.charmap a:active,.charmap a:hover,.charmap a:link,.charmap a:visited{color:#326ca6;text-decoration:none}",""])},"./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/draggable/draggable.css":function(e,t,n){(e.exports=n("./node_modules/css-loader/dist/runtime/api.js")(!1)).push([e.i,"table.draggable{margin-left:-10px;margin-top:-10px}table.draggable:hover>tbody>tr>td.draggable-column,table.draggable:hover>tbody>tr>td.draggable-row,table.draggable:hover>tbody>tr>td.draggable-table{background-color:#777;border-top:1px solid #777;border-left:1px solid #777}table.draggable:hover>tbody>tr>td.draggable-column,table.draggable:hover>tbody>tr>td.draggable-table{border-right:1px solid #aaa}table.draggable:hover>tbody>tr>td.draggable-row,table.draggable:hover>tbody>tr>td.draggable-table{border-bottom:1px solid #aaa}td.draggable-column,td.draggable-row,td.draggable-table{background-color:transparent;border-top:1px solid transparent;border-left:1px solid transparent;cursor:move}td.draggable-column,td.draggable-table{border-right:1px solid transparent}td.draggable-row,td.draggable-table{border-bottom:1px solid transparent}td.draggable-column{height:10px}td.draggable-row{width:10px}.wiki-content img.confluence-embedded-image,.wiki-content img.editor-inline-macro,.wiki-content table.wysiwyg-macro{cursor:move}.wiki-content table.wysiwyg-macro>tbody>tr>td.wysiwyg-macro-body{cursor:text}#move-indicator{font-weight:400!important}",""])},"./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/insert-files/insert-files.css":function(e,t,n){(e.exports=n("./node_modules/css-loader/dist/runtime/api.js")(!1)).push([e.i,".quick-comment-form #rte-toolbar .insert-files.toolbar-item{padding:0 6px}.quick-comment-form #rte-toolbar .insert-files .toolbar-trigger{margin:0 -6px}#rte-toolbar .insert-files.toolbar-item{padding:0}#rte-toolbar .insert-files .trigger-text{display:none}#rte-toolbar .insert-files .aui-button{padding:0 6px}",""])},"./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/insertwiki/insert-wiki-markup.css":function(e,t,n){(e.exports=n("./node_modules/css-loader/dist/runtime/api.js")(!1)).push([e.i,'.aui-dialog .wiki-parser-selector{font-size:14px;margin-right:5px}.insert-wiki-markup-panel div,.insert-wiki-markup-panel div form{height:100%;text-align:center}.insert-wiki-markup-panel .spinner{position:absolute;top:50%;left:50%;margin-top:-73px;margin-left:-60px}#insert-wiki-info-title{text-align:left;margin-left:10px}#insert-wiki-markup-form{height:95%}#insert-wiki-markup-form .wiki-title span{box-sizing:border-box;display:-moz-inline-stack;display:inline-block;margin-bottom:10px;max-width:48%;text-align:left;vertical-align:middle;width:48%}#insert-wiki-markup-form .wiki-title span:first-child{margin-right:20px}#insert-wiki-textarea,#insert-wiki-textarea-preview{box-sizing:border-box;display:-moz-inline-stack;display:inline-block;font-size:14px;height:84%;max-width:48%;vertical-align:middle;width:48%;resize:none}#insert-wiki-textarea.originalDefault{height:100%;min-width:100%;width:100%}#insert-wiki-textarea{font-family:Monaco,Consolas,Courier New,"monospace";margin-right:20px}#insert-wiki-textarea-preview{border:1px solid #ccc;border-radius:3px;position:relative}#insert-wiki-textarea-preview iframe{border:0;height:100%;left:0;min-height:100%;overflow:hidden;position:absolute;top:0;width:100%}',""])},"./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/iosediting/iosediting.css":function(e,t,n){(e.exports=n("./node_modules/css-loader/dist/runtime/api.js")(!1)).push([e.i,"body.ios{min-height:150px}",""])},"./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/propertypanel/css/property-panel.css":function(e,t,n){(e.exports=n("./node_modules/css-loader/dist/runtime/api.js")(!1)).push([e.i,"#property-panel a.macro-placeholder-property-panel-display-newline-button span.icon{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAvklEQVR42rVTPQuFIBT1p1t7e2EFDrXnVmNb4Ca4BS5BW9AfOA+F+wjfAwfpwuHcDzn3olcGIAv5An3fo+u6L55x27bE5P+cZdkWqVJH6pDMsWxTSsFjmqbAMZIC4zjivm9c14XjOLDvO4wx2LYNwzCkBZqmwXmecM7BWgutNdZ1xTzP8LWkQFVVWJYFUspwQUII1HUd2NeSApxzeJRlCfKLovBxYPa6xe9KsedHLc7TXryzidQpnurvZNm/8QMbqb4yyqv4rAAAAABJRU5ErkJggg==);width:16px;height:16px;display:inline-block}#property-panel a.macro-placeholder-property-panel-display-inline-button span.icon{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAw0lEQVR42q1TMQqAMBDr0/UBroJiBUEf0E51dRMcxUlwFBcHPxA5IUuLONSDcDmupO01VQCiEC+gtYagrusH5FVVCfdz0FfRQVVR5CmoLtzfnWBf/R7WWhhjIFnAmvlToOs6XNeF8zyx7zvWdcU8zxjHEW3bhgK8NydaFAWO48C2bViWBdM0YRgGOOcgPc7t9RWyLEPf92ia5hEuyxJ5nj+Lpae+IkkSpGkKZnLW6u/gDHzX+c6kP4j/nfjmNJ8HiP6NN81gzxU6QYojAAAAAElFTkSuQmCC);width:16px;height:16px;display:inline-block}#property-panel a.macro-placeholder-property-panel-display-inline-button,#property-panel a.macro-placeholder-property-panel-display-newline-button{padding:0 6px}",""])},"./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/status-macro/editor-content.scss":function(e,t,n){(e.exports=n("./node_modules/css-loader/dist/runtime/api.js")(!1)).push([e.i,".editor-inline-macro[data-macro-name=status]{background:transparent;border:0;min-height:16px;margin:0;vertical-align:-4px}",""])},"./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/status-macro/styles.scss":function(e,t,n){(e.exports=n("./node_modules/css-loader/dist/runtime/api.js")(!1)).push([e.i,"#property-panel a.macro-property-panel-Grey span.icon{background-color:#42526e}#property-panel a.macro-property-panel-Green span.icon{background-color:#00875a}#property-panel a.macro-property-panel-Red span.icon{background-color:#bf2600}#property-panel a.macro-property-panel-Yellow span.icon{background-color:#ff991f}#property-panel a.macro-property-panel-Blue span.icon{background-color:#0052cc}#property-panel a.macro-property-panel-Blue,#property-panel a.macro-property-panel-Brown,#property-panel a.macro-property-panel-Green,#property-panel a.macro-property-panel-Grey,#property-panel a.macro-property-panel-Red,#property-panel a.macro-property-panel-Yellow{padding:6px;display:inline-block}#property-panel a.macro-property-panel-Blue span.icon,#property-panel a.macro-property-panel-Brown span.icon,#property-panel a.macro-property-panel-Green span.icon,#property-panel a.macro-property-panel-Grey span.icon,#property-panel a.macro-property-panel-Red span.icon,#property-panel a.macro-property-panel-Yellow span.icon{display:inline-block;background-image:none;margin:0;border:0;min-width:auto;border-radius:3px;width:16px;height:16px}#property-panel .editable.status-macro-title{margin-right:10px;float:none;text-transform:uppercase;text-decoration:none;width:88px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;font-size:11px;padding:0 5px}#property-panel input.editable.status-macro-title{outline:none;height:30px;line-height:20px;vertical-align:bottom;padding-top:2px}",""])},"./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/theme-atlassian/editor-content.scss":function(e,t,n){(e.exports=n("./node_modules/css-loader/dist/runtime/api.js")(!1)).push([e.i,".mce-content-body .mce-visual-caret{background-color:#000;background-color:currentColor;position:absolute;display:none}.mce-content-body .mce-visual-caret-hidden{display:none}.mce-content-body [data-mce-caret]{left:-1000px;margin:0;padding:0;position:absolute;right:auto;top:0}.mce-content-body .mce-offscreen-selection{left:-2000000px;max-width:1000000px;position:absolute}.ephox-snooker-resizer-bar{background-color:#22b5fe;opacity:0;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.ephox-snooker-resizer-bar:hover{opacity:1}.ephox-snooker-resizer-cols{cursor:col-resize;width:3px!important}.ephox-snooker-resizer-rows{cursor:default;height:0!important}.ephox-snooker-resizer-bar.ephox-snooker-resizer-bar-dragging{opacity:1}table[data-mce-selected]{outline:1px solid #fff}",""])},"./node_modules/css-loader/dist/runtime/api.js":function(e,t,n){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=function(e,t){var n=e[1]||"",r=e[3];if(!r)return n;if(t&&"function"==typeof btoa){var o=(a=r,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(a))))+" */"),i=r.sources.map((function(e){return"/*# sourceURL="+r.sourceRoot+e+" */"}));return[n].concat(i).concat([o]).join("\n")}var a;return[n].join("\n")}(t,e);return t[2]?"@media "+t[2]+"{"+n+"}":n})).join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var r={},o=0;o<this.length;o++){var i=this[o][0];null!=i&&(r[i]=!0)}for(o=0;o<e.length;o++){var a=e[o];null!=a[0]&&r[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="("+a[2]+") and ("+n+")"),t.push(a))}},t}},"./node_modules/process/browser.js":function(e,t){var n,r,o=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function c(e){if(n===setTimeout)return setTimeout(e,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:i}catch(e){n=i}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(e){r=a}}();var u,l=[],s=!1,f=-1;function d(){s&&u&&(s=!1,u.length?l=u.concat(l):f=-1,l.length&&m())}function m(){if(!s){var e=c(d);s=!0;for(var t=l.length;t;){for(u=l,l=[];++f<t;)u&&u[f].run();f=-1,t=l.length}u=null,s=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function g(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new p(e,t)),1!==l.length||s||c(m)},p.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=g,o.addListener=g,o.once=g,o.off=g,o.removeListener=g,o.removeAllListeners=g,o.emit=g,o.prependListener=g,o.prependOnceListener=g,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},"./node_modules/querystring-es3/decode.js":function(e,t,n){"use strict";function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,n,i){t=t||"&",n=n||"=";var a={};if("string"!=typeof e||0===e.length)return a;var c=/\+/g;e=e.split(t);var u=1e3;i&&"number"==typeof i.maxKeys&&(u=i.maxKeys);var l=e.length;u>0&&l>u&&(l=u);for(var s=0;s<l;++s){var f,d,m,p,g=e[s].replace(c,"%20"),h=g.indexOf(n);h>=0?(f=g.substr(0,h),d=g.substr(h+1)):(f=g,d=""),m=decodeURIComponent(f),p=decodeURIComponent(d),r(a,m)?o(a[m])?a[m].push(p):a[m]=[a[m],p]:a[m]=p}return a};var o=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},"./node_modules/querystring-es3/encode.js":function(e,t,n){"use strict";var r=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,n,c){return t=t||"&",n=n||"=",null===e&&(e=void 0),"object"==typeof e?i(a(e),(function(a){var c=encodeURIComponent(r(a))+n;return o(e[a])?i(e[a],(function(e){return c+encodeURIComponent(r(e))})).join(t):c+encodeURIComponent(r(e[a]))})).join(t):c?encodeURIComponent(r(c))+n+encodeURIComponent(r(e)):""};var o=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function i(e,t){if(e.map)return e.map(t);for(var n=[],r=0;r<e.length;r++)n.push(t(e[r],r));return n}var a=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t}},"./node_modules/querystring-es3/index.js":function(e,t,n){"use strict";t.decode=t.parse=n("./node_modules/querystring-es3/decode.js"),t.encode=t.stringify=n("./node_modules/querystring-es3/encode.js")},"./node_modules/setimmediate/setImmediate.js":function(e,t,n){(function(e,t){!function(e,n){"use strict";if(!e.setImmediate){var r,o,i,a,c,u=1,l={},s=!1,f=e.document,d=Object.getPrototypeOf&&Object.getPrototypeOf(e);d=d&&d.setTimeout?d:e,"[object process]"==={}.toString.call(e.process)?r=function(e){t.nextTick((function(){p(e)}))}:!function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?e.MessageChannel?((i=new MessageChannel).port1.onmessage=function(e){p(e.data)},r=function(e){i.port2.postMessage(e)}):f&&"onreadystatechange"in f.createElement("script")?(o=f.documentElement,r=function(e){var t=f.createElement("script");t.onreadystatechange=function(){p(e),t.onreadystatechange=null,o.removeChild(t),t=null},o.appendChild(t)}):r=function(e){setTimeout(p,0,e)}:(a="setImmediate$"+Math.random()+"$",c=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(a)&&p(+t.data.slice(a.length))},e.addEventListener?e.addEventListener("message",c,!1):e.attachEvent("onmessage",c),r=function(t){e.postMessage(a+t,"*")}),d.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var o={callback:e,args:t};return l[u]=o,r(u),u++},d.clearImmediate=m}function m(e){delete l[e]}function p(e){if(s)setTimeout(p,0,e);else{var t=l[e];if(t){s=!0;try{!function(e){var t=e.callback,n=e.args;switch(n.length){case 0:t();break;case 1:t(n[0]);break;case 2:t(n[0],n[1]);break;case 3:t(n[0],n[1],n[2]);break;default:t.apply(void 0,n)}}(t)}finally{m(e),s=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,n("./node_modules/webpack/buildin/global.js"),n("./node_modules/process/browser.js"))},"./node_modules/style-loader/lib/addStyles.js":function(e,t,n){var r,o,i={},a=(r=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===o&&(o=r.apply(this,arguments)),o}),c=function(e,t){return t?t.querySelector(e):document.querySelector(e)},u=function(e){var t={};return function(e,n){if("function"==typeof e)return e();if(void 0===t[e]){var r=c.call(this,e,n);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(e){r=null}t[e]=r}return t[e]}}(),l=null,s=0,f=[],d=n("./node_modules/style-loader/lib/urls.js");function m(e,t){for(var n=0;n<e.length;n++){var r=e[n],o=i[r.id];if(o){o.refs++;for(var a=0;a<o.parts.length;a++)o.parts[a](r.parts[a]);for(;a<r.parts.length;a++)o.parts.push(y(r.parts[a],t))}else{var c=[];for(a=0;a<r.parts.length;a++)c.push(y(r.parts[a],t));i[r.id]={id:r.id,refs:1,parts:c}}}}function p(e,t){for(var n=[],r={},o=0;o<e.length;o++){var i=e[o],a=t.base?i[0]+t.base:i[0],c={css:i[1],media:i[2],sourceMap:i[3]};r[a]?r[a].parts.push(c):n.push(r[a]={id:a,parts:[c]})}return n}function g(e,t){var n=u(e.insertInto);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var r=f[f.length-1];if("top"===e.insertAt)r?r.nextSibling?n.insertBefore(t,r.nextSibling):n.appendChild(t):n.insertBefore(t,n.firstChild),f.push(t);else if("bottom"===e.insertAt)n.appendChild(t);else{if("object"!=typeof e.insertAt||!e.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var o=u(e.insertAt.before,n);n.insertBefore(t,o)}}function h(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e);var t=f.indexOf(e);t>=0&&f.splice(t,1)}function v(e){var t=document.createElement("style");if(void 0===e.attrs.type&&(e.attrs.type="text/css"),void 0===e.attrs.nonce){var r=function(){0;return n.nc}();r&&(e.attrs.nonce=r)}return b(t,e.attrs),g(e,t),t}function b(e,t){Object.keys(t).forEach((function(n){e.setAttribute(n,t[n])}))}function y(e,t){var n,r,o,i;if(t.transform&&e.css){if(!(i="function"==typeof t.transform?t.transform(e.css):t.transform.default(e.css)))return function(){};e.css=i}if(t.singleton){var a=s++;n=l||(l=v(t)),r=x.bind(null,n,a,!1),o=x.bind(null,n,a,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=function(e){var t=document.createElement("link");return void 0===e.attrs.type&&(e.attrs.type="text/css"),e.attrs.rel="stylesheet",b(t,e.attrs),g(e,t),t}(t),r=k.bind(null,n,t),o=function(){h(n),n.href&&URL.revokeObjectURL(n.href)}):(n=v(t),r=S.bind(null,n),o=function(){h(n)});return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else o()}}e.exports=function(e,t){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(t=t||{}).attrs="object"==typeof t.attrs?t.attrs:{},t.singleton||"boolean"==typeof t.singleton||(t.singleton=a()),t.insertInto||(t.insertInto="head"),t.insertAt||(t.insertAt="bottom");var n=p(e,t);return m(n,t),function(e){for(var r=[],o=0;o<n.length;o++){var a=n[o];(c=i[a.id]).refs--,r.push(c)}e&&m(p(e,t),t);for(o=0;o<r.length;o++){var c;if(0===(c=r[o]).refs){for(var u=0;u<c.parts.length;u++)c.parts[u]();delete i[c.id]}}}};var w,C=(w=[],function(e,t){return w[e]=t,w.filter(Boolean).join("\n")});function x(e,t,n,r){var o=n?"":r.css;if(e.styleSheet)e.styleSheet.cssText=C(t,o);else{var i=document.createTextNode(o),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(i,a[t]):e.appendChild(i)}}function S(e,t){var n=t.css,r=t.media;if(r&&e.setAttribute("media",r),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}function k(e,t,n){var r=n.css,o=n.sourceMap,i=void 0===t.convertToAbsoluteUrls&&o;(t.convertToAbsoluteUrls||i)&&(r=d(r)),o&&(r+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(o))))+" */");var a=new Blob([r],{type:"text/css"}),c=e.href;e.href=URL.createObjectURL(a),c&&URL.revokeObjectURL(c)}},"./node_modules/style-loader/lib/urls.js":function(e,t){e.exports=function(e){var t="undefined"!=typeof window&&window.location;if(!t)throw new Error("fixUrls requires window.location");if(!e||"string"!=typeof e)return e;var n=t.protocol+"//"+t.host,r=n+t.pathname.replace(/\/[^\/]*$/,"/");return e.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,(function(e,t){var o,i=t.trim().replace(/^"(.*)"$/,(function(e,t){return t})).replace(/^'(.*)'$/,(function(e,t){return t}));return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(i)?e:(o=0===i.indexOf("//")?i:0===i.indexOf("/")?n+i:r+i.replace(/^\.\//,""),"url("+JSON.stringify(o)+")")}))}},"./node_modules/timers-browserify/main.js":function(e,t,n){(function(e){var r=void 0!==e&&e||"undefined"!=typeof self&&self||window,o=Function.prototype.apply;function i(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new i(o.call(setTimeout,r,arguments),clearTimeout)},t.setInterval=function(){return new i(o.call(setInterval,r,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},i.prototype.unref=i.prototype.ref=function(){},i.prototype.close=function(){this._clearFn.call(r,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},n("./node_modules/setimmediate/setImmediate.js"),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./node_modules/tinymce/plugins/lists/index.js":function(e,t,n){n("./node_modules/tinymce/plugins/lists/plugin.js")},"./node_modules/tinymce/plugins/lists/plugin.js":function(e,t){!function(){"use strict";var e,t,n=tinymce.util.Tools.resolve("tinymce.PluginManager"),r=function(e){return function(t){return r=typeof(n=t),(null===n?"null":"object"===r&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"===r&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":r)===e;var n,r}},o=function(e){return function(t){return typeof t===e}},i=r("string"),a=r("object"),c=r("array"),u=o("boolean"),l=o("function"),s=o("number"),f=function(){},d=function(e){return function(){return e}},m=function(e){return e},p=function(e,t){return e===t},g=function(e){return function(t){return!e(t)}},h=d(!1),v=d(!0),b=function(){return y},y={fold:function(e,t){return e()},isSome:h,isNone:v,getOr:t=m,getOrThunk:e=function(e){return e()},getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:d(null),getOrUndefined:d(void 0),or:t,orThunk:e,map:b,each:f,bind:b,exists:h,forall:v,filter:function(){return b()},toArray:function(){return[]},toString:d("none()")},w=function(e){var t=d(e),n=function(){return o},r=function(t){return t(e)},o={fold:function(t,n){return n(e)},isSome:v,isNone:h,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:n,orThunk:n,map:function(t){return w(t(e))},each:function(t){t(e)},bind:r,exists:r,forall:r,filter:function(t){return t(e)?o:y},toArray:function(){return[e]},toString:function(){return"some("+e+")"}};return o},C={some:w,none:b,from:function(e){return null==e?y:w(e)}},x=Array.prototype.slice,S=Array.prototype.push,k=function(e,t){for(var n=e.length,r=new Array(n),o=0;o<n;o++){var i=e[o];r[o]=t(i,o)}return r},T=function(e,t){for(var n=0,r=e.length;n<r;n++){t(e[n],n)}},E=function(e,t){for(var n=[],r=0,o=e.length;r<o;r++){var i=e[r];t(i,r)&&n.push(i)}return n},A=function(e,t,n){return T(e,(function(e,r){n=t(n,e,r)})),n},_=function(e,t,n){for(var r=0,o=e.length;r<o;r++){var i=e[r];if(t(i,r))return C.some(i);if(n(i,r))break}return C.none()},N=function(e,t){return _(e,t,h)},R=function(e,t){return function(e){for(var t=[],n=0,r=e.length;n<r;++n){if(!c(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);S.apply(t,e[n])}return t}(k(e,t))},D=function(e){var t=x.call(e,0);return t.reverse(),t},O=function(e,t){return t>=0&&t<e.length?C.some(e[t]):C.none()},I=function(e){return O(e,0)},P=function(e){return O(e,e.length-1)},B=function(){return(B=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};var M,L=function(){return F(0,0)},F=function(e,t){return{major:e,minor:t}},j={nu:F,detect:function(e,t){var n=String(t).toLowerCase();return 0===e.length?L():function(e,t){var n=function(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(r.test(t))return r}}(e,t);if(!n)return{major:0,minor:0};var r=function(e){return Number(t.replace(n,"$"+e))};return F(r(1),r(2))}(e,n)},unknown:L},H=function(e,t){return function(e,t){for(var n=0;n<e.length;n++){var r=t(e[n],n);if(r.isSome())return r}return C.none()}(t.brands,(function(t){var n=t.brand.toLowerCase();return N(e,(function(e){var t;return n===(null===(t=e.brand)||void 0===t?void 0:t.toLowerCase())})).map((function(e){return{current:e.name,version:j.nu(parseInt(t.version,10),0)}}))}))},U=function(e,t){var n=String(t).toLowerCase();return N(e,(function(e){return e.search(n)}))},z=function(e,t){return-1!==e.indexOf(t)},W=(M=/^\s+|\s+$/g,function(e){return e.replace(M,"")}),V=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,q=function(e){return function(t){return z(t,e)}},$=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(e){return z(e,"edge/")&&z(e,"chrome")&&z(e,"safari")&&z(e,"applewebkit")}},{name:"Chrome",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,V],search:function(e){return z(e,"chrome")&&!z(e,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(e){return z(e,"msie")||z(e,"trident")}},{name:"Opera",versionRegexes:[V,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:q("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:q("firefox")},{name:"Safari",versionRegexes:[V,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(e){return(z(e,"safari")||z(e,"mobile/"))&&z(e,"applewebkit")}}],K=[{name:"Windows",search:q("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(e){return z(e,"iphone")||z(e,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:q("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:q("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:q("linux"),versionRegexes:[]},{name:"Solaris",search:q("sunos"),versionRegexes:[]},{name:"FreeBSD",search:q("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:q("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],G={browsers:d($),oses:d(K)},J=function(e){var t=e.current,n=e.version,r=function(e){return function(){return t===e}};return{current:t,version:n,isEdge:r("Edge"),isChrome:r("Chrome"),isIE:r("IE"),isOpera:r("Opera"),isFirefox:r("Firefox"),isSafari:r("Safari")}},X={unknown:function(){return J({current:void 0,version:j.unknown()})},nu:J,edge:d("Edge"),chrome:d("Chrome"),ie:d("IE"),opera:d("Opera"),firefox:d("Firefox"),safari:d("Safari")},Y=function(e){var t=e.current,n=e.version,r=function(e){return function(){return t===e}};return{current:t,version:n,isWindows:r("Windows"),isiOS:r("iOS"),isAndroid:r("Android"),isOSX:r("OSX"),isLinux:r("Linux"),isSolaris:r("Solaris"),isFreeBSD:r("FreeBSD"),isChromeOS:r("ChromeOS")}},Q={unknown:function(){return Y({current:void 0,version:j.unknown()})},nu:Y,windows:d("Windows"),ios:d("iOS"),android:d("Android"),linux:d("Linux"),osx:d("OSX"),solaris:d("Solaris"),freebsd:d("FreeBSD"),chromeos:d("ChromeOS")},Z=function(e,t,n){var r=G.browsers(),o=G.oses(),i=t.bind((function(e){return H(r,e)})).orThunk((function(){return function(e,t){return U(e,t).map((function(e){var n=j.detect(e.versionRegexes,t);return{current:e.name,version:n}}))}(r,e)})).fold(X.unknown,X.nu),a=function(e,t){return U(e,t).map((function(e){var n=j.detect(e.versionRegexes,t);return{current:e.name,version:n}}))}(o,e).fold(Q.unknown,Q.nu),c=function(e,t,n,r){var o=e.isiOS()&&!0===/ipad/i.test(n),i=e.isiOS()&&!o,a=e.isiOS()||e.isAndroid(),c=a||r("(pointer:coarse)"),u=o||!i&&a&&r("(min-device-width:768px)"),l=i||a&&!u,s=t.isSafari()&&e.isiOS()&&!1===/safari/i.test(n),f=!l&&!u&&!s;return{isiPad:d(o),isiPhone:d(i),isTablet:d(u),isPhone:d(l),isTouch:d(c),isAndroid:e.isAndroid,isiOS:e.isiOS,isWebView:d(s),isDesktop:d(f)}}(a,i,e,n);return{browser:i,os:a,deviceType:c}},ee=function(e){return window.matchMedia(e).matches},te=function(e){var t,n=!1;return function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return n||(n=!0,t=e.apply(null,r)),t}}((function(){return Z(navigator.userAgent,C.from(navigator.userAgentData),ee)})),ne=function(e){if(null==e)throw new Error("Node cannot be null or undefined");return{dom:e}},re={fromHtml:function(e,t){var n=(t||document).createElement("div");if(n.innerHTML=e,!n.hasChildNodes()||n.childNodes.length>1)throw console.error("HTML does not have a single root node",e),new Error("HTML must have a single root node");return ne(n.childNodes[0])},fromTag:function(e,t){var n=(t||document).createElement(e);return ne(n)},fromText:function(e,t){var n=(t||document).createTextNode(e);return ne(n)},fromDom:ne,fromPoint:function(e,t,n){return C.from(e.dom.elementFromPoint(t,n)).map(ne)}},oe=function(e,t){return e.dom===t.dom},ie=function(e,t){return n=e.dom,r=t.dom,function(e,t,n){return 0!=(e.compareDocumentPosition(t)&n)}(n,r,Node.DOCUMENT_POSITION_CONTAINED_BY);var n,r},ae=function(e,t){return te().browser.isIE()?ie(e,t):function(e,t){var n=e.dom,r=t.dom;return n!==r&&n.contains(r)}(e,t)},ce=function(e,t){var n=e.dom;if(1!==n.nodeType)return!1;var r=n;if(void 0!==r.matches)return r.matches(t);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(t);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(t);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")},ue=tinymce.util.Tools.resolve("tinymce.dom.RangeUtils"),le=tinymce.util.Tools.resolve("tinymce.dom.TreeWalker"),se=tinymce.util.Tools.resolve("tinymce.util.VK"),fe=Object.keys,de=function(e,t){for(var n=fe(e),r=0,o=n.length;r<o;r++){var i=n[r];t(e[i],i)}},me=function(e,t){var n={};return function(e,t,n,r){de(e,(function(e,o){(t(e,o)?n:r)(e,o)}))}(e,t,function(e){return function(t,n){e[n]=t}}(n),f),n};"undefined"!=typeof window?window:Function("return this;")();var pe,ge=function(e){return e.dom.nodeName.toLowerCase()},he=(pe=1,function(e){return function(e){return e.dom.nodeType}(e)===pe}),ve=function(e){return function(t){return he(t)&&ge(t)===e}},be=function(e,t){var n=e.dom;de(t,(function(e,t){!function(e,t,n){if(!(i(n)||u(n)||s(n)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",n,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(t,n+"")}(n,t,e)}))},ye=function(e){return A(e.dom.attributes,(function(e,t){return e[t.name]=t.value,e}),{})},we=function(e){return C.from(e.dom.parentNode).map(re.fromDom)},Ce=function(e){return k(e.dom.childNodes,re.fromDom)},xe=function(e,t){var n=e.dom.childNodes;return C.from(n[t]).map(re.fromDom)},Se=function(e){return xe(e,0)},ke=function(e){return xe(e,e.dom.childNodes.length-1)},Te=function(e,t){we(e).each((function(n){n.dom.insertBefore(t.dom,e.dom)}))},Ee=function(e,t){e.dom.appendChild(t.dom)},Ae=function(e,t){T(t,(function(t){Ee(e,t)}))},_e=function(e){var t=e.dom;null!==t.parentNode&&t.parentNode.removeChild(t)},Ne=function(e){return function(e,t){return re.fromDom(e.dom.cloneNode(t))}(e,!0)},Re=function(e,t){var n=function(e,t){var n=re.fromTag(t),r=ye(e);return be(n,r),n}(e,t);Te(e,n);var r=Ce(e);return Ae(n,r),_e(e),n},De=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),Oe=tinymce.util.Tools.resolve("tinymce.util.Tools"),Ie=function(e){return function(t){return t&&t.nodeName.toLowerCase()===e}},Pe=function(e){return function(t){return t&&e.test(t.nodeName)}},Be=function(e){return e&&3===e.nodeType},Me=Pe(/^(OL|UL|DL)$/),Le=Pe(/^(OL|UL)$/),Fe=Ie("ol"),je=Pe(/^(LI|DT|DD)$/),He=Pe(/^(DT|DD)$/),Ue=Pe(/^(TH|TD)$/),ze=Ie("br"),We=function(e,t){return t&&!!e.schema.getTextBlockElements()[t.nodeName]},Ve=function(e,t){return e&&e.nodeName in t},qe=function(e,t,n){var r=e.isEmpty(t);return!(n&&e.select("span[data-mce-type=bookmark]",t).length>0)&&r},$e=function(e,t){return e.isChildOf(t,e.getRoot())},Ke=function(e,t){var n,r,o,i=e.dom,a=e.schema.getBlockElements(),c=i.createFragment(),u=function(e){var t=e.getParam("forced_root_block","p");return!1===t?"":!0===t?"p":t}(e);if(u&&((r=i.create(u)).tagName===u.toUpperCase()&&i.setAttribs(r,function(e){return e.getParam("forced_root_block_attrs",{})}(e)),Ve(t.firstChild,a)||c.appendChild(r)),t)for(;n=t.firstChild;){var l=n.nodeName;o||"SPAN"===l&&"bookmark"===n.getAttribute("data-mce-type")||(o=!0),Ve(n,a)?(c.appendChild(n),r=null):u?(r||(r=i.create(u),c.appendChild(r)),r.appendChild(n)):c.appendChild(n)}return u?o||r.appendChild(i.create("br",{"data-mce-bogus":"1"})):c.appendChild(i.create("br")),c},Ge=De.DOM,Je=ve("dd"),Xe=ve("dt"),Ye=function(e,t){Je(t)?Re(t,"dt"):Xe(t)&&we(t).each((function(n){return function(e,t,n){var r=Ge.select('span[data-mce-type="bookmark"]',t),o=Ke(e,n),i=Ge.createRng();i.setStartAfter(n),i.setEndAfter(t);for(var a,c=i.extractContents(),u=c.firstChild;u;u=u.firstChild)if("LI"===u.nodeName&&e.dom.isEmpty(u)){Ge.remove(u);break}e.dom.isEmpty(c)||Ge.insertAfter(c,t),Ge.insertAfter(o,t),qe(e.dom,n.parentNode)&&(a=n.parentNode,Oe.each(r,(function(e){a.parentNode.insertBefore(e,n.parentNode)})),Ge.remove(a)),Ge.remove(n),qe(e.dom,t)&&Ge.remove(t)}(e,n.dom,t.dom)}))},Qe=function(e){Xe(e)&&Re(e,"dd")},Ze=function(e,t){if(Be(e))return{container:e,offset:t};var n=ue.getNode(e,t);return Be(n)?{container:n,offset:t>=e.childNodes.length?n.data.length:0}:n.previousSibling&&Be(n.previousSibling)?{container:n.previousSibling,offset:n.previousSibling.data.length}:n.nextSibling&&Be(n.nextSibling)?{container:n.nextSibling,offset:0}:{container:e,offset:t}},et=function(e){var t=e.cloneRange(),n=Ze(e.startContainer,e.startOffset);t.setStart(n.container,n.offset);var r=Ze(e.endContainer,e.endOffset);return t.setEnd(r.container,r.offset),t},tt=tinymce.util.Tools.resolve("tinymce.dom.DomQuery"),nt=function(e,t){var n=t||e.selection.getStart(!0);return e.dom.getParent(n,"OL,UL,DL",it(e,n))},rt=function(e){var t=nt(e),n=e.selection.getSelectedBlocks();return function(e,t){return e&&1===t.length&&t[0]===e}(t,n)?function(e){return E(e.querySelectorAll("ol,ul,dl"),Me)}(t):E(n,(function(e){return Me(e)&&t!==e}))},ot=function(e){var t=e.selection.getSelectedBlocks();return E(function(e,t){var n=Oe.map(t,(function(t){var n=e.dom.getParent(t,"li,dd,dt",it(e,t));return n||t}));return tt.unique(n)}(e,t),je)},it=function(e,t){var n=e.dom.getParents(t,"TD,TH");return n.length>0?n[0]:e.getBody()},at=function(e,t){var n=e.dom.getParents(t,"ol,ul",it(e,t));return P(n)},ct=function(e){var t=function(e){var t=at(e,e.selection.getStart()),n=E(e.selection.getSelectedBlocks(),Le);return t.toArray().concat(n)}(e);return ut(e,t)},ut=function(e,t){var n=k(t,(function(t){return at(e,t).getOr(t)}));return tt.unique(n)},lt=function(e,t,n){return void 0===n&&(n=p),e.exists((function(e){return n(e,t)}))},st=function(e,t,n){return e.isSome()&&t.isSome()?C.some(n(e.getOrDie(),t.getOrDie())):C.none()},ft=function(e,t,n){return e.fire("ListMutation",{action:t,element:n})},dt=function(e,t,n){if(!i(n))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",n,":: Element ",e),new Error("CSS value must be a string: "+n);(function(e){return void 0!==e.style&&l(e.style.getPropertyValue)})(e)&&e.style.setProperty(t,n)},mt=function(e,t){Ee(e.item,t.list)},pt=function(e,t){var n={list:re.fromTag(t,e),item:re.fromTag("li",e)};return Ee(n.list,n.item),n},gt=function(e,t,n){var r=t.slice(0,n.depth);return P(r).each((function(t){!function(e,t){Ee(e.list,t),e.item=t}(t,function(e,t,n){var r=re.fromTag("li",e);return be(r,t),Ae(r,n),r}(e,n.itemAttributes,n.content)),function(e,t){ge(e.list)!==t.listType&&(e.list=Re(e.list,t.listType)),be(e.list,t.listAttributes)}(t,n)})),r},ht=function(e,t,n){var r,o=function(e,t,n){for(var r=[],o=0;o<n;o++)r.push(pt(e,t.listType));return r}(e,n,n.depth-t.length);return function(e){for(var t=1;t<e.length;t++)mt(e[t-1],e[t])}(o),function(e,t){for(var n=0;n<e.length-1;n++)r=e[n].item,o="list-style-type",i="none",a=void 0,a=r.dom,dt(a,o,i);var r,o,i,a;P(e).each((function(e){be(e.list,t.listAttributes),be(e.item,t.itemAttributes),Ae(e.item,t.content)}))}(o,n),r=o,st(P(t),I(r),mt),t.concat(o)},vt=function(e){return ce(e,"OL,UL")},bt=function(e){return Se(e).exists(vt)},yt=function(e){return e.depth>0},wt=function(e){return e.isSelected},Ct=function(e){var t=Ce(e),n=ke(e).exists(vt)?t.slice(0,-1):t;return k(n,Ne)},xt=function(e){return T(e,(function(t,n){(function(e,t){var n=e[t].depth,r=function(e){return e.depth===n&&!e.dirty},o=function(e){return e.depth<n};return _(D(e.slice(0,t)),r,o).orThunk((function(){return _(e.slice(t+1),r,o)}))})(e,n).fold((function(){t.dirty&&function(e){e.listAttributes=me(e.listAttributes,(function(e,t){return"start"!==t}))}(t)}),(function(e){return r=e,(n=t).listType=r.listType,void(n.listAttributes=B({},r.listAttributes));var n,r}))})),e},St=function(e,t,n,r){return Se(r).filter(vt).fold((function(){t.each((function(e){oe(e.start,r)&&n.set(!0)}));var o=function(e,t,n){return we(e).filter(he).map((function(r){return{depth:t,dirty:!1,isSelected:n,content:Ct(e),itemAttributes:ye(e),listAttributes:ye(r),listType:ge(r)}}))}(r,e,n.get());t.each((function(e){oe(e.end,r)&&n.set(!1)}));var i=ke(r).filter(vt).map((function(r){return kt(e,t,n,r)})).getOr([]);return o.toArray().concat(i)}),(function(r){return kt(e,t,n,r)}))},kt=function(e,t,n,r){return R(Ce(r),(function(r){return(vt(r)?kt:St)(e+1,t,n,r)}))},Tt=function(e,t){var n=xt(t);return k(n,(function(t){var n,r,o,i=(n=t.content,o=(r||document).createDocumentFragment(),T(n,(function(e){o.appendChild(e.dom)})),re.fromDom(o));return re.fromDom(Ke(e,i.dom))}))},Et=function(e,t){var n=xt(t);return function(e,t){var n=A(t,(function(t,n){return n.depth>t.length?ht(e,t,n):gt(e,t,n)}),[]);return I(n).map((function(e){return e.list}))}(e.contentDocument,n).toArray()},At=function(e,t,n){var r=function(e,t){var n,r=(n=!1,{get:function(){return n},set:function(e){n=e}});return k(e,(function(e){return{sourceList:e,entries:kt(0,t,r,e)}}))}(t,function(e){var t=k(ot(e),re.fromDom);return st(N(t,g(bt)),N(D(t),g(bt)),(function(e,t){return{start:e,end:t}}))}(e));T(r,(function(t){!function(e,t){T(E(e,wt),(function(e){return function(e,t){switch(e){case"Indent":t.depth++;break;case"Outdent":t.depth--;break;case"Flatten":t.depth=0}t.dirty=!0}(t,e)}))}(t.entries,n);var r,o=function(e,t){return R(function(e,t){if(0===e.length)return[];for(var n=t(e[0]),r=[],o=[],i=0,a=e.length;i<a;i++){var c=e[i],u=t(c);u!==n&&(r.push(o),o=[]),n=u,o.push(c)}return 0!==o.length&&r.push(o),r}(t,yt),(function(t){return I(t).exists(yt)?Et(e,t):Tt(e,t)}))}(e,t.entries);T(o,(function(t){ft(e,"Indent"===n?"IndentList":"OutdentList",t.dom)})),r=t.sourceList,T(o,(function(e){Te(r,e)})),_e(t.sourceList)}))},_t=function(e,t){var n=k(ct(e),re.fromDom),r=k(function(e){return E(ot(e),He)}(e),re.fromDom),o=!1;if(n.length||r.length){var i=e.selection.getBookmark();At(e,n,t),function(e,t,n){T(n,"Indent"===t?Qe:function(t){return Ye(e,t)})}(e,t,r),e.selection.moveToBookmark(i),e.selection.setRng(et(e.selection.getRng())),e.nodeChanged(),o=!0}return o},Nt=function(e){return _t(e,"Indent")},Rt=function(e){return _t(e,"Outdent")},Dt=function(e){return _t(e,"Flatten")},Ot=tinymce.util.Tools.resolve("tinymce.dom.BookmarkManager"),It=De.DOM,Pt=function(e){var t={},n=function(n){var r=e[n?"startContainer":"endContainer"],o=e[n?"startOffset":"endOffset"];if(1===r.nodeType){var i=It.create("span",{"data-mce-type":"bookmark"});r.hasChildNodes()?(o=Math.min(o,r.childNodes.length-1),n?r.insertBefore(i,r.childNodes[o]):It.insertAfter(i,r.childNodes[o])):r.appendChild(i),r=i,o=0}t[n?"startContainer":"endContainer"]=r,t[n?"startOffset":"endOffset"]=o};return n(!0),e.collapsed||n(),t},Bt=function(e){var t=function(t){var n,r=n=e[t?"startContainer":"endContainer"],o=e[t?"startOffset":"endOffset"];r&&(1===r.nodeType&&(o=function(e){for(var t=e.parentNode.firstChild,n=0;t;){if(t===e)return n;1===t.nodeType&&"bookmark"===t.getAttribute("data-mce-type")||n++,t=t.nextSibling}return-1}(r),r=r.parentNode,It.remove(n),!r.hasChildNodes()&&It.isBlock(r)&&r.appendChild(It.create("br"))),e[t?"startContainer":"endContainer"]=r,e[t?"startOffset":"endOffset"]=o)};t(!0),t();var n=It.createRng();return n.setStart(e.startContainer,e.startOffset),e.endContainer&&n.setEnd(e.endContainer,e.endOffset),et(n)},Mt=function(e){switch(e){case"UL":return"ToggleUlList";case"OL":return"ToggleOlList";case"DL":return"ToggleDLList"}},Lt=function(e){return/\btox\-/.test(e.className)},Ft=function(e,t,n){var r=function(e){var r=_(e.parents,Me,Ue).filter((function(e){return e.nodeName===t&&!Lt(e)})).isSome();n(r)},o=e.dom.getParents(e.selection.getNode());return r({parents:o}),e.on("NodeChange",r),function(){return e.off("NodeChange",r)}},jt=function(e,t){Oe.each(t,(function(t,n){e.setAttribute(n,t)}))},Ht=function(e,t,n){!function(e,t,n){var r=n["list-style-type"]?n["list-style-type"]:null;e.setStyle(t,"list-style-type",r)}(e,t,n),function(e,t,n){jt(t,n["list-attributes"]),Oe.each(e.select("li",t),(function(e){jt(e,n["list-item-attributes"])}))}(e,t,n)},Ut=function(e,t,n,r){var o=t[n?"startContainer":"endContainer"],i=t[n?"startOffset":"endOffset"];for(1===o.nodeType&&(o=o.childNodes[Math.min(i,o.childNodes.length-1)]||o),!n&&ze(o.nextSibling)&&(o=o.nextSibling);o.parentNode!==r;){if(We(e,o))return o;if(/^(TD|TH)$/.test(o.parentNode.nodeName))return o;o=o.parentNode}return o},zt=function(e,t,n){var r=e.selection.getRng(),o="LI",i=it(e,e.selection.getStart(!0)),a=e.dom;if("false"!==a.getContentEditable(e.selection.getNode())){"DL"===(t=t.toUpperCase())&&(o="DT");var c=Pt(r),u=function(e,t,n){for(var r,o=[],i=e.dom,a=Ut(e,t,!0,n),c=Ut(e,t,!1,n),u=[],l=a;l&&(u.push(l),l!==c);l=l.nextSibling);return Oe.each(u,(function(t){if(We(e,t))return o.push(t),void(r=null);if(i.isBlock(t)||ze(t))return ze(t)&&i.remove(t),void(r=null);var a=t.nextSibling;Ot.isBookmarkNode(t)&&(Me(a)||We(e,a)||!a&&t.parentNode===n)?r=null:(r||(r=i.create("p"),t.parentNode.insertBefore(r,t),o.push(r)),r.appendChild(t))})),o}(e,r,i);Oe.each(u,(function(r){var i,c=r.previousSibling,u=r.parentNode;je(u)||(c&&Me(c)&&c.nodeName===t&&function(e,t,n){var r=e.getStyle(t,"list-style-type"),o=n?n["list-style-type"]:"";return r===(o=null===o?"":o)}(a,c,n)?(i=c,r=a.rename(r,o),c.appendChild(r)):(i=a.create(t),r.parentNode.insertBefore(i,r),i.appendChild(r),r=a.rename(r,o)),function(e,t,n){Oe.each(n,(function(n){var r;return e.setStyle(t,((r={})[n]="",r))}))}(a,r,["margin","margin-right","margin-bottom","margin-left","margin-top","padding","padding-right","padding-bottom","padding-left","padding-top"]),Ht(a,i,n),Vt(e.dom,i))})),e.selection.setRng(Bt(c))}},Wt=function(e,t,n){return function(e,t){return e&&t&&Me(e)&&e.nodeName===t.nodeName}(t,n)&&function(e,t,n){return e.getStyle(t,"list-style-type",!0)===e.getStyle(n,"list-style-type",!0)}(e,t,n)&&(r=n,t.className===r.className);var r},Vt=function(e,t){var n,r;if(n=t.nextSibling,Wt(e,t,n)){for(;r=n.firstChild;)t.appendChild(r);e.remove(n)}if(n=t.previousSibling,Wt(e,t,n)){for(;r=n.lastChild;)t.insertBefore(r,t.firstChild);e.remove(n)}},qt=function(e,t,n,r,o){var i=Me(t);if(i&&t.nodeName===r&&!$t(o))Dt(e);else{zt(e,r,o);var a=Pt(e.selection.getRng()),c=i?function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}([t],n,!0):n;Oe.each(c,(function(t){!function(e,t,n,r){if(t.nodeName!==n){var o=e.dom.rename(t,n);Ht(e.dom,o,r),ft(e,Mt(n),o)}else Ht(e.dom,t,r),ft(e,Mt(n),t)}(e,t,r,o)})),e.selection.setRng(Bt(a))}},$t=function(e){return"list-style-type"in e},Kt=function(e,t,n){var r=nt(e),o=rt(e),i=a(n)?n:{};o.length>0?qt(e,r,o,t,i):function(e,t,n,r){if(t!==e.getBody())if(t)if(t.nodeName!==n||$t(r)||Lt(t)){var o=Pt(e.selection.getRng());Ht(e.dom,t,r);var i=e.dom.rename(t,n);Vt(e.dom,i),e.selection.setRng(Bt(o)),zt(e,n,r),ft(e,Mt(n),i)}else Dt(e);else zt(e,n,r),ft(e,Mt(n),t)}(e,r,t,i)},Gt=De.DOM,Jt=function(e,t){var n=Oe.grep(e.select("ol,ul",t));Oe.each(n,(function(t){!function(e,t){var n,r=t.parentNode;"LI"===r.nodeName&&r.firstChild===t&&((n=r.previousSibling)&&"LI"===n.nodeName?(n.appendChild(t),qe(e,r)&&Gt.remove(r)):Gt.setStyle(r,"listStyleType","none"));Me(r)&&((n=r.previousSibling)&&"LI"===n.nodeName&&n.appendChild(t))}(e,t)}))},Xt=function(e,t,n,r){var o=t.startContainer,i=t.startOffset;if(Be(o)&&(n?i<o.data.length:i>0))return o;var a=e.schema.getNonEmptyElements();1===o.nodeType&&(o=ue.getNode(o,i));var c=new le(o,r);for(n&&function(e,t){return!!ze(t)&&(e.isBlock(t.nextSibling)&&!ze(t.previousSibling))}(e.dom,o)&&c.next();o=c[n?"next":"prev2"]();){if("LI"===o.nodeName&&!o.hasChildNodes())return o;if(a[o.nodeName])return o;if(Be(o)&&o.data.length>0)return o}},Yt=function(e,t){var n=t.childNodes;return 1===n.length&&!Me(n[0])&&e.isBlock(n[0])},Qt=function(e,t,n){var r,o=Yt(e,n)?n.firstChild:n;if(function(e,t){Yt(e,t)&&e.remove(t.firstChild,!0)}(e,t),!qe(e,t,!0))for(;r=t.firstChild;)o.appendChild(r)},Zt=function(e,t,n){var r,o=t.parentNode;if($e(e,t)&&$e(e,n)){Me(n.lastChild)&&(r=n.lastChild),o===n.lastChild&&ze(o.previousSibling)&&e.remove(o.previousSibling);var i=n.lastChild;i&&ze(i)&&t.hasChildNodes()&&e.remove(i),qe(e,n,!0)&&e.$(n).empty(),Qt(e,t,n),r&&n.appendChild(r);var a=ae(re.fromDom(n),re.fromDom(t))?e.getParents(t,Me,n):[];e.remove(t),T(a,(function(t){qe(e,t)&&t!==e.getRoot()&&e.remove(t)}))}},en=function(e,t,n,r){var o=e.dom;if(o.isEmpty(r))!function(e,t,n){e.dom.$(n).empty(),Zt(e.dom,t,n),e.selection.setCursorLocation(n,0)}(e,n,r);else{var i=Pt(t);Zt(o,n,r),e.selection.setRng(Bt(i))}},tn=function(e,t){var n=e.dom,r=e.selection,o=r.getStart(),i=it(e,o),a=n.getParent(r.getStart(),"LI",i);if(a){var c=a.parentNode;if(c===e.getBody()&&qe(n,c))return!0;var u=et(r.getRng()),l=n.getParent(Xt(e,u,t,i),"LI",i);if(l&&l!==a)return e.undoManager.transact((function(){var n;t?en(e,u,l,a):(n=a).parentNode.firstChild===n?Rt(e):function(e,t,n,r){var o=Pt(t);Zt(e.dom,n,r);var i=Bt(o);e.selection.setRng(i)}(e,u,a,l)})),!0;if(!l&&!t&&0===u.startOffset&&0===u.endOffset)return e.undoManager.transact((function(){Dt(e)})),!0}return!1},nn=function(e,t){return tn(e,t)||function(e,t){var n=e.dom,r=e.selection.getStart(),o=it(e,r),i=n.getParent(r,n.isBlock,o);if(i&&n.isEmpty(i)){var a=et(e.selection.getRng()),c=n.getParent(Xt(e,a,t,o),"LI",o);if(c)return e.undoManager.transact((function(){!function(e,t,n){var r=e.getParent(t.parentNode,e.isBlock,n);e.remove(t),r&&e.isEmpty(r)&&e.remove(r)}(n,i,o),Vt(n,c.parentNode),e.selection.select(c,!0),e.selection.collapse(t)})),!0}return!1}(e,t)},rn=function(e,t){return e.selection.isCollapsed()?nn(e,t):function(e){var t=e.selection.getStart(),n=it(e,t);return!!(e.dom.getParent(t,"LI,DT,DD",n)||ot(e).length>0)&&(e.undoManager.transact((function(){e.execCommand("Delete"),Jt(e.dom,e.getBody())})),!0)}(e)},on=function(e){var t=D(W(e).split("")),n=k(t,(function(e,t){var n=e.toUpperCase().charCodeAt(0)-"A".charCodeAt(0)+1;return Math.pow(26,t)*n}));return A(n,(function(e,t){return e+t}),0)},an=function(e){if(--e<0)return"";var t=e%26,n=Math.floor(e/26);return an(n)+String.fromCharCode("A".charCodeAt(0)+t)},cn=function(e){var t,n,r=nt(e);Fe(r)&&e.windowManager.open({title:"List Properties",body:{type:"panel",items:[{type:"input",name:"start",label:"Start list at number",inputMode:"numeric"}]},initialData:{start:(t={start:e.dom.getAttrib(r,"start","1"),listStyleType:C.some(e.dom.getStyle(r,"list-style-type"))},n=parseInt(t.start,10),lt(t.listStyleType,"upper-alpha")?an(n):lt(t.listStyleType,"lower-alpha")?an(n).toLowerCase():t.start)},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],onSubmit:function(t){(function(e){switch(function(e){return/^[0-9]+$/.test(e)?2:function(e){return/^[A-Z]+$/.test(e)}(e)?0:function(e){return/^[a-z]+$/.test(e)}(e)?1:function(e){return e.length>0}(e)?4:3}(e)){case 2:return C.some({listStyleType:C.none(),start:e});case 0:return C.some({listStyleType:C.some("upper-alpha"),start:on(e).toString()});case 1:return C.some({listStyleType:C.some("lower-alpha"),start:on(e).toString()});case 3:return C.some({listStyleType:C.none(),start:""});case 4:return C.none()}})(t.getData().start).each((function(t){e.execCommand("mceListUpdate",!1,{attrs:{start:"1"===t.start?"":t.start},styles:{"list-style-type":t.listStyleType.getOr("")}})})),t.close()}})},un=function(e,t){return function(){var n=nt(e);return n&&n.nodeName===t}},ln=function(e){e.addCommand("mceListProps",(function(){cn(e)}))},sn=function(e){e.on("BeforeExecCommand",(function(t){var n=t.command.toLowerCase();"indent"===n?Nt(e):"outdent"===n&&Rt(e)})),e.addCommand("InsertUnorderedList",(function(t,n){Kt(e,"UL",n)})),e.addCommand("InsertOrderedList",(function(t,n){Kt(e,"OL",n)})),e.addCommand("InsertDefinitionList",(function(t,n){Kt(e,"DL",n)})),e.addCommand("RemoveList",(function(){Dt(e)})),ln(e),e.addCommand("mceListUpdate",(function(t,n){a(n)&&function(e,t){var n=nt(e);e.undoManager.transact((function(){a(t.styles)&&e.dom.setStyles(n,t.styles),a(t.attrs)&&de(t.attrs,(function(t,r){return e.dom.setAttrib(n,r,t)}))}))}(e,n)})),e.addQueryStateHandler("InsertUnorderedList",un(e,"UL")),e.addQueryStateHandler("InsertOrderedList",un(e,"OL")),e.addQueryStateHandler("InsertDefinitionList",un(e,"DL"))},fn=function(e){(function(e){return e.getParam("lists_indent_on_tab",!0)})(e)&&function(e){e.on("keydown",(function(t){t.keyCode!==se.TAB||se.metaKeyPressed(t)||e.undoManager.transact((function(){(t.shiftKey?Rt(e):Nt(e))&&t.preventDefault()}))}))}(e),function(e){e.on("keydown",(function(t){t.keyCode===se.BACKSPACE?rn(e,!1)&&t.preventDefault():t.keyCode===se.DELETE&&rn(e,!0)&&t.preventDefault()}))}(e)};n.add("lists",(function(e){return!1===e.hasPlugin("rtc",!0)?(fn(e),sn(e)):ln(e),function(e){var t=function(t){return function(){return e.execCommand(t)}};e.hasPlugin("advlist")||(e.ui.registry.addToggleButton("numlist",{icon:"ordered-list",active:!1,tooltip:"Numbered list",onAction:t("InsertOrderedList"),onSetup:function(t){return Ft(e,"OL",t.setActive)}}),e.ui.registry.addToggleButton("bullist",{icon:"unordered-list",active:!1,tooltip:"Bullet list",onAction:t("InsertUnorderedList"),onSetup:function(t){return Ft(e,"UL",t.setActive)}}))}(e),function(e){var t={text:"List properties...",icon:"ordered-list",onAction:function(){return e.execCommand("mceListProps")},onSetup:function(t){return Ft(e,"OL",(function(e){return t.setDisabled(!e)}))}};e.ui.registry.addMenuItem("listprops",t),e.ui.registry.addContextMenu("lists",{update:function(t){var n=nt(e,t);return Fe(n)?["listprops"]:[]}})}(e),function(e){return{backspaceDelete:function(t){rn(e,t)}}}(e)}))}()},"./node_modules/tinymce/plugins/paste/index.js":function(e,t,n){n("./node_modules/tinymce/plugins/paste/plugin.js")},"./node_modules/tinymce/plugins/paste/plugin.js":function(e,t){!function(){"use strict";var e,t,n,r,o,i=function(e){var t=e;return{get:function(){return t},set:function(e){t=e}}},a=tinymce.util.Tools.resolve("tinymce.PluginManager"),c=(e="array",function(t){return r=typeof(n=t),(null===n?"null":"object"===r&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"===r&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":r)===e;var n,r}),u=function(e){return!function(e){return null==e}(e)},l=function(e){return function(t){return typeof t===e}}("function"),s=function(){},f=function(e){return function(){return e}},d=function(e){return e},m=f(!1),p=f(!0),g=function(){return h},h={fold:function(e,t){return e()},isSome:m,isNone:p,getOr:n=d,getOrThunk:t=function(e){return e()},getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:f(null),getOrUndefined:f(void 0),or:n,orThunk:t,map:g,each:s,bind:g,exists:m,forall:p,filter:function(){return g()},toArray:function(){return[]},toString:f("none()")},v=function(e){var t=f(e),n=function(){return o},r=function(t){return t(e)},o={fold:function(t,n){return n(e)},isSome:p,isNone:m,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:n,orThunk:n,map:function(t){return v(t(e))},each:function(t){t(e)},bind:r,exists:r,forall:r,filter:function(t){return t(e)?o:h},toArray:function(){return[e]},toString:function(){return"some("+e+")"}};return o},b={some:v,none:g,from:function(e){return null==e?h:v(e)}},y=Array.prototype.slice,w=Array.prototype.push,C=function(e,t){for(var n=0,r=e.length;n<r;n++){if(t(e[n],n))return!0}return!1},x=function(e,t){for(var n=e.length,r=new Array(n),o=0;o<n;o++){var i=e[o];r[o]=t(i,o)}return r},S=function(e,t){for(var n=0,r=e.length;n<r;n++){t(e[n],n)}},k=function(e,t){return function(e){for(var t=[],n=0,r=e.length;n<r;++n){if(!c(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);w.apply(t,e[n])}return t}(x(e,t))},T=l(Array.from)?Array.from:function(e){return y.call(e)},E=function(){return(E=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},A=function(){var e=function(e){var t=i(b.none()),n=function(){return t.get().each(e)};return{clear:function(){n(),t.set(b.none())},isSet:function(){return t.get().isSome()},get:function(){return t.get()},set:function(e){n(),t.set(b.some(e))}}}(s);return E(E({},e),{on:function(t){return e.get().each(t)}})},_=function(e,t,n){return""===t||e.length>=t.length&&e.substr(n,n+t.length)===t},N=tinymce.util.Tools.resolve("tinymce.Env"),R=tinymce.util.Tools.resolve("tinymce.util.Delay"),D=tinymce.util.Tools.resolve("tinymce.util.Promise"),O=tinymce.util.Tools.resolve("tinymce.util.VK"),I=function(e,t){return e.fire("PastePlainTextToggle",{state:t})},P=tinymce.util.Tools.resolve("tinymce.util.Tools"),B=function(e){return e.getParam("paste_data_images",!1)},M=function(e){return e.getParam("paste_merge_formats",!0)},L=function(e){return e.getParam("paste_retain_style_properties")},F=function(e){return e.getParam("validate")},j=function(e){return e.getParam("allow_html_data_urls",!1,"boolean")},H=function(e){return e.getParam("paste_data_images",!1,"boolean")},U=function(e){return P.explode(e.getParam("images_file_types","jpeg,jpg,jpe,jfi,jif,jfif,png,gif,bmp,webp","string"))},z=function(e){return-1!==e.indexOf("\x3c!-- x-tinymce/html --\x3e")},W=f("x-tinymce/html"),V=Object.hasOwnProperty,q=function(e,t){return V.call(e,t)},$=tinymce.util.Tools.resolve("tinymce.html.Entities"),K=function(e,t,n){var r=e.split(/\n\n/),o=function(e,t){var n=[],r="<"+e;if("object"==typeof t){for(var o in t)q(t,o)&&n.push(o+'="'+$.encodeAllRaw(t[o])+'"');n.length&&(r+=" "+n.join(" "))}return r+">"}(t,n),i="</"+t+">",a=P.map(r,(function(e){return e.split(/\n/).join("<br />")}));return 1===a.length?a[0]:P.map(a,(function(e){return o+e+i})).join("")},G=tinymce.util.Tools.resolve("tinymce.html.DomParser"),J=tinymce.util.Tools.resolve("tinymce.html.Serializer"),X=tinymce.util.Tools.resolve("tinymce.html.Node"),Y=tinymce.util.Tools.resolve("tinymce.html.Schema"),Q=function(e,t){return P.each(t,(function(t){e=t.constructor===RegExp?e.replace(t,""):e.replace(t[0],t[1])})),e},Z=function(e){return e=Q(e,[/^[\s\S]*<body[^>]*>\s*|\s*<\/body[^>]*>[\s\S]*$/gi,/<!--StartFragment-->|<!--EndFragment-->/g,[/( ?)<span class="Apple-converted-space">\u00a0<\/span>( ?)/g,function(e,t,n){return t||n?"":" "}],/<br class="Apple-interchange-newline">/g,/<br>$/i])},ee=function(e){return/<font face="Times New Roman"|class="?Mso|style="[^"]*\bmso-|style='[^']*\bmso-|w:WordDocument/i.test(e)||/class="OutlineElement/.test(e)||/id="?docs\-internal\-guid\-/.test(e)},te=function(e){var t=!1;return e=e.replace(/^[\u00a0 ]+/,""),P.each([/^[IVXLMCD]+\.[ \u00a0]/,/^[ivxlmcd]+\.[ \u00a0]/,/^[a-z]{1,2}[\.\)][ \u00a0]/,/^[A-Z]{1,2}[\.\)][ \u00a0]/,/^[0-9]+\.[ \u00a0]/,/^[\u3007\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d]+\.[ \u00a0]/,/^[\u58f1\u5f10\u53c2\u56db\u4f0d\u516d\u4e03\u516b\u4e5d\u62fe]+\.[ \u00a0]/],(function(n){if(n.test(e))return t=!0,!1})),t},ne=function(e,t,n,r){var o={},i=e.dom.parseStyle(r);P.each(i,(function(i,a){switch(a){case"mso-list":var c=/\w+ \w+([0-9]+)/i.exec(r);c&&(n._listLevel=parseInt(c[1],10)),/Ignore/i.test(i)&&n.firstChild&&(n._listIgnore=!0,n.firstChild._listIgnore=!0);break;case"horiz-align":a="text-align";break;case"vert-align":a="vertical-align";break;case"font-color":case"mso-foreground":a="color";break;case"mso-background":case"mso-highlight":a="background";break;case"font-weight":case"font-style":return void("normal"!==i&&(o[a]=i));case"mso-element":if(/^(comment|comment-list)$/i.test(i))return void n.remove()}0!==a.indexOf("mso-comment")?0!==a.indexOf("mso-")&&("all"===L(e)||t&&t[a])&&(o[a]=i):n.remove()})),/(bold)/i.test(o["font-weight"])&&(delete o["font-weight"],n.wrap(new X("b",1))),/(italic)/i.test(o["font-style"])&&(delete o["font-style"],n.wrap(new X("i",1)));var a=e.dom.serializeStyle(o,n.name);return a||null},re=function(e,t){var n,r=L(e);r&&(n=P.makeMap(r.split(/[, ]/))),t=Q(t,[/<br class="?Apple-interchange-newline"?>/gi,/<b[^>]+id="?docs-internal-[^>]*>/gi,/<!--[\s\S]+?-->/gi,/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|img|meta|link|style|\w:\w+)(?=[\s\/>]))[^>]*>/gi,[/<(\/?)s>/gi,"<$1strike>"],[/&nbsp;/gi,""],[/<span\s+style\s*=\s*"\s*mso-spacerun\s*:\s*yes\s*;?\s*"\s*>([\s\u00a0]*)<\/span>/gi,function(e,t){return t.length>0?t.replace(/./," ").slice(Math.floor(t.length/2)).split("").join(""):""}]]);var o=function(e){return e.getParam("paste_word_valid_elements","-strong/b,-em/i,-u,-span,-p,-ol,-ul,-li,-h1,-h2,-h3,-h4,-h5,-h6,-p/div,-a[href|name],sub,sup,strike,br,del,table[width],tr,td[colspan|rowspan|width],th[colspan|rowspan|width],thead,tfoot,tbody")}(e),i=Y({valid_elements:o,valid_children:"-li[p]"});P.each(i.elements,(function(e){e.attributes.class||(e.attributes.class={},e.attributesOrder.push("class")),e.attributes.style||(e.attributes.style={},e.attributesOrder.push("style"))}));var a=G({},i);a.addAttributeFilter("style",(function(t){for(var r,o=t.length;o--;)(r=t[o]).attr("style",ne(e,n,r,r.attr("style"))),"span"===r.name&&r.parent&&!r.attributes.length&&r.unwrap()})),a.addAttributeFilter("class",(function(e){for(var t,n,r=e.length;r--;)n=(t=e[r]).attr("class"),/^(MsoCommentReference|MsoCommentText|msoDel)$/i.test(n)&&t.remove(),t.attr("class",null)})),a.addNodeFilter("del",(function(e){for(var t=e.length;t--;)e[t].remove()})),a.addNodeFilter("a",(function(e){for(var t,n,r,o=e.length;o--;)if(n=(t=e[o]).attr("href"),r=t.attr("name"),n&&-1!==n.indexOf("#_msocom_"))t.remove();else if(n&&0===n.indexOf("file://")&&(n=n.split("#")[1])&&(n="#"+n),n||r){if(r&&!/^_?(?:toc|edn|ftn)/i.test(r)){t.unwrap();continue}t.attr({href:n,name:r})}else t.unwrap()}));var c=a.parse(t);return function(e){return e.getParam("paste_convert_word_fake_lists",!0)}(e)&&function(e){for(var t,n,r=1,o=function(e){var t="";if(3===e.type)return e.value;if(e=e.firstChild)do{t+=o(e)}while(e=e.next);return t},i=function(e,t){if(3===e.type&&t.test(e.value))return e.value=e.value.replace(t,""),!1;if(e=e.firstChild)do{if(!i(e,t))return!1}while(e=e.next);return!0},a=function(e){if(e._listIgnore)e.remove();else if(e=e.firstChild)do{a(e)}while(e=e.next)},c=function(e,o,c){var u=e._listLevel||r;u!==r&&(u<r?t&&(t=t.parent.parent):(n=t,t=null)),t&&t.name===o?t.append(e):(n=n||t,t=new X(o,1),c>1&&t.attr("start",""+c),e.wrap(t)),e.name="li",u>r&&n&&n.lastChild.append(t),r=u,a(e),i(e,/^\u00a0+/),i(e,/^\s*([\u2022\u00b7\u00a7\u25CF]|\w+\.)/),i(e,/^\u00a0+/)},u=[],l=e.firstChild;null!=l;)if(u.push(l),null!==(l=l.walk()))for(;void 0!==l&&l.parent!==e;)l=l.walk();for(var s=0;s<u.length;s++)if("p"===(e=u[s]).name&&e.firstChild){var f=o(e);if(/^[\s\u00a0]*[\u2022\u00b7\u00a7\u25CF]\s*/.test(f)){c(e,"ul");continue}if(te(f)){var d=/([0-9]+)\./.exec(f),m=1;d&&(m=parseInt(d[1],10)),c(e,"ol",m);continue}if(e._listLevel){c(e,"ul",1);continue}t=null}else n=t,t=null}(c),t=J({validate:F(e)},i).serialize(c)},oe=function(e,t){return{content:e,cancelled:t}},ie=function(e,t,n,r){var o=function(e,t,n,r){return e.fire("PastePreProcess",{content:t,internal:n,wordContent:r})}(e,t,n,r),i=function(e,t){var n=G({},e.schema);n.addNodeFilter("meta",(function(e){P.each(e,(function(e){e.remove()}))}));var r=n.parse(t,{forced_root_block:!1,isRootContent:!0});return J({validate:F(e)},e.schema).serialize(r)}(e,o.content);return e.hasEventListeners("PastePostProcess")&&!o.isDefaultPrevented()?function(e,t,n,r){var o=e.dom.create("div",{style:"display:none"},t),i=function(e,t,n,r){return e.fire("PastePostProcess",{node:t,internal:n,wordContent:r})}(e,o,n,r);return oe(i.node.innerHTML,i.isDefaultPrevented())}(e,i,n,r):oe(i,o.isDefaultPrevented())},ae=function(e,t,n){var r=ee(t),o=r?function(e,t){return function(e){return e.getParam("paste_enable_default_filters",!0)}(e)?re(e,t):t}(e,t):t;return ie(e,o,n,r)},ce=function(e,t){return e.insertContent(t,{merge:M(e),paste:!0}),!0},ue=function(e){return/^https?:\/\/[\w\?\-\/+=.&%@~#]+$/i.test(e)},le=function(e,t){return ue(t)&&C(U(e),(function(e){return n=t.toLowerCase(),r="."+e.toLowerCase(),_(n,r,n.length-r.length);var n,r}))},se=function(e,t,n){return!(!1!==e.selection.isCollapsed()||!ue(t))&&function(e,t,n){return e.undoManager.extra((function(){n(e,t)}),(function(){e.execCommand("mceInsertLink",!1,t)})),!0}(e,t,n)},fe=function(e,t,n){return!!le(e,t)&&function(e,t,n){return e.undoManager.extra((function(){n(e,t)}),(function(){e.insertContent('<img src="'+t+'">')})),!0}(e,t,n)},de=function(e,t,n){n||!1===function(e){return e.getParam("smart_paste",!0)}(e)?ce(e,t):function(e,t){P.each([se,fe,ce],(function(n){return!0!==n(e,t,ce)}))}(e,t)},me=function(e){return"\n"===e||"\r"===e},pe=function(e,t){var n,r,o=(n=" ",(r=function(e){return e.getParam("paste_tab_spaces",4,"number")}(e))<=0?"":new Array(r+1).join(n)),i=t.replace(/\t/g,o);return function(e,t,n){return S(e,(function(e,r){n=t(n,e,r)})),n}(i,(function(e,t){return function(e){return-1!==" \f\t\v".indexOf(e)}(t)||""===t?e.pcIsSpace||""===e.str||e.str.length===i.length-1||function(e,t){return t<e.length&&t>=0&&me(e[t])}(i,e.str.length+1)?{pcIsSpace:!1,str:e.str+""}:{pcIsSpace:!0,str:e.str+" "}:{pcIsSpace:me(t),str:e.str+t}}),{pcIsSpace:!1,str:""}).str},ge=function(e,t,n,r){var o=ae(e,t,n);!1===o.cancelled&&de(e,o.content,r)},he=function(e,t,n){var r=n||z(t);ge(e,function(e){return e.replace("\x3c!-- x-tinymce/html --\x3e","")}(t),r,!1)},ve=function(e,t){var n=e.dom.encode(t).replace(/\r\n/g,"\n"),r=function(e,t,n){return t?K(e,!0===t?"p":t,n):function(e){return e.replace(/\r?\n/g,"<br>")}(e)}(pe(e,n),function(e){return e.getParam("forced_root_block")}(e),function(e){return e.getParam("forced_root_block_attrs")}(e));ge(e,r,!1,!0)},be=function(e){var t={};if(e){if(e.getData){var n=e.getData("Text");n&&n.length>0&&-1===n.indexOf("data:text/mce-internal,")&&(t["text/plain"]=n)}if(e.types)for(var r=0;r<e.types.length;r++){var o=e.types[r];try{t[o]=e.getData(o)}catch(e){t[o]=""}}}return t},ye=function(e,t){return t in e&&e[t].length>0},we=function(e){return ye(e,"text/html")||ye(e,"text/plain")},Ce=(r="mceclip",o=0,function(){return r+o++}),xe=function(e,t){var n,r,o=(n=t.uri,(r=/data:([^;]+);base64,([a-z0-9\+\/=]+)/i.exec(n))?{type:r[1],data:decodeURIComponent(r[2])}:{type:null,data:null}),i=o.data,a=o.type,c=Ce(),l=t.blob,s=new Image;if(s.src=t.uri,function(e,t){var n=function(e){return e.getParam("images_dataimg_filter")}(e);return!n||n(t)}(e,s)){var f=e.editorUpload.blobCache,d=void 0,m=f.getByData(i,a);if(m)d=m;else{var p=function(e){return e.getParam("images_reuse_filename")}(e)&&u(l.name),g=p?function(e,t){var n=t.match(/([\s\S]+?)(?:\.[a-z0-9.]+)$/i);return u(n)?e.dom.encode(n[1]):null}(e,l.name):c,h=p?l.name:void 0;d=f.create(c,l,i,g,h),f.add(d)}he(e,'<img src="'+d.blobUri()+'">',!1)}else he(e,'<img src="'+t.uri+'">',!1)},Se=function(e){return D.all(x(e,(function(e){return new D((function(t){var n=function(e){return u(e.getAsFile)}(e)?e.getAsFile():e,r=new window.FileReader;r.onload=function(){t({blob:n,uri:r.result})},r.readAsDataURL(n)}))})))},ke=function(e){var t=U(e);return function(e){return function(e,t){return _(e,t,0)}(e.type,"image/")&&C(t,(function(t){return n=t.toLowerCase(),r={jpg:"jpeg",jpe:"jpeg",jfi:"jpeg",jif:"jpeg",jfif:"jpeg",pjpeg:"jpeg",pjp:"jpeg",svg:"svg+xml"},(P.hasOwn(r,n)?"image/"+r[n]:"image/"+n)===e.type;var n,r}))}},Te=function(e,t,n){var r="paste"===t.type?t.clipboardData:t.dataTransfer;if(H(e)&&r){var o=function(e,t){var n=t.items?k(T(t.items),(function(e){return"file"===e.kind?[e.getAsFile()]:[]})):[],r=t.files?T(t.files):[];return function(e,t){for(var n=[],r=0,o=e.length;r<o;r++){var i=e[r];t(i,r)&&n.push(i)}return n}(n.length>0?n:r,ke(e))}(e,r);if(o.length>0)return t.preventDefault(),Se(o).then((function(t){n&&e.selection.setRng(n),S(t,(function(t){xe(e,t)}))})),!0}return!1},Ee=function(e){return O.metaKeyPressed(e)&&86===e.keyCode||e.shiftKey&&45===e.keyCode},Ae=function(e,t,n){var r,o=A(),i=A();e.on("keyup",i.clear),e.on("keydown",(function(n){var a=function(e){Ee(e)&&!e.isDefaultPrevented()&&t.remove()};if(Ee(n)&&!n.isDefaultPrevented()){if((r=n.shiftKey&&86===n.keyCode)&&N.webkit&&-1!==navigator.userAgent.indexOf("Version/"))return;if(n.stopImmediatePropagation(),o.set(n),i.set(!0),N.ie&&r)return n.preventDefault(),void function(e,t){e.fire("paste",{ieFake:t})}(e,!0);t.remove(),t.create(),e.once("keyup",a),e.once("paste",(function(){e.off("keyup",a)}))}}));var a=function(e,n,r,o,i){var a;ye(n,"text/html")?a=n["text/html"]:(a=t.getHtml(),i=i||z(a),t.isDefaultContent(a)&&(o=!0)),a=Z(a),t.remove();var c=!1===i&&!/<(?:\/?(?!(?:div|p|br|span)>)\w+|(?:(?!(?:span style="white-space:\s?pre;?">)|br\s?\/>))\w+\s[^>]+)>/i.test(a),u=ue(a);(!a.length||c&&!u)&&(o=!0),(o||u)&&(a=ye(n,"text/plain")&&c?n["text/plain"]:function(e){var t=Y(),n=G({},t),r="",o=t.getShortEndedElements(),i=P.makeMap("script noscript style textarea video audio iframe object"," "),a=t.getBlockElements(),c=function(e){var t=e.name,n=e;if("br"!==t){if("wbr"!==t)if(o[t]&&(r+=" "),i[t])r+=" ";else{if(3===e.type&&(r+=e.value),!e.shortEnded&&(e=e.firstChild))do{c(e)}while(e=e.next);a[t]&&n.next&&(r+="\n","p"===t&&(r+="\n"))}}else r+="\n"};return e=Q(e,[/<!\[[^\]]+\]>/g]),c(n.parse(e)),r}(a)),t.isDefaultContent(a)?r||e.windowManager.alert("Please use Ctrl+V/Cmd+V keyboard shortcuts to paste contents."):o?ve(e,a):he(e,a,i)};e.on("paste",(function(c){var u=o.isSet()||i.isSet();u&&o.clear();var l=function(e,t){return be(t.clipboardData||e.getDoc().dataTransfer)}(e,c),s="text"===n.get()||r,f=ye(l,W());r=!1,c.isDefaultPrevented()||function(e){var t=e.clipboardData;return-1!==navigator.userAgent.indexOf("Android")&&t&&t.items&&0===t.items.length}(c)?t.remove():we(l)||!Te(e,c,t.getLastRng()||e.selection.getRng())?(u||c.preventDefault(),!N.ie||u&&!c.ieFake||ye(l,"text/html")||(t.create(),e.dom.bind(t.getEl(),"paste",(function(e){e.stopPropagation()})),e.getDoc().execCommand("Paste",!1,null),l["text/html"]=t.getHtml()),ye(l,"text/html")?(c.preventDefault(),f||(f=z(l["text/html"])),a(e,l,u,s,f)):R.setEditorTimeout(e,(function(){a(e,l,u,s,f)}),0)):t.remove()}))},_e=function(e){return N.ie&&e.inline?document.body:e.getBody()},Ne=function(e,t,n){(function(e){return _e(e)!==e.getBody()})(e)&&e.dom.bind(t,"paste keyup",(function(t){Oe(e,n)||e.fire("paste")}))},Re=function(e){return e.dom.get("mcepastebin")},De=function(e,t){return t===e},Oe=function(e,t){var n,r=Re(e);return(n=r)&&"mcepastebin"===n.id&&De(t,r.innerHTML)},Ie=function(e){var t=i(null);return{create:function(){return function(e,t,n){var r=e.dom,o=e.getBody();t.set(e.selection.getRng());var i=e.dom.add(_e(e),"div",{id:"mcepastebin",class:"mce-pastebin",contentEditable:!0,"data-mce-bogus":"all",style:"position: fixed; top: 50%; width: 10px; height: 10px; overflow: hidden; opacity: 0"},n);(N.ie||N.gecko)&&r.setStyle(i,"left","rtl"===r.getStyle(o,"direction",!0)?65535:-65535),r.bind(i,"beforedeactivate focusin focusout",(function(e){e.stopPropagation()})),Ne(e,i,n),i.focus(),e.selection.select(i,!0)}(e,t,"%MCEPASTEBIN%")},remove:function(){return function(e,t){if(Re(e)){for(var n=void 0,r=t.get();n=e.dom.get("mcepastebin");)e.dom.remove(n),e.dom.unbind(n);r&&e.selection.setRng(r)}t.set(null)}(e,t)},getEl:function(){return Re(e)},getHtml:function(){return function(e){var t=function(t,n){t.appendChild(n),e.dom.remove(n,!0)},n=P.grep(_e(e).childNodes,(function(e){return"mcepastebin"===e.id})),r=n.shift();P.each(n,(function(e){t(r,e)}));for(var o=e.dom.select("div[id=mcepastebin]",r),i=o.length-1;i>=0;i--){var a=e.dom.create("div");r.insertBefore(a,o[i]),t(a,o[i])}return r?r.innerHTML:""}(e)},getLastRng:t.get,isDefault:function(){return Oe(e,"%MCEPASTEBIN%")},isDefaultContent:function(e){return De("%MCEPASTEBIN%",e)}}},Pe=function(e,t){var n=Ie(e);return e.on("PreInit",(function(){return function(e,t,n){var r;Ae(e,t,n),e.parser.addNodeFilter("img",(function(t,n,o){var i=function(e){e.attr("data-mce-object")||r===N.transparentSrc||e.remove()},a=function(e){return 0===e.indexOf("webkit-fake-url")},c=function(e){return 0===e.indexOf("data:")};if(!H(e)&&function(e){return e.data&&!0===e.data.paste}(o))for(var u=t.length;u--;)(r=t[u].attr("src"))&&(a(r)||!j(e)&&c(r))&&i(t[u])}))}(e,n,t)})),{pasteFormat:t,pasteHtml:function(t,n){return he(e,t,n)},pasteText:function(t){return ve(e,t)},pasteImageData:function(t,n){return Te(e,t,n)},getDataTransferItems:be,hasHtmlOrText:we,hasContentType:ye}},Be=function(e,t){e.addCommand("mceTogglePlainTextPaste",(function(){!function(e,t){"text"===t.pasteFormat.get()?(t.pasteFormat.set("html"),I(e,!1)):(t.pasteFormat.set("text"),I(e,!0)),e.focus()}(e,t)})),e.addCommand("mceInsertClipboardContent",(function(e,n){n.content&&t.pasteHtml(n.content,n.internal),n.text&&t.pasteText(n.text)}))},Me=function(e,t,n){if(!function(e){return!1===N.iOS&&"function"==typeof(null==e?void 0:e.setData)}(e))return!1;try{return e.clearData(),e.setData("text/html",t),e.setData("text/plain",n),e.setData(W(),t),!0}catch(e){return!1}},Le=function(e,t,n,r){Me(e.clipboardData,t.html,t.text)?(e.preventDefault(),r()):n(t.html,r)},Fe=function(e){return function(t,n){var r=function(e){return"\x3c!-- x-tinymce/html --\x3e"+e}(t),o=e.dom.create("div",{contenteditable:"false","data-mce-bogus":"all"}),i=e.dom.create("div",{contenteditable:"true"},r);e.dom.setStyles(o,{position:"fixed",top:"0",left:"-3000px",width:"1000px",overflow:"hidden"}),o.appendChild(i),e.dom.add(e.getBody(),o);var a=e.selection.getRng();i.focus();var c=e.dom.createRng();c.selectNodeContents(i),e.selection.setRng(c),R.setTimeout((function(){e.selection.setRng(a),o.parentNode.removeChild(o),n()}),0)}},je=function(e){return{html:e.selection.getContent({contextual:!0}),text:e.selection.getContent({format:"text"})}},He=function(e){return!e.selection.isCollapsed()||function(e){return!!e.dom.getParent(e.selection.getStart(),"td[data-mce-selected],th[data-mce-selected]",e.getBody())}(e)},Ue=function(e){e.on("cut",function(e){return function(t){He(e)&&Le(t,je(e),Fe(e),(function(){if(N.browser.isChrome()||N.browser.isFirefox()){var t=e.selection.getRng();R.setEditorTimeout(e,(function(){e.selection.setRng(t),e.execCommand("Delete")}),0)}else e.execCommand("Delete")}))}}(e)),e.on("copy",function(e){return function(t){He(e)&&Le(t,je(e),Fe(e),s)}}(e))},ze=tinymce.util.Tools.resolve("tinymce.dom.RangeUtils"),We=function(e,t){return ze.getCaretRangeFromPoint(t.clientX,t.clientY,e.getDoc())},Ve=function(e,t){e.focus(),e.selection.setRng(t)},qe=function(e,t){e.on("PastePreProcess",(function(n){n.content=t(e,n.content,n.internal,n.wordContent)}))},$e=function(e,t){if(!ee(t))return t;var n=[];P.each(e.schema.getBlockElements(),(function(e,t){n.push(t)}));var r=new RegExp("(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*(<\\/?("+n.join("|")+")[^>]*>)(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*","g");return t=Q(t,[[r,"$1"]]),t=Q(t,[[/<br><br>/g,"<BR><BR>"],[/<br>/g," "],[/<BR><BR>/g,"<br>"]])},Ke=function(e,t,n,r){if(r||n)return t;var o,i=function(e){return e.getParam("paste_webkit_styles")}(e);if(!1===function(e){return e.getParam("paste_remove_styles_if_webkit",!0)}(e)||"all"===i)return t;if(i&&(o=i.split(/[, ]/)),o){var a=e.dom,c=e.selection.getNode();t=t.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,(function(e,t,n,r){var i=a.parseStyle(a.decode(n)),u={};if("none"===o)return t+r;for(var l=0;l<o.length;l++){var s=i[o[l]],f=a.getStyle(c,o[l],!0);/color/.test(o[l])&&(s=a.toHex(s),f=a.toHex(f)),f!==s&&(u[o[l]]=s)}var d=a.serializeStyle(u,"span");return d?t+' style="'+d+'"'+r:t+r}))}else t=t.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,"$1$3");return t=t.replace(/(<[^>]+) data-mce-style="([^"]+)"([^>]*>)/gi,(function(e,t,n,r){return t+' style="'+n+'"'+r}))},Ge=function(e,t){e.$("a",t).find("font,u").each((function(t,n){e.dom.remove(n,!0)}))},Je=function(e,t){return function(n){n.setActive("text"===t.pasteFormat.get());var r=function(e){return n.setActive(e.state)};return e.on("PastePlainTextToggle",r),function(){return e.off("PastePlainTextToggle",r)}}};a.add("paste",(function(e){if(!1===function(e){return!!e.hasPlugin("powerpaste",!0)&&(void 0!==window.console&&window.console.log&&window.console.log("PowerPaste is incompatible with Paste plugin! Remove 'paste' from the 'plugins' option."),!0)}(e)){var t=i(!1),n=i(function(e){return e.getParam("paste_as_text",!1)}(e)?"text":"html"),r=Pe(e,n);return function(e){N.webkit&&qe(e,Ke),N.ie&&(qe(e,$e),function(e,t){e.on("PastePostProcess",(function(n){t(e,n.node)}))}(e,Ge))}(e),function(e,t){var n=function(){return e.execCommand("mceTogglePlainTextPaste")};e.ui.registry.addToggleButton("pastetext",{active:!1,icon:"paste-text",tooltip:"Paste as text",onAction:n,onSetup:Je(e,t)}),e.ui.registry.addToggleMenuItem("pastetext",{text:"Paste as text",icon:"paste-text",onAction:n,onSetup:Je(e,t)})}(e,r),Be(e,r),function(e){var t=e.plugins.paste,n=function(e){return e.getParam("paste_preprocess")}(e);n&&e.on("PastePreProcess",(function(e){n.call(t,t,e)}));var r=function(e){return e.getParam("paste_postprocess")}(e);r&&e.on("PastePostProcess",(function(e){r.call(t,t,e)}))}(e),Ue(e),function(e,t,n){(function(e){return e.getParam("paste_block_drop",!1)})(e)&&e.on("dragend dragover draggesture dragdrop drop drag",(function(e){e.preventDefault(),e.stopPropagation()})),B(e)||e.on("drop",(function(e){var t=e.dataTransfer;t&&t.files&&t.files.length>0&&e.preventDefault()})),e.on("drop",(function(r){var o=We(e,r);if(!r.isDefaultPrevented()&&!n.get()){var i,a=t.getDataTransferItems(r.dataTransfer),c=t.hasContentType(a,W());if((t.hasHtmlOrText(a)&&(!(i=a["text/plain"])||0!==i.indexOf("file://"))||!t.pasteImageData(r,o))&&o&&function(e){return e.getParam("paste_filter_drop",!0)}(e)){var u=a["mce-internal"]||a["text/html"]||a["text/plain"];u&&(r.preventDefault(),R.setEditorTimeout(e,(function(){e.undoManager.transact((function(){a["mce-internal"]&&e.execCommand("Delete"),Ve(e,o),u=Z(u),a["text/html"]?t.pasteHtml(u,c):t.pasteText(u)}))})))}}})),e.on("dragstart",(function(e){n.set(!0)})),e.on("dragover dragend",(function(t){B(e)&&!1===n.get()&&(t.preventDefault(),Ve(e,We(e,t))),"dragend"===t.type&&n.set(!1)}))}(e,r,t),function(e){return{clipboard:e}}(r)}}))}()},"./node_modules/tinymce/plugins/table/index.js":function(e,t,n){n("./node_modules/tinymce/plugins/table/plugin.js")},"./node_modules/tinymce/plugins/table/plugin.js":function(e,t){!function(){"use strict";var e=function(e){return function(t){return r=typeof(n=t),(null===n?"null":"object"===r&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"===r&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":r)===e;var n,r}},t=function(e){return function(t){return typeof t===e}},n=function(e){return function(t){return e===t}},r=e("string"),o=e("object"),i=e("array"),a=n(null),c=t("boolean"),u=n(void 0),l=function(e){return!function(e){return null==e}(e)},s=t("function"),f=t("number"),d=function(){},m=function(e){return function(){return e}},p=function(e){return e},g=function(e,t){return e===t};function h(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var o=t.concat(n);return e.apply(null,o)}}var v,b,y=function(e){return function(t){return!e(t)}},w=m(!1),C=m(!0),x=function(){return S},S={fold:function(e,t){return e()},isSome:w,isNone:C,getOr:b=p,getOrThunk:v=function(e){return e()},getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:m(null),getOrUndefined:m(void 0),or:b,orThunk:v,map:x,each:d,bind:x,exists:w,forall:C,filter:function(){return x()},toArray:function(){return[]},toString:m("none()")},k=function(e){var t=m(e),n=function(){return o},r=function(t){return t(e)},o={fold:function(t,n){return n(e)},isSome:C,isNone:w,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:n,orThunk:n,map:function(t){return k(t(e))},each:function(t){t(e)},bind:r,exists:r,forall:r,filter:function(t){return t(e)?o:S},toArray:function(){return[e]},toString:function(){return"some("+e+")"}};return o},T={some:k,none:x,from:function(e){return null==e?S:k(e)}},E=Array.prototype.slice,A=Array.prototype.indexOf,_=Array.prototype.push,N=function(e,t){return n=e,r=t,A.call(n,r)>-1;var n,r},R=function(e,t){for(var n=0,r=e.length;n<r;n++){if(t(e[n],n))return!0}return!1},D=function(e,t){for(var n=[],r=0;r<e;r++)n.push(t(r));return n},O=function(e,t){for(var n=e.length,r=new Array(n),o=0;o<n;o++){var i=e[o];r[o]=t(i,o)}return r},I=function(e,t){for(var n=0,r=e.length;n<r;n++){t(e[n],n)}},P=function(e,t){for(var n=[],r=[],o=0,i=e.length;o<i;o++){var a=e[o];(t(a,o)?n:r).push(a)}return{pass:n,fail:r}},B=function(e,t){for(var n=[],r=0,o=e.length;r<o;r++){var i=e[r];t(i,r)&&n.push(i)}return n},M=function(e,t,n){return function(e,t){for(var n=e.length-1;n>=0;n--){t(e[n],n)}}(e,(function(e,r){n=t(n,e,r)})),n},L=function(e,t,n){return I(e,(function(e,r){n=t(n,e,r)})),n},F=function(e,t){return function(e,t,n){for(var r=0,o=e.length;r<o;r++){var i=e[r];if(t(i,r))return T.some(i);if(n(i,r))break}return T.none()}(e,t,w)},j=function(e,t){for(var n=0,r=e.length;n<r;n++){if(t(e[n],n))return T.some(n)}return T.none()},H=function(e){for(var t=[],n=0,r=e.length;n<r;++n){if(!i(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);_.apply(t,e[n])}return t},U=function(e,t){return H(O(e,t))},z=function(e,t){for(var n=0,r=e.length;n<r;++n){if(!0!==t(e[n],n))return!1}return!0},W=function(e,t){for(var n={},r=0,o=e.length;r<o;r++){var i=e[r];n[String(i)]=t(i,r)}return n},V=function(e){return[e]},q=function(e,t){return t>=0&&t<e.length?T.some(e[t]):T.none()},$=function(e){return q(e,0)},K=function(e){return q(e,e.length-1)},G=function(e,t){for(var n=0;n<e.length;n++){var r=t(e[n],n);if(r.isSome())return r}return T.none()},J=function(){return(J=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function X(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}var Y=function(e){var t,n=!1;return function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return n||(n=!0,t=e.apply(null,r)),t}},Q=function(){return Z(0,0)},Z=function(e,t){return{major:e,minor:t}},ee={nu:Z,detect:function(e,t){var n=String(t).toLowerCase();return 0===e.length?Q():function(e,t){var n=function(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(r.test(t))return r}}(e,t);if(!n)return{major:0,minor:0};var r=function(e){return Number(t.replace(n,"$"+e))};return Z(r(1),r(2))}(e,n)},unknown:Q},te=function(e,t){var n=String(t).toLowerCase();return F(e,(function(e){return e.search(n)}))},ne=function(e,t,n){return""===t||e.length>=t.length&&e.substr(n,n+t.length)===t},re=function(e,t){return-1!==e.indexOf(t)},oe=function(e,t){return ne(e,t,0)},ie=function(e,t){return ne(e,t,e.length-t.length)},ae=function(e){return function(t){return t.replace(e,"")}}(/^\s+|\s+$/g),ce=function(e){return e.length>0},ue=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,le=function(e){return function(t){return re(t,e)}},se=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(e){return re(e,"edge/")&&re(e,"chrome")&&re(e,"safari")&&re(e,"applewebkit")}},{name:"Chrome",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,ue],search:function(e){return re(e,"chrome")&&!re(e,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(e){return re(e,"msie")||re(e,"trident")}},{name:"Opera",versionRegexes:[ue,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:le("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:le("firefox")},{name:"Safari",versionRegexes:[ue,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(e){return(re(e,"safari")||re(e,"mobile/"))&&re(e,"applewebkit")}}],fe=[{name:"Windows",search:le("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(e){return re(e,"iphone")||re(e,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:le("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:le("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:le("linux"),versionRegexes:[]},{name:"Solaris",search:le("sunos"),versionRegexes:[]},{name:"FreeBSD",search:le("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:le("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],de={browsers:m(se),oses:m(fe)},me=function(e){var t=e.current,n=e.version,r=function(e){return function(){return t===e}};return{current:t,version:n,isEdge:r("Edge"),isChrome:r("Chrome"),isIE:r("IE"),isOpera:r("Opera"),isFirefox:r("Firefox"),isSafari:r("Safari")}},pe={unknown:function(){return me({current:void 0,version:ee.unknown()})},nu:me,edge:m("Edge"),chrome:m("Chrome"),ie:m("IE"),opera:m("Opera"),firefox:m("Firefox"),safari:m("Safari")},ge=function(e){var t=e.current,n=e.version,r=function(e){return function(){return t===e}};return{current:t,version:n,isWindows:r("Windows"),isiOS:r("iOS"),isAndroid:r("Android"),isOSX:r("OSX"),isLinux:r("Linux"),isSolaris:r("Solaris"),isFreeBSD:r("FreeBSD"),isChromeOS:r("ChromeOS")}},he={unknown:function(){return ge({current:void 0,version:ee.unknown()})},nu:ge,windows:m("Windows"),ios:m("iOS"),android:m("Android"),linux:m("Linux"),osx:m("OSX"),solaris:m("Solaris"),freebsd:m("FreeBSD"),chromeos:m("ChromeOS")},ve=function(e,t,n){var r=de.browsers(),o=de.oses(),i=t.bind((function(e){return function(e,t){return G(t.brands,(function(t){var n=t.brand.toLowerCase();return F(e,(function(e){var t;return n===(null===(t=e.brand)||void 0===t?void 0:t.toLowerCase())})).map((function(e){return{current:e.name,version:ee.nu(parseInt(t.version,10),0)}}))}))}(r,e)})).orThunk((function(){return function(e,t){return te(e,t).map((function(e){var n=ee.detect(e.versionRegexes,t);return{current:e.name,version:n}}))}(r,e)})).fold(pe.unknown,pe.nu),a=function(e,t){return te(e,t).map((function(e){var n=ee.detect(e.versionRegexes,t);return{current:e.name,version:n}}))}(o,e).fold(he.unknown,he.nu),c=function(e,t,n,r){var o=e.isiOS()&&!0===/ipad/i.test(n),i=e.isiOS()&&!o,a=e.isiOS()||e.isAndroid(),c=a||r("(pointer:coarse)"),u=o||!i&&a&&r("(min-device-width:768px)"),l=i||a&&!u,s=t.isSafari()&&e.isiOS()&&!1===/safari/i.test(n),f=!l&&!u&&!s;return{isiPad:m(o),isiPhone:m(i),isTablet:m(u),isPhone:m(l),isTouch:m(c),isAndroid:e.isAndroid,isiOS:e.isiOS,isWebView:m(s),isDesktop:m(f)}}(a,i,e,n);return{browser:i,os:a,deviceType:c}},be=function(e){return window.matchMedia(e).matches},ye=Y((function(){return ve(navigator.userAgent,T.from(navigator.userAgentData),be)})),we=function(){return ye()},Ce=function(e){if(null==e)throw new Error("Node cannot be null or undefined");return{dom:e}},xe={fromHtml:function(e,t){var n=(t||document).createElement("div");if(n.innerHTML=e,!n.hasChildNodes()||n.childNodes.length>1)throw console.error("HTML does not have a single root node",e),new Error("HTML must have a single root node");return Ce(n.childNodes[0])},fromTag:function(e,t){var n=(t||document).createElement(e);return Ce(n)},fromText:function(e,t){var n=(t||document).createTextNode(e);return Ce(n)},fromDom:Ce,fromPoint:function(e,t,n){return T.from(e.dom.elementFromPoint(t,n)).map(Ce)}},Se=function(e,t){var n=e.dom;if(1!==n.nodeType)return!1;var r=n;if(void 0!==r.matches)return r.matches(t);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(t);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(t);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")},ke=function(e){return 1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType||0===e.childElementCount},Te=function(e,t){var n=void 0===t?document:t.dom;return ke(n)?T.none():T.from(n.querySelector(e)).map(xe.fromDom)},Ee=function(e,t){return e.dom===t.dom},Ae=function(e,t){return n=e.dom,r=t.dom,function(e,t,n){return 0!=(e.compareDocumentPosition(t)&n)}(n,r,Node.DOCUMENT_POSITION_CONTAINED_BY);var n,r},_e=function(e,t){return we().browser.isIE()?Ae(e,t):function(e,t){var n=e.dom,r=t.dom;return n!==r&&n.contains(r)}(e,t)},Ne=Se,Re=Object.keys,De=Object.hasOwnProperty,Oe=function(e,t){for(var n=Re(e),r=0,o=n.length;r<o;r++){var i=n[r];t(e[i],i)}},Ie=function(e,t){return Pe(e,(function(e,n){return{k:n,v:t(e,n)}}))},Pe=function(e,t){var n={};return Oe(e,(function(e,r){var o=t(e,r);n[o.k]=o.v})),n},Be=function(e,t){var n={};return function(e,t,n,r){Oe(e,(function(e,o){(t(e,o)?n:r)(e,o)}))}(e,t,function(e){return function(t,n){e[n]=t}}(n),d),n},Me=function(e,t){var n=[];return Oe(e,(function(e,r){n.push(t(e,r))})),n},Le=function(e){return Me(e,p)},Fe=function(e){return Re(e).length},je=function(e,t){return He(e,t)?T.from(e[t]):T.none()},He=function(e,t){return De.call(e,t)},Ue=function(e,t){return He(e,t)&&void 0!==e[t]&&null!==e[t]},ze=["tfoot","thead","tbody","colgroup"],We=function(e,t,n){return{element:e,rowspan:t,colspan:n}},Ve=function(e,t,n){return{element:e,cells:t,section:n}},qe=function(e,t,n){return{element:e,isNew:t,isLocked:n}},$e=function(e,t,n,r){return{element:e,cells:t,section:n,isNew:r}};"undefined"!=typeof window?window:Function("return this;")();var Ke=function(e){return e.dom.nodeName.toLowerCase()},Ge=function(e){return e.dom.nodeType},Je=function(e){return function(t){return Ge(t)===e}},Xe=function(e){return 8===Ge(e)||"#comment"===Ke(e)},Ye=Je(1),Qe=Je(3),Ze=Je(9),et=Je(11),tt=function(e){return function(t){return Ye(t)&&Ke(t)===e}},nt=function(e){return xe.fromDom(e.dom.ownerDocument)},rt=function(e){return Ze(e)?e:nt(e)},ot=function(e){return T.from(e.dom.parentNode).map(xe.fromDom)},it=function(e,t){for(var n=s(t)?t:w,r=e.dom,o=[];null!==r.parentNode&&void 0!==r.parentNode;){var i=r.parentNode,a=xe.fromDom(i);if(o.push(a),!0===n(a))break;r=i}return o},at=function(e){return T.from(e.dom.previousSibling).map(xe.fromDom)},ct=function(e){return T.from(e.dom.nextSibling).map(xe.fromDom)},ut=function(e){return O(e.dom.childNodes,xe.fromDom)},lt=function(e,t){var n=e.dom.childNodes;return T.from(n[t]).map(xe.fromDom)},st=s(Element.prototype.attachShadow)&&s(Node.prototype.getRootNode),ft=m(st),dt=st?function(e){return xe.fromDom(e.dom.getRootNode())}:rt,mt=function(e){var t,n=dt(e);return et(t=n)&&l(t.dom.host)?T.some(n):T.none()},pt=function(e){return xe.fromDom(e.dom.host)},gt=function(e){return l(e.dom.shadowRoot)},ht=function(e){var t=Qe(e)?e.dom.parentNode:e.dom;if(null==t||null===t.ownerDocument)return!1;var n,r,o=t.ownerDocument;return mt(xe.fromDom(t)).fold((function(){return o.body.contains(t)}),(n=ht,r=pt,function(e){return n(r(e))}))},vt=function(e){var t=e.dom.body;if(null==t)throw new Error("Body is not available yet");return xe.fromDom(t)},bt=function(e,t){var n=[];return I(ut(e),(function(e){t(e)&&(n=n.concat([e])),n=n.concat(bt(e,t))})),n},yt=function(e,t,n){return function(e,t,n){return B(it(e,n),t)}(e,(function(e){return Se(e,t)}),n)},wt=function(e,t){return function(e,t){return B(ut(e),t)}(e,(function(e){return Se(e,t)}))},Ct=function(e,t){return function(e,t){var n=void 0===t?document:t.dom;return ke(n)?[]:O(n.querySelectorAll(e),xe.fromDom)}(t,e)};function xt(e,t,n,r,o){return e(n,r)?T.some(n):s(o)&&o(n)?T.none():t(n,r,o)}var St=function(e,t,n){for(var r=e.dom,o=s(n)?n:w;r.parentNode;){r=r.parentNode;var i=xe.fromDom(r);if(t(i))return T.some(i);if(o(i))break}return T.none()},kt=function(e,t,n){return St(e,(function(e){return Se(e,t)}),n)},Tt=function(e,t){return function(e,t){return F(e.dom.childNodes,(function(e){return t(xe.fromDom(e))})).map(xe.fromDom)}(e,(function(e){return Se(e,t)}))},Et=function(e,t){return Te(t,e)},At=function(e,t,n){return xt((function(e,t){return Se(e,t)}),kt,e,t,n)},_t=function(e,t,n){if(!(r(n)||c(n)||f(n)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",n,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(t,n+"")},Nt=function(e,t,n){_t(e.dom,t,n)},Rt=function(e,t){var n=e.dom;Oe(t,(function(e,t){_t(n,t,e)}))},Dt=function(e,t){var n=e.dom.getAttribute(t);return null===n?void 0:n},Ot=function(e,t){return T.from(Dt(e,t))},It=function(e,t){e.dom.removeAttribute(t)},Pt=function(e){return L(e.dom.attributes,(function(e,t){return e[t.name]=t.value,e}),{})},Bt=function(e,t,n){return void 0===n&&(n=g),e.exists((function(e){return n(e,t)}))},Mt=function(e){for(var t=[],n=function(e){t.push(e)},r=0;r<e.length;r++)e[r].each(n);return t},Lt=function(e,t,n){return e.isSome()&&t.isSome()?T.some(n(e.getOrDie(),t.getOrDie())):T.none()},Ft=function(e,t){return e?T.some(t):T.none()},jt=function(e){return void 0!==e.style&&s(e.style.getPropertyValue)},Ht=function(e,t,n){if(!r(n))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",n,":: Element ",e),new Error("CSS value must be a string: "+n);jt(e)&&e.style.setProperty(t,n)},Ut=function(e,t,n){var r=e.dom;Ht(r,t,n)},zt=function(e,t){var n=e.dom;Oe(t,(function(e,t){Ht(n,t,e)}))},Wt=function(e,t){var n=e.dom,r=window.getComputedStyle(n).getPropertyValue(t);return""!==r||ht(e)?r:Vt(n,t)},Vt=function(e,t){return jt(e)?e.style.getPropertyValue(t):""},qt=function(e,t){var n=e.dom,r=Vt(n,t);return T.from(r).filter((function(e){return e.length>0}))},$t=function(e,t){!function(e,t){jt(e)&&e.style.removeProperty(t)}(e.dom,t),Bt(Ot(e,"style").map(ae),"")&&It(e,"style")},Kt=function(e,t,n){return void 0===n&&(n=0),Ot(e,t).map((function(e){return parseInt(e,10)})).getOr(n)},Gt=function(e,t){return Kt(e,t,1)},Jt=function(e){return tt("col")(e)?Kt(e,"span",1)>1:Gt(e,"colspan")>1},Xt=function(e){return Gt(e,"rowspan")>1},Yt=function(e,t){return parseInt(Wt(e,t),10)},Qt=m(10),Zt=m(10),en=function(e,t){return tn(e,t,C)},tn=function(e,t,n){return U(ut(e),(function(e){return Se(e,t)?n(e)?[e]:[]:tn(e,t,n)}))},nn=function(e,t){return function(e,t,n){if(void 0===n&&(n=w),n(t))return T.none();if(N(e,Ke(t)))return T.some(t);return kt(t,e.join(","),(function(e){return Se(e,"table")||n(e)}))}(["td","th"],e,t)},rn=function(e){return en(e,"th,td")},on=function(e){return Se(e,"colgroup")?wt(e,"col"):U(un(e),(function(e){return wt(e,"col")}))},an=function(e,t){return At(e,"table",t)},cn=function(e){return en(e,"tr")},un=function(e){return an(e).fold(m([]),(function(e){return wt(e,"colgroup")}))},ln=function(e,t){return O(e,(function(e){if("colgroup"===Ke(e)){var n=O(on(e),(function(e){var t=Kt(e,"span",1);return We(e,1,t)}));return Ve(e,n,"colgroup")}n=O(rn(e),(function(e){var t=Kt(e,"rowspan",1),n=Kt(e,"colspan",1);return We(e,t,n)}));return Ve(e,n,t(e))}))},sn=function(e){return ot(e).map((function(e){var t=Ke(e);return function(e){return N(ze,e)}(t)?t:"tbody"})).getOr("tbody")},fn=function(e){var t=cn(e),n=X(X([],un(e),!0),t,!0);return ln(n,sn)},dn=function(e,t,n){var r=e.cells,o=r.slice(0,t),i=r.slice(t),a=o.concat(n).concat(i);return gn(e,a)},mn=function(e,t,n){return dn(e,t,[n])},pn=function(e,t,n){e.cells[t]=n},gn=function(e,t){return $e(e.element,t,e.section,e.isNew)},hn=function(e,t){return e.cells[t]},vn=function(e,t){return hn(e,t).element},bn=function(e){return e.cells.length},yn=function(e){var t=P(e,(function(e){return"colgroup"===e.section}));return{rows:t.fail,cols:t.pass}},wn=function(e,t,n){var r=O(e.cells,n);return $e(t(e.element),r,e.section,!0)},Cn="data-snooker-locked-cols",xn=function(e){return Ot(e,Cn).bind((function(e){return T.from(e.match(/\d+/g))})).map((function(e){return W(e,C)}))},Sn=function(e){var t=L(yn(e).rows,(function(e,t){return I(t.cells,(function(t,n){t.isLocked&&(e[n]=!0)})),e}),{});return function(e,t){var n=E.call(e,0);return n.sort(t),n}(Me(t,(function(e,t){return parseInt(t,10)})))},kn=function(e,t){return e+","+t},Tn=function(e,t){var n=U(e.all,(function(e){return e.cells}));return B(n,t)},En=function(e){var t={},n=[],r=$(e).map((function(e){return e.element})).bind(an).bind(xn).getOr({}),o=0,i=0,a=0,c=P(e,(function(e){return"colgroup"===e.section})),u=c.pass,l=c.fail;I(l,(function(e){var c=[];I(e.cells,(function(e){for(var n=0;void 0!==t[kn(a,n)];)n++;for(var o=Ue(r,n.toString()),u=function(e,t,n,r,o,i){return{element:e,rowspan:t,colspan:n,row:r,column:o,isLocked:i}}(e.element,e.rowspan,e.colspan,a,n,o),l=0;l<e.colspan;l++)for(var s=0;s<e.rowspan;s++){var f=n+l,d=kn(a+s,f);t[d]=u,i=Math.max(i,f+1)}c.push(u)})),o++,n.push(Ve(e.element,c,e.section)),a++}));var s=K(u).map((function(e){var t=function(e){var t={},n=0;return I(e.cells,(function(e){var r=e.colspan;D(r,(function(o){var i=n+o;t[i]=function(e,t,n){return{element:e,colspan:t,column:n}}(e.element,r,i)})),n+=r})),t}(e);return{colgroups:[function(e,t){return{element:e,columns:t}}(e.element,Le(t))],columns:t}})).getOrThunk((function(){return{colgroups:[],columns:{}}})),f=s.columns,d=s.colgroups;return{grid:function(e,t){return{rows:e,columns:t}}(o,i),access:t,all:n,columns:f,colgroups:d}},An={fromTable:function(e){var t=fn(e);return En(t)},generate:En,getAt:function(e,t,n){return T.from(e.access[kn(t,n)])},findItem:function(e,t,n){var r=Tn(e,(function(e){return n(t,e.element)}));return r.length>0?T.some(r[0]):T.none()},filterItems:Tn,justCells:function(e){return U(e.all,(function(e){return e.cells}))},justColumns:function(e){return Le(e.columns)},hasColumns:function(e){return Re(e.columns).length>0},getColumnAt:function(e,t){return T.from(e.columns[t])}},_n=function(e,t){var n=t.column,r=t.column+t.colspan-1,o=t.row,i=t.row+t.rowspan-1;return n<=e.finishCol&&r>=e.startCol&&o<=e.finishRow&&i>=e.startRow},Nn=function(e,t){return t.column>=e.startCol&&t.column+t.colspan-1<=e.finishCol&&t.row>=e.startRow&&t.row+t.rowspan-1<=e.finishRow},Rn=function(e,t,n){var r=An.findItem(e,t,Ee),o=An.findItem(e,n,Ee);return r.bind((function(e){return o.map((function(t){return n=e,r=t,o=Math.min(n.row,r.row),i=Math.min(n.column,r.column),a=Math.max(n.row+n.rowspan-1,r.row+r.rowspan-1),c=Math.max(n.column+n.colspan-1,r.column+r.colspan-1),{startRow:o,startCol:i,finishRow:a,finishCol:c};var n,r,o,i,a,c}))}))},Dn=function(e,t,n){return Rn(e,t,n).bind((function(t){return function(e,t){for(var n=!0,r=h(Nn,t),o=t.startRow;o<=t.finishRow;o++)for(var i=t.startCol;i<=t.finishCol;i++)n=n&&An.getAt(e,o,i).exists(r);return n?T.some(t):T.none()}(e,t)}))},On=function(e,t,n){return Rn(e,t,n).map((function(t){var n=An.filterItems(e,h(_n,t));return O(n,(function(e){return e.element}))}))},In=function(e,t){return An.findItem(e,t,(function(e,t){return _e(t,e)})).map((function(e){return e.element}))},Pn=function(e,t,n){return an(e).bind((function(r){return function(e,t,n,r){return An.findItem(e,t,Ee).bind((function(t){var o=n>0?t.row+t.rowspan-1:t.row,i=r>0?t.column+t.colspan-1:t.column;return An.getAt(e,o+n,i+r).map((function(e){return e.element}))}))}(Ln(r),e,t,n)}))},Bn=function(e,t,n){var r=Ln(e);return On(r,t,n)},Mn=function(e,t,n,r,o){var i=Ln(e),a=Ee(e,n)?T.some(t):In(i,t),c=Ee(e,o)?T.some(r):In(i,r);return a.bind((function(e){return c.bind((function(t){return On(i,e,t)}))}))},Ln=An.fromTable,Fn=function(e,t){ot(e).each((function(n){n.dom.insertBefore(t.dom,e.dom)}))},jn=function(e,t){ct(e).fold((function(){ot(e).each((function(e){Un(e,t)}))}),(function(e){Fn(e,t)}))},Hn=function(e,t){(function(e){return lt(e,0)})(e).fold((function(){Un(e,t)}),(function(n){e.dom.insertBefore(t.dom,n.dom)}))},Un=function(e,t){e.dom.appendChild(t.dom)},zn=function(e,t){Fn(e,t),Un(t,e)},Wn=function(e,t){I(t,(function(n,r){var o=0===r?e:t[r-1];jn(o,n)}))},Vn=function(e,t){I(t,(function(t){Un(e,t)}))},qn=function(e){e.dom.textContent="",I(ut(e),(function(e){$n(e)}))},$n=function(e){var t=e.dom;null!==t.parentNode&&t.parentNode.removeChild(t)},Kn=function(e){var t,n=ut(e);n.length>0&&(t=e,I(n,(function(e){Fn(t,e)}))),$n(e)},Gn=function(e,t){var n=function(t){return e(t)?T.from(t.dom.nodeValue):T.none()};return{get:function(r){if(!e(r))throw new Error("Can only get "+t+" value of a "+t+" node");return n(r).getOr("")},getOption:n,set:function(n,r){if(!e(n))throw new Error("Can only set raw "+t+" value of a "+t+" node");n.dom.nodeValue=r}}}(Qe,"text"),Jn=function(e){return Gn.get(e)},Xn=function(e){return Gn.getOption(e)},Yn=function(e,t){return Gn.set(e,t)},Qn=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"];function Zn(){return{up:m({selector:kt,closest:At,predicate:St,all:it}),down:m({selector:Ct,predicate:bt}),styles:m({get:Wt,getRaw:qt,set:Ut,remove:$t}),attrs:m({get:Dt,set:Nt,remove:It,copyTo:function(e,t){var n=Pt(e);Rt(t,n)}}),insert:m({before:Fn,after:jn,afterAll:Wn,append:Un,appendAll:Vn,prepend:Hn,wrap:zn}),remove:m({unwrap:Kn,remove:$n}),create:m({nu:xe.fromTag,clone:function(e){return xe.fromDom(e.dom.cloneNode(!1))},text:xe.fromText}),query:m({comparePosition:function(e,t){return e.dom.compareDocumentPosition(t.dom)},prevSibling:at,nextSibling:ct}),property:m({children:ut,name:Ke,parent:ot,document:function(e){return rt(e).dom},isText:Qe,isComment:Xe,isElement:Ye,isSpecial:function(e){var t=Ke(e);return N(["script","noscript","iframe","noframes","noembed","title","style","textarea","xmp"],t)},getLanguage:function(e){return Ye(e)?Ot(e,"lang"):T.none()},getText:Jn,setText:Yn,isBoundary:function(e){return!!Ye(e)&&("body"===Ke(e)||N(Qn,Ke(e)))},isEmptyTag:function(e){return!!Ye(e)&&N(["br","img","hr","input"],Ke(e))},isNonEditable:function(e){return Ye(e)&&"false"===Dt(e,"contenteditable")}}),eq:Ee,is:Ne}}var er,tr,nr=function(e,t,n,r){var o=t(e,n);return M(r,(function(n,r){var o=t(e,r);return rr(e,n,o)}),o)},rr=function(e,t,n){return t.bind((function(t){return n.filter(h(e.eq,t))}))},or=function(e,t,n){return n.length>0?function(e,t,n,r){return r(e,t,n[0],n.slice(1))}(e,t,n,nr):T.none()},ir=function(e,t,n,r){void 0===r&&(r=w);var o=[t].concat(e.up().all(t)),i=[n].concat(e.up().all(n)),a=function(e){return j(e,r).fold((function(){return e}),(function(t){return e.slice(0,t+1)}))},c=a(o),u=a(i),l=F(c,(function(t){return R(u,function(e,t){return h(e.eq,t)}(e,t))}));return{firstpath:c,secondpath:u,shared:l}},ar=Zn(),cr=function(e,t){return or(ar,(function(t,n){return e(n)}),t)},ur=function(e){return kt(e,"table")},lr=function(e,t,n){var r=function(e){return function(t){return void 0!==n&&n(t)||Ee(t,e)}};return Ee(e,t)?T.some({boxes:T.some([e]),start:e,finish:t}):ur(e).bind((function(o){return ur(t).bind((function(i){if(Ee(o,i))return T.some({boxes:Bn(o,e,t),start:e,finish:t});if(_e(o,i)){var a=(c=yt(t,"td,th",r(o))).length>0?c[c.length-1]:t;return T.some({boxes:Mn(o,e,o,t,i),start:e,finish:a})}if(_e(i,o)){var c,u=(c=yt(e,"td,th",r(i))).length>0?c[c.length-1]:e;return T.some({boxes:Mn(i,e,o,t,i),start:e,finish:u})}return function(e,t,n){return ir(ar,e,t,n)}(e,t).shared.bind((function(a){return At(a,"table",n).bind((function(n){var a=yt(t,"td,th",r(n)),c=a.length>0?a[a.length-1]:t,u=yt(e,"td,th",r(n)),l=u.length>0?u[u.length-1]:e;return T.some({boxes:Mn(n,e,o,t,i),start:l,finish:c})}))}))}))}))},sr=function(e,t){var n=Ct(e,t);return n.length>0?T.some(n):T.none()},fr=function(e,t,n){return Et(e,t).bind((function(t){return Et(e,n).bind((function(e){return cr(ur,[t,e]).map((function(n){return{first:t,last:e,table:n}}))}))}))},dr=function(e,t,n,r,o){return function(e,t){return F(e,(function(e){return Se(e,t)}))}(e,o).bind((function(e){return Pn(e,t,n).bind((function(e){return function(e,t){return kt(e,"table").bind((function(n){return Et(n,t).bind((function(t){return lr(t,e).bind((function(e){return e.boxes.map((function(t){return{boxes:t,start:e.start,finish:e.finish}}))}))}))}))}(e,r)}))}))},mr=function(e,t){return sr(e,t)},pr=function(e,t,n){return fr(e,t,n).bind((function(t){var n=function(t){return Ee(e,t)},r=kt(t.first,"thead,tfoot,tbody,table",n),o=kt(t.last,"thead,tfoot,tbody,table",n);return r.bind((function(e){return o.bind((function(n){return Ee(e,n)?function(e,t,n){var r=Ln(e);return Dn(r,t,n)}(t.table,t.first,t.last):T.none()}))}))}))},gr=function(e){if(!i(e))throw new Error("cases must be an array");if(0===e.length)throw new Error("there must be at least one case");var t=[],n={};return I(e,(function(r,o){var a=Re(r);if(1!==a.length)throw new Error("one and only one name per case");var c=a[0],u=r[c];if(void 0!==n[c])throw new Error("duplicate key detected:"+c);if("cata"===c)throw new Error("cannot have a case named cata (sorry)");if(!i(u))throw new Error("case arguments must be an array");t.push(c),n[c]=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var i=n.length;if(i!==u.length)throw new Error("Wrong number of arguments to case "+c+". Expected "+u.length+" ("+u+"), got "+i);var a=function(e){var r=Re(e);if(t.length!==r.length)throw new Error("Wrong number of arguments to match. Expected: "+t.join(",")+"\nActual: "+r.join(","));if(!z(t,(function(e){return N(r,e)})))throw new Error("Not all branches were specified when using match. Specified: "+r.join(", ")+"\nRequired: "+t.join(", "));return e[c].apply(null,n)};return{fold:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];if(t.length!==e.length)throw new Error("Wrong number of arguments to fold. Expected "+e.length+", got "+t.length);var i=t[o];return i.apply(null,n)},match:a,log:function(e){console.log(e,{constructors:t,constructor:c,params:n})}}}})),n},hr=gr([{none:[]},{multiple:["elements"]},{single:["element"]}]),vr=function(e,t,n,r){return e.fold(t,n,r)},br=hr.none,yr=hr.multiple,wr=hr.single,Cr=tinymce.util.Tools.resolve("tinymce.PluginManager"),xr=function(e,t){return xe.fromDom(e.dom.cloneNode(t))},Sr=function(e){return xr(e,!1)},kr=function(e){return xr(e,!0)},Tr=function(e,t){var n=xe.fromTag(t),r=Pt(e);return Rt(n,r),n},Er=function(e,t){var n=function(n){var r=t(n);if(r<=0||null===r){var o=Wt(n,e);return parseFloat(o)||0}return r},r=function(e,t){return L(t,(function(t,n){var r=Wt(e,n),o=void 0===r?0:parseInt(r,10);return isNaN(o)?t:t+o}),0)};return{set:function(t,n){if(!f(n)&&!n.match(/^[0-9]+$/))throw new Error(e+".set accepts only positive integer values. Value was "+n);var r=t.dom;jt(r)&&(r.style[e]=n+"px")},get:n,getOuter:n,aggregate:r,max:function(e,t,n){var o=r(e,n);return t>o?t-o:0}}},Ar=function(){var e=we().browser;return e.isIE()||e.isEdge()},_r=function(e,t){return function(e){var t=parseFloat(e);return isNaN(t)?T.none():T.some(t)}(e).getOr(t)},Nr=function(e,t,n){return _r(Wt(e,t),n)},Rr=function(e){return Wt(e,"box-sizing")},Dr=function(e,t,n,r){return t-Nr(e,"padding-"+n,0)-Nr(e,"padding-"+r,0)-Nr(e,"border-"+n+"-width",0)-Nr(e,"border-"+r+"-width",0)},Or=function(e,t){var n=e.dom,r=n.getBoundingClientRect().width||n.offsetWidth;return"border-box"===t?r:Dr(e,r,"left","right")},Ir=Er("width",(function(e){return e.dom.offsetWidth})),Pr=function(e){return Ir.get(e)},Br=function(e){return Ir.getOuter(e)},Mr=function(e){return Or(e,"content-box")},Lr=function(e){return Ar()?Or(e,Rr(e)):Nr(e,"width",e.dom.offsetWidth)},Fr=function(e,t){void 0===t&&(t=C);var n=e.grid,r=D(n.columns,p),o=D(n.rows,p);return O(r,(function(n){return jr((function(){return U(o,(function(t){return An.getAt(e,t,n).filter((function(e){return e.column===n})).toArray()}))}),(function(e){return 1===e.colspan&&t(e.element)}),(function(){return An.getAt(e,0,n)}))}))},jr=function(e,t,n){var r=e();return F(r,t).orThunk((function(){return T.from(r[0]).orThunk(n)})).map((function(e){return e.element}))},Hr=function(e){var t=e.grid,n=D(t.rows,p),r=D(t.columns,p);return O(n,(function(t){return jr((function(){return U(r,(function(n){return An.getAt(e,t,n).filter((function(e){return e.row===t})).fold(m([]),(function(e){return[e]}))}))}),(function(e){return 1===e.rowspan}),(function(){return An.getAt(e,t,0)}))}))},Ur=function(e,t){if(t<0||t>=e.length-1)return T.none();var n=e[t].fold((function(){var n=function(e){var t=E.call(e,0);return t.reverse(),t}(e.slice(0,t));return G(n,(function(e,t){return e.map((function(e){return{value:e,delta:t+1}}))}))}),(function(e){return T.some({value:e,delta:0})})),r=e[t+1].fold((function(){var n=e.slice(t+1);return G(n,(function(e,t){return e.map((function(e){return{value:e,delta:t+1}}))}))}),(function(e){return T.some({value:e,delta:1})}));return n.bind((function(e){return r.map((function(t){var n=t.delta+e.delta;return Math.abs(t.value-e.value)/n}))}))},zr=function(e,t){return function(n){return"rtl"===Wr(n)?t:e}},Wr=function(e){return"rtl"===Wt(e,"direction")?"rtl":"ltr"},Vr=Er("height",(function(e){var t=e.dom;return ht(e)?t.getBoundingClientRect().height:t.offsetHeight})),qr=function(e){return Vr.get(e)},$r=function(e){return Vr.getOuter(e)},Kr=function(e){return Ar()?function(e,t){var n=e.dom,r=n.getBoundingClientRect().height||n.offsetHeight;return"border-box"===t?r:Dr(e,r,"top","bottom")}(e,Rr(e)):Nr(e,"height",e.dom.offsetHeight)},Gr=function(e,t){return{left:e,top:t,translate:function(n,r){return Gr(e+n,t+r)}}},Jr=Gr,Xr=function(e,t){return void 0!==e?e:void 0!==t?t:0},Yr=function(e){var t=e.dom.ownerDocument,n=t.body,r=t.defaultView,o=t.documentElement;if(n===e.dom)return Jr(n.offsetLeft,n.offsetTop);var i=Xr(null==r?void 0:r.pageYOffset,o.scrollTop),a=Xr(null==r?void 0:r.pageXOffset,o.scrollLeft),c=Xr(o.clientTop,n.clientTop),u=Xr(o.clientLeft,n.clientLeft);return Qr(e).translate(a-u,i-c)},Qr=function(e){var t=e.dom,n=t.ownerDocument.body;return n===t?Jr(n.offsetLeft,n.offsetTop):ht(e)?function(e){var t=e.getBoundingClientRect();return Jr(t.left,t.top)}(t):Jr(0,0)},Zr=function(e,t){return{row:e,y:t}},eo=function(e,t){return{col:e,x:t}},to=function(e){return Yr(e).left+Br(e)},no=function(e){return Yr(e).left},ro=function(e,t){return eo(e,no(t))},oo=function(e,t){return eo(e,to(t))},io=function(e){return Yr(e).top},ao=function(e,t){return Zr(e,io(t))},co=function(e,t){return Zr(e,io(t)+$r(t))},uo=function(e,t,n){if(0===n.length)return[];var r=O(n.slice(1),(function(t,n){return t.map((function(t){return e(n,t)}))})),o=n[n.length-1].map((function(e){return t(n.length-1,e)}));return r.concat([o])},lo={delta:p,positions:function(e){return uo(ao,co,e)},edge:io},so={delta:p,edge:no,positions:function(e){return uo(ro,oo,e)}},fo={delta:function(e){return-e},edge:to,positions:function(e){return uo(oo,ro,e)}},mo=zr(so,fo),po={delta:function(e,t){return mo(t).delta(e,t)},positions:function(e,t){return mo(t).positions(e,t)},edge:function(e){return mo(e).edge(e)}},go={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},ho=(er=function(e){return"(?:"+e+")?"},tr=["Infinity","[0-9]+\\."+er("[0-9]+")+er("[eE][+-]?[0-9]+"),"\\.[0-9]+"+er("[eE][+-]?[0-9]+"),"[0-9]+"+er("[eE][+-]?[0-9]+")].join("|"),new RegExp("^([+-]?(?:"+tr+"))(.*)$")),vo=function(e,t){return T.from(ho.exec(e)).bind((function(e){var n=Number(e[1]),r=e[2];return function(e,t){return R(t,(function(t){return R(go[t],(function(t){return e===t}))}))}(r,t)?T.some({value:n,unit:r}):T.none()}))},bo=/(\d+(\.\d+)?)%/,yo=/(\d+(\.\d+)?)px|em/,wo=tt("col"),Co=function(e,t,n){var r,o=(r=e,T.from(r.dom.parentElement).map(xe.fromDom)).getOrThunk((function(){return vt(nt(e))}));return t(e)/n(o)*100},xo=function(e,t){Ut(e,"width",t+"px")},So=function(e,t){Ut(e,"width",t+"%")},ko=function(e,t){Ut(e,"height",t+"px")},To=function(e,t,n,r){var o=parseFloat(e);return ie(e,"%")&&"table"!==Ke(t)?function(e,t,n,r){var o=an(e).map((function(e){var r=n(e);return Math.floor(t/100*r)})).getOr(t);return r(e,o),o}(t,o,n,r):o},Eo=function(e){var t=function(e){return Kr(e)+"px"}(e);return t?To(t,e,qr,ko):qr(e)},Ao=function(e,t){return qt(e,t).orThunk((function(){return Ot(e,t).map((function(e){return e+"px"}))}))},_o=function(e){return Ao(e,"width")},No=function(e){return Co(e,Pr,Mr)},Ro=function(e){return wo(e)?Pr(e):Lr(e)},Do=function(e){return function(e,t,n){return n(e)/Gt(e,t)}(e,"rowspan",Eo)},Oo=function(e,t,n){Ut(e,"width",t+n)},Io=function(e){return Co(e,Pr,Mr)+"%"},Po=m(bo),Bo=tt("col"),Mo=function(e){return _o(e).getOrThunk((function(){return Ro(e)+"px"}))},Lo=function(e){return(t=e,Ao(t,"height")).getOrThunk((function(){return Do(e)+"px"}));var t},Fo=function(e,t,n,r,o,i){return e.filter(r).fold((function(){return i(Ur(n,t))}),(function(e){return o(e)}))},jo=function(e,t,n,r){var o=Fr(e),i=An.hasColumns(e)?function(e){return O(An.justColumns(e),(function(e){return T.from(e.element)}))}(e):o,a=[T.some(po.edge(t))].concat(O(po.positions(o,t),(function(e){return e.map((function(e){return e.x}))}))),c=y(Jt);return O(i,(function(e,t){return Fo(e,t,a,c,(function(e){if(function(e){var t=we().browser,n=t.isChrome()||t.isFirefox();return!Bo(e)||n}(e))return n(e);var i,u,l=(i=o[t],u=p,null!=i?u(i):T.none());return Fo(l,t,a,c,(function(e){return r(T.some(Pr(e)))}),r)}),r)}))},Ho=function(e){return e.map((function(e){return e+"px"})).getOr("")},Uo=function(e,t,n){return jo(e,t,Ro,(function(e){return e.getOrThunk(n.minCellWidth)}))},zo=function(e,t,n,r,o){var i=Hr(e),a=[T.some(n.edge(t))].concat(O(n.positions(i,t),(function(e){return e.map((function(e){return e.y}))})));return O(i,(function(e,t){return Fo(e,t,a,y(Xt),r,o)}))},Wo=function(e,t){return function(){return ht(e)?t(e):parseFloat(qt(e,"width").getOr("0"))}},Vo=function(e){var t=Wo(e,Pr),n=m(0);return{width:t,pixelWidth:t,getWidths:function(t,n){return Uo(t,e,n)},getCellDelta:n,singleColumnWidth:m([0]),minCellWidth:n,setElementWidth:d,adjustTableWidth:d,isRelative:!0,label:"none"}},qo=function(e){var t=Wo(e,(function(e){return parseFloat(Io(e))})),n=Wo(e,Pr);return{width:t,pixelWidth:n,getWidths:function(t,n){return function(e,t,n){return jo(e,t,No,(function(e){return e.fold((function(){return n.minCellWidth()}),(function(e){return e/n.pixelWidth()*100}))}))}(t,e,n)},getCellDelta:function(e){return e/n()*100},singleColumnWidth:function(e,t){return[100-e]},minCellWidth:function(){return Qt()/n()*100},setElementWidth:So,adjustTableWidth:function(n){var r=t();So(e,r+n/100*r)},isRelative:!0,label:"percent"}},$o=function(e){var t=Wo(e,Pr);return{width:t,pixelWidth:t,getWidths:function(t,n){return Uo(t,e,n)},getCellDelta:p,singleColumnWidth:function(e,t){return[Math.max(Qt(),e+t)-e]},minCellWidth:Qt,setElementWidth:xo,adjustTableWidth:function(n){var r=t()+n;xo(e,r)},isRelative:!1,label:"pixel"}},Ko=function(e){return _o(e).fold((function(){return Vo(e)}),(function(t){return function(e,t){return null!==Po().exec(t)?qo(e):$o(e)}(e,t)}))},Go=$o,Jo=qo,Xo=function(e,t,n){var r=e[n].element,o=xe.fromTag("td");Un(o,xe.fromTag("br")),(t?Un:Hn)(r,o)},Yo=function(e,t){var n=function(e){return Se(e.element,t)},r=kr(e),o=fn(r),i=Ko(e),a=An.generate(o),c=function(e,t){var n=e.grid.columns,r=e.grid.rows,o=n,i=0,a=0,c=[],u=[];return Oe(e.access,(function(e){if(c.push(e),t(e)){u.push(e);var n=e.row,l=n+e.rowspan-1,s=e.column,f=s+e.colspan-1;n<r?r=n:l>i&&(i=l),s<o?o=s:f>a&&(a=f)}})),function(e,t,n,r,o,i){return{minRow:e,minCol:t,maxRow:n,maxCol:r,allCells:o,selectedCells:i}}(r,o,i,a,c,u)}(a,n),u="th:not("+t+"),td:not("+t+")",l=tn(r,"th,td",(function(e){return Se(e,u)}));return I(l,$n),function(e,t,n,r){for(var o=t.grid.columns,i=t.grid.rows,a=0;a<i;a++)for(var c=!1,u=0;u<o;u++){if(!(a<n.minRow||a>n.maxRow||u<n.minCol||u>n.maxCol))An.getAt(t,a,u).filter(r).isNone()?Xo(e,c,a):c=!0}}(o,a,c,n),function(e,t,n,r){Oe(n.columns,(function(e){(e.column<t.minCol||e.column>t.maxCol)&&$n(e.element)}));var o=B(en(e,"tr"),(function(e){return 0===e.dom.childElementCount}));I(o,$n),t.minCol!==t.maxCol&&t.minRow!==t.maxRow||I(en(e,"th,td"),(function(e){It(e,"rowspan"),It(e,"colspan")})),It(e,Cn),It(e,"data-snooker-col-series"),Ko(e).adjustTableWidth(r)}(r,c,a,function(e,t,n,r){if(0===r.minCol&&t.grid.columns===r.maxCol+1)return 0;var o=Uo(t,e,n),i=L(o,(function(e,t){return e+t}),0),a=L(o.slice(r.minCol,r.maxCol+1),(function(e,t){return e+t}),0)/i*n.pixelWidth()-n.pixelWidth();return n.getCellDelta(a)}(e,An.fromTable(e),i,c)),r},Qo=function(e){return"img"===Ke(e)?1:Xn(e).fold((function(){return ut(e).length}),(function(e){return e.length}))},Zo=["img","br"],ei=function(e){return Xn(e).filter((function(e){return 0!==e.trim().length||e.indexOf("")>-1})).isSome()||N(Zo,Ke(e))},ti=function(e){return t=ei,(n=function(e){for(var r=0;r<e.childNodes.length;r++){var o=xe.fromDom(e.childNodes[r]);if(t(o))return T.some(o);var i=n(e.childNodes[r]);if(i.isSome())return i}return T.none()})(e.dom);var t,n},ni=function(e){return ri(e,ei)},ri=function(e,t){var n=function(e){for(var r=ut(e),o=r.length-1;o>=0;o--){var i=r[o];if(t(i))return T.some(i);var a=n(i);if(a.isSome())return a}return T.none()};return n(e)},oi={scope:["row","col"]},ii=function(e){return function(){var t=xe.fromTag("td",e.dom);return Un(t,xe.fromTag("br",e.dom)),t}},ai=function(e){return function(){return xe.fromTag("col",e.dom)}},ci=function(e){return function(){return xe.fromTag("colgroup",e.dom)}},ui=function(e){return function(){return xe.fromTag("tr",e.dom)}},li=function(e,t,n){var r=function(e,t){var n=Tr(e,t),r=ut(kr(e));return Vn(n,r),n}(e,t);return Oe(n,(function(e,t){null===e?It(r,t):Nt(r,t,e)})),r},si=function(e){return e},fi=function(e,t,n){var r=function(e,t){var n,r,o,i;n=e.element,r=t,o=n.dom,i=r.dom,jt(o)&&jt(i)&&(i.style.cssText=o.style.cssText),$t(t,"height"),1!==e.colspan&&$t(t,"width")};return{col:function(n){var o=xe.fromTag(Ke(n.element),t.dom);return r(n,o),e(n.element,o),o},colgroup:ci(t),row:ui(t),cell:function(o){var i=xe.fromTag(Ke(o.element),t.dom),a=n.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"]),c=a.length>0?function(e,t,n){return ti(e).map((function(r){var o=n.join(","),i=yt(r,o,(function(t){return Ee(t,e)}));return M(i,(function(e,t){var n=Sr(t);return It(n,"contenteditable"),Un(e,n),n}),t)})).getOr(t)}(o.element,i,a):i;return Un(c,xe.fromTag("br")),r(o,i),function(e,t){Oe(oi,(function(n,r){return Ot(e,r).filter((function(e){return N(n,e)})).each((function(e){return Nt(t,r,e)}))}))}(o.element,i),e(o.element,i),i},replace:li,colGap:ai(t),gap:ii(t)}},di=function(e){return{col:ai(e),colgroup:ci(e),row:ui(e),cell:ii(e),replace:si,colGap:ai(e),gap:ii(e)}},mi=function(e){return O(e,xe.fromDom)},pi=function(e){return xe.fromDom(e.getBody())},gi=function(e){return e.getBoundingClientRect().width},hi=function(e){return e.getBoundingClientRect().height},vi=function(e){return function(t){return Ee(t,pi(e))}},bi=function(e){return/^\d+(\.\d+)?$/.test(e)?e+"px":e},yi=function(e){It(e,"data-mce-style");var t=function(e){return It(e,"data-mce-style")};I(rn(e),t),I(on(e),t),I(cn(e),t)},wi=function(e){return xe.fromDom(e.selection.getStart())},Ci=function(e){return vr(e.get(),m([]),p,V)},xi=function(e){var t=function(e,t){return Ot(e,t).exists((function(e){return parseInt(e,10)>1}))},n=Ci(e);return n.length>0&&z(n,(function(e){return t(e,"rowspan")||t(e,"colspan")}))?T.some(n):T.none()},Si=function(e,t,n){return vr(t.get(),T.none,(function(t){return t.length<=1?T.none():pr(e,n.firstSelectedSelector,n.lastSelectedSelector).map((function(e){return{bounds:e,cells:t}}))}),T.none)},ki={selected:"data-mce-selected",selectedSelector:"td[data-mce-selected],th[data-mce-selected]",firstSelected:"data-mce-first-selected",firstSelectedSelector:"td[data-mce-first-selected],th[data-mce-first-selected]",lastSelected:"data-mce-last-selected",lastSelectedSelector:"td[data-mce-last-selected],th[data-mce-last-selected]"},Ti=function(e,t,n){return{element:n,mergable:Si(t,e,ki),unmergable:xi(e),selection:Ci(e)}},Ei=function(e){return function(t,n){var r,o=Ke(t),i="col"===o||"colgroup"===o?an(r=t).bind((function(e){return mr(e,ki.firstSelectedSelector)})).fold(m(r),(function(e){return e[0]})):t;return At(i,e,n)}},Ai=Ei("th,td,caption"),_i=Ei("th,td"),Ni=function(e){return Ci(e)},Ri=function(e,t,n){e.on("BeforeGetContent",(function(n){!0===n.selection&&vr(t.get(),d,(function(t){n.preventDefault(),function(e){return an(e[0]).map((function(e){var t=Yo(e,"[data-mce-selected]");return yi(t),[t]}))}(t).each((function(t){n.content="text"===n.format?function(e){return O(e,(function(e){return e.dom.innerText})).join("")}(t):function(e,t){return O(t,(function(t){return e.selection.serializer.serialize(t.dom,{})})).join("")}(e,t)}))}),d)})),e.on("BeforeSetContent",(function(r){if(!0===r.selection&&!0===r.paste){var o=Ni(t);$(o).each((function(t){an(t).each((function(o){var i,a,c,u=B((i=r.content,(c=(a||document).createElement("div")).innerHTML=i,ut(xe.fromDom(c))),(function(e){return"meta"!==Ke(e)})),l=tt("table");if(1===u.length&&l(u[0])){r.preventDefault();var s=xe.fromDom(e.getDoc()),f=di(s),d=function(e,t,n){return{element:e,clipboard:t,generators:n}}(t,u[0],f);n.pasteCells(o,d).each((function(){e.focus()}))}}))}))}}))},Di=gr([{none:[]},{only:["index"]},{left:["index","next"]},{middle:["prev","index","next"]},{right:["prev","index"]}]),Oi=J({},Di),Ii=function(e,t,n,r,o){var i=e.slice(0),a=function(e,t){return 0===e.length?Oi.none():1===e.length?Oi.only(0):0===t?Oi.left(0,1):t===e.length-1?Oi.right(t-1,t):t>0&&t<e.length-1?Oi.middle(t-1,t,t+1):Oi.none()}(e,t),c=m(O(i,m(0)));return a.fold(c,(function(e){return r.singleColumnWidth(i[e],n)}),(function(e,t){return o.calcLeftEdgeDeltas(i,e,t,n,r.minCellWidth(),r.isRelative)}),(function(e,t,a){return o.calcMiddleDeltas(i,e,t,a,n,r.minCellWidth(),r.isRelative)}),(function(e,t){return o.calcRightEdgeDeltas(i,e,t,n,r.minCellWidth(),r.isRelative)}))},Pi=function(e,t,n){for(var r=0,o=e;o<t;o++)r+=void 0!==n[o]?n[o]:0;return r},Bi=function(e,t){var n=An.justCells(e);return O(n,(function(e){var n=Pi(e.row,e.row+e.rowspan,t);return{element:e.element,height:n,rowspan:e.rowspan}}))},Mi=function(e,t){return An.hasColumns(e)?function(e,t){var n=An.justColumns(e);return O(n,(function(e,n){return{element:e.element,width:t[n],colspan:e.colspan}}))}(e,t):function(e,t){var n=An.justCells(e);return O(n,(function(e){var n=Pi(e.column,e.column+e.colspan,t);return{element:e.element,width:n,colspan:e.colspan}}))}(e,t)},Li=function(e,t,n){var r=Mi(e,t);I(r,(function(e){n.setElementWidth(e.element,e.width)}))},Fi=function(e,t,n,r,o){var i=An.fromTable(e),a=o.getCellDelta(t),c=o.getWidths(i,o),u=n===i.grid.columns-1,l=r.clampTableDelta(c,n,a,o.minCellWidth(),u),s=Ii(c,n,l,o,r),f=O(s,(function(e,t){return e+c[t]}));Li(i,f,o),r.resizeTable(o.adjustTableWidth,l,u)},ji=function(e,t,n,r){var o=An.fromTable(e),i=function(e,t,n){return zo(e,t,n,Do,(function(e){return e.getOrThunk(Zt)}))}(o,e,r),a=O(i,(function(e,r){return n===r?Math.max(t+e,Zt()):e})),c=Bi(o,a),u=function(e,t){return O(e.all,(function(e,n){return{element:e.element,height:t[n]}}))}(o,a);I(u,(function(e){ko(e.element,e.height)})),I(c,(function(e){ko(e.element,e.height)}));var l=M(a,(function(e,t){return e+t}),0);ko(e,l)},Hi=function(e){return O(e,m(0))},Ui=function(e,t,n,r,o){return o(e.slice(0,t)).concat(r).concat(o(e.slice(n)))},zi=function(e){return function(t,n,r,o){if(e(r)){var i=Math.max(o,t[n]-Math.abs(r)),a=Math.abs(i-t[n]);return r>=0?a:-a}return r}},Wi=zi((function(e){return e<0})),Vi=zi(C),qi=function(){var e=function(e,t,n,r){var o=(100+n)/100,i=Math.max(r,(e[t]+n)/o);return O(e,(function(e,n){return(n===t?i:e/o)-e}))},t=function(t,n,r,o,i,a){return a?e(t,n,o,i):function(e,t,n,r,o){var i=Wi(e,t,r,o);return Ui(e,t,n+1,[i,0],Hi)}(t,n,r,o,i)};return{resizeTable:function(e,t){return e(t)},clampTableDelta:Wi,calcLeftEdgeDeltas:t,calcMiddleDeltas:function(e,n,r,o,i,a,c){return t(e,r,o,i,a,c)},calcRightEdgeDeltas:function(t,n,r,o,i,a){if(a)return e(t,r,o,i);var c=Wi(t,r,o,i);return Hi(t.slice(0,r)).concat([c])},calcRedestributedWidths:function(e,t,n,r){if(r){var o=(t+n)/t,i=O(e,(function(e){return e/o}));return{delta:100*o-100,newSizes:i}}return{delta:n,newSizes:e}}}},$i=function(){var e=function(e,t,n,r,o){var i=Vi(e,r>=0?n:t,r,o);return Ui(e,t,n+1,[i,-i],Hi)};return{resizeTable:function(e,t,n){n&&e(t)},clampTableDelta:function(e,t,n,r,o){if(o){if(n>=0)return n;var i=L(e,(function(e,t){return e+t-r}),0);return Math.max(-i,n)}return Wi(e,t,n,r)},calcLeftEdgeDeltas:e,calcMiddleDeltas:function(t,n,r,o,i,a){return e(t,r,o,i,a)},calcRightEdgeDeltas:function(e,t,n,r,o,i){if(i)return Hi(e);var a=r/e.length;return O(e,m(a))},calcRedestributedWidths:function(e,t,n,r){return{delta:0,newSizes:e}}}},Ki=function(e,t){var n=T.from(e.dom.documentElement).map(xe.fromDom).getOr(e);return{parent:m(n),view:m(e),origin:m(Jr(0,0)),isResizable:t}},Gi=function(e,t,n){return{parent:m(t),view:m(e),origin:m(Jr(0,0)),isResizable:n}},Ji=gr([{invalid:["raw"]},{pixels:["value"]},{percent:["value"]}]),Xi=function(e,t,n){var r=n.substring(0,n.length-e.length),o=parseFloat(r);return r===o.toString()?t(o):Ji.invalid(n)},Yi=J(J({},Ji),{from:function(e){return ie(e,"%")?Xi("%",Ji.percent,e):ie(e,"px")?Xi("px",Ji.pixels,e):Ji.invalid(e)}}),Qi=function(e,t,n){return e.fold((function(){return t}),(function(e){return function(e,t,n){var r=n/t;return O(e,(function(e){return Yi.from(e).fold((function(){return e}),(function(e){return e*r+"px"}),(function(e){return e/100*n+"px"}))}))}(t,n,e)}),(function(e){return function(e,t){return O(e,(function(e){return Yi.from(e).fold((function(){return e}),(function(e){return e/t*100+"%"}),(function(e){return e+"%"}))}))}(t,n)}))},Zi=function(e,t,n){var r=Yi.from(n),o=z(e,(function(e){return"0px"===e}))?function(e,t){var n=e.fold((function(){return m("")}),(function(e){return m(e/t+"px")}),(function(){return m(100/t+"%")}));return D(t,n)}(r,e.length):Qi(r,e,t);return na(o)},ea=function(e,t){return 0===e.length?t:M(e,(function(e,t){return Yi.from(t).fold(m(0),p,p)+e}),0)},ta=function(e,t){return Yi.from(e).fold(m(e),(function(e){return e+t+"px"}),(function(e){return e+t+"%"}))},na=function(e){if(0===e.length)return e;var t=M(e,(function(e,t){var n=Yi.from(t).fold((function(){return{value:t,remainder:0}}),(function(e){return function(e,t){var n=Math.floor(e);return{value:n+t,remainder:e-n}}(e,"px")}),(function(e){return{value:e+"%",remainder:0}}));return{output:[n.value].concat(e.output),remainder:e.remainder+n.remainder}}),{output:[],remainder:0}),n=t.output;return n.slice(0,n.length-1).concat([ta(n[n.length-1],Math.round(t.remainder))])},ra=Yi.from,oa=function(e){return ra(e).fold(m("px"),m("px"),m("%"))},ia=function(e,t,n){var r=An.fromTable(e),o=r.all,i=An.justCells(r),a=An.justColumns(r);t.each((function(t){var n=oa(t),o=Pr(e),c=function(e,t){return jo(e,t,Mo,Ho)}(r,e),u=Zi(c,o,t);An.hasColumns(r)?function(e,t,n){I(t,(function(t,r){var o=ea([e[r]],Qt());Ut(t.element,"width",o+n)}))}(u,a,n):function(e,t,n){I(t,(function(t){var r=e.slice(t.column,t.colspan+t.column),o=ea(r,Qt());Ut(t.element,"width",o+n)}))}(u,i,n),Ut(e,"width",t)})),n.each((function(t){var n=oa(t),a=qr(e),c=function(e,t,n){return zo(e,t,n,Lo,Ho)}(r,e,lo);!function(e,t,n,r){I(n,(function(t){var n=e.slice(t.row,t.rowspan+t.row),o=ea(n,Zt());Ut(t.element,"height",o+r)})),I(t,(function(t,n){Ut(t.element,"height",e[n])}))}(Zi(c,a,t),o,i,n),Ut(e,"height",t)}))},aa=function(e){return _o(e).exists((function(e){return bo.test(e)}))},ca=function(e){return _o(e).exists((function(e){return yo.test(e)}))},ua=function(e){return _o(e).isNone()},la=function(e){return An.fromTable(e).grid},sa=function(e){var t=[];return{bind:function(e){if(void 0===e)throw new Error("Event bind error: undefined handler");t.push(e)},unbind:function(e){t=B(t,(function(t){return t!==e}))},trigger:function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var o={};I(e,(function(e,t){o[e]=n[t]})),I(t,(function(e){e(o)}))}}},fa=function(e){return{registry:Ie(e,(function(e){return{bind:e.bind,unbind:e.unbind}})),trigger:Ie(e,(function(e){return e.trigger}))}},da=function(e){return e.slice(0).sort()},ma=function(e,t,n){if(0===t.length)throw new Error("You must specify at least one required field.");var o;return function(e,t){if(!i(t))throw new Error("The "+e+" fields must be an array. Was: "+t+".");I(t,(function(t){if(!r(t))throw new Error("The value "+t+" in the "+e+" fields was not a string.")}))}("required",t),o=da(t),F(o,(function(e,t){return t<o.length-1&&e===o[t+1]})).each((function(e){throw new Error("The field: "+e+" occurs more than once in the combined fields: ["+o.join(", ")+"].")})),function(r){var o=Re(r);z(t,(function(e){return N(o,e)}))||function(e,t){throw new Error("All required keys ("+da(e).join(", ")+") were not specified. Specified keys were: "+da(t).join(", ")+".")}(t,o),e(t,o);var i=B(t,(function(e){return!n.validate(r[e],e)}));return i.length>0&&function(e,t){throw new Error("All values need to be of type: "+t+". Keys ("+da(e).join(", ")+") were not.")}(i,n.label),r}},pa=function(e,t){var n=B(t,(function(t){return!N(e,t)}));n.length>0&&function(e){throw new Error("Unsupported keys for object: "+da(e).join(", "))}(n)},ga=function(e){return function(e,t){return ma(e,t,{validate:s,label:"function"})}(pa,e)},ha=ga(["compare","extract","mutate","sink"]),va=ga(["element","start","stop","destroy"]),ba=ga(["forceDrop","drop","move","delayDrop"]),ya=function(){var e=T.none(),t=fa({move:sa(["info"])});return{onEvent:function(n,r){r.extract(n).each((function(n){(function(t,n){var r=e.map((function(e){return t.compare(e,n)}));return e=T.some(n),r})(r,n).each((function(e){t.trigger.move(e)}))}))},reset:function(){e=T.none()},events:t.registry}},wa=function(){var e,t=(e=fa({move:sa(["info"])}),{onEvent:d,reset:d,events:e.registry}),n=ya(),r=t;return{on:function(){r.reset(),r=n},off:function(){r.reset(),r=t},isOn:function(){return r===n},onEvent:function(e,t){r.onEvent(e,t)},events:n.events}},Ca=function(e,t,n){var r,o,i,c,u=!1,l=fa({start:sa([]),stop:sa([])}),s=wa(),f=function(){p.stop(),s.isOn()&&(s.off(),l.trigger.stop())},d=(r=f,o=200,i=null,{cancel:c=function(){a(i)||(clearTimeout(i),i=null)},throttle:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];c(),i=setTimeout((function(){i=null,r.apply(null,e)}),o)}});s.events.move.bind((function(n){t.mutate(e,n.info)}));var m=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];u&&e.apply(null,t)}},p=t.sink(ba({forceDrop:f,drop:m(f),move:m((function(e){d.cancel(),s.onEvent(e,t)})),delayDrop:m(d.throttle)}),n);return{element:p.element,go:function(e){p.start(e),s.on(),l.trigger.start()},on:function(){u=!0},off:function(){u=!1},destroy:function(){p.destroy()},events:l.registry}},xa=function(e){var t,n,r=xe.fromDom(function(e){if(ft()&&l(e.target)){var t=xe.fromDom(e.target);if(Ye(t)&&gt(t)&&e.composed&&e.composedPath){var n=e.composedPath();if(n)return $(n)}}return T.from(e.target)}(e).getOr(e.target)),o=function(){return e.stopPropagation()},i=function(){return e.preventDefault()},a=(t=i,n=o,function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return t(n.apply(null,e))});return function(e,t,n,r,o,i,a){return{target:e,x:t,y:n,stop:r,prevent:o,kill:i,raw:a}}(r,e.clientX,e.clientY,o,i,a,e)},Sa=function(e,t,n,r,o){var i=function(e,t){return function(n){e(n)&&t(xa(n))}}(n,r);return e.dom.addEventListener(t,i,o),{unbind:h(ka,e,t,i,o)}},ka=function(e,t,n,r){e.dom.removeEventListener(t,n,r)},Ta=C,Ea=function(e,t,n){return function(e,t,n,r){return Sa(e,t,n,r,!1)}(e,t,Ta,n)},Aa=xa,_a=function(e,t){var n=Dt(e,t);return void 0===n||""===n?[]:n.split(" ")},Na=function(e){return void 0!==e.dom.classList},Ra=function(e,t){return function(e,t,n){var r=_a(e,t).concat([n]);return Nt(e,t,r.join(" ")),!0}(e,"class",t)},Da=function(e,t){Na(e)?e.dom.classList.add(t):Ra(e,t)},Oa=function(e,t){return Na(e)&&e.dom.classList.contains(t)},Ia=function(e){var t=e.replace(/\./g,"-");return{resolve:function(e){return t+"-"+e}}},Pa=Ia("ephox-dragster"),Ba=Pa.resolve,Ma=ha({compare:function(e,t){return Jr(t.left-e.left,t.top-e.top)},extract:function(e){return T.some(Jr(e.x,e.y))},sink:function(e,t){var n=function(e){var t=J({layerClass:Ba("blocker")},e),n=xe.fromTag("div");Nt(n,"role","presentation"),zt(n,{position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"}),Da(n,Ba("blocker")),Da(n,t.layerClass);return{element:m(n),destroy:function(){$n(n)}}}(t),r=Ea(n.element(),"mousedown",e.forceDrop),o=Ea(n.element(),"mouseup",e.drop),i=Ea(n.element(),"mousemove",e.move),a=Ea(n.element(),"mouseout",e.delayDrop);return va({element:n.element,start:function(e){Un(e,n.element())},stop:function(){$n(n.element())},destroy:function(){n.destroy(),o.unbind(),i.unbind(),a.unbind(),r.unbind()}})},mutate:function(e,t){e.mutate(t.left,t.top)}}),La=function(e){return At(e,"[contenteditable]")},Fa=function(e,t){return void 0===t&&(t=!1),!we().browser.isIE()&&ht(e)?e.dom.isContentEditable:La(e).fold(m(t),(function(e){return"true"===ja(e)}))},ja=function(e){return e.dom.contentEditable},Ha=Ia("ephox-snooker"),Ua=Ha.resolve,za=function(){var e=fa({drag:sa(["xDelta","yDelta","target"])}),t=T.none(),n=function(){var e=fa({drag:sa(["xDelta","yDelta"])});return{mutate:function(t,n){e.trigger.drag(t,n)},events:e.registry}}();n.events.drag.bind((function(n){t.each((function(t){e.trigger.drag(n.xDelta,n.yDelta,t)}))}));return{assign:function(e){t=T.some(e)},get:function(){return t},mutate:n.mutate,events:e.registry}},Wa=Ua("resizer-bar"),Va=Ua("resizer-rows"),qa=Ua("resizer-cols"),$a=function(e){var t=Ct(e.parent(),"."+Wa);I(t,$n)},Ka=function(e,t,n){var r=e.origin();I(t,(function(t){t.each((function(t){var o=n(r,t);Da(o,Wa),Un(e.parent(),o)}))}))},Ga=function(e,t,n,r){Ka(e,t,(function(e,t){var o,i,a,c,u,l,s=(o=t.col,i=t.x-e.left,a=n.top-e.top,c=7,u=r,l=xe.fromTag("div"),zt(l,{position:"absolute",left:i-c/2+"px",top:a+"px",height:u+"px",width:c+"px"}),Rt(l,{"data-column":o,role:"presentation"}),l);return Da(s,qa),s}))},Ja=function(e,t,n,r){Ka(e,t,(function(e,t){var o=function(e,t,n,r,o){var i=xe.fromTag("div");return zt(i,{position:"absolute",left:t+"px",top:n-o/2+"px",height:o+"px",width:r+"px"}),Rt(i,{"data-row":e,role:"presentation"}),i}(t.row,n.left-e.left,t.y-e.top,r,7);return Da(o,Va),o}))},Xa=function(e,t,n,r,o){var i=Yr(n),a=t.isResizable,c=r.length>0?lo.positions(r,n):[],u=c.length>0?function(e,t){return U(e.all,(function(e,n){return t(e.element)?[n]:[]}))}(e,a):[],l=B(c,(function(e,t){return R(u,(function(e){return t===e}))}));Ja(t,l,i,Br(n));var s=o.length>0?po.positions(o,n):[],f=s.length>0?function(e,t){var n=[];return D(e.grid.columns,(function(r){An.getColumnAt(e,r).map((function(e){return e.element})).forall(t)&&n.push(r)})),B(n,(function(n){var r=An.filterItems(e,(function(e){return e.column===n}));return z(r,(function(e){return t(e.element)}))}))}(e,a):[],d=B(s,(function(e,t){return R(f,(function(e){return t===e}))}));Ga(t,d,i,$r(n))},Ya=function(e,t){if($a(e),e.isResizable(t)){var n=An.fromTable(t),r=Hr(n),o=Fr(n);Xa(n,e,t,r,o)}},Qa=function(e,t){var n=Ct(e.parent(),"."+Wa);I(n,t)},Za=function(e){Qa(e,(function(e){Ut(e,"display","none")}))},ec=function(e){Qa(e,(function(e){Ut(e,"display","block")}))},tc=Ua("resizer-bar-dragging"),nc=function(e){var t=za(),n=function(e,t){void 0===t&&(t={});var n=void 0!==t.mode?t.mode:Ma;return Ca(e,n,t)}(t,{}),r=T.none(),o=function(e,t){return T.from(Dt(e,t))};t.events.drag.bind((function(e){o(e.target,"data-row").each((function(t){var n=Yt(e.target,"top");Ut(e.target,"top",n+e.yDelta+"px")})),o(e.target,"data-column").each((function(t){var n=Yt(e.target,"left");Ut(e.target,"left",n+e.xDelta+"px")}))}));var i=function(e,t){return Yt(e,t)-Kt(e,"data-initial-"+t,0)};n.events.stop.bind((function(){t.get().each((function(t){r.each((function(n){o(t,"data-row").each((function(e){var r=i(t,"top");It(t,"data-initial-top"),s.trigger.adjustHeight(n,r,parseInt(e,10))})),o(t,"data-column").each((function(e){var r=i(t,"left");It(t,"data-initial-left"),s.trigger.adjustWidth(n,r,parseInt(e,10))})),Ya(e,n)}))}))}));var a=function(r,o){s.trigger.startAdjust(),t.assign(r),Nt(r,"data-initial-"+o,Yt(r,o)),Da(r,tc),Ut(r,"opacity","0.2"),n.go(e.parent())},c=Ea(e.parent(),"mousedown",(function(e){var t;t=e.target,Oa(t,Va)&&a(e.target,"top"),function(e){return Oa(e,qa)}(e.target)&&a(e.target,"left")})),u=function(t){return Ee(t,e.view())},l=Ea(e.view(),"mouseover",(function(t){var n;(n=t.target,At(n,"table",u).filter(Fa)).fold((function(){ht(t.target)&&$a(e)}),(function(t){r=T.some(t),Ya(e,t)}))})),s=fa({adjustHeight:sa(["table","delta","row"]),adjustWidth:sa(["table","delta","column"]),startAdjust:sa([])});return{destroy:function(){c.unbind(),l.unbind(),n.destroy(),$a(e)},refresh:function(t){Ya(e,t)},on:n.on,off:n.off,hideBars:h(Za,e),showBars:h(ec,e),events:s.registry}},rc=function(e,t,n){var r=lo,o=po,i=nc(e),a=fa({beforeResize:sa(["table","type"]),afterResize:sa(["table","type"]),startDrag:sa([])});return i.events.adjustHeight.bind((function(e){var t=e.table;a.trigger.beforeResize(t,"row");var n=r.delta(e.delta,t);ji(t,n,e.row,r),a.trigger.afterResize(t,"row")})),i.events.startAdjust.bind((function(e){a.trigger.startDrag()})),i.events.adjustWidth.bind((function(e){var r=e.table;a.trigger.beforeResize(r,"col");var i=o.delta(e.delta,r),c=n(r);Fi(r,i,e.column,t,c),a.trigger.afterResize(r,"col")})),{on:i.on,off:i.off,hideBars:i.hideBars,showBars:i.showBars,destroy:i.destroy,events:a.registry}},oc=function(e,t){return e.fire("newrow",{node:t})},ic=function(e,t){return e.fire("newcell",{node:t})},ac=function(e,t,n){e.fire("TableModified",J(J({},n),{table:t}))},cc={structure:!1,style:!0},uc={structure:!0,style:!1},lc={structure:!0,style:!0},sc={"border-collapse":"collapse",width:"100%"},fc=D(5,(function(e){var t=e+1+"px";return{title:t,value:t}})),dc=O(["Solid","Dotted","Dashed","Double","Groove","Ridge","Inset","Outset","None","Hidden"],(function(e){return{title:e,value:e.toLowerCase()}})),mc={border:"1"},pc=function(e){return e.getParam("table_sizing_mode","auto")},gc=function(e){return e.getParam("table_responsive_width")},hc=function(e){return e.getParam("table_border_widths",fc,"array")},vc=function(e){return e.getParam("table_border_styles",dc,"array")},bc=function(e){return e.getParam("table_default_attributes",mc,"object")},yc=function(e){return e.getParam("table_default_styles",function(e){var t;if(Ac(e)){var n=e.dom,r=null!==(t=n.getParent(e.selection.getStart(),n.isBlock))&&void 0!==t?t:e.getBody(),o=Mr(xe.fromDom(r));return J(J({},sc),{width:o+"px"})}return _c(e)?Be(sc,(function(e,t){return"width"!==t})):sc}(e),"object")},wc=function(e){return e.getParam("table_cell_advtab",!0,"boolean")},Cc=function(e){return e.getParam("table_row_advtab",!0,"boolean")},xc=function(e){return e.getParam("table_advtab",!0,"boolean")},Sc=function(e){return e.getParam("table_style_by_css",!1,"boolean")},kc=function(e){return e.getParam("table_cell_class_list",[],"array")},Tc=function(e){return e.getParam("table_class_list",[],"array")},Ec=function(e){return"relative"===pc(e)||!0===gc(e)},Ac=function(e){return"fixed"===pc(e)||!1===gc(e)},_c=function(e){return"responsive"===pc(e)},Nc=function(e){return e.getParam("table_use_colgroups",!1,"boolean")},Rc=function(e){var t=e.getParam("table_header_type","section","string");return N(["section","cells","sectionCells","auto"],t)?t:"section"},Dc=function(e){var t=e.getParam("table_column_resizing","preservetable","string");return F(["preservetable","resizetable"],(function(e){return e===t})).getOr("preservetable")},Oc=function(e){return"preservetable"===Dc(e)},Ic=function(e){return"resizetable"===Dc(e)},Pc=function(e){var t=e.getParam("table_clone_elements");return r(t)?T.some(t.split(/[ ,]/)):Array.isArray(t)?T.some(t):T.none()},Bc=function(e){return e.getParam("table_background_color_map",[],"array")},Mc=function(e){return e.getParam("table_border_color_map",[],"array")},Lc=function(e,t){return Ec(e)?Jo(t):Ac(e)?Go(t):Ko(t)},Fc=function(e){It(e,"width")},jc=function(e){var t=Io(e);ia(e,T.some(t),T.none()),Fc(e)},Hc=function(e){var t=function(e){return Pr(e)+"px"}(e);ia(e,T.some(t),T.none()),Fc(e)},Uc=function(e){$t(e,"width");var t=on(e),n=t.length>0?t:rn(e);I(n,(function(e){$t(e,"width"),Fc(e)})),Fc(e)},zc=function(){var e=xe.fromTag("div");return zt(e,{position:"static",height:"0",width:"0",padding:"0",margin:"0",border:"0"}),Un(vt(xe.fromDom(document)),e),e},Wc=function(e){return"false"!==Dt(e,"data-mce-resize")},Vc=function(e){var t,n,o=T.none(),i=T.none(),a=T.none(),c=function(e){return"TABLE"===e.nodeName},u=function(){return i},l=function(t){return Lc(e,t)},s=function(){return Oc(e)?$i():qi()},f=function(r,o,i){var a=ie(o,"e");if(""===n&&jc(r),i!==t&&""!==n){Ut(r,"width",n);var c=s(),u=l(r),f=Oc(e)||a?function(e){return la(e).columns}(r)-1:0;Fi(r,i-t,f,c,u)}else if(function(e){return/^(\d+(\.\d+)?)%$/.test(e)}(n)){var d=parseFloat(n.replace("%",""));Ut(r,"width",i*d/t+"%")}(function(e){return/^(\d+(\.\d+)?)px$/.test(e)})(n)&&function(e){var t=An.fromTable(e);An.hasColumns(t)||I(rn(e),(function(e){var t=Wt(e,"width");Ut(e,"width",t),It(e,"width")}))}(r)};return e.on("init",(function(){var t=function(e,t){return e.inline?Gi(pi(e),zc(),t):Ki(xe.fromDom(e.getDoc()),t)}(e,Wc);if(a=T.some(t),function(e){var t=e.getParam("object_resizing",!0);return r(t)?"table"===t:t}(e)&&function(e){return e.getParam("table_resize_bars",!0,"boolean")}(e)){var n=s(),c=rc(t,n,l);c.on(),c.events.startDrag.bind((function(t){o=T.some(e.selection.getRng())})),c.events.beforeResize.bind((function(t){var n=t.table.dom;!function(e,t,n,r,o){e.fire("ObjectResizeStart",{target:t,width:n,height:r,origin:o})}(e,n,gi(n),hi(n),"bar-"+t.type)})),c.events.afterResize.bind((function(t){var n=t.table,r=n.dom;yi(n),o.each((function(t){e.selection.setRng(t),e.focus()})),function(e,t,n,r,o){e.fire("ObjectResized",{target:t,width:n,height:r,origin:o})}(e,r,gi(r),hi(r),"bar-"+t.type),e.undoManager.add()})),i=T.some(c)}})),e.on("ObjectResizeStart",(function(r){var o=r.target;if(c(o)){var i=xe.fromDom(o);I(e.dom.select(".mce-clonedresizable"),(function(t){e.dom.addClass(t,"mce-"+Dc(e)+"-columns")})),!ca(i)&&Ac(e)?Hc(i):!aa(i)&&Ec(e)&&jc(i),ua(i)&&oe(r.origin,"bar-")&&jc(i),t=r.width,n=_c(e)?"":function(e,t){var n=e.dom.getStyle(t,"width")||e.dom.getAttrib(t,"width");return T.from(n).filter(ce)}(e,o).getOr("")}})),e.on("ObjectResized",(function(t){var n=t.target;if(c(n)){var r=xe.fromDom(n),o=t.origin;oe(o,"corner-")&&f(r,o,t.width),yi(r),ac(e,r.dom,cc)}})),e.on("SwitchMode",(function(){u().each((function(t){e.mode.isReadOnly()?t.hideBars():t.showBars()}))})),{lazyResize:u,lazyWire:function(){return a.getOr(Ki(xe.fromDom(e.getBody()),Wc))},destroy:function(){i.each((function(e){e.destroy()})),a.each((function(t){!function(e,t){e.inline&&$n(t.parent())}(e,t)}))}}},qc=function(e,t){return{element:e,offset:t}},$c=function(e,t,n){return e.property().isText(t)&&0===e.property().getText(t).trim().length||e.property().isComment(t)?n(t).bind((function(t){return $c(e,t,n).orThunk((function(){return T.some(t)}))})):T.none()},Kc=function(e,t){return e.property().isText(t)?e.property().getText(t).length:e.property().children(t).length},Gc=function(e,t){var n=$c(e,t,e.query().prevSibling).getOr(t);if(e.property().isText(n))return qc(n,Kc(e,n));var r=e.property().children(n);return r.length>0?Gc(e,r[r.length-1]):qc(n,Kc(e,n))},Jc=Gc,Xc=Zn(),Yc=function(e,t){1===Gt(e,"colspan")&&function(e){return _o(e).bind((function(e){return vo(e,["fixed","relative","empty"])}))}(e).each((function(n){var r=n.value/2;Oo(e,r,n.unit),Oo(t,r,n.unit)}))},Qc=tt("th"),Zc=function(e){return z(e,(function(e){return Qc(e.element)}))},eu=function(e,t){return e&&t?"sectionCells":e?"section":"cells"},tu=function(e){var t="thead"===e.section,n=Bt(nu(e.cells),"th");return t||n?{type:"header",subType:eu(t,n)}:"tfoot"===e.section?{type:"footer"}:{type:"body"}},nu=function(e){var t=B(e,(function(e){return Qc(e.element)}));return 0===t.length?T.some("td"):t.length===e.length?T.some("th"):T.none()},ru=function(e,t,n){return qe(n(e.element,t),!0,e.isLocked)},ou=function(e,t){return e.section!==t?$e(e.element,e.cells,t,e.isNew):e},iu=function(){return{transformRow:ou,transformCell:function(e,t,n){var r=n(e.element,t),o="td"!==Ke(r)?function(e,t){var n=Tr(e,t);Fn(e,n);var r=ut(e);return Vn(n,r),$n(e),n}(r,"td"):r;return qe(o,e.isNew,e.isLocked)}}},au=function(){return{transformRow:ou,transformCell:ru}},cu=function(){return{transformRow:function(e,t){return ou(e,"thead"===t?"tbody":t)},transformCell:ru}},uu=function(e,t){switch(function(e){return G(e.all,(function(e){var t=tu(e);return"header"===t.type?T.from(t.subType):T.none()}))}(An.fromTable(e)).getOr(t)){case"section":return iu();case"sectionCells":return au();case"cells":return cu()}},lu=iu,su=au,fu=cu,du=function(){return{transformRow:p,transformCell:ru}},mu=function(e,t,n,r){n===r?It(e,t):Nt(e,t,n)},pu=function(e,t,n){K(wt(e,t)).fold((function(){return Hn(e,n)}),(function(e){return jn(e,n)}))},gu=function(e,t){var n=[],r=[],o=function(e){return O(e,(function(e){e.isNew&&n.push(e.element);var t=e.element;return qn(t),I(e.cells,(function(e){e.isNew&&r.push(e.element),mu(e.element,"colspan",e.colspan,1),mu(e.element,"rowspan",e.rowspan,1),Un(t,e.element)})),t}))},i=function(e){return U(e,(function(e){return O(e.cells,(function(e){return mu(e.element,"span",e.colspan,1),e.element}))}))},a=function(t,n){var r=function(e,t){var n=Tt(e,t).getOrThunk((function(){var n=xe.fromTag(t,nt(e).dom);return"thead"===t?pu(e,"caption,colgroup",n):"colgroup"===t?pu(e,"caption",n):Un(e,n),n}));return qn(n),n}(e,n),a=("colgroup"===n?i:o)(t);Vn(r,a)},c=function(t,n){t.length>0?a(t,n):function(t){Tt(e,t).each($n)}(n)},u=[],l=[],s=[],f=[];return I(t,(function(e){switch(e.section){case"thead":u.push(e);break;case"tbody":l.push(e);break;case"tfoot":s.push(e);break;case"colgroup":f.push(e)}})),c(f,"colgroup"),c(u,"thead"),c(l,"tbody"),c(s,"tfoot"),{newRows:n,newCells:r}},hu=function(e,t){if(0===e.length)return 0;var n=e[0];return j(e,(function(e){return!t(n.element,e.element)})).getOr(e.length)},vu=function(e,t,n,r){var o=function(e,t){return e[t]}(e,t),i="colgroup"===o.section;return{colspan:hu(o.cells.slice(n),r),rowspan:i?1:hu(function(e,t){return O(e,(function(e){return hn(e,t)}))}(e.slice(t),n),r)}},bu=function(e,t){var n=O(e,(function(e){return O(e.cells,w)}));return O(e,(function(r,o){var i=U(r.cells,(function(r,i){if(!1===n[o][i]){var a=vu(e,o,i,t);return function(e,t,r,o){for(var i=e;i<e+r;i++)for(var a=t;a<t+o;a++)n[i][a]=!0}(o,i,a.rowspan,a.colspan),[(c=r.element,u=a.rowspan,l=a.colspan,s=r.isNew,{element:c,rowspan:u,colspan:l,isNew:s})]}return[];var c,u,l,s}));return function(e,t,n,r){return{element:e,cells:t,section:n,isNew:r}}(r.element,i,r.section,r.isNew)}))},yu=function(e,t,n){var r=[];I(e.colgroups,(function(o){for(var i=[],a=0;a<e.grid.columns;a++){var c=An.getColumnAt(e,a).map((function(e){return qe(e.element,n,!1)})).getOrThunk((function(){return qe(t.colGap(),!0,!1)}));i.push(c)}r.push($e(o.element,i,"colgroup",n))}));for(var o=0;o<e.grid.rows;o++){for(var i=[],a=0;a<e.grid.columns;a++){var c=An.getAt(e,o,a).map((function(e){return qe(e.element,n,e.isLocked)})).getOrThunk((function(){return qe(t.gap(),!0,!1)}));i.push(c)}var u=e.all[o],l=$e(u.element,i,u.section,n);r.push(l)}return r},wu=function(e){return bu(e,Ee)},Cu=function(e,t){return G(e.all,(function(e){return F(e.cells,(function(e){return Ee(t,e.element)}))}))},xu=function(e,t,n){var r=O(t.selection,(function(t){return nn(t).bind((function(t){return Cu(e,t)})).filter(n)})),o=Mt(r);return Ft(o.length>0,o)},Su=function(e,t,n,r,o){return function(i,a,c,u,l){var s=An.fromTable(a),f=T.from(null==l?void 0:l.section).getOrThunk(du);return t(s,c).map((function(t){var n=function(e,t){return yu(e,t,!1)}(s,u),r=e(n,t,Ee,o(u),f),i=Sn(r.grid);return{info:t,grid:wu(r.grid),cursor:r.cursor,lockedColumns:i}})).bind((function(e){var t=gu(a,e.grid),o=T.from(null==l?void 0:l.sizing).getOrThunk((function(){return Ko(a)})),c=T.from(null==l?void 0:l.resize).getOrThunk($i);return n(a,e.grid,e.info,{sizing:o,resize:c,section:f}),r(a),Ya(i,a),It(a,Cn),e.lockedColumns.length>0&&Nt(a,Cn,e.lockedColumns.join(",")),T.some({cursor:e.cursor,newRows:t.newRows,newCells:t.newCells})}))}},ku=function(e,t){return xu(e,t,C).map((function(e){return{cells:e,generators:t.generators,clipboard:t.clipboard}}))},Tu=function(e,t){return xu(e,t,C)},Eu=function(e,t){return xu(e,t,(function(e){return!e.isLocked}))},Au=function(e,t){return z(t,(function(t){return function(e,t){return Cu(e,t).exists((function(e){return!e.isLocked}))}(e,t)}))},_u=function(e,t){return function(e,t){return t.mergable}(0,t).filter((function(t){return Au(e,t.cells)}))},Nu=function(e,t){return function(e,t){return t.unmergable}(0,t).filter((function(t){return Au(e,t)}))},Ru=function(e,t,n,r){for(var o=yn(e).rows,i=!0,a=0;a<o.length;a++)for(var c=0;c<bn(o[0]);c++){var u=o[a],l=hn(u,c),s=n(l.element,t);!0===s&&!1===i?pn(u,c,qe(r(),!0,l.isLocked)):!0===s&&(i=!1)}return e},Du=function(e,t,n,r){var o=yn(e).rows;if(t>0&&t<o.length){var i=function(e,t){return L(e,(function(e,n){return R(e,(function(e){return t(e.element,n.element)}))?e:e.concat([n])}),[])}(o[t-1].cells,n);I(i,(function(e){for(var i=T.none(),a=t;a<o.length;a++)for(var c=function(t){var c=o[a],u=hn(c,t);n(u.element,e.element)&&(i.isNone()&&(i=T.some(r())),i.each((function(e){pn(c,t,qe(e,!0,u.isLocked))})))},u=0;u<bn(o[0]);u++)c(u)}))}return e},Ou=function(e){return{isValue:C,isError:w,getOr:m(e),getOrThunk:m(e),getOrDie:m(e),or:function(t){return Ou(e)},orThunk:function(t){return Ou(e)},fold:function(t,n){return n(e)},map:function(t){return Ou(t(e))},mapError:function(t){return Ou(e)},each:function(t){t(e)},bind:function(t){return t(e)},exists:function(t){return t(e)},forall:function(t){return t(e)},toOptional:function(){return T.some(e)}}},Iu=function(e){return{isValue:w,isError:C,getOr:p,getOrThunk:function(e){return e()},getOrDie:function(){return(t=String(e),function(){throw new Error(t)})();var t},or:p,orThunk:function(e){return e()},fold:function(t,n){return t(e)},map:function(t){return Iu(e)},mapError:function(t){return Iu(t(e))},each:d,bind:function(t){return Iu(e)},exists:w,forall:C,toOptional:T.none}},Pu={value:Ou,error:Iu,fromOption:function(e,t){return e.fold((function(){return Iu(t)}),Ou)}},Bu=function(e,t){return{rowDelta:0,colDelta:bn(e[0])-bn(t[0])}},Mu=function(e,t){return{rowDelta:e.length-t.length,colDelta:0}},Lu=function(e,t,n,r){var o="colgroup"===t.section?n.col:n.cell;return D(e,(function(e){return qe(o(),!0,r(e))}))},Fu=function(e,t,n,r){var o=e[e.length-1];return e.concat(D(t,(function(){var e="colgroup"===o.section?n.colgroup:n.row,t=wn(o,e,p),i=Lu(t.cells.length,t,n,(function(e){return He(r,e.toString())}));return gn(t,i)})))},ju=function(e,t,n,r){return O(e,(function(e){var o=Lu(t,e,n,w);return dn(e,r,o)}))},Hu=function(e,t,n){var r=t.colDelta<0?ju:p,o=t.rowDelta<0?Fu:p,i=Sn(e),a=bn(e[0]),c=R(i,(function(e){return e===a-1})),u=r(e,Math.abs(t.colDelta),n,c?a-1:a),l=Sn(u);return o(u,Math.abs(t.rowDelta),n,W(l,C))},Uu=function(e,t,n,r){var o=h(r,hn(e[t],n).element),i=e[t];return e.length>1&&bn(i)>1&&(n>0&&o(vn(i,n-1))||n<i.cells.length-1&&o(vn(i,n+1))||t>0&&o(vn(e[t-1],n))||t<e.length-1&&o(vn(e[t+1],n)))},zu=function(e,t,n){return B(n,(function(n){return n>=e.column&&n<=bn(t[0])+e.column}))},Wu=function(e,t,n,r,o){var i=Sn(t),a=function(e,t,n){var r=bn(t[0]),o=yn(t).cols.length+e.row,i=D(r-e.column,(function(t){return t+e.column}));return{row:o,column:F(i,(function(e){return z(n,(function(t){return t!==e}))})).getOr(r-1)}}(e,t,i),c=yn(n).rows,u=zu(a,c,i);return function(e,t,n){if(e.row>=t.length||e.column>bn(t[0]))return Pu.error("invalid start address out of table bounds, row: "+e.row+", column: "+e.column);var r=t.slice(e.row),o=r[0].cells.slice(e.column),i=bn(n[0]),a=n.length;return Pu.value({rowDelta:r.length-a,colDelta:o.length-i})}(a,t,c).map((function(e){var n=J(J({},e),{colDelta:e.colDelta-u.length}),i=Hu(t,n,r),l=Sn(i),s=zu(a,c,l);return function(e,t,n,r,o,i){for(var a=e.row,c=e.column,u=a+n.length,l=c+bn(n[0])+i.length,s=W(i,C),f=a;f<u;f++)for(var d=0,m=c;m<l;m++)if(s[m])d++;else{Uu(t,f,m,o)&&Ru(t,vn(t[f],m),o,r.cell);var p=m-c-d,g=hn(n[f-a],p),h=g.element,v=r.replace(h);pn(t[f],m,qe(v,!0,g.isLocked))}return t}(a,i,c,r,o,s)}))},Vu=function(e,t,n,r,o){!function(e,t,n,r){t>0&&t<e[0].cells.length&&I(e,(function(e){var o=e.cells[t-1],i=e.cells[t];n(i.element,o.element)&&pn(e,t,qe(r(),!0,i.isLocked))}))}(t,e,o,r.cell);var i=Mu(n,t),a=Hu(n,i,r),c=Mu(t,a),u=Hu(t,c,r);return O(u,(function(t,n){return dn(t,e,a[n].cells)}))},qu=function(e,t,n,r,o){Du(t,e,o,r.cell);var i=Sn(t),a=Bu(t,n),c=J(J({},a),{colDelta:a.colDelta-i.length}),u=Hu(t,c,r),l=yn(u),s=l.cols,f=l.rows,d=Sn(u),m=Bu(n,t),p=J(J({},m),{colDelta:m.colDelta+d.length}),g=function(e,t,n){return O(e,(function(e){return L(n,(function(n,r){var o=Lu(1,e,t,C)[0];return mn(n,r,o)}),e)}))}(n,r,d),h=Hu(g,p,r);return s.concat(f.slice(0,e)).concat(h).concat(f.slice(e,f.length))},$u=function(e,t,n,r,o){var i=yn(e),a=i.rows,c=i.cols,u=a.slice(0,t),l=a.slice(t),s=function(e,t,n,r){return wn(e,(function(e){return r(e,n)}),t)}(a[n],(function(e,n){return t>0&&t<a.length&&r(vn(a[t-1],n),vn(a[t],n))?hn(a[t],n):qe(o(e.element,r),!0,e.isLocked)}),r,o);return c.concat(u).concat([s]).concat(l)},Ku=function(e,t,n,r,o){return O(e,(function(e){var i=t>0&&t<bn(e)&&r(vn(e,t-1),vn(e,t)),a=function(e,t,n,r,o,i,a){if("colgroup"!==n&&r)return hn(e,t);var c=hn(e,o);return qe(a(c.element,i),!0,!1)}(e,t,e.section,i,n,r,o);return mn(e,t,a)}))},Gu=function(e,t,n,r){return function(e,t,n,r){return void 0!==vn(e[t],n)&&t>0&&r(vn(e[t-1],n),vn(e[t],n))}(e,t,n,r)||function(e,t,n){return t>0&&n(vn(e,t-1),vn(e,t))}(e[t],n,r)},Ju=function(e,t,n,r){var o=function(e){return function(e){return"row"===e?Xt(t):Jt(t)}(e)?e+"group":e};return e?Qc(t)?o(n):null:r&&Qc(t)?o("row"===n?"col":"row"):null},Xu=function(e,t,n){return qe(n(e.element,t),!0,e.isLocked)},Yu=function(e,t,n,r,o,i,a){return O(e,(function(e,c){return function(e,t){var n=e.cells,r=O(n,t);return $e(e.element,r,e.section,e.isNew)}(e,(function(e,u){if(function(e){return R(t,(function(t){return n(e.element,t.element)}))}(e)){var l=a(e,c,u)?o(e,n,r):e;return i(l,c,u).each((function(e){var t,n;t=l.element,n={scope:T.from(e)},Oe(n,(function(e,n){e.fold((function(){It(t,n)}),(function(e){_t(t.dom,n,e)}))}))})),l}return e}))}))},Qu=function(e,t,n){return U(e,(function(r,o){return Gu(e,o,t,n)?[]:[hn(r,t)]}))},Zu=function(e,t,n,r,o){var i=yn(e).rows,a=U(t,(function(e){return Qu(i,e,r)})),c=O(e,(function(e){return Zc(e.cells)})),u=function(e,t){return z(t,p)&&Zc(e)?C:function(e,n,r){return!("th"===Ke(e.element)&&t[n])}}(a,c),l=function(e,t){return function(n,r){return T.some(Ju(e,n.element,"row",t[r]))}}(n,c);return Yu(e,a,r,o,Xu,l,u)},el=function(e,t,n,r,o,i,a){var c=yn(e),u=c.cols,l=c.rows,s=l[t[0]],f=U(t,(function(e){return function(e,t,n){var r=e[t];return U(r.cells,(function(r,o){return Gu(e,t,o,n)?[]:[r]}))}(l,e,o)})),d=O(s.cells,(function(e,t){return Zc(Qu(l,t,o))})),m=X([],l,!0);I(t,(function(e){m[e]=a.transformRow(l[e],n)}));var g=u.concat(m),h=function(e,t){return z(t,p)&&Zc(e.cells)?C:function(e,n,r){return!("th"===Ke(e.element)&&t[r])}}(s,d),v=function(e,t){return function(n,r,o){return T.some(Ju(e,n.element,"col",t[o]))}}(r,d);return Yu(g,f,o,i,a.transformCell,v,h)},tl=function(e,t,n,r){var o=yn(e).rows,i=O(t,(function(e){return hn(o[e.row],e.column)}));return Yu(e,i,n,r,Xu,T.none,C)},nl=function(e){return L(e,(function(e,t){return R(e,(function(e){return e.column===t.column}))?e:e.concat([t])}),[]).sort((function(e,t){return e.column-t.column}))},rl=tt("col"),ol=tt("colgroup"),il=function(e){return"tr"===Ke(e)||ol(e)},al=function(e){return{element:e,colspan:Kt(e,"colspan",1),rowspan:Kt(e,"rowspan",1)}},cl=function(e){return Ot(e,"scope").map((function(e){return e.substr(0,3)}))},ul=function(e,t){void 0===t&&(t=al);var n=function(n){if(il(n))return ol((o={element:n}).element)?e.colgroup(o):e.row(o);var o,i=function(t){return rl(t.element)?e.col(t):e.cell(t)}(t(n));return r=T.some({item:n,replacement:i}),i},r=T.none();return{getOrInit:function(e,t){return r.fold((function(){return n(e)}),(function(r){return t(e,r.item)?r.replacement:n(e)}))}}},ll=function(e){return function(t){var n=[],r=function(r){var o="td"===e?{scope:null}:{},i=t.replace(r,e,o);return n.push({item:r,sub:i}),i};return{replaceOrInit:function(e,t){return il(e)||rl(e)?e:function(e,t){return F(n,(function(n){return t(n.item,e)}))}(e,t).fold((function(){return r(e)}),(function(n){return t(e,n.item)?n.sub:r(e)}))}}}},sl=function(e){return{unmerge:function(t){var n=cl(t);return n.each((function(e){return Nt(t,"scope",e)})),function(){var r=e.cell({element:t,colspan:1,rowspan:1});return $t(r,"width"),$t(t,"width"),n.each((function(e){return Nt(r,"scope",e)})),r}},merge:function(e){return $t(e[0],"width"),function(){var t=Mt(O(e,cl));if(0===t.length)return T.none();var n=t[0],r=["row","col"];return R(t,(function(e){return e!==n&&N(r,e)}))?T.none():T.from(n)}().fold((function(){return It(e[0],"scope")}),(function(t){return Nt(e[0],"scope",t+"group")})),m(e[0])}}},fl=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","table","thead","tfoot","tbody","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],dl=Zn(),ml=function(e){return function(e,t){var n=e.property().name(t);return N(fl,n)}(dl,e)},pl=function(e){return function(e,t){var n=e.property().name(t);return N(["ol","ul"],n)}(dl,e)},gl=function(e){return function(e,t){return N(["br","img","hr","input"],e.property().name(t))}(dl,e)},hl=function(e){var t,n=function(e){return"br"===Ke(e)},r=function(e){return ni(e).bind((function(t){var r=ct(t).map((function(e){return!!ml(e)||!!gl(e)&&"img"!==Ke(e)})).getOr(!1);return ot(t).map((function(o){return!0===r||function(e){return"li"===Ke(e)||St(e,pl).isSome()}(o)||n(t)||ml(o)&&!Ee(e,o)?[]:[xe.fromTag("br")]}))})).getOr([])},o=0===(t=U(e,(function(e){var t=ut(e);return function(e){return z(e,(function(e){return n(e)||Qe(e)&&0===Jn(e).trim().length}))}(t)?[]:t.concat(r(e))}))).length?[xe.fromTag("br")]:t;qn(e[0]),Vn(e[0],o)},vl=function(e){return Fa(e,!0)},bl=function(e){0===rn(e).length&&$n(e)},yl=function(e,t){return{grid:e,cursor:t}},wl=function(e,t,n){var r,o,i=yn(e).rows;return T.from(null===(o=null===(r=i[t])||void 0===r?void 0:r.cells[n])||void 0===o?void 0:o.element).filter(vl).orThunk((function(){return function(e){return G(e,(function(e){return G(e.cells,(function(e){var t=e.element;return Ft(vl(t),t)}))}))}(i)}))},Cl=function(e,t,n){var r=wl(e,t,n);return yl(e,r)},xl=function(e){return L(e,(function(e,t){return R(e,(function(e){return e.row===t.row}))?e:e.concat([t])}),[]).sort((function(e,t){return e.row-t.row}))},Sl=function(e,t){return function(n,r,o,i,a){var c=xl(r),u=O(c,(function(e){return e.row})),l=el(n,u,e,t,o,i.replaceOrInit,a);return Cl(l,r[0].row,r[0].column)}},kl=Sl("thead",!0),Tl=Sl("tbody",!1),El=Sl("tfoot",!1),Al=function(e,t,n){var r=function(e,t){return ln(e,(function(){return t}))}(e,n.section),o=An.generate(r);return yu(o,t,!0)},_l=function(e,t,n,r){return function(e,t,n,r){var o=An.generate(t),i=r.getWidths(o,r);Li(o,i,r)}(0,t,0,r.sizing)},Nl=function(e,t,n,r){return function(e,t,n,r,o){var i=An.generate(t),a=r.getWidths(i,r),c=r.pixelWidth(),u=o.calcRedestributedWidths(a,c,n.pixelDelta,r.isRelative),l=u.newSizes,s=u.delta;Li(i,l,r),r.adjustTableWidth(s)}(0,t,n,r.sizing,r.resize)},Rl=function(e,t){return R(t,(function(e){return 0===e.column&&e.isLocked}))},Dl=function(e,t){return R(t,(function(t){return t.column+t.colspan>=e.grid.columns&&t.isLocked}))},Ol=function(e,t){var n=Fr(e),r=nl(t);return L(r,(function(e,t){return e+n[t.column].map(Br).getOr(0)}),0)},Il=function(e){return function(t,n){return Tu(t,n).filter((function(n){return!(e?Rl:Dl)(t,n)})).map((function(e){return{details:e,pixelDelta:Ol(t,e)}}))}},Pl=function(e){return function(t,n){return ku(t,n).filter((function(n){return!(e?Rl:Dl)(t,n.cells)}))}},Bl=ll("th"),Ml=ll("td"),Ll=Su((function(e,t,n,r){var o=t[0].row,i=xl(t),a=M(i,(function(e,t){return{grid:$u(e.grid,o,t.row+e.delta,n,r.getOrInit),delta:e.delta+1}}),{grid:e,delta:0}).grid;return Cl(a,o,t[0].column)}),Tu,d,d,ul),Fl=Su((function(e,t,n,r){var o=xl(t),i=o[o.length-1],a=i.row+i.rowspan,c=M(o,(function(e,t){return $u(e,a,t.row,n,r.getOrInit)}),e);return Cl(c,a,t[0].column)}),Tu,d,d,ul),jl=Su((function(e,t,n,r){var o=t.details,i=nl(o),a=i[0].column,c=M(i,(function(e,t){return{grid:Ku(e.grid,a,t.column+e.delta,n,r.getOrInit),delta:e.delta+1}}),{grid:e,delta:0}).grid;return Cl(c,o[0].row,a)}),Il(!0),Nl,d,ul),Hl=Su((function(e,t,n,r){var o=t.details,i=o[o.length-1],a=i.column+i.colspan,c=nl(o),u=M(c,(function(e,t){return Ku(e,a,t.column,n,r.getOrInit)}),e);return Cl(u,o[0].row,a)}),Il(!1),Nl,d,ul),Ul=Su((function(e,t,n,r){var o=nl(t.details),i=function(e,t){return U(e,(function(e){var n=e.cells,r=M(t,(function(e,t){return t>=0&&t<e.length?e.slice(0,t).concat(e.slice(t+1)):e}),n);return r.length>0?[$e(e.element,r,e.section,e.isNew)]:[]}))}(e,O(o,(function(e){return e.column}))),a=i.length>0?i[0].cells.length-1:0;return Cl(i,o[0].row,Math.min(o[0].column,a))}),(function(e,t){return Eu(e,t).map((function(t){return{details:t,pixelDelta:-Ol(e,t)}}))}),Nl,bl,ul),zl=Su((function(e,t,n,r){var o=xl(t),i=function(e,t,n){var r=yn(e),o=r.rows;return r.cols.concat(o.slice(0,t)).concat(o.slice(n+1))}(e,o[0].row,o[o.length-1].row),a=i.length>0?i.length-1:0;return Cl(i,Math.min(t[0].row,a),t[0].column)}),Tu,d,bl,ul),Wl=Su((function(e,t,n,r){var o=nl(t),i=O(o,(function(e){return e.column})),a=Zu(e,i,!0,n,r.replaceOrInit);return Cl(a,t[0].row,t[0].column)}),Eu,d,d,Bl),Vl=Su((function(e,t,n,r){var o=nl(t),i=O(o,(function(e){return e.column})),a=Zu(e,i,!1,n,r.replaceOrInit);return Cl(a,t[0].row,t[0].column)}),Eu,d,d,Ml),ql=Su(kl,Eu,d,d,Bl),$l=Su(Tl,Eu,d,d,Ml),Kl=Su(El,Eu,d,d,Ml),Gl=Su((function(e,t,n,r){var o=tl(e,t,n,r.replaceOrInit);return Cl(o,t[0].row,t[0].column)}),Eu,d,d,Bl),Jl=Su((function(e,t,n,r){var o=tl(e,t,n,r.replaceOrInit);return Cl(o,t[0].row,t[0].column)}),Eu,d,d,Ml),Xl=Su((function(e,t,n,r){var o=t.cells;hl(o);var i=function(e,t,n,r){var o=yn(e).rows;if(0===o.length)return e;for(var i=t.startRow;i<=t.finishRow;i++)for(var a=t.startCol;a<=t.finishCol;a++){var c=o[i],u=hn(c,a).isLocked;pn(c,a,qe(r(),!1,u))}return e}(e,t.bounds,0,r.merge(o));return yl(i,T.from(o[0]))}),_u,_l,d,sl),Yl=Su((function(e,t,n,r){var o=M(t,(function(e,t){return Ru(e,t,n,r.unmerge(t))}),e);return yl(o,T.from(t[0]))}),Nu,_l,d,sl),Ql=Su((function(e,t,n,r){var o=function(e,t){var n=An.fromTable(e);return yu(n,t,!0)}(t.clipboard,t.generators),i=function(e,t){return{row:e,column:t}}(t.row,t.column);return Wu(i,e,o,t.generators,n).fold((function(){return yl(e,T.some(t.element))}),(function(e){return Cl(e,t.row,t.column)}))}),(function(e,t){return nn(t.element).bind((function(n){return Cu(e,n).map((function(e){return J(J({},e),{generators:t.generators,clipboard:t.clipboard})}))}))}),_l,d,ul),Zl=Su((function(e,t,n,r){var o=yn(e).rows,i=t.cells[0].column,a=o[t.cells[0].row],c=Al(t.clipboard,t.generators,a),u=Vu(i,e,c,t.generators,n);return Cl(u,t.cells[0].row,t.cells[0].column)}),Pl(!0),d,d,ul),es=Su((function(e,t,n,r){var o=yn(e).rows,i=t.cells[t.cells.length-1].column+t.cells[t.cells.length-1].colspan,a=o[t.cells[0].row],c=Al(t.clipboard,t.generators,a),u=Vu(i,e,c,t.generators,n);return Cl(u,t.cells[0].row,t.cells[0].column)}),Pl(!1),d,d,ul),ts=Su((function(e,t,n,r){var o=yn(e).rows,i=t.cells[0].row,a=o[i],c=Al(t.clipboard,t.generators,a),u=qu(i,e,c,t.generators,n);return Cl(u,t.cells[0].row,t.cells[0].column)}),ku,d,d,ul),ns=Su((function(e,t,n,r){var o=yn(e).rows,i=t.cells[t.cells.length-1].row+t.cells[t.cells.length-1].rowspan,a=o[t.cells[0].row],c=Al(t.clipboard,t.generators,a),u=qu(i,e,c,t.generators,n);return Cl(u,t.cells[0].row,t.cells[0].column)}),ku,d,d,ul),rs=function(e,t){var n=An.fromTable(e);return Tu(n,t).bind((function(e){var t=e[e.length-1],r=e[0].column,o=t.column+t.colspan,i=H(O(n.all,(function(e){return B(e.cells,(function(e){return e.column>=r&&e.column<o}))})));return nu(i)})).getOr("")},os=function(e,t){var n=An.fromTable(e);return Tu(n,t).bind(nu).getOr("")},is=function(e,t){var n=An.fromTable(e);return Tu(n,t).bind((function(e){var t=e[e.length-1],r=e[0].row,o=t.row+t.rowspan;return function(e){var t=O(e,(function(e){return tu(e).type})),n=N(t,"header"),r=N(t,"footer");if(n||r){var o=N(t,"body");return!n||o||r?n||o||!r?T.none():T.some("footer"):T.some("header")}return T.some("body")}(n.all.slice(r,o))})).getOr("")},as=function(e,t,n){var r=function(e){return"table"===Ke(pi(e))},o=Pc(e),i=Ic(e)?d:Yc,a=function(t){switch(Rc(e)){case"section":return lu();case"sectionCells":return su();case"cells":return fu();default:return uu(t,"section")}},c=function(n,r){return r.cursor.fold((function(){var r=rn(n);return $(r).filter(ht).map((function(r){t.clear(n);var o=e.dom.createRng();return o.selectNode(r.dom),e.selection.setRng(o),Nt(r,"data-mce-selected","1"),o}))}),(function(r){var o=Jc(Xc,r),i=e.dom.createRng();return i.setStart(o.element.dom,o.offset),i.setEnd(o.element.dom,o.offset),e.selection.setRng(i),t.clear(n),T.some(i)}))},u=function(t,n,r,i,u){return function(l,s,f){void 0===f&&(f=!1),yi(l);var d=i(),m=xe.fromDom(e.getDoc()),p=fi(r,m,o),g={sizing:Lc(e,l),resize:Ic(e)?qi():$i(),section:a(l)};return n(l)?t(d,l,s,p,g).bind((function(t){I(t.newRows,(function(t){oc(e,t.dom)})),I(t.newCells,(function(t){ic(e,t.dom)}));var n=c(l,t);return ht(l)&&(yi(l),f||ac(e,l.dom,u)),n.map((function(e){return{rng:e,effect:u}}))})):T.none()}};return{deleteRow:u(zl,(function(t){return!1===r(e)||la(t).rows>1}),d,n,uc),deleteColumn:u(Ul,(function(t){return!1===r(e)||la(t).columns>1}),d,n,uc),insertRowsBefore:u(Ll,C,d,n,uc),insertRowsAfter:u(Fl,C,d,n,uc),insertColumnsBefore:u(jl,C,i,n,uc),insertColumnsAfter:u(Hl,C,i,n,uc),mergeCells:u(Xl,C,d,n,uc),unmergeCells:u(Yl,C,d,n,uc),pasteColsBefore:u(Zl,C,d,n,uc),pasteColsAfter:u(es,C,d,n,uc),pasteRowsBefore:u(ts,C,d,n,uc),pasteRowsAfter:u(ns,C,d,n,uc),pasteCells:u(Ql,C,d,n,lc),makeCellsHeader:u(Gl,C,d,n,uc),unmakeCellsHeader:u(Jl,C,d,n,uc),makeColumnsHeader:u(Wl,C,d,n,uc),unmakeColumnsHeader:u(Vl,C,d,n,uc),makeRowsHeader:u(ql,C,d,n,uc),makeRowsBody:u($l,C,d,n,uc),makeRowsFooter:u(Kl,C,d,n,uc),getTableRowType:is,getTableCellType:os,getTableColType:rs}},cs={styles:{"border-collapse":"collapse",width:"100%"},attributes:{border:"1"},colGroups:!1},us=function(e){var t=xe.fromTag("colgroup");return D(e,(function(){return Un(t,xe.fromTag("col"))})),t},ls=function(e,t,n,r){return D(e,(function(e){return function(e,t,n,r){for(var o=xe.fromTag("tr"),i=0;i<e;i++){var a=r<t||i<n?xe.fromTag("th"):xe.fromTag("td");i<n&&Nt(a,"scope","row"),r<t&&Nt(a,"scope","col"),Un(a,xe.fromTag("br")),Un(o,a)}return o}(t,n,r,e)}))},ss=function(e,t){e.selection.select(t.dom,!0),e.selection.collapse(!0)},fs=function(e,t,n,o,i){var a=yc(e),c={styles:a,attributes:bc(e),colGroups:Nc(e)};return e.undoManager.ignore((function(){var r=function(e,t,n,r,o,i){void 0===i&&(i=cs);var a=xe.fromTag("table"),c="cells"!==o;zt(a,i.styles),Rt(a,i.attributes),i.colGroups&&Un(a,us(t));var u=Math.min(e,n);if(c&&n>0){var l=xe.fromTag("thead");Un(a,l);var s=ls(n,t,"sectionCells"===o?u:0,r);Vn(l,s)}var f=xe.fromTag("tbody");Un(a,f);var d=ls(c?e-u:e,t,c?0:n,r);return Vn(f,d),a}(n,t,i,o,Rc(e),c);Nt(r,"data-mce-id","__mce");var a=function(e){var t=xe.fromTag("div"),n=xe.fromDom(e.dom.cloneNode(!0));return Un(t,n),function(e){return e.dom.innerHTML}(t)}(r);e.insertContent(a),e.addVisual()})),Et(pi(e),'table[data-mce-id="__mce"]').map((function(t){return Ac(e)?Hc(t):_c(e)?Uc(t):(Ec(e)||function(e){return r(e)&&-1!==e.indexOf("%")}(a.width))&&jc(t),yi(t),It(t,"data-mce-id"),function(e,t){I(Ct(t,"tr"),(function(t){oc(e,t.dom),I(Ct(t,"th,td"),(function(t){ic(e,t.dom)}))}))}(e,t),function(e,t){Et(t,"td,th").each(h(ss,e))}(e,t),t.dom})).getOr(null)},ds=function(e,t,n,r,o){void 0===r&&(r={});var i=function(e){return f(e)&&e>0};if(i(t)&&i(n)){var a=r.headerRows||0,c=r.headerColumns||0;return fs(e,n,t,c,a)}return console.error(o),null},ms=function(e){return function(){return e().fold((function(){return[]}),(function(e){return O(e,(function(e){return e.dom}))}))}},ps=function(e){return function(t){var n=t.length>0?T.some(mi(t)):T.none();e(n)}},gs=function(e){return function(t,n,r){void 0===r&&(r={});var o=ds(e,n,t,r,"Invalid values for insertTable - rows and columns values are required to insert a table.");return e.undoManager.add(),o}},hs=function(e,t,n){var r=Kt(e,t,1);1===n||r<=1?It(e,t):Nt(e,t,Math.min(n,r))},vs=function(e,t){var n=An.fromTable(e);return Eu(n,t).map((function(e){var t=e[e.length-1],r=e[0].column,o=t.column+t.colspan,i=function(e,t,n){if(An.hasColumns(e)){var r=B(An.justColumns(e),(function(e){return e.column>=t&&e.column<n})),o=O(r,(function(e){var r=kr(e.element);return hs(r,"span",n-t),r})),i=xe.fromTag("colgroup");return Vn(i,o),[i]}return[]}(n,r,o),a=function(e,t,n){return O(e.all,(function(e){var r=B(e.cells,(function(e){return e.column>=t&&e.column<n})),o=O(r,(function(e){var r=kr(e.element);return hs(r,"colspan",n-t),r})),i=xe.fromTag("tr");return Vn(i,o),i}))}(n,r,o);return X(X([],i,!0),a,!0)}))},bs=function(e,t,n){var r=An.fromTable(e);return Tu(r,t).bind((function(e){var t=yu(r,n,!1),o=yn(t).rows.slice(e[0].row,e[e.length-1].row+e[e.length-1].rowspan),i=U(o,(function(e){var t=B(e.cells,(function(e){return!e.isLocked}));return t.length>0?[J(J({},e),{cells:t})]:[]})),a=wu(i);return Ft(a.length>0,a)})).map((function(e){return function(e){return O(e,(function(e){var t=Sr(e.element);return I(e.cells,(function(e){var n=kr(e.element);mu(n,"colspan",e.colspan,1),mu(n,"rowspan",e.rowspan,1),Un(t,n)})),t}))}(e)}))},ys=tinymce.util.Tools.resolve("tinymce.util.Tools"),ws=function(e,t,n){return function(t,r){for(var o=0;o<r.length;o++){var i=e.getStyle(r[o],n);if(void 0===t&&(t=i),t!==i)return""}return t}(void 0,e.select("td,th",t))},Cs=function(e,t,n){n&&e.formatter.apply("align"+n,{},t)},xs=function(e,t){ys.each("left center right".split(" "),(function(n){e.formatter.remove("align"+n,{},t)}))},Ss=[{text:"None",value:""},{text:"Top",value:"top"},{text:"Middle",value:"middle"},{text:"Bottom",value:"bottom"}],ks=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,Ts=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,Es=function(e){return(t=e,n="#",oe(t,n)?function(e,t){return e.substring(t)}(t,n.length):t).toUpperCase();var t,n},As=function(e){return function(e){return ks.test(e)||Ts.test(e)}(e)?T.some({value:Es(e)}):T.none()},_s=function(e){var t=e.toString(16);return(1===t.length?"0"+t:t).toUpperCase()},Ns=function(e){return function(e){return{value:e}}(_s(e.red)+_s(e.green)+_s(e.blue))},Rs=/^rgb\((\d+),\s*(\d+),\s*(\d+)\)/,Ds=/^rgba\((\d+),\s*(\d+),\s*(\d+),\s*(\d?(?:\.\d+)?)\)/,Os=function(e,t,n,r){return{red:e,green:t,blue:n,alpha:r}},Is=function(e,t,n,r){var o=parseInt(e,10),i=parseInt(t,10),a=parseInt(n,10),c=parseFloat(r);return Os(o,i,a,c)},Ps=function(e){return As(e).orThunk((function(){return function(e){if("transparent"===e)return T.some(Os(0,0,0,0));var t=Rs.exec(e);if(null!==t)return T.some(Is(t[1],t[2],t[3],"1"));var n=Ds.exec(e);return null!==n?T.some(Is(n[1],n[2],n[3],n[4])):T.none()}(e).map(Ns)})).getOrThunk((function(){var t=document.createElement("canvas");t.height=1,t.width=1;var n=t.getContext("2d");n.clearRect(0,0,t.width,t.height),n.fillStyle="#FFFFFF",n.fillStyle=e,n.fillRect(0,0,1,1);var r=n.getImageData(0,0,1,1).data,o=r[0],i=r[1],a=r[2],c=r[3];return Ns(Os(o,i,a,c))}))},Bs=function(e){var t=e;return{get:function(){return t},set:function(e){t=e}}},Ms=function(e){var t=Bs(T.none()),n=function(){return t.get().each(e)};return{clear:function(){n(),t.set(T.none())},isSet:function(){return t.get().isSome()},get:function(){return t.get()},set:function(e){n(),t.set(T.some(e))}}},Ls=function(){var e=Ms(d);return J(J({},e),{on:function(t){return e.get().each(t)}})},Fs=function(e,t,n,r){return function(o){var i=Ms((function(e){return e.unbind()})),a=!ce(r),c=function(){var c=Ni(t),u=function(t){return e.formatter.match(n,{value:r},t.dom,a)};a?(o.setActive(!R(c,u)),i.set(e.formatter.formatChanged(n,(function(e){return o.setActive(!e)}),!0))):(o.setActive(z(c,u)),i.set(e.formatter.formatChanged(n,o.setActive,!1,{value:r})))};return e.initialized?c():e.on("init",c),i.clear}},js=function(e){return Ue(e,"menu")},Hs=function(e){return O(e,(function(e){var t=e.text||e.title;return js(e)?{text:t,items:Hs(e.menu)}:{text:t,value:e.value}}))},Us=function(e,t,n,r,o){return O(n,(function(n){var i=n.text||n.title;return js(n)?{type:"nestedmenuitem",text:i,getSubmenuItems:function(){return Us(e,t,n.menu,r,o)}}:{text:i,type:"togglemenuitem",onAction:function(){return o(n.value)},onSetup:Fs(e,t,r,n.value)}}))},zs=function(e,t){return function(n){var r;e.execCommand("mceTableApplyCellStyle",!1,((r={})[t]=n,r))}},Ws=function(e){return U(e,(function(e){return js(e)?[J(J({},e),{menu:Ws(e.menu)})]:ce(e.value)?[e]:[]}))},Vs=function(e,t,n,r,o){return function(i){return i(Us(e,t,n,r,o))}},qs=function(e,t,n){var r=O(t,(function(e){return{text:e.title,value:"#"+Ps(e.value).value,type:"choiceitem"}}));return[{type:"fancymenuitem",fancytype:"colorswatch",initData:{colors:r.length>0?r:void 0,allowCustomColors:!1},onAction:function(t){var r,o="remove"===t.value?"":t.value;e.execCommand("mceTableApplyCellStyle",!1,((r={})[n]=o,r))}}]},$s=function(e){return function(){var t="header"===e.queryCommandValue("mceTableRowType")?"body":"header";e.execCommand("mceTableRowType",!1,{type:t})}},Ks=function(e){return function(){var t="th"===e.queryCommandValue("mceTableColType")?"td":"th";e.execCommand("mceTableColType",!1,{type:t})}},Gs=[{name:"width",type:"input",label:"Width"},{name:"height",type:"input",label:"Height"},{name:"celltype",type:"listbox",label:"Cell type",items:[{text:"Cell",value:"td"},{text:"Header cell",value:"th"}]},{name:"scope",type:"listbox",label:"Scope",items:[{text:"None",value:""},{text:"Row",value:"row"},{text:"Column",value:"col"},{text:"Row group",value:"rowgroup"},{text:"Column group",value:"colgroup"}]},{name:"halign",type:"listbox",label:"Horizontal align",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{name:"valign",type:"listbox",label:"Vertical align",items:Ss}],Js=function(e){return Gs.concat(function(e){var t=Hs(kc(e));return t.length>0?T.some({name:"class",type:"listbox",label:"Class",items:t}):T.none()}(e).toArray())},Xs=function(e,t){var n=[{name:"borderstyle",type:"listbox",label:"Border style",items:[{text:"Select...",value:""}].concat(Hs(vc(e)))},{name:"bordercolor",type:"colorinput",label:"Border color"},{name:"backgroundcolor",type:"colorinput",label:"Background color"}];return{title:"Advanced",name:"advanced",items:"cell"===t?[{name:"borderwidth",type:"input",label:"Border width"}].concat(n):n}},Ys=function(e){return function(t,n){var r=t.dom;return{setAttrib:function(t,o){e&&!o||r.setAttrib(n,t,o)},setStyle:function(t,o){e&&!o||r.setStyle(n,t,o)},setFormat:function(r,o){e&&!o||(""===o?t.formatter.remove(r,{value:null},n,!0):t.formatter.apply(r,{value:o},n))}}}},Qs={normal:Ys(!1),ifTruthy:Ys(!0)},Zs=function(e){return function(t){return oe(t,"rgb")?e.toHex(t):t}},ef=function(e,t){var n=xe.fromDom(t);return{borderwidth:qt(n,"border-width").getOr(""),borderstyle:qt(n,"border-style").getOr(""),bordercolor:qt(n,"border-color").map(Zs(e)).getOr(""),backgroundcolor:qt(n,"background-color").map(Zs(e)).getOr("")}},tf=function(e){var t=e[0],n=e.slice(1);return I(n,(function(e){I(Re(t),(function(n){Oe(e,(function(e,r){var o=t[n];""!==o&&n===r&&o!==e&&(t[n]="")}))}))})),t},nf=function(e,t,n,r){return F(e,(function(e){return!u(n.formatter.matchNode(r,t+e))})).getOr("")},rf=h(nf,["left","center","right"],"align"),of=h(nf,["top","middle","bottom"],"valign"),af=function(e){return an(xe.fromDom(e)).map((function(t){var n={selection:mi(e.cells)};return is(t,n)})).getOr("")},cf=function(e,t){var n=An.fromTable(e),r=An.justCells(n),o=B(r,(function(e){return R(t,(function(t){return Ee(e.element,t)}))}));return O(o,(function(e){return{element:e.element.dom,column:An.getColumnAt(n,e.column).map((function(e){return e.element.dom}))}}))},uf=function(e,t,n){var r=1===t.length;I(t,(function(t){var o=t.element,i=r?Qs.normal(e,o):Qs.ifTruthy(e,o);!function(e,t,n){e.setAttrib("scope",n.scope),e.setAttrib("class",n.class),e.setStyle("height",bi(n.height)),t.setStyle("width",bi(n.width))}(i,t.column.map((function(t){return r?Qs.normal(e,t):Qs.ifTruthy(e,t)})).getOr(i),n),wc(e)&&function(e,t){e.setFormat("tablecellbackgroundcolor",t.backgroundcolor),e.setFormat("tablecellbordercolor",t.bordercolor),e.setFormat("tablecellborderstyle",t.borderstyle),e.setFormat("tablecellborderwidth",bi(t.borderwidth))}(i,n),r&&(xs(e,o),function(e,t){ys.each("top middle bottom".split(" "),(function(n){e.formatter.remove("valign"+n,{},t)}))}(e,o)),n.halign&&Cs(e,o,n.halign),n.valign&&function(e,t,n){n&&e.formatter.apply("valign"+n,{},t)}(e,o,n.valign)}))},lf=function(e,t,n,r){var o=r.getData();r.close(),e.undoManager.transact((function(){!function(e,t,n,r){var o=Be(r,(function(e,t){return n[t]!==e}));Fe(o)>0&&t.length>=1&&an(t[0]).each((function(n){var i=cf(n,t),a=Fe(Be(o,(function(e,t){return"scope"!==t&&"celltype"!==t})))>0,c=He(o,"celltype");(a||He(o,"scope"))&&uf(e,i,r),c&&function(e,t){e.execCommand("mceTableCellType",!1,{type:t.celltype,no_events:!0})}(e,r),ac(e,n.dom,{structure:c,style:a})}))}(e,t,n,o),e.focus()}))},sf=function(e,t){var n=an(t[0]).map((function(n){return O(cf(n,t),(function(t){return function(e,t,n,r){var o,i=e.dom,a=r.getOr(t),c=function(e,t){return i.getStyle(e,t)||i.getAttrib(e,t)};return J({width:c(a,"width"),height:c(t,"height"),scope:i.getAttrib(t,"scope"),celltype:(o=t,o.nodeName.toLowerCase()),class:i.getAttrib(t,"class",""),halign:rf(e,t),valign:of(e,t)},n?ef(i,t):{})}(e,t.element,wc(e),t.column)}))}));return tf(n.getOrDie())},ff=function(e,t){var n=Ni(t);if(0!==n.length){var r=sf(e,n),o={type:"tabpanel",tabs:[{title:"General",name:"general",items:Js(e)},Xs(e,"cell")]},i={type:"panel",items:[{type:"grid",columns:2,items:Js(e)}]};e.windowManager.open({title:"Cell Properties",size:"normal",body:wc(e)?o:i,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:r,onSubmit:h(lf,e,n,r)})}},df=[{type:"listbox",name:"type",label:"Row type",items:[{text:"Header",value:"header"},{text:"Body",value:"body"},{text:"Footer",value:"footer"}]},{type:"listbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"Height",name:"height",type:"input"}],mf=function(e){return df.concat(function(e){var t=Hs(function(e){return e.getParam("table_row_class_list",[],"array")}(e));return t.length>0?T.some({name:"class",type:"listbox",label:"Class",items:t}):T.none()}(e).toArray())},pf=function(e,t,n,r){var o=1===t.length;I(t,(function(t){var i=o?Qs.normal(e,t):Qs.ifTruthy(e,t);!function(e,t){e.setAttrib("class",t.class),e.setStyle("height",bi(t.height))}(i,n),Cc(e)&&function(e,t){e.setStyle("background-color",t.backgroundcolor),e.setStyle("border-color",t.bordercolor),e.setStyle("border-style",t.borderstyle)}(i,n),n.align!==r.align&&(xs(e,t),Cs(e,t,n.align))}))},gf=function(e,t,n,r){var o=r.getData();r.close(),e.undoManager.transact((function(){!function(e,t,n,r){var o=Be(r,(function(e,t){return n[t]!==e}));if(Fe(o)>0){var i=He(o,"type"),a=!i||Fe(o)>1;a&&pf(e,t,r,n),i&&function(e,t){e.execCommand("mceTableRowType",!1,{type:t.type,no_events:!0})}(e,r),an(xe.fromDom(t[0])).each((function(t){return ac(e,t.dom,{structure:i,style:a})}))}}(e,t,n,o),e.focus()}))},hf=function(e){var t,n,r,o,i=(t=wi(e),n=ki.selected,r=_i(t),o=r.bind((function(e){return an(e)})).map((function(e){return cn(e)})),Lt(r,o,(function(e,t){return B(t,(function(t){return R(mi(t.dom.cells),(function(t){return"1"===Dt(t,n)||Ee(t,e)}))}))})).getOr([]));if(0!==i.length){var a=O(i,(function(t){return function(e,t,n){var r=e.dom;return J({height:r.getStyle(t,"height")||r.getAttrib(t,"height"),class:r.getAttrib(t,"class",""),type:af(t),align:rf(e,t)},n?ef(r,t):{})}(e,t.dom,Cc(e))})),c=tf(a),u={type:"tabpanel",tabs:[{title:"General",name:"general",items:mf(e)},Xs(e,"row")]},l={type:"panel",items:[{type:"grid",columns:2,items:mf(e)}]};e.windowManager.open({title:"Row Properties",size:"normal",body:Cc(e)?u:l,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:c,onSubmit:h(gf,e,O(i,(function(e){return e.dom})),c)})}},vf=function(e,t,n){var r=n?[{type:"input",name:"cols",label:"Cols",inputMode:"numeric"},{type:"input",name:"rows",label:"Rows",inputMode:"numeric"}]:[],o=function(e){return e.getParam("table_appearance_options",!0,"boolean")}(e)?[{type:"input",name:"cellspacing",label:"Cell spacing",inputMode:"numeric"},{type:"input",name:"cellpadding",label:"Cell padding",inputMode:"numeric"},{type:"input",name:"border",label:"Border width"},{type:"label",label:"Caption",items:[{type:"checkbox",name:"caption",label:"Show caption"}]}]:[],i=t.length>0?[{type:"listbox",name:"class",label:"Class",items:t}]:[];return r.concat([{type:"input",name:"width",label:"Width"},{type:"input",name:"height",label:"Height"}]).concat(o).concat([{type:"listbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]}]).concat(i)},bf=function(e,t,n,o){if("TD"===t.tagName||"TH"===t.tagName)r(n)?e.setStyle(t,n,o):e.setStyle(t,n);else if(t.children)for(var i=0;i<t.children.length;i++)bf(e,t.children[i],n,o)},yf=function(e,t,n,r){var o=e.dom,i=r.getData(),a=Be(i,(function(e,t){return n[t]!==e}));r.close(),""===i.class&&delete i.class,e.undoManager.transact((function(){if(!t){var n=parseInt(i.cols,10)||1,r=parseInt(i.rows,10)||1;t=fs(e,n,r,0,0)}if(Fe(a)>0){!function(e,t,n){var r=e.dom,o={},i={};if(o.class=n.class,i.height=bi(n.height),r.getAttrib(t,"width")&&!Sc(e)?o.width=function(e){return e?e.replace(/px$/,""):""}(n.width):i.width=bi(n.width),Sc(e)?(i["border-width"]=bi(n.border),i["border-spacing"]=bi(n.cellspacing)):(o.border=n.border,o.cellpadding=n.cellpadding,o.cellspacing=n.cellspacing),Sc(e)&&t.children)for(var a=0;a<t.children.length;a++)bf(r,t.children[a],{"border-width":bi(n.border),padding:bi(n.cellpadding)}),xc(e)&&bf(r,t.children[a],{"border-color":n.bordercolor});xc(e)&&(i["background-color"]=n.backgroundcolor,i["border-color"]=n.bordercolor,i["border-style"]=n.borderstyle),o.style=r.serializeStyle(J(J({},yc(e)),i)),r.setAttribs(t,J(J({},bc(e)),o))}(e,t,i);var c=o.select("caption",t)[0];(c&&!i.caption||!c&&i.caption)&&e.execCommand("mceTableToggleCaption"),""===i.align?xs(e,t):Cs(e,t,i.align)}if(e.focus(),e.addVisual(),Fe(a)>0){var u=He(a,"caption"),l=!u||Fe(a)>1;ac(e,t,{structure:u,style:l})}}))},wf=function(e,t){var n,r=e.dom,o=function(e,t){var n,r,o,i,a=yc(e),c=bc(e),u=t?(n=e.dom,{borderstyle:je(a,"border-style").getOr(""),bordercolor:Zs(n)(je(a,"border-color").getOr("")),backgroundcolor:Zs(n)(je(a,"background-color").getOr(""))}):{};return J(J(J(J(J(J({},{height:"",width:"100%",cellspacing:"",cellpadding:"",caption:!1,class:"",align:"",border:""}),a),c),u),(i=a["border-width"],Sc(e)&&i?{border:i}:je(c,"border").fold((function(){return{}}),(function(e){return{border:e}})))),(r=je(a,"border-spacing").or(je(c,"cellspacing")).fold((function(){return{}}),(function(e){return{cellspacing:e}})),o=je(a,"border-padding").or(je(c,"cellpadding")).fold((function(){return{}}),(function(e){return{cellpadding:e}})),J(J({},r),o)))}(e,xc(e));!1===t?(n=r.getParent(e.selection.getStart(),"table",e.getBody()))?o=function(e,t,n){var r=e.dom,o=Sc(e)?r.getStyle(t,"border-spacing")||r.getAttrib(t,"cellspacing"):r.getAttrib(t,"cellspacing")||r.getStyle(t,"border-spacing"),i=Sc(e)?ws(r,t,"padding")||r.getAttrib(t,"cellpadding"):r.getAttrib(t,"cellpadding")||ws(r,t,"padding");return J({width:r.getStyle(t,"width")||r.getAttrib(t,"width"),height:r.getStyle(t,"height")||r.getAttrib(t,"height"),cellspacing:o,cellpadding:i,border:function(t,n){var r=qt(xe.fromDom(n),"border-width");return Sc(e)&&r.isSome()?r.getOr(""):t.getAttrib(n,"border")||ws(e.dom,n,"border-width")||ws(e.dom,n,"border")}(r,t),caption:!!r.select("caption",t)[0],class:r.getAttrib(t,"class",""),align:rf(e,t)},n?ef(r,t):{})}(e,n,xc(e)):xc(e)&&(o.borderstyle="",o.bordercolor="",o.backgroundcolor=""):(o.cols="1",o.rows="1",xc(e)&&(o.borderstyle="",o.bordercolor="",o.backgroundcolor=""));var i=Hs(Tc(e));i.length>0&&o.class&&(o.class=o.class.replace(/\s*mce\-item\-table\s*/g,""));var a={type:"grid",columns:2,items:vf(e,i,t)},c=xc(e)?{type:"tabpanel",tabs:[{title:"General",name:"general",items:[a]},Xs(e,"table")]}:{type:"panel",items:[a]};e.windowManager.open({title:"Table Properties",size:"normal",body:c,onSubmit:h(yf,e,n,o),buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:o})},Cf=function(e){return Ai(wi(e),vi(e))},xf=function(e,t,n,i,a){var c=vi(e),u=function(e){return an(e,c)},l=function(t){return function(e){return _i(wi(e),vi(e))}(e).bind((function(e){return u(e).map((function(n){return t(n,e)}))}))},s=function(t){e.focus()},f=function(e,t){return void 0===t&&(t=!1),l((function(n,r){var o=Ti(i,n,r);e(n,o,t).each(s)}))},m=function(){return l((function(t,n){var r=Ti(i,t,n),o=fi(d,xe.fromDom(e.getDoc()),T.none());return bs(t,r,o)}))},p=function(){return l((function(e,t){var n=Ti(i,e,t);return vs(e,n)}))},g=function(t,n){return n().each((function(n){var r=O(n,(function(e){return kr(e)}));l((function(n,o){var a=di(xe.fromDom(e.getDoc())),c=function(e,t,n,r){return{selection:Ci(e),clipboard:n,generators:r}}(i,0,r,a);t(n,c).each(s)}))}))},v=function(e){return function(t,n){return je(n,"type").each((function(t){f(e(t),n.no_events)}))}};Oe({mceTableSplitCells:function(){return f(t.unmergeCells)},mceTableMergeCells:function(){return f(t.mergeCells)},mceTableInsertRowBefore:function(){return f(t.insertRowsBefore)},mceTableInsertRowAfter:function(){return f(t.insertRowsAfter)},mceTableInsertColBefore:function(){return f(t.insertColumnsBefore)},mceTableInsertColAfter:function(){return f(t.insertColumnsAfter)},mceTableDeleteCol:function(){return f(t.deleteColumn)},mceTableDeleteRow:function(){return f(t.deleteRow)},mceTableCutCol:function(){return p().each((function(e){a.setColumns(e),f(t.deleteColumn)}))},mceTableCutRow:function(){return m().each((function(e){a.setRows(e),f(t.deleteRow)}))},mceTableCopyCol:function(){return p().each((function(e){return a.setColumns(e)}))},mceTableCopyRow:function(){return m().each((function(e){return a.setRows(e)}))},mceTablePasteColBefore:function(){return g(t.pasteColsBefore,a.getColumns)},mceTablePasteColAfter:function(){return g(t.pasteColsAfter,a.getColumns)},mceTablePasteRowBefore:function(){return g(t.pasteRowsBefore,a.getRows)},mceTablePasteRowAfter:function(){return g(t.pasteRowsAfter,a.getRows)},mceTableDelete:function(){return Cf(e).each((function(t){an(t,c).filter(y(c)).each((function(t){var n=xe.fromText("");if(jn(t,n),$n(t),e.dom.isEmpty(e.getBody()))e.setContent(""),e.selection.setCursorLocation();else{var r=e.dom.createRng();r.setStart(n.dom,0),r.setEnd(n.dom,0),e.selection.setRng(r),e.nodeChanged()}}))}))},mceTableCellToggleClass:function(t,n){l((function(t){var r=Ni(i),o=z(r,(function(t){return e.formatter.match("tablecellclass",{value:n},t.dom)}))?e.formatter.remove:e.formatter.apply;I(r,(function(e){return o("tablecellclass",{value:n},e.dom)})),ac(e,t.dom,cc)}))},mceTableToggleClass:function(t,n){l((function(t){e.formatter.toggle("tableclass",{value:n},t.dom),ac(e,t.dom,cc)}))},mceTableToggleCaption:function(){Cf(e).each((function(t){an(t,c).each((function(n){Tt(n,"caption").fold((function(){var t=xe.fromTag("caption");Un(t,xe.fromText("Caption")),function(e,t,n){lt(e,n).fold((function(){Un(e,t)}),(function(e){Fn(e,t)}))}(n,t,0),e.selection.setCursorLocation(t.dom,0)}),(function(r){tt("caption")(t)&&Te("td",n).each((function(t){return e.selection.setCursorLocation(t.dom,0)})),$n(r)})),ac(e,n.dom,uc)}))}))},mceTableSizingMode:function(t,n){return function(t){return Cf(e).each((function(n){_c(e)||Ac(e)||Ec(e)||an(n,c).each((function(n){"relative"!==t||aa(n)?"fixed"!==t||ca(n)?"responsive"!==t||ua(n)||Uc(n):Hc(n):jc(n),yi(n),ac(e,n.dom,uc)}))}))}(n)},mceTableCellType:v((function(e){return"th"===e?t.makeCellsHeader:t.unmakeCellsHeader})),mceTableColType:v((function(e){return"th"===e?t.makeColumnsHeader:t.unmakeColumnsHeader})),mceTableRowType:v((function(e){switch(e){case"header":return t.makeRowsHeader;case"footer":return t.makeRowsFooter;default:return t.makeRowsBody}}))},(function(t,n){return e.addCommand(n,t)})),Oe({mceTableProps:h(wf,e,!1),mceTableRowProps:h(hf,e),mceTableCellProps:h(ff,e,i)},(function(t,n){return e.addCommand(n,(function(){return t()}))})),e.addCommand("mceInsertTable",(function(t,n){o(n)&&Re(n).length>0?ds(e,n.rows,n.columns,n.options,"Invalid values for mceInsertTable - rows and columns values are required to insert a table."):wf(e,!0)})),e.addCommand("mceTableApplyCellStyle",(function(t,n){var a=function(e){return"tablecell"+e.toLowerCase().replace("-","")};if(o(n)){var c=Ni(i);if(0!==c.length){var l=Be(n,(function(t,n){return e.formatter.has(a(n))&&r(t)}));(function(e){for(var t in e)if(De.call(e,t))return!1;return!0})(l)||(Oe(l,(function(t,n){I(c,(function(r){Qs.normal(e,r.dom).setFormat(a(n),t)}))})),u(c[0]).each((function(t){return ac(e,t.dom,cc)})))}}}))},Sf={remove_similar:!0,inherit:!1},kf=J({selector:"td,th"},Sf),Tf={tablecellbackgroundcolor:J({styles:{backgroundColor:"%value"}},kf),tablecellverticalalign:J({styles:{"vertical-align":"%value"}},kf),tablecellbordercolor:J({styles:{borderColor:"%value"}},kf),tablecellclass:J({classes:["%value"]},kf),tableclass:J({selector:"table",classes:["%value"]},Sf),tablecellborderstyle:J({styles:{borderStyle:"%value"}},kf),tablecellborderwidth:J({styles:{borderWidth:"%value"}},kf)},Ef=gr([{none:["current"]},{first:["current"]},{middle:["current","target"]},{last:["current"]}]),Af=J(J({},Ef),{none:function(e){return void 0===e&&(e=void 0),Ef.none(e)}}),_f=function(e,t,n,r,o){void 0===o&&(o=C);var i=1===r;if(!i&&n<=0)return Af.first(e[0]);if(i&&n>=e.length-1)return Af.last(e[e.length-1]);var a=n+r,c=e[a];return o(c)?Af.middle(t,c):_f(e,t,a,r,o)},Nf=function(e,t){return an(e,t).bind((function(t){var n=rn(t);return j(n,(function(t){return Ee(e,t)})).map((function(e){return{index:e,all:n}}))}))},Rf=function(e,t,n,r){return{start:e,soffset:t,finish:n,foffset:r}},Df=gr([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),Of={before:Df.before,on:Df.on,after:Df.after,cata:function(e,t,n,r){return e.fold(t,n,r)},getStart:function(e){return e.fold(p,p,p)}},If=gr([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),Pf={domRange:If.domRange,relative:If.relative,exact:If.exact,exactFromRange:function(e){return If.exact(e.start,e.soffset,e.finish,e.foffset)},getWin:function(e){var t,n=function(e){return e.match({domRange:function(e){return xe.fromDom(e.startContainer)},relative:function(e,t){return Of.getStart(e)},exact:function(e,t,n,r){return e}})}(e);return t=n,xe.fromDom(rt(t).dom.defaultView)},range:Rf},Bf=function(e,t){var n=e.document.createRange();return n.selectNode(t.dom),n},Mf=function(e,t){var n=e.document.createRange();return Lf(n,t),n},Lf=function(e,t){return e.selectNodeContents(t.dom)},Ff=function(e,t,n){var r,o=e.document.createRange();return r=o,t.fold((function(e){r.setStartBefore(e.dom)}),(function(e,t){r.setStart(e.dom,t)}),(function(e){r.setStartAfter(e.dom)})),function(e,t){t.fold((function(t){e.setEndBefore(t.dom)}),(function(t,n){e.setEnd(t.dom,n)}),(function(t){e.setEndAfter(t.dom)}))}(o,n),o},jf=function(e,t,n,r,o){var i=e.document.createRange();return i.setStart(t.dom,n),i.setEnd(r.dom,o),i},Hf=function(e){return{left:e.left,top:e.top,right:e.right,bottom:e.bottom,width:e.width,height:e.height}},Uf=gr([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),zf=function(e,t,n){return t(xe.fromDom(n.startContainer),n.startOffset,xe.fromDom(n.endContainer),n.endOffset)},Wf=function(e,t){return function(e,t){var n=t.ltr();return n.collapsed?t.rtl().filter((function(e){return!1===e.collapsed})).map((function(e){return Uf.rtl(xe.fromDom(e.endContainer),e.endOffset,xe.fromDom(e.startContainer),e.startOffset)})).getOrThunk((function(){return zf(0,Uf.ltr,n)})):zf(0,Uf.ltr,n)}(0,function(e,t){return t.match({domRange:function(e){return{ltr:m(e),rtl:T.none}},relative:function(t,n){return{ltr:Y((function(){return Ff(e,t,n)})),rtl:Y((function(){return T.some(Ff(e,n,t))}))}},exact:function(t,n,r,o){return{ltr:Y((function(){return jf(e,t,n,r,o)})),rtl:Y((function(){return T.some(jf(e,r,o,t,n))}))}}})}(e,t))},Vf=function(e,t){return Wf(e,t).match({ltr:function(t,n,r,o){var i=e.document.createRange();return i.setStart(t.dom,n),i.setEnd(r.dom,o),i},rtl:function(t,n,r,o){var i=e.document.createRange();return i.setStart(r.dom,o),i.setEnd(t.dom,n),i}})};Uf.ltr,Uf.rtl;var qf=function(e,t,n){return t>=e.left&&t<=e.right&&n>=e.top&&n<=e.bottom},$f=function(e,t,n,r,o){var i=function(n){var r=e.dom.createRange();return r.setStart(t.dom,n),r.collapse(!0),r},a=Jn(t).length,c=function(e,t,n,r,o){if(0===o)return 0;if(t===r)return o-1;for(var i=r,a=1;a<o;a++){var c=e(a),u=Math.abs(t-c.left);if(n<=c.bottom){if(n<c.top||u>i)return a-1;i=u}}return 0}((function(e){return i(e).getBoundingClientRect()}),n,r,o.right,a);return i(c)},Kf=function(e,t,n,r){return Qe(t)?function(e,t,n,r){var o=e.dom.createRange();o.selectNode(t.dom);var i=o.getClientRects();return G(i,(function(e){return qf(e,n,r)?T.some(e):T.none()})).map((function(o){return $f(e,t,n,r,o)}))}(e,t,n,r):function(e,t,n,r){var o=e.dom.createRange(),i=ut(t);return G(i,(function(t){return o.selectNode(t.dom),qf(o.getBoundingClientRect(),n,r)?Kf(e,t,n,r):T.none()}))}(e,t,n,r)},Gf=function(e,t){return t-e.left<e.right-t},Jf=function(e,t,n){var r=e.dom.createRange();return r.selectNode(t.dom),r.collapse(n),r},Xf=function(e,t,n){var r=e.dom.createRange();r.selectNode(t.dom);var o=r.getBoundingClientRect(),i=Gf(o,n);return(!0===i?ti:ni)(t).map((function(t){return Jf(e,t,i)}))},Yf=function(e,t,n){var r=t.dom.getBoundingClientRect(),o=Gf(r,n);return T.some(Jf(e,t,o))},Qf=function(e,t,n){var r,o;return T.from(null===(o=(r=e.dom).caretPositionFromPoint)||void 0===o?void 0:o.call(r,t,n)).bind((function(t){if(null===t.offsetNode)return T.none();var n=e.dom.createRange();return n.setStart(t.offsetNode,t.offset),n.collapse(),T.some(n)}))},Zf=function(e,t,n){var r,o;return T.from(null===(o=(r=e.dom).caretRangeFromPoint)||void 0===o?void 0:o.call(r,t,n))},ed=function(e,t,n,r){var o=e.dom.createRange();o.selectNode(t.dom);var i=o.getBoundingClientRect();return function(e,t,n,r){var o=e.dom.createRange();o.selectNode(t.dom);var i=o.getBoundingClientRect(),a=Math.max(i.left,Math.min(i.right,n)),c=Math.max(i.top,Math.min(i.bottom,r));return Kf(e,t,a,c)}(e,t,Math.max(i.left,Math.min(i.right,n)),Math.max(i.top,Math.min(i.bottom,r)))},td=function(e,t,n){return xe.fromPoint(e,t,n).bind((function(r){var o=function(){return function(e,t,n){return(0===ut(t).length?Yf:Xf)(e,t,n)}(e,r,t)};return 0===ut(r).length?o():ed(e,r,t,n).orThunk(o)}))},nd=document.caretPositionFromPoint?Qf:document.caretRangeFromPoint?Zf:td,rd=function(e,t){var n=Ke(e);return"input"===n?Of.after(e):N(["br","img"],n)?0===t?Of.before(e):Of.after(e):Of.on(e,t)},od=function(e,t){var n=e.fold(Of.before,rd,Of.after),r=t.fold(Of.before,rd,Of.after);return Pf.relative(n,r)},id=function(e,t,n,r){var o=rd(e,t),i=rd(n,r);return Pf.relative(o,i)},ad=function(e,t,n,r){var o=function(e,t,n,r){var o=nt(e).dom.createRange();return o.setStart(e.dom,t),o.setEnd(n.dom,r),o}(e,t,n,r),i=Ee(e,n)&&t===r;return o.collapsed&&!i},cd=function(e){return T.from(e.getSelection())},ud=function(e,t){cd(e).each((function(e){e.removeAllRanges(),e.addRange(t)}))},ld=function(e,t,n,r,o){var i=jf(e,t,n,r,o);ud(e,i)},sd=function(e,t){return Wf(e,t).match({ltr:function(t,n,r,o){ld(e,t,n,r,o)},rtl:function(t,n,r,o){cd(e).each((function(i){if(i.setBaseAndExtent)i.setBaseAndExtent(t.dom,n,r.dom,o);else if(i.extend)try{!function(e,t,n,r,o,i){t.collapse(n.dom,r),t.extend(o.dom,i)}(0,i,t,n,r,o)}catch(i){ld(e,r,o,t,n)}else ld(e,r,o,t,n)}))}})},fd=function(e,t,n,r,o){var i=id(t,n,r,o);sd(e,i)},dd=function(e,t,n){var r=od(t,n);sd(e,r)},md=function(e){var t=Pf.getWin(e).dom,n=function(e,n,r,o){return jf(t,e,n,r,o)},r=function(e){return e.match({domRange:function(e){var t=xe.fromDom(e.startContainer),n=xe.fromDom(e.endContainer);return id(t,e.startOffset,n,e.endOffset)},relative:od,exact:id})}(e);return Wf(t,r).match({ltr:n,rtl:n})},pd=function(e){if(e.rangeCount>0){var t=e.getRangeAt(0),n=e.getRangeAt(e.rangeCount-1);return T.some(Rf(xe.fromDom(t.startContainer),t.startOffset,xe.fromDom(n.endContainer),n.endOffset))}return T.none()},gd=function(e){if(null===e.anchorNode||null===e.focusNode)return pd(e);var t=xe.fromDom(e.anchorNode),n=xe.fromDom(e.focusNode);return ad(t,e.anchorOffset,n,e.focusOffset)?T.some(Rf(t,e.anchorOffset,n,e.focusOffset)):pd(e)},hd=function(e,t,n){void 0===n&&(n=!0);var r=(n?Mf:Bf)(e,t);ud(e,r)},vd=function(e){return function(e){return cd(e).filter((function(e){return e.rangeCount>0})).bind(gd)}(e).map((function(e){return Pf.exact(e.start,e.soffset,e.finish,e.foffset)}))},bd=function(e,t){return function(e){var t=e.getClientRects(),n=t.length>0?t[0]:e.getBoundingClientRect();return n.width>0||n.height>0?T.some(n).map(Hf):T.none()}(Vf(e,t))},yd=function(e,t,n){return function(e,t,n){var r=xe.fromDom(e.document);return nd(r,t,n).map((function(e){return Rf(xe.fromDom(e.startContainer),e.startOffset,xe.fromDom(e.endContainer),e.endOffset)}))}(e,t,n)},wd=tinymce.util.Tools.resolve("tinymce.util.VK"),Cd=function(e,t,n){return Sd(e,t,function(e,t,n){return Nf(e,n).fold((function(){return Af.none(e)}),(function(n){return _f(n.all,e,n.index,1,t)}))}(n,Fa))},xd=function(e,t,n){return Sd(e,t,function(e,t,n){return Nf(e,n).fold((function(){return Af.none()}),(function(n){return _f(n.all,e,n.index,-1,t)}))}(n,Fa))},Sd=function(e,t,n){return n.fold(T.none,T.none,(function(e,t){return ti(t).map((function(e){return function(e,t){var n=Pf.exact(t,0,t,0);return md(n)}(0,e)}))}),(function(n){return e.execCommand("mceTableInsertRowAfter"),Cd(e,t,n)}))},kd=["table","li","dl"],Td=function(e,t){return{selection:e,kill:t}},Ed=function(e,t,n,r){return{start:Of.on(e,t),finish:Of.on(n,r)}},Ad=function(e,t){var n=Vf(e,t);return Rf(xe.fromDom(n.startContainer),n.startOffset,xe.fromDom(n.endContainer),n.endOffset)},_d=Ed,Nd=function(e,t,n,r,o){return Ee(n,r)?T.none():lr(n,r,t).bind((function(t){var r=t.boxes.getOr([]);return r.length>1?(o(e,r,t.start,t.finish),T.some(Td(T.some(_d(n,0,n,Qo(n))),!0))):T.none()}))},Rd=function(e,t){return{item:e,mode:t}},Dd=function(e,t,n,r){return void 0===r&&(r=Od),e.property().parent(t).map((function(e){return Rd(e,r)}))},Od=function(e,t,n,r){return void 0===r&&(r=Id),n.sibling(e,t).map((function(e){return Rd(e,r)}))},Id=function(e,t,n,r){void 0===r&&(r=Id);var o=e.property().children(t);return n.first(o).map((function(e){return Rd(e,r)}))},Pd=[{current:Dd,next:Od,fallback:T.none()},{current:Od,next:Id,fallback:T.some(Dd)},{current:Id,next:Id,fallback:T.some(Od)}],Bd=function(e,t,n,r,o){return void 0===o&&(o=Pd),F(o,(function(e){return e.current===n})).bind((function(n){return n.current(e,t,r,n.next).orThunk((function(){return n.fallback.bind((function(n){return Bd(e,t,n,r)}))}))}))},Md=function(){return{sibling:function(e,t){return e.query().prevSibling(t)},first:function(e){return e.length>0?T.some(e[e.length-1]):T.none()}}},Ld=function(){return{sibling:function(e,t){return e.query().nextSibling(t)},first:function(e){return e.length>0?T.some(e[0]):T.none()}}},Fd=function(e,t,n,r,o,i){return Bd(e,t,r,o).bind((function(t){return i(t.item)?T.none():n(t.item)?T.some(t.item):Fd(e,t.item,n,t.mode,o,i)}))},jd=function(e){return function(t){return 0===e.property().children(t).length}},Hd=function(e,t,n,r){return Fd(e,t,n,Od,Md(),r)},Ud=function(e,t,n,r){return Fd(e,t,n,Od,Ld(),r)},zd=Zn(),Wd=function(e,t){return function(e,t,n){return Hd(e,t,jd(e),n)}(zd,e,t)},Vd=function(e,t){return function(e,t,n){return Ud(e,t,jd(e),n)}(zd,e,t)},qd=gr([{none:["message"]},{success:[]},{failedUp:["cell"]},{failedDown:["cell"]}]),$d=function(e){return At(e,"tr")},Kd=J(J({},qd),{verify:function(e,t,n,r,o,i,a){return At(r,"td,th",a).bind((function(n){return At(t,"td,th",a).map((function(t){return Ee(n,t)?Ee(r,n)&&Qo(n)===o?i(t):qd.none("in same cell"):cr($d,[n,t]).fold((function(){return function(e,t,n){var r=e.getRect(t),o=e.getRect(n);return o.right>r.left&&o.left<r.right}(e,t,n)?qd.success():i(t)}),(function(e){return i(t)}))}))})).getOr(qd.none("default"))},cata:function(e,t,n,r,o){return e.fold(t,n,r,o)}}),Gd=function(e,t){return j(e,h(Ee,t))},Jd=function(e){return"br"===Ke(e)},Xd=function(e,t,n){return t(e,n).bind((function(e){return Qe(e)&&0===Jn(e).trim().length?Xd(e,t,n):T.some(e)}))},Yd=function(e,t,n,r){return function(e,t){return lt(e,t).filter(Jd).orThunk((function(){return lt(e,t-1).filter(Jd)}))}(t,n).bind((function(t){return r.traverse(t).fold((function(){return Xd(t,r.gather,e).map(r.relative)}),(function(e){return function(e){return ot(e).bind((function(t){var n=ut(t);return Gd(n,e).map((function(r){return function(e,t,n,r){return{parent:e,children:t,element:n,index:r}}(t,n,e,r)}))}))}(e).map((function(e){return Of.on(e.parent,e.index)}))}))}))},Qd=function(e,t,n,r){return(Jd(t)?function(e,t,n){return n.traverse(t).orThunk((function(){return Xd(t,n.gather,e)})).map(n.relative)}(e,t,r):Yd(e,t,n,r)).map((function(e){return{start:e,finish:e}}))},Zd=function(e,t){return{left:e.left,top:e.top+t,right:e.right,bottom:e.bottom+t}},em=function(e,t){return{left:e.left,top:e.top-t,right:e.right,bottom:e.bottom-t}},tm=function(e,t,n){return{left:e.left+t,top:e.top+n,right:e.right+t,bottom:e.bottom+n}},nm=function(e){return{left:e.left,top:e.top,right:e.right,bottom:e.bottom}},rm=function(e,t){return T.some(e.getRect(t))},om=function(e,t,n){return Ye(t)?rm(e,t).map(nm):Qe(t)?function(e,t,n){return n>=0&&n<Qo(t)?e.getRangedRect(t,n,t,n+1):n>0?e.getRangedRect(t,n-1,t,n):T.none()}(e,t,n).map(nm):T.none()},im=function(e,t){return Ye(t)?rm(e,t).map(nm):Qe(t)?e.getRangedRect(t,0,t,Qo(t)).map(nm):T.none()},am=gr([{none:[]},{retry:["caret"]}]),cm=function(e,t,n){return(r=t,o=ml,xt((function(e,t){return t(e)}),St,r,o,i)).fold(w,(function(t){return im(e,t).exists((function(e){return function(e,t){return e.left<t.left||Math.abs(t.right-e.left)<1||e.left>t.right}(n,e)}))}));var r,o,i},um={point:function(e){return e.bottom},adjuster:function(e,t,n,r,o){var i=Zd(o,5);return Math.abs(n.bottom-r.bottom)<1||n.top>o.bottom?am.retry(i):n.top===o.bottom?am.retry(Zd(o,1)):cm(e,t,o)?am.retry(tm(i,5,0)):am.none()},move:Zd,gather:Vd},lm=function(e,t,n,r,o){return 0===o?T.some(r):function(e,t,n){return e.elementFromPoint(t,n).filter((function(e){return"table"===Ke(e)})).isSome()}(e,r.left,t.point(r))?function(e,t,n,r,o){return lm(e,t,n,t.move(r,5),o)}(e,t,n,r,o-1):e.situsFromPoint(r.left,t.point(r)).bind((function(i){return i.start.fold(T.none,(function(i){return im(e,i).bind((function(a){return t.adjuster(e,i,a,n,r).fold(T.none,(function(r){return lm(e,t,n,r,o-1)}))})).orThunk((function(){return T.some(r)}))}),T.none)}))},sm=function(e,t,n){var r=e.move(n,5),o=lm(t,e,n,r,100).getOr(r);return function(e,t,n){return e.point(t)>n.getInnerHeight()?T.some(e.point(t)-n.getInnerHeight()):e.point(t)<0?T.some(-e.point(t)):T.none()}(e,o,t).fold((function(){return t.situsFromPoint(o.left,e.point(o))}),(function(n){return t.scrollBy(0,n),t.situsFromPoint(o.left,e.point(o)-n)}))},fm={tryUp:h(sm,{point:function(e){return e.top},adjuster:function(e,t,n,r,o){var i=em(o,5);return Math.abs(n.top-r.top)<1||n.bottom<o.top?am.retry(i):n.bottom===o.top?am.retry(em(o,1)):cm(e,t,o)?am.retry(tm(i,5,0)):am.none()},move:em,gather:Wd}),tryDown:h(sm,um),ieTryUp:function(e,t){return e.situsFromPoint(t.left,t.top-5)},ieTryDown:function(e,t){return e.situsFromPoint(t.left,t.bottom+5)},getJumpSize:m(5)},dm=function(e,t,n){return e.getSelection().bind((function(r){return Qd(t,r.finish,r.foffset,n).fold((function(){return T.some(qc(r.finish,r.foffset))}),(function(o){var i=e.fromSitus(o);return function(e){return Kd.cata(e,(function(e){return T.none()}),(function(){return T.none()}),(function(e){return T.some(qc(e,0))}),(function(e){return T.some(qc(e,Qo(e)))}))}(Kd.verify(e,r.finish,r.foffset,i.finish,i.foffset,n.failure,t))}))}))},mm=function(e,t,n,r,o,i){return 0===i?T.none():hm(e,t,n,r,o).bind((function(a){var c=e.fromSitus(a),u=Kd.verify(e,n,r,c.finish,c.foffset,o.failure,t);return Kd.cata(u,(function(){return T.none()}),(function(){return T.some(a)}),(function(a){return Ee(n,a)&&0===r?pm(e,n,r,em,o):mm(e,t,a,0,o,i-1)}),(function(a){return Ee(n,a)&&r===Qo(a)?pm(e,n,r,Zd,o):mm(e,t,a,Qo(a),o,i-1)}))}))},pm=function(e,t,n,r,o){return om(e,t,n).bind((function(t){return gm(e,o,r(t,fm.getJumpSize()))}))},gm=function(e,t,n){var r=we().browser;return r.isChrome()||r.isSafari()||r.isFirefox()||r.isEdge()?t.otherRetry(e,n):r.isIE()?t.ieRetry(e,n):T.none()},hm=function(e,t,n,r,o){return om(e,n,r).bind((function(t){return gm(e,o,t)}))},vm=function(e,t){return St(e,(function(e){return ot(e).exists((function(e){return Ee(e,t)}))}),n).isSome();var n},bm=function(e,t,n,r,o){return At(r,"td,th",t).bind((function(r){return At(r,"table",t).bind((function(i){return vm(o,i)?function(e,t,n){return dm(e,t,n).bind((function(r){return mm(e,t,r.element,r.offset,n,20).map(e.fromSitus)}))}(e,t,n).bind((function(e){return At(e.finish,"td,th",t).map((function(t){return{start:r,finish:t,range:e}}))})):T.none()}))}))},ym=function(e,t,n,r,o,i){return we().browser.isIE()?T.none():i(r,t).orThunk((function(){return bm(e,t,n,r,o).map((function(e){var t=e.range;return Td(T.some(_d(t.start,t.soffset,t.finish,t.foffset)),!0)}))}))},wm=function(e,t){return At(e,"tr",t).bind((function(e){return At(e,"table",t).bind((function(n){var r=Ct(n,"tr");return Ee(e,r[0])?function(e,t,n){return Hd(zd,e,t,n)}(n,(function(e){return ni(e).isSome()}),t).map((function(e){var t=Qo(e);return Td(T.some(_d(e,t,e,t)),!0)})):T.none()}))}))},Cm=function(e,t){return At(e,"tr",t).bind((function(e){return At(e,"table",t).bind((function(n){var r=Ct(n,"tr");return Ee(e,r[r.length-1])?function(e,t,n){return Ud(zd,e,t,n)}(n,(function(e){return ti(e).isSome()}),t).map((function(e){return Td(T.some(_d(e,0,e,0)),!0)})):T.none()}))}))},xm=function(e,t,n,r,o,i,a){return bm(e,n,r,o,i).bind((function(e){return Nd(t,n,e.start,e.finish,a)}))},Sm=function(e,t){return At(e,"td,th",t)},km={traverse:ct,gather:Vd,relative:Of.before,otherRetry:fm.tryDown,ieRetry:fm.ieTryDown,failure:Kd.failedDown},Tm={traverse:at,gather:Wd,relative:Of.before,otherRetry:fm.tryUp,ieRetry:fm.ieTryUp,failure:Kd.failedUp},Em=function(e){return function(t){return t===e}},Am=Em(38),_m=Em(40),Nm=function(e){return e>=37&&e<=40},Rm={isBackward:Em(37),isForward:Em(39)},Dm={isBackward:Em(39),isForward:Em(37)},Om=function(e){return{elementFromPoint:function(t,n){return xe.fromPoint(xe.fromDom(e.document),t,n)},getRect:function(e){return e.dom.getBoundingClientRect()},getRangedRect:function(t,n,r,o){var i=Pf.exact(t,n,r,o);return bd(e,i)},getSelection:function(){return vd(e).map((function(t){return Ad(e,t)}))},fromSitus:function(t){var n=Pf.relative(t.start,t.finish);return Ad(e,n)},situsFromPoint:function(t,n){return yd(e,t,n).map((function(e){return Ed(e.start,e.soffset,e.finish,e.foffset)}))},clearSelection:function(){!function(e){cd(e).each((function(e){return e.removeAllRanges()}))}(e)},collapseSelection:function(t){void 0===t&&(t=!1),vd(e).each((function(n){return n.fold((function(e){return e.collapse(t)}),(function(n,r){var o=t?n:r;dd(e,o,o)}),(function(n,r,o,i){var a=t?n:o,c=t?r:i;fd(e,a,c,a,c)}))}))},setSelection:function(t){fd(e,t.start,t.soffset,t.finish,t.foffset)},setRelativeSelection:function(t,n){dd(e,t,n)},selectNode:function(t){hd(e,t,!1)},selectContents:function(t){hd(e,t)},getInnerHeight:function(){return e.innerHeight},getScrollY:function(){var t,n,r,o;return(t=xe.fromDom(e.document),n=void 0!==t?t.dom:document,r=n.body.scrollLeft||n.documentElement.scrollLeft,o=n.body.scrollTop||n.documentElement.scrollTop,Jr(r,o)).top},scrollBy:function(t,n){!function(e,t,n){var r=(void 0!==n?n.dom:document).defaultView;r&&r.scrollBy(e,t)}(t,n,xe.fromDom(e.document))}}},Im=function(e,t){return{rows:e,cols:t}},Pm=function(e,t,n,r){var o=function(e,t,n,r){var o=Ls(),i=o.clear,a=function(i){o.on((function(o){r.clearBeforeUpdate(t),Sm(i.target,n).each((function(a){lr(o,a,n).each((function(n){var o=n.boxes.getOr([]);if(1===o.length){var c=o[0],u="false"===ja(c),l=Bt(La(i.target),c,Ee);u&&l&&(r.selectRange(t,o,c,c),e.selectContents(c))}else o.length>1&&(r.selectRange(t,o,n.start,n.finish),e.selectContents(a))}))}))}))};return{clearstate:i,mousedown:function(e){r.clear(t),Sm(e.target,n).each(o.set)},mouseover:function(e){a(e)},mouseup:function(e){a(e),i()}}}(Om(e),t,n,r);return{clearstate:o.clearstate,mousedown:o.mousedown,mouseover:o.mouseover,mouseup:o.mouseup}},Bm=function(e,t,n,r){var o=Om(e),i=function(){return r.clear(t),T.none()};return{keydown:function(e,a,c,u,l,s){var f=e.raw,d=f.which,m=!0===f.shiftKey;return sr(t,r.selectedSelector).fold((function(){return Nm(d)&&!m&&r.clearBeforeUpdate(t),_m(d)&&m?h(xm,o,t,n,km,u,a,r.selectRange):Am(d)&&m?h(xm,o,t,n,Tm,u,a,r.selectRange):_m(d)?h(ym,o,n,km,u,a,Cm):Am(d)?h(ym,o,n,Tm,u,a,wm):T.none}),(function(e){var n=function(n){return function(){return G(n,(function(n){return function(e,t,n,r,o){return dr(r,e,t,o.firstSelectedSelector,o.lastSelectedSelector).map((function(e){return o.clearBeforeUpdate(n),o.selectRange(n,e.boxes,e.start,e.finish),e.boxes}))}(n.rows,n.cols,t,e,r)})).fold((function(){return fr(t,r.firstSelectedSelector,r.lastSelectedSelector).map((function(e){var n=_m(d)||s.isForward(d)?Of.after:Of.before;return o.setRelativeSelection(Of.on(e.first,0),n(e.table)),r.clear(t),Td(T.none(),!0)}))}),(function(e){return T.some(Td(T.none(),!0))}))}};return _m(d)&&m?n([Im(1,0)]):Am(d)&&m?n([Im(-1,0)]):s.isBackward(d)&&m?n([Im(0,-1),Im(-1,0)]):s.isForward(d)&&m?n([Im(0,1),Im(1,0)]):Nm(d)&&!m?i:T.none}))()},keyup:function(e,o,i,a,c){return sr(t,r.selectedSelector).fold((function(){var u=e.raw,l=u.which;return!0===u.shiftKey&&Nm(l)?function(e,t,n,r,o,i,a){return Ee(n,o)&&r===i?T.none():At(n,"td,th",t).bind((function(n){return At(o,"td,th",t).bind((function(r){return Nd(e,t,n,r,a)}))}))}(t,n,o,i,a,c,r.selectRange):T.none()}),T.none)}}},Mm=function(e,t,n){var r=function(t){It(t,e.selected),It(t,e.firstSelected),It(t,e.lastSelected)},o=function(t){Nt(t,e.selected,"1")},i=function(e){a(e),n()},a=function(t){var n=Ct(t,e.selectedSelector+","+e.firstSelectedSelector+","+e.lastSelectedSelector);I(n,r)};return{clearBeforeUpdate:a,clear:i,selectRange:function(n,r,a,c){i(n),I(r,o),Nt(a,e.firstSelected,"1"),Nt(c,e.lastSelected,"1"),t(r,a,c)},selectedSelector:e.selectedSelector,firstSelectedSelector:e.firstSelectedSelector,lastSelectedSelector:e.lastSelectedSelector}},Lm=function(e,t,n){var r=An.fromTable(e);return Tu(r,t).map((function(e){var t=yu(r,n,!1);return{upOrLeftCells:function(e,t){var n=e.slice(0,t[t.length-1].row+1),r=wu(n);return U(r,(function(e){var n=e.cells.slice(0,t[t.length-1].column+1);return O(n,(function(e){return e.element}))}))}(t,e),downOrRightCells:function(e,t){var n=e.slice(t[0].row+t[0].rowspan-1,e.length),r=wu(n);return U(r,(function(e){var n=e.cells.slice(t[0].column+t[0].colspan-1,e.cells.length);return O(n,(function(e){return e.element}))}))}(t,e)}}))},Fm=tinymce.util.Tools.resolve("tinymce.Env"),jm=function(e){return!1===Oa(xe.fromDom(e.target),"ephox-snooker-resizer-bar")};function Hm(e,t,n){var r=Mm(ki,(function(t,r,o){n.targets().each((function(n){an(r).each((function(i){var a=Pc(e),c=fi(d,xe.fromDom(e.getDoc()),a),u=Lm(i,n,c);!function(e,t,n,r,o){e.fire("TableSelectionChange",{cells:t,start:n,finish:r,otherCells:o})}(e,t,r,o,u)}))}))}),(function(){return function(e){e.fire("TableSelectionClear")}(e)}));return e.on("init",(function(n){var o=e.getWin(),i=pi(e),a=vi(e),c=Pm(o,i,a,r),u=Bm(o,i,a,r),l=function(e,t,n,r){var o=Om(e);return function(e,i){r.clearBeforeUpdate(t),lr(e,i,n).each((function(e){var n=e.boxes.getOr([]);r.selectRange(t,n,e.start,e.finish),o.selectContents(i),o.collapseSelection()}))}}(o,i,a,r);e.on("TableSelectorChange",(function(e){return l(e.start,e.finish)}));var s,f,m=function(t,n){(function(e){return!0===e.raw.shiftKey})(t)&&(n.kill&&t.kill(),n.selection.each((function(t){var n=Pf.relative(t.start,t.finish),r=Vf(o,n);e.selection.setRng(r)})))},p=function(e){return 0===e.button},g=(s=Bs(xe.fromDom(i)),f=Bs(0),{touchEnd:function(e){var t=xe.fromDom(e.target);if("td"===Ke(t)||"th"===Ke(t)){var n=s.get(),r=f.get();Ee(n,t)&&e.timeStamp-r<300&&(e.preventDefault(),l(t,t))}s.set(t),f.set(e.timeStamp)}});e.on("dragstart",(function(e){c.clearstate()})),e.on("mousedown",(function(e){p(e)&&jm(e)&&c.mousedown(Aa(e))})),e.on("mouseover",(function(e){var t;(void 0===(t=e).buttons||Fm.browser.isEdge()&&0===t.buttons||0!=(1&t.buttons))&&jm(e)&&c.mouseover(Aa(e))})),e.on("mouseup",(function(e){p(e)&&jm(e)&&c.mouseup(Aa(e))})),e.on("touchend",g.touchEnd),e.on("keyup",(function(t){var n=Aa(t);if(n.raw.shiftKey&&Nm(n.raw.which)){var r=e.selection.getRng(),o=xe.fromDom(r.startContainer),i=xe.fromDom(r.endContainer);u.keyup(n,o,r.startOffset,i,r.endOffset).each((function(e){m(n,e)}))}})),e.on("keydown",(function(n){var r=Aa(n);t().each((function(e){return e.hideBars()}));var o=e.selection.getRng(),i=xe.fromDom(o.startContainer),a=xe.fromDom(o.endContainer),c=zr(Rm,Dm)(xe.fromDom(e.selection.getStart()));u.keydown(r,i,o.startOffset,a,o.endOffset,c).each((function(e){m(r,e)})),t().each((function(e){return e.showBars()}))})),e.on("NodeChange",(function(){var t=e.selection,n=xe.fromDom(t.getStart()),o=xe.fromDom(t.getEnd());cr(an,[n,o]).fold((function(){return r.clear(i)}),d)}))})),{clear:r.clear}}var Um=function(e,t){var n=Bs(T.none()),r=Bs([]),o=T.none(),i=tt("caption"),a=function(e){return o.forall((function(t){return!t[e]}))},c=function(){return Ai(function(e){return xe.fromDom(e.selection.getEnd())}(e),vi(e))},u=function(){return Ai(wi(e),vi(e)).bind((function(e){return Lt(an(e),c().bind(an),(function(n,r){return Ee(n,r)?i(e)?T.some(function(e){return{element:e,mergable:T.none(),unmergable:T.none(),selection:[e]}}(e)):T.some(Ti(t,n,e)):T.none()})).bind(p)}))},l=function(e){return an(e.element).map((function(t){var n=An.fromTable(t),r=Tu(n,e).getOr([]),o=L(r,(function(e,t){return t.isLocked&&(e.onAny=!0,0===t.column?e.onFirst=!0:t.column+t.colspan>=n.grid.columns&&(e.onLast=!0)),e}),{onAny:!1,onFirst:!1,onLast:!1});return{mergeable:_u(n,e).isSome(),unmergeable:Nu(n,e).isSome(),locked:o}}))},s=function(){n.set(Y(u)()),o=n.get().bind(l),I(r.get(),(function(e){return e()}))},f=function(e){return e(),r.set(r.get().concat([e])),function(){r.set(B(r.get(),(function(t){return t!==e})))}},d=function(e,t){return f((function(){return n.get().fold((function(){e.setDisabled(!0)}),(function(n){e.setDisabled(t(n))}))}))},m=function(e,t,r){return f((function(){return n.get().fold((function(){e.setDisabled(!0),e.setActive(!1)}),(function(n){e.setDisabled(t(n)),e.setActive(r(n))}))}))},g=function(e){return o.exists((function(t){return t.locked[e]}))},h=function(t,n){return function(r){return m(r,(function(e){return i(e.element)}),(function(){return e.queryCommandValue(t)===n}))}},v=h("mceTableRowType","header"),b=h("mceTableColType","th");return e.on("NodeChange ExecCommand TableSelectorChange",s),{onSetupTable:function(e){return d(e,(function(e){return!1}))},onSetupCellOrRow:function(e){return d(e,(function(e){return i(e.element)}))},onSetupColumn:function(e){return function(t){return d(t,(function(t){return i(t.element)||g(e)}))}},onSetupPasteable:function(e){return function(t){return d(t,(function(t){return i(t.element)||e().isNone()}))}},onSetupPasteableColumn:function(e,t){return function(n){return d(n,(function(n){return i(n.element)||e().isNone()||g(t)}))}},onSetupMergeable:function(e){return d(e,(function(e){return a("mergeable")}))},onSetupUnmergeable:function(e){return d(e,(function(e){return a("unmergeable")}))},resetTargets:s,onSetupTableWithCaption:function(t){return m(t,w,(function(t){return an(t.element,vi(e)).exists((function(e){return Tt(e,"caption").isSome()}))}))},onSetupTableRowHeaders:v,onSetupTableColumnHeaders:b,targets:n.get}},zm=function(e){var t=function(e,t,n){return{get:function(){return mr(e(),n).fold((function(){return t().fold(br,wr)}),(function(e){return yr(e)}))}}}((function(){return pi(e)}),(function(){return _i(wi(e),vi(e))}),ki.selectedSelector),n=Um(e,t),r=Vc(e),o=Hm(e,r.lazyResize,n),i=as(e,o,r.lazyWire),a=function(){var e=Ls(),t=Ls();return{getRows:e.get,setRows:function(n){n.fold(e.clear,e.set),t.clear()},clearRows:e.clear,getColumns:t.get,setColumns:function(n){n.fold(t.clear,t.set),e.clear()},clearColumns:t.clear}}();return xf(e,i,0,t,a),function(e,t,n){var r=vi(e),o=function(t){return _i(wi(e)).bind((function(e){return an(e,r).map((function(r){var o=Ti(n,r,e);return t(r,o)}))})).getOr("")};Oe({mceTableRowType:function(){return o(t.getTableRowType)},mceTableCellType:function(){return o(t.getTableCellType)},mceTableColType:function(){return o(t.getTableColType)}},(function(t,n){return e.addQueryValueHandler(n,t)}))}(e,i,t),Ri(e,t,i),function(e,t,n,r){var o=function(t){return function(){return e.execCommand(t)}},i=function(t){e.execCommand("mceInsertTable",!1,{rows:t.numRows,columns:t.numColumns})},a={text:"Table properties",onSetup:n.onSetupTable,onAction:o("mceTableProps")},c={text:"Delete table",icon:"table-delete-table",onSetup:n.onSetupTable,onAction:o("mceTableDelete")};e.ui.registry.addMenuItem("tableinsertrowbefore",{text:"Insert row before",icon:"table-insert-row-above",onAction:o("mceTableInsertRowBefore"),onSetup:n.onSetupCellOrRow}),e.ui.registry.addMenuItem("tableinsertrowafter",{text:"Insert row after",icon:"table-insert-row-after",onAction:o("mceTableInsertRowAfter"),onSetup:n.onSetupCellOrRow}),e.ui.registry.addMenuItem("tabledeleterow",{text:"Delete row",icon:"table-delete-row",onAction:o("mceTableDeleteRow"),onSetup:n.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablerowprops",{text:"Row properties",icon:"table-row-properties",onAction:o("mceTableRowProps"),onSetup:n.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablecutrow",{text:"Cut row",icon:"cut-row",onAction:o("mceTableCutRow"),onSetup:n.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablecopyrow",{text:"Copy row",icon:"duplicate-row",onAction:o("mceTableCopyRow"),onSetup:n.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablepasterowbefore",{text:"Paste row before",icon:"paste-row-before",onAction:o("mceTablePasteRowBefore"),onSetup:n.onSetupPasteable(r.getRows)}),e.ui.registry.addMenuItem("tablepasterowafter",{text:"Paste row after",icon:"paste-row-after",onAction:o("mceTablePasteRowAfter"),onSetup:n.onSetupPasteable(r.getRows)});var u={type:"nestedmenuitem",text:"Row",getSubmenuItems:m("tableinsertrowbefore tableinsertrowafter tabledeleterow tablerowprops | tablecutrow tablecopyrow tablepasterowbefore tablepasterowafter")};e.ui.registry.addMenuItem("tableinsertcolumnbefore",{text:"Insert column before",icon:"table-insert-column-before",onAction:o("mceTableInsertColBefore"),onSetup:n.onSetupColumn("onFirst")}),e.ui.registry.addMenuItem("tableinsertcolumnafter",{text:"Insert column after",icon:"table-insert-column-after",onAction:o("mceTableInsertColAfter"),onSetup:n.onSetupColumn("onLast")}),e.ui.registry.addMenuItem("tabledeletecolumn",{text:"Delete column",icon:"table-delete-column",onAction:o("mceTableDeleteCol"),onSetup:n.onSetupColumn("onAny")}),e.ui.registry.addMenuItem("tablecutcolumn",{text:"Cut column",icon:"cut-column",onAction:o("mceTableCutCol"),onSetup:n.onSetupColumn("onAny")}),e.ui.registry.addMenuItem("tablecopycolumn",{text:"Copy column",icon:"duplicate-column",onAction:o("mceTableCopyCol"),onSetup:n.onSetupColumn("onAny")}),e.ui.registry.addMenuItem("tablepastecolumnbefore",{text:"Paste column before",icon:"paste-column-before",onAction:o("mceTablePasteColBefore"),onSetup:n.onSetupPasteableColumn(r.getColumns,"onFirst")}),e.ui.registry.addMenuItem("tablepastecolumnafter",{text:"Paste column after",icon:"paste-column-after",onAction:o("mceTablePasteColAfter"),onSetup:n.onSetupPasteableColumn(r.getColumns,"onLast")});var l={type:"nestedmenuitem",text:"Column",getSubmenuItems:m("tableinsertcolumnbefore tableinsertcolumnafter tabledeletecolumn | tablecutcolumn tablecopycolumn tablepastecolumnbefore tablepastecolumnafter")};e.ui.registry.addMenuItem("tablecellprops",{text:"Cell properties",icon:"table-cell-properties",onAction:o("mceTableCellProps"),onSetup:n.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablemergecells",{text:"Merge cells",icon:"table-merge-cells",onAction:o("mceTableMergeCells"),onSetup:n.onSetupMergeable}),e.ui.registry.addMenuItem("tablesplitcells",{text:"Split cell",icon:"table-split-cells",onAction:o("mceTableSplitCells"),onSetup:n.onSetupUnmergeable});var s={type:"nestedmenuitem",text:"Cell",getSubmenuItems:m("tablecellprops tablemergecells tablesplitcells")};!1===function(e){return e.getParam("table_grid",!0,"boolean")}(e)?e.ui.registry.addMenuItem("inserttable",{text:"Table",icon:"table",onAction:o("mceInsertTable")}):e.ui.registry.addNestedMenuItem("inserttable",{text:"Table",icon:"table",getSubmenuItems:function(){return[{type:"fancymenuitem",fancytype:"inserttable",onAction:i}]}}),e.ui.registry.addMenuItem("inserttabledialog",{text:"Insert table",icon:"table",onAction:o("mceInsertTable")}),e.ui.registry.addMenuItem("tableprops",a),e.ui.registry.addMenuItem("deletetable",c),e.ui.registry.addNestedMenuItem("row",u),e.ui.registry.addNestedMenuItem("column",l),e.ui.registry.addNestedMenuItem("cell",s),e.ui.registry.addContextMenu("table",{update:function(){return n.resetTargets(),n.targets().fold(m(""),(function(e){return"caption"===Ke(e.element)?"tableprops deletetable":"cell row column | advtablesort | tableprops deletetable"}))}});var f=Ws(Tc(e));0!==f.length&&e.ui.registry.addNestedMenuItem("tableclass",{icon:"table-classes",text:"Table styles",getSubmenuItems:function(){return Us(e,t,f,"tableclass",(function(t){return e.execCommand("mceTableToggleClass",!1,t)}))},onSetup:n.onSetupTable});var d=Ws(kc(e));0!==d.length&&e.ui.registry.addNestedMenuItem("tablecellclass",{icon:"table-cell-classes",text:"Cell styles",getSubmenuItems:function(){return Us(e,t,d,"tablecellclass",(function(t){return e.execCommand("mceTableCellToggleClass",!1,t)}))},onSetup:n.onSetupCellOrRow}),e.ui.registry.addNestedMenuItem("tablecellvalign",{icon:"vertical-align",text:"Vertical align",getSubmenuItems:function(){return Us(e,t,Ss,"tablecellverticalalign",zs(e,"vertical-align"))},onSetup:n.onSetupCellOrRow}),e.ui.registry.addNestedMenuItem("tablecellborderwidth",{icon:"border-width",text:"Border width",getSubmenuItems:function(){return Us(e,t,hc(e),"tablecellborderwidth",zs(e,"border-width"))},onSetup:n.onSetupCellOrRow}),e.ui.registry.addNestedMenuItem("tablecellborderstyle",{icon:"border-style",text:"Border style",getSubmenuItems:function(){return Us(e,t,vc(e),"tablecellborderstyle",zs(e,"border-style"))},onSetup:n.onSetupCellOrRow}),e.ui.registry.addToggleMenuItem("tablecaption",{icon:"table-caption",text:"Table caption",onAction:o("mceTableToggleCaption"),onSetup:n.onSetupTableWithCaption}),e.ui.registry.addNestedMenuItem("tablecellbackgroundcolor",{icon:"cell-background-color",text:"Background color",getSubmenuItems:function(){return qs(e,Bc(e),"background-color")},onSetup:n.onSetupCellOrRow}),e.ui.registry.addNestedMenuItem("tablecellbordercolor",{icon:"cell-border-color",text:"Border color",getSubmenuItems:function(){return qs(e,Mc(e),"border-color")},onSetup:n.onSetupCellOrRow}),e.ui.registry.addToggleMenuItem("tablerowheader",{text:"Row header",icon:"table-top-header",onAction:$s(e),onSetup:n.onSetupTableRowHeaders}),e.ui.registry.addToggleMenuItem("tablecolheader",{text:"Column header",icon:"table-left-header",onAction:Ks(e),onSetup:n.onSetupTableColumnHeaders})}(e,t,n,a),function(e,t,n,r){e.ui.registry.addMenuButton("table",{tooltip:"Table",icon:"table",fetch:function(e){return e("inserttable | cell row column | advtablesort | tableprops deletetable")}});var o=function(t){return function(){return e.execCommand(t)}};e.ui.registry.addButton("tableprops",{tooltip:"Table properties",onAction:o("mceTableProps"),icon:"table",onSetup:n.onSetupTable}),e.ui.registry.addButton("tabledelete",{tooltip:"Delete table",onAction:o("mceTableDelete"),icon:"table-delete-table",onSetup:n.onSetupTable}),e.ui.registry.addButton("tablecellprops",{tooltip:"Cell properties",onAction:o("mceTableCellProps"),icon:"table-cell-properties",onSetup:n.onSetupCellOrRow}),e.ui.registry.addButton("tablemergecells",{tooltip:"Merge cells",onAction:o("mceTableMergeCells"),icon:"table-merge-cells",onSetup:n.onSetupMergeable}),e.ui.registry.addButton("tablesplitcells",{tooltip:"Split cell",onAction:o("mceTableSplitCells"),icon:"table-split-cells",onSetup:n.onSetupUnmergeable}),e.ui.registry.addButton("tableinsertrowbefore",{tooltip:"Insert row before",onAction:o("mceTableInsertRowBefore"),icon:"table-insert-row-above",onSetup:n.onSetupCellOrRow}),e.ui.registry.addButton("tableinsertrowafter",{tooltip:"Insert row after",onAction:o("mceTableInsertRowAfter"),icon:"table-insert-row-after",onSetup:n.onSetupCellOrRow}),e.ui.registry.addButton("tabledeleterow",{tooltip:"Delete row",onAction:o("mceTableDeleteRow"),icon:"table-delete-row",onSetup:n.onSetupCellOrRow}),e.ui.registry.addButton("tablerowprops",{tooltip:"Row properties",onAction:o("mceTableRowProps"),icon:"table-row-properties",onSetup:n.onSetupCellOrRow}),e.ui.registry.addButton("tableinsertcolbefore",{tooltip:"Insert column before",onAction:o("mceTableInsertColBefore"),icon:"table-insert-column-before",onSetup:n.onSetupColumn("onFirst")}),e.ui.registry.addButton("tableinsertcolafter",{tooltip:"Insert column after",onAction:o("mceTableInsertColAfter"),icon:"table-insert-column-after",onSetup:n.onSetupColumn("onLast")}),e.ui.registry.addButton("tabledeletecol",{tooltip:"Delete column",onAction:o("mceTableDeleteCol"),icon:"table-delete-column",onSetup:n.onSetupColumn("onAny")}),e.ui.registry.addButton("tablecutrow",{tooltip:"Cut row",icon:"cut-row",onAction:o("mceTableCutRow"),onSetup:n.onSetupCellOrRow}),e.ui.registry.addButton("tablecopyrow",{tooltip:"Copy row",icon:"duplicate-row",onAction:o("mceTableCopyRow"),onSetup:n.onSetupCellOrRow}),e.ui.registry.addButton("tablepasterowbefore",{tooltip:"Paste row before",icon:"paste-row-before",onAction:o("mceTablePasteRowBefore"),onSetup:n.onSetupPasteable(r.getRows)}),e.ui.registry.addButton("tablepasterowafter",{tooltip:"Paste row after",icon:"paste-row-after",onAction:o("mceTablePasteRowAfter"),onSetup:n.onSetupPasteable(r.getRows)}),e.ui.registry.addButton("tablecutcol",{tooltip:"Cut column",icon:"cut-column",onAction:o("mceTableCutCol"),onSetup:n.onSetupColumn("onAny")}),e.ui.registry.addButton("tablecopycol",{tooltip:"Copy column",icon:"duplicate-column",onAction:o("mceTableCopyCol"),onSetup:n.onSetupColumn("onAny")}),e.ui.registry.addButton("tablepastecolbefore",{tooltip:"Paste column before",icon:"paste-column-before",onAction:o("mceTablePasteColBefore"),onSetup:n.onSetupPasteableColumn(r.getColumns,"onFirst")}),e.ui.registry.addButton("tablepastecolafter",{tooltip:"Paste column after",icon:"paste-column-after",onAction:o("mceTablePasteColAfter"),onSetup:n.onSetupPasteableColumn(r.getColumns,"onLast")}),e.ui.registry.addButton("tableinsertdialog",{tooltip:"Insert table",onAction:o("mceInsertTable"),icon:"table"});var i=Ws(Tc(e));0!==i.length&&e.ui.registry.addMenuButton("tableclass",{icon:"table-classes",tooltip:"Table styles",fetch:Vs(e,t,i,"tableclass",(function(t){return e.execCommand("mceTableToggleClass",!1,t)})),onSetup:n.onSetupTable});var a=Ws(kc(e));0!==a.length&&e.ui.registry.addMenuButton("tablecellclass",{icon:"table-cell-classes",tooltip:"Cell styles",fetch:Vs(e,t,a,"tablecellclass",(function(t){return e.execCommand("mceTableCellToggleClass",!1,t)})),onSetup:n.onSetupCellOrRow}),e.ui.registry.addMenuButton("tablecellvalign",{icon:"vertical-align",tooltip:"Vertical align",fetch:Vs(e,t,Ss,"tablecellverticalalign",zs(e,"vertical-align")),onSetup:n.onSetupCellOrRow}),e.ui.registry.addMenuButton("tablecellborderwidth",{icon:"border-width",tooltip:"Border width",fetch:Vs(e,t,hc(e),"tablecellborderwidth",zs(e,"border-width")),onSetup:n.onSetupCellOrRow}),e.ui.registry.addMenuButton("tablecellborderstyle",{icon:"border-style",tooltip:"Border style",fetch:Vs(e,t,vc(e),"tablecellborderstyle",zs(e,"border-style")),onSetup:n.onSetupCellOrRow}),e.ui.registry.addToggleButton("tablecaption",{tooltip:"Table caption",onAction:o("mceTableToggleCaption"),icon:"table-caption",onSetup:n.onSetupTableWithCaption}),e.ui.registry.addMenuButton("tablecellbackgroundcolor",{icon:"cell-background-color",tooltip:"Background color",fetch:function(t){return t(qs(e,Bc(e),"background-color"))},onSetup:n.onSetupCellOrRow}),e.ui.registry.addMenuButton("tablecellbordercolor",{icon:"cell-border-color",tooltip:"Border color",fetch:function(t){return t(qs(e,Mc(e),"border-color"))},onSetup:n.onSetupCellOrRow}),e.ui.registry.addToggleButton("tablerowheader",{tooltip:"Row header",icon:"table-top-header",onAction:$s(e),onSetup:n.onSetupTableRowHeaders}),e.ui.registry.addToggleButton("tablecolheader",{tooltip:"Column header",icon:"table-left-header",onAction:Ks(e),onSetup:n.onSetupTableColumnHeaders})}(e,t,n,a),function(e){var t=function(e){return e.getParam("table_toolbar","tableprops tabledelete | tableinsertrowbefore tableinsertrowafter tabledeleterow | tableinsertcolbefore tableinsertcolafter tabledeletecol")}(e);t.length>0&&e.ui.registry.addContextToolbar("table",{predicate:function(t){return e.dom.is(t,"table")&&e.getBody().contains(t)},items:t,scope:"node",position:"node"})}(e),e.on("PreInit",(function(){e.serializer.addTempAttr(ki.firstSelected),e.serializer.addTempAttr(ki.lastSelected),function(e){e.formatter.register(Tf)}(e)})),function(e){return e.getParam("table_tab_navigation",!0,"boolean")}(e)&&e.on("keydown",(function(t){!function(e,t,n){if(e.keyCode===wd.TAB){var r=pi(t),o=function(e){var t=Ke(e);return Ee(e,r)||N(kd,t)},i=t.selection.getRng(),a=xe.fromDom(e.shiftKey?i.startContainer:i.endContainer);nn(a,o).each((function(r){e.preventDefault(),an(r,o).each(n.clear),t.selection.collapse(e.shiftKey),(e.shiftKey?xd:Cd)(t,o,r).each((function(e){t.selection.setRng(e)}))}))}}(t,e,o)})),e.on("remove",(function(){r.destroy()})),function(e,t,n,r){return{insertTable:gs(e),setClipboardRows:ps(t.setRows),getClipboardRows:ms(t.getRows),setClipboardCols:ps(t.setColumns),getClipboardCols:ms(t.getColumns),resizeHandler:n,selectionTargets:r}}(e,a,r,n)};Cr.add("table",zm)}()},"./node_modules/tinymce/tinymce.js":function(e,t,n){(function(t,n){!function(){"use strict";var r=function(e){if(null===e)return"null";if(void 0===e)return"undefined";var t=typeof e;return"object"===t&&(Array.prototype.isPrototypeOf(e)||e.constructor&&"Array"===e.constructor.name)?"array":"object"===t&&(String.prototype.isPrototypeOf(e)||e.constructor&&"String"===e.constructor.name)?"string":t},o=function(e){return{eq:e}},i=o((function(e,t){return e===t})),a=function(e){return o((function(t,n){if(t.length!==n.length)return!1;for(var r=t.length,o=0;o<r;o++)if(!e.eq(t[o],n[o]))return!1;return!0}))},c=function(e,t){return function(e,t){return o((function(n,r){return e.eq(t(n),t(r))}))}(a(e),(function(e){return function(e,t){return Array.prototype.slice.call(e).sort(t)}(e,t)}))},u=function(e){return o((function(t,n){var r=Object.keys(t),o=Object.keys(n);if(!c(i).eq(r,o))return!1;for(var a=r.length,u=0;u<a;u++){var l=r[u];if(!e.eq(t[l],n[l]))return!1}return!0}))},l=o((function(e,t){if(e===t)return!0;var n=r(e);return n===r(t)&&(function(e){return-1!==["undefined","boolean","number","string","function","xml","null"].indexOf(e)}(n)?e===t:"array"===n?a(l).eq(e,t):"object"===n&&u(l).eq(e,t))})),s=function(e){return function(t){return r=typeof(n=t),(null===n?"null":"object"===r&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"===r&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":r)===e;var n,r}},f=function(e){return function(t){return typeof t===e}},d=function(e){return function(t){return e===t}},m=s("string"),p=s("object"),g=s("array"),h=d(null),v=f("boolean"),b=d(void 0),y=function(e){return null==e},w=function(e){return!y(e)},C=f("function"),x=f("number"),S=function(){},k=function(e,t){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return e(t.apply(null,n))}},T=function(e,t){return function(n){return e(t(n))}},E=function(e){return function(){return e}},A=function(e){return e},_=function(e,t){return e===t};function N(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var o=t.concat(n);return e.apply(null,o)}}var R=function(e){return function(t){return!e(t)}},D=function(e){return e()},O=function(e){e()},I=E(!1),P=E(!0),B=function(){return M},M=function(){var e=function(e){return e()},t=A;return{fold:function(e,t){return e()},isSome:I,isNone:P,getOr:t,getOrThunk:e,getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:E(null),getOrUndefined:E(void 0),or:t,orThunk:e,map:B,each:S,bind:B,exists:I,forall:P,filter:function(){return B()},toArray:function(){return[]},toString:E("none()")}}(),L=function(e){var t=E(e),n=function(){return o},r=function(t){return t(e)},o={fold:function(t,n){return n(e)},isSome:P,isNone:I,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:n,orThunk:n,map:function(t){return L(t(e))},each:function(t){t(e)},bind:r,exists:r,forall:r,filter:function(t){return t(e)?o:M},toArray:function(){return[e]},toString:function(){return"some("+e+")"}};return o},F={some:L,none:B,from:function(e){return null==e?M:L(e)}},j=Array.prototype.slice,H=Array.prototype.indexOf,U=Array.prototype.push,z=function(e,t){return H.call(e,t)},W=function(e,t){return z(e,t)>-1},V=function(e,t){for(var n=0,r=e.length;n<r;n++){if(t(e[n],n))return!0}return!1},q=function(e,t){for(var n=e.length,r=new Array(n),o=0;o<n;o++){var i=e[o];r[o]=t(i,o)}return r},$=function(e,t){for(var n=0,r=e.length;n<r;n++){t(e[n],n)}},K=function(e,t){for(var n=e.length-1;n>=0;n--){t(e[n],n)}},G=function(e,t){for(var n=[],r=[],o=0,i=e.length;o<i;o++){var a=e[o];(t(a,o)?n:r).push(a)}return{pass:n,fail:r}},J=function(e,t){for(var n=[],r=0,o=e.length;r<o;r++){var i=e[r];t(i,r)&&n.push(i)}return n},X=function(e,t,n){return K(e,(function(e,r){n=t(n,e,r)})),n},Y=function(e,t,n){return $(e,(function(e,r){n=t(n,e,r)})),n},Q=function(e,t,n){for(var r=0,o=e.length;r<o;r++){var i=e[r];if(t(i,r))return F.some(i);if(n(i,r))break}return F.none()},Z=function(e,t){return Q(e,t,I)},ee=function(e,t){for(var n=0,r=e.length;n<r;n++){if(t(e[n],n))return F.some(n)}return F.none()},te=function(e,t){return function(e){for(var t=[],n=0,r=e.length;n<r;++n){if(!g(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);U.apply(t,e[n])}return t}(q(e,t))},ne=function(e,t){for(var n=0,r=e.length;n<r;++n){if(!0!==t(e[n],n))return!1}return!0},re=function(e){var t=j.call(e,0);return t.reverse(),t},oe=function(e,t){return J(e,(function(e){return!W(t,e)}))},ie=function(e,t){var n=j.call(e,0);return n.sort(t),n},ae=function(e,t){return t>=0&&t<e.length?F.some(e[t]):F.none()},ce=function(e){return ae(e,0)},ue=function(e){return ae(e,e.length-1)},le=C(Array.from)?Array.from:function(e){return j.call(e)},se=function(e,t){for(var n=0;n<e.length;n++){var r=t(e[n],n);if(r.isSome())return r}return F.none()},fe=Object.keys,de=Object.hasOwnProperty,me=function(e,t){for(var n=fe(e),r=0,o=n.length;r<o;r++){var i=n[r];t(e[i],i)}},pe=function(e,t){return ge(e,(function(e,n){return{k:n,v:t(e,n)}}))},ge=function(e,t){var n={};return me(e,(function(e,r){var o=t(e,r);n[o.k]=o.v})),n},he=function(e){return function(t,n){e[n]=t}},ve=function(e,t,n,r){return me(e,(function(e,o){(t(e,o)?n:r)(e,o)})),{}},be=function(e,t){var n={};return ve(e,t,he(n),S),n},ye=function(e){return function(e,t){var n=[];return me(e,(function(e,r){n.push(t(e,r))})),n}(e,A)},we=function(e,t){return Ce(e,t)?F.from(e[t]):F.none()},Ce=function(e,t){return de.call(e,t)},xe=function(e,t){return Ce(e,t)&&void 0!==e[t]&&null!==e[t]},Se=Array.isArray,ke=function(e,t,n){var r,o;if(!e)return!1;if(n=n||e,void 0!==e.length){for(r=0,o=e.length;r<o;r++)if(!1===t.call(n,e[r],r,e))return!1}else for(r in e)if(Ce(e,r)&&!1===t.call(n,e[r],r,e))return!1;return!0},Te=function(e,t){var n=[];return ke(e,(function(r,o){n.push(t(r,o,e))})),n},Ee=function(e,t){var n=[];return ke(e,(function(r,o){t&&!t(r,o,e)||n.push(r)})),n},Ae=function(e,t){if(e)for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1},_e=function(e,t,n,r){for(var o=b(n)?e[0]:n,i=0;i<e.length;i++)o=t.call(r,o,e[i],i);return o},Ne=function(e,t,n){var r,o;for(r=0,o=e.length;r<o;r++)if(t.call(n,e[r],r,e))return r;return-1},Re=function(e){return e[e.length-1]},De=function(){return(De=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function Oe(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}var Ie=function(e){var t,n=!1;return function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return n||(n=!0,t=e.apply(null,r)),t}},Pe=function(){return Be(0,0)},Be=function(e,t){return{major:e,minor:t}},Me={nu:Be,detect:function(e,t){var n=String(t).toLowerCase();return 0===e.length?Pe():function(e,t){var n=function(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(r.test(t))return r}}(e,t);if(!n)return{major:0,minor:0};var r=function(e){return Number(t.replace(n,"$"+e))};return Be(r(1),r(2))}(e,n)},unknown:Pe},Le=function(e,t){var n=String(t).toLowerCase();return Z(e,(function(e){return e.search(n)}))},Fe=function(e,t){return-1!==e.indexOf(t)},je=function(e,t){return function(e,t,n){return""===t||e.length>=t.length&&e.substr(n,n+t.length)===t}(e,t,0)},He=function(e){return function(t){return t.replace(e,"")}},Ue=He(/^\s+|\s+$/g),ze=He(/^\s+/g),We=He(/\s+$/g),Ve=function(e){return e.length>0},qe=function(e){return!Ve(e)},$e=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Ke=function(e){return function(t){return Fe(t,e)}},Ge=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(e){return Fe(e,"edge/")&&Fe(e,"chrome")&&Fe(e,"safari")&&Fe(e,"applewebkit")}},{name:"Chrome",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,$e],search:function(e){return Fe(e,"chrome")&&!Fe(e,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(e){return Fe(e,"msie")||Fe(e,"trident")}},{name:"Opera",versionRegexes:[$e,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:Ke("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:Ke("firefox")},{name:"Safari",versionRegexes:[$e,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(e){return(Fe(e,"safari")||Fe(e,"mobile/"))&&Fe(e,"applewebkit")}}],Je=[{name:"Windows",search:Ke("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(e){return Fe(e,"iphone")||Fe(e,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:Ke("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:Ke("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:Ke("linux"),versionRegexes:[]},{name:"Solaris",search:Ke("sunos"),versionRegexes:[]},{name:"FreeBSD",search:Ke("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:Ke("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],Xe={browsers:E(Ge),oses:E(Je)},Ye=function(e){var t=e.current,n=e.version,r=function(e){return function(){return t===e}};return{current:t,version:n,isEdge:r("Edge"),isChrome:r("Chrome"),isIE:r("IE"),isOpera:r("Opera"),isFirefox:r("Firefox"),isSafari:r("Safari")}},Qe={unknown:function(){return Ye({current:void 0,version:Me.unknown()})},nu:Ye,edge:E("Edge"),chrome:E("Chrome"),ie:E("IE"),opera:E("Opera"),firefox:E("Firefox"),safari:E("Safari")},Ze=function(e){var t=e.current,n=e.version,r=function(e){return function(){return t===e}};return{current:t,version:n,isWindows:r("Windows"),isiOS:r("iOS"),isAndroid:r("Android"),isOSX:r("OSX"),isLinux:r("Linux"),isSolaris:r("Solaris"),isFreeBSD:r("FreeBSD"),isChromeOS:r("ChromeOS")}},et={unknown:function(){return Ze({current:void 0,version:Me.unknown()})},nu:Ze,windows:E("Windows"),ios:E("iOS"),android:E("Android"),linux:E("Linux"),osx:E("OSX"),solaris:E("Solaris"),freebsd:E("FreeBSD"),chromeos:E("ChromeOS")},tt=function(e,t,n){var r=Xe.browsers(),o=Xe.oses(),i=t.bind((function(e){return function(e,t){return se(t.brands,(function(t){var n=t.brand.toLowerCase();return Z(e,(function(e){var t;return n===(null===(t=e.brand)||void 0===t?void 0:t.toLowerCase())})).map((function(e){return{current:e.name,version:Me.nu(parseInt(t.version,10),0)}}))}))}(r,e)})).orThunk((function(){return function(e,t){return Le(e,t).map((function(e){var n=Me.detect(e.versionRegexes,t);return{current:e.name,version:n}}))}(r,e)})).fold(Qe.unknown,Qe.nu),a=function(e,t){return Le(e,t).map((function(e){var n=Me.detect(e.versionRegexes,t);return{current:e.name,version:n}}))}(o,e).fold(et.unknown,et.nu),c=function(e,t,n,r){var o=e.isiOS()&&!0===/ipad/i.test(n),i=e.isiOS()&&!o,a=e.isiOS()||e.isAndroid(),c=a||r("(pointer:coarse)"),u=o||!i&&a&&r("(min-device-width:768px)"),l=i||a&&!u,s=t.isSafari()&&e.isiOS()&&!1===/safari/i.test(n),f=!l&&!u&&!s;return{isiPad:E(o),isiPhone:E(i),isTablet:E(u),isPhone:E(l),isTouch:E(c),isAndroid:e.isAndroid,isiOS:e.isiOS,isWebView:E(s),isDesktop:E(f)}}(a,i,e,n);return{browser:i,os:a,deviceType:c}},nt=function(e){return window.matchMedia(e).matches},rt=Ie((function(){return tt(navigator.userAgent,F.from(navigator.userAgentData),nt)})),ot=function(){return rt()},it=navigator.userAgent,at=ot(),ct=at.browser,ut=at.os,lt=at.deviceType,st=/WebKit/.test(it)&&!ct.isEdge(),ft="FormData"in window&&"FileReader"in window&&"URL"in window&&!!URL.createObjectURL,dt=-1!==it.indexOf("Windows Phone"),mt={opera:ct.isOpera(),webkit:st,ie:!(!ct.isIE()&&!ct.isEdge())&&ct.version.major,gecko:ct.isFirefox(),mac:ut.isOSX()||ut.isiOS(),iOS:lt.isiPad()||lt.isiPhone(),android:ut.isAndroid(),contentEditable:!0,transparentSrc:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",caretAfter:!0,range:window.getSelection&&"Range"in window,documentMode:ct.isIE()?document.documentMode||7:10,fileApi:ft,ceFalse:!0,cacheSuffix:null,container:null,experimentalShadowDom:!1,canHaveCSP:!ct.isIE(),desktop:lt.isDesktop(),windowsPhone:dt,browser:{current:ct.current,version:ct.version,isChrome:ct.isChrome,isEdge:ct.isEdge,isFirefox:ct.isFirefox,isIE:ct.isIE,isOpera:ct.isOpera,isSafari:ct.isSafari},os:{current:ut.current,version:ut.version,isAndroid:ut.isAndroid,isChromeOS:ut.isChromeOS,isFreeBSD:ut.isFreeBSD,isiOS:ut.isiOS,isLinux:ut.isLinux,isOSX:ut.isOSX,isSolaris:ut.isSolaris,isWindows:ut.isWindows},deviceType:{isDesktop:lt.isDesktop,isiPad:lt.isiPad,isiPhone:lt.isiPhone,isPhone:lt.isPhone,isTablet:lt.isTablet,isTouch:lt.isTouch,isWebView:lt.isWebView}},pt=/^\s*|\s*$/g,gt=function(e){return null==e?"":(""+e).replace(pt,"")},ht=function(e,t){return t?!("array"!==t||!Se(e))||typeof e===t:void 0!==e},vt=function(e,t,n,r){r=r||this,e&&(n&&(e=e[n]),ke(e,(function(e,o){if(!1===t.call(r,e,o,n))return!1;vt(e,t,n,r)})))},bt={trim:gt,isArray:Se,is:ht,toArray:function(e){if(Se(e))return e;for(var t=[],n=0,r=e.length;n<r;n++)t[n]=e[n];return t},makeMap:function(e,t,n){var r;for(t=t||",","string"==typeof(e=e||[])&&(e=e.split(t)),n=n||{},r=e.length;r--;)n[e[r]]={};return n},each:ke,map:Te,grep:Ee,inArray:Ae,hasOwn:Ce,extend:function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=0;r<t.length;r++){var o=t[r];for(var i in o)if(Ce(o,i)){var a=o[i];void 0!==a&&(e[i]=a)}}return e},create:function(e,t,n){var r,o,i,a=0,c=(e=/^((static) )?([\w.]+)(:([\w.]+))?/.exec(e))[3].match(/(^|\.)(\w+)$/i)[2],u=this.createNS(e[3].replace(/\.\w+$/,""),n);if(!u[c]){if("static"===e[2])return u[c]=t,void(this.onCreate&&this.onCreate(e[2],e[3],u[c]));t[c]||(t[c]=function(){},a=1),u[c]=t[c],this.extend(u[c].prototype,t),e[5]&&(r=this.resolve(e[5]).prototype,o=e[5].match(/\.(\w+)$/i)[1],i=u[c],u[c]=a?function(){return r[o].apply(this,arguments)}:function(){return this.parent=r[o],i.apply(this,arguments)},u[c].prototype[c]=u[c],this.each(r,(function(e,t){u[c].prototype[t]=r[t]})),this.each(t,(function(e,t){r[t]?u[c].prototype[t]=function(){return this.parent=r[t],e.apply(this,arguments)}:t!==c&&(u[c].prototype[t]=e)}))),this.each(t.static,(function(e,t){u[c][t]=e}))}},walk:vt,createNS:function(e,t){var n,r;for(t=t||window,e=e.split("."),n=0;n<e.length;n++)t[r=e[n]]||(t[r]={}),t=t[r];return t},resolve:function(e,t){var n,r;for(t=t||window,n=0,r=(e=e.split(".")).length;n<r&&(t=t[e[n]]);n++);return t},explode:function(e,t){return!e||ht(e,"array")?e:Te(e.split(t||","),gt)},_addCacheSuffix:function(e){var t=mt.cacheSuffix;return t&&(e+=(-1===e.indexOf("?")?"?":"&")+t),e}},yt=function(e){if(null==e)throw new Error("Node cannot be null or undefined");return{dom:e}},wt={fromHtml:function(e,t){var n=(t||document).createElement("div");if(n.innerHTML=e,!n.hasChildNodes()||n.childNodes.length>1)throw console.error("HTML does not have a single root node",e),new Error("HTML must have a single root node");return yt(n.childNodes[0])},fromTag:function(e,t){var n=(t||document).createElement(e);return yt(n)},fromText:function(e,t){var n=(t||document).createTextNode(e);return yt(n)},fromDom:yt,fromPoint:function(e,t,n){return F.from(e.dom.elementFromPoint(t,n)).map(yt)}},Ct=function(e,t){var n=[],r=function(e){return n.push(e),t(e)},o=t(e);do{o=o.bind(r)}while(o.isSome());return n},xt=function(e,t){var n=e.dom;if(1!==n.nodeType)return!1;var r=n;if(void 0!==r.matches)return r.matches(t);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(t);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(t);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")},St=function(e){return 1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType||0===e.childElementCount},kt=function(e,t){return e.dom===t.dom},Tt=function(e,t){return n=e.dom,r=t.dom,function(e,t,n){return 0!=(e.compareDocumentPosition(t)&n)}(n,r,Node.DOCUMENT_POSITION_CONTAINED_BY);var n,r},Et=function(e,t){return ot().browser.isIE()?Tt(e,t):function(e,t){var n=e.dom,r=t.dom;return n!==r&&n.contains(r)}(e,t)};"undefined"!=typeof window?window:Function("return this;")();var At=function(e){return e.dom.nodeName.toLowerCase()},_t=function(e){return e.dom.nodeType},Nt=function(e){return function(t){return _t(t)===e}},Rt=Nt(1),Dt=Nt(3),Ot=Nt(9),It=Nt(11),Pt=function(e){return wt.fromDom(e.dom.ownerDocument)},Bt=function(e){return Ot(e)?e:Pt(e)},Mt=function(e){return wt.fromDom(Bt(e).dom.defaultView)},Lt=function(e){return F.from(e.dom.parentNode).map(wt.fromDom)},Ft=function(e){return F.from(e.dom.previousSibling).map(wt.fromDom)},jt=function(e){return F.from(e.dom.nextSibling).map(wt.fromDom)},Ht=function(e){return re(Ct(e,Ft))},Ut=function(e){return Ct(e,jt)},zt=function(e){return q(e.dom.childNodes,wt.fromDom)},Wt=function(e,t){var n=e.dom.childNodes;return F.from(n[t]).map(wt.fromDom)},Vt=function(e){return Wt(e,0)},qt=function(e){return Wt(e,e.dom.childNodes.length-1)},$t=function(e){return e.dom.childNodes.length},Kt=function(e){return It(e)&&w(e.dom.host)},Gt=C(Element.prototype.attachShadow)&&C(Node.prototype.getRootNode),Jt=E(Gt),Xt=Gt?function(e){return wt.fromDom(e.dom.getRootNode())}:Bt,Yt=function(e){return Kt(e)?e:function(e){var t=e.dom.head;if(null==t)throw new Error("Head is not available yet");return wt.fromDom(t)}(Bt(e))},Qt=function(e){return wt.fromDom(e.dom.host)},Zt=function(e){return w(e.dom.shadowRoot)},en=function(e,t){Lt(e).each((function(n){n.dom.insertBefore(t.dom,e.dom)}))},tn=function(e,t){jt(e).fold((function(){Lt(e).each((function(e){rn(e,t)}))}),(function(e){en(e,t)}))},nn=function(e,t){Vt(e).fold((function(){rn(e,t)}),(function(n){e.dom.insertBefore(t.dom,n.dom)}))},rn=function(e,t){e.dom.appendChild(t.dom)},on=function(e,t){$(t,(function(t){rn(e,t)}))},an=function(e){e.dom.textContent="",$(zt(e),(function(e){cn(e)}))},cn=function(e){var t=e.dom;null!==t.parentNode&&t.parentNode.removeChild(t)},un=function(e){var t,n=zt(e);n.length>0&&(t=e,$(n,(function(e){en(t,e)}))),cn(e)},ln=function(e){var t=Dt(e)?e.dom.parentNode:e.dom;if(null==t||null===t.ownerDocument)return!1;var n=t.ownerDocument;return function(e){var t=Xt(e);return Kt(t)?F.some(t):F.none()}(wt.fromDom(t)).fold((function(){return n.body.contains(t)}),T(ln,Qt))},sn=function(e,t){return{left:e,top:t,translate:function(n,r){return sn(e+n,t+r)}}},fn=sn,dn=function(e,t){return void 0!==e?e:void 0!==t?t:0},mn=function(e){var t=e.dom,n=t.ownerDocument.body;return n===t?fn(n.offsetLeft,n.offsetTop):ln(e)?function(e){var t=e.getBoundingClientRect();return fn(t.left,t.top)}(t):fn(0,0)},pn=function(e){var t=void 0!==e?e.dom:document,n=t.body.scrollLeft||t.documentElement.scrollLeft,r=t.body.scrollTop||t.documentElement.scrollTop;return fn(n,r)},gn=function(e,t,n){var r=(void 0!==n?n.dom:document).defaultView;r&&r.scrollTo(e,t)},hn=function(e,t){ot().browser.isSafari()&&C(e.dom.scrollIntoViewIfNeeded)?e.dom.scrollIntoViewIfNeeded(!1):e.dom.scrollIntoView(t)},vn=function(e,t,n,r){return{x:e,y:t,width:n,height:r,right:e+n,bottom:t+r}},bn=function(e){var t=void 0===e?window:e,n=t.document,r=pn(wt.fromDom(n));return function(e){var t=void 0===e?window:e;return ot().browser.isFirefox()?F.none():F.from(t.visualViewport)}(t).fold((function(){var e=t.document.documentElement,n=e.clientWidth,o=e.clientHeight;return vn(r.left,r.top,n,o)}),(function(e){return vn(Math.max(e.pageLeft,r.left),Math.max(e.pageTop,r.top),e.width,e.height)}))},yn=function(e){return function(t){return!!t&&t.nodeType===e}},wn=function(e){return!!e&&!Object.getPrototypeOf(e)},Cn=yn(1),xn=function(e){var t=e.map((function(e){return e.toLowerCase()}));return function(e){if(e&&e.nodeName){var n=e.nodeName.toLowerCase();return W(t,n)}return!1}},Sn=function(e,t){var n=t.toLowerCase().split(" ");return function(t){if(Cn(t))for(var r=0;r<n.length;r++){var o=t.ownerDocument.defaultView.getComputedStyle(t,null);if((o?o.getPropertyValue(e):null)===n[r])return!0}return!1}},kn=function(e){return function(t){return Cn(t)&&t.hasAttribute(e)}},Tn=function(e){return Cn(e)&&e.hasAttribute("data-mce-bogus")},En=function(e){return Cn(e)&&"TABLE"===e.tagName},An=function(e){return function(t){if(Cn(t)){if(t.contentEditable===e)return!0;if(t.getAttribute("data-mce-contenteditable")===e)return!0}return!1}},_n=xn(["textarea","input"]),Nn=yn(3),Rn=yn(8),Dn=yn(9),On=yn(11),In=xn(["br"]),Pn=xn(["img"]),Bn=An("true"),Mn=An("false"),Ln=xn(["td","th"]),Fn=xn(["video","audio","object","embed"]),jn=function(e,t,n){return void 0===n&&(n=_),e.exists((function(e){return n(e,t)}))},Hn=function(e,t,n){return e.isSome()&&t.isSome()?F.some(n(e.getOrDie(),t.getOrDie())):F.none()},Un=function(e){return void 0!==e.style&&C(e.style.getPropertyValue)},zn=function(e,t,n){if(!(m(n)||v(n)||x(n)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",n,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(t,n+"")},Wn=function(e,t,n){zn(e.dom,t,n)},Vn=function(e,t){var n=e.dom;me(t,(function(e,t){zn(n,t,e)}))},qn=function(e,t){var n=e.dom.getAttribute(t);return null===n?void 0:n},$n=function(e,t){return F.from(qn(e,t))},Kn=function(e,t){e.dom.removeAttribute(t)},Gn=function(e,t){var n=e.dom;me(t,(function(e,t){!function(e,t,n){if(!m(n))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",n,":: Element ",e),new Error("CSS value must be a string: "+n);Un(e)&&e.style.setProperty(t,n)}(n,t,e)}))},Jn=function(e,t){var n=e.dom,r=window.getComputedStyle(n).getPropertyValue(t);return""!==r||ln(e)?r:Xn(n,t)},Xn=function(e,t){return Un(e)?e.style.getPropertyValue(t):""},Yn=function(e,t){var n=e.dom,r=Xn(n,t);return F.from(r).filter((function(e){return e.length>0}))},Qn=function(e){var t={},n=e.dom;if(Un(n))for(var r=0;r<n.style.length;r++){var o=n.style.item(r);t[o]=n.style[o]}return t},Zn=ot().browser,er=function(e){return Z(e,Rt)},tr=function(e,t){return e.children&&W(e.children,t)},nr=function(e,t,n){var r=0,o=0,i=e.ownerDocument;if(n=n||e,t){if(n===e&&t.getBoundingClientRect&&"static"===Jn(wt.fromDom(e),"position")){var a=t.getBoundingClientRect();return{x:r=a.left+(i.documentElement.scrollLeft||e.scrollLeft)-i.documentElement.clientLeft,y:o=a.top+(i.documentElement.scrollTop||e.scrollTop)-i.documentElement.clientTop}}for(var c=t;c&&c!==n&&c.nodeType&&!tr(c,n);){var u=c;r+=u.offsetLeft||0,o+=u.offsetTop||0,c=u.offsetParent}for(c=t.parentNode;c&&c!==n&&c.nodeType&&!tr(c,n);)r-=c.scrollLeft||0,o-=c.scrollTop||0,c=c.parentNode;o+=function(e){return Zn.isFirefox()&&"table"===At(e)?er(zt(e)).filter((function(e){return"caption"===At(e)})).bind((function(e){return er(Ut(e)).map((function(t){var n=t.dom.offsetTop,r=e.dom.offsetTop,o=e.dom.offsetHeight;return n<=r?-o:0}))})).getOr(0):0}(wt.fromDom(t))}return{x:r,y:o}},rr={},or={exports:rr};!function(e,r,o,i){!function(t,n){"object"==typeof r&&void 0!==o?o.exports=n():"function"==typeof e&&e.amd?e(n):(t="undefined"!=typeof globalThis?globalThis:t||self).EphoxContactWrapper=n()}(this,(function(){var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{},r={exports:{}};!function(t){!function(e){var r=setTimeout;function o(){}function i(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],f(e,this)}function a(e,t){for(;3===e._state;)e=e._value;0!==e._state?(e._handled=!0,i._immediateFn((function(){var n=1===e._state?t.onFulfilled:t.onRejected;if(null!==n){var r;try{r=n(e._value)}catch(e){return void u(t.promise,e)}c(t.promise,r)}else(1===e._state?c:u)(t.promise,e._value)}))):e._deferreds.push(t)}function c(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var n=t.then;if(t instanceof i)return e._state=3,e._value=t,void l(e);if("function"==typeof n)return void f((r=n,o=t,function(){r.apply(o,arguments)}),e)}e._state=1,e._value=t,l(e)}catch(t){u(e,t)}var r,o}function u(e,t){e._state=2,e._value=t,l(e)}function l(e){2===e._state&&0===e._deferreds.length&&i._immediateFn((function(){e._handled||i._unhandledRejectionFn(e._value)}));for(var t=0,n=e._deferreds.length;t<n;t++)a(e,e._deferreds[t]);e._deferreds=null}function s(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}function f(e,t){var n=!1;try{e((function(e){n||(n=!0,c(t,e))}),(function(e){n||(n=!0,u(t,e))}))}catch(e){if(n)return;n=!0,u(t,e)}}i.prototype.catch=function(e){return this.then(null,e)},i.prototype.then=function(e,t){var n=new this.constructor(o);return a(this,new s(e,t,n)),n},i.all=function(e){var t=Array.prototype.slice.call(e);return new i((function(e,n){if(0===t.length)return e([]);var r=t.length;function o(i,a){try{if(a&&("object"==typeof a||"function"==typeof a)){var c=a.then;if("function"==typeof c)return void c.call(a,(function(e){o(i,e)}),n)}t[i]=a,0==--r&&e(t)}catch(e){n(e)}}for(var i=0;i<t.length;i++)o(i,t[i])}))},i.resolve=function(e){return e&&"object"==typeof e&&e.constructor===i?e:new i((function(t){t(e)}))},i.reject=function(e){return new i((function(t,n){n(e)}))},i.race=function(e){return new i((function(t,n){for(var r=0,o=e.length;r<o;r++)e[r].then(t,n)}))},i._immediateFn="function"==typeof n?function(e){n(e)}:function(e){r(e,0)},i._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},i._setImmediateFn=function(e){i._immediateFn=e},i._setUnhandledRejectionFn=function(e){i._unhandledRejectionFn=e},t.exports?t.exports=i:e.Promise||(e.Promise=i)}(e)}(r);var o=r.exports;return{boltExport:("undefined"!=typeof window?window:Function("return this;")()).Promise||o}}))}(void 0,rr,or);var ir=or.exports.boltExport,ar=function(e){var t=F.none(),n=[],r=function(e){o()?a(e):n.push(e)},o=function(){return t.isSome()},i=function(e){$(e,a)},a=function(e){t.each((function(t){setTimeout((function(){e(t)}),0)}))};return e((function(e){o()||(t=F.some(e),i(n),n=[])})),{get:r,map:function(e){return ar((function(t){r((function(n){t(e(n))}))}))},isReady:o}},cr={nu:ar,pure:function(e){return ar((function(t){t(e)}))}},ur=function(e){setTimeout((function(){throw e}),0)},lr=function(e){var t=function(t){e().then(t,ur)};return{map:function(t){return lr((function(){return e().then(t)}))},bind:function(t){return lr((function(){return e().then((function(e){return t(e).toPromise()}))}))},anonBind:function(t){return lr((function(){return e().then((function(){return t.toPromise()}))}))},toLazy:function(){return cr.nu(t)},toCached:function(){var t=null;return lr((function(){return null===t&&(t=e()),t}))},toPromise:e,get:t}},sr=function(e){return lr((function(){return new ir(e)}))},fr=function(e,t){return t((function(t){var n=[],r=0;0===e.length?t([]):$(e,(function(o,i){o.get(function(o){return function(i){n[o]=i,++r>=e.length&&t(n)}}(i))}))}))},dr=function(e){return{isValue:P,isError:I,getOr:E(e),getOrThunk:E(e),getOrDie:E(e),or:function(t){return dr(e)},orThunk:function(t){return dr(e)},fold:function(t,n){return n(e)},map:function(t){return dr(t(e))},mapError:function(t){return dr(e)},each:function(t){t(e)},bind:function(t){return t(e)},exists:function(t){return t(e)},forall:function(t){return t(e)},toOptional:function(){return F.some(e)}}},mr=function(e){return{isValue:I,isError:P,getOr:A,getOrThunk:function(e){return e()},getOrDie:function(){return(t=String(e),function(){throw new Error(t)})();var t},or:A,orThunk:function(e){return e()},fold:function(t,n){return t(e)},map:function(t){return mr(e)},mapError:function(t){return mr(t(e))},each:S,bind:function(t){return mr(e)},exists:I,forall:P,toOptional:F.none}},pr={value:dr,error:mr,fromOption:function(e,t){return e.fold((function(){return mr(t)}),dr)}},gr=function(e){if(!g(e))throw new Error("cases must be an array");if(0===e.length)throw new Error("there must be at least one case");var t=[],n={};return $(e,(function(r,o){var i=fe(r);if(1!==i.length)throw new Error("one and only one name per case");var a=i[0],c=r[a];if(void 0!==n[a])throw new Error("duplicate key detected:"+a);if("cata"===a)throw new Error("cannot have a case named cata (sorry)");if(!g(c))throw new Error("case arguments must be an array");t.push(a),n[a]=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var i=n.length;if(i!==c.length)throw new Error("Wrong number of arguments to case "+a+". Expected "+c.length+" ("+c+"), got "+i);var u=function(e){var r=fe(e);if(t.length!==r.length)throw new Error("Wrong number of arguments to match. Expected: "+t.join(",")+"\nActual: "+r.join(","));if(!ne(t,(function(e){return W(r,e)})))throw new Error("Not all branches were specified when using match. Specified: "+r.join(", ")+"\nRequired: "+t.join(", "));return e[a].apply(null,n)};return{fold:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];if(t.length!==e.length)throw new Error("Wrong number of arguments to fold. Expected "+e.length+", got "+t.length);var i=t[o];return i.apply(null,n)},match:u,log:function(e){console.log(e,{constructors:t,constructor:a,params:n})}}}})),n};gr([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]);var hr=function(e){return e.fold(A,A)};function vr(e,t,n,r,o){return e(n,r)?F.some(n):C(o)&&o(n)?F.none():t(n,r,o)}var br,yr,wr,Cr,xr,Sr,kr,Tr,Er,Ar,_r,Nr,Rr,Dr,Or,Ir,Pr,Br,Mr,Lr,Fr=function(e,t,n){for(var r=e.dom,o=C(n)?n:I;r.parentNode;){r=r.parentNode;var i=wt.fromDom(r);if(t(i))return F.some(i);if(o(i))break}return F.none()},jr=function(e,t,n){return vr((function(e,t){return t(e)}),Fr,e,t,n)},Hr=function(e,t){return Z(e.dom.childNodes,(function(e){return t(wt.fromDom(e))})).map(wt.fromDom)},Ur=function(e,t,n){return Fr(e,(function(e){return xt(e,t)}),n)},zr=function(e,t){return function(e,t){var n=void 0===t?document:t.dom;return St(n)?F.none():F.from(n.querySelector(e)).map(wt.fromDom)}(t,e)},Wr=function(e,t,n){return vr((function(e,t){return xt(e,t)}),Ur,e,t,n)},Vr=window.Promise?window.Promise:ir,qr=function(e,t){return"number"!=typeof t&&(t=0),setTimeout(e,t)},$r=function(e,t){return"number"!=typeof t&&(t=1),setInterval(e,t)},Kr=function(e,t){var n,r=function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];clearTimeout(n),n=qr((function(){e.apply(this,r)}),t)};return r.stop=function(){clearTimeout(n)},r},Gr={requestAnimationFrame:function(e,t){br?br.then(e):br=new Vr((function(e){t||(t=document.body),function(e,t){for(var n=window.requestAnimationFrame,r=["ms","moz","webkit"],o=0;o<r.length&&!n;o++)n=window[r[o]+"RequestAnimationFrame"];n||(n=function(e){window.setTimeout(e,0)}),n(e,t)}(e,t)})).then(e)},setTimeout:qr,setInterval:$r,setEditorTimeout:function(e,t,n){return qr((function(){e.removed||t()}),n)},setEditorInterval:function(e,t,n){var r=$r((function(){e.removed?clearInterval(r):t()}),n);return r},debounce:Kr,throttle:Kr,clearInterval:function(e){return clearInterval(e)},clearTimeout:function(e){return clearTimeout(e)}},Jr=function(e,t){void 0===t&&(t={});var n=0,r={},o=wt.fromDom(e),i=Bt(o),a=t.maxLoadTime||5e3,c=function(c,u,l){var s,f=bt._addCacheSuffix(c),d=function(e){return we(r,e).getOrThunk((function(){return{id:"mce-u"+n++,passed:[],failed:[],count:0}}))}(f);r[f]=d,d.count++;var m=function(e,t){for(var n=e.length;n--;)e[n]();d.status=t,d.passed=[],d.failed=[],s&&(s.onload=null,s.onerror=null,s=null)},p=function(){return m(d.passed,2)},g=function(){return m(d.failed,3)},h=function(){var t;t=h,function(){for(var t=e.styleSheets,n=t.length;n--;){var r=t[n].ownerNode;if(r&&r.id===s.id)return p(),!0}return!1}()||(Date.now()-y<a?Gr.setTimeout(t):g())};if(u&&d.passed.push(u),l&&d.failed.push(l),1!==d.status)if(2!==d.status)if(3!==d.status){d.status=1;var v=wt.fromTag("link",i.dom);Vn(v,{rel:"stylesheet",type:"text/css",id:d.id});var b,y=Date.now();t.contentCssCors&&Wn(v,"crossOrigin","anonymous"),t.referrerPolicy&&Wn(v,"referrerpolicy",t.referrerPolicy),(s=v.dom).onload=h,s.onerror=g,b=v,rn(Yt(o),b),Wn(v,"href",f)}else g();else p()},u=function(e){return sr((function(t){c(e,k(t,E(pr.value(e))),k(t,E(pr.error(e))))}))},l=function(e){var t=bt._addCacheSuffix(e);we(r,t).each((function(e){var n,i;0===--e.count&&(delete r[t],n=e.id,i=Yt(o),zr(i,"#"+n).each(cn))}))};return{load:c,loadAll:function(e,t,n){var r;(r=q(e,u),fr(r,sr)).get((function(e){var r=G(e,(function(e){return e.isValue()}));r.fail.length>0?n(r.fail.map(hr)):t(r.pass.map(hr))}))},unload:l,unloadAll:function(e){$(e,(function(e){l(e)}))},_setReferrerPolicy:function(e){t.referrerPolicy=e}}},Xr=function(){var e=new WeakMap;return{forElement:function(t,n){var r=Xt(t).dom;return F.from(e.get(r)).getOrThunk((function(){var t=Jr(r,n);return e.set(r,t),t}))}}}(),Yr=function(){function e(e,t){this.node=e,this.rootNode=t,this.current=this.current.bind(this),this.next=this.next.bind(this),this.prev=this.prev.bind(this),this.prev2=this.prev2.bind(this)}return e.prototype.current=function(){return this.node},e.prototype.next=function(e){return this.node=this.findSibling(this.node,"firstChild","nextSibling",e),this.node},e.prototype.prev=function(e){return this.node=this.findSibling(this.node,"lastChild","previousSibling",e),this.node},e.prototype.prev2=function(e){return this.node=this.findPreviousNode(this.node,"lastChild","previousSibling",e),this.node},e.prototype.findSibling=function(e,t,n,r){var o,i;if(e){if(!r&&e[t])return e[t];if(e!==this.rootNode){if(o=e[n])return o;for(i=e.parentNode;i&&i!==this.rootNode;i=i.parentNode)if(o=i[n])return o}}},e.prototype.findPreviousNode=function(e,t,n,r){var o,i,a;if(e){if(o=e[n],this.rootNode&&o===this.rootNode)return;if(o){if(!r)for(a=o[t];a;a=a[t])if(!a[t])return a;return o}if((i=e.parentNode)&&i!==this.rootNode)return i}},e}(),Qr=function(e){var t;return function(n){return t=t||function(e,t){for(var n={},r=0,o=e.length;r<o;r++){var i=e[r];n[String(i)]=t(i,r)}return n}(e,P),Ce(t,At(n))}},Zr=Qr(["h1","h2","h3","h4","h5","h6"]),eo=Qr(["article","aside","details","div","dt","figcaption","footer","form","fieldset","header","hgroup","html","main","nav","section","summary","body","p","dl","multicol","dd","figure","address","center","blockquote","h1","h2","h3","h4","h5","h6","listing","xmp","pre","plaintext","menu","dir","ul","ol","li","hr","table","tbody","thead","tfoot","th","tr","td","caption"]),to=function(e){return Rt(e)&&!eo(e)},no=function(e){return Rt(e)&&"br"===At(e)},ro=Qr(["h1","h2","h3","h4","h5","h6","p","div","address","pre","form","blockquote","center","dir","fieldset","header","footer","article","section","hgroup","aside","nav","figure"]),oo=Qr(["ul","ol","dl"]),io=Qr(["li","dd","dt"]),ao=Qr(["thead","tbody","tfoot"]),co=Qr(["td","th"]),uo=Qr(["pre","script","textarea","style"]),lo=function(e){return"\ufeff"===e},so=function(e){return e.replace(/\uFEFF/g,"")},fo=Cn,mo=Nn,po=function(e){return mo(e)&&(e=e.parentNode),fo(e)&&e.hasAttribute("data-mce-caret")},go=function(e){return mo(e)&&lo(e.data)},ho=function(e){return po(e)||go(e)},vo=function(e){return e.firstChild!==e.lastChild||!In(e.firstChild)},bo=function(e){var t=e.container();return!!Nn(t)&&("\ufeff"===t.data.charAt(e.offset())||e.isAtStart()&&go(t.previousSibling))},yo=function(e){var t=e.container();return!!Nn(t)&&("\ufeff"===t.data.charAt(e.offset()-1)||e.isAtEnd()&&go(t.nextSibling))},wo=function(e,t,n){var r,o=t.ownerDocument.createElement(e);o.setAttribute("data-mce-caret",n?"before":"after"),o.setAttribute("data-mce-bogus","all"),o.appendChild(((r=document.createElement("br")).setAttribute("data-mce-bogus","1"),r));var i=t.parentNode;return n?i.insertBefore(o,t):t.nextSibling?i.insertBefore(o,t.nextSibling):i.appendChild(o),o},Co=function(e){return mo(e)&&"\ufeff"===e.data[0]},xo=function(e){return mo(e)&&"\ufeff"===e.data[e.data.length-1]},So=function(e){return e&&e.hasAttribute("data-mce-caret")?(t=e.getElementsByTagName("br"),n=t[t.length-1],Tn(n)&&n.parentNode.removeChild(n),e.removeAttribute("data-mce-caret"),e.removeAttribute("data-mce-bogus"),e.removeAttribute("style"),e.removeAttribute("_moz_abspos"),e):null;var t,n},ko=function(e){return po(e.startContainer)},To=Bn,Eo=Mn,Ao=In,_o=Nn,No=xn(["script","style","textarea"]),Ro=xn(["img","input","textarea","hr","iframe","video","audio","object","embed"]),Do=xn(["table"]),Oo=ho,Io=function(e){return!Oo(e)&&(_o(e)?!No(e.parentNode):Ro(e)||Ao(e)||Do(e)||Po(e))},Po=function(e){return!1===function(e){return Cn(e)&&"true"===e.getAttribute("unselectable")}(e)&&Eo(e)},Bo=function(e,t){return Io(e)&&function(e,t){for(e=e.parentNode;e&&e!==t;e=e.parentNode){if(Po(e))return!1;if(To(e))return!0}return!0}(e,t)},Mo=/^[ \t\r\n]*$/,Lo=function(e){return Mo.test(e)},Fo=function(e,t){var n,r,o,i=wt.fromDom(t),a=wt.fromDom(e);return n=a,r="pre,code",o=N(kt,i),Ur(n,r,o).isSome()},jo=function(e,t){return Io(e)&&!1===function(e,t){return Nn(e)&&Lo(e.data)&&!1===Fo(e,t)}(e,t)||function(e){return Cn(e)&&"A"===e.nodeName&&!e.hasAttribute("href")&&(e.hasAttribute("name")||e.hasAttribute("id"))}(e)||Ho(e)},Ho=kn("data-mce-bookmark"),Uo=kn("data-mce-bogus"),zo=(yr="data-mce-bogus",wr="all",function(e){return Cn(e)&&e.getAttribute(yr)===wr}),Wo=function(e,t){return void 0===t&&(t=!0),function(e,t){var n=0;if(jo(e,e))return!1;var r=e.firstChild;if(!r)return!0;var o=new Yr(r,e);do{if(t){if(zo(r)){r=o.next(!0);continue}if(Uo(r)){r=o.next();continue}}if(In(r))n++,r=o.next();else{if(jo(r,e))return!1;r=o.next()}}while(r);return n<=1}(e.dom,t)},Vo=function(e,t){return w(e)&&(jo(e,t)||to(wt.fromDom(e)))},qo=function(e){return function(e){return"span"===e.nodeName.toLowerCase()}(e)&&"bookmark"===e.getAttribute("data-mce-type")},$o=function(e,t){return Nn(e)&&e.data.length>0&&function(e,t){var n=new Yr(e,t).prev(!1),r=new Yr(e,t).next(!1),o=b(n)||Vo(n,t),i=b(r)||Vo(r,t);return o&&i}(e,t)},Ko=function(e,t,n){var r=n||t;if(Cn(t)&&qo(t))return t;for(var o=t.childNodes,i=o.length-1;i>=0;i--)Ko(e,o[i],r);if(Cn(t)){var a=t.childNodes;1===a.length&&qo(a[0])&&t.parentNode.insertBefore(a[0],t)}return function(e){return On(e)||Dn(e)}(t)||jo(t,r)||function(e){return!!Cn(e)&&e.childNodes.length>0}(t)||$o(t,r)||e.remove(t),t},Go=bt.makeMap,Jo=/[&<>\"\u0060\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,Xo=/[<>&\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,Yo=/[<>&\"\']/g,Qo=/&#([a-z0-9]+);?|&([a-z0-9]+);/gi,Zo={128:"",130:"",131:"",132:"",133:"",134:"",135:"",136:"",137:"",138:"",139:"",140:"",142:"",145:"",146:"",147:"",148:"",149:"",150:"",151:"",152:"",153:"",154:"",155:"",156:"",158:"",159:""},ei={'"':"&quot;","'":"&#39;","<":"&lt;",">":"&gt;","&":"&amp;","`":"&#96;"},ti={"&lt;":"<","&gt;":">","&amp;":"&","&quot;":'"',"&apos;":"'"},ni=function(e,t){var n,r,o,i={};if(e){for(e=e.split(","),t=t||10,n=0;n<e.length;n+=2)r=String.fromCharCode(parseInt(e[n],t)),ei[r]||(o="&"+e[n+1]+";",i[r]=o,i[o]=r);return i}},ri=ni("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro",32),oi=function(e,t){return e.replace(t?Jo:Xo,(function(e){return ei[e]||e}))},ii=function(e,t){return e.replace(t?Jo:Xo,(function(e){return e.length>1?"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";":ei[e]||"&#"+e.charCodeAt(0)+";"}))},ai=function(e,t,n){return n=n||ri,e.replace(t?Jo:Xo,(function(e){return ei[e]||n[e]||e}))},ci={encodeRaw:oi,encodeAllRaw:function(e){return(""+e).replace(Yo,(function(e){return ei[e]||e}))},encodeNumeric:ii,encodeNamed:ai,getEncodeFunc:function(e,t){var n=ni(t)||ri,r=Go(e.replace(/\+/g,","));return r.named&&r.numeric?function(e,t){return e.replace(t?Jo:Xo,(function(e){return void 0!==ei[e]?ei[e]:void 0!==n[e]?n[e]:e.length>1?"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";":"&#"+e.charCodeAt(0)+";"}))}:r.named?t?function(e,t){return ai(e,t,n)}:ai:r.numeric?ii:oi},decode:function(e){return e.replace(Qo,(function(e,t){return t?(t="x"===t.charAt(0).toLowerCase()?parseInt(t.substr(1),16):parseInt(t,10))>65535?(t-=65536,String.fromCharCode(55296+(t>>10),56320+(1023&t))):Zo[t]||String.fromCharCode(t):ti[e]||ri[e]||function(e){var t=wt.fromTag("div").dom;return t.innerHTML=e,t.textContent||t.innerText||e}(e)}))}},ui={},li={},si=bt.makeMap,fi=bt.each,di=bt.extend,mi=bt.explode,pi=bt.inArray,gi=function(e,t){return(e=bt.trim(e))?e.split(t||" "):[]},hi=function(e,t){var n;return e&&(n={},"string"==typeof e&&(e={"*":e}),fi(e,(function(e,r){n[r]=n[r.toUpperCase()]="map"===t?si(e,/[, ]/):mi(e,/[, ]/)}))),n},vi=function(e){var t={},n={},r=[],o={},i={},a=function(t,n,r){var o=e[t];return o?o=si(o,/[, ]/,si(o.toUpperCase(),/[, ]/)):(o=ui[t])||(o=si(n," ",si(n.toUpperCase()," ")),o=di(o,r),ui[t]=o),o},c=function(e){var t,n,r,o,i,a,c={},u=function(e,n,r){var o,i,a,u=function(e,t){var n,r,o={};for(n=0,r=e.length;n<r;n++)o[e[n]]=t||{};return o};n=n||"","string"==typeof(r=r||[])&&(r=gi(r));var l=gi(e);for(o=l.length;o--;)a={attributes:u(i=gi([t,n].join(" "))),attributesOrder:i,children:u(r,li)},c[l[o]]=a},l=function(e,t){var n,r,o,i,a=gi(e);n=a.length;for(var u=gi(t);n--;)for(r=c[a[n]],o=0,i=u.length;o<i;o++)r.attributes[u[o]]={},r.attributesOrder.push(u[o])};return ui[e]?ui[e]:(t="id accesskey class dir lang style tabindex title role",n="address blockquote div dl fieldset form h1 h2 h3 h4 h5 h6 hr menu ol p pre table ul",r="a abbr b bdo br button cite code del dfn em embed i iframe img input ins kbd label map noscript object q s samp script select small span strong sub sup textarea u var #text #comment","html4"!==e&&(t+=" contenteditable contextmenu draggable dropzone hidden spellcheck translate",n+=" article aside details dialog figure main header footer hgroup section nav",r+=" audio canvas command datalist mark meter output picture progress time wbr video ruby bdi keygen"),"html5-strict"!==e&&(t+=" xml:lang",r=[r,a="acronym applet basefont big font strike tt"].join(" "),fi(gi(a),(function(e){u(e,"",r)})),n=[n,i="center dir isindex noframes"].join(" "),o=[n,r].join(" "),fi(gi(i),(function(e){u(e,"",o)}))),o=o||[n,r].join(" "),u("html","manifest","head body"),u("head","","base command link meta noscript script style title"),u("title hr noscript br"),u("base","href target"),u("link","href rel media hreflang type sizes hreflang"),u("meta","name http-equiv content charset"),u("style","media type scoped"),u("script","src async defer type charset"),u("body","onafterprint onbeforeprint onbeforeunload onblur onerror onfocus onhashchange onload onmessage onoffline ononline onpagehide onpageshow onpopstate onresize onscroll onstorage onunload",o),u("address dt dd div caption","",o),u("h1 h2 h3 h4 h5 h6 pre p abbr code var samp kbd sub sup i b u bdo span legend em strong small s cite dfn","",r),u("blockquote","cite",o),u("ol","reversed start type","li"),u("ul","","li"),u("li","value",o),u("dl","","dt dd"),u("a","href target rel media hreflang type",r),u("q","cite",r),u("ins del","cite datetime",o),u("img","src sizes srcset alt usemap ismap width height"),u("iframe","src name width height",o),u("embed","src type width height"),u("object","data type typemustmatch name usemap form width height",[o,"param"].join(" ")),u("param","name value"),u("map","name",[o,"area"].join(" ")),u("area","alt coords shape href target rel media hreflang type"),u("table","border","caption colgroup thead tfoot tbody tr"+("html4"===e?" col":"")),u("colgroup","span","col"),u("col","span"),u("tbody thead tfoot","","tr"),u("tr","","td th"),u("td","colspan rowspan headers",o),u("th","colspan rowspan headers scope abbr",o),u("form","accept-charset action autocomplete enctype method name novalidate target",o),u("fieldset","disabled form name",[o,"legend"].join(" ")),u("label","form for",r),u("input","accept alt autocomplete checked dirname disabled form formaction formenctype formmethod formnovalidate formtarget height list max maxlength min multiple name pattern readonly required size src step type value width"),u("button","disabled form formaction formenctype formmethod formnovalidate formtarget name type value","html4"===e?o:r),u("select","disabled form multiple name required size","option optgroup"),u("optgroup","disabled label","option"),u("option","disabled label selected value"),u("textarea","cols dirname disabled form maxlength name readonly required rows wrap"),u("menu","type label",[o,"li"].join(" ")),u("noscript","",o),"html4"!==e&&(u("wbr"),u("ruby","",[r,"rt rp"].join(" ")),u("figcaption","",o),u("mark rt rp summary bdi","",r),u("canvas","width height",o),u("video","src crossorigin poster preload autoplay mediagroup loop muted controls width height buffered",[o,"track source"].join(" ")),u("audio","src crossorigin preload autoplay mediagroup loop muted controls buffered volume",[o,"track source"].join(" ")),u("picture","","img source"),u("source","src srcset type media sizes"),u("track","kind src srclang label default"),u("datalist","",[r,"option"].join(" ")),u("article section nav aside main header footer","",o),u("hgroup","","h1 h2 h3 h4 h5 h6"),u("figure","",[o,"figcaption"].join(" ")),u("time","datetime",r),u("dialog","open",o),u("command","type label icon disabled checked radiogroup command"),u("output","for form name",r),u("progress","value max",r),u("meter","value min max low high optimum",r),u("details","open",[o,"summary"].join(" ")),u("keygen","autofocus challenge disabled form keytype name")),"html5-strict"!==e&&(l("script","language xml:space"),l("style","xml:space"),l("object","declare classid code codebase codetype archive standby align border hspace vspace"),l("embed","align name hspace vspace"),l("param","valuetype type"),l("a","charset name rev shape coords"),l("br","clear"),l("applet","codebase archive code object alt name width height align hspace vspace"),l("img","name longdesc align border hspace vspace"),l("iframe","longdesc frameborder marginwidth marginheight scrolling align"),l("font basefont","size color face"),l("input","usemap align"),l("select"),l("textarea"),l("h1 h2 h3 h4 h5 h6 div p legend caption","align"),l("ul","type compact"),l("li","type"),l("ol dl menu dir","compact"),l("pre","width xml:space"),l("hr","align noshade size width"),l("isindex","prompt"),l("table","summary width frame rules cellspacing cellpadding align bgcolor"),l("col","width align char charoff valign"),l("colgroup","width align char charoff valign"),l("thead","align char charoff valign"),l("tr","align char charoff valign bgcolor"),l("th","axis align char charoff valign nowrap bgcolor width height"),l("form","accept"),l("td","abbr axis scope align char charoff valign nowrap bgcolor width height"),l("tfoot","align char charoff valign"),l("tbody","align char charoff valign"),l("area","nohref"),l("body","background bgcolor text link vlink alink")),"html4"!==e&&(l("input button select textarea","autofocus"),l("input textarea","placeholder"),l("a","download"),l("link script img","crossorigin"),l("img","loading"),l("iframe","sandbox seamless allowfullscreen loading")),fi(gi("a form meter progress dfn"),(function(e){c[e]&&delete c[e].children[e]})),delete c.caption.children.table,delete c.script,ui[e]=c,c)}((e=e||{}).schema);!1===e.verify_html&&(e.valid_elements="*[*]");var u=hi(e.valid_styles),l=hi(e.invalid_styles,"map"),s=hi(e.valid_classes,"map"),f=a("whitespace_elements","pre script noscript style textarea video audio iframe object code"),d=a("self_closing_elements","colgroup dd dt li option p td tfoot th thead tr"),m=a("short_ended_elements","area base basefont br col frame hr img input isindex link meta param embed source wbr track"),p=a("boolean_attributes","checked compact declare defer disabled ismap multiple nohref noresize noshade nowrap readonly selected autoplay loop controls"),g=a("non_empty_elements","td th iframe video audio object script code pre",m),h=a("move_caret_before_on_enter_elements","td th iframe video audio object script code table",m),v=a("text_block_elements","h1 h2 h3 h4 h5 h6 p div address pre form blockquote center dir fieldset header footer article section hgroup aside main nav figure"),b=a("block_elements","hr table tbody thead tfoot th tr td li ol ul caption dl dt dd noscript menu isindex option datalist select optgroup figcaption details summary",v),y=a("text_inline_elements","span strong b em i font strike u var cite dfn code mark q sup sub samp");fi((e.special||"script noscript iframe noframes noembed title style textarea xmp").split(" "),(function(e){i[e]=new RegExp("</"+e+"[^>]*>","gi")}));var w=function(e){return new RegExp("^"+e.replace(/([?+*])/g,".$1")+"$")},C=function(e){var n,o,i,a,c,u,l,s,f,d,m,p,g,h,v,b,y,C,x=/^([#+\-])?([^\[!\/]+)(?:\/([^\[!]+))?(?:(!?)\[([^\]]+)])?$/,S=/^([!\-])?(\w+[\\:]:\w+|[^=:<]+)?(?:([=:<])(.*))?$/,k=/[*?+]/;if(e){var T=gi(e,",");for(t["@"]&&(b=t["@"].attributes,y=t["@"].attributesOrder),n=0,o=T.length;n<o;n++)if(c=x.exec(T[n])){if(h=c[1],f=c[2],v=c[3],s=c[5],u={attributes:p={},attributesOrder:g=[]},"#"===h&&(u.paddEmpty=!0),"-"===h&&(u.removeEmpty=!0),"!"===c[4]&&(u.removeEmptyAttrs=!0),b&&(me(b,(function(e,t){p[t]=e})),g.push.apply(g,y)),s)for(i=0,a=(s=gi(s,"|")).length;i<a;i++)if(c=S.exec(s[i])){if(l={},m=c[1],d=c[2].replace(/[\\:]:/g,":"),h=c[3],C=c[4],"!"===m&&(u.attributesRequired=u.attributesRequired||[],u.attributesRequired.push(d),l.required=!0),"-"===m){delete p[d],g.splice(pi(g,d),1);continue}h&&("="===h&&(u.attributesDefault=u.attributesDefault||[],u.attributesDefault.push({name:d,value:C}),l.defaultValue=C),":"===h&&(u.attributesForced=u.attributesForced||[],u.attributesForced.push({name:d,value:C}),l.forcedValue=C),"<"===h&&(l.validValues=si(C,"?"))),k.test(d)?(u.attributePatterns=u.attributePatterns||[],l.pattern=w(d),u.attributePatterns.push(l)):(p[d]||g.push(d),p[d]=l)}b||"@"!==f||(b=p,y=g),v&&(u.outputName=f,t[v]=u),k.test(f)?(u.pattern=w(f),r.push(u)):t[f]=u}}},x=function(e){t={},r=[],C(e),fi(c,(function(e,t){n[t]=e.children}))},S=function(e){var r=/^(~)?(.+)$/;e&&(ui.text_block_elements=ui.block_elements=null,fi(gi(e,","),(function(e){var i=r.exec(e),a="~"===i[1],c=a?"span":"div",u=i[2];if(n[u]=n[c],o[u]=c,a||(b[u.toUpperCase()]={},b[u]={}),!t[u]){var l=t[c];delete(l=di({},l)).removeEmptyAttrs,delete l.removeEmpty,t[u]=l}fi(n,(function(e,t){e[c]&&(n[t]=e=di({},n[t]),e[u]=e[c])}))})))},k=function(t){var r=/^([+\-]?)([A-Za-z0-9_\-.\u00b7\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u037d\u037f-\u1fff\u200c-\u200d\u203f-\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]+)\[([^\]]+)]$/;ui[e.schema]=null,t&&fi(gi(t,","),(function(e){var t,o,i=r.exec(e);i&&(o=i[1],t=o?n[i[2]]:n[i[2]]={"#comment":{}},t=n[i[2]],fi(gi(i[3],"|"),(function(e){"-"===o?delete t[e]:t[e]={}})))}))},T=function(e){var n,o=t[e];if(o)return o;for(n=r.length;n--;)if((o=r[n]).pattern.test(e))return o};e.valid_elements?x(e.valid_elements):(fi(c,(function(e,r){t[r]={attributes:e.attributes,attributesOrder:e.attributesOrder},n[r]=e.children})),"html5"!==e.schema&&fi(gi("strong/b em/i"),(function(e){var n=gi(e,"/");t[n[1]].outputName=n[0]})),fi(gi("ol ul sub sup blockquote span font a table tbody strong em b i"),(function(e){t[e]&&(t[e].removeEmpty=!0)})),fi(gi("p h1 h2 h3 h4 h5 h6 th td pre div address caption li"),(function(e){t[e].paddEmpty=!0})),fi(gi("span"),(function(e){t[e].removeEmptyAttrs=!0}))),S(e.custom_elements),k(e.valid_children),C(e.extended_valid_elements),k("+ol[ul|ol],+ul[ul|ol]"),fi({dd:"dl",dt:"dl",li:"ul ol",td:"tr",th:"tr",tr:"tbody thead tfoot",tbody:"table",thead:"table",tfoot:"table",legend:"fieldset",area:"map",param:"video audio object"},(function(e,n){t[n]&&(t[n].parentsRequired=gi(e))})),e.invalid_elements&&fi(mi(e.invalid_elements),(function(e){t[e]&&delete t[e]})),T("span")||C("span[!data-mce-type|*]");var A=E(u),_=E(l),N=E(s),R=E(p),D=E(b),O=E(v),I=E(y),P=E(m),B=E(d),M=E(g),L=E(h),F=E(f),j=E(i),H=E(o);return{children:n,elements:t,getValidStyles:A,getValidClasses:N,getBlockElements:D,getInvalidStyles:_,getShortEndedElements:P,getTextBlockElements:O,getTextInlineElements:I,getBoolAttrs:R,getElementRule:T,getSelfClosingElements:B,getNonEmptyElements:M,getMoveCaretBeforeOnEnterElements:L,getWhiteSpaceElements:F,getSpecialElements:j,isValidChild:function(e,t){var r=n[e.toLowerCase()];return!(!r||!r[t.toLowerCase()])},isValid:function(e,t){var n,r,o=T(e);if(o){if(!t)return!0;if(o.attributes[t])return!0;if(n=o.attributePatterns)for(r=n.length;r--;)if(n[r].pattern.test(e))return!0}return!1},getCustomElements:H,addValidElements:C,setValidElements:x,addCustomElements:S,addValidChildren:k}},bi=function(e,t,n,r){var o=function(e){return(e=parseInt(e,10).toString(16)).length>1?e:"0"+e};return"#"+o(t)+o(n)+o(r)},yi=function(e,t){var n,r,o,i=this,a=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\s*\)/gi,c=/(?:url(?:(?:\(\s*\"([^\"]+)\"\s*\))|(?:\(\s*\'([^\']+)\'\s*\))|(?:\(\s*([^)\s]+)\s*\))))|(?:\'([^\']+)\')|(?:\"([^\"]+)\")/gi,u=/\s*([^:]+):\s*([^;]+);?/g,l=/\s+$/,s={};e=e||{},t&&(r=t.getValidStyles(),o=t.getInvalidStyles());var f="\\\" \\' \\; \\: ; : \ufeff".split(" ");for(n=0;n<f.length;n++)s[f[n]]="\ufeff"+n,s["\ufeff"+n]=f[n];return{toHex:function(e){return e.replace(a,bi)},parse:function(t){var r,o,f,d,m,p,g,h,v={},b=e.url_converter,y=e.url_converter_scope||i,w=function(e,t,r){var o=v[e+"-top"+t];if(o){var i=v[e+"-right"+t];if(i){var a=v[e+"-bottom"+t];if(a){var c=v[e+"-left"+t];if(c){var u=[o,i,a,c];for(n=u.length-1;n--&&u[n]===u[n+1];);n>-1&&r||(v[e+t]=-1===n?u[0]:u.join(" "),delete v[e+"-top"+t],delete v[e+"-right"+t],delete v[e+"-bottom"+t],delete v[e+"-left"+t])}}}}},C=function(e){var t,n=v[e];if(n){for(t=(n=n.split(" ")).length;t--;)if(n[t]!==n[0])return!1;return v[e]=n[0],!0}},x=function(e){return d=!0,s[e]},S=function(e,t){return d&&(e=e.replace(/\uFEFF[0-9]/g,(function(e){return s[e]}))),t||(e=e.replace(/\\([\'\";:])/g,"$1")),e},k=function(e){return String.fromCharCode(parseInt(e.slice(1),16))},T=function(e){return e.replace(/\\[0-9a-f]+/gi,k)},E=function(t,n,r,o,i,a){if(i=i||a)return"'"+(i=S(i)).replace(/\'/g,"\\'")+"'";if(n=S(n||r||o),!e.allow_script_urls){var c=n.replace(/[\s\r\n]+/g,"");if(/(java|vb)script:/i.test(c))return"";if(!e.allow_svg_data_urls&&/^data:image\/svg/i.test(c))return""}return b&&(n=b.call(y,n,"style")),"url('"+n.replace(/\'/g,"\\'")+"')"};if(t){for(t=(t=t.replace(/[\u0000-\u001F]/g,"")).replace(/\\[\"\';:\uFEFF]/g,x).replace(/\"[^\"]+\"|\'[^\']+\'/g,(function(e){return e.replace(/[;:]/g,x)}));r=u.exec(t);)if(u.lastIndex=r.index+r[0].length,o=r[1].replace(l,"").toLowerCase(),f=r[2].replace(l,""),o&&f){if(o=T(o),f=T(f),-1!==o.indexOf("\ufeff")||-1!==o.indexOf('"'))continue;if(!e.allow_script_urls&&("behavior"===o||/expression\s*\(|\/\*|\*\//.test(f)))continue;"font-weight"===o&&"700"===f?f="bold":"color"!==o&&"background-color"!==o||(f=f.toLowerCase()),f=(f=f.replace(a,bi)).replace(c,E),v[o]=d?S(f,!0):f}w("border","",!0),w("border","-width"),w("border","-color"),w("border","-style"),w("padding",""),w("margin",""),m="border",g="border-style",h="border-color",C(p="border-width")&&C(g)&&C(h)&&(v[m]=v[p]+" "+v[g]+" "+v[h],delete v[p],delete v[g],delete v[h]),"medium none"===v.border&&delete v.border,"none"===v["border-image"]&&delete v["border-image"]}return v},serialize:function(e,t){var n="",i=function(t){var o,i=r[t];if(i)for(var a=0,c=i.length;a<c;a++)t=i[a],(o=e[t])&&(n+=(n.length>0?" ":"")+t+": "+o+";")};return t&&r?(i("*"),i(t)):me(e,(function(e,r){!e||o&&!function(e,t){var n=o["*"];return(!n||!n[e])&&!((n=o[t])&&n[e])}(r,t)||(n+=(n.length>0?" ":"")+r+": "+e+";")})),n}}},wi={keyLocation:!0,layerX:!0,layerY:!0,returnValue:!0,webkitMovementX:!0,webkitMovementY:!0,keyIdentifier:!0,mozPressure:!0},Ci=function(e){return e instanceof Event||C(e.initEvent)},xi=function(e,t,n,r){var o,i=function(e,t){var n=null!=t?t:{};for(var r in e)Ce(wi,r)||(n[r]=e[r]);return w(n.composedPath)&&(n.composedPath=function(){return e.composedPath()}),n}(t,r);return i.type=e,y(i.target)&&(i.target=null!==(o=i.srcElement)&&void 0!==o?o:n),function(e){return y(e.preventDefault)||Ci(e)}(t)&&(i.preventDefault=function(){i.defaultPrevented=!0,i.isDefaultPrevented=P,C(t.preventDefault)?t.preventDefault():Ci(t)&&(t.returnValue=!1)},i.stopPropagation=function(){i.cancelBubble=!0,i.isPropagationStopped=P,C(t.stopPropagation)?t.stopPropagation():Ci(t)&&(t.cancelBubble=!0)},i.stopImmediatePropagation=function(){i.isImmediatePropagationStopped=P,i.stopPropagation()},function(e){return e.isDefaultPrevented===P||e.isDefaultPrevented===I}(i)||(i.isDefaultPrevented=!0===i.defaultPrevented?P:I,i.isPropagationStopped=!0===i.cancelBubble?P:I,i.isImmediatePropagationStopped=I)),i},Si=/^(?:mouse|contextmenu)|click/,ki=function(e,t,n,r){e.addEventListener?e.addEventListener(t,n,r||!1):e.attachEvent&&e.attachEvent("on"+t,n)},Ti=function(e,t,n,r){e.removeEventListener?e.removeEventListener(t,n,r||!1):e.detachEvent&&e.detachEvent("on"+t,n)},Ei=function(e,t){var n=xi(e.type,e,document,t);if(function(e){return w(e)&&Si.test(e.type)}(e)&&b(e.pageX)&&!b(e.clientX)){var r=n.target.ownerDocument||document,o=r.documentElement,i=r.body,a=n;a.pageX=e.clientX+(o&&o.scrollLeft||i&&i.scrollLeft||0)-(o&&o.clientLeft||i&&i.clientLeft||0),a.pageY=e.clientY+(o&&o.scrollTop||i&&i.scrollTop||0)-(o&&o.clientTop||i&&i.clientTop||0)}return b(n.metaKey)&&(n.metaKey=!1),n},Ai=function(e,t,n){var r=e.document,o={type:"ready"};if(n.domLoaded)t(o);else{var i=function(){Ti(e,"DOMContentLoaded",i),Ti(e,"load",i),n.domLoaded||(n.domLoaded=!0,t(o)),e=null};"complete"===r.readyState||"interactive"===r.readyState&&r.body?i():ki(e,"DOMContentLoaded",i),n.domLoaded||ki(e,"load",i)}},_i=function(){function e(){this.domLoaded=!1,this.events={},this.count=1,this.expando="mce-data-"+(+new Date).toString(32),this.hasMouseEnterLeave="onmouseenter"in document.documentElement,this.hasFocusIn="onfocusin"in document.documentElement,this.count=1}return e.prototype.bind=function(e,t,n,r){var o,i,a,c,u,l,s,f=this,d=window,m=function(e){f.executeHandlers(Ei(e||d.event),o)};if(e&&3!==e.nodeType&&8!==e.nodeType){e[f.expando]?o=e[f.expando]:(o=f.count++,e[f.expando]=o,f.events[o]={}),r=r||e;var p=t.split(" ");for(a=p.length;a--;)l=m,u=s=!1,"DOMContentLoaded"===(c=p[a])&&(c="ready"),f.domLoaded&&"ready"===c&&"complete"===e.readyState?n.call(r,Ei({type:c})):(f.hasMouseEnterLeave||(u=f.mouseEnterLeave[c])&&(l=function(e){var t=e.currentTarget,n=e.relatedTarget;if(n&&t.contains)n=t.contains(n);else for(;n&&n!==t;)n=n.parentNode;n||((e=Ei(e||d.event)).type="mouseout"===e.type?"mouseleave":"mouseenter",e.target=t,f.executeHandlers(e,o))}),f.hasFocusIn||"focusin"!==c&&"focusout"!==c||(s=!0,u="focusin"===c?"focus":"blur",l=function(e){(e=Ei(e||d.event)).type="focus"===e.type?"focusin":"focusout",f.executeHandlers(e,o)}),(i=f.events[o][c])?"ready"===c&&f.domLoaded?n(Ei({type:c})):i.push({func:n,scope:r}):(f.events[o][c]=i=[{func:n,scope:r}],i.fakeName=u,i.capture=s,i.nativeHandler=l,"ready"===c?Ai(e,l,f):ki(e,u||c,l,s)));return e=i=null,n}},e.prototype.unbind=function(e,t,n){var r,o,i,a,c;if(!e||3===e.nodeType||8===e.nodeType)return this;var u=e[this.expando];if(u){if(c=this.events[u],t){var l=t.split(" ");for(o=l.length;o--;)if(r=c[a=l[o]]){if(n)for(i=r.length;i--;)if(r[i].func===n){var s=r.nativeHandler,f=r.fakeName,d=r.capture;(r=r.slice(0,i).concat(r.slice(i+1))).nativeHandler=s,r.fakeName=f,r.capture=d,c[a]=r}n&&0!==r.length||(delete c[a],Ti(e,r.fakeName||a,r.nativeHandler,r.capture))}}else me(c,(function(t,n){Ti(e,t.fakeName||n,t.nativeHandler,t.capture)})),c={};for(a in c)if(Ce(c,a))return this;delete this.events[u];try{delete e[this.expando]}catch(t){e[this.expando]=null}}return this},e.prototype.fire=function(e,t,n){var r;if(!e||3===e.nodeType||8===e.nodeType)return this;var o=Ei({type:t,target:e},n);do{(r=e[this.expando])&&this.executeHandlers(o,r),e=e.parentNode||e.ownerDocument||e.defaultView||e.parentWindow}while(e&&!o.isPropagationStopped());return this},e.prototype.clean=function(e){var t,n;if(!e||3===e.nodeType||8===e.nodeType)return this;if(e[this.expando]&&this.unbind(e),e.getElementsByTagName||(e=e.document),e&&e.getElementsByTagName)for(this.unbind(e),t=(n=e.getElementsByTagName("*")).length;t--;)(e=n[t])[this.expando]&&this.unbind(e);return this},e.prototype.destroy=function(){this.events={}},e.prototype.cancel=function(e){return e&&(e.preventDefault(),e.stopImmediatePropagation()),!1},e.prototype.executeHandlers=function(e,t){var n=this.events[t],r=n&&n[e.type];if(r)for(var o=0,i=r.length;o<i;o++){var a=r[o];if(a&&!1===a.func.call(a.scope,e)&&e.preventDefault(),e.isImmediatePropagationStopped())return}},e.Event=new e,e}(),Ni="sizzle"+-new Date,Ri=window.document,Di=0,Oi=0,Ii=sa(),Pi=sa(),Bi=sa(),Mi=function(e,t){return e===t&&(Rr=!0),0},Li={}.hasOwnProperty,Fi=[],ji=Fi.pop,Hi=Fi.push,Ui=Fi.push,zi=Fi.slice,Wi=Fi.indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(this[t]===e)return t;return-1},Vi="[\\x20\\t\\r\\n\\f]",qi="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",$i="\\["+Vi+"*("+qi+")(?:"+Vi+"*([*^$|!~]?=)"+Vi+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+qi+"))|)"+Vi+"*\\]",Ki=":("+qi+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+$i+")*)|.*)\\)|)",Gi=new RegExp("^"+Vi+"+|((?:^|[^\\\\])(?:\\\\.)*)"+Vi+"+$","g"),Ji=new RegExp("^"+Vi+"*,"+Vi+"*"),Xi=new RegExp("^"+Vi+"*([>+~]|"+Vi+")"+Vi+"*"),Yi=new RegExp("="+Vi+"*([^\\]'\"]*?)"+Vi+"*\\]","g"),Qi=new RegExp(Ki),Zi=new RegExp("^"+qi+"$"),ea={ID:new RegExp("^#("+qi+")"),CLASS:new RegExp("^\\.("+qi+")"),TAG:new RegExp("^("+qi+"|[*])"),ATTR:new RegExp("^"+$i),PSEUDO:new RegExp("^"+Ki),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+Vi+"*(even|odd|(([+-]|)(\\d*)n|)"+Vi+"*(?:([+-]|)"+Vi+"*(\\d+)|))"+Vi+"*\\)|)","i"),bool:new RegExp("^(?:checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)$","i"),needsContext:new RegExp("^"+Vi+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+Vi+"*((?:-\\d)?\\d*)"+Vi+"*\\)|)(?=[^-]|$)","i")},ta=/^(?:input|select|textarea|button)$/i,na=/^h\d$/i,ra=/^[^{]+\{\s*\[native \w/,oa=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ia=/[+~]/,aa=/'|\\/g,ca=new RegExp("\\\\([\\da-f]{1,6}"+Vi+"?|("+Vi+")|.)","ig"),ua=function(e,t,n){var r="0x"+t-65536;return r!=r||n?t:r<0?String.fromCharCode(r+65536):String.fromCharCode(r>>10|55296,1023&r|56320)};try{Ui.apply(Fi=zi.call(Ri.childNodes),Ri.childNodes),Fi[Ri.childNodes.length].nodeType}catch(e){Ui={apply:Fi.length?function(e,t){Hi.apply(e,zi.call(t))}:function(e,t){for(var n=e.length,r=0;e[n++]=t[r++];);e.length=n-1}}}var la=function(e,t,n,r){var o,i,a,c,u,l,s,f,d,m;if((t?t.ownerDocument||t:Ri)!==Or&&Dr(t),n=n||[],!e||"string"!=typeof e)return n;if(1!==(c=(t=t||Or).nodeType)&&9!==c)return[];if(Pr&&!r){if(o=oa.exec(e))if(a=o[1]){if(9===c){if(!(i=t.getElementById(a))||!i.parentNode)return n;if(i.id===a)return n.push(i),n}else if(t.ownerDocument&&(i=t.ownerDocument.getElementById(a))&&Lr(t,i)&&i.id===a)return n.push(i),n}else{if(o[2])return Ui.apply(n,t.getElementsByTagName(e)),n;if((a=o[3])&&Cr.getElementsByClassName)return Ui.apply(n,t.getElementsByClassName(a)),n}if(Cr.qsa&&(!Br||!Br.test(e))){if(f=s=Ni,d=t,m=9===c&&e,1===c&&"object"!==t.nodeName.toLowerCase()){for(l=Tr(e),(s=t.getAttribute("id"))?f=s.replace(aa,"\\$&"):t.setAttribute("id",f),f="[id='"+f+"'] ",u=l.length;u--;)l[u]=f+ha(l[u]);d=ia.test(e)&&pa(t.parentNode)||t,m=l.join(",")}if(m)try{return Ui.apply(n,d.querySelectorAll(m)),n}catch(e){}finally{s||t.removeAttribute("id")}}}return Ar(e.replace(Gi,"$1"),t,n,r)};function sa(){var e=[];return function t(n,r){return e.push(n+" ")>xr.cacheLength&&delete t[e.shift()],t[n+" "]=r}}function fa(e){return e[Ni]=!0,e}function da(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||1<<31)-(~e.sourceIndex||1<<31);if(r)return r;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function ma(e){return fa((function(t){return t=+t,fa((function(n,r){for(var o,i=e([],n.length,t),a=i.length;a--;)n[o=i[a]]&&(n[o]=!(r[o]=n[o]))}))}))}function pa(e){return e&&void 0!==e.getElementsByTagName&&e}function ga(){}function ha(e){for(var t=0,n=e.length,r="";t<n;t++)r+=e[t].value;return r}function va(e,t,n){var r=t.dir,o=n&&"parentNode"===r,i=Oi++;return t.first?function(t,n,i){for(;t=t[r];)if(1===t.nodeType||o)return e(t,n,i)}:function(t,n,a){var c,u,l=[Di,i];if(a){for(;t=t[r];)if((1===t.nodeType||o)&&e(t,n,a))return!0}else for(;t=t[r];)if(1===t.nodeType||o){if((c=(u=t[Ni]||(t[Ni]={}))[r])&&c[0]===Di&&c[1]===i)return l[2]=c[2];if(u[r]=l,l[2]=e(t,n,a))return!0}}}function ba(e){return e.length>1?function(t,n,r){for(var o=e.length;o--;)if(!e[o](t,n,r))return!1;return!0}:e[0]}function ya(e,t,n,r,o){for(var i,a=[],c=0,u=e.length,l=null!=t;c<u;c++)(i=e[c])&&(n&&!n(i,r,o)||(a.push(i),l&&t.push(c)));return a}function wa(e,t,n,r,o,i){return r&&!r[Ni]&&(r=wa(r)),o&&!o[Ni]&&(o=wa(o,i)),fa((function(i,a,c,u){var l,s,f,d=[],m=[],p=a.length,g=i||function(e,t,n){for(var r=0,o=t.length;r<o;r++)la(e,t[r],n);return n}(t||"*",c.nodeType?[c]:c,[]),h=!e||!i&&t?g:ya(g,d,e,c,u),v=n?o||(i?e:p||r)?[]:a:h;if(n&&n(h,v,c,u),r)for(l=ya(v,m),r(l,[],c,u),s=l.length;s--;)(f=l[s])&&(v[m[s]]=!(h[m[s]]=f));if(i){if(o||e){if(o){for(l=[],s=v.length;s--;)(f=v[s])&&l.push(h[s]=f);o(null,v=[],l,u)}for(s=v.length;s--;)(f=v[s])&&(l=o?Wi.call(i,f):d[s])>-1&&(i[l]=!(a[l]=f))}}else v=ya(v===a?v.splice(p,v.length):v),o?o(null,a,v,u):Ui.apply(a,v)}))}function Ca(e){for(var t,n,r,o=e.length,i=xr.relative[e[0].type],a=i||xr.relative[" "],c=i?1:0,u=va((function(e){return e===t}),a,!0),l=va((function(e){return Wi.call(t,e)>-1}),a,!0),s=[function(e,n,r){var o=!i&&(r||n!==_r)||((t=n).nodeType?u(e,n,r):l(e,n,r));return t=null,o}];c<o;c++)if(n=xr.relative[e[c].type])s=[va(ba(s),n)];else{if((n=xr.filter[e[c].type].apply(null,e[c].matches))[Ni]){for(r=++c;r<o&&!xr.relative[e[r].type];r++);return wa(c>1&&ba(s),c>1&&ha(e.slice(0,c-1).concat({value:" "===e[c-2].type?"*":""})).replace(Gi,"$1"),n,c<r&&Ca(e.slice(c,r)),r<o&&Ca(e=e.slice(r)),r<o&&ha(e))}s.push(n)}return ba(s)}Cr=la.support={},kr=la.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return!!t&&"HTML"!==t.nodeName},Dr=la.setDocument=function(e){var t,n=e?e.ownerDocument||e:Ri,r=n.defaultView;return n!==Or&&9===n.nodeType&&n.documentElement?(Or=n,Ir=n.documentElement,Pr=!kr(n),r&&r!==function(e){try{return e.top}catch(e){}return null}(r)&&(r.addEventListener?r.addEventListener("unload",(function(){Dr()}),!1):r.attachEvent&&r.attachEvent("onunload",(function(){Dr()}))),Cr.attributes=!0,Cr.getElementsByTagName=!0,Cr.getElementsByClassName=ra.test(n.getElementsByClassName),Cr.getById=!0,xr.find.ID=function(e,t){if(void 0!==t.getElementById&&Pr){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},xr.filter.ID=function(e){var t=e.replace(ca,ua);return function(e){return e.getAttribute("id")===t}},xr.find.TAG=Cr.getElementsByTagName?function(e,t){if(void 0!==t.getElementsByTagName)return t.getElementsByTagName(e)}:function(e,t){var n,r=[],o=0,i=t.getElementsByTagName(e);if("*"===e){for(;n=i[o++];)1===n.nodeType&&r.push(n);return r}return i},xr.find.CLASS=Cr.getElementsByClassName&&function(e,t){if(Pr)return t.getElementsByClassName(e)},Mr=[],Br=[],Cr.disconnectedMatch=!0,Br=Br.length&&new RegExp(Br.join("|")),Mr=Mr.length&&new RegExp(Mr.join("|")),t=ra.test(Ir.compareDocumentPosition),Lr=t||ra.test(Ir.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},Mi=t?function(e,t){if(e===t)return Rr=!0,0;var r=!e.compareDocumentPosition-!t.compareDocumentPosition;return r||(1&(r=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!Cr.sortDetached&&t.compareDocumentPosition(e)===r?e===n||e.ownerDocument===Ri&&Lr(Ri,e)?-1:t===n||t.ownerDocument===Ri&&Lr(Ri,t)?1:Nr?Wi.call(Nr,e)-Wi.call(Nr,t):0:4&r?-1:1)}:function(e,t){if(e===t)return Rr=!0,0;var r,o=0,i=e.parentNode,a=t.parentNode,c=[e],u=[t];if(!i||!a)return e===n?-1:t===n?1:i?-1:a?1:Nr?Wi.call(Nr,e)-Wi.call(Nr,t):0;if(i===a)return da(e,t);for(r=e;r=r.parentNode;)c.unshift(r);for(r=t;r=r.parentNode;)u.unshift(r);for(;c[o]===u[o];)o++;return o?da(c[o],u[o]):c[o]===Ri?-1:u[o]===Ri?1:0},n):Or},la.matches=function(e,t){return la(e,null,null,t)},la.matchesSelector=function(e,t){if((e.ownerDocument||e)!==Or&&Dr(e),t=t.replace(Yi,"='$1']"),Cr.matchesSelector&&Pr&&(!Mr||!Mr.test(t))&&(!Br||!Br.test(t)))try{var n=(void 0).call(e,t);if(n||Cr.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(e){}return la(t,Or,null,[e]).length>0},la.contains=function(e,t){return(e.ownerDocument||e)!==Or&&Dr(e),Lr(e,t)},la.attr=function(e,t){(e.ownerDocument||e)!==Or&&Dr(e);var n=xr.attrHandle[t.toLowerCase()],r=n&&Li.call(xr.attrHandle,t.toLowerCase())?n(e,t,!Pr):void 0;return void 0!==r?r:Cr.attributes||!Pr?e.getAttribute(t):(r=e.getAttributeNode(t))&&r.specified?r.value:null},la.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},la.uniqueSort=function(e){var t,n=[],r=0,o=0;if(Rr=!Cr.detectDuplicates,Nr=!Cr.sortStable&&e.slice(0),e.sort(Mi),Rr){for(;t=e[o++];)t===e[o]&&(r=n.push(o));for(;r--;)e.splice(n[r],1)}return Nr=null,e},Sr=la.getText=function(e){var t,n="",r=0,o=e.nodeType;if(o){if(1===o||9===o||11===o){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=Sr(e)}else if(3===o||4===o)return e.nodeValue}else for(;t=e[r++];)n+=Sr(t);return n},(xr=la.selectors={cacheLength:50,createPseudo:fa,match:ea,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(ca,ua),e[3]=(e[3]||e[4]||e[5]||"").replace(ca,ua),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||la.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&la.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return ea.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&Qi.test(n)&&(t=Tr(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(ca,ua).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=Ii[e+" "];return t||(t=new RegExp("(^|"+Vi+")"+e+"("+Vi+"|$)"))&&Ii(e,(function(e){return t.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")}))},ATTR:function(e,t,n){return function(r){var o=la.attr(r,e);return null==o?"!="===t:!t||(o+="","="===t?o===n:"!="===t?o!==n:"^="===t?n&&0===o.indexOf(n):"*="===t?n&&o.indexOf(n)>-1:"$="===t?n&&o.slice(-n.length)===n:"~="===t?(" "+o+" ").indexOf(n)>-1:"|="===t&&(o===n||o.slice(0,n.length+1)===n+"-"))}},CHILD:function(e,t,n,r,o){var i="nth"!==e.slice(0,3),a="last"!==e.slice(-4),c="of-type"===t;return 1===r&&0===o?function(e){return!!e.parentNode}:function(t,n,u){var l,s,f,d,m,p,g=i!==a?"nextSibling":"previousSibling",h=t.parentNode,v=c&&t.nodeName.toLowerCase(),b=!u&&!c;if(h){if(i){for(;g;){for(f=t;f=f[g];)if(c?f.nodeName.toLowerCase()===v:1===f.nodeType)return!1;p=g="only"===e&&!p&&"nextSibling"}return!0}if(p=[a?h.firstChild:h.lastChild],a&&b){for(m=(l=(s=h[Ni]||(h[Ni]={}))[e]||[])[0]===Di&&l[1],d=l[0]===Di&&l[2],f=m&&h.childNodes[m];f=++m&&f&&f[g]||(d=m=0)||p.pop();)if(1===f.nodeType&&++d&&f===t){s[e]=[Di,m,d];break}}else if(b&&(l=(t[Ni]||(t[Ni]={}))[e])&&l[0]===Di)d=l[1];else for(;(f=++m&&f&&f[g]||(d=m=0)||p.pop())&&((c?f.nodeName.toLowerCase()!==v:1!==f.nodeType)||!++d||(b&&((f[Ni]||(f[Ni]={}))[e]=[Di,d]),f!==t)););return(d-=o)===r||d%r==0&&d/r>=0}}},PSEUDO:function(e,t){var n,r=xr.pseudos[e]||xr.setFilters[e.toLowerCase()]||la.error("unsupported pseudo: "+e);return r[Ni]?r(t):r.length>1?(n=[e,e,"",t],xr.setFilters.hasOwnProperty(e.toLowerCase())?fa((function(e,n){for(var o,i=r(e,t),a=i.length;a--;)e[o=Wi.call(e,i[a])]=!(n[o]=i[a])})):function(e){return r(e,0,n)}):r}},pseudos:{not:fa((function(e){var t=[],n=[],r=Er(e.replace(Gi,"$1"));return r[Ni]?fa((function(e,t,n,o){for(var i,a=r(e,null,o,[]),c=e.length;c--;)(i=a[c])&&(e[c]=!(t[c]=i))})):function(e,o,i){return t[0]=e,r(t,null,i,n),t[0]=null,!n.pop()}})),has:fa((function(e){return function(t){return la(e,t).length>0}})),contains:fa((function(e){return e=e.replace(ca,ua),function(t){return(t.textContent||t.innerText||Sr(t)).indexOf(e)>-1}})),lang:fa((function(e){return Zi.test(e||"")||la.error("unsupported lang: "+e),e=e.replace(ca,ua).toLowerCase(),function(t){var n;do{if(n=Pr?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(n=n.toLowerCase())===e||0===n.indexOf(e+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}})),target:function(e){var t=window.location&&window.location.hash;return t&&t.slice(1)===e.id},root:function(e){return e===Ir},focus:function(e){return e===Or.activeElement&&(!Or.hasFocus||Or.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return!1===e.disabled},disabled:function(e){return!0===e.disabled},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!xr.pseudos.empty(e)},header:function(e){return na.test(e.nodeName)},input:function(e){return ta.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:ma((function(){return[0]})),last:ma((function(e,t){return[t-1]})),eq:ma((function(e,t,n){return[n<0?n+t:n]})),even:ma((function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e})),odd:ma((function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e})),lt:ma((function(e,t,n){for(var r=n<0?n+t:n;--r>=0;)e.push(r);return e})),gt:ma((function(e,t,n){for(var r=n<0?n+t:n;++r<t;)e.push(r);return e}))}}).pseudos.nth=xr.pseudos.eq,$(["radio","checkbox","file","password","image"],(function(e){xr.pseudos[e]=function(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e}}(e)})),$(["submit","reset"],(function(e){xr.pseudos[e]=function(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}(e)})),ga.prototype=xr.filters=xr.pseudos,xr.setFilters=new ga,Tr=la.tokenize=function(e,t){var n,r,o,i,a,c,u,l=Pi[e+" "];if(l)return t?0:l.slice(0);for(a=e,c=[],u=xr.preFilter;a;){for(i in n&&!(r=Ji.exec(a))||(r&&(a=a.slice(r[0].length)||a),c.push(o=[])),n=!1,(r=Xi.exec(a))&&(n=r.shift(),o.push({value:n,type:r[0].replace(Gi," ")}),a=a.slice(n.length)),xr.filter)xr.filter.hasOwnProperty(i)&&(!(r=ea[i].exec(a))||u[i]&&!(r=u[i](r))||(n=r.shift(),o.push({value:n,type:i,matches:r}),a=a.slice(n.length)));if(!n)break}return t?a.length:a?la.error(e):Pi(e,c).slice(0)},Er=la.compile=function(e,t){var n,r=[],o=[],i=Bi[e+" "];if(!i){for(t||(t=Tr(e)),n=t.length;n--;)(i=Ca(t[n]))[Ni]?r.push(i):o.push(i);(i=Bi(e,function(e,t){var n=t.length>0,r=e.length>0,o=function(o,i,a,c,u){var l,s,f,d=0,m="0",p=o&&[],g=[],h=_r,v=o||r&&xr.find.TAG("*",u),b=Di+=null==h?1:Math.random()||.1,y=v.length;for(u&&(_r=i!==Or&&i);m!==y&&null!=(l=v[m]);m++){if(r&&l){for(s=0;f=e[s++];)if(f(l,i,a)){c.push(l);break}u&&(Di=b)}n&&((l=!f&&l)&&d--,o&&p.push(l))}if(d+=m,n&&m!==d){for(s=0;f=t[s++];)f(p,g,i,a);if(o){if(d>0)for(;m--;)p[m]||g[m]||(g[m]=ji.call(c));g=ya(g)}Ui.apply(c,g),u&&!o&&g.length>0&&d+t.length>1&&la.uniqueSort(c)}return u&&(Di=b,_r=h),p};return n?fa(o):o}(o,r))).selector=e}return i},Ar=la.select=function(e,t,n,r){var o,i,a,c,u,l="function"==typeof e&&e,s=!r&&Tr(e=l.selector||e);if(n=n||[],1===s.length){if((i=s[0]=s[0].slice(0)).length>2&&"ID"===(a=i[0]).type&&Cr.getById&&9===t.nodeType&&Pr&&xr.relative[i[1].type]){if(!(t=(xr.find.ID(a.matches[0].replace(ca,ua),t)||[])[0]))return n;l&&(t=t.parentNode),e=e.slice(i.shift().value.length)}for(o=ea.needsContext.test(e)?0:i.length;o--&&(a=i[o],!xr.relative[c=a.type]);)if((u=xr.find[c])&&(r=u(a.matches[0].replace(ca,ua),ia.test(i[0].type)&&pa(t.parentNode)||t))){if(i.splice(o,1),!(e=r.length&&ha(i)))return Ui.apply(n,r),n;break}}return(l||Er(e,s))(r,t,!Pr,n,ia.test(e)&&pa(t.parentNode)||t),n},Cr.sortStable=Ni.split("").sort(Mi).join("")===Ni,Cr.detectDuplicates=!!Rr,Dr(),Cr.sortDetached=!0;var xa=document,Sa=Array.prototype.push,ka=Array.prototype.slice,Ta=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,Ea=_i.Event,Aa=bt.makeMap("children,contents,next,prev"),_a=function(e){return void 0!==e},Na=function(e){return"string"==typeof e},Ra=function(e,t){var n,r=(t=t||xa).createElement("div"),o=t.createDocumentFragment();for(r.innerHTML=e;n=r.firstChild;)o.appendChild(n);return o},Da=function(e,t,n,r){var o;if(Na(t))t=Ra(t,qa(e[0]));else if(t.length&&!t.nodeType){if(t=Ja.makeArray(t),r)for(o=t.length-1;o>=0;o--)Da(e,t[o],n,r);else for(o=0;o<t.length;o++)Da(e,t[o],n,r);return e}if(t.nodeType)for(o=e.length;o--;)n.call(e[o],t);return e},Oa=function(e,t){return e&&t&&-1!==(" "+e.className+" ").indexOf(" "+t+" ")},Ia=function(e,t,n){var r,o;return t=Ja(t)[0],e.each((function(){n&&r===this.parentNode||(r=this.parentNode,o=t.cloneNode(!1),this.parentNode.insertBefore(o,this)),o.appendChild(this)})),e},Pa=bt.makeMap("fillOpacity fontWeight lineHeight opacity orphans widows zIndex zoom"," "),Ba=bt.makeMap("checked compact declare defer disabled ismap multiple nohref noshade nowrap readonly selected"," "),Ma={for:"htmlFor",class:"className",readonly:"readOnly"},La={float:"cssFloat"},Fa={},ja={},Ha=function(e,t){return new Ja.fn.init(e,t)},Ua=/^\s*|\s*$/g,za=function(e){return null==e?"":(""+e).replace(Ua,"")},Wa=function(e,t){var n,r,o,i;if(e)if(void 0===(n=e.length)){for(r in e)if(e.hasOwnProperty(r)&&(i=e[r],!1===t.call(i,r,i)))break}else for(o=0;o<n&&(i=e[o],!1!==t.call(i,o,i));o++);return e},Va=function(e,t){var n=[];return Wa(e,(function(e,r){t(r,e)&&n.push(r)})),n},qa=function(e){return e?9===e.nodeType?e:e.ownerDocument:xa};Ha.fn=Ha.prototype={constructor:Ha,selector:"",context:null,length:0,init:function(e,t){var n,r;if(!e)return this;if(e.nodeType)return this.context=this[0]=e,this.length=1,this;if(t&&t.nodeType)this.context=t;else{if(t)return Ja(e).attr(t);this.context=t=document}if(Na(e)){if(this.selector=e,!(n="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:Ta.exec(e)))return Ja(t).find(e);if(n[1])for(r=Ra(e,qa(t)).firstChild;r;)Sa.call(this,r),r=r.nextSibling;else{if(!(r=qa(t).getElementById(n[2])))return this;if(r.id!==n[2])return this.find(e);this.length=1,this[0]=r}}else this.add(e,!1);return this},toArray:function(){return bt.toArray(this)},add:function(e,t){var n,r;if(Na(e))return this.add(Ja(e));if(!1!==t)for(n=Ja.unique(this.toArray().concat(Ja.makeArray(e))),this.length=n.length,r=0;r<n.length;r++)this[r]=n[r];else Sa.apply(this,Ja.makeArray(e));return this},attr:function(e,t){var n,r=this;if("object"==typeof e)Wa(e,(function(e,t){r.attr(e,t)}));else{if(!_a(t)){if(r[0]&&1===r[0].nodeType){if((n=Fa[e])&&n.get)return n.get(r[0],e);if(Ba[e])return r.prop(e)?e:void 0;null===(t=r[0].getAttribute(e,2))&&(t=void 0)}return t}this.each((function(){var n;if(1===this.nodeType){if((n=Fa[e])&&n.set)return void n.set(this,t);null===t?this.removeAttribute(e,2):this.setAttribute(e,t,2)}}))}return r},removeAttr:function(e){return this.attr(e,null)},prop:function(e,t){var n=this;if("object"==typeof(e=Ma[e]||e))Wa(e,(function(e,t){n.prop(e,t)}));else{if(!_a(t))return n[0]&&n[0].nodeType&&e in n[0]?n[0][e]:t;this.each((function(){1===this.nodeType&&(this[e]=t)}))}return n},css:function(e,t){var n,r,o=this,i=function(e){return e.replace(/-(\D)/g,(function(e,t){return t.toUpperCase()}))},a=function(e){return e.replace(/[A-Z]/g,(function(e){return"-"+e}))};if("object"==typeof e)Wa(e,(function(e,t){o.css(e,t)}));else if(_a(t))e=i(e),"number"!=typeof t||Pa[e]||(t=t.toString()+"px"),o.each((function(){var n=this.style;if((r=ja[e])&&r.set)r.set(this,t);else{try{this.style[La[e]||e]=t}catch(e){}null!==t&&""!==t||(n.removeProperty?n.removeProperty(a(e)):n.removeAttribute(e))}}));else{if(n=o[0],(r=ja[e])&&r.get)return r.get(n);if(!n.ownerDocument.defaultView)return n.currentStyle?n.currentStyle[i(e)]:"";try{return n.ownerDocument.defaultView.getComputedStyle(n,null).getPropertyValue(a(e))}catch(e){return}}return o},remove:function(){for(var e,t=this.length;t--;)e=this[t],Ea.clean(e),e.parentNode&&e.parentNode.removeChild(e);return this},empty:function(){for(var e,t=this.length;t--;)for(e=this[t];e.firstChild;)e.removeChild(e.firstChild);return this},html:function(e){var t;if(_a(e)){t=this.length;try{for(;t--;)this[t].innerHTML=e}catch(n){Ja(this[t]).empty().append(e)}return this}return this[0]?this[0].innerHTML:""},text:function(e){var t;if(_a(e)){for(t=this.length;t--;)"innerText"in this[t]?this[t].innerText=e:this[0].textContent=e;return this}return this[0]?this[0].innerText||this[0].textContent:""},append:function(){return Da(this,arguments,(function(e){(1===this.nodeType||this.host&&1===this.host.nodeType)&&this.appendChild(e)}))},prepend:function(){return Da(this,arguments,(function(e){(1===this.nodeType||this.host&&1===this.host.nodeType)&&this.insertBefore(e,this.firstChild)}),!0)},before:function(){var e=this;return e[0]&&e[0].parentNode?Da(e,arguments,(function(e){this.parentNode.insertBefore(e,this)})):e},after:function(){var e=this;return e[0]&&e[0].parentNode?Da(e,arguments,(function(e){this.parentNode.insertBefore(e,this.nextSibling)}),!0):e},appendTo:function(e){return Ja(e).append(this),this},prependTo:function(e){return Ja(e).prepend(this),this},replaceWith:function(e){return this.before(e).remove()},wrap:function(e){return Ia(this,e)},wrapAll:function(e){return Ia(this,e,!0)},wrapInner:function(e){return this.each((function(){Ja(this).contents().wrapAll(e)})),this},unwrap:function(){return this.parent().each((function(){Ja(this).replaceWith(this.childNodes)}))},clone:function(){var e=[];return this.each((function(){e.push(this.cloneNode(!0))})),Ja(e)},addClass:function(e){return this.toggleClass(e,!0)},removeClass:function(e){return this.toggleClass(e,!1)},toggleClass:function(e,t){var n=this;return"string"!=typeof e||(-1!==e.indexOf(" ")?Wa(e.split(" "),(function(){n.toggleClass(this,t)})):n.each((function(n,r){var o=Oa(r,e);if(o!==t){var i=r.className;o?r.className=za((" "+i+" ").replace(" "+e+" "," ")):r.className+=i?" "+e:e}}))),n},hasClass:function(e){return Oa(this[0],e)},each:function(e){return Wa(this,e)},on:function(e,t){return this.each((function(){Ea.bind(this,e,t)}))},off:function(e,t){return this.each((function(){Ea.unbind(this,e,t)}))},trigger:function(e){return this.each((function(){"object"==typeof e?Ea.fire(this,e.type,e):Ea.fire(this,e)}))},show:function(){return this.css("display","")},hide:function(){return this.css("display","none")},slice:function(){return Ja(ka.apply(this,arguments))},eq:function(e){return-1===e?this.slice(e):this.slice(e,+e+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},find:function(e){var t,n,r=[];for(t=0,n=this.length;t<n;t++)Ja.find(e,this[t],r);return Ja(r)},filter:function(e){return Ja("function"==typeof e?Va(this.toArray(),(function(t,n){return e(n,t)})):Ja.filter(e,this.toArray()))},closest:function(e){var t=[];return e instanceof Ja&&(e=e[0]),this.each((function(n,r){for(;r;){if("string"==typeof e&&Ja(r).is(e)){t.push(r);break}if(r===e){t.push(r);break}r=r.parentNode}})),Ja(t)},offset:function(e){var t,n,r,o,i=0,a=0;return e?this.css(e):((t=this[0])&&(r=(n=t.ownerDocument).documentElement,t.getBoundingClientRect&&(i=(o=t.getBoundingClientRect()).left+(r.scrollLeft||n.body.scrollLeft)-r.clientLeft,a=o.top+(r.scrollTop||n.body.scrollTop)-r.clientTop)),{left:i,top:a})},push:Sa,sort:Array.prototype.sort,splice:Array.prototype.splice},bt.extend(Ha,{extend:bt.extend,makeArray:function(e){return(t=e)&&t===t.window||e.nodeType?[e]:bt.toArray(e);var t},inArray:function(e,t){var n;if(t.indexOf)return t.indexOf(e);for(n=t.length;n--;)if(t[n]===e)return n;return-1},isArray:bt.isArray,each:Wa,trim:za,grep:Va,find:la,expr:la.selectors,unique:la.uniqueSort,text:la.getText,contains:la.contains,filter:function(e,t,n){var r=t.length;for(n&&(e=":not("+e+")");r--;)1!==t[r].nodeType&&t.splice(r,1);return t=1===t.length?Ja.find.matchesSelector(t[0],e)?[t[0]]:[]:Ja.find.matches(e,t)}});var $a=function(e,t,n){var r=[],o=e[t];for("string"!=typeof n&&n instanceof Ja&&(n=n[0]);o&&9!==o.nodeType;){if(void 0!==n){if(o===n)break;if("string"==typeof n&&Ja(o).is(n))break}1===o.nodeType&&r.push(o),o=o[t]}return r},Ka=function(e,t,n,r){var o=[];for(r instanceof Ja&&(r=r[0]);e;e=e[t])if(!n||e.nodeType===n){if(void 0!==r){if(e===r)break;if("string"==typeof r&&Ja(e).is(r))break}o.push(e)}return o},Ga=function(e,t,n){for(e=e[t];e;e=e[t])if(e.nodeType===n)return e;return null};Wa({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return $a(e,"parentNode")},next:function(e){return Ga(e,"nextSibling",1)},prev:function(e){return Ga(e,"previousSibling",1)},children:function(e){return Ka(e.firstChild,"nextSibling",1)},contents:function(e){return bt.toArray(("iframe"===e.nodeName?e.contentDocument||e.contentWindow.document:e).childNodes)}},(function(e,t){Ha.fn[e]=function(n){var r=[];this.each((function(){var e=t.call(r,this,n,r);e&&(Ja.isArray(e)?r.push.apply(r,e):r.push(e))})),this.length>1&&(Aa[e]||(r=Ja.unique(r)),0===e.indexOf("parents")&&(r=r.reverse()));var o=Ja(r);return n?o.filter(n):o}})),Wa({parentsUntil:function(e,t){return $a(e,"parentNode",t)},nextUntil:function(e,t){return Ka(e,"nextSibling",1,t).slice(1)},prevUntil:function(e,t){return Ka(e,"previousSibling",1,t).slice(1)}},(function(e,t){Ha.fn[e]=function(n,r){var o=[];this.each((function(){var e=t.call(o,this,n,o);e&&(Ja.isArray(e)?o.push.apply(o,e):o.push(e))})),this.length>1&&(o=Ja.unique(o),0!==e.indexOf("parents")&&"prevUntil"!==e||(o=o.reverse()));var i=Ja(o);return r?i.filter(r):i}})),Ha.fn.is=function(e){return!!e&&this.filter(e).length>0},Ha.fn.init.prototype=Ha.fn,Ha.overrideDefaults=function(e){var t,n=function(r,o){return t=t||e(),0===arguments.length&&(r=t.element),o||(o=t.context),new n.fn.init(r,o)};return Ja.extend(n,this),n},Ha.attrHooks=Fa,Ha.cssHooks=ja;var Ja=Ha,Xa=bt.each,Ya=bt.grep,Qa=mt.ie,Za=/^([a-z0-9],?)+$/i,ec=function(e,t){var n=t.attr("style"),r=e.serialize(e.parse(n),t[0].nodeName);r||(r=null),t.attr("data-mce-style",r)},tc=function(e,t){var n,r,o=0;if(e)for(n=e.nodeType,e=e.previousSibling;e;e=e.previousSibling)r=e.nodeType,(!t||3!==r||r!==n&&e.nodeValue.length)&&(o++,n=r);return o},nc=function(e,t){void 0===t&&(t={});var n={},r=window,o={},i=0,a=Xr.forElement(wt.fromDom(e),{contentCssCors:t.contentCssCors,referrerPolicy:t.referrerPolicy}),c=[],u=t.schema?t.schema:vi({}),l=yi({url_converter:t.url_converter,url_converter_scope:t.url_converter_scope},t.schema),s=t.ownEvents?new _i:_i.Event,f=u.getBlockElements(),d=Ja.overrideDefaults((function(){return{context:e,element:W.getRoot()}})),p=function(t){return t&&e&&m(t)?e.getElementById(t):t},g=function(e){return d("string"==typeof e?p(e):e)},h=function(e,t,n){var r,o,i=g(e);return i.length&&(o=(r=V[t])&&r.get?r.get(i,t):i.attr(t)),void 0===o&&(o=n||""),o},v=function(e){var t=p(e);return t?t.attributes:[]},b=function(e,n,r){""===r&&(r=null);var o=g(e),i=o.attr(n);if(o.length){var a=V[n];a&&a.set?a.set(o,r,n):o.attr(n,r),i!==r&&t.onSetAttrib&&t.onSetAttrib({attrElm:o,attrName:n,attrValue:r})}},w=function(){return t.root_element||e.body},C=function(t,n){return nr(e.body,p(t),n)},x=function(e,t,n){var r=g(e);return n?r.css(t):("float"===(t=t.replace(/-(\D)/g,(function(e,t){return t.toUpperCase()})))&&(t=mt.browser.isIE()?"styleFloat":"cssFloat"),r[0]&&r[0].style?r[0].style[t]:void 0)},k=function(e){var t,n;return e=p(e),t=x(e,"width"),n=x(e,"height"),-1===t.indexOf("px")&&(t=0),-1===n.indexOf("px")&&(n=0),{w:parseInt(t,10)||e.offsetWidth||e.clientWidth,h:parseInt(n,10)||e.offsetHeight||e.clientHeight}},T=function(e,t){var n;if(!e)return!1;if(!Array.isArray(e)){if("*"===t)return 1===e.nodeType;if(Za.test(t)){var r=t.toLowerCase().split(/,/),o=e.nodeName.toLowerCase();for(n=r.length-1;n>=0;n--)if(r[n]===o)return!0;return!1}if(e.nodeType&&1!==e.nodeType)return!1}var i=Array.isArray(e)?e:[e];return la(t,i[0].ownerDocument||i[0],null,i).length>0},A=function(e,t,n,r){var o,i=[],a=p(e);for(r=void 0===r,n=n||("BODY"!==w().nodeName?w().parentNode:null),bt.is(t,"string")&&(o=t,t="*"===t?function(e){return 1===e.nodeType}:function(e){return T(e,o)});a&&!(a===n||y(a.nodeType)||Dn(a)||On(a));){if(!t||"function"==typeof t&&t(a)){if(!r)return[a];i.push(a)}a=a.parentNode}return r?i:null},_=function(e,t,n){var r=t;if(e)for("string"==typeof t&&(r=function(e){return T(e,t)}),e=e[n];e;e=e[n])if("function"==typeof r&&r(e))return e;return null},N=function(e,t,n){var r,o="string"==typeof e?p(e):e;if(!o)return!1;if(bt.isArray(o)&&(o.length||0===o.length))return r=[],Xa(o,(function(e,o){e&&r.push(t.call(n,"string"==typeof e?p(e):e,o))})),r;var i=n||this;return t.call(i,o)},R=function(e,t){g(e).each((function(e,n){Xa(t,(function(e,t){b(n,t,e)}))}))},D=function(e,t){var n=g(e);Qa?n.each((function(e,n){if(!1!==n.canHaveHTML){for(;n.firstChild;)n.removeChild(n.firstChild);try{n.innerHTML="<br>"+t,n.removeChild(n.firstChild)}catch(e){Ja("<div></div>").html("<br>"+t).contents().slice(1).appendTo(n)}return t}})):n.html(t)},O=function(t,n,r,o,i){return N(t,(function(t){var a="string"==typeof n?e.createElement(n):n;return R(a,r),o&&("string"!=typeof o&&o.nodeType?a.appendChild(o):"string"==typeof o&&D(a,o)),i?a:t.appendChild(a)}))},I=function(t,n,r){return O(e.createElement(t),t,n,r,!0)},P=ci.encodeAllRaw,B=function(e,t){var n=g(e);return t?n.each((function(){for(var e;e=this.firstChild;)3===e.nodeType&&0===e.data.length?this.removeChild(e):this.parentNode.insertBefore(e,this)})).remove():n.remove(),n.length>1?n.toArray():n[0]},M=function(e,t,n){g(e).toggleClass(t,n).each((function(){""===this.className&&Ja(this).attr("class",null)}))},L=function(e,t,n){return N(t,(function(t){return bt.is(t,"array")&&(e=e.cloneNode(!0)),n&&Xa(Ya(t.childNodes),(function(t){e.appendChild(t)})),t.parentNode.replaceChild(e,t)}))},F=function(e){if(Cn(e)){var t="a"===e.nodeName.toLowerCase()&&!h(e,"href")&&h(e,"id");if(h(e,"name")||h(e,"data-mce-bookmark")||t)return!0}return!1},j=function(){return e.createRange()},H=function(n,o,i,a){if(bt.isArray(n)){for(var u=n.length,l=[];u--;)l[u]=H(n[u],o,i,a);return l}return!t.collect||n!==e&&n!==r||c.push([n,o,i,a]),s.bind(n,o,i,a||W)},U=function(t,n,o){if(bt.isArray(t)){for(var i=t.length,a=[];i--;)a[i]=U(t[i],n,o);return a}if(c.length>0&&(t===e||t===r))for(i=c.length;i--;){var u=c[i];t!==u[0]||n&&n!==u[1]||o&&o!==u[2]||s.unbind(u[0],u[1],u[2])}return s.unbind(t,n,o)},z=function(e){if(e&&Cn(e)){var t=e.getAttribute("data-mce-contenteditable");return t&&"inherit"!==t?t:"inherit"!==e.contentEditable?e.contentEditable:null}return null},W={doc:e,settings:t,win:r,files:o,stdMode:!0,boxModel:!0,styleSheetLoader:a,boundEvents:c,styles:l,schema:u,events:s,isBlock:function(e){if("string"==typeof e)return!!f[e];if(e){var t=e.nodeType;if(t)return!(1!==t||!f[e.nodeName])}return!1},$:d,$$:g,root:null,clone:function(t,n){if(!Qa||1!==t.nodeType||n)return t.cloneNode(n);var r=e.createElement(t.nodeName);return Xa(v(t),(function(e){b(r,e.nodeName,h(t,e.nodeName))})),r},getRoot:w,getViewPort:function(e){var t=bn(e);return{x:t.x,y:t.y,w:t.width,h:t.height}},getRect:function(e){e=p(e);var t=C(e),n=k(e);return{x:t.x,y:t.y,w:n.w,h:n.h}},getSize:k,getParent:function(e,t,n){var r=A(e,t,n,!1);return r&&r.length>0?r[0]:null},getParents:A,get:p,getNext:function(e,t){return _(e,t,"nextSibling")},getPrev:function(e,t){return _(e,t,"previousSibling")},select:function(n,r){return la(n,p(r)||t.root_element||e,[])},is:T,add:O,create:I,createHTML:function(e,t,n){var r,o="";for(r in o+="<"+e,t)xe(t,r)&&(o+=" "+r+'="'+P(t[r])+'"');return void 0!==n?o+">"+n+"</"+e+">":o+" />"},createFragment:function(t){var n,r=e.createElement("div"),o=e.createDocumentFragment();for(o.appendChild(r),t&&(r.innerHTML=t);n=r.firstChild;)o.appendChild(n);return o.removeChild(r),o},remove:B,setStyle:function(e,n,r){var o=m(n)?g(e).css(n,r):g(e).css(n);t.update_styles&&ec(l,o)},getStyle:x,setStyles:function(e,n){var r=g(e).css(n);t.update_styles&&ec(l,r)},removeAllAttribs:function(e){return N(e,(function(e){var t,n=e.attributes;for(t=n.length-1;t>=0;t--)e.removeAttributeNode(n.item(t))}))},setAttrib:b,setAttribs:R,getAttrib:h,getPos:C,parseStyle:function(e){return l.parse(e)},serializeStyle:function(e,t){return l.serialize(e,t)},addStyle:function(t){var r,o;if(W!==nc.DOM&&e===document){if(n[t])return;n[t]=!0}(o=e.getElementById("mceDefaultStyles"))||((o=e.createElement("style")).id="mceDefaultStyles",o.type="text/css",(r=e.getElementsByTagName("head")[0]).firstChild?r.insertBefore(o,r.firstChild):r.appendChild(o)),o.styleSheet?o.styleSheet.cssText+=t:o.appendChild(e.createTextNode(t))},loadCSS:function(e){e||(e=""),$(e.split(","),(function(e){o[e]=!0,a.load(e,S)}))},addClass:function(e,t){g(e).addClass(t)},removeClass:function(e,t){M(e,t,!1)},hasClass:function(e,t){return g(e).hasClass(t)},toggleClass:M,show:function(e){g(e).show()},hide:function(e){g(e).hide()},isHidden:function(e){return"none"===g(e).css("display")},uniqueId:function(e){return(e||"mce_")+i++},setHTML:D,getOuterHTML:function(e){var t="string"==typeof e?p(e):e;return Cn(t)?t.outerHTML:Ja("<div></div>").append(Ja(t).clone()).html()},setOuterHTML:function(e,t){g(e).each((function(){try{if("outerHTML"in this)return void(this.outerHTML=t)}catch(e){}B(Ja(this).html(t),!0)}))},decode:ci.decode,encode:P,insertAfter:function(e,t){var n=p(t);return N(e,(function(e){var t=n.parentNode,r=n.nextSibling;return r?t.insertBefore(e,r):t.appendChild(e),e}))},replace:L,rename:function(e,t){var n;return e.nodeName!==t.toUpperCase()&&(n=I(t),Xa(v(e),(function(t){b(n,t.nodeName,h(e,t.nodeName))})),L(n,e,!0)),n||e},findCommonAncestor:function(e,t){for(var n,r=e;r;){for(n=t;n&&r!==n;)n=n.parentNode;if(r===n)break;r=r.parentNode}return!r&&e.ownerDocument?e.ownerDocument.documentElement:r},toHex:function(e){return l.toHex(bt.trim(e))},run:N,getAttribs:v,isEmpty:function(e,t){var n,r,o=0;if(F(e))return!1;if(e=e.firstChild){var i=new Yr(e,e.parentNode),a=u?u.getWhiteSpaceElements():{};t=t||(u?u.getNonEmptyElements():null);do{if(n=e.nodeType,Cn(e)){var c=e.getAttribute("data-mce-bogus");if(c){e=i.next("all"===c);continue}if(r=e.nodeName.toLowerCase(),t&&t[r]){if("br"===r){o++,e=i.next();continue}return!1}if(F(e))return!1}if(8===n)return!1;if(3===n&&!Lo(e.nodeValue))return!1;if(3===n&&e.parentNode&&a[e.parentNode.nodeName]&&Lo(e.nodeValue))return!1;e=i.next()}while(e)}return o<=1},createRng:j,nodeIndex:tc,split:function(e,t,n){var r,o,i,a=j();if(e&&t)return a.setStart(e.parentNode,tc(e)),a.setEnd(t.parentNode,tc(t)),r=a.extractContents(),(a=j()).setStart(t.parentNode,tc(t)+1),a.setEnd(e.parentNode,tc(e)+1),o=a.extractContents(),(i=e.parentNode).insertBefore(Ko(W,r),e),n?i.insertBefore(n,e):i.insertBefore(t,e),i.insertBefore(Ko(W,o),e),B(e),n||t},bind:H,unbind:U,fire:function(e,t,n){return s.fire(e,t,n)},getContentEditable:z,getContentEditableParent:function(e){for(var t=w(),n=null;e&&e!==t&&null===(n=z(e));e=e.parentNode);return n},destroy:function(){if(c.length>0)for(var e=c.length;e--;){var t=c[e];s.unbind(t[0],t[1],t[2])}me(o,(function(e,t){a.unload(t),delete o[t]})),la.setDocument&&la.setDocument()},isChildOf:function(e,t){if(Qa){for(;e;){if(t===e)return!0;e=e.parentNode}return!1}return e===t||t.contains(e)},dumpRng:function(e){return"startContainer: "+e.startContainer.nodeName+", startOffset: "+e.startOffset+", endContainer: "+e.endContainer.nodeName+", endOffset: "+e.endOffset}},V=function(e,t,n){var r=t.keep_values,o={set:function(e,r,o){t.url_converter&&null!==r&&(r=t.url_converter.call(t.url_converter_scope||n(),r,o,e[0])),e.attr("data-mce-"+o,r).attr(o,r)},get:function(e,t){return e.attr("data-mce-"+t)||e.attr(t)}},i={style:{set:function(t,n){null===n||"object"!=typeof n?(r&&t.attr("data-mce-style",n),null!==n&&"string"==typeof n?(t.removeAttr("style"),t.css(e.parse(n))):t.attr("style",n)):t.css(n)},get:function(t){var n=t.attr("data-mce-style")||t.attr("style");return n=e.serialize(e.parse(n),t[0].nodeName)}}};return r&&(i.href=i.src=o),i}(l,t,E(W));return W};nc.DOM=nc(document),nc.nodeIndex=tc;var rc=nc.DOM,oc=bt.each,ic=bt.grep,ac=function(){function e(e){void 0===e&&(e={}),this.states={},this.queue=[],this.scriptLoadedCallbacks={},this.queueLoadedCallbacks=[],this.loading=0,this.settings=e}return e.prototype._setReferrerPolicy=function(e){this.settings.referrerPolicy=e},e.prototype.loadScript=function(e,t,n){var r,o=rc,i=function(){o.remove(a),r&&(r.onerror=r.onload=r=null)},a=o.uniqueId();(r=document.createElement("script")).id=a,r.type="text/javascript",r.src=bt._addCacheSuffix(e),this.settings.referrerPolicy&&o.setAttrib(r,"referrerpolicy",this.settings.referrerPolicy),r.onload=function(){i(),t()},r.onerror=function(){i(),C(n)?n():"undefined"!=typeof console&&console.log&&console.log("Failed to load script: "+e)},(document.getElementsByTagName("head")[0]||document.body).appendChild(r)},e.prototype.isDone=function(e){return 2===this.states[e]},e.prototype.markDone=function(e){this.states[e]=2},e.prototype.add=function(e,t,n,r){var o=this.states[e];this.queue.push(e),void 0===o&&(this.states[e]=0),t&&(this.scriptLoadedCallbacks[e]||(this.scriptLoadedCallbacks[e]=[]),this.scriptLoadedCallbacks[e].push({success:t,failure:r,scope:n||this}))},e.prototype.load=function(e,t,n,r){return this.add(e,t,n,r)},e.prototype.remove=function(e){delete this.states[e],delete this.scriptLoadedCallbacks[e]},e.prototype.loadQueue=function(e,t,n){this.loadScripts(this.queue,e,t,n)},e.prototype.loadScripts=function(e,t,n,r){var o=this,i=[],a=function(e,t){oc(o.scriptLoadedCallbacks[t],(function(t){C(t[e])&&t[e].call(t.scope)})),o.scriptLoadedCallbacks[t]=void 0};o.queueLoadedCallbacks.push({success:t,failure:r,scope:n||this});var c=function(){var t=ic(e);if(e.length=0,oc(t,(function(e){2!==o.states[e]?3!==o.states[e]?1!==o.states[e]&&(o.states[e]=1,o.loading++,o.loadScript(e,(function(){o.states[e]=2,o.loading--,a("success",e),c()}),(function(){o.states[e]=3,o.loading--,i.push(e),a("failure",e),c()}))):a("failure",e):a("success",e)})),!o.loading){var n=o.queueLoadedCallbacks.slice(0);o.queueLoadedCallbacks.length=0,oc(n,(function(e){0===i.length?C(e.success)&&e.success.call(e.scope):C(e.failure)&&e.failure.call(e.scope,i)}))}};c()},e.ScriptLoader=new e,e}(),cc=function(e){var t=e;return{get:function(){return t},set:function(e){t=e}}},uc={},lc=cc("en"),sc=function(){return we(uc,lc.get())},fc={getData:function(){return pe(uc,(function(e){return De({},e)}))},setCode:function(e){e&&lc.set(e)},getCode:function(){return lc.get()},add:function(e,t){var n=uc[e];n||(uc[e]=n={}),me(t,(function(e,t){n[t.toLowerCase()]=e}))},translate:function(e){var t,n=sc().getOr({}),r=function(e){return C(e)?Object.prototype.toString.call(e):o(e)?"":""+e},o=function(e){return""===e||null==e},i=function(e){var t=r(e);return we(n,t.toLowerCase()).map(r).getOr(t)},a=function(e){return e.replace(/{context:\w+}$/,"")};if(o(e))return"";if(p(t=e)&&Ce(t,"raw"))return r(e.raw);if(function(e){return g(e)&&e.length>1}(e)){var c=e.slice(1);return a(i(e[0]).replace(/\{([0-9]+)\}/g,(function(e,t){return Ce(c,t)?r(c[t]):e})))}return a(i(e))},isRtl:function(){return sc().bind((function(e){return we(e,"_dir")})).exists((function(e){return"rtl"===e}))},hasCode:function(e){return Ce(uc,e)}},dc=function(){var e=[],t={},n={},r=[],o=function(e,t){var n=J(r,(function(n){return n.name===e&&n.state===t}));$(n,(function(e){return e.callback()}))},i=function(e){var t;return n[e]&&(t=n[e].dependencies),t||[]},a=function(e,t){return"object"==typeof t?t:"string"==typeof e?{prefix:"",resource:t,suffix:""}:{prefix:e.prefix,resource:t,suffix:e.suffix}},c=function(e,r,u,l,s){if(!t[e]){var f="string"==typeof r?r:r.prefix+r.resource+r.suffix;0!==f.indexOf("/")&&-1===f.indexOf("://")&&(f=dc.baseURL+"/"+f),t[e]=f.substring(0,f.lastIndexOf("/"));var d=function(){o(e,"loaded"),function(e,t,n,r){var o=i(e);$(o,(function(e){var n=a(t,e);c(n.resource,n,void 0,void 0)})),n&&(r?n.call(r):n.call(ac))}(e,r,u,l)};n[e]?d():ac.ScriptLoader.add(f,d,l,s)}},u=function(e,o,i){void 0===i&&(i="added"),Ce(n,e)&&"added"===i||Ce(t,e)&&"loaded"===i?o():r.push({name:e,state:i,callback:o})};return{items:e,urls:t,lookup:n,_listeners:r,get:function(e){if(n[e])return n[e].instance},dependencies:i,requireLangPack:function(e,n){!1!==dc.languageLoad&&u(e,(function(){var r=fc.getCode();!r||n&&-1===(","+(n||"")+",").indexOf(","+r+",")||ac.ScriptLoader.add(t[e]+"/langs/"+r+".js")}),"loaded")},add:function(t,r,i){var a=r;return e.push(a),n[t]={instance:a,dependencies:i},o(t,"added"),a},remove:function(e){delete t[e],delete n[e]},createUrl:a,addComponents:function(e,n){var r=t[e];$(n,(function(e){ac.ScriptLoader.add(r+"/"+e)}))},load:c,waitFor:u}};dc.languageLoad=!0,dc.baseURL="",dc.PluginManager=dc(),dc.ThemeManager=dc();var mc=function(){var e=function(e){var t=cc(F.none()),n=function(){return t.get().each(e)};return{clear:function(){n(),t.set(F.none())},isSet:function(){return t.get().isSome()},get:function(){return t.get()},set:function(e){n(),t.set(F.some(e))}}}(S);return De(De({},e),{on:function(t){return e.get().each(t)}})},pc=function(e,t){var n=null;return{cancel:function(){h(n)||(clearTimeout(n),n=null)},throttle:function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];h(n)&&(n=setTimeout((function(){n=null,e.apply(null,r)}),t))}}},gc=function(e,t){var n=null,r=function(){h(n)||(clearTimeout(n),n=null)};return{cancel:r,throttle:function(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];r(),n=setTimeout((function(){n=null,e.apply(null,o)}),t)}}},hc=function(e,t){var n=qn(e,t);return void 0===n||""===n?[]:n.split(" ")},vc=function(e){return void 0!==e.dom.classList},bc=function(e,t){return function(e,t,n){var r=hc(e,t).concat([n]);return Wn(e,t,r.join(" ")),!0}(e,"class",t)},yc=function(e,t){return function(e,t,n){var r=J(hc(e,t),(function(e){return e!==n}));return r.length>0?Wn(e,t,r.join(" ")):Kn(e,t),!1}(e,"class",t)},wc=function(e,t){vc(e)?e.dom.classList.add(t):bc(e,t)},Cc=function(e){0===(vc(e)?e.dom.classList:function(e){return hc(e,"class")}(e)).length&&Kn(e,"class")},xc=function(e,t){return vc(e)&&e.dom.classList.contains(t)},Sc=function(e,t){var n=[];return $(zt(e),(function(e){t(e)&&(n=n.concat([e])),n=n.concat(Sc(e,t))})),n},kc=function(e,t){return function(e,t){var n=void 0===t?document:t.dom;return St(n)?[]:q(n.querySelectorAll(e),wt.fromDom)}(t,e)},Tc=E("mce-annotation"),Ec=E("data-mce-annotation"),Ac=E("data-mce-annotation-uid"),_c=function(e,t){var n=e.selection.getRng(),r=wt.fromDom(n.startContainer),o=wt.fromDom(e.getBody()),i=t.fold((function(){return"."+Tc()}),(function(e){return"["+Ec()+'="'+e+'"]'})),a=Wt(r,n.startOffset).getOr(r),c=Wr(a,i,(function(e){return kt(e,o)})),u=function(e,t){return function(e,t){var n=e.dom;return!(!n||!n.hasAttribute)&&n.hasAttribute(t)}(e,t)?F.some(qn(e,t)):F.none()};return c.bind((function(t){return u(t,""+Ac()).bind((function(n){return u(t,""+Ec()).map((function(t){var r=Nc(e,n);return{uid:n,name:t,elements:r}}))}))}))},Nc=function(e,t){var n=wt.fromDom(e.getBody());return kc(n,"["+Ac()+'="'+t+'"]')},Rc=function(e,t){var n=cc({}),r=function(){return{listeners:[],previous:mc()}},o=function(e,t){i(e,(function(e){return t(e),e}))},i=function(e,t){var o=n.get(),i=t(we(o,e).getOrThunk(r));o[e]=i,n.set(o)},a=gc((function(){var t=n.get(),r=ie(fe(t));$(r,(function(t){i(t,(function(n){var r=n.previous.get();return _c(e,F.some(t)).fold((function(){r.isSome()&&(!function(e){o(e,(function(t){$(t.listeners,(function(t){return t(!1,e)}))}))}(t),n.previous.clear())}),(function(e){var t=e.uid,i=e.name,a=e.elements;jn(r,t)||(!function(e,t,n){o(e,(function(r){$(r.listeners,(function(r){return r(!0,e,{uid:t,nodes:q(n,(function(e){return e.dom}))})}))}))}(i,t,a),n.previous.set(t))})),{previous:n.previous,listeners:n.listeners}}))}))}),30);e.on("remove",(function(){a.cancel()})),e.on("NodeChange",(function(){a.throttle()}));return{addListener:function(e,t){i(e,(function(e){return{previous:e.previous,listeners:e.listeners.concat([t])}}))}}},Dc=function(e,t){e.on("init",(function(){e.serializer.addNodeFilter("span",(function(e){$(e,(function(e){(function(e){return F.from(e.attr(Ec())).bind(t.lookup)})(e).each((function(t){!1===t.persistent&&e.unwrap()}))}))}))}))},Oc=0,Ic=function(e){var t=(new Date).getTime();return e+"_"+Math.floor(1e9*Math.random())+ ++Oc+String(t)},Pc=function(e,t){var n,r,o=Pt(e).dom,i=wt.fromDom(o.createDocumentFragment()),a=(n=t,(r=(o||document).createElement("div")).innerHTML=n,zt(wt.fromDom(r)));on(i,a),an(e),rn(e,i)},Bc=function(e,t){return wt.fromDom(e.dom.cloneNode(t))},Mc=function(e){return Bc(e,!1)},Lc=function(e){return Bc(e,!0)},Fc=function(e,t,n){void 0===n&&(n=I);var r=new Yr(e,t),o=function(e){var t;do{t=r[e]()}while(t&&!Nn(t)&&!n(t));return F.from(t).filter(Nn)};return{current:function(){return F.from(r.current()).filter(Nn)},next:function(){return o("next")},prev:function(){return o("prev")},prev2:function(){return o("prev2")}}},jc=function(e,t){var n=t||function(t){return e.isBlock(t)||In(t)||Mn(t)},r=function(e,t,n,o){if(Nn(e)){var i=o(e,t,e.data);if(-1!==i)return F.some({container:e,offset:i})}return n().bind((function(e){return r(e.container,e.offset,n,o)}))};return{backwards:function(e,t,o,i){var a=Fc(e,i,n);return r(e,t,(function(){return a.prev().map((function(e){return{container:e,offset:e.length}}))}),o).getOrNull()},forwards:function(e,t,o,i){var a=Fc(e,i,n);return r(e,t,(function(){return a.next().map((function(e){return{container:e,offset:0}}))}),o).getOrNull()}}},Hc=Math.round,Uc=function(e){return e?{left:Hc(e.left),top:Hc(e.top),bottom:Hc(e.bottom),right:Hc(e.right),width:Hc(e.width),height:Hc(e.height)}:{left:0,top:0,bottom:0,right:0,width:0,height:0}},zc=function(e,t){return e=Uc(e),t||(e.left=e.left+e.width),e.right=e.left,e.width=0,e},Wc=function(e,t,n){return e>=0&&e<=Math.min(t.height,n.height)/2},Vc=function(e,t){var n=Math.min(t.height/2,e.height/2);return e.bottom-n<t.top||!(e.top>t.bottom)&&Wc(t.top-e.bottom,e,t)},qc=function(e,t){return e.top>t.bottom||!(e.bottom<t.top)&&Wc(t.bottom-e.top,e,t)},$c=function(e,t,n){return t>=e.left&&t<=e.right&&n>=e.top&&n<=e.bottom},Kc=function(e){var t=e.startContainer,n=e.startOffset;return t.hasChildNodes()&&e.endOffset===n+1?t.childNodes[n]:null},Gc=function(e,t){if(Cn(e)&&e.hasChildNodes()){var n=e.childNodes;return n[function(e,t,n){return Math.min(Math.max(e,t),n)}(t,0,n.length-1)]}return e},Jc=new RegExp("[-----------------------------------------------------------------------------------------------------------------------------------]"),Xc=function(e){return"string"==typeof e&&e.charCodeAt(0)>=768&&Jc.test(e)},Yc=Cn,Qc=Io,Zc=Sn("display","block table"),eu=Sn("float","left right"),tu=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){for(var n=0;n<e.length;n++)if(!e[n](t))return!1;return!0}}(Yc,Qc,R(eu)),nu=R(Sn("white-space","pre pre-line pre-wrap")),ru=Nn,ou=In,iu=nc.nodeIndex,au=function(e,t){return t<0&&Cn(e)&&e.hasChildNodes()?void 0:Gc(e,t)},cu=function(e){return"createRange"in e?e.createRange():nc.DOM.createRng()},uu=function(e){return e&&/[\r\n\t ]/.test(e)},lu=function(e){return!!e.setStart&&!!e.setEnd},su=function(e){var t=e.startContainer,n=e.startOffset;if(uu(e.toString())&&nu(t.parentNode)&&Nn(t)){var r=t.data;if(uu(r[n-1])||uu(r[n+1]))return!0}return!1},fu=function(e){return 0===e.left&&0===e.right&&0===e.top&&0===e.bottom},du=function(e){var t,n=e.getClientRects();return t=n.length>0?Uc(n[0]):Uc(e.getBoundingClientRect()),!lu(e)&&ou(e)&&fu(t)?function(e){var t=e.ownerDocument,n=cu(t),r=t.createTextNode(""),o=e.parentNode;o.insertBefore(r,e),n.setStart(r,0),n.setEnd(r,1);var i=Uc(n.getBoundingClientRect());return o.removeChild(r),i}(e):fu(t)&&lu(e)?function(e){var t=e.startContainer,n=e.endContainer,r=e.startOffset,o=e.endOffset;if(t===n&&Nn(n)&&0===r&&1===o){var i=e.cloneRange();return i.setEndAfter(n),du(i)}return null}(e):t},mu=function(e,t){var n=zc(e,t);return n.width=1,n.right=n.left+1,n},pu=function(e){var t=[],n=function(e){var n,r;0!==e.height&&(t.length>0&&(n=e,r=t[t.length-1],n.left===r.left&&n.top===r.top&&n.bottom===r.bottom&&n.right===r.right)||t.push(e))},r=function(e,r){var o=cu(e.ownerDocument);if(r<e.data.length){if(Xc(e.data[r]))return t;if(Xc(e.data[r-1])&&(o.setStart(e,r),o.setEnd(e,r+1),!su(o)))return n(mu(du(o),!1)),t}r>0&&(o.setStart(e,r-1),o.setEnd(e,r),su(o)||n(mu(du(o),!1))),r<e.data.length&&(o.setStart(e,r),o.setEnd(e,r+1),su(o)||n(mu(du(o),!0)))},o=e.container(),i=e.offset();if(ru(o))return r(o,i),t;if(Yc(o))if(e.isAtEnd()){var a=au(o,i);ru(a)&&r(a,a.data.length),tu(a)&&!ou(a)&&n(mu(du(a),!1))}else{a=au(o,i);if(ru(a)&&r(a,0),tu(a)&&e.isAtEnd())return n(mu(du(a),!1)),t;var c=au(e.container(),e.offset()-1);tu(c)&&!ou(c)&&(Zc(c)||Zc(a)||!tu(a))&&n(mu(du(c),!1)),tu(a)&&n(mu(du(a),!0))}return t},gu=function(e,t,n){var r=function(){return n||(n=pu(gu(e,t))),n};return{container:E(e),offset:E(t),toRange:function(){var n=cu(e.ownerDocument);return n.setStart(e,t),n.setEnd(e,t),n},getClientRects:r,isVisible:function(){return r().length>0},isAtStart:function(){return ru(e),0===t},isAtEnd:function(){return ru(e)?t>=e.data.length:t>=e.childNodes.length},isEqual:function(n){return n&&e===n.container()&&t===n.offset()},getNode:function(n){return au(e,n?t-1:t)}}};gu.fromRangeStart=function(e){return gu(e.startContainer,e.startOffset)},gu.fromRangeEnd=function(e){return gu(e.endContainer,e.endOffset)},gu.after=function(e){return gu(e.parentNode,iu(e)+1)},gu.before=function(e){return gu(e.parentNode,iu(e))},gu.isAbove=function(e,t){return Hn(ce(t.getClientRects()),ue(e.getClientRects()),Vc).getOr(!1)},gu.isBelow=function(e,t){return Hn(ue(t.getClientRects()),ce(e.getClientRects()),qc).getOr(!1)},gu.isAtStart=function(e){return!!e&&e.isAtStart()},gu.isAtEnd=function(e){return!!e&&e.isAtEnd()},gu.isTextPosition=function(e){return!!e&&Nn(e.container())},gu.isElementPosition=function(e){return!1===gu.isTextPosition(e)};var hu,vu=function(e,t){Nn(t)&&0===t.data.length&&e.remove(t)},bu=function(e,t,n){On(n)?function(e,t,n){var r=F.from(n.firstChild),o=F.from(n.lastChild);t.insertNode(n),r.each((function(t){return vu(e,t.previousSibling)})),o.each((function(t){return vu(e,t.nextSibling)}))}(e,t,n):function(e,t,n){t.insertNode(n),vu(e,n.previousSibling),vu(e,n.nextSibling)}(e,t,n)},yu=Nn,wu=Tn,Cu=nc.nodeIndex,xu=function(e){var t=e.parentNode;return wu(t)?xu(t):t},Su=function(e){return e?_e(e.childNodes,(function(e,t){return wu(t)&&"BR"!==t.nodeName?e=e.concat(Su(t)):e.push(t),e}),[]):[]},ku=function(e){return function(t){return e===t}},Tu=function(e){return(yu(e)?"text()":e.nodeName.toLowerCase())+"["+function(e){var t,n;t=Su(xu(e)),n=Ne(t,ku(e),e),t=t.slice(0,n+1);var r=_e(t,(function(e,n,r){return yu(n)&&yu(t[r-1])&&e++,e}),0);return t=Ee(t,xn([e.nodeName])),(n=Ne(t,ku(e),e))-r}(e)+"]"},Eu=function(e,t){var n,r,o,i,a,c=[];return n=t.container(),r=t.offset(),yu(n)?o=function(e,t){for(;(e=e.previousSibling)&&yu(e);)t+=e.data.length;return t}(n,r):(r>=(i=n.childNodes).length?(o="after",r=i.length-1):o="before",n=i[r]),c.push(Tu(n)),a=function(e,t,n){var r=[];for(t=t.parentNode;t!==e&&(!n||!n(t));t=t.parentNode)r.push(t);return r}(e,n),a=Ee(a,R(Tn)),(c=c.concat(Te(a,(function(e){return Tu(e)})))).reverse().join("/")+","+o},Au=function(e,t){var n;if(!t)return null;var r=t.split(","),o=r[0].split("/");n=r.length>1?r[1]:"before";var i=_e(o,(function(e,t){var n=/([\w\-\(\)]+)\[([0-9]+)\]/.exec(t);return n?("text()"===n[1]&&(n[1]="#text"),function(e,t,n){var r=Su(e);return r=Ee(r,(function(e,t){return!yu(e)||!yu(r[t-1])})),(r=Ee(r,xn([t])))[n]}(e,n[1],parseInt(n[2],10))):null}),e);return i?yu(i)?function(e,t){for(var n,r=e,o=0;yu(r);){if(n=r.data.length,t>=o&&t<=o+n){e=r,t-=o;break}if(!yu(r.nextSibling)){e=r,t=n;break}o+=n,r=r.nextSibling}return yu(e)&&t>e.data.length&&(t=e.data.length),gu(e,t)}(i,parseInt(n,10)):(n="after"===n?Cu(i)+1:Cu(i),gu(i.parentNode,n)):null},_u=Mn,Nu=function(e,t,n,r,o){var i,a=r[o?"startContainer":"endContainer"],c=r[o?"startOffset":"endOffset"],u=[],l=0,s=e.getRoot();for(Nn(a)?u.push(n?function(e,t,n){var r,o;for(o=e(t.data.slice(0,n)).length,r=t.previousSibling;r&&Nn(r);r=r.previousSibling)o+=e(r.data).length;return o}(t,a,c):c):(c>=(i=a.childNodes).length&&i.length&&(l=1,c=Math.max(0,i.length-1)),u.push(e.nodeIndex(i[c],n)+l));a&&a!==s;a=a.parentNode)u.push(e.nodeIndex(a,n));return u},Ru=function(e,t,n){var r=0;return bt.each(e.select(t),(function(e){if("all"!==e.getAttribute("data-mce-bogus"))return e!==n&&void r++})),r},Du=function(e,t){var n,r,o,i=t?"start":"end";n=e[i+"Container"],r=e[i+"Offset"],Cn(n)&&"TR"===n.nodeName&&(n=(o=n.childNodes)[Math.min(t?r:r-1,o.length-1)])&&(r=t?0:n.childNodes.length,e["set"+(t?"Start":"End")](n,r))},Ou=function(e){return Du(e,!0),Du(e,!1),e},Iu=function(e,t){var n;if(Cn(e)&&(e=Gc(e,t),_u(e)))return e;if(ho(e)){if(Nn(e)&&po(e)&&(e=e.parentNode),n=e.previousSibling,_u(n))return n;if(n=e.nextSibling,_u(n))return n}},Pu=function(e,t,n){var r=n.getNode(),o=r?r.nodeName:null,i=n.getRng();if(_u(r)||"IMG"===o)return{name:o,index:Ru(n.dom,o,r)};var a=function(e){return Iu(e.startContainer,e.startOffset)||Iu(e.endContainer,e.endOffset)}(i);return a?{name:o=a.tagName,index:Ru(n.dom,o,a)}:function(e,t,n,r){var o=t.dom,i={};return i.start=Nu(o,e,n,r,!0),t.isCollapsed()||(i.end=Nu(o,e,n,r,!1)),ko(r)&&(i.isFakeCaret=!0),i}(e,n,t,i)},Bu=function(e,t,n){var r={"data-mce-type":"bookmark",id:t,style:"overflow:hidden;line-height:0px"};return n?e.create("span",r,"&#xFEFF;"):e.create("span",r)},Mu=function(e,t){var n=e.dom,r=e.getRng(),o=n.uniqueId(),i=e.isCollapsed(),a=e.getNode(),c=a.nodeName;if("IMG"===c)return{name:c,index:Ru(n,c,a)};var u=Ou(r.cloneRange());if(!i){u.collapse(!1);var l=Bu(n,o+"_end",t);bu(n,u,l)}(r=Ou(r)).collapse(!0);var s=Bu(n,o+"_start",t);return bu(n,r,s),e.moveToBookmark({id:o,keep:!0}),{id:o}},Lu=function(e,t,n){return 2===t?Pu(so,n,e):3===t?function(e){var t=e.getRng();return{start:Eu(e.dom.getRoot(),gu.fromRangeStart(t)),end:Eu(e.dom.getRoot(),gu.fromRangeEnd(t))}}(e):t?function(e){return{rng:e.getRng()}}(e):Mu(e,!1)},Fu=N(Pu,A,!0),ju=nc.DOM,Hu=function(e,t,n){var r=e.getParam(t,n);if(-1!==r.indexOf("=")){var o=e.getParam(t,"","hash");return we(o,e.id).getOr(n)}return r},Uu=function(e){return e.getParam("content_security_policy","")},zu=function(e){if(e.getParam("force_p_newlines",!1))return"p";var t=e.getParam("forced_root_block","p");return!1===t?"":!0===t?"p":t},Wu=function(e){return e.getParam("forced_root_block_attrs",{})},Vu=function(e){return e.getParam("automatic_uploads",!0,"boolean")},qu=function(e){return e.getParam("images_reuse_filename",!1,"boolean")},$u=function(e){return e.getParam("icons","","string")},Ku=function(e){return e.getParam("images_upload_url","","string")},Gu=function(e){return e.getParam("images_upload_base_path","","string")},Ju=function(e){return e.getParam("images_upload_credentials",!1,"boolean")},Xu=function(e){return e.getParam("images_upload_handler",null,"function")},Yu=function(e){return e.getParam("content_css_cors",!1,"boolean")},Qu=function(e){return e.getParam("referrer_policy","","string")},Zu=function(e){return e.getParam("language","en","string")},el=function(e){return e.getParam("indent_use_margin",!1)},tl=function(e){var t=e.getParam("font_css",[]);return g(t)?t:q(t.split(","),Ue)},nl=function(e){var t=e.getParam("object_resizing");return!1!==t&&!mt.iOS&&(m(t)?t:"table,img,figure.image,div,video,iframe")},rl=function(e){return e.getParam("event_root")},ol=function(e){return e.getParam("theme")},il=function(e){return e.getParam("validate")},al=function(e){return!1!==e.getParam("inline_boundaries")},cl=function(e){return e.getParam("content_css_cors")},ul=function(e){return e.getParam("plugins","","string")},ll=Cn,sl=Nn,fl=function(e){var t=e.parentNode;t&&t.removeChild(e)},dl=function(e){var t=so(e);return{count:e.length-t.length,text:t}},ml=function(e){for(var t;-1!==(t=e.data.lastIndexOf("\ufeff"));)e.deleteData(t,1)},pl=function(e,t){return bl(e),t},gl=function(e,t){var n=t.container(),r=function(e,t){var n=z(e,t);return-1===n?F.none():F.some(n)}(le(n.childNodes),e).map((function(e){return e<t.offset()?gu(n,t.offset()-1):t})).getOr(t);return bl(e),r},hl=function(e,t){return sl(e)&&t.container()===e?function(e,t){var n=dl(e.data.substr(0,t.offset())),r=dl(e.data.substr(t.offset()));return(n.text+r.text).length>0?(ml(e),gu(e,t.offset()-n.count)):t}(e,t):pl(e,t)},vl=function(e,t){return gu.isTextPosition(t)?hl(e,t):function(e,t){return t.container()===e.parentNode?gl(e,t):pl(e,t)}(e,t)},bl=function(e){ll(e)&&ho(e)&&(vo(e)?e.removeAttribute("data-mce-caret"):fl(e)),sl(e)&&(ml(e),0===e.data.length&&fl(e))},yl=ot().browser,wl=Mn,Cl=Fn,xl=Ln,Sl=function(e,t,n){var r,o,i=zc(t.getBoundingClientRect(),n);if("BODY"===e.tagName){var a=e.ownerDocument.documentElement;r=e.scrollLeft||a.scrollLeft,o=e.scrollTop||a.scrollTop}else{var c=e.getBoundingClientRect();r=e.scrollLeft-c.left,o=e.scrollTop-c.top}i.left+=r,i.right+=r,i.top+=o,i.bottom+=o,i.width=1;var u=t.offsetWidth-t.clientWidth;return u>0&&(n&&(u*=-1),i.left+=u,i.right+=u),i},kl=function(e,t,n,r){var o,i,a=mc(),c=zu(e),u=c.length>0?c:"p",l=function(){!function(e){for(var t=kc(wt.fromDom(e),"*[contentEditable=false],video,audio,embed,object"),n=0;n<t.length;n++){var r,o=t[n].dom,i=o.previousSibling;if(xo(i))1===(r=i.data).length?i.parentNode.removeChild(i):i.deleteData(r.length-1,1);if(i=o.nextSibling,Co(i))1===(r=i.data).length?i.parentNode.removeChild(i):i.deleteData(0,1)}}(t),i&&(bl(i),i=null),a.on((function(e){Ja(e.caret).remove(),a.clear()})),o&&(Gr.clearInterval(o),o=void 0)},s=function(){o=Gr.setInterval((function(){r()?Ja("div.mce-visual-caret",t).toggleClass("mce-visual-caret-hidden"):Ja("div.mce-visual-caret",t).addClass("mce-visual-caret-hidden")}),500)};return{show:function(e,r){var o;if(l(),xl(r))return null;if(!n(r))return i=function(e,t){var n=e.ownerDocument.createTextNode("\ufeff"),r=e.parentNode;if(t){o=e.previousSibling;if(mo(o)){if(ho(o))return o;if(xo(o))return o.splitText(o.data.length-1)}r.insertBefore(n,e)}else{var o=e.nextSibling;if(mo(o)){if(ho(o))return o;if(Co(o))return o.splitText(1),o}e.nextSibling?r.insertBefore(n,e.nextSibling):r.appendChild(n)}return n}(r,e),o=r.ownerDocument.createRange(),El(i.nextSibling)?(o.setStart(i,0),o.setEnd(i,0)):(o.setStart(i,1),o.setEnd(i,1)),o;i=wo(u,r,e);var c=Sl(t,r,e);Ja(i).css("top",c.top);var f=Ja('<div class="mce-visual-caret" data-mce-bogus="all"></div>').css(De({},c)).appendTo(t)[0];return a.set({caret:f,element:r,before:e}),e&&Ja(f).addClass("mce-visual-caret-before"),s(),(o=r.ownerDocument.createRange()).setStart(i,0),o.setEnd(i,0),o},hide:l,getCss:function(){return".mce-visual-caret {position: absolute;background-color: black;background-color: currentcolor;}.mce-visual-caret-hidden {display: none;}*[data-mce-caret] {position: absolute;left: -1000px;right: auto;top: 0;margin: 0;padding: 0;}"},reposition:function(){a.on((function(e){var n=Sl(t,e.element,e.before);Ja(e.caret).css(De({},n))}))},destroy:function(){return Gr.clearInterval(o)}}},Tl=function(){return yl.isIE()||yl.isEdge()||yl.isFirefox()},El=function(e){return wl(e)||Cl(e)},Al=function(e){return El(e)||En(e)&&Tl()},_l=Mn,Nl=Fn,Rl=Sn("display","block table table-cell table-caption list-item"),Dl=ho,Ol=po,Il=Cn,Pl=Io,Bl=function(e){return e>0},Ml=function(e){return e<0},Ll=function(e,t){for(var n;n=e(t);)if(!Ol(n))return n;return null},Fl=function(e,t,n,r,o){var i=new Yr(e,r),a=_l(e)||Ol(e);if(Ml(t)){if(a&&n(e=Ll(i.prev.bind(i),!0)))return e;for(;e=Ll(i.prev.bind(i),o);)if(n(e))return e}if(Bl(t)){if(a&&n(e=Ll(i.next.bind(i),!0)))return e;for(;e=Ll(i.next.bind(i),o);)if(n(e))return e}return null},jl=function(e,t){for(;e&&e!==t;){if(Rl(e))return e;e=e.parentNode}return null},Hl=function(e,t,n){return jl(e.container(),n)===jl(t.container(),n)},Ul=function(e,t){if(!t)return null;var n=t.container(),r=t.offset();return Il(n)?n.childNodes[r+e]:null},zl=function(e,t){var n=t.ownerDocument.createRange();return e?(n.setStartBefore(t),n.setEndBefore(t)):(n.setStartAfter(t),n.setEndAfter(t)),n},Wl=function(e,t,n){return jl(t,e)===jl(n,e)},Vl=function(e,t,n){for(var r=e?"previousSibling":"nextSibling";n&&n!==t;){var o=n[r];if(Dl(o)&&(o=o[r]),_l(o)||Nl(o)){if(Wl(t,o,n))return o;break}if(Pl(o))break;n=n.parentNode}return null},ql=N(zl,!0),$l=N(zl,!1),Kl=function(e,t,n){var r,o=N(Vl,!0,t),i=N(Vl,!1,t),a=n.startContainer,c=n.startOffset;if(po(a)){Il(a)||(a=a.parentNode);var u=a.getAttribute("data-mce-caret");if("before"===u&&(r=a.nextSibling,Al(r)))return ql(r);if("after"===u&&(r=a.previousSibling,Al(r)))return $l(r)}if(!n.collapsed)return n;if(Nn(a)){if(Dl(a)){if(1===e){if(r=i(a))return ql(r);if(r=o(a))return $l(r)}if(-1===e){if(r=o(a))return $l(r);if(r=i(a))return ql(r)}return n}if(xo(a)&&c>=a.data.length-1)return 1===e&&(r=i(a))?ql(r):n;if(Co(a)&&c<=1)return-1===e&&(r=o(a))?$l(r):n;if(c===a.data.length)return(r=i(a))?ql(r):n;if(0===c)return(r=o(a))?$l(r):n}return n},Gl=function(e,t){return F.from(Ul(e?0:-1,t)).filter(_l)},Jl=function(e,t,n){var r=Kl(e,t,n);return-1===e?gu.fromRangeStart(r):gu.fromRangeEnd(r)},Xl=function(e){return F.from(e.getNode()).map(wt.fromDom)},Yl=function(e,t){for(;t=e(t);)if(t.isVisible())return t;return t},Ql=function(e,t){var n=Hl(e,t);return!(n||!In(e.getNode()))||n};!function(e){e[e.Backwards=-1]="Backwards",e[e.Forwards=1]="Forwards"}(hu||(hu={}));var Zl,es=Mn,ts=Nn,ns=Cn,rs=In,os=Io,is=function(e){return Ro(e)||function(e){return!!Po(e)&&!0!==Y(le(e.getElementsByTagName("*")),(function(e,t){return e||To(t)}),!1)}(e)},as=Bo,cs=function(e,t){return e.hasChildNodes()&&t<e.childNodes.length?e.childNodes[t]:null},us=function(e,t){if(Bl(e)){if(os(t.previousSibling)&&!ts(t.previousSibling))return gu.before(t);if(ts(t))return gu(t,0)}if(Ml(e)){if(os(t.nextSibling)&&!ts(t.nextSibling))return gu.after(t);if(ts(t))return gu(t,t.data.length)}return Ml(e)?rs(t)?gu.before(t):gu.after(t):gu.before(t)},ls=function(e,t,n){var r,o,i,a;if(!ns(n)||!t)return null;if(t.isEqual(gu.after(n))&&n.lastChild){if(a=gu.after(n.lastChild),Ml(e)&&os(n.lastChild)&&ns(n.lastChild))return rs(n.lastChild)?gu.before(n.lastChild):a}else a=t;var c=a.container(),u=a.offset();if(ts(c)){if(Ml(e)&&u>0)return gu(c,--u);if(Bl(e)&&u<c.length)return gu(c,++u);r=c}else{if(Ml(e)&&u>0&&(o=cs(c,u-1),os(o)))return!is(o)&&(i=Fl(o,e,as,o))?ts(i)?gu(i,i.data.length):gu.after(i):ts(o)?gu(o,o.data.length):gu.before(o);if(Bl(e)&&u<c.childNodes.length&&(o=cs(c,u),os(o)))return rs(o)?function(e,t){var n=t.nextSibling;return n&&os(n)?ts(n)?gu(n,0):gu.before(n):ls(hu.Forwards,gu.after(t),e)}(n,o):!is(o)&&(i=Fl(o,e,as,o))?ts(i)?gu(i,0):gu.before(i):ts(o)?gu(o,0):gu.after(o);r=o||a.getNode()}if((Bl(e)&&a.isAtEnd()||Ml(e)&&a.isAtStart())&&(r=Fl(r,e,P,n,!0),as(r,n)))return us(e,r);o=Fl(r,e,as,n);var l=Re(J(function(e,t){for(var n=[];e&&e!==t;)n.push(e),e=e.parentNode;return n}(c,n),es));return!l||o&&l.contains(o)?o?us(e,o):null:a=Bl(e)?gu.after(l):gu.before(l)},ss=function(e){return{next:function(t){return ls(hu.Forwards,t,e)},prev:function(t){return ls(hu.Backwards,t,e)}}},fs=function(e){return gu.isTextPosition(e)?0===e.offset():Io(e.getNode())},ds=function(e){if(gu.isTextPosition(e)){var t=e.container();return e.offset()===t.data.length}return Io(e.getNode(!0))},ms=function(e,t){return!gu.isTextPosition(e)&&!gu.isTextPosition(t)&&e.getNode()===t.getNode(!0)},ps=function(e,t,n){return e?!ms(t,n)&&(r=t,!(!gu.isTextPosition(r)&&In(r.getNode())))&&ds(t)&&fs(n):!ms(n,t)&&fs(t)&&ds(n);var r},gs=function(e,t,n){var r=ss(t);return F.from(e?r.next(n):r.prev(n))},hs=function(e,t,n){return gs(e,t,n).bind((function(r){return Hl(n,r,t)&&ps(e,n,r)?gs(e,t,r):F.some(r)}))},vs=function(e,t,n,r){return hs(e,t,n).bind((function(n){return r(n)?vs(e,t,n,r):F.some(n)}))},bs=function(e,t){var n,r=e?t.firstChild:t.lastChild;return Nn(r)?F.some(gu(r,e?0:r.data.length)):r?Io(r)?F.some(e?gu.before(r):In(n=r)?gu.before(n):gu.after(n)):function(e,t,n){var r=e?gu.before(n):gu.after(n);return gs(e,t,r)}(e,t,r):F.none()},ys=N(gs,!0),ws=N(gs,!1),Cs=N(bs,!0),xs=N(bs,!1),Ss=function(e){return Cn(e)&&"_mce_caret"===e.id},ks=function(e,t){for(;t&&t!==e;){if("_mce_caret"===t.id)return t;t=t.parentNode}return null},Ts=function(e){return bt.isArray(e.start)},Es=function(e,t){return Cn(t)&&e.isBlock(t)&&!t.innerHTML&&!mt.ie&&(t.innerHTML='<br data-mce-bogus="1" />'),t},As=function(e,t){return xs(e).fold(I,(function(e){return t.setStart(e.container(),e.offset()),t.setEnd(e.container(),e.offset()),!0}))},_s=function(e,t,n){return!(!function(e){return!1===e.hasChildNodes()}(t)||!ks(e,t))&&(function(e,t){var n=e.ownerDocument.createTextNode("\ufeff");e.appendChild(n),t.setStart(n,0),t.setEnd(n,0)}(t,n),!0)},Ns=function(e,t,n,r){var o,i,a,c,u=n[t?"start":"end"],l=e.getRoot();if(u){for(a=u[0],i=l,o=u.length-1;o>=1;o--){if(c=i.childNodes,_s(l,i,r))return!0;if(u[o]>c.length-1)return!!_s(l,i,r)||As(i,r);i=c[u[o]]}3===i.nodeType&&(a=Math.min(u[0],i.nodeValue.length)),1===i.nodeType&&(a=Math.min(u[0],i.childNodes.length)),t?r.setStart(i,a):r.setEnd(i,a)}return!0},Rs=function(e){return Nn(e)&&e.data.length>0},Ds=function(e,t,n){var r,o,i,a,c,u,l=e.get(n.id+"_"+t),s=n.keep;if(l){if(r=l.parentNode,"start"===t?(s?l.hasChildNodes()?(r=l.firstChild,o=1):Rs(l.nextSibling)?(r=l.nextSibling,o=0):Rs(l.previousSibling)?(r=l.previousSibling,o=l.previousSibling.data.length):(r=l.parentNode,o=e.nodeIndex(l)+1):o=e.nodeIndex(l),c=r,u=o):(s?l.hasChildNodes()?(r=l.firstChild,o=1):Rs(l.previousSibling)?(r=l.previousSibling,o=l.previousSibling.data.length):(r=l.parentNode,o=e.nodeIndex(l)):o=e.nodeIndex(l),c=r,u=o),!s){for(a=l.previousSibling,i=l.nextSibling,bt.each(bt.grep(l.childNodes),(function(e){Nn(e)&&(e.nodeValue=e.nodeValue.replace(/\uFEFF/g,""))}));l=e.get(n.id+"_"+t);)e.remove(l,!0);a&&i&&a.nodeType===i.nodeType&&Nn(a)&&!mt.opera&&(o=a.nodeValue.length,a.appendData(i.nodeValue),e.remove(i),c=a,u=o)}return F.some(gu(c,u))}return F.none()},Os=function(e,t){var n=e.dom;if(t){if(Ts(t))return function(e,t){var n=e.createRng();return Ns(e,!0,t,n)&&Ns(e,!1,t,n)?F.some(n):F.none()}(n,t);if(function(e){return m(e.start)}(t))return F.some(function(e,t){var n,r=e.createRng();return n=Au(e.getRoot(),t.start),r.setStart(n.container(),n.offset()),n=Au(e.getRoot(),t.end),r.setEnd(n.container(),n.offset()),r}(n,t));if(function(e){return Ce(e,"id")}(t))return function(e,t){var n=Ds(e,"start",t),r=Ds(e,"end",t);return Hn(n,r.or(n),(function(t,n){var r=e.createRng();return r.setStart(Es(e,t.container()),t.offset()),r.setEnd(Es(e,n.container()),n.offset()),r}))}(n,t);if(function(e){return Ce(e,"name")}(t))return function(e,t){return F.from(e.select(t.name)[t.index]).map((function(t){var n=e.createRng();return n.selectNode(t),n}))}(n,t);if(function(e){return Ce(e,"rng")}(t))return F.some(t.rng)}return F.none()},Is=function(e,t,n){return Lu(e,t,n)},Ps=function(e,t){Os(e,t).each((function(t){e.setRng(t)}))},Bs=function(e){return Cn(e)&&"SPAN"===e.tagName&&"bookmark"===e.getAttribute("data-mce-type")},Ms=(Zl="",function(e){return Zl===e}),Ls=function(e){return""!==e&&-1!==" \f\n\r\t\v".indexOf(e)},Fs=function(e){return!Ls(e)&&!Ms(e)},js=function(e){return!!e.nodeType},Hs=function(e,t,n){var r=n.startOffset,o=n.startContainer;if((o!==n.endContainer||!function(e){return e&&/^(IMG)$/.test(e.nodeName)}(o.childNodes[r]))&&Cn(o)){var i=o.childNodes,a=void 0;r<i.length?(o=i[r],a=new Yr(o,e.getParent(o,e.isBlock))):(o=i[i.length-1],(a=new Yr(o,e.getParent(o,e.isBlock))).next(!0));for(var c=a.current();c;c=a.next())if(Nn(c)&&!Vs(c))return n.setStart(c,0),void t.setRng(n)}},Us=function(e,t,n){if(e){var r=t?"nextSibling":"previousSibling";for(e=n?e:e[r];e;e=e[r])if(Cn(e)||!Vs(e))return e}},zs=function(e,t){return js(t)&&(t=t.nodeName),!!e.schema.getTextBlockElements()[t.toLowerCase()]},Ws=function(e,t,n){return e.schema.isValidChild(t,n)},Vs=function(e,t){if(void 0===t&&(t=!1),w(e)&&Nn(e)){var n=t?e.data.replace(/ /g,""):e.data;return Lo(n)}return!1},qs=function(e,t){return C(e)?e=e(t):w(t)&&(e=e.replace(/%(\w+)/g,(function(e,n){return t[n]||e}))),e},$s=function(e,t){return t=t||"",e=""+((e=e||"").nodeName||e),t=""+(t.nodeName||t),e.toLowerCase()===t.toLowerCase()},Ks=function(e,t,n){return"color"!==n&&"backgroundColor"!==n||(t=e.toHex(t)),"fontWeight"===n&&700===t&&(t="bold"),"fontFamily"===n&&(t=t.replace(/[\'\"]/g,"").replace(/,\s+/g,",")),""+t},Gs=function(e,t,n){return Ks(e,e.getStyle(t,n),n)},Js=function(e,t){var n;return e.getParent(t,(function(t){return(n=e.getStyle(t,"text-decoration"))&&"none"!==n})),n},Xs=function(e,t,n){return e.getParents(t,n,e.getRoot())},Ys=function(e,t,n){var r=["inline","block","selector","attributes","styles","classes"],o=function(e){return be(e,(function(e,t){return V(r,(function(e){return e===t}))}))};return V(e.formatter.get(t),(function(t){var r=o(t);return V(e.formatter.get(n),(function(e){var t=o(e);return function(e,t,n){return void 0===n&&(n=l),u(n).eq(e,t)}(r,t)}))}))},Qs=function(e){return xe(e,"block")},Zs=function(e){return xe(e,"selector")},ef=function(e){return xe(e,"inline")},tf=function(e){return Zs(e)&&!1!==e.expand&&!ef(e)},nf=Bs,rf=Xs,of=Vs,af=zs,cf=function(e,t){for(var n=t;n;){if(Cn(n)&&e.getContentEditable(n))return"false"===e.getContentEditable(n)?n:t;n=n.parentNode}return t},uf=function(e,t,n,r){for(var o=t.data,i=n;e?i>=0:i<o.length;e?i--:i++)if(r(o.charAt(i)))return e?i+1:i;return-1},lf=function(e,t,n){return uf(e,t,n,(function(e){return Ms(e)||Ls(e)}))},sf=function(e,t,n){return uf(e,t,n,Fs)},ff=function(e,t,n,r,o,i){var a,c=e.getParent(n,e.isBlock)||t,u=function(t,n,r){var i=jc(e),u=o?i.backwards:i.forwards;return F.from(u(t,n,(function(e,t){return nf(e.parentNode)?-1:(a=e,r(o,e,t))}),c))};return u(n,r,lf).bind((function(e){return i?u(e.container,e.offset+(o?-1:0),sf):F.some(e)})).orThunk((function(){return a?F.some({container:a,offset:o?0:a.length}):F.none()}))},df=function(e,t,n,r,o){Nn(r)&&qe(r.data)&&r[o]&&(r=r[o]);for(var i=rf(e,r),a=0;a<i.length;a++)for(var c=0;c<t.length;c++){var u=t[c];if((!w(u.collapsed)||u.collapsed===n.collapsed)&&(Zs(u)&&e.is(i[a],u.selector)))return i[a]}return r},mf=function(e,t,n,r){var o=n,i=e.dom,a=i.getRoot(),c=t[0];if(Qs(c)&&(o=c.wrapper?null:i.getParent(n,c.block,a)),!o){var u=i.getParent(n,"LI,TD,TH");o=i.getParent(Nn(n)?n.parentNode:n,(function(t){return t!==a&&af(e,t)}),u)}if(o&&Qs(c)&&c.wrapper&&(o=rf(i,o,"ul,ol").reverse()[0]||o),!o)for(o=n;o[r]&&!i.isBlock(o[r])&&(o=o[r],!$s(o,"br")););return o||n},pf=function(e,t,n,r){var o=n.parentNode;return!w(n[r])&&(!(o!==t&&!y(o)&&!e.isBlock(o))||pf(e,t,o,r))},gf=function(e,t,n,r,o){var i,a=n,c=o?"previousSibling":"nextSibling",u=e.getRoot();if(Nn(n)&&!of(n)&&(o?r>0:r<n.data.length))return n;for(;;){if(!t[0].block_expand&&e.isBlock(a))return a;for(var l=a[c];l;l=l[c]){var s=Nn(l)&&!pf(e,u,l,c);if(!nf(l)&&(!In(i=l)||!i.getAttribute("data-mce-bogus")||i.nextSibling)&&!of(l,s))return a}if(a===u||a.parentNode===u){n=a;break}a=a.parentNode}return n},hf=function(e){return nf(e.parentNode)||nf(e)},vf=function(e,t,n,r){void 0===r&&(r=!1);var o=t.startContainer,i=t.startOffset,a=t.endContainer,c=t.endOffset,u=e.dom,l=n[0];(Cn(o)&&o.hasChildNodes()&&(o=Gc(o,i),Nn(o)&&(i=0)),Cn(a)&&a.hasChildNodes()&&(a=Gc(a,t.collapsed?c:c-1),Nn(a)&&(c=a.nodeValue.length)),o=cf(u,o),a=cf(u,a),hf(o)&&(o=nf(o)?o:o.parentNode,o=t.collapsed?o.previousSibling||o:o.nextSibling||o,Nn(o)&&(i=t.collapsed?o.length:0)),hf(a)&&(a=nf(a)?a:a.parentNode,a=t.collapsed?a.nextSibling||a:a.previousSibling||a,Nn(a)&&(c=t.collapsed?0:a.length)),t.collapsed)&&(ff(u,e.getBody(),o,i,!0,r).each((function(e){var t=e.container,n=e.offset;o=t,i=n})),ff(u,e.getBody(),a,c,!1,r).each((function(e){var t=e.container,n=e.offset;a=t,c=n})));return(ef(l)||l.block_expand)&&(ef(l)&&Nn(o)&&0!==i||(o=gf(u,n,o,i,!0)),ef(l)&&Nn(a)&&c!==a.nodeValue.length||(a=gf(u,n,a,c,!1))),tf(l)&&(o=df(u,n,t,o,"previousSibling"),a=df(u,n,t,a,"nextSibling")),(Qs(l)||Zs(l))&&(o=mf(e,n,o,"previousSibling"),a=mf(e,n,a,"nextSibling"),Qs(l)&&(u.isBlock(o)||(o=gf(u,n,o,i,!0)),u.isBlock(a)||(a=gf(u,n,a,c,!1)))),Cn(o)&&(i=u.nodeIndex(o),o=o.parentNode),Cn(a)&&(c=u.nodeIndex(a)+1,a=a.parentNode),{startContainer:o,startOffset:i,endContainer:a,endOffset:c}},bf=function(e,t,n){var r=t.startOffset,o=Gc(t.startContainer,r),i=t.endOffset,a=Gc(t.endContainer,i-1),c=function(e){var t=e[0];Nn(t)&&t===o&&r>=t.data.length&&e.splice(0,1);var n=e[e.length-1];return 0===i&&e.length>0&&n===a&&Nn(n)&&e.splice(e.length-1,1),e},u=function(e,t,n){for(var r=[];e&&e!==n;e=e[t])r.push(e);return r},l=function(t,n){return e.getParent(t,(function(e){return e.parentNode===n}),n)},s=function(e,t,r){for(var o=r?"nextSibling":"previousSibling",i=e,a=i.parentNode;i&&i!==t;i=a){a=i.parentNode;var l=u(i===e?i:i[o],o);l.length&&(r||l.reverse(),n(c(l)))}};if(o===a)return n(c([o]));var f=e.findCommonAncestor(o,a);if(e.isChildOf(o,a))return s(o,f,!0);if(e.isChildOf(a,o))return s(a,f);var d=l(o,f)||o,m=l(a,f)||a;s(o,d,!0);var p=u(d===o?d:d.nextSibling,"nextSibling",m===a?m.nextSibling:m);p.length&&n(c(p)),s(a,m)},yf=function(e){var t=[];if(e)for(var n=0;n<e.rangeCount;n++)t.push(e.getRangeAt(n));return t},wf=function(e){return J(function(e){return te(e,(function(e){var t=Kc(e);return t?[wt.fromDom(t)]:[]}))}(e),co)},Cf=function(e,t){var n=kc(t,"td[data-mce-selected],th[data-mce-selected]");return n.length>0?n:wf(e)},xf=function(e){return Cf(yf(e.selection.getSel()),wt.fromDom(e.getBody()))},Sf=function(e,t){return Ur(e,"table",t)},kf=function(e){return Vt(e).fold(E([e]),(function(t){return[e].concat(kf(t))}))},Tf=function(e){return qt(e).fold(E([e]),(function(t){return"br"===At(t)?Ft(t).map((function(t){return[e].concat(Tf(t))})).getOr([]):[e].concat(Tf(t))}))},Ef=function(e,t){return Hn(function(e){var t=e.startContainer,n=e.startOffset;return Nn(t)?0===n?F.some(wt.fromDom(t)):F.none():F.from(t.childNodes[n]).map(wt.fromDom)}(t),function(e){var t=e.endContainer,n=e.endOffset;return Nn(t)?n===t.data.length?F.some(wt.fromDom(t)):F.none():F.from(t.childNodes[n-1]).map(wt.fromDom)}(t),(function(t,n){var r=Z(kf(e),N(kt,t)),o=Z(Tf(e),N(kt,n));return r.isSome()&&o.isSome()})).getOr(!1)},Af=function(e,t,n,r){var o=n,i=new Yr(n,o),a=be(e.schema.getMoveCaretBeforeOnEnterElements(),(function(e,t){return!W(["td","th","table"],t.toLowerCase())}));do{if(Nn(n)&&0!==bt.trim(n.nodeValue).length)return void(r?t.setStart(n,0):t.setEnd(n,n.nodeValue.length));if(a[n.nodeName])return void(r?t.setStartBefore(n):"BR"===n.nodeName?t.setEndBefore(n):t.setEndAfter(n))}while(n=r?i.next():i.prev());"BODY"===o.nodeName&&(r?t.setStart(o,0):t.setEnd(o,o.childNodes.length))},_f=function(e){var t=e.selection.getSel();return t&&t.rangeCount>0},Nf=function(e,t){var n=xf(e);n.length>0?$(n,(function(n){var r=n.dom,o=e.dom.createRng();o.setStartBefore(r),o.setEndAfter(r),t(o,!0)})):t(e.selection.getRng(),!1)},Rf=function(e,t,n){var r=Mu(e,t);n(r),e.moveToBookmark(r)},Df=function(e,t){var n=function(t){return e(t)?F.from(t.dom.nodeValue):F.none()};return{get:function(r){if(!e(r))throw new Error("Can only get "+t+" value of a "+t+" node");return n(r).getOr("")},getOption:n,set:function(n,r){if(!e(n))throw new Error("Can only set raw "+t+" value of a "+t+" node");n.dom.nodeValue=r}}}(Dt,"text"),Of=function(e){return Df.get(e)},If=function(e,t,n,r){return Lt(t).fold((function(){return"skipping"}),(function(o){return"br"===r||function(e){return Dt(e)&&"\ufeff"===Of(e)}(t)?"valid":function(e){return Rt(e)&&xc(e,Tc())}(t)?"existing":Ss(t.dom)?"caret":Ws(e,n,r)&&Ws(e,At(o),n)?"valid":"invalid-child"}))},Pf=function(e,t,n,r){var o=t.uid,i=void 0===o?Ic("mce-annotation"):o,a=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}(t,["uid"]),c=wt.fromTag("span",e);wc(c,Tc()),Wn(c,""+Ac(),i),Wn(c,""+Ec(),n);var u=r(i,a),l=u.attributes,s=void 0===l?{}:l,f=u.classes,d=void 0===f?[]:f;return Vn(c,s),function(e,t){$(t,(function(t){wc(e,t)}))}(c,d),c},Bf=function(e,t,n,r,o){var i=[],a=Pf(e.getDoc(),o,n,r),c=mc(),u=function(){c.clear()},l=function(e){$(e,s)},s=function(t){switch(If(e,t,"span",At(t))){case"invalid-child":u();var n=zt(t);l(n),u();break;case"valid":!function(e,t){en(e,t),rn(t,e)}(t,c.get().getOrThunk((function(){var e=Mc(a);return i.push(e),c.set(e),e})))}};return bf(e.dom,t,(function(e){u(),function(e){var t=q(e,wt.fromDom);l(t)}(e)})),i},Mf=function(e,t,n,r){e.undoManager.transact((function(){var o=e.selection,i=o.getRng(),a=xf(e).length>0;if(i.collapsed&&!a&&function(e,t){var n=vf(e,t,[{inline:"span"}]);t.setStart(n.startContainer,n.startOffset),t.setEnd(n.endContainer,n.endOffset),e.selection.setRng(t)}(e,i),o.getRng().collapsed&&!a){var c=Pf(e.getDoc(),r,t,n.decorate);Pc(c,""),o.getRng().insertNode(c.dom),o.select(c.dom)}else Rf(o,!1,(function(){Nf(e,(function(o){Bf(e,o,t,n.decorate,r)}))}))}))},Lf=function(e){var t,n=(t={},{register:function(e,n){t[e]={name:e,settings:n}},lookup:function(e){return we(t,e).map((function(e){return e.settings}))}});Dc(e,n);var r=Rc(e);return{register:function(e,t){n.register(e,t)},annotate:function(t,r){n.lookup(t).each((function(n){Mf(e,t,n,r)}))},annotationChanged:function(e,t){r.addListener(e,t)},remove:function(t){_c(e,F.some(t)).each((function(e){var t=e.elements;$(t,un)}))},getAll:function(t){var n=function(e,t){var n=wt.fromDom(e.getBody()),r=kc(n,"["+Ec()+'="'+t+'"]'),o={};return $(r,(function(e){var t=qn(e,Ac()),n=we(o,t).getOr([]);o[t]=n.concat([e])})),o}(e,t);return pe(n,(function(e){return q(e,(function(e){return e.dom}))}))}}},Ff=function(e){return{getBookmark:N(Is,e),moveToBookmark:N(Ps,e)}};Ff.isBookmarkNode=Bs;var jf=function(e,t){for(;t&&t!==e;){if(Bn(t)||Mn(t))return t;t=t.parentNode}return null},Hf=function(e,t,n){if(n.collapsed)return!1;if(mt.browser.isIE()&&n.startOffset===n.endOffset-1&&n.startContainer===n.endContainer){var r=n.startContainer.childNodes[n.startOffset];if(Cn(r))return V(r.getClientRects(),(function(n){return $c(n,e,t)}))}return V(n.getClientRects(),(function(n){return $c(n,e,t)}))},Uf=function(e,t,n){return e.fire(t,n)},zf=function(e,t,n,r){return e.fire("FormatApply",{format:t,node:n,vars:r})},Wf=function(e,t,n,r){return e.fire("FormatRemove",{format:t,node:n,vars:r})},Vf={BACKSPACE:8,DELETE:46,DOWN:40,ENTER:13,ESC:27,LEFT:37,RIGHT:39,SPACEBAR:32,TAB:9,UP:38,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,modifierPressed:function(e){return e.shiftKey||e.ctrlKey||e.altKey||Vf.metaKeyPressed(e)},metaKeyPressed:function(e){return mt.mac?e.metaKey:e.ctrlKey&&!e.altKey}},qf=Mn,$f=function(e,t){var n,r,o,i,a,c,u,l,s,f,d,m,p,g,h,v=t.dom,b=bt.each,y=t.getDoc(),C=document,x=Math.abs,S=Math.round,k=t.getBody(),T={nw:[0,0,-1,-1],ne:[1,0,1,-1],se:[1,1,1,1],sw:[0,1,-1,1]},E=function(e){return e&&("IMG"===e.nodeName||t.dom.is(e,"figure.image"))},A=function(e){return Fn(e)||v.hasClass(e,"mce-preview-object")},_=function(e){var n=e.target;(function(e,t){if("longpress"===e.type||0===e.type.indexOf("touch")){var n=e.touches[0];return E(e.target)&&!Hf(n.clientX,n.clientY,t)}return E(e.target)&&!Hf(e.clientX,e.clientY,t)})(e,t.selection.getRng())&&!e.isDefaultPrevented()&&t.selection.select(n)},N=function(e){return v.is(e,"figure.image")?[e.querySelector("img")]:v.hasClass(e,"mce-preview-object")&&w(e.firstElementChild)?[e,e.firstElementChild]:[e]},R=function(e){var n=nl(t);return!!n&&("false"!==e.getAttribute("data-mce-resize")&&(e!==t.getBody()&&(v.hasClass(e,"mce-preview-object")?xt(wt.fromDom(e.firstElementChild),n):xt(wt.fromDom(e),n))))},D=function(e,n,r){if(w(r)){var o=N(e);$(o,(function(e){e.style[n]||!t.schema.isValid(e.nodeName.toLowerCase(),n)?v.setStyle(e,n,r):v.setAttrib(e,n,""+r)}))}},O=function(e,t,n){D(e,"width",t),D(e,"height",n)},I=function(e){var a,b,y,w;a=e.screenX-c,b=e.screenY-u,m=a*i[2]+l,p=b*i[3]+s,m=m<5?5:m,p=p<5?5:p,((E(n)||A(n))&&!1!==function(e){return e.getParam("resize_img_proportional",!0,"boolean")}(t)?!Vf.modifierPressed(e):Vf.modifierPressed(e))&&(x(a)>x(b)?(p=S(m*f),m=S(p/f)):(m=S(p/f),p=S(m*f))),O(r,m,p),y=(y=i.startPos.x+a)>0?y:0,w=(w=i.startPos.y+b)>0?w:0,v.setStyles(o,{left:y,top:w,display:"block"}),o.innerHTML=m+" &times; "+p,i[2]<0&&r.clientWidth<=m&&v.setStyle(r,"left",void 0+(l-m)),i[3]<0&&r.clientHeight<=p&&v.setStyle(r,"top",void 0+(s-p)),(a=k.scrollWidth-g)+(b=k.scrollHeight-h)!==0&&v.setStyles(o,{left:y-a,top:w-b}),d||(!function(e,t,n,r,o){e.fire("ObjectResizeStart",{target:t,width:n,height:r,origin:o})}(t,n,l,s,"corner-"+i.name),d=!0)},P=function(){var e=d;d=!1,e&&(D(n,"width",m),D(n,"height",p)),v.unbind(y,"mousemove",I),v.unbind(y,"mouseup",P),C!==y&&(v.unbind(C,"mousemove",I),v.unbind(C,"mouseup",P)),v.remove(r),v.remove(o),v.remove(a),B(n),e&&(!function(e,t,n,r,o){e.fire("ObjectResized",{target:t,width:n,height:r,origin:o})}(t,n,m,p,"corner-"+i.name),v.setAttrib(n,"style",v.getAttrib(n,"style"))),t.nodeChanged()},B=function(e){j();var d=v.getPos(e,k),w=d.x,x=d.y,S=e.getBoundingClientRect(),E=S.width||S.right-S.left,_=S.height||S.bottom-S.top;n!==e&&(M(),n=e,m=p=0);var D=t.fire("ObjectSelected",{target:e}),B=v.getAttrib(n,"data-mce-selected","1");R(e)&&!D.isDefaultPrevented()?b(T,(function(e,t){var d,m=function(d){var m,p=N(n)[0];c=d.screenX,u=d.screenY,l=p.clientWidth,s=p.clientHeight,f=s/l,(i=e).name=t,i.startPos={x:E*e[0]+w,y:_*e[1]+x},g=k.scrollWidth,h=k.scrollHeight,a=v.add(k,"div",{class:"mce-resize-backdrop","data-mce-bogus":"all"}),v.setStyles(a,{position:"fixed",left:"0",top:"0",width:"100%",height:"100%"}),r=A(m=n)?v.create("img",{src:mt.transparentSrc}):m.cloneNode(!0),v.addClass(r,"mce-clonedresizable"),v.setAttrib(r,"data-mce-bogus","all"),r.contentEditable="false",v.setStyles(r,{left:w,top:x,margin:0}),O(r,E,_),r.removeAttribute("data-mce-selected"),k.appendChild(r),v.bind(y,"mousemove",I),v.bind(y,"mouseup",P),C!==y&&(v.bind(C,"mousemove",I),v.bind(C,"mouseup",P)),o=v.add(k,"div",{class:"mce-resize-helper","data-mce-bogus":"all"},l+" &times; "+s)};(d=v.get("mceResizeHandle"+t))&&v.remove(d),d=v.add(k,"div",{id:"mceResizeHandle"+t,"data-mce-bogus":"all",class:"mce-resizehandle",unselectable:!0,style:"cursor:"+t+"-resize; margin:0; padding:0"}),11===mt.ie&&(d.contentEditable=!1),v.bind(d,"mousedown",(function(e){e.stopImmediatePropagation(),e.preventDefault(),m(e)})),e.elm=d,v.setStyles(d,{left:E*e[0]+w-d.offsetWidth/2,top:_*e[1]+x-d.offsetHeight/2})})):M(),v.getAttrib(n,"data-mce-selected")||n.setAttribute("data-mce-selected",B)},M=function(){j(),n&&n.removeAttribute("data-mce-selected"),me(T,(function(e,t){var n=v.get("mceResizeHandle"+t);n&&(v.unbind(n),v.remove(n))}))},L=function(n){var r,o=function(e,t){if(e)do{if(e===t)return!0}while(e=e.parentNode)};d||t.removed||(b(v.select("img[data-mce-selected],hr[data-mce-selected]"),(function(e){e.removeAttribute("data-mce-selected")})),r="mousedown"===n.type?n.target:e.getNode(),o(r=v.$(r).closest("table,img,figure.image,hr,video,span.mce-preview-object")[0],k)&&(H(),o(e.getStart(!0),r)&&o(e.getEnd(!0),r))?B(r):M())},F=function(e){return qf(jf(t.getBody(),e))},j=function(){me(T,(function(e){e.elm&&(v.unbind(e.elm),delete e.elm)}))},H=function(){try{t.getDoc().execCommand("enableObjectResizing",!1,"false")}catch(e){}};t.on("init",(function(){if(H(),mt.browser.isIE()||mt.browser.isEdge()){t.on("mousedown click",(function(e){var n=e.target,r=n.nodeName;d||!/^(TABLE|IMG|HR)$/.test(r)||F(n)||(2!==e.button&&t.selection.select(n,"TABLE"===r),"mousedown"===e.type&&t.nodeChanged())}));var e=function(e){var n=function(e){Gr.setEditorTimeout(t,(function(){return t.selection.select(e)}))};if(F(e.target)||Fn(e.target))return e.preventDefault(),void n(e.target);/^(TABLE|IMG|HR)$/.test(e.target.nodeName)&&(e.preventDefault(),"IMG"===e.target.tagName&&n(e.target))};v.bind(k,"mscontrolselect",e),t.on("remove",(function(){return v.unbind(k,"mscontrolselect",e)}))}var r=Gr.throttle((function(e){t.composing||L(e)}));t.on("nodechange ResizeEditor ResizeWindow ResizeContent drop FullscreenStateChanged",r),t.on("keyup compositionend",(function(e){n&&"TABLE"===n.nodeName&&r(e)})),t.on("hide blur",M),t.on("contextmenu longpress",_,!0)})),t.on("remove",j);return{isResizable:R,showResizeRect:B,hideResizeRect:M,updateResizeRect:L,destroy:function(){n=r=a=null}}},Kf=function(e){return Bn(e)||Mn(e)},Gf=function(e,t,n){var r,o,i=n;if(i.caretPositionFromPoint)(o=i.caretPositionFromPoint(e,t))&&((r=n.createRange()).setStart(o.offsetNode,o.offset),r.collapse(!0));else if(i.caretRangeFromPoint)r=i.caretRangeFromPoint(e,t);else if(i.body.createTextRange){r=i.body.createTextRange();try{r.moveToPoint(e,t),r.collapse(!0)}catch(o){r=function(e,t,n){var r,o=n.elementFromPoint(e,t),i=n.body.createTextRange();if(o&&"HTML"!==o.tagName||(o=n.body),i.moveToElementText(o),(r=(r=bt.toArray(i.getClientRects())).sort((function(e,n){return(e=Math.abs(Math.max(e.top-t,e.bottom-t)))-(n=Math.abs(Math.max(n.top-t,n.bottom-t)))}))).length>0){t=(r[0].bottom+r[0].top)/2;try{return i.moveToPoint(e,t),i.collapse(!0),i}catch(e){}}return null}(e,t,n)}return function(e,t){var n=e&&e.parentElement?e.parentElement():null;return Mn(function(e,t,n){for(;e&&e!==t;){if(n(e))return e;e=e.parentNode}return null}(n,t,Kf))?null:e}(r,n.body)}return r},Jf=function(e,t){return e&&t&&e.startContainer===t.startContainer&&e.startOffset===t.startOffset&&e.endContainer===t.endContainer&&e.endOffset===t.endOffset},Xf=function(e,t,n){return null!==function(e,t,n){for(;e&&e!==t;){if(n(e))return e;e=e.parentNode}return null}(e,t,n)},Yf=function(e,t,n){return Xf(e,t,(function(e){return e.nodeName===n}))},Qf=function(e){return e&&"TABLE"===e.nodeName},Zf=function(e){return e&&/^(TD|TH|CAPTION)$/.test(e.nodeName)},ed=function(e,t){return ho(e)&&!1===Xf(e,t,Ss)},td=function(e,t,n){for(var r=new Yr(t,e.getParent(t.parentNode,e.isBlock)||e.getRoot());t=r[n?"prev":"next"]();)if(In(t))return!0},nd=function(e,t,n,r,o){var i,a,c=e.getRoot(),u=e.schema.getNonEmptyElements(),l=e.getParent(o.parentNode,e.isBlock)||c;if(r&&In(o)&&t&&e.isEmpty(l))return F.some(gu(o.parentNode,e.nodeIndex(o)));for(var s=new Yr(o,l);a=s[r?"prev":"next"]();){if("false"===e.getContentEditableParent(a)||ed(a,c))return F.none();if(Nn(a)&&a.nodeValue.length>0)return!1===Yf(a,c,"A")?F.some(gu(a,r?a.nodeValue.length:0)):F.none();if(e.isBlock(a)||u[a.nodeName.toLowerCase()])return F.none();i=a}return n&&i?F.some(gu(i,0)):F.none()},rd=function(e,t,n,r){var o,i,a,c,u=e.getRoot(),l=!1;o=r[(n?"start":"end")+"Container"],i=r[(n?"start":"end")+"Offset"];var s=Cn(o)&&i===o.childNodes.length,f=e.schema.getNonEmptyElements();if(c=n,ho(o))return F.none();if(Cn(o)&&i>o.childNodes.length-1&&(c=!1),Dn(o)&&(o=u,i=0),o===u){if(c&&(a=o.childNodes[i>0?i-1:0])){if(ho(a))return F.none();if(f[a.nodeName]||Qf(a))return F.none()}if(o.hasChildNodes()){if(i=Math.min(!c&&i>0?i-1:i,o.childNodes.length-1),o=o.childNodes[i],i=Nn(o)&&s?o.data.length:0,!t&&o===u.lastChild&&Qf(o))return F.none();if(function(e,t){for(;t&&t!==e;){if(Mn(t))return!0;t=t.parentNode}return!1}(u,o)||ho(o))return F.none();if(o.hasChildNodes()&&!1===Qf(o)){a=o;var d=new Yr(o,u);do{if(Mn(a)||ho(a)){l=!1;break}if(Nn(a)&&a.nodeValue.length>0){i=c?0:a.nodeValue.length,o=a,l=!0;break}if(f[a.nodeName.toLowerCase()]&&!Zf(a)){i=e.nodeIndex(a),o=a.parentNode,c||i++,l=!0;break}}while(a=c?d.next():d.prev())}}}return t&&(Nn(o)&&0===i&&nd(e,s,t,!0,o).each((function(e){o=e.container(),i=e.offset(),l=!0})),Cn(o)&&((a=o.childNodes[i])||(a=o.childNodes[i-1]),!a||!In(a)||function(e,t){return e.previousSibling&&e.previousSibling.nodeName===t}(a,"A")||td(e,a,!1)||td(e,a,!0)||nd(e,s,t,!0,a).each((function(e){o=e.container(),i=e.offset(),l=!0})))),c&&!t&&Nn(o)&&i===o.nodeValue.length&&nd(e,s,t,!1,o).each((function(e){o=e.container(),i=e.offset(),l=!0})),l?F.some(gu(o,i)):F.none()},od=function(e,t){var n=t.collapsed,r=t.cloneRange(),o=gu.fromRangeStart(t);return rd(e,n,!0,r).each((function(e){n&&gu.isAbove(o,e)||r.setStart(e.container(),e.offset())})),n||rd(e,n,!1,r).each((function(e){r.setEnd(e.container(),e.offset())})),n&&r.collapse(!0),Jf(t,r)?F.none():F.some(r)},id=function(e,t){return e.splitText(t)},ad=function(e){var t=e.startContainer,n=e.startOffset,r=e.endContainer,o=e.endOffset;return t===r&&Nn(t)?n>0&&n<t.nodeValue.length&&(t=(r=id(t,n)).previousSibling,o>n?(t=r=id(r,o-=n).previousSibling,o=r.nodeValue.length,n=0):o=0):(Nn(t)&&n>0&&n<t.nodeValue.length&&(t=id(t,n),n=0),Nn(r)&&o>0&&o<r.nodeValue.length&&(o=(r=id(r,o).previousSibling).nodeValue.length)),{startContainer:t,startOffset:n,endContainer:r,endOffset:o}},cd=function(e){return{walk:function(t,n){return bf(e,t,n)},split:ad,normalize:function(t){return od(e,t).fold(I,(function(e){return t.setStart(e.startContainer,e.startOffset),t.setEnd(e.endContainer,e.endOffset),!0}))}}};cd.compareRanges=Jf,cd.getCaretRangeFromPoint=Gf,cd.getSelectedNode=Kc,cd.getNode=Gc;var ud,ld=function(e,t){var n=function(n){var r=t(n);if(r<=0||null===r){var o=Jn(n,e);return parseFloat(o)||0}return r},r=function(e,t){return Y(t,(function(t,n){var r=Jn(e,n),o=void 0===r?0:parseInt(r,10);return isNaN(o)?t:t+o}),0)};return{set:function(t,n){if(!x(n)&&!n.match(/^[0-9]+$/))throw new Error(e+".set accepts only positive integer values. Value was "+n);var r=t.dom;Un(r)&&(r.style[e]=n+"px")},get:n,getOuter:n,aggregate:r,max:function(e,t,n){var o=r(e,n);return t>o?t-o:0}}}("height",(function(e){var t=e.dom;return ln(e)?t.getBoundingClientRect().height:t.offsetHeight})),sd=function(e,t){return e.view(t).fold(E([]),(function(t){var n=e.owner(t),r=sd(e,n);return[t].concat(r)}))},fd=Object.freeze({__proto__:null,view:function(e){var t;return(e.dom===document?F.none():F.from(null===(t=e.dom.defaultView)||void 0===t?void 0:t.frameElement)).map(wt.fromDom)},owner:function(e){return Bt(e)}}),dd=function(e){var t=wt.fromDom(document),n=pn(t),r=function(e,t){var n=t.owner(e);return sd(t,n)}(e,fd),o=mn(e),i=X(r,(function(e,t){var n=mn(t);return{left:e.left+n.left,top:e.top+n.top}}),{left:0,top:0});return fn(i.left+o.left+n.left,i.top+o.top+n.top)},md=function(e){return"textarea"===At(e)},pd=function(e,t){var n=function(e){var t=e.dom.ownerDocument,n=t.body,r=t.defaultView,o=t.documentElement;if(n===e.dom)return fn(n.offsetLeft,n.offsetTop);var i=dn(null==r?void 0:r.pageYOffset,o.scrollTop),a=dn(null==r?void 0:r.pageXOffset,o.scrollLeft),c=dn(o.clientTop,n.clientTop),u=dn(o.clientLeft,n.clientLeft);return mn(e).translate(a-u,i-c)}(e),r=function(e){return ld.get(e)}(e);return{element:e,bottom:n.top+r,height:r,pos:n,cleanup:t}},gd=function(e,t){var n=function(e,t){var n=zt(e);if(0===n.length||md(e))return{element:e,offset:t};if(t<n.length&&!md(n[t]))return{element:n[t],offset:0};var r=n[n.length-1];return md(r)?{element:e,offset:t}:"img"===At(r)?{element:r,offset:1}:Dt(r)?{element:r,offset:Of(r).length}:{element:r,offset:zt(r).length}}(e,t),r=wt.fromHtml('<span data-mce-bogus="all" style="display: inline-block;">\ufeff</span>');return en(n.element,r),pd(r,(function(){return cn(r)}))},hd=function(e,t,n,r){wd(e,(function(o,i){return bd(e,t,n,r)}),n)},vd=function(e,t,n,r,o){var i={elm:r.element.dom,alignToTop:o};(function(e,t){return e.fire("ScrollIntoView",t).isDefaultPrevented()})(e,i)||(n(t,pn(t).top,r,o),function(e,t){e.fire("AfterScrollIntoView",t)}(e,i))},bd=function(e,t,n,r){var o=wt.fromDom(e.getBody()),i=wt.fromDom(e.getDoc());o.dom.offsetWidth;var a=gd(wt.fromDom(n.startContainer),n.startOffset);vd(e,i,t,a,r),a.cleanup()},yd=function(e,t,n,r){var o=wt.fromDom(e.getDoc());vd(e,o,n,function(e){return pd(wt.fromDom(e),S)}(t),r)},wd=function(e,t,n){var r=n.startContainer,o=n.startOffset,i=n.endContainer,a=n.endOffset;t(wt.fromDom(r),wt.fromDom(i));var c=e.dom.createRng();c.setStart(r,o),c.setEnd(i,a),e.selection.setRng(n)},Cd=function(e,t,n,r){var o=e.pos;if(n)gn(o.left,o.top,r);else{var i=o.top-t+e.height;gn(o.left,i,r)}},xd=function(e,t,n,r,o){var i=n+t,a=r.pos.top,c=r.bottom,u=c-a>=n;if(a<t)Cd(r,n,!1!==o,e);else if(a>i){Cd(r,n,u?!1!==o:!0===o,e)}else c>i&&!u&&Cd(r,n,!0===o,e)},Sd=function(e,t,n,r){var o=e.dom.defaultView.innerHeight;xd(e,t,o,n,r)},kd=function(e,t,n,r){var o=e.dom.defaultView.innerHeight;xd(e,t,o,n,r);var i=dd(n.element),a=bn(window);i.top<a.y?hn(n.element,!1!==r):i.top>a.bottom&&hn(n.element,!0===r)},Td=function(e,t,n){return hd(e,Sd,t,n)},Ed=function(e,t,n){return yd(e,t,Sd,n)},Ad=function(e,t,n){return hd(e,kd,t,n)},_d=function(e,t,n){return yd(e,t,kd,n)},Nd=function(e,t,n){(e.inline?Td:Ad)(e,t,n)},Rd=function(e){var t=Xt(e).dom;return e.dom===t.activeElement},Dd=function(e){return void 0===e&&(e=wt.fromDom(document)),F.from(e.dom.activeElement).map(wt.fromDom)},Od=function(e,t,n,r){return{start:e,soffset:t,finish:n,foffset:r}},Id=gr([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),Pd=(Id.before,Id.on,Id.after,function(e){return e.fold(A,A,A)}),Bd=gr([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),Md={domRange:Bd.domRange,relative:Bd.relative,exact:Bd.exact,exactFromRange:function(e){return Bd.exact(e.start,e.soffset,e.finish,e.foffset)},getWin:function(e){var t=function(e){return e.match({domRange:function(e){return wt.fromDom(e.startContainer)},relative:function(e,t){return Pd(e)},exact:function(e,t,n,r){return e}})}(e);return Mt(t)},range:Od},Ld=ot().browser,Fd=function(e,t){var n=Dt(t)?Of(t).length:zt(t).length+1;return e>n?n:e<0?0:e},jd=function(e){return Md.range(e.start,Fd(e.soffset,e.start),e.finish,Fd(e.foffset,e.finish))},Hd=function(e,t){return!wn(t.dom)&&(Et(e,t)||kt(e,t))},Ud=function(e){return function(t){return Hd(e,t.start)&&Hd(e,t.finish)}},zd=function(e){return!0===e.inline||Ld.isIE()},Wd=function(e){return Md.range(wt.fromDom(e.startContainer),e.startOffset,wt.fromDom(e.endContainer),e.endOffset)},Vd=function(e){return function(e){var t=e.getSelection();return(t&&0!==t.rangeCount?F.from(t.getRangeAt(0)):F.none()).map(Wd)}(Mt(e).dom).filter(Ud(e))},qd=function(e){var t=document.createRange();try{return t.setStart(e.start.dom,e.soffset),t.setEnd(e.finish.dom,e.foffset),F.some(t)}catch(e){return F.none()}},$d=function(e){var t=zd(e)?Vd(wt.fromDom(e.getBody())):F.none();e.bookmark=t.isSome()?t:e.bookmark},Kd=function(e){return(e.bookmark?e.bookmark:F.none()).bind((function(t){return function(e,t){return F.from(t).filter(Ud(e)).map(jd)}(wt.fromDom(e.getBody()),t)})).bind(qd)},Gd={isEditorUIElement:function(e){var t=e.className.toString();return-1!==t.indexOf("tox-")||-1!==t.indexOf("mce-")}},Jd=function(e,t){ot().browser.isIE()?function(e){e.on("focusout",(function(){$d(e)}))}(e):function(e,t){e.on("mouseup touchend",(function(e){t.throttle()}))}(e,t),e.on("keyup NodeChange",(function(t){(function(e){return"nodechange"===e.type&&e.selectionChange})(t)||$d(e)}))},Xd=function(e){var t=pc((function(){$d(e)}),0);e.on("init",(function(){e.inline&&function(e,t){var n=function(){t.throttle()};nc.DOM.bind(document,"mouseup",n),e.on("remove",(function(){nc.DOM.unbind(document,"mouseup",n)}))}(e,t),Jd(e,t)})),e.on("remove",(function(){t.cancel()}))},Yd=nc.DOM,Qd=function(e,t){var n=function(e){return e.getParam("custom_ui_selector","","string")}(e);return null!==Yd.getParent(t,(function(t){return function(e){return Gd.isEditorUIElement(e)}(t)||!!n&&e.dom.is(t,n)}))},Zd=function(e,t){var n=t.editor;Xd(n),n.on("focusin",(function(){var t=e.focusedEditor;t!==n&&(t&&t.fire("blur",{focusedEditor:n}),e.setActive(n),e.focusedEditor=n,n.fire("focus",{blurredEditor:t}),n.focus(!0))})),n.on("focusout",(function(){Gr.setEditorTimeout(n,(function(){var t=e.focusedEditor;Qd(n,function(e){try{var t=Xt(wt.fromDom(e.getElement()));return Dd(t).fold((function(){return document.body}),(function(e){return e.dom}))}catch(e){return document.body}}(n))||t!==n||(n.fire("blur",{focusedEditor:null}),e.focusedEditor=null)}))})),ud||(ud=function(t){var n=e.activeEditor;n&&function(e){if(Jt()&&w(e.target)){var t=wt.fromDom(e.target);if(Rt(t)&&Zt(t)&&e.composed&&e.composedPath){var n=e.composedPath();if(n)return ce(n)}}return F.from(e.target)}(t).each((function(t){t.ownerDocument===document&&(t===document.body||Qd(n,t)||e.focusedEditor!==n||(n.fire("blur",{focusedEditor:null}),e.focusedEditor=null))}))},Yd.bind(document,"focusin",ud))},em=function(e,t){e.focusedEditor===t.editor&&(e.focusedEditor=null),e.activeEditor||(Yd.unbind(document,"focusin",ud),ud=null)},tm=function(e,t){return function(e){return e.collapsed?F.from(Gc(e.startContainer,e.startOffset)).map(wt.fromDom):F.none()}(t).bind((function(t){return ao(t)?F.some(t):!1===Et(e,t)?F.some(e):F.none()}))},nm=function(e,t){tm(wt.fromDom(e.getBody()),t).bind((function(e){return Cs(e.dom)})).fold((function(){e.selection.normalize()}),(function(t){return e.selection.setRng(t.toRange())}))},rm=function(e){if(e.setActive)try{e.setActive()}catch(t){e.focus()}else e.focus()},om=function(e){return Rd(e)||(t=e,Dd(Xt(t)).filter((function(e){return t.dom.contains(e.dom)}))).isSome();var t},im=function(e){return e.inline?function(e){var t=e.getBody();return t&&om(wt.fromDom(t))}(e):function(e){return e.iframeElement&&Rd(wt.fromDom(e.iframeElement))}(e)},am=function(e){return im(e)||function(e){var t=Xt(wt.fromDom(e.getElement()));return Dd(t).filter((function(t){return n=t.dom,!(void 0!==(r=n.classList)&&(r.contains("tox-edit-area")||r.contains("tox-edit-area__iframe")||r.contains("mce-content-body")))&&Qd(e,t.dom);var n,r})).isSome()}(e)},cm=function(e){return e.editorManager.setActive(e)},um=function(e,t){e.removed||(t?cm(e):function(e){var t=e.selection,n=e.getBody(),r=t.getRng();e.quirks.refreshContentEditable(),void 0!==e.bookmark&&!1===im(e)&&Kd(e).each((function(t){e.selection.setRng(t),r=t}));var o=function(e,t){return e.dom.getParent(t,(function(t){return"true"===e.dom.getContentEditable(t)}))}(e,t.getNode());if(e.$.contains(n,o))return rm(o),nm(e,r),void cm(e);e.inline||(mt.opera||rm(n),e.getWin().focus()),(mt.gecko||e.inline)&&(rm(n),nm(e,r)),cm(e)}(e))},lm=function(e,t,n,r,o){var i=n?t.startContainer:t.endContainer,a=n?t.startOffset:t.endOffset;return F.from(i).map(wt.fromDom).map((function(e){return r&&t.collapsed?e:Wt(e,o(e,a)).getOr(e)})).bind((function(e){return Rt(e)?F.some(e):Lt(e).filter(Rt)})).map((function(e){return e.dom})).getOr(e)},sm=function(e,t,n){return lm(e,t,!0,n,(function(e,t){return Math.min($t(e),t)}))},fm=function(e,t,n){return lm(e,t,!1,n,(function(e,t){return t>0?t-1:t}))},dm=function(e,t){for(var n=e;e&&Nn(e)&&0===e.length;)e=t?e.nextSibling:e.previousSibling;return e||n},mm=function(e,t){return q(t,(function(t){var n=e.fire("GetSelectionRange",{range:t});return n.range!==t?n.range:t}))},pm={"#text":3,"#comment":8,"#cdata":4,"#pi":7,"#doctype":10,"#document-fragment":11},gm=function(e,t,n){var r=n?"lastChild":"firstChild",o=n?"prev":"next";if(e[r])return e[r];if(e!==t){var i=e[o];if(i)return i;for(var a=e.parent;a&&a!==t;a=a.parent)if(i=a[o])return i}},hm=function(e){if(!Lo(e.value))return!1;var t=e.parent;return!t||"span"===t.name&&!t.attr("style")||!/^[ ]+$/.test(e.value)},vm=function(e){var t="a"===e.name&&!e.attr("href")&&e.attr("id");return e.attr("name")||e.attr("id")&&!e.firstChild||e.attr("data-mce-bookmark")||t},bm=function(){function e(e,t){this.name=e,this.type=t,1===t&&(this.attributes=[],this.attributes.map={})}return e.create=function(t,n){var r=new e(t,pm[t]||1);return n&&me(n,(function(e,t){r.attr(t,e)})),r},e.prototype.replace=function(e){return e.parent&&e.remove(),this.insert(e,this),this.remove(),this},e.prototype.attr=function(e,t){var n,r=this;if("string"!=typeof e)return null!=e&&me(e,(function(e,t){r.attr(t,e)})),r;if(n=r.attributes){if(void 0!==t){if(null===t){if(e in n.map){delete n.map[e];for(var o=n.length;o--;)if(n[o].name===e)return n.splice(o,1),r}return r}if(e in n.map){for(o=n.length;o--;)if(n[o].name===e){n[o].value=t;break}}else n.push({name:e,value:t});return n.map[e]=t,r}return n.map[e]}},e.prototype.clone=function(){var t,n=new e(this.name,this.type);if(t=this.attributes){var r=[];r.map={};for(var o=0,i=t.length;o<i;o++){var a=t[o];"id"!==a.name&&(r[r.length]={name:a.name,value:a.value},r.map[a.name]=a.value)}n.attributes=r}return n.value=this.value,n.shortEnded=this.shortEnded,n},e.prototype.wrap=function(e){return this.parent.insert(e,this),e.append(this),this},e.prototype.unwrap=function(){for(var e=this.firstChild;e;){var t=e.next;this.insert(e,this,!0),e=t}this.remove()},e.prototype.remove=function(){var e=this.parent,t=this.next,n=this.prev;return e&&(e.firstChild===this?(e.firstChild=t,t&&(t.prev=null)):n.next=t,e.lastChild===this?(e.lastChild=n,n&&(n.next=null)):t.prev=n,this.parent=this.next=this.prev=null),this},e.prototype.append=function(e){e.parent&&e.remove();var t=this.lastChild;return t?(t.next=e,e.prev=t,this.lastChild=e):this.lastChild=this.firstChild=e,e.parent=this,e},e.prototype.insert=function(e,t,n){e.parent&&e.remove();var r=t.parent||this;return n?(t===r.firstChild?r.firstChild=e:t.prev.next=e,e.prev=t.prev,e.next=t,t.prev=e):(t===r.lastChild?r.lastChild=e:t.next.prev=e,e.next=t.next,e.prev=t,t.next=e),e.parent=r,e},e.prototype.getAll=function(e){for(var t=[],n=this.firstChild;n;n=gm(n,this))n.name===e&&t.push(n);return t},e.prototype.children=function(){for(var e=[],t=this.firstChild;t;t=t.next)e.push(t);return e},e.prototype.empty=function(){if(this.firstChild){for(var e=[],t=this.firstChild;t;t=gm(t,this))e.push(t);for(var n=e.length;n--;){(t=e[n]).parent=t.firstChild=t.lastChild=t.next=t.prev=null}}return this.firstChild=this.lastChild=null,this},e.prototype.isEmpty=function(e,t,n){void 0===t&&(t={});var r=this.firstChild;if(vm(this))return!1;if(r)do{if(1===r.type){if(r.attr("data-mce-bogus"))continue;if(e[r.name])return!1;if(vm(r))return!1}if(8===r.type)return!1;if(3===r.type&&!hm(r))return!1;if(3===r.type&&r.parent&&t[r.parent.name]&&Lo(r.value))return!1;if(n&&n(r))return!1}while(r=gm(r,this));return!0},e.prototype.walk=function(e){return gm(this,null,e)},e}(),ym=function(e,t){return e.replace(t.re,(function(e){return we(t.uris,e).getOr(e)}))},wm=bt.each,Cm=bt.trim,xm="source protocol authority userInfo user password host port relative path directory file query anchor".split(" "),Sm={ftp:21,http:80,https:443,mailto:25},km=["img","video"],Tm=function(e,t,n){return!e.allow_html_data_urls&&(/^data:image\//i.test(t)?function(e,t){return w(e)?!e:!w(t)||!W(km,t)}(e.allow_svg_data_urls,n)&&/^data:image\/svg\+xml/i.test(t):/^data:/i.test(t))},Em=function(){function e(t,n){t=Cm(t),this.settings=n||{};var r=this.settings.base_uri,o=this;if(/^([\w\-]+):([^\/]{2})/i.test(t)||/^\s*#/.test(t))o.source=t;else{var i=0===t.indexOf("//");if(0!==t.indexOf("/")||i||(t=(r&&r.protocol||"http")+"://mce_host"+t),!/^[\w\-]*:?\/\//.test(t)){var a=this.settings.base_uri?this.settings.base_uri.path:new e(document.location.href).directory;if(this.settings.base_uri&&""==this.settings.base_uri.protocol)t="//mce_host"+o.toAbsPath(a,t);else{var c=/([^#?]*)([#?]?.*)/.exec(t);t=(r&&r.protocol||"http")+"://mce_host"+o.toAbsPath(a,c[1])+c[2]}}t=t.replace(/@@/g,"(mce_at)");var u=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@\/]*):?([^:@\/]*))?@)?(\[[a-zA-Z0-9:.%]+\]|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/.exec(t);wm(xm,(function(e,t){var n=u[t];n&&(n=n.replace(/\(mce_at\)/g,"@@")),o[e]=n})),r&&(o.protocol||(o.protocol=r.protocol),o.userInfo||(o.userInfo=r.userInfo),o.port||"mce_host"!==o.host||(o.port=r.port),o.host&&"mce_host"!==o.host||(o.host=r.host),o.source=""),i&&(o.protocol="")}}return e.parseDataUri=function(e){var t,n=decodeURIComponent(e).split(","),r=/data:([^;]+)/.exec(n[0]);return r&&(t=r[1]),{type:t,data:n[1]}},e.isDomSafe=function(e,t,n){if(void 0===n&&(n={}),n.allow_script_urls)return!0;var r=ci.decode(e).replace(/[\s\u0000-\u001F]+/g,"");try{r=decodeURIComponent(r)}catch(e){r=unescape(r)}return!/((java|vb)script|mhtml):/i.test(r)&&!Tm(n,r,t)},e.getDocumentBaseUrl=function(e){var t;return t=0!==e.protocol.indexOf("http")&&"file:"!==e.protocol?e.href:e.protocol+"//"+e.host+e.pathname,/^[^:]+:\/\/\/?[^\/]+\//.test(t)&&(t=t.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,""),/[\/\\]$/.test(t)||(t+="/")),t},e.prototype.setPath=function(e){var t=/^(.*?)\/?(\w+)?$/.exec(e);this.path=t[0],this.directory=t[1],this.file=t[2],this.source="",this.getURI()},e.prototype.toRelative=function(t){var n;if("./"===t)return t;var r=new e(t,{base_uri:this});if("mce_host"!==r.host&&this.host!==r.host&&r.host||this.port!==r.port||this.protocol!==r.protocol&&""!==r.protocol)return r.getURI();var o=this.getURI(),i=r.getURI();return o===i||"/"===o.charAt(o.length-1)&&o.substr(0,o.length-1)===i?o:(n=this.toRelPath(this.path,r.path),r.query&&(n+="?"+r.query),r.anchor&&(n+="#"+r.anchor),n)},e.prototype.toAbsolute=function(t,n){var r=new e(t,{base_uri:this});return r.getURI(n&&this.isSameOrigin(r))},e.prototype.isSameOrigin=function(e){if(this.host==e.host&&this.protocol==e.protocol){if(this.port==e.port)return!0;var t=Sm[this.protocol];if(t&&(this.port||t)==(e.port||t))return!0}return!1},e.prototype.toRelPath=function(e,t){var n,r,o=0,i="",a=e.substring(0,e.lastIndexOf("/")).split("/"),c=t.split("/");if(a.length>=c.length)for(n=0,r=a.length;n<r;n++)if(n>=c.length||a[n]!==c[n]){o=n+1;break}if(a.length<c.length)for(n=0,r=c.length;n<r;n++)if(n>=a.length||a[n]!==c[n]){o=n+1;break}if(1===o)return t;for(n=0,r=a.length-(o-1);n<r;n++)i+="../";for(n=o-1,r=c.length;n<r;n++)i+=n!==o-1?"/"+c[n]:c[n];return i},e.prototype.toAbsPath=function(e,t){var n,r,o=0,i=[],a=/\/$/.test(t)?"/":"",c=e.split("/"),u=t.split("/");for(wm(c,(function(e){e&&i.push(e)})),c=i,n=u.length-1,i=[];n>=0;n--)0!==u[n].length&&"."!==u[n]&&(".."!==u[n]?o>0?o--:i.push(u[n]):o++);return 0!==(r=(n=c.length-o)<=0?re(i).join("/"):c.slice(0,n).join("/")+"/"+re(i).join("/")).indexOf("/")&&(r="/"+r),a&&r.lastIndexOf("/")!==r.length-1&&(r+=a),r},e.prototype.getURI=function(e){var t;return void 0===e&&(e=!1),this.source&&!e||(t="",e||(this.protocol?t+=this.protocol+"://":t+="//",this.userInfo&&(t+=this.userInfo+"@"),this.host&&(t+=this.host),this.port&&(t+=":"+this.port)),this.path&&(t+=this.path),this.query&&(t+="?"+this.query),this.anchor&&(t+="#"+this.anchor),this.source=t),this.source},e}(),Am=bt.makeMap("button,fieldset,form,iframe,img,image,input,object,output,select,textarea"),_m=function(e,t,n){for(var r=/<([!?\/])?([A-Za-z0-9\-_:.]+)/g,o=/(?:\s(?:[^'">]+(?:"[^"]*"|'[^']*'))*[^"'>]*(?:"[^">]*|'[^'>]*)?|\s*|\/)>/g,i=e.getShortEndedElements(),a=1,c=n;0!==a;)for(r.lastIndex=c;;){var u=r.exec(t);if(null===u)return c;if("!"===u[1]){c=je(u[2],"--")?Nm(t,!1,u.index+"!--".length):Nm(t,!0,u.index+1);break}o.lastIndex=r.lastIndex;var l=o.exec(t);if(!h(l)&&l.index===r.lastIndex){"/"===u[1]?a-=1:Ce(i,u[2])||(a+=1),c=r.lastIndex+l[0].length;break}}return c},Nm=function(e,t,n){void 0===n&&(n=0);var r=e.toLowerCase();if(-1!==r.indexOf("[if ",n)&&function(e,t){return/^\s*\[if [\w\W]+\]>.*<!\[endif\](--!?)?>/.test(e.substr(t))}(r,n)){var o=r.indexOf("[endif]",n);return r.indexOf(">",o)}if(t){var i=r.indexOf(">",n);return-1!==i?i:r.length}var a=/--!?>/g;a.lastIndex=n;var c=a.exec(e);return c?c.index+c[0].length:r.length},Rm=function(e,t){var n=e.exec(t);if(n){var r=n[1],o=n[2];return"string"==typeof r&&"data-mce-bogus"===r.toLowerCase()?o:null}return null},Dm=function(e,t){var n;void 0===t&&(t=vi());var r=null!==(n=(e=e||{}).document)&&void 0!==n?n:document,o=r.createElement("form");!1!==e.fix_self_closing&&(e.fix_self_closing=!0);var i=e.comment?e.comment:S,a=e.cdata?e.cdata:S,c=e.text?e.text:S,u=e.start?e.start:S,l=e.end?e.end:S,s=e.pi?e.pi:S,f=e.doctype?e.doctype:S,d=function(n,d){void 0===d&&(d="html");for(var m,p,g,h,v,b,y,w,C,x,S,k,T,E,A,_,N,R,D,O=n.html,I=0,P=[],B=0,M=ci.decode,L=bt.makeMap("src,href,data,background,action,formaction,poster,xlink:href"),F="html"===d?0:1,j=function(e){var t,n;for(t=P.length;t--&&P[t].name!==e;);if(t>=0){for(n=P.length-1;n>=t;n--)(e=P[n]).valid&&l(e.name);P.length=t}},H=function(e,t){return c(ym(e,n),t)},U=function(t){""!==t&&(">"===t.charAt(0)&&(t=" "+t),e.allow_conditional_comments||"[if"!==t.substr(0,3).toLowerCase()||(t=" "+t),i(ym(t,n)))},z=function(e,t){var n=e||"",r=!je(n,"--"),o=Nm(O,r,t);return e=O.substr(t,o-t),U(r?n+e:e),o+1},W=function(t,i,a,c,u){if(a=function(e){return ym(e,n)}((i=i.toLowerCase())in G?i:M(a||c||u||"")),J&&!w&&!1===function(e){return 0===e.indexOf("data-")||0===e.indexOf("aria-")}(i)){var l=E[i];if(!l&&A){for(var s=A.length;s--&&!(l=A[s]).pattern.test(i););-1===s&&(l=null)}if(!l)return;if(l.validValues&&!(a in l.validValues))return}("name"===i||"id"===i)&&t in Am&&(a in r||a in o)||L[i]&&!Em.isDomSafe(a,t,e)||w&&(i in L||0===i.indexOf("on"))||(h.map[i]=a,h.push({name:i,value:a}))},V=new RegExp("<(?:(?:!--([\\w\\W]*?)--!?>)|(?:!\\[CDATA\\[([\\w\\W]*?)\\]\\]>)|(?:![Dd][Oo][Cc][Tt][Yy][Pp][Ee]([\\w\\W]*?)>)|(?:!(--)?)|(?:\\?([^\\s\\/<>]+) ?([\\w\\W]*?)[?/]>)|(?:\\/([A-Za-z][A-Za-z0-9\\-_\\:\\.]*)>)|(?:([A-Za-z][A-Za-z0-9\\-_:.]*)(\\s(?:[^'\">]+(?:\"[^\"]*\"|'[^']*'))*[^\"'>]*(?:\"[^\">]*|'[^'>]*)?|\\s*|\\/)>))","g"),q=/([\w:\-]+)(?:\s*=\s*(?:(?:\"((?:[^\"])*)\")|(?:\'((?:[^\'])*)\')|([^>\s]+)))?/g,$=t.getShortEndedElements(),K=e.self_closing_elements||t.getSelfClosingElements(),G=t.getBoolAttrs(),J=e.validate,X=e.remove_internals,Y=e.fix_self_closing,Q=t.getSpecialElements(),Z=O+">";m=V.exec(Z);){var ee=m[0];if(I<m.index&&H(M(O.substr(I,m.index-I))),p=m[7])":"===(p=p.toLowerCase()).charAt(0)&&(p=p.substr(1)),j(p);else if(p=m[8]){if(m.index+ee.length>O.length){H(M(O.substr(m.index))),I=m.index+ee.length;continue}":"===(p=p.toLowerCase()).charAt(0)&&(p=p.substr(1)),C=p in $,Y&&K[p]&&P.length>0&&P[P.length-1].name===p&&j(p);var te=Rm(q,m[9]);if(null!==te){if("all"===te){I=_m(t,O,V.lastIndex),V.lastIndex=I;continue}S=!1}if(!J||(x=t.getElementRule(p))){if(S=!0,J&&(E=x.attributes,A=x.attributePatterns),(T=m[9])?((w=-1!==T.indexOf("data-mce-type"))&&X&&(S=!1),(h=[]).map={},T.replace(q,(function(e,t,n,r,o){return W(p,t,n,r,o),""}))):(h=[]).map={},J&&!w){if(_=x.attributesRequired,N=x.attributesDefault,R=x.attributesForced,x.removeEmptyAttrs&&!h.length&&(S=!1),R)for(v=R.length;v--;)y=(k=R[v]).name,"{$uid}"===(D=k.value)&&(D="mce_"+B++),h.map[y]=D,h.push({name:y,value:D});if(N)for(v=N.length;v--;)(y=(k=N[v]).name)in h.map||("{$uid}"===(D=k.value)&&(D="mce_"+B++),h.map[y]=D,h.push({name:y,value:D}));if(_){for(v=_.length;v--&&!(_[v]in h.map););-1===v&&(S=!1)}if(k=h.map["data-mce-bogus"]){if("all"===k){I=_m(t,O,V.lastIndex),V.lastIndex=I;continue}S=!1}}S&&u(p,h,C)}else S=!1;if(g=Q[p]){g.lastIndex=I=m.index+ee.length,(m=g.exec(O))?(S&&(b=O.substr(I,m.index-I)),I=m.index+m[0].length):(b=O.substr(I),I=O.length),S&&(b.length>0&&H(b,!0),l(p)),V.lastIndex=I;continue}C||(T&&T.indexOf("/")===T.length-1?S&&l(p):P.push({name:p,valid:S}))}else if(p=m[1])U(p);else if(p=m[2]){if(!(1===F||e.preserve_cdata||P.length>0&&t.isValidChild(P[P.length-1].name,"#cdata"))){I=z("",m.index+2),V.lastIndex=I;continue}a(p)}else if(p=m[3])f(p);else{if((p=m[4])||"<!"===ee){I=z(p,m.index+ee.length),V.lastIndex=I;continue}if(p=m[5]){if(1!==F){I=z("?",m.index+2),V.lastIndex=I;continue}s(p,m[6])}}I=m.index+ee.length}for(I<O.length&&H(M(O.substr(I))),v=P.length-1;v>=0;v--)(p=P[v]).valid&&l(p.name)};return{parse:function(e,t){void 0===t&&(t="html"),d(function(e){for(var t,n=/data:[^;]+;base64,([a-z0-9\+\/=\s]+)/gi,r=[],o={},i=Ic("img"),a=0,c=0;t=n.exec(e);){var u=t[0],l=i+"_"+c++;o[l]=u,a<t.index&&r.push(e.substr(a,t.index-a)),r.push(l),a=t.index+u.length}var s=new RegExp(i+"_[0-9]+","g");return 0===a?{prefix:i,uris:o,html:e,re:s}:(a<e.length&&r.push(e.substr(a)),{prefix:i,uris:o,html:r.join(""),re:s})}(e),t)}}};Dm.findEndTag=_m;var Om=function(e,t){for(var n,r=/<(\w+) [^>]*data-mce-bogus="all"[^>]*>/g,o=e.schema,i=function(e,t){var n=new RegExp(["\\s?("+e.join("|")+')="[^"]+"'].join("|"),"gi");return t.replace(n,"")}(e.getTempAttrs(),t),a=o.getShortEndedElements();n=r.exec(i);){var c=r.lastIndex,u=n[0].length,l=void 0;l=a[n[1]]?c:Dm.findEndTag(o,i,c),i=i.substring(0,c-u)+i.substring(l),r.lastIndex=c-u}return so(i)},Im=Om,Pm=function(e,t,n,r){var o,i=function(e,t){return De(De({},e),{format:t,get:!0,getInner:!0})}(t,n),a=t.no_events?i:e.fire("BeforeGetContent",i);return o="raw"===a.format?bt.trim(Im(e.serializer,r.innerHTML)):"text"===a.format?e.dom.isEmpty(r)?"":so(r.innerText||r.textContent):"tree"===a.format?e.serializer.serialize(r,a):function(e,t){var n=zu(e),r=new RegExp("^(<"+n+"[^>]*>(&nbsp;|&#160;|\\s||<br \\/>|)<\\/"+n+">[\r\n]*|<br \\/>[\r\n]*)$");return t.replace(r,"")}(e,e.serializer.serialize(r,a)),W(["text","tree"],a.format)||uo(wt.fromDom(r))?a.content=o:a.content=bt.trim(o),a.no_events?a.content:e.fire("GetContent",a).content},Bm=bt.each,Mm=function(e){return{compare:function(t,n){if(t.nodeName!==n.nodeName)return!1;var r=function(t){var n={};return Bm(e.getAttribs(t),(function(r){var o=r.nodeName.toLowerCase();0!==o.indexOf("_")&&"style"!==o&&0!==o.indexOf("data-")&&(n[o]=e.getAttrib(t,o))})),n},o=function(e,t){var n,r;for(r in e)if(Ce(e,r)){if(void 0===(n=t[r]))return!1;if(e[r]!==n)return!1;delete t[r]}for(r in t)if(Ce(t,r))return!1;return!0};return!!o(r(t),r(n))&&(!!o(e.parseStyle(e.getAttrib(t,"style")),e.parseStyle(e.getAttrib(n,"style")))&&(!Bs(t)&&!Bs(n)))}}},Lm=bt.makeMap,Fm=function(e){var t=[],n=(e=e||{}).indent,r=Lm(e.indent_before||""),o=Lm(e.indent_after||""),i=ci.getEncodeFunc(e.entity_encoding||"raw",e.entities),a="html"===e.element_format;return{start:function(e,c,u){var l,s,f,d;if(n&&r[e]&&t.length>0&&(d=t[t.length-1]).length>0&&"\n"!==d&&t.push("\n"),t.push("<",e),c)for(l=0,s=c.length;l<s;l++)f=c[l],t.push(" ",f.name,'="',i(f.value,!0),'"');t[t.length]=!u||a?">":" />",u&&n&&o[e]&&t.length>0&&(d=t[t.length-1]).length>0&&"\n"!==d&&t.push("\n")},end:function(e){var r;t.push("</",e,">"),n&&o[e]&&t.length>0&&(r=t[t.length-1]).length>0&&"\n"!==r&&t.push("\n")},text:function(e,n){e.length>0&&(t[t.length]=n?e:i(e))},cdata:function(e){t.push("<![CDATA[",e,"]]>")},comment:function(e){t.push("\x3c!--",e,"--\x3e")},pi:function(e,r){r?t.push("<?",e," ",i(r),"?>"):t.push("<?",e,"?>"),n&&t.push("\n")},doctype:function(e){t.push("<!DOCTYPE",e,">",n?"\n":"")},reset:function(){t.length=0},getContent:function(){return t.join("").replace(/\n$/,"")}}},jm=function(e,t){void 0===t&&(t=vi());var n=Fm(e);(e=e||{}).validate=!("validate"in e)||e.validate;return{serialize:function(r){var o=e.validate,i={3:function(e){n.text(e.value,e.raw)},8:function(e){n.comment(e.value)},7:function(e){n.pi(e.name,e.value)},10:function(e){n.doctype(e.value)},4:function(e){n.cdata(e.value)},11:function(e){if(e=e.firstChild)do{a(e)}while(e=e.next)}};n.reset();var a=function(e){var r=i[e.type];if(r)r(e);else{var c=e.name,u=e.shortEnded,l=e.attributes;if(o&&l&&l.length>1){var s=[];s.map={};var f=t.getElementRule(e.name);if(f){for(var d=0,m=f.attributesOrder.length;d<m;d++){if((g=f.attributesOrder[d])in l.map){var p=l.map[g];s.map[g]=p,s.push({name:g,value:p})}}for(d=0,m=l.length;d<m;d++){var g;if(!((g=l[d].name)in s.map)){p=l.map[g];s.map[g]=p,s.push({name:g,value:p})}}l=s}}if(n.start(e.name,l,u),!u){if(e=e.firstChild)do{a(e)}while(e=e.next);n.end(c)}}};return 1!==r.type||e.inner?i[11](r):a(r),n.getContent()}}},Hm=new Set;$(["margin","margin-left","margin-right","margin-top","margin-bottom","padding","padding-left","padding-right","padding-top","padding-bottom","border","border-width","border-style","border-color","background","background-attachment","background-clip","background-color","background-image","background-origin","background-position","background-repeat","background-size","float","position","left","right","top","bottom","z-index","display","transform","width","max-width","min-width","height","max-height","min-height","overflow","overflow-x","overflow-y","text-overflow","vertical-align","transition","transition-delay","transition-duration","transition-property","transition-timing-function"],(function(e){Hm.add(e)}));var Um=["font","text-decoration","text-emphasis"],zm=function(e,t){return fe(e.parseStyle(e.getAttrib(t,"style")))},Wm=function(e,t){return ne(zm(e,t),(function(e){return!function(e){return Hm.has(e)}(e)}))},Vm=function(e,t,n){var r=zm(e,t),o=zm(e,n),i=function(r){var o=e.getStyle(t,r),i=e.getStyle(n,r);return Ve(o)&&Ve(i)&&o!==i};return V(r,(function(e){var t=function(t){return V(t,(function(t){return t===e}))};if(!t(o)&&t(Um)){var n=J(o,(function(e){return V(Um,(function(t){return je(e,t)}))}));return V(n,i)}return i(e)}))},qm=function(e,t,n){return F.from(n.container()).filter(Nn).exists((function(r){var o=e?0:-1;return t(r.data.charAt(n.offset()+o))}))},$m=N(qm,!0,Ls),Km=N(qm,!1,Ls),Gm=function(e){var t=e.container();return Nn(t)&&(0===t.data.length||lo(t.data)&&Ff.isBookmarkNode(t.parentNode))},Jm=function(e,t){return function(n){return F.from(Ul(e?0:-1,n)).filter(t).isSome()}},Xm=function(e){return Pn(e)&&"block"===Jn(wt.fromDom(e),"display")},Ym=function(e){return Mn(e)&&!function(e){return Cn(e)&&"all"===e.getAttribute("data-mce-bogus")}(e)},Qm=Jm(!0,Xm),Zm=Jm(!1,Xm),ep=Jm(!0,Fn),tp=Jm(!1,Fn),np=Jm(!0,En),rp=Jm(!1,En),op=Jm(!0,Ym),ip=Jm(!1,Ym),ap=function(e){var t=kc(e,"br"),n=J(function(e){for(var t=[],n=e.dom;n;)t.push(wt.fromDom(n)),n=n.lastChild;return t}(e).slice(-1),no);t.length===n.length&&$(n,cn)},cp=function(e){an(e),rn(e,wt.fromHtml('<br data-mce-bogus="1">'))},up=function(e){qt(e).each((function(t){Ft(t).each((function(n){eo(e)&&no(t)&&eo(n)&&cn(t)}))}))},lp=function(e,t,n){return Et(t,e)?function(e,t){for(var n=C(t)?t:I,r=e.dom,o=[];null!==r.parentNode&&void 0!==r.parentNode;){var i=r.parentNode,a=wt.fromDom(i);if(o.push(a),!0===n(a))break;r=i}return o}(e,(function(e){return n(e)||kt(e,t)})).slice(0,-1):[]},sp=function(e,t){return lp(e,t,I)},fp=function(e,t){return[e].concat(sp(e,t))},dp=function(e,t,n){return vs(e,t,n,Gm)},mp=function(e,t){return Z(fp(wt.fromDom(t.container()),e),eo)},pp=function(e,t,n){return dp(e,t.dom,n).forall((function(e){return mp(t,n).fold((function(){return!1===Hl(e,n,t.dom)}),(function(r){return!1===Hl(e,n,t.dom)&&Et(r,wt.fromDom(e.container()))}))}))},gp=function(e,t,n){return mp(t,n).fold((function(){return dp(e,t.dom,n).forall((function(e){return!1===Hl(e,n,t.dom)}))}),(function(t){return dp(e,t.dom,n).isNone()}))},hp=N(gp,!1),vp=N(gp,!0),bp=N(pp,!1),yp=N(pp,!0),wp=function(e){return Xl(e).exists(no)},Cp=function(e,t,n){var r=J(fp(wt.fromDom(n.container()),t),eo),o=ce(r).getOr(t);return gs(e,o.dom,n).filter(wp)},xp=function(e,t){return Xl(t).exists(no)||Cp(!0,e,t).isSome()},Sp=function(e,t){return function(e){return F.from(e.getNode(!0)).map(wt.fromDom)}(t).exists(no)||Cp(!1,e,t).isSome()},kp=N(Cp,!1),Tp=N(Cp,!0),Ep=function(e){return gu.isTextPosition(e)&&!e.isAtStart()&&!e.isAtEnd()},Ap=function(e,t){var n=J(fp(wt.fromDom(t.container()),e),eo);return ce(n).getOr(e)},_p=function(e,t){return Ep(t)?Km(t):Km(t)||ws(Ap(e,t).dom,t).exists(Km)},Np=function(e,t){return Ep(t)?$m(t):$m(t)||ys(Ap(e,t).dom,t).exists($m)},Rp=function(e){return Xl(e).bind((function(e){return jr(e,Rt)})).exists((function(e){return function(e){return W(["pre","pre-wrap"],e)}(Jn(e,"white-space"))}))},Dp=function(e,t){return function(e,t){return ws(e.dom,t).isNone()}(e,t)||function(e,t){return ys(e.dom,t).isNone()}(e,t)||hp(e,t)||vp(e,t)||Sp(e,t)||xp(e,t)},Op=function(e,t){return!Rp(t)&&(hp(e,t)||bp(e,t)||Sp(e,t)||_p(e,t))},Ip=function(e,t){return!Rp(t)&&(vp(e,t)||yp(e,t)||xp(e,t)||Np(e,t))},Pp=function(e,t){return Op(e,t)||Ip(e,function(e){var t=e.container(),n=e.offset();return Nn(t)&&n<t.data.length?gu(t,n+1):e}(t))},Bp=function(e,t){return Ms(e.charAt(t))},Mp=function(e){var t=e.container();return Nn(t)&&Fe(t.data,"")},Lp=function(e){var t=e.data,n=function(e){var t=e.split("");return q(t,(function(e,n){return Ms(e)&&n>0&&n<t.length-1&&Fs(t[n-1])&&Fs(t[n+1])?" ":e})).join("")}(t);return n!==t&&(e.data=n,!0)},Fp=function(e,t){return F.some(t).filter(Mp).bind((function(t){var n=t.container();return function(e,t){var n=t.data,r=gu(t,0);return!(!Bp(n,0)||Pp(e,r))&&(t.data=" "+n.slice(1),!0)}(e,n)||Lp(n)||function(e,t){var n=t.data,r=gu(t,n.length-1);return!(!Bp(n,n.length-1)||Pp(e,r))&&(t.data=n.slice(0,-1)+" ",!0)}(e,n)?F.some(t):F.none()}))},jp=function(e){var t=wt.fromDom(e.getBody());e.selection.isCollapsed()&&Fp(t,gu.fromRangeStart(e.selection.getRng())).each((function(t){e.selection.setRng(t.toRange())}))},Hp=function(e,t,n){if(0!==n){var r=wt.fromDom(e),o=Fr(r,eo).getOr(r),i=e.data.slice(t,t+n),a=t+n>=e.data.length&&Ip(o,gu(e,e.data.length)),c=0===t&&Op(o,gu(e,0));e.replaceData(t,n,function(e,t,n){return Y(e,(function(r,o){return Ls(o)||Ms(o)?r.previousCharIsSpace||""===r.str&&t||r.str.length===e.length-1&&n?{previousCharIsSpace:!1,str:r.str+""}:{previousCharIsSpace:!0,str:r.str+" "}:{previousCharIsSpace:!1,str:r.str+o}}),{previousCharIsSpace:!1,str:""}).str}(i,c,a))}},Up=function(e,t){var n=e.data.slice(t),r=n.length-ze(n).length;Hp(e,t,r)},zp=function(e,t){var n=e.data.slice(0,t),r=n.length-We(n).length;Hp(e,t-r,r)},Wp=function(e,t,n,r){void 0===r&&(r=!0);var o=We(e.data).length,i=r?e:t,a=r?t:e;return r?i.appendData(a.data):i.insertData(0,a.data),cn(wt.fromDom(a)),n&&Up(i,o),i},Vp=function(e,t){return function(e,t){var n=e.container(),r=e.offset();return!1===gu.isTextPosition(e)&&n===t.parentNode&&r>gu.before(t).offset()}(t,e)?gu(t.container(),t.offset()-1):t},qp=function(e){return Io(e.previousSibling)?F.some((t=e.previousSibling,Nn(t)?gu(t,t.data.length):gu.after(t))):e.previousSibling?xs(e.previousSibling):F.none();var t},$p=function(e){return Io(e.nextSibling)?F.some((t=e.nextSibling,Nn(t)?gu(t,0):gu.before(t))):e.nextSibling?Cs(e.nextSibling):F.none();var t},Kp=function(e,t){return qp(t).orThunk((function(){return $p(t)})).orThunk((function(){return function(e,t){var n=gu.before(t.previousSibling?t.previousSibling:t.parentNode);return ws(e,n).fold((function(){return ys(e,gu.after(t))}),F.some)}(e,t)}))},Gp=function(e,t){return $p(t).orThunk((function(){return qp(t)})).orThunk((function(){return function(e,t){return ys(e,gu.after(t)).fold((function(){return ws(e,gu.before(t))}),F.some)}(e,t)}))},Jp=function(e,t,n){return function(e,t,n){return e?Gp(t,n):Kp(t,n)}(e,t,n).map(N(Vp,n))},Xp=function(e,t,n){n.fold((function(){e.focus()}),(function(n){e.selection.setRng(n.toRange(),t)}))},Yp=function(e,t){return t&&Ce(e.schema.getBlockElements(),At(t))},Qp=function(e){if(Wo(e)){var t=wt.fromHtml('<br data-mce-bogus="1">');return an(e),rn(e,t),F.some(gu.before(t.dom))}return F.none()},Zp=function(e,t,n){var r,o,i,a,c=Ft(e).filter(Dt),u=jt(e).filter(Dt);return cn(e),(r=c,o=u,i=t,a=function(e,t,r){var o=e.dom,i=t.dom,a=o.data.length;return Wp(o,i,n),r.container()===i?gu(o,a):r},r.isSome()&&o.isSome()&&i.isSome()?F.some(a(r.getOrDie(),o.getOrDie(),i.getOrDie())):F.none()).orThunk((function(){return n&&(c.each((function(e){return zp(e.dom,e.dom.length)})),u.each((function(e){return Up(e.dom,0)}))),t}))},eg=function(e,t,n,r){void 0===r&&(r=!0);var o,i=Jp(t,e.getBody(),n.dom),a=Fr(n,N(Yp,e),(o=e.getBody(),function(e){return e.dom===o})),c=Zp(n,i,function(e,t){return Ce(e.schema.getTextInlineElements(),At(t))}(e,n));e.dom.isEmpty(e.getBody())?(e.setContent(""),e.selection.setCursorLocation()):a.bind(Qp).fold((function(){r&&Xp(e,t,c)}),(function(n){r&&Xp(e,t,F.some(n))}))},tg=function(e){return kc(e,"td,th")},ng=function(e,t){return{start:e,end:t}},rg=gr([{singleCellTable:["rng","cell"]},{fullTable:["table"]},{partialTable:["cells","outsideDetails"]},{multiTable:["startTableCells","endTableCells","betweenRng"]}]),og=function(e,t){return Wr(wt.fromDom(e),"td,th",t)},ig=function(e){return!kt(e.start,e.end)},ag=function(e,t){return Sf(e.start,t).bind((function(n){return Sf(e.end,t).bind((function(e){return t=kt(n,e),r=n,t?F.some(r):F.none();var t,r}))}))},cg=function(e){return function(t){return ag(t,e).map((function(e){return function(e,t,n){return{rng:e,table:t,cells:n}}(t,e,tg(e))}))}},ug=function(e,t,n,r){if(n.collapsed||!e.forall(ig))return F.none();if(t.isSameTable){var o=e.bind(cg(r));return F.some({start:o,end:o})}var i=og(n.startContainer,r),a=og(n.endContainer,r),c=i.bind(function(e){return function(t){return Sf(t,e).bind((function(e){return ue(tg(e)).map((function(e){return ng(t,e)}))}))}}(r)).bind(cg(r)),u=a.bind(function(e){return function(t){return Sf(t,e).bind((function(e){return ce(tg(e)).map((function(e){return ng(e,t)}))}))}}(r)).bind(cg(r));return F.some({start:c,end:u})},lg=function(e,t){return ee(e,(function(e){return kt(e,t)}))},sg=function(e){return Hn(lg(e.cells,e.rng.start),lg(e.cells,e.rng.end),(function(t,n){return e.cells.slice(t,n+1)}))},fg=function(e,t,n){return e.exists((function(e){return function(e,t){return!ig(e)&&ag(e,t).exists((function(e){var t=e.dom.rows;return 1===t.length&&1===t[0].cells.length}))}(e,n)&&Ef(e.start,t)}))},dg=function(e,t){var n=t.startTable,r=t.endTable,o=e.cloneRange();return n.each((function(e){return o.setStartAfter(e.dom)})),r.each((function(e){return o.setEndBefore(e.dom)})),o},mg=function(e,t){var n=function(e){return function(t){return kt(e,t)}}(e),r=function(e,t){var n=og(e.startContainer,t),r=og(e.endContainer,t);return Hn(n,r,ng)}(t,n),o=function(e,t){var n=function(e){return Sf(wt.fromDom(e),t)},r=n(e.startContainer),o=n(e.endContainer),i=r.isSome(),a=o.isSome(),c=Hn(r,o,kt).getOr(!1);return{startTable:r,endTable:o,isStartInTable:i,isEndInTable:a,isSameTable:c,isMultiTable:!c&&i&&a}}(t,n);return fg(r,t,n)?r.map((function(e){return rg.singleCellTable(t,e.start)})):o.isMultiTable?function(e,t,n,r){return ug(e,t,n,r).bind((function(e){var r=e.start,o=e.end,i=r.bind(sg).getOr([]),a=o.bind(sg).getOr([]);if(i.length>0&&a.length>0){var c=dg(n,t);return F.some(rg.multiTable(i,a,c))}return F.none()}))}(r,o,t,n):function(e,t,n,r){return ug(e,t,n,r).bind((function(e){var t=e.start,n=e.end;return t.or(n)})).bind((function(e){var r=t.isSameTable,o=sg(e).getOr([]);if(r&&e.cells.length===o.length)return F.some(rg.fullTable(e.table));if(o.length>0){if(r)return F.some(rg.partialTable(o,F.none()));var i=dg(n,t);return F.some(rg.partialTable(o,F.some(De(De({},t),{rng:i}))))}return F.none()}))}(r,o,t,n)},pg=function(e){var t;return(8===_t(t=e)||"#comment"===At(t)?Ft(e):qt(e)).bind(pg).orThunk((function(){return F.some(e)}))},gg=function(e){return $(e,(function(e){Kn(e,"contenteditable"),cp(e)}))},hg=function(e,t,n,r){var o=n.cloneRange();r?(o.setStart(n.startContainer,n.startOffset),o.setEndAfter(t.dom.lastChild)):(o.setStartBefore(t.dom.firstChild),o.setEnd(n.endContainer,n.endOffset)),wg(e,o,t,!1)},vg=function(e){var t=xf(e),n=wt.fromDom(e.selection.getNode());Ln(n.dom)&&Wo(n)?e.selection.setCursorLocation(n.dom,0):e.selection.collapse(!0),t.length>1&&V(t,(function(e){return kt(e,n)}))&&Wn(n,"data-mce-selected","1")},bg=function(e,t,n){var r=e.selection.getRng(),o=n.bind((function(n){var o=n.rng,i=n.isStartInTable,a=function(e,t){return F.from(e.dom.getParent(t,e.dom.isBlock)).map(wt.fromDom)}(e,i?o.endContainer:o.startContainer);o.deleteContents(),function(e,t,n){n.each((function(n){t?cn(n):(cp(n),e.selection.setCursorLocation(n.dom,0))}))}(e,i,a.filter(Wo));var c=i?t[0]:t[t.length-1];return hg(e,c,r,i),Wo(c)?F.none():F.some(i?t.slice(1):t.slice(0,-1))})).getOr(t);return gg(o),vg(e),!0},yg=function(e,t,n,r){var o=e.selection.getRng(),i=t[0],a=n[n.length-1];hg(e,i,o,!0),hg(e,a,o,!1);var c=Wo(i)?t:t.slice(1),u=Wo(a)?n:n.slice(0,-1);return gg(c.concat(u)),r.deleteContents(),vg(e),!0},wg=function(e,t,n,r){void 0===r&&(r=!0),t.deleteContents();var o,i=pg(n).getOr(n),a=wt.fromDom(e.dom.getParent(i.dom,e.dom.isBlock));if(Wo(a)&&(cp(a),r&&e.selection.setCursorLocation(a.dom,0)),!kt(n,a)){var c=jn(Lt(a),n)?[]:Lt(o=a).map(zt).map((function(e){return J(e,(function(e){return!kt(o,e)}))})).getOr([]);$(c.concat(zt(n)),(function(e){kt(e,a)||Et(e,a)||!Wo(e)||cn(e)}))}return!0},Cg=function(e,t){return eg(e,!1,t),!0},xg=function(e,t,n,r){return kg(t,r).fold((function(){return function(e,t,n){return mg(t,n).map((function(t){return t.fold(N(wg,e),N(Cg,e),N(bg,e),N(yg,e))}))}(e,t,n)}),(function(t){return function(e,t){return Tg(e,t)}(e,t)})).getOr(!1)},Sg=function(e,t){return Z(fp(t,e),co)},kg=function(e,t){return Z(fp(t,e),(n="caption",function(e){return Rt(e)&&At(e)===n}));var n},Tg=function(e,t){return cp(t),e.selection.setCursorLocation(t.dom,0),F.some(!0)},Eg=function(e,t,n,r,o){return hs(n,e.getBody(),o).bind((function(i){return function(e,t,n,r){return Cs(e.dom).bind((function(o){return xs(e.dom).map((function(e){return t?n.isEqual(o)&&r.isEqual(e):n.isEqual(e)&&r.isEqual(o)}))})).getOr(!0)}(r,n,o,i)?function(e,t){return Tg(e,t)}(e,r):function(e,t,n){return kg(e,wt.fromDom(n.getNode())).map((function(e){return!1===kt(e,t)}))}(t,r,i)})).or(F.some(!0))},Ag=function(e,t,n,r){var o=gu.fromRangeStart(e.selection.getRng());return Sg(n,r).bind((function(r){return Wo(r)?Tg(e,r):function(e,t,n,r,o){return hs(n,e.getBody(),o).bind((function(e){return Sg(t,wt.fromDom(e.getNode())).map((function(e){return!1===kt(e,r)}))}))}(e,n,t,r,o)})).getOr(!1)},_g=function(e,t){return e?np(t):rp(t)},Ng=function(e,t,n){var r=wt.fromDom(e.getBody());return kg(r,n).fold((function(){return Ag(e,t,r,n)||function(e,t){var n=gu.fromRangeStart(e.selection.getRng());return _g(t,n)||gs(t,e.getBody(),n).exists((function(e){return _g(t,e)}))}(e,t)}),(function(n){return function(e,t,n,r){var o=gu.fromRangeStart(e.selection.getRng());return Wo(r)?Tg(e,r):Eg(e,n,t,r,o)}(e,t,r,n).getOr(!1)}))},Rg=function(e,t){var n=wt.fromDom(e.selection.getStart(!0)),r=xf(e);return e.selection.isCollapsed()&&0===r.length?Ng(e,t,n):function(e,t,n){var r=wt.fromDom(e.getBody()),o=e.selection.getRng();return 0!==n.length?bg(e,n,F.none()):xg(e,r,o,t)}(e,n,r)},Dg=function(e){var t=gu.fromRangeStart(e),n=gu.fromRangeEnd(e),r=e.commonAncestorContainer;return gs(!1,r,n).map((function(o){return!Hl(t,n,r)&&Hl(t,o,r)?function(e,t,n,r){var o=document.createRange();return o.setStart(e,t),o.setEnd(n,r),o}(t.container(),t.offset(),o.container(),o.offset()):e})).getOr(e)},Og=function(e){return e.collapsed?e:Dg(e)},Ig=function(e){return e&&e.firstChild&&e.firstChild===e.lastChild&&function(e){return""===e.data||In(e)}(e.firstChild)},Pg=function(e){return e.length>0&&(!(t=e[e.length-1]).firstChild||Ig(t))?e.slice(0,-1):e;var t},Bg=function(e,t){var n=e.getParent(t,e.isBlock);return n&&"LI"===n.nodeName?n:null},Mg=function(e,t){var n=gu.after(e),r=ss(t).prev(n);return r?r.toRange():null},Lg=function(e,t,n){var r=e.parentNode;return bt.each(t,(function(t){r.insertBefore(t,e)})),function(e,t){var n=gu.before(e),r=ss(t).next(n);return r?r.toRange():null}(e,n)},Fg=function(e,t,n,r){var o,i=function(e,t,n){var r=t.serialize(n);return function(e){var t=e.firstChild,n=e.lastChild;return t&&"META"===t.nodeName&&t.parentNode.removeChild(t),n&&"mce_marker"===n.id&&n.parentNode.removeChild(n),e}(e.createFragment(r))}(t,e,r),a=Bg(t,n.startContainer),c=Pg((o=i.firstChild,J(o.childNodes,(function(e){return"LI"===e.nodeName})))),u=t.getRoot(),l=function(e){var r=gu.fromRangeStart(n),o=ss(t.getRoot()),i=1===e?o.prev(r):o.next(r);return!i||Bg(t,i.getNode())!==a};return l(1)?Lg(a,c,u):l(2)?function(e,t,n,r){return r.insertAfter(t.reverse(),e),Mg(t[0],n)}(a,c,u,t):function(e,t,n,r){var o=function(e,t){var n=t.cloneRange(),r=t.cloneRange();return n.setStartBefore(e),r.setEndAfter(e),[n.cloneContents(),r.cloneContents()]}(e,r),i=e.parentNode;return i.insertBefore(o[0],e),bt.each(t,(function(t){i.insertBefore(t,e)})),i.insertBefore(o[1],e),i.removeChild(e),Mg(t[t.length-1],n)}(a,c,u,n)},jg=Ln,Hg=function(e){var t=e.dom,n=Og(e.selection.getRng());e.selection.setRng(n);var r=t.getParent(n.startContainer,jg);!function(e,t,n){return null!==n&&(n===e.getParent(t.endContainer,jg)&&Ef(wt.fromDom(n),t))}(t,n,r)?e.getDoc().execCommand("Delete",!1,null):wg(e,n,wt.fromDom(r))},Ug=function(e,t,n){var r,o,i,a=e.selection,c=e.dom;/^ | $/.test(t)&&(t=function(e,t,n){var r=wt.fromDom(e.getRoot());return n=Op(r,gu.fromRangeStart(t))?n.replace(/^ /,"&nbsp;"):n.replace(/^&nbsp;/," "),n=Ip(r,gu.fromRangeEnd(t))?n.replace(/(&nbsp;| )(<br( \/)>)?$/,"&nbsp;"):n.replace(/&nbsp;(<br( \/)?>)?$/," ")}(c,a.getRng(),t));var u=e.parser,l=n.merge,s=jm({validate:il(e)},e.schema),f='<span id="mce_marker" data-mce-type="bookmark">&#xFEFF;</span>',d=e.fire("BeforeSetContent",{content:t,format:"html",selection:!0,paste:n.paste});if(d.isDefaultPrevented())e.fire("SetContent",{content:d.content,format:"html",selection:!0,paste:n.paste});else{-1===(t=d.content).indexOf("{$caret}")&&(t+="{$caret}"),t=t.replace(/\{\$caret\}/,f);var m=(o=a.getRng()).startContainer||(o.parentElement?o.parentElement():null),p=e.getBody();m===p&&a.isCollapsed()&&c.isBlock(p.firstChild)&&function(e,t){return t&&!e.schema.getShortEndedElements()[t.nodeName]}(e,p.firstChild)&&c.isEmpty(p.firstChild)&&((o=c.createRng()).setStart(p.firstChild,0),o.setEnd(p.firstChild,0),a.setRng(o)),a.isCollapsed()||Hg(e);var g,h={context:(r=a.getNode()).nodeName.toLowerCase(),data:n.data,insert:!0},v=u.parse(t,h);if(!0===n.paste&&function(e,t){var n=t.firstChild,r=t.lastChild;return n&&"meta"===n.name&&(n=n.next),r&&"mce_marker"===r.attr("id")&&(r=r.prev),function(e,t){var n=e.getNonEmptyElements();return t&&(t.isEmpty(n)||function(e,t){return e.getBlockElements()[t.name]&&function(e){return e.firstChild&&e.firstChild===e.lastChild}(t)&&function(e){return"br"===e.name||""===e.value}(t.firstChild)}(e,t))}(e,r)&&(r=r.prev),!(!n||n!==r)&&("ul"===n.name||"ol"===n.name)}(e.schema,v)&&function(e,t){return!!Bg(e,t)}(c,r))return o=Fg(s,c,a.getRng(),v),a.setRng(o),void e.fire("SetContent",d);if(function(e){for(var t=e;t=t.walk();)1===t.type&&t.attr("data-mce-fragment","1")}(v),"mce_marker"===(i=v.lastChild).attr("id")){var b=i;for(i=i.prev;i;i=i.walk(!0))if(3===i.type||!c.isBlock(i.name)){e.schema.isValidChild(i.parent.name,"span")&&i.parent.insert(b,i,"br"===i.name);break}}if(e._selectionOverrides.showBlockCaretContainer(r),h.invalid){e.selection.setContent(f),r=a.getNode();var y=e.getBody();for(9===r.nodeType?r=i=y:i=r;i!==y;)r=i,i=i.parentNode;t=r===y?y.innerHTML:c.getOuterHTML(r),t=s.serialize(u.parse(t.replace(/<span (id="mce_marker"|id=mce_marker).+?<\/span>/i,(function(){return s.serialize(v)})))),r===y?c.setHTML(y,t):c.setOuterHTML(r,t)}else!function(e,t,n){if("all"===n.getAttribute("data-mce-bogus"))n.parentNode.insertBefore(e.dom.createFragment(t),n);else{var r=n.firstChild,o=n.lastChild;!r||r===o&&"BR"===r.nodeName?e.dom.setHTML(n,t):e.selection.setContent(t)}}(e,t=s.serialize(v),r);!function(e,t){var n=e.schema.getTextInlineElements(),r=e.dom;if(t){var o=e.getBody(),i=Mm(r);bt.each(r.select("*[data-mce-fragment]"),(function(e){if(w(n[e.nodeName.toLowerCase()])&&Wm(r,e))for(var t=e.parentNode;w(t)&&t!==o;t=t.parentNode){if(Vm(r,e,t))break;if(i.compare(t,e)){r.remove(e,!0);break}}}))}}(e,l),function(e,t){var n,r=e.dom,o=e.selection;if(t){o.scrollIntoView(t);var i=jf(e.getBody(),t);if("false"===r.getContentEditable(i))return r.remove(t),void o.select(i);var a=r.createRng(),c=t.previousSibling;if(Nn(c)){if(a.setStart(c,c.nodeValue.length),!mt.ie){var u=t.nextSibling;Nn(u)&&(c.appendData(u.data),u.parentNode.removeChild(u))}}else a.setStartBefore(t),a.setEndBefore(t);var l=r.getParent(t,r.isBlock);r.remove(t),l&&r.isEmpty(l)&&(e.$(l).empty(),a.setStart(l,0),a.setEnd(l,0),jg(l)||function(e){return!!e.getAttribute("data-mce-fragment")}(l)||!(n=function(t){var n=gu.fromRangeStart(t);if(n=ss(e.getBody()).next(n))return n.toRange()}(a))?r.add(l,r.create("br",{"data-mce-bogus":"1"})):(a=n,r.remove(l))),o.setRng(a)}}(e,c.get("mce_marker")),g=e.getBody(),bt.each(g.getElementsByTagName("*"),(function(e){e.removeAttribute("data-mce-fragment")})),function(e,t){F.from(e.getParent(t,"td,th")).map(wt.fromDom).each(up)}(c,a.getStart()),e.fire("SetContent",d),e.addVisual()}},zg=function(e,t){t(e),e.firstChild&&zg(e.firstChild,t),e.next&&zg(e.next,t)},Wg=function(e,t,n){var r=function(e,t,n){var r={},o={},i=[];for(var a in n.firstChild&&zg(n.firstChild,(function(n){$(e,(function(e){e.name===n.name&&(r[e.name]?r[e.name].nodes.push(n):r[e.name]={filter:e,nodes:[n]})})),$(t,(function(e){"string"==typeof n.attr(e.name)&&(o[e.name]?o[e.name].nodes.push(n):o[e.name]={filter:e,nodes:[n]})}))})),r)Ce(r,a)&&i.push(r[a]);for(var c in o)Ce(o,c)&&i.push(o[c]);return i}(e,t,n);$(r,(function(e){$(e.filter.callbacks,(function(t){t(e.nodes,e.filter.name,{})}))}))},Vg=function(e){return e instanceof bm},qg=function(e,t,n){e.dom.setHTML(e.getBody(),t),!0!==n&&function(e){im(e)&&Cs(e.getBody()).each((function(t){var n=t.getNode(),r=En(n)?Cs(n).getOr(t):t;e.selection.setRng(r.toRange())}))}(e)},$g=function(e,t,n){var r=function(e,t){return De(De({format:"html"},e),{set:!0,content:Vg(t)?"":t})}(n,t),o=n.no_events?r:e.fire("BeforeSetContent",r);return Vg(t)||(t=o.content),F.from(e.getBody()).fold(E(t),(function(n){return Vg(t)?function(e,t,n,r){Wg(e.parser.getNodeFilters(),e.parser.getAttributeFilters(),n);var o=jm({validate:e.validate},e.schema).serialize(n);return r.content=uo(wt.fromDom(t))?o:bt.trim(o),qg(e,r.content,r.no_selection),r.no_events||e.fire("SetContent",r),n}(e,n,t,o):function(e,t,n,r){if(0===n.length||/^\s+$/.test(n)){var o='<br data-mce-bogus="1">';"TABLE"===t.nodeName?n="<tr><td>"+o+"</td></tr>":/^(UL|OL)$/.test(t.nodeName)&&(n="<li>"+o+"</li>");var i=zu(e);i&&e.schema.isValidChild(t.nodeName.toLowerCase(),i.toLowerCase())?(n=o,n=e.dom.createHTML(i,Wu(e),n)):n||(n='<br data-mce-bogus="1">'),qg(e,n,r.no_selection),e.fire("SetContent",r)}else"raw"!==r.format&&(n=jm({validate:e.validate},e.schema).serialize(e.parser.parse(n,{isRootContent:!0,insert:!0}))),r.content=uo(wt.fromDom(t))?n:bt.trim(n),qg(e,r.content,r.no_selection),r.no_events||e.fire("SetContent",r);return r.content}(e,n,t,o)}))},Kg=function(e,t){return function(e,t){var n=e.dom;return n.parentNode?Hr(wt.fromDom(n.parentNode),(function(n){return!kt(e,n)&&t(n)})):F.none()}(e,t).isSome()},Gg=function(e){return C(e)?e:I},Jg=function(e,t,n){var r=t(e),o=Gg(n);return r.orThunk((function(){return o(e)?F.none():function(e,t,n){for(var r=e.dom,o=Gg(n);r.parentNode;){r=r.parentNode;var i=wt.fromDom(r),a=t(i);if(a.isSome())return a;if(o(i))break}return F.none()}(e,t,o)}))},Xg=$s,Yg=function(e,t,n){var r=e.formatter.get(n);if(r)for(var o=0;o<r.length;o++){var i=r[o];if(Zs(i)&&!1===i.inherit&&e.dom.is(t,i.selector))return!0}return!1},Qg=function(e,t,n,r,o){var i=e.dom.getRoot();return t!==i&&(t=e.dom.getParent(t,(function(t){return!!Yg(e,t,n)||(t.parentNode===i||!!th(e,t,n,r,!0))})),!!th(e,t,n,r,o))},Zg=function(e,t,n){return!!Xg(t,n.inline)||(!!Xg(t,n.block)||(n.selector?1===t.nodeType&&e.is(t,n.selector):void 0))},eh=function(e,t,n,r,o,i){var a=n[r];if(C(n.onmatch))return n.onmatch(t,n,r);if(a)if(b(a.length)){for(var c in a)if(Ce(a,c)){var u="attributes"===r?e.getAttrib(t,c):Gs(e,t,c),l=qs(a[c],i),s=y(u)||qe(u);if(s&&y(l))continue;if(o&&s&&!n.exact)return!1;if((!o||n.exact)&&!Xg(u,Ks(e,l,c)))return!1}}else for(var f=0;f<a.length;f++)if("attributes"===r?e.getAttrib(t,a[f]):Gs(e,t,a[f]))return!0;return!0},th=function(e,t,n,r,o){var i=e.formatter.get(n),a=e.dom;if(i&&t)for(var c=0;c<i.length;c++){var u=i[c];if(Zg(e.dom,t,u)&&eh(a,t,u,"attributes",o,r)&&eh(a,t,u,"styles",o,r)){var l=u.classes;if(l)for(var s=0;s<l.length;s++)if(!e.dom.hasClass(t,qs(l[s],r)))return;return u}}},nh=function(e,t,n,r,o){if(r)return Qg(e,r,t,n,o);if(r=e.selection.getNode(),Qg(e,r,t,n,o))return!0;var i=e.selection.getStart();return!(i===r||!Qg(e,i,t,n,o))},rh=function(e,t){var n=function(t){return kt(t,wt.fromDom(e.getBody()))};return F.from(e.selection.getStart(!0)).bind((function(r){return Jg(wt.fromDom(r),(function(n){return se(t,(function(t){return function(t,n){return th(e,t.dom,n)?F.some(n):F.none()}(n,t)}))}),n)})).getOrNull()},oh=function(e,t,n){return Y(n,(function(n,r){var o=function(e,t){return V(e.formatter.get(t),(function(e){var t=function(e){return e.length>1&&"%"===e.charAt(0)};return V(["styles","attributes"],(function(n){return we(e,n).exists((function(e){var n=g(e)?e:ye(e);return V(n,t)}))}))}))}(e,r);return e.formatter.matchNode(t,r,{},o)?n.concat([r]):n}),[])},ih=function(e){return function(e){for(var t=[];e;){if(3===e.nodeType&&"\ufeff"!==e.nodeValue||e.childNodes.length>1)return[];1===e.nodeType&&t.push(e),e=e.firstChild}return t}(e).length>0},ah=function(e){if(e){var t=new Yr(e,e);for(e=t.current();e;e=t.next())if(Nn(e))return e}return null},ch=function(e){var t=wt.fromTag("span");return Vn(t,{id:"_mce_caret","data-mce-bogus":"1","data-mce-type":"format-caret"}),e&&rn(t,wt.fromText("\ufeff")),t},uh=function(e,t,n){void 0===n&&(n=!0);var r=e.dom,o=e.selection;if(ih(t))eg(e,!1,wt.fromDom(t),n);else{var i=o.getRng(),a=r.getParent(t,r.isBlock),c=i.startContainer,u=i.startOffset,l=i.endContainer,s=i.endOffset,f=function(e){var t=ah(e);return t&&"\ufeff"===t.nodeValue.charAt(0)&&t.deleteData(0,1),t}(t);r.remove(t,!0),c===f&&u>0&&i.setStart(f,u-1),l===f&&s>0&&i.setEnd(f,s-1),a&&r.isEmpty(a)&&cp(wt.fromDom(a)),o.setRng(i)}},lh=function(e,t,n){void 0===n&&(n=!0);var r=e.dom,o=e.selection;if(t)uh(e,t,n);else if(!(t=ks(e.getBody(),o.getStart())))for(;t=r.get("_mce_caret");)uh(e,t,!1)},sh=function(e,t){return e.appendChild(t),t},fh=function(e,t){var n=X(e,(function(e,t){return sh(e,t.cloneNode(!1))}),t);return sh(n,n.ownerDocument.createTextNode("\ufeff"))},dh=function(e,t,n,r){var o,i,a,c=e.dom,u=e.selection,l=[],s=u.getRng(),f=s.startContainer,d=s.startOffset;for(i=f,3===f.nodeType&&(d!==f.nodeValue.length&&(o=!0),i=i.parentNode);i;){if(th(e,i,t,n,r)){a=i;break}i.nextSibling&&(o=!0),l.push(i),i=i.parentNode}if(a)if(o){var m=u.getBookmark();s.collapse(!0);var p=vf(e,s,e.formatter.get(t),!0);p=ad(p),e.formatter.remove(t,n,p,r),u.moveToBookmark(m)}else{var g=ks(e.getBody(),a),h=ch(!1).dom;!function(e,t,n){var r=e.dom,o=r.getParent(n,N(zs,e));o&&r.isEmpty(o)?n.parentNode.replaceChild(t,n):(ap(wt.fromDom(n)),r.isEmpty(n)?n.parentNode.replaceChild(t,n):r.insertAfter(t,n))}(e,h,null!==g?g:a);var v=function(e,t,n,r,o,i){var a=e.formatter,c=e.dom,u=J(fe(a.get()),(function(e){return e!==r&&!Fe(e,"removeformat")})),l=oh(e,n,u);if(J(l,(function(t){return!Ys(e,t,r)})).length>0){var s=n.cloneNode(!1);return c.add(t,s),a.remove(r,o,s,i),c.remove(s),F.some(s)}return F.none()}(e,h,a,t,n,r),b=fh(l.concat(v.toArray()),h);uh(e,g,!1),u.setCursorLocation(b,1),c.isEmpty(a)&&c.remove(a)}},mh=function(e){e.on("mouseup keydown",(function(t){!function(e,t){var n=e.selection,r=e.getBody();lh(e,null,!1),8!==t&&46!==t||!n.isCollapsed()||"\ufeff"!==n.getStart().innerHTML||lh(e,ks(r,n.getStart())),37!==t&&39!==t||lh(e,ks(r,n.getStart()))}(e,t.keyCode)}))},ph=function(e,t){var n=e.schema.getTextInlineElements();return Ce(n,At(t))&&!Ss(t.dom)&&!Tn(t.dom)},gh={},hh=Ee,vh=ke;!function(e,t){gh[e]||(gh[e]=[]),gh[e].push(t)}("pre",(function(e){var t,n=e.selection.getRng(),r=xn(["pre"]);n.collapsed||(t=e.selection.getSelectedBlocks(),vh(hh(hh(t,r),(function(e){return r(e.previousSibling)&&-1!==Ae(t,e.previousSibling)})),(function(e){var t,n;t=e.previousSibling,Ja(n=e).remove(),Ja(t).append("<br><br>").append(n.childNodes)})))}));var bh=bt.each,yh=function(e){return Cn(e)&&!Bs(e)&&!Ss(e)&&!Tn(e)},wh=function(e,t){for(var n=e;n;n=n[t]){if(Nn(n)&&Ve(n.data))return e;if(Cn(n)&&!Bs(n))return n}return e},Ch=function(e,t,n){var r=Mm(e);if(t&&n&&(t=wh(t,"previousSibling"),n=wh(n,"nextSibling"),r.compare(t,n))){for(var o=t.nextSibling;o&&o!==n;){var i=o;o=o.nextSibling,t.appendChild(i)}return e.remove(n),bt.each(bt.grep(n.childNodes),(function(e){t.appendChild(e)})),t}return n},xh=function(e,t,n,r){if(r&&!1!==t.merge_siblings){var o=Ch(e,Us(r),r);Ch(e,o,Us(o,!0))}},Sh=function(e,t,n){bh(e.childNodes,(function(e){yh(e)&&(t(e)&&n(e),e.hasChildNodes()&&Sh(e,t,n))}))},kh=function(e,t){return function(n){return!(!n||!Gs(e,n,t))}},Th=function(e,t,n){return function(r){e.setStyle(r,t,n),""===r.getAttribute("style")&&r.removeAttribute("style"),function(e,t){"SPAN"===t.nodeName&&0===e.getAttribs(t).length&&e.remove(t,!0)}(e,r)}},Eh=gr([{keep:[]},{rename:["name"]},{removed:[]}]),Ah=/^(src|href|style)$/,_h=bt.each,Nh=$s,Rh=function(e,t,n){return e.isChildOf(t,n)&&t!==n&&!e.isBlock(n)},Dh=function(e,t,n){var r=t[n?"startContainer":"endContainer"],o=t[n?"startOffset":"endOffset"];if(Cn(r)){var i=r.childNodes.length-1;!n&&o&&o--,r=r.childNodes[o>i?i:o]}return Nn(r)&&n&&o>=r.nodeValue.length&&(r=new Yr(r,e.getBody()).next()||r),Nn(r)&&!n&&0===o&&(r=new Yr(r,e.getBody()).prev()||r),r},Oh=function(e,t){var n=t?"firstChild":"lastChild";if(function(e){return/^(TR|TH|TD)$/.test(e.nodeName)}(e)&&e[n]){var r=e[n];return"TR"===e.nodeName&&r[n]||r}return e},Ih=function(e,t,n,r){var o=e.create(n,r);return t.parentNode.insertBefore(o,t),o.appendChild(t),o},Ph=function(e,t,n,r,o){var i=wt.fromDom(t),a=wt.fromDom(e.create(r,o)),c=n?Ut(i):Ht(i);return on(a,c),n?(en(i,a),nn(a,i)):(tn(i,a),rn(a,i)),a.dom},Bh=function(e,t,n,r){var o=Us(t,n,r);return y(o)||"BR"===o.nodeName||e.isBlock(o)},Mh=function(e,t,n){var r,o=t.parentNode,i=e.dom,a=zu(e);Qs(n)&&(a?o===i.getRoot()&&(n.list_block&&Nh(t,n.list_block)||$(le(t.childNodes),(function(t){Ws(e,a,t.nodeName.toLowerCase())?r?r.appendChild(t):(r=Ih(i,t,a),i.setAttribs(r,e.settings.forced_root_block_attrs)):r=null}))):i.isBlock(t)&&!i.isBlock(o)&&(Bh(i,t,!1)||Bh(i,t.firstChild,!0,!0)||t.insertBefore(i.create("br"),t.firstChild),Bh(i,t,!0)||Bh(i,t.lastChild,!1,!0)||t.appendChild(i.create("br")))),function(e){return Zs(e)&&ef(e)&&jn(we(e,"mixed"),!0)}(n)&&!Nh(n.inline,t)||i.remove(t,!0)},Lh=function(e,t,n,r,o){var i,a=e.dom;if(!function(e,t,n){return!(!ef(n)||!Nh(t,n.inline))||(!(!Qs(n)||!Nh(t,n.block))||(Zs(n)?Cn(t)&&e.is(t,n.selector):void 0))}(a,r,t)&&!function(e,t){return t.links&&"A"===e.nodeName}(r,t))return Eh.keep();var c=r;if(ef(t)&&"all"===t.remove&&g(t.preserve_attributes)){var u=J(a.getAttribs(c),(function(e){return W(t.preserve_attributes,e.name.toLowerCase())}));if(a.removeAllAttribs(c),$(u,(function(e){return a.setAttrib(c,e.name,e.value)})),u.length>0)return Eh.rename("span")}if("all"!==t.remove){_h(t.styles,(function(e,r){e=Ks(a,qs(e,n),r+""),x(r)&&(r=e,o=null),(t.remove_similar||!o||Nh(Gs(a,o,r),e))&&a.setStyle(c,r,""),i=!0})),i&&""===a.getAttrib(c,"style")&&(c.removeAttribute("style"),c.removeAttribute("data-mce-style")),_h(t.attributes,(function(e,r){var i;if(e=qs(e,n),x(r)&&(r=e,o=null),t.remove_similar||!o||Nh(a.getAttrib(o,r),e)){if("class"===r&&(e=a.getAttrib(c,r))&&(i="",$(e.split(/\s+/),(function(e){/mce\-\w+/.test(e)&&(i+=(i?" ":"")+e)})),i))return void a.setAttrib(c,r,i);if(Ah.test(r)&&c.removeAttribute("data-mce-"+r),"style"===r&&xn(["li"])(c)&&"none"===a.getStyle(c,"list-style-type"))return c.removeAttribute(r),void a.setStyle(c,"list-style-type","none");"class"===r&&c.removeAttribute("className"),c.removeAttribute(r)}})),_h(t.classes,(function(e){e=qs(e,n),o&&!a.hasClass(o,e)||a.removeClass(c,e)}));for(var l=a.getAttribs(c),s=0;s<l.length;s++){var f=l[s].nodeName;if(0!==f.indexOf("_")&&0!==f.indexOf("data-"))return Eh.keep()}}return"none"!==t.remove?(Mh(e,c,t),Eh.removed()):Eh.keep()},Fh=function(e,t,n,r,o){return Lh(e,t,n,r,o).fold(I,(function(t){return e.dom.rename(r,t),!0}),P)},jh=function(e,t,n,r){return Lh(e,t,n,r,r).fold(E(r),(function(t){return e.dom.createFragment().appendChild(r),e.dom.rename(r,t)}),E(null))},Hh=function(e,t,n,r,o){var i=e.formatter.get(t),a=i[0],c=!0,u=e.dom,l=e.selection,s=function(r){var c=function(e,t,n,r,o){var i;return $(Xs(e.dom,t.parentNode).reverse(),(function(t){if(!i&&"_start"!==t.id&&"_end"!==t.id){var a=th(e,t,n,r,o);a&&!1!==a.split&&(i=t)}})),i}(e,r,t,n,o);return function(e,t,n,r,o,i,a,c){var u,l,s,f=e.dom;if(n){for(var d=n.parentNode,m=r.parentNode;m&&m!==d;m=m.parentNode){u=f.clone(m,!1);for(var p=0;p<t.length&&null!==(u=jh(e,t[p],c,u));p++);u&&(l&&u.appendChild(l),s||(s=u),l=u)}!i||a.mixed&&f.isBlock(n)||(r=f.split(n,r)),l&&(o.parentNode.insertBefore(l,o),s.appendChild(o),ef(a)&&xh(f,a,0,l))}return r}(e,i,c,r,r,!0,a,n)},f=function(t){return V(i,(function(r){return Fh(e,r,n,t,t)}))},d=function(t){var n=!0,r=!1;Cn(t)&&u.getContentEditable(t)&&(n=c,c="true"===u.getContentEditable(t),r=!0);var o=le(t.childNodes);if(c&&!r){var l=f(t)||V(i,(function(e){return Zg(u,t,e)})),s=t.parentNode;!l&&w(s)&&tf(a)&&f(s)}if(a.deep&&o.length){for(var m=0;m<o.length;m++)d(o[m]);r&&(c=n)}$(["underline","line-through","overline"],(function(n){Cn(t)&&e.dom.getStyle(t,"text-decoration")===n&&t.parentNode&&Js(u,t.parentNode)===n&&Fh(e,{deep:!1,exact:!0,inline:"span",styles:{textDecoration:n}},null,t)}))},m=function(e){var t=u.get(e?"_start":"_end"),n=t[e?"firstChild":"lastChild"];return function(e){return Bs(e)&&Cn(e)&&("_start"===e.id||"_end"===e.id)}(n)&&(n=n[e?"firstChild":"lastChild"]),Nn(n)&&0===n.data.length&&(n=e?t.previousSibling||t.nextSibling:t.nextSibling||t.previousSibling),u.remove(t,!0),n},p=function(t){var n,r,o=vf(e,t,i,t.collapsed);if(a.split){if(o=ad(o),(n=Dh(e,o,!0))!==(r=Dh(e,o))){if(n=Oh(n,!0),r=Oh(r,!1),Rh(u,n,r)){var c=F.from(n.firstChild).getOr(n);return s(Ph(u,c,!0,"span",{id:"_start","data-mce-type":"bookmark"})),void m(!0)}if(Rh(u,r,n)){c=F.from(r.lastChild).getOr(r);return s(Ph(u,c,!1,"span",{id:"_end","data-mce-type":"bookmark"})),void m(!1)}n=Ih(u,n,"span",{id:"_start","data-mce-type":"bookmark"}),r=Ih(u,r,"span",{id:"_end","data-mce-type":"bookmark"});var l=u.createRng();l.setStartAfter(n),l.setEndBefore(r),bf(u,l,(function(e){$(e,(function(e){Bs(e)||Bs(e.parentNode)||s(e)}))})),s(n),s(r),n=m(!0),r=m()}else n=r=s(n);o.startContainer=n.parentNode?n.parentNode:n,o.startOffset=u.nodeIndex(n),o.endContainer=r.parentNode?r.parentNode:r,o.endOffset=u.nodeIndex(r)+1}bf(u,o,(function(e){$(e,d)}))};if(r){if(js(r)){var g=u.createRng();g.setStartBefore(r),g.setEndAfter(r),p(g)}else p(r);Wf(e,t,r,n)}else if("false"!==u.getContentEditable(l.getNode()))l.isCollapsed()&&ef(a)&&!xf(e).length?dh(e,t,n,o):(Rf(l,!0,(function(){Nf(e,p)})),ef(a)&&nh(e,t,n,l.getStart())&&Hs(u,l,l.getRng()),e.nodeChanged()),Wf(e,t,r,n);else{r=l.getNode();for(var h=0;h<i.length&&(!i[h].ceFalseOverride||!Fh(e,i[h],n,r,r));h++);Wf(e,t,r,n)}},Uh=bt.each,zh=function(e,t,n,r){Uh(t,(function(t){ef(t)&&Uh(e.dom.select(t.inline,r),(function(r){yh(r)&&Fh(e,t,n,r,t.exact?r:null)})),function(e,t,n){if(t.clear_child_styles){var r=t.links?"*:not(a)":"*";bh(e.select(r,n),(function(n){yh(n)&&bh(t.styles,(function(t,r){e.setStyle(n,r,"")}))}))}}(e.dom,t,r)}))},Wh=bt.each,Vh=function(e){return Cn(e)&&!Bs(e)&&!Ss(e)&&!Tn(e)},qh=function(e,t,n,r){var o=e.formatter.get(t),i=o[0],a=!r&&e.selection.isCollapsed(),c=e.dom,u=e.selection,l=function(e,t){if(void 0===t&&(t=i),C(t.onformat)&&t.onformat(e,t,n,r),Wh(t.styles,(function(t,r){c.setStyle(e,r,qs(t,n))})),t.styles){var o=c.getAttrib(e,"style");o&&c.setAttrib(e,"data-mce-style",o)}Wh(t.attributes,(function(t,r){c.setAttrib(e,r,qs(t,n))})),Wh(t.classes,(function(t){t=qs(t,n),c.hasClass(e,t)||c.addClass(e,t)}))},s=function(e,t){var n=!1;return Wh(e,(function(e){return!!Zs(e)&&(w(e.collapsed)&&e.collapsed!==a?void 0:c.is(t,e.selector)&&!Ss(t)?(l(t,e),n=!0,!1):void 0)})),n},f=function(e){if(m(e)){var t=c.create(e);return l(t),t}return null},d=function(r,a,c){var u=[],d=!0,m=i.inline||i.block,p=f(m);bf(r,a,(function(a){var f,g=function(a){var h=!1,v=d,b=a.nodeName.toLowerCase(),y=a.parentNode,C=y.nodeName.toLowerCase();if(Cn(a)&&r.getContentEditable(a)&&(v=d,d="true"===r.getContentEditable(a),h=!0),In(a)&&!function(e,t,n,r){if(function(e){return e.getParam("format_empty_lines",!1,"boolean")}(e)&&ef(t)){var o=De(De({},e.schema.getTextBlockElements()),{td:{},th:{},li:{},dt:{},dd:{},figcaption:{},caption:{},details:{},summary:{}}),i=Kg(wt.fromDom(n),(function(e){return Ss(e.dom)}));return xe(o,r)&&Wo(wt.fromDom(n.parentNode),!1)&&!i}return!1}(e,i,a,C))return f=null,void(Qs(i)&&r.remove(a));if(Qs(i)&&i.wrapper&&th(e,a,t,n))f=null;else{if(d&&!h&&Qs(i)&&!i.wrapper&&zs(e,b)&&Ws(e,C,m)){var x=r.rename(a,m);return l(x),u.push(x),void(f=null)}if(Zs(i)){var S=s(o,a);if(!S&&w(y)&&tf(i)&&(S=s(o,y)),!ef(i)||S)return void(f=null)}!d||h||!Ws(e,m,b)||!Ws(e,C,m)||!c&&Nn(a)&&lo(a.data)||Ss(a)||ef(i)&&r.isBlock(a)?(f=null,$(le(a.childNodes),g),h&&(d=v),f=null):(f||(f=r.clone(p,!1),a.parentNode.insertBefore(f,a),u.push(f)),f.appendChild(a))}};$(a,g)})),!0===i.links&&$(u,(function(e){var t=function(e){"A"===e.nodeName&&l(e,i),$(le(e.childNodes),t)};t(e)})),$(u,(function(a){var c=function(e){var t=0;return $(e.childNodes,(function(e){(function(e){return w(e)&&Nn(e)&&0===e.length})(e)||Bs(e)||t++})),t}(a);!(u.length>1)&&r.isBlock(a)||0!==c?(ef(i)||Qs(i)&&i.wrapper)&&(i.exact||1!==c||(a=function(e){return Z(e.childNodes,Vh).filter((function(e){return Zg(r,e,i)})).map((function(t){var n=r.clone(t,!1);return l(n),r.replace(n,e,!0),r.remove(t,!0),n})).getOr(e)}(a)),zh(e,o,n,a),function(e,t,n,r,o){th(e,o.parentNode,n,r)&&Fh(e,t,r,o)||t.merge_with_parents&&e.dom.getParent(o.parentNode,(function(i){if(th(e,i,n,r))return Fh(e,t,r,o),!0}))}(e,i,t,n,a),function(e,t,n,r){t.styles&&t.styles.backgroundColor&&Sh(r,kh(e,"fontSize"),Th(e,"backgroundColor",qs(t.styles.backgroundColor,n)))}(r,i,n,a),function(e,t,n,r){var o=function(t){if(1===t.nodeType&&t.parentNode&&1===t.parentNode.nodeType){var n=Js(e,t.parentNode);e.getStyle(t,"color")&&n?e.setStyle(t,"text-decoration",n):e.getStyle(t,"text-decoration")===n&&e.setStyle(t,"text-decoration",null)}};t.styles&&(t.styles.color||t.styles.textDecoration)&&(bt.walk(r,o,"childNodes"),o(r))}(r,i,0,a),function(e,t,n,r){!ef(t)||"sub"!==t.inline&&"sup"!==t.inline||(Sh(r,kh(e,"fontSize"),Th(e,"fontSize","")),e.remove(e.select("sup"===t.inline?"sub":"sup",r),!0))}(r,i,0,a),xh(r,i,0,a)):r.remove(a,!0)}))};if("false"!==c.getContentEditable(u.getNode())){if(i){if(r)if(js(r)){if(!s(o,r)){var p=c.createRng();p.setStartBefore(r),p.setEndAfter(r),d(c,vf(e,p,o),!0)}}else d(c,r,!0);else if(a&&ef(i)&&!xf(e).length)!function(e,t,n){var r,o,i=e.selection,a=i.getRng(),c=a.startOffset,u=a.startContainer.nodeValue;(r=ks(e.getBody(),i.getStart()))&&(o=ah(r));var l,s,f=/[^\s\u00a0\u00ad\u200b\ufeff]/;if(u&&c>0&&c<u.length&&f.test(u.charAt(c))&&f.test(u.charAt(c-1))){var d=i.getBookmark();a.collapse(!0);var m=vf(e,a,e.formatter.get(t));m=ad(m),e.formatter.apply(t,n,m),i.moveToBookmark(d)}else r&&"\ufeff"===o.nodeValue||(l=e.getDoc(),s=ch(!0).dom,o=(r=l.importNode(s,!0)).firstChild,a.insertNode(r),c=1),e.formatter.apply(t,n,r),i.setCursorLocation(o,c)}(e,t,n);else{var g=u.getNode(),h=o[0];e.settings.forced_root_block||!h.defaultBlock||c.getParent(g,c.isBlock)||qh(e,h.defaultBlock),u.setRng(Og(u.getRng())),Rf(u,!0,(function(){Nf(e,(function(t,n){var r=n?t:vf(e,t,o);d(c,r,!1)}))})),Hs(c,u,u.getRng()),e.nodeChanged()}!function(e,t){vh(gh[e],(function(e){e(t)}))}(t,e)}zf(e,t,r,n)}else{r=u.getNode();for(var v=0,b=o.length;v<b;v++){var y=o[v];if(y.ceFalseOverride&&Zs(y)&&c.is(r,y.selector)){l(r,y);break}}zf(e,t,r,n)}},$h=function(e){return Ce(e,"vars")},Kh=function(e){return e.selection.getStart()},Gh=function(e,t,n,r,o){return Q(t,(function(t){var i=e.formatter.matchNode(t,n,null!=o?o:{},r);return!b(i)}),(function(t){return!!Yg(e,t,n)||!r&&w(e.formatter.matchNode(t,n,o,!0))}))},Jh=function(e,t){var n=null!=t?t:Kh(e);return J(Xs(e.dom,n),(function(e){return Cn(e)&&!Tn(e)}))},Xh=function(e,t,n){var r=Jh(e,t);me(n,(function(n,o){var i=function(n){var i=Gh(e,r,o,n.similar,$h(n)?n.vars:void 0),a=i.isSome();if(n.state.get()!==a){n.state.set(a);var c=i.getOr(t);$h(n)?n.callback(a,{node:c,format:o,parents:r}):$(n.callbacks,(function(e){return e(a,{node:c,format:o,parents:r})}))}};$([n.withSimilar,n.withoutSimilar],i),$(n.withVars,i)}))},Yh=function(e,t,n,r,o,i){return null===t.get()&&function(e,t){e.set({}),t.on("NodeChange",(function(n){Xh(t,n.element,e.get())})),t.on("FormatApply FormatRemove",(function(n){var r=F.from(n.node).map((function(e){return js(e)?e:e.startContainer})).bind((function(e){return Cn(e)?F.some(e):F.from(e.parentElement)})).getOrThunk((function(){return Kh(t)}));Xh(t,r,e.get())}))}(t,e),function(e,t,n,r,o,i){var a=t.get();$(n.split(","),(function(t){var n=we(a,t).getOrThunk((function(){var e={withSimilar:{state:cc(!1),similar:!0,callbacks:[]},withoutSimilar:{state:cc(!1),similar:!1,callbacks:[]},withVars:[]};return a[t]=e,e})),c=function(){var n=Jh(e);return Gh(e,n,t,o,i).isSome()};if(b(i)){var u=o?n.withSimilar:n.withoutSimilar;u.callbacks.push(r),1===u.callbacks.length&&u.state.set(c())}else n.withVars.push({state:cc(c()),similar:o,vars:i,callback:r})})),t.set(a)}(e,t,n,r,o,i),{unbind:function(){return function(e,t,n){var r=e.get();$(t.split(","),(function(e){return we(r,e).each((function(t){r[e]={withSimilar:De(De({},t.withSimilar),{callbacks:J(t.withSimilar.callbacks,(function(e){return e!==n}))}),withoutSimilar:De(De({},t.withoutSimilar),{callbacks:J(t.withoutSimilar.callbacks,(function(e){return e!==n}))}),withVars:J(t.withVars,(function(e){return e.callback!==n}))}}))})),e.set(r)}(t,n,r)}}},Qh=function(e,t){var n=(t||document).createDocumentFragment();return $(e,(function(e){n.appendChild(e.dom)})),wt.fromDom(n)},Zh=function(e,t,n){return{element:e,width:t,rows:n}},ev=function(e,t){return{element:e,cells:t}},tv=function(e,t){return{x:e,y:t}},nv=function(e,t){var n=parseInt(qn(e,t),10);return isNaN(n)?1:n},rv=function(e,t,n){var r=e.rows;return!!(r[n]?r[n].cells:[])[t]},ov=function(e){return Y(e,(function(e,t){return t.cells.length>e?t.cells.length:e}),0)},iv=function(e,t){for(var n=e.rows,r=0;r<n.length;r++)for(var o=n[r].cells,i=0;i<o.length;i++)if(kt(o[i],t))return F.some(tv(i,r));return F.none()},av=function(e,t,n,r,o){for(var i=[],a=e.rows,c=n;c<=o;c++){var u=a[c].cells,l=t<r?u.slice(t,r+1):u.slice(r,t+1);i.push(ev(a[c].element,l))}return i},cv=function(e){var t=Zh(Mc(e),0,[]);return $(kc(e,"tr"),(function(e,n){$(kc(e,"td,th"),(function(r,o){!function(e,t,n,r,o){for(var i=nv(o,"rowspan"),a=nv(o,"colspan"),c=e.rows,u=n;u<n+i;u++){c[u]||(c[u]=ev(Lc(r),[]));for(var l=t;l<t+a;l++){c[u].cells[l]=u===n&&l===t?o:Mc(o)}}}(t,function(e,t,n){for(;rv(e,t,n);)t++;return t}(t,o,n),n,e,r)}))})),Zh(t.element,ov(t.rows),t.rows)},uv=function(e){return function(e,t){var n=Mc(e.element),r=wt.fromTag("tbody");return on(r,t),rn(n,r),n}(e,function(e){return q(e.rows,(function(e){var t=q(e.cells,(function(e){var t=Lc(e);return Kn(t,"colspan"),Kn(t,"rowspan"),t})),n=Mc(e.element);return on(n,t),n}))}(e))},lv=function(e,t,n){return iv(e,t).bind((function(t){return iv(e,n).map((function(n){return function(e,t,n){var r=t.x,o=t.y,i=n.x,a=n.y,c=o<a?av(e,r,o,i,a):av(e,r,a,i,o);return Zh(e.element,ov(c),c)}(e,t,n)}))}))},sv=function(e,t){return Z(e,(function(e){return"li"===At(e)&&Ef(e,t)})).fold(E([]),(function(t){return function(e){return Z(e,(function(e){return"ul"===At(e)||"ol"===At(e)}))}(e).map((function(e){var t=wt.fromTag(At(e)),n=be(Qn(e),(function(e,t){return je(t,"list-style")}));return Gn(t,n),[wt.fromTag("li"),t]})).getOr([])}))},fv=function(e,t){var n=wt.fromDom(t.commonAncestorContainer),r=fp(n,e),o=J(r,(function(e){return to(e)||Zr(e)})),i=sv(r,t),a=o.concat(i.length?i:function(e){return io(e)?Lt(e).filter(oo).fold(E([]),(function(t){return[e,t]})):oo(e)?[e]:[]}(n));return q(a,Mc)},dv=function(){return Qh([])},mv=function(e,t){return n=wt.fromDom(t.cloneContents()),r=fv(e,t),o=Y(r,(function(e,t){return rn(t,e),t}),n),r.length>0?Qh([o]):o;var n,r,o},pv=function(e,t){return(n=e,r=t[0],Ur(r,"table",N(kt,n))).bind((function(e){var n=t[0],r=t[t.length-1],o=cv(e);return lv(o,n,r).map((function(e){return Qh([uv(e)])}))})).getOrThunk(dv);var n,r},gv=function(e,t){var n=Cf(t,e);return n.length>0?pv(e,n):function(e,t){return t.length>0&&t[0].collapsed?dv():mv(e,t[0])}(e,t)},hv=function(e,t){return t>=0&&t<e.length&&Ls(e.charAt(t))},vv=function(e,t){var n=so(e.innerText);return t?function(e){return e.replace(/^[ \f\n\r\t\v]+/,"")}(n):n},bv=function(e,t,n){void 0===n&&(n={});var r=function(e,t){return De(De({},e),{format:t,get:!0,selection:!0})}(n,t),o=e.fire("BeforeGetContent",r);if(o.isDefaultPrevented())return e.fire("GetContent",o),o.content;if("text"===o.format)return function(e){return F.from(e.selection.getRng()).map((function(t){var n=F.from(e.dom.getParent(t.commonAncestorContainer,e.dom.isBlock)),r=e.getBody(),o=function(e){return e.map((function(e){return e.nodeName})).getOr("div").toLowerCase()}(n),i=mt.browser.isIE()&&"pre"!==o,a=e.dom.add(r,o,{"data-mce-bogus":"all",style:"overflow: hidden; opacity: 0;"},t.cloneContents()),c=vv(a,i),u=so(a.textContent);if(e.dom.remove(a),hv(u,0)||hv(u,u.length-1)){var l=n.getOr(r),s=vv(l,i),f=s.indexOf(c);return-1===f?c:(hv(s,f-1)?" ":"")+c+(hv(s,f+c.length)?" ":"")}return c})).getOr("")}(e);o.getInner=!0;var i=function(e,t){var n=e.selection.getRng(),r=e.dom.create("body"),o=e.selection.getSel(),i=mm(e,yf(o)),a=t.contextual?gv(wt.fromDom(e.getBody()),i).dom:n.cloneContents();return a&&r.appendChild(a),e.selection.serializer.serialize(r,t)}(e,o);return"tree"===o.format?i:(o.content=e.selection.isCollapsed()?"":i,e.fire("GetContent",o),o.content)},yv=function(e){return Cn(e)?e.outerHTML:Nn(e)?ci.encodeRaw(e.data,!1):Rn(e)?"\x3c!--"+e.data+"--\x3e":""},wv=function(e,t,n){var r=function(e){var t,n=document.createElement("div"),r=document.createDocumentFragment();for(e&&(n.innerHTML=e);t=n.firstChild;)r.appendChild(t);return r}(t);if(e.hasChildNodes()&&n<e.childNodes.length){var o=e.childNodes[n];o.parentNode.insertBefore(r,o)}else e.appendChild(r)},Cv=function(e,t){var n,r,o,i,a,c,u,l,s,f=q(le(t.childNodes),yv);return function(e,t){var n=0;$(e,(function(e){0===e[0]?n++:1===e[0]?(wv(t,e[1],n),n++):2===e[0]&&function(e,t){if(e.hasChildNodes()&&t<e.childNodes.length){var n=e.childNodes[t];n.parentNode.removeChild(n)}}(t,n)}))}((r=e,o=(n=f).length+r.length+2,i=new Array(o),a=new Array(o),c=function(e,t,o,i,a){var u=l(e,t,o,i);if(null===u||u.start===t&&u.diag===t-i||u.end===e&&u.diag===e-o)for(var s=e,f=o;s<t||f<i;)s<t&&f<i&&n[s]===r[f]?(a.push([0,n[s]]),++s,++f):t-e>i-o?(a.push([2,n[s]]),++s):(a.push([1,r[f]]),++f);else{c(e,u.start,o,u.start-u.diag,a);for(var d=u.start;d<u.end;++d)a.push([0,n[d]]);c(u.end,t,u.end-u.diag,i,a)}},u=function(e,t,o,i){for(var a=e;a-t<i&&a<o&&n[a]===r[a-t];)++a;return function(e,t,n){return{start:e,end:t,diag:n}}(e,a,t)},l=function(e,t,o,c){var l=t-e,s=c-o;if(0===l||0===s)return null;var f,d,m,p,g,h=l-s,v=s+l,b=(v%2==0?v:v+1)/2;for(i[1+b]=e,a[1+b]=t+1,f=0;f<=b;++f){for(d=-f;d<=f;d+=2){for(m=d+b,d===-f||d!==f&&i[m-1]<i[m+1]?i[m]=i[m+1]:i[m]=i[m-1]+1,g=(p=i[m])-e+o-d;p<t&&g<c&&n[p]===r[g];)i[m]=++p,++g;if(h%2!=0&&h-f<=d&&d<=h+f&&a[m-h]<=i[m])return u(a[m-h],d+e-o,t,c)}for(d=h-f;d<=h+f;d+=2){for(m=d+b-h,d===h-f||d!==h+f&&a[m+1]<=a[m-1]?a[m]=a[m+1]-1:a[m]=a[m-1],g=(p=a[m]-1)-e+o-d;p>=e&&g>=o&&n[p]===r[g];)a[m]=p--,g--;if(h%2==0&&-f<=d&&d<=f&&a[m]<=i[m+h])return u(a[m],d+e-o,t,c)}}},s=[],c(0,n.length,0,r.length,s),s),t),t},xv=Ie((function(){return document.implementation.createHTMLDocument("undo")})),Sv=function(e){var t,n=(t=e.getBody(),J(q(le(t.childNodes),yv),(function(e){return e.length>0}))),r=te(n,(function(t){var n=Om(e.serializer,t);return n.length>0?[n]:[]})),o=r.join("");return-1!==o.indexOf("</iframe>")?function(e){return{type:"fragmented",fragments:e,content:"",bookmark:null,beforeBookmark:null}}(r):function(e){return{type:"complete",fragments:null,content:e,bookmark:null,beforeBookmark:null}}(o)},kv=function(e,t,n){var r=n?t.beforeBookmark:t.bookmark;"fragmented"===t.type?Cv(t.fragments,e.getBody()):e.setContent(t.content,{format:"raw",no_selection:!w(r)||!Ts(r)||!r.isFakeCaret}),e.selection.moveToBookmark(r)},Tv=function(e){return"fragmented"===e.type?e.fragments.join(""):e.content},Ev=function(e){var t=wt.fromTag("body",xv());return Pc(t,Tv(e)),$(kc(t,"*[data-mce-bogus]"),un),t.dom.innerHTML},Av=function(e,t){return!(!e||!t)&&(!!function(e,t){return Tv(e)===Tv(t)}(e,t)||function(e,t){return Ev(e)===Ev(t)}(e,t))},_v=function(e){return 0===e.get()},Nv=function(e,t,n){_v(n)&&(e.typing=t)},Rv=function(e,t){e.typing&&(Nv(e,!1,t),e.add())},Dv=function(e){return{undoManager:{beforeChange:function(t,n){return function(e,t,n){_v(t)&&n.set(Fu(e.selection))}(e,t,n)},add:function(t,n,r,o,i,a){return function(e,t,n,r,o,i,a){var c=Sv(e);if(i=i||{},i=bt.extend(i,c),!1===_v(r)||e.removed)return null;var u=t.data[n.get()];if(e.fire("BeforeAddUndo",{level:i,lastLevel:u,originalEvent:a}).isDefaultPrevented())return null;if(u&&Av(u,i))return null;t.data[n.get()]&&o.get().each((function(e){t.data[n.get()].beforeBookmark=e}));var l=function(e){return e.getParam("custom_undo_redo_levels",0,"number")}(e);if(l&&t.data.length>l){for(var s=0;s<t.data.length-1;s++)t.data[s]=t.data[s+1];t.data.length--,n.set(t.data.length)}i.bookmark=Fu(e.selection),n.get()<t.data.length-1&&(t.data.length=n.get()+1),t.data.push(i),n.set(t.data.length-1);var f={level:i,lastLevel:u,originalEvent:a};return n.get()>0?(e.setDirty(!0),e.fire("AddUndo",f),e.fire("change",f)):e.fire("AddUndo",f),i}(e,t,n,r,o,i,a)},undo:function(t,n,r){return function(e,t,n,r){var o;return t.typing&&(t.add(),t.typing=!1,Nv(t,!1,n)),r.get()>0&&(r.set(r.get()-1),o=t.data[r.get()],kv(e,o,!0),e.setDirty(!0),e.fire("Undo",{level:o})),o}(e,t,n,r)},redo:function(t,n){return function(e,t,n){var r;return t.get()<n.length-1&&(t.set(t.get()+1),r=n[t.get()],kv(e,r,!1),e.setDirty(!0),e.fire("Redo",{level:r})),r}(e,t,n)},clear:function(t,n){return function(e,t,n){t.data=[],n.set(0),t.typing=!1,e.fire("ClearUndos")}(e,t,n)},reset:function(e){return function(e){e.clear(),e.add()}(e)},hasUndo:function(t,n){return function(e,t,n){return n.get()>0||t.typing&&t.data[0]&&!Av(Sv(e),t.data[0])}(e,t,n)},hasRedo:function(e,t){return function(e,t){return t.get()<e.data.length-1&&!e.typing}(e,t)},transact:function(e,t,n){return function(e,t,n){return Rv(e,t),e.beforeChange(),e.ignore(n),e.add()}(e,t,n)},ignore:function(e,t){return function(e,t){try{e.set(e.get()+1),t()}finally{e.set(e.get()-1)}}(e,t)},extra:function(t,n,r,o){return function(e,t,n,r,o){if(t.transact(r)){var i=t.data[n.get()].bookmark,a=t.data[n.get()-1];kv(e,a,!0),t.transact(o)&&(t.data[n.get()-1].beforeBookmark=i)}}(e,t,n,r,o)}},formatter:{match:function(t,n,r,o){return nh(e,t,n,r,o)},matchAll:function(t,n){return function(e,t,n){var r=[],o={},i=e.selection.getStart();return e.dom.getParent(i,(function(i){for(var a=0;a<t.length;a++){var c=t[a];!o[c]&&th(e,i,c,n)&&(o[c]=!0,r.push(c))}}),e.dom.getRoot()),r}(e,t,n)},matchNode:function(t,n,r,o){return th(e,t,n,r,o)},canApply:function(t){return function(e,t){var n=e.formatter.get(t),r=e.dom;if(n)for(var o=e.selection.getStart(),i=Xs(r,o),a=n.length-1;a>=0;a--){var c=n[a];if(!Zs(c)||w(c.defaultBlock))return!0;for(var u=i.length-1;u>=0;u--)if(r.is(i[u],c.selector))return!0}return!1}(e,t)},closest:function(t){return rh(e,t)},apply:function(t,n,r){return qh(e,t,n,r)},remove:function(t,n,r,o){return Hh(e,t,n,r,o)},toggle:function(t,n,r){return function(e,t,n,r){var o=e.formatter.get(t);!nh(e,t,n,r)||"toggle"in o[0]&&!o[0].toggle?qh(e,t,n,r):Hh(e,t,n,r)}(e,t,n,r)},formatChanged:function(t,n,r,o,i){return Yh(e,t,n,r,o,i)}},editor:{getContent:function(t,n){return function(e,t,n){return F.from(e.getBody()).fold(E("tree"===t.format?new bm("body",11):""),(function(r){return Pm(e,t,n,r)}))}(e,t,n)},setContent:function(t,n){return $g(e,t,n)},insertContent:function(t,n){return Ug(e,t,n)},addVisual:function(t){return function(e,t){var n=e.dom,r=w(t)?t:e.getBody();b(e.hasVisual)&&(e.hasVisual=function(e){return e.getParam("visual",!0,"boolean")}(e)),$(n.select("table,a",r),(function(t){switch(t.nodeName){case"TABLE":var r=function(e){return e.getParam("visual_table_class","mce-item-table","string")}(e),o=n.getAttrib(t,"border");o&&"0"!==o||!e.hasVisual?n.removeClass(t,r):n.addClass(t,r);break;case"A":if(!n.getAttrib(t,"href")){var i=n.getAttrib(t,"name")||t.id,a=function(e){return e.getParam("visual_anchor_class","mce-item-anchor","string")}(e);i&&e.hasVisual?n.addClass(t,a):n.removeClass(t,a)}}})),e.fire("VisualAid",{element:t,hasVisual:e.hasVisual})}(e,t)}},selection:{getContent:function(t,n){return bv(e,t,n)}},raw:{getModel:function(){return F.none()}}}},Ov=function(e){return Ce(e.plugins,"rtc")},Iv=function(e){var t=e;return function(e){return we(e.plugins,"rtc").bind((function(e){return F.from(e.setup)}))}(e).fold((function(){return t.rtcInstance=Dv(e),F.none()}),(function(e){return t.rtcInstance=function(){var e=E(null),t=E("");return{undoManager:{beforeChange:S,add:e,undo:e,redo:e,clear:S,reset:S,hasUndo:I,hasRedo:I,transact:e,ignore:S,extra:S},formatter:{match:I,matchAll:E([]),matchNode:E(void 0),canApply:I,closest:t,apply:S,remove:S,toggle:S,formatChanged:E({unbind:S})},editor:{getContent:t,setContent:t,insertContent:S,addVisual:S},selection:{getContent:t},raw:{getModel:E(F.none())}}}(),F.some((function(){return e().then((function(e){return t.rtcInstance=function(e){var t=function(e){return p(e)?e:{}},n=e.undoManager,r=e.formatter,o=e.editor,i=e.selection,a=e.raw;return{undoManager:{beforeChange:n.beforeChange,add:n.add,undo:n.undo,redo:n.redo,clear:n.clear,reset:n.reset,hasUndo:n.hasUndo,hasRedo:n.hasRedo,transact:function(e,t,r){return n.transact(r)},ignore:function(e,t){return n.ignore(t)},extra:function(e,t,r,o){return n.extra(r,o)}},formatter:{match:function(e,n,o,i){return r.match(e,t(n),i)},matchAll:r.matchAll,matchNode:r.matchNode,canApply:function(e){return r.canApply(e)},closest:function(e){return r.closest(e)},apply:function(e,n,o){return r.apply(e,t(n))},remove:function(e,n,o,i){return r.remove(e,t(n))},toggle:function(e,n,o){return r.toggle(e,t(n))},formatChanged:function(e,t,n,o,i){return r.formatChanged(t,n,o,i)}},editor:{getContent:function(e,t){return o.getContent(e)},setContent:function(e,t){return o.setContent(e,t)},insertContent:function(e,t){return o.insertContent(e)},addVisual:o.addVisual},selection:{getContent:function(e,t){return i.getContent(t)}},raw:{getModel:function(){return F.some(a.getRawModel())}}}}(e),e.rtc.isRemote}))}))}))},Pv=function(e){return e.rtcInstance?e.rtcInstance:Dv(e)},Bv=function(e){var t=e.rtcInstance;if(t)return t;throw new Error("Failed to get RTC instance not yet initialized.")},Mv=function(e,t){return void 0===t&&(t={}),function(e,t,n){return Bv(e).selection.getContent(t,n)}(e,t.format?t.format:"html",t)},Lv=function(e){return 0===e.dom.length?(cn(e),F.none()):F.some(e)},Fv=function(e,t,n,r){e.bind((function(e){return(r?zp:Up)(e.dom,r?e.dom.length:0),t.filter(Dt).map((function(t){return function(e,t,n,r){var o=e.dom,i=t.dom,a=r?o.length:i.length;r?(Wp(o,i,!1,!r),n.setStart(i,a)):(Wp(i,o,!1,!r),n.setEnd(i,a))}(e,t,n,r)}))})).orThunk((function(){return function(e,t){return e.filter((function(e){return Ff.isBookmarkNode(e.dom)})).bind(t?jt:Ft)}(t,r).or(t).filter(Dt).map((function(e){return function(e,t){Lt(e).each((function(n){var r=e.dom;t&&Op(n,gu(r,0))?Up(r,0):!t&&Ip(n,gu(r,r.length))&&zp(r,r.length)}))}(e,r)}))}))},jv=function(e,t,n){void 0===n&&(n={});var r=function(e,t){return De(De({format:"html"},e),{set:!0,selection:!0,content:t})}(n,t),o=r;if(!r.no_events){var i=e.fire("BeforeSetContent",r);if(i.isDefaultPrevented())return void e.fire("SetContent",i);o=i}o.content=function(e,t){if("raw"!==t.format){var n=e.selection.getRng(),r=e.dom.getParent(n.commonAncestorContainer,e.dom.isBlock),o=r?{context:r.nodeName.toLowerCase()}:{},i=e.parser.parse(t.content,De(De({isRootContent:!0,forced_root_block:!1},o),t));return jm({validate:e.validate},e.schema).serialize(i)}return t.content}(e,o);var a=e.selection.getRng();!function(e,t){var n=F.from(t.firstChild).map(wt.fromDom),r=F.from(t.lastChild).map(wt.fromDom);e.deleteContents(),e.insertNode(t);var o=n.bind(Ft).filter(Dt).bind(Lv),i=r.bind(jt).filter(Dt).bind(Lv);Fv(o,n,e,!0),Fv(i,r,e,!1),e.collapse(!1)}(a,a.createContextualFragment(o.content)),e.selection.setRng(a),Nd(e,a),o.no_events||e.fire("SetContent",o)},Hv=function(e,t,n){if(e&&Ce(e,t)){var r=J(e[t],(function(e){return e!==n}));0===r.length?delete e[t]:e[t]=r}};var Uv,zv,Wv=function(e){return!!e.select},Vv=function(e){return!(!e||!e.ownerDocument)&&Et(wt.fromDom(e.ownerDocument),wt.fromDom(e))},qv=function(e,t,n,r){var o,i,a=function(e,t){var n,r,o=function(t,n){return Z(n,(function(n){return e.is(n,t)}))},i=function(t){return e.getParents(t,null,e.getRoot())};return{selectorChangedWithUnbind:function(e,a){return n||(n={},r={},t.on("NodeChange",(function(e){var t=e.element,a=i(t),c={};bt.each(n,(function(e,t){o(t,a).each((function(n){r[t]||($(e,(function(e){e(!0,{node:n,selector:t,parents:a})})),r[t]=e),c[t]=e}))})),bt.each(r,(function(e,n){c[n]||(delete r[n],bt.each(e,(function(e){e(!1,{node:t,selector:n,parents:a})})))}))}))),n[e]||(n[e]=[]),n[e].push(a),o(e,i(t.selection.getStart())).each((function(){r[e]=n[e]})),{unbind:function(){Hv(n,e,a),Hv(r,e,a)}}}}}(e,r).selectorChangedWithUnbind,c=function(e,t){return jv(r,e,t)},u=function(e){var t=s();t.collapse(!!e),f(t)},l=function(){return t.getSelection?t.getSelection():t.document.selection},s=function(){var n,a,c,u=function(e,t,n){try{return t.compareBoundaryPoints(e,n)}catch(e){return-1}},s=t.document;if(void 0!==r.bookmark&&!1===im(r)){var f=Kd(r);if(f.isSome())return f.map((function(e){return mm(r,[e])[0]})).getOr(s.createRange())}try{(n=l())&&!wn(n.anchorNode)&&(a=n.rangeCount>0?n.getRangeAt(0):n.createRange?n.createRange():s.createRange(),a=mm(r,[a])[0])}catch(e){}return a||(a=s.createRange?s.createRange():s.body.createTextRange()),a.setStart&&9===a.startContainer.nodeType&&a.collapsed&&(c=e.getRoot(),a.setStart(c,0),a.setEnd(c,0)),o&&i&&(0===u(a.START_TO_START,a,o)&&0===u(a.END_TO_END,a,o)?a=i:(o=null,i=null)),a},f=function(e,t){var n;if(function(e){return!!e&&(!!Wv(e)||Vv(e.startContainer)&&Vv(e.endContainer))}(e)){var a=Wv(e)?e:null;if(a){i=null;try{a.select()}catch(e){}}else{var c=l();if(e=r.fire("SetSelectionRange",{range:e,forward:t}).range,c){i=e;try{c.removeAllRanges(),c.addRange(e)}catch(e){}!1===t&&c.extend&&(c.collapse(e.endContainer,e.endOffset),c.extend(e.startContainer,e.startOffset)),o=c.rangeCount>0?c.getRangeAt(0):null}e.collapsed||e.startContainer!==e.endContainer||!c.setBaseAndExtent||mt.ie||e.endOffset-e.startOffset<2&&e.startContainer.hasChildNodes()&&(n=e.startContainer.childNodes[e.startOffset])&&"IMG"===n.tagName&&(c.setBaseAndExtent(e.startContainer,e.startOffset,e.endContainer,e.endOffset),c.anchorNode===e.startContainer&&c.focusNode===e.endContainer||c.setBaseAndExtent(n,0,n,1)),r.fire("AfterSetSelectionRange",{range:e,forward:t})}}},d=function(){var t=l(),n=null==t?void 0:t.anchorNode,r=null==t?void 0:t.focusNode;if(!t||!n||!r||wn(n)||wn(r))return!0;var o=e.createRng();o.setStart(n,t.anchorOffset),o.collapse(!0);var i=e.createRng();return i.setStart(r,t.focusOffset),i.collapse(!0),o.compareBoundaryPoints(o.START_TO_START,i)<=0},m={bookmarkManager:null,controlSelection:null,dom:e,win:t,serializer:n,editor:r,collapse:u,setCursorLocation:function(t,n){var o=e.createRng();w(t)&&w(n)?(o.setStart(t,n),o.setEnd(t,n),f(o),u(!1)):(Af(e,o,r.getBody(),!0),f(o))},getContent:function(e){return Mv(r,e)},setContent:c,getBookmark:function(e,t){return p.getBookmark(e,t)},moveToBookmark:function(e){return p.moveToBookmark(e)},select:function(t,n){return function(e,t,n){return F.from(t).map((function(t){var r=e.nodeIndex(t),o=e.createRng();return o.setStart(t.parentNode,r),o.setEnd(t.parentNode,r+1),n&&(Af(e,o,t,!0),Af(e,o,t,!1)),o}))}(e,t,n).each(f),t},isCollapsed:function(){var e=s(),t=l();return!(!e||e.item)&&(e.compareEndPoints?0===e.compareEndPoints("StartToEnd",e):!t||e.collapsed)},isForward:d,setNode:function(t){return c(e.getOuterHTML(t)),t},getNode:function(){return function(e,t){var n,r,o;if(!t)return e;r=t.startContainer,o=t.endContainer;var i=t.startOffset,a=t.endOffset;return n=t.commonAncestorContainer,!t.collapsed&&(r===o&&a-i<2&&r.hasChildNodes()&&(n=r.childNodes[i]),3===r.nodeType&&3===o.nodeType&&(r=r.length===i?dm(r.nextSibling,!0):r.parentNode,o=0===a?dm(o.previousSibling,!1):o.parentNode,r&&r===o))?r:n&&3===n.nodeType?n.parentNode:n}(r.getBody(),s())},getSel:l,setRng:f,getRng:s,getStart:function(e){return sm(r.getBody(),s(),e)},getEnd:function(e){return fm(r.getBody(),s(),e)},getSelectedBlocks:function(t,n){return function(e,t,n,r){var o,i=[],a=e.getRoot();if(n=e.getParent(n||sm(a,t,t.collapsed),e.isBlock),r=e.getParent(r||fm(a,t,t.collapsed),e.isBlock),n&&n!==a&&i.push(n),n&&r&&n!==r){o=n;for(var c=new Yr(n,a);(o=c.next())&&o!==r;)e.isBlock(o)&&i.push(o)}return r&&n!==r&&r!==a&&i.push(r),i}(e,s(),t,n)},normalize:function(){var t=s(),n=l();if(!(yf(n).length>1)&&_f(r)){var o=od(e,t);return o.each((function(e){f(e,d())})),o.getOr(t)}return t},selectorChanged:function(e,t){return a(e,t),m},selectorChangedWithUnbind:a,getScrollContainer:function(){for(var t,n=e.getRoot();n&&"BODY"!==n.nodeName;){if(n.scrollHeight>n.clientHeight){t=n;break}n=n.parentNode}return t},scrollIntoView:function(e,t){w(e)?function(e,t,n){(e.inline?Ed:_d)(e,t,n)}(r,e,t):Nd(r,s(),t)},placeCaretAt:function(e,t){return f(Gf(e,t,r.getDoc()))},getBoundingClientRect:function(){var e=s();return e.collapsed?gu.fromRangeStart(e).getClientRects()[0]:e.getBoundingClientRect()},destroy:function(){t=o=i=null,g.destroy()}},p=Ff(m),g=$f(m,r);return m.bookmarkManager=p,m.controlSelection=g,m},$v=function(e,t,n){e.addNodeFilter("font",(function(e){$(e,(function(e){var r=t.parse(e.attr("style")),o=e.attr("color"),i=e.attr("face"),a=e.attr("size");o&&(r.color=o),i&&(r["font-family"]=i),a&&(r["font-size"]=n[parseInt(e.attr("size"),10)-1]),e.name="span",e.attr("style",t.serialize(r)),function(e,t){$(t,(function(t){e.attr(t,null)}))}(e,["color","face","size"])}))}))},Kv=function(e,t){var n=yi();t.convert_fonts_to_spans&&$v(e,n,bt.explode(t.font_size_legacy_values)),function(e,t){e.addNodeFilter("strike",(function(e){$(e,(function(e){var n=t.parse(e.attr("style"));n["text-decoration"]="line-through",e.name="span",e.attr("style",t.serialize(n))}))}))}(e,n)},Gv=function(e){var t,n=decodeURIComponent(e).split(","),r=/data:([^;]+)/.exec(n[0]);return r&&(t=r[1]),{type:t,data:n[1]}},Jv=function(e,t){var n;try{n=atob(t)}catch(e){return F.none()}for(var r=new Uint8Array(n.length),o=0;o<r.length;o++)r[o]=n.charCodeAt(o);return F.some(new Blob([r],{type:e}))},Xv=function(e){return 0===e.indexOf("blob:")?function(e){return new Vr((function(t,n){var r=function(){n("Cannot convert "+e+" to Blob. Resource might not exist or is inaccessible.")};try{var o=new XMLHttpRequest;o.open("GET",e,!0),o.responseType="blob",o.onload=function(){200===o.status?t(o.response):r()},o.onerror=r,o.send()}catch(e){r()}}))}(e):0===e.indexOf("data:")?(t=e,new Vr((function(e){var n=Gv(t),r=n.type,o=n.data;Jv(r,o).fold((function(){return e(new Blob([]))}),e)}))):null;var t},Yv=0,Qv=function(e){return(e||"blobid")+Yv++},Zv=function(e,t,n,r){var o,i;if(0!==t.src.indexOf("blob:")){var a=Gv(t.src),c=a.data,u=a.type;o=c,(i=e.getByData(o,u))?n({image:t,blobInfo:i}):Xv(t.src).then((function(r){i=e.create(Qv(),r,o),e.add(i),n({image:t,blobInfo:i})}),(function(e){r(e)}))}else(i=e.getByUri(t.src))?n({image:t,blobInfo:i}):Xv(t.src).then((function(r){(function(e){return new Vr((function(t){var n=new FileReader;n.onloadend=function(){t(n.result)},n.readAsDataURL(e)}))})(r).then((function(a){o=Gv(a).data,i=e.create(Qv(),r,o),e.add(i),n({image:t,blobInfo:i})}))}),(function(e){r(e)}))},eb=function(e,t){var n={};return{findAll:function(r,o){o||(o=P);var i=J(function(e){return e?le(e.getElementsByTagName("img")):[]}(r),(function(t){var n=t.src;return!!mt.fileApi&&(!t.hasAttribute("data-mce-bogus")&&(!t.hasAttribute("data-mce-placeholder")&&(!(!n||n===mt.transparentSrc)&&(0===n.indexOf("blob:")?!e.isUploaded(n)&&o(t):0===n.indexOf("data:")&&o(t)))))})),a=q(i,(function(e){if(void 0!==n[e.src])return new Vr((function(t){n[e.src].then((function(n){if("string"==typeof n)return n;t({image:e,blobInfo:n.blobInfo})}))}));var r=new Vr((function(n,r){Zv(t,e,n,r)})).then((function(e){return delete n[e.image.src],e})).catch((function(t){return delete n[e.src],t}));return n[e.src]=r,r}));return Vr.all(a)}}},tb=function(e,t,n,r){(e.padd_empty_with_br||t.insert)&&n[r.name]?r.empty().append(new bm("br",1)).shortEnded=!0:r.empty().append(new bm("#text",3)).value=""},nb=function(e,t){return e&&e.firstChild&&e.firstChild===e.lastChild&&e.firstChild.name===t},rb=function(e,t,n,r){return r.isEmpty(t,n,(function(t){return function(e,t){var n=e.getElementRule(t.name);return n&&n.paddEmpty}(e,t)}))},ob=function(e,t){var n=t.blob_cache,r=function(e){var r=e.attr("src");(function(e){return e.attr("src")===mt.transparentSrc||w(e.attr("data-mce-placeholder"))})(e)||function(e){return w(e.attr("data-mce-bogus"))}(e)||function(e){var t=/data:([^;]+);base64,([a-z0-9\+\/=\s]+)/i.exec(e);return t?F.some({type:t[1],data:decodeURIComponent(t[2])}):F.none()}(r).filter((function(){return function(e,t){if(t.images_dataimg_filter){var n=new Image;return n.src=e.attr("src"),me(e.attributes.map,(function(e,t){n.setAttribute(t,e)})),t.images_dataimg_filter(n)}return!0}(e,t)})).bind((function(e){var t=e.type,r=e.data;return F.from(n.getByData(r,t)).orThunk((function(){return Jv(t,r).map((function(e){var t=n.create(Qv(),e,r);return n.add(t),t}))}))})).each((function(t){e.attr("src",t.blobUri())}))};n&&e.addAttributeFilter("src",(function(e){return $(e,r)}))},ib=bt.makeMap,ab=bt.each,cb=bt.explode,ub=bt.extend,lb=function(e,t){void 0===t&&(t=vi());var n={},r=[],o={},i={};(e=e||{}).validate=!("validate"in e)||e.validate,e.root_name=e.root_name||"body";var a=function(e){var t=e.name;t in n&&((c=o[t])?c.push(e):o[t]=[e]);for(var a=r.length;a--;){var c,u=r[a].name;if(u in e.attributes.map)(c=i[u])?c.push(e):i[u]=[e]}return e},c={schema:t,addAttributeFilter:function(e,t){ab(cb(e),(function(e){var n;for(n=0;n<r.length;n++)if(r[n].name===e)return void r[n].callbacks.push(t);r.push({name:e,callbacks:[t]})}))},getAttributeFilters:function(){return[].concat(r)},addNodeFilter:function(e,t){ab(cb(e),(function(e){var r=n[e];r||(n[e]=r=[]),r.push(t)}))},getNodeFilters:function(){var e=[];for(var t in n)Ce(n,t)&&e.push({name:t,callbacks:n[t]});return e},filterNode:a,parse:function(c,u){var l,s,f,d,m,p,g,h,v=[];u=u||{},o={},i={};var b=ub(ib("script,style,head,html,body,title,meta,param"),t.getBlockElements()),y=t.getNonEmptyElements(),w=t.children,C=e.validate,x=function(e){return!1===e?"":!0===e?"p":e}("forced_root_block"in u?u.forced_root_block:e.forced_root_block),S=t.getWhiteSpaceElements(),k=/^[ \t\r\n]+/,T=/[ \t\r\n]+$/,E=/[ \t\r\n]+/g,A=/^[ \t\r\n]+$/,_=Ce(S,u.context)||Ce(S,e.root_name),N=function(e,t){var r,i=new bm(e,t);return e in n&&((r=o[e])?r.push(i):o[e]=[i]),i},R=function(e){for(var n=t.getBlockElements(),r=e.prev;r&&3===r.type;){var o=r.value.replace(T,"");if(o.length>0)return void(r.value=o);var i=r.next;if(i){if(3===i.type&&i.value.length){r=r.prev;continue}if(!n[i.name]&&"script"!==i.name&&"style"!==i.name){r=r.prev;continue}}var a=r.prev;r.remove(),r=a}},D=Dm({validate:C,document:e.document,allow_html_data_urls:e.allow_html_data_urls,allow_svg_data_urls:e.allow_svg_data_urls,allow_script_urls:e.allow_script_urls,allow_conditional_comments:e.allow_conditional_comments,preserve_cdata:e.preserve_cdata,self_closing_elements:function(e){var t={};for(var n in e)"li"!==n&&"p"!==n&&(t[n]=e[n]);return t}(t.getSelfClosingElements()),cdata:function(e){h.append(N("#cdata",4)).value=e},text:function(e,t){var n;_||(e=e.replace(E," "),function(e,t){return e&&(Ce(t,e.name)||"br"===e.name)}(h.lastChild,b)&&(e=e.replace(k,""))),0!==e.length&&((n=N("#text",3)).raw=!!t,h.append(n).value=e)},comment:function(e){h.append(N("#comment",8)).value=e},pi:function(e,t){h.append(N(e,7)).value=t,R(h)},doctype:function(e){h.append(N("#doctype",10)).value=e,R(h)},start:function(e,n,o){var a=C?t.getElementRule(e):{};if(a){var c=N(a.outputName||e,1);c.attributes=n,c.shortEnded=o,h.append(c);var u=w[h.name];u&&w[c.name]&&!u[c.name]&&v.push(c);for(var l=r.length;l--;){var s=r[l].name;s in n.map&&((p=i[s])?p.push(c):i[s]=[c])}b[e]&&R(c),o||(h=c),!_&&S[e]&&(_=!0)}},end:function(n){var r,o,i,a,c=C?t.getElementRule(n):{};if(c){if(b[n]&&!_){if((r=h.firstChild)&&3===r.type)if((o=r.value.replace(k,"")).length>0)r.value=o,r=r.next;else for(i=r.next,r.remove(),r=i;r&&3===r.type;)o=r.value,i=r.next,(0===o.length||A.test(o))&&(r.remove(),r=i),r=i;if((r=h.lastChild)&&3===r.type)if((o=r.value.replace(T,"")).length>0)r.value=o,r=r.prev;else for(i=r.prev,r.remove(),r=i;r&&3===r.type;)o=r.value,i=r.prev,(0===o.length||A.test(o))&&(r.remove(),r=i),r=i}if(_&&S[n]&&(_=!1),c.removeEmpty&&rb(t,y,S,h))return a=h.parent,b[h.name]?h.empty().remove():h.unwrap(),void(h=a);c.paddEmpty&&(function(e){return nb(e,"#text")&&""===e.firstChild.value}(h)||rb(t,y,S,h))&&tb(e,u,b,h),h=h.parent}}},t),O=h=new bm(u.context||e.root_name,11);if(D.parse(c,u.format),C&&v.length&&(u.context?u.invalid=!0:function(e){for(var n=ib("tr,td,th,tbody,thead,tfoot,table"),r=t.getNonEmptyElements(),o=t.getWhiteSpaceElements(),i=t.getTextBlockElements(),c=t.getSpecialElements(),u=function(e,n){if(void 0===n&&(n=e.parent),c[e.name])e.empty().remove();else{for(var r=0,o=e.children();r<o.length;r++){var i=o[r];t.isValidChild(n.name,i.name)||u(i,n)}e.unwrap()}},l=0;l<e.length;l++){var s=e[l],f=void 0,d=void 0,m=void 0;if(s.parent&&!s.fixed)if(i[s.name]&&"li"===s.parent.name){for(var p=s.next;p&&i[p.name];)p.name="li",p.fixed=!0,s.parent.insert(p,s.parent),p=p.next;s.unwrap()}else{var g=[s];for(f=s.parent;f&&!t.isValidChild(f.name,s.name)&&!n[f.name];f=f.parent)g.push(f);if(f&&g.length>1)if(t.isValidChild(f.name,s.name)){g.reverse();for(var h=d=a(g[0].clone()),v=0;v<g.length-1;v++){t.isValidChild(h.name,g[v].name)?(m=a(g[v].clone()),h.append(m)):m=h;for(var b=g[v].firstChild;b&&b!==g[v+1];){var y=b.next;m.append(b),b=y}h=m}rb(t,r,o,d)?f.insert(s,g[0],!0):(f.insert(d,g[0],!0),f.insert(s,d)),f=g[0],(rb(t,r,o,f)||nb(f,"br"))&&f.empty().remove()}else u(s);else if(s.parent){if("li"===s.name){if((p=s.prev)&&("ul"===p.name||"ol"===p.name)){p.append(s);continue}if((p=s.next)&&("ul"===p.name||"ol"===p.name)){p.insert(s,p.firstChild,!0);continue}s.wrap(a(new bm("ul",1)));continue}t.isValidChild(s.parent.name,"div")&&t.isValidChild("div",s.name)?s.wrap(a(new bm("div",1))):u(s)}}}}(v)),x&&("body"===O.name||u.isRootContent)&&function(){var n=O.firstChild,r=null,o=function(e){e&&((n=e.firstChild)&&3===n.type&&(n.value=n.value.replace(k,"")),(n=e.lastChild)&&3===n.type&&(n.value=n.value.replace(T,"")))};if(t.isValidChild(O.name,x.toLowerCase())){for(;n;){var i=n.next;3===n.type||1===n.type&&"p"!==n.name&&!b[n.name]&&!n.attr("data-mce-type")?(r||((r=N(x,1)).attr(e.forced_root_block_attrs),O.insert(r,n)),r.append(n)):(o(r),r=null),n=i}o(r)}}(),!u.invalid){for(g in o)if(Ce(o,g)){for(p=n[g],d=(l=o[g]).length;d--;)l[d].parent||l.splice(d,1);for(s=0,f=p.length;s<f;s++)p[s](l,g,u)}for(s=0,f=r.length;s<f;s++)if((p=r[s]).name in i){for(d=(l=i[p.name]).length;d--;)l[d].parent||l.splice(d,1);for(d=0,m=p.callbacks.length;d<m;d++)p.callbacks[d](l,p.name,u)}}return O}};return function(e,t){var n=e.schema;t.remove_trailing_brs&&e.addNodeFilter("br",(function(e,r,o){var i,a,c,u,l,s,f,d,m=e.length,p=bt.extend({},n.getBlockElements()),g=n.getNonEmptyElements(),h=n.getWhiteSpaceElements();for(p.body=1,i=0;i<m;i++)if(c=(a=e[i]).parent,p[a.parent.name]&&a===c.lastChild){for(l=a.prev;l;){if("span"!==(s=l.name)||"bookmark"!==l.attr("data-mce-type")){"br"===s&&(a=null);break}l=l.prev}a&&(a.remove(),rb(n,g,h,c)&&(f=n.getElementRule(c.name))&&(f.removeEmpty?c.remove():f.paddEmpty&&tb(t,o,p,c)))}else{for(u=a;c&&c.firstChild===u&&c.lastChild===u&&(u=c,!p[c.name]);)c=c.parent;u===c&&!0!==t.padd_empty_with_br&&((d=new bm("#text",3)).value="",a.replace(d))}})),e.addAttributeFilter("href",(function(e){var n,r,o=e.length;if(!t.allow_unsafe_link_target)for(;o--;){var i=e[o];"a"===i.name&&"_blank"===i.attr("target")&&i.attr("rel",(n=i.attr("rel"),r=void 0,r=n?bt.trim(n):"",/\b(noopener)\b/g.test(r)?r:function(e){return e.split(" ").filter((function(e){return e.length>0})).concat(["noopener"]).sort().join(" ")}(r)))}})),t.allow_html_in_named_anchor||e.addAttributeFilter("id,name",(function(e){for(var t,n,r,o,i=e.length;i--;)if("a"===(o=e[i]).name&&o.firstChild&&!o.attr("href")){r=o.parent,t=o.lastChild;do{n=t.prev,r.insert(t,o),t=n}while(t)}})),t.fix_list_elements&&e.addNodeFilter("ul,ol",(function(e){for(var t,n,r=e.length;r--;)if("ul"===(n=(t=e[r]).parent).name||"ol"===n.name)if(t.prev&&"li"===t.prev.name)t.prev.append(t);else{var o=new bm("li",1);o.attr("style","list-style-type: none"),t.wrap(o)}})),t.validate&&n.getValidClasses()&&e.addAttributeFilter("class",(function(e){for(var t=n.getValidClasses(),r=e.length;r--;){for(var o=e[r],i=o.attr("class").split(" "),a="",c=0;c<i.length;c++){var u=i[c],l=!1,s=t["*"];s&&s[u]&&(l=!0),s=t[o.name],!l&&s&&s[u]&&(l=!0),l&&(a&&(a+=" "),a+=u)}a.length||(a=null),o.attr("class",a)}})),ob(e,t)}(c,e),function(e,t){t.inline_styles&&Kv(e,t)}(c,e),c},sb=function(e,t,n){return function(e,t){return e&&e.hasEventListeners("PreProcess")&&!t.no_events}(e,n)?function(e,t,n){var r,o=e.dom,i=t.cloneNode(!0),a=document.implementation;if(a.createHTMLDocument){var c=a.createHTMLDocument("");bt.each("BODY"===i.nodeName?i.childNodes:[i],(function(e){c.body.appendChild(c.importNode(e,!0))})),i="BODY"!==i.nodeName?c.body.firstChild:c.body,r=o.doc,o.doc=c}return function(e,t){e.fire("PreProcess",t)}(e,De(De({},n),{node:i})),r&&(o.doc=r),i}(e,t,n):t},fb=function(e,t,n){-1===bt.inArray(t,n)&&(e.addAttributeFilter(n,(function(e,t){for(var n=e.length;n--;)e[n].attr(t,null)})),t.push(n))},db=function(e,t,n,r,o){return function(e,t,n){return!t.no_events&&e?function(e,t){return e.fire("PostProcess",t)}(e,De(De({},t),{content:n})).content:n}(e,o,function(e,t,n){return jm(e,t).serialize(n)}(t,n,r))},mb=function(e,t){var n=["data-mce-selected"],r=t&&t.dom?t.dom:nc.DOM,o=t&&t.schema?t.schema:vi(e);e.entity_encoding=e.entity_encoding||"named",e.remove_trailing_brs=!("remove_trailing_brs"in e)||e.remove_trailing_brs;var i=lb(e,o);!function(e,t,n){e.addAttributeFilter("data-mce-tabindex",(function(e,t){for(var n=e.length;n--;){var r=e[n];r.attr("tabindex",r.attr("data-mce-tabindex")),r.attr(t,null)}})),e.addAttributeFilter("src,href,style",(function(e,r){for(var o="data-mce-"+r,i=t.url_converter,a=t.url_converter_scope,c=e.length;c--;){var u=e[c],l=u.attr(o);void 0!==l?(u.attr(r,l.length>0?l:null),u.attr(o,null)):(l=u.attr(r),"style"===r?l=n.serializeStyle(n.parseStyle(l),u.name):i&&(l=i.call(a,l,r,u.name)),u.attr(r,l.length>0?l:null))}})),e.addAttributeFilter("class",(function(e){for(var t=e.length;t--;){var n=e[t],r=n.attr("class");r&&(r=n.attr("class").replace(/(?:^|\s)mce-item-\w+(?!\S)/g,""),n.attr("class",r.length>0?r:null))}})),e.addAttributeFilter("data-mce-type",(function(e,t,n){for(var r=e.length;r--;){var o=e[r];if("bookmark"===o.attr("data-mce-type")&&!n.cleanup)F.from(o.firstChild).exists((function(e){return!lo(e.value)}))?o.unwrap():o.remove()}})),e.addNodeFilter("noscript",(function(e){for(var t=e.length;t--;){var n=e[t].firstChild;n&&(n.value=ci.decode(n.value))}})),e.addNodeFilter("script,style",(function(e,n){for(var r=function(e){return e.replace(/(<!--\[CDATA\[|\]\]-->)/g,"\n").replace(/^[\r\n]*|[\r\n]*$/g,"").replace(/^\s*((<!--)?(\s*\/\/)?\s*<!\[CDATA\[|(<!--\s*)?\/\*\s*<!\[CDATA\[\s*\*\/|(\/\/)?\s*<!--|\/\*\s*<!--\s*\*\/)\s*[\r\n]*/gi,"").replace(/\s*(\/\*\s*\]\]>\s*\*\/(-->)?|\s*\/\/\s*\]\]>(-->)?|\/\/\s*(-->)?|\]\]>|\/\*\s*-->\s*\*\/|\s*-->\s*)\s*$/g,"")},o=e.length;o--;){var i=e[o],a=i.firstChild?i.firstChild.value:"";if("script"===n){var c=i.attr("type");c&&i.attr("type","mce-no/type"===c?null:c.replace(/^mce\-/,"")),"xhtml"===t.element_format&&a.length>0&&(i.firstChild.value="// <![CDATA[\n"+r(a)+"\n// ]]>")}else"xhtml"===t.element_format&&a.length>0&&(i.firstChild.value="\x3c!--\n"+r(a)+"\n--\x3e")}})),e.addNodeFilter("#comment",(function(e){for(var r=e.length;r--;){var o=e[r];t.preserve_cdata&&0===o.value.indexOf("[CDATA[")?(o.name="#cdata",o.type=4,o.value=n.decode(o.value.replace(/^\[CDATA\[|\]\]$/g,""))):0===o.value.indexOf("mce:protected ")&&(o.name="#text",o.type=3,o.raw=!0,o.value=unescape(o.value).substr(14))}})),e.addNodeFilter("xml:namespace,input",(function(e,t){for(var n=e.length;n--;){var r=e[n];7===r.type?r.remove():1===r.type&&("input"!==t||r.attr("type")||r.attr("type","text"))}})),e.addAttributeFilter("data-mce-type",(function(t){$(t,(function(t){"format-caret"===t.attr("data-mce-type")&&(t.isEmpty(e.schema.getNonEmptyElements())?t.remove():t.unwrap())}))})),e.addAttributeFilter("data-mce-src,data-mce-href,data-mce-style,data-mce-selected,data-mce-expando,data-mce-type,data-mce-resize,data-mce-placeholder",(function(e,t){for(var n=e.length;n--;)e[n].attr(t,null)}))}(i,e,r);return{schema:o,addNodeFilter:i.addNodeFilter,addAttributeFilter:i.addAttributeFilter,serialize:function(n,a){void 0===a&&(a={});var c=De({format:"html"},a),u=sb(t,n,c),l=function(e,t,n){var r=so(n.getInner?t.innerHTML:e.getOuterHTML(t));return n.selection||uo(wt.fromDom(t))?r:bt.trim(r)}(r,u,c),s=function(e,t,n){var r=n.selection?De({forced_root_block:!1},n):n,o=e.parse(t,r);return function(e){var t=function(e){return e&&"br"===e.name},n=e.lastChild;if(t(n)){var r=n.prev;t(r)&&(n.remove(),r.remove())}}(o),o}(i,l,c);return"tree"===c.format?s:db(t,e,o,s,c)},addRules:o.addValidElements,setRules:o.setValidElements,addTempAttr:N(fb,i,n),getTempAttrs:E(n),getNodeFilters:i.getNodeFilters,getAttributeFilters:i.getAttributeFilters}},pb=function(e,t){var n=mb(e,t);return{schema:n.schema,addNodeFilter:n.addNodeFilter,addAttributeFilter:n.addAttributeFilter,serialize:n.serialize,addRules:n.addRules,setRules:n.setRules,addTempAttr:n.addTempAttr,getTempAttrs:n.getTempAttrs,getNodeFilters:n.getNodeFilters,getAttributeFilters:n.getAttributeFilters}},gb=function(e,t){return void 0===t&&(t={}),function(e,t,n){return Pv(e).editor.getContent(t,n)}(e,t,t.format?t.format:"html")},hb=function(e,t,n){return void 0===n&&(n={}),function(e,t,n){return Pv(e).editor.setContent(t,n)}(e,t,n)},vb=nc.DOM,bb=function(e){return F.from(e).each((function(e){return e.destroy()}))},yb=function(e){if(!e.removed){var t=e._selectionOverrides,n=e.editorUpload,r=e.getBody(),o=e.getElement();r&&e.save({is_removing:!0}),e.removed=!0,e.unbindAllNativeEvents(),e.hasHiddenInput&&o&&vb.remove(o.nextSibling),function(e){e.fire("remove")}(e),e.editorManager.remove(e),!e.inline&&r&&function(e){vb.setStyle(e.id,"display",e.orgDisplay)}(e),function(e){e.fire("detach")}(e),vb.remove(e.getContainer()),bb(t),bb(n),e.destroy()}},wb=function(e,t){var n=e.selection,r=e.dom;e.destroyed||(t||e.removed?(t||(e.editorManager.off("beforeunload",e._beforeUnload),e.theme&&e.theme.destroy&&e.theme.destroy(),bb(n),bb(r)),function(e){var t=e.formElement;t&&(t._mceOldSubmit&&(t.submit=t._mceOldSubmit,t._mceOldSubmit=null),vb.unbind(t,"submit reset",e.formEventDelegate))}(e),function(e){e.contentAreaContainer=e.formElement=e.container=e.editorContainer=null,e.bodyElement=e.contentDocument=e.contentWindow=null,e.iframeElement=e.targetElm=null,e.selection&&(e.selection=e.selection.win=e.selection.dom=e.selection.dom.doc=null)}(e),e.destroyed=!0):e.remove())},Cb=(Uv=function(e,t){return p(e)&&p(t)?Cb(e,t):t},function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(0===e.length)throw new Error("Can't merge zero objects");for(var n={},r=0;r<e.length;r++){var o=e[r];for(var i in o)Ce(o,i)&&(n[i]=Uv(n[i],o[i]))}return n}),xb="autoresize_on_init,content_editable_state,convert_fonts_to_spans,inline_styles,padd_empty_with_br,block_elements,boolean_attributes,editor_deselector,editor_selector,elements,file_browser_callback_types,filepicker_validator_handler,force_hex_style_colors,force_p_newlines,gecko_spellcheck,images_dataimg_filter,media_scripts,mode,move_caret_before_on_enter_elements,non_empty_elements,self_closing_elements,short_ended_elements,special,spellchecker_select_languages,spellchecker_whitelist,tab_focus,table_responsive_width,text_block_elements,text_inline_elements,toolbar_drawer,types,validate,whitespace_elements,paste_word_valid_elements,paste_retain_style_properties,paste_convert_word_fake_lists".split(","),Sb="bbcode,colorpicker,contextmenu,fullpage,legacyoutput,spellchecker,textcolor".split(","),kb="imagetools,toc".split(","),Tb=function(e){var t=J(xb,(function(t){return Ce(e,t)})),n=e.forced_root_block;return!1!==n&&""!==n||t.push("forced_root_block (false only)"),ie(t)},Eb=function(e){var t=bt.makeMap(e.plugins," "),n=function(e){return Ce(t,e)},r=Oe(Oe([],J(Sb,n),!0),te(kb,(function(e){return n(e)?[e+" (moving to premium)"]:[]})),!0);return ie(r)},Ab=ot().deviceType,_b=Ab.isTouch(),Nb=Ab.isPhone(),Rb=Ab.isTablet(),Db=["lists","autolink","autosave"],Ob={table_grid:!1,object_resizing:!1,resize:!1},Ib=function(e){var t=g(e)?e.join(" "):e,n=q(m(t)?t.split(" "):[],Ue);return J(n,(function(e){return e.length>0}))},Pb=function(e,t){var n,r,o=(r={},ve(t,(function(t,n){return W(e,n)}),he(n={}),he(r)),{t:n,f:r});return function(e,t){return{sections:E(e),settings:E(t)}}(o.t,o.f)},Bb=function(e,t){return Ce(e.sections(),t)},Mb=function(e,t){return we(e,"toolbar_mode").orThunk((function(){return we(e,"toolbar_drawer").map((function(e){return!1===e?"wrap":e}))})).getOr(t)},Lb=function(e,t){var n={resize:!1,toolbar_mode:Mb(e,"scrolling"),toolbar_sticky:!1};return De(De(De({},Ob),n),t?{menubar:!1}:{})},Fb=function(e,t){var n=t.external_plugins?t.external_plugins:{};return e&&e.external_plugins?bt.extend({},e.external_plugins,n):n},jb=function(e,t,n,r){return e&&function(e,t,n){var r=e.sections();return Bb(e,t)&&r[t].theme===n}(t,"mobile","mobile")?J(r,N(W,Db)):e&&Bb(t,"mobile")?r:n},Hb=function(e,t,n,r){var o=Ib(n.forced_plugins),i=Ib(r.plugins),a=function(e,t){return Bb(e,t)?e.sections()[t]:{}}(t,"mobile"),c=a.plugins?Ib(a.plugins):i,u=function(e,t){return[].concat(Ib(e)).concat(Ib(t))}(o,jb(e,t,i,c));if(mt.browser.isIE()&&W(u,"rtc"))throw new Error("RTC plugin is not supported on IE 11.");return bt.extend(r,{plugins:u.join(" ")})},Ub=function(e,t,n,r,o){var i=e?{mobile:Lb(o.mobile||{},t)}:{},a=Pb(["mobile"],Cb(i,o)),c=bt.extend(n,r,a.settings(),function(e,t){return e&&Bb(t,"mobile")}(e,a)?function(e,t,n){void 0===n&&(n={});var r=e.sections(),o=we(r,t).getOr({});return bt.extend({},n,o)}(a,"mobile"):{},{validate:!0,external_plugins:Fb(r,a.settings())});return Hb(e,a,r,c)},zb=function(e,t,n,r,o){var i=function(e,t,n,r,o){var i={id:t,theme:"silver",toolbar_mode:Mb(e,"floating"),plugins:"",document_base_url:n,add_form_submit_trigger:!0,submit_patch:!0,add_unload_trigger:!0,convert_urls:!0,relative_urls:!0,remove_script_host:!0,object_resizing:!0,doctype:"<!DOCTYPE html>",visual:!0,font_size_legacy_values:"xx-small,small,medium,large,x-large,xx-large,300%",forced_root_block:"p",hidden_input:!0,inline_styles:!0,convert_fonts_to_spans:!0,indent:!0,indent_before:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist",indent_after:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist",entity_encoding:"named",url_converter:o.convertURL,url_converter_scope:o};return De(De({},i),r?Ob:{})}(o,t,n,_b,e),a=Ub(Nb||Rb,Nb,i,r,o);return!1!==a.deprecation_warnings&&function(e,t){var n=Tb(e),r=Eb(t),o=r.length>0,i=n.length>0,a="mobile"===t.theme;if(o||i||a){var c=a?"\n\nThemes:\n- mobile":"",u=o?"\n\nPlugins:\n- "+r.join("\n- "):"",l=i?"\n\nSettings:\n- "+n.join("\n- "):"";console.warn("The following deprecated features are currently enabled, these will be removed in TinyMCE 6.0. See https://www.tiny.cloud/docs/release-notes/6.0-upcoming-changes/ for more information."+c+u+l)}}(o,a),a},Wb=function(e,t,n){return F.from(t.settings[n]).filter(e)},Vb=function(e,t,n,r){var o,i=t in e.settings?e.settings[t]:n;return"hash"===r?function(e){var t={};return"string"==typeof e?$(e.indexOf("=")>0?e.split(/[;,](?![^=;,]*(?:[;,]|$))/):e.split(","),(function(e){var n=e.split("=");n.length>1?t[bt.trim(n[0])]=bt.trim(n[1]):t[bt.trim(n[0])]=bt.trim(n[0])})):t=e,t}(i):"string"===r?Wb(m,e,t).getOr(n):"number"===r?Wb(x,e,t).getOr(n):"boolean"===r?Wb(v,e,t).getOr(n):"object"===r?Wb(p,e,t).getOr(n):"array"===r?Wb(g,e,t).getOr(n):"string[]"===r?Wb((o=m,function(e){return g(e)&&ne(e,o)}),e,t).getOr(n):"function"===r?Wb(C,e,t).getOr(n):i},qb=(zv={},{add:function(e,t){zv[e]=t},get:function(e){return zv[e]?zv[e]:{icons:{}}},has:function(e){return Ce(zv,e)}}),$b=function(e,t){return t.dom[e]},Kb=function(e,t){return parseInt(Jn(t,e),10)},Gb=N($b,"clientWidth"),Jb=N($b,"clientHeight"),Xb=N(Kb,"margin-top"),Yb=N(Kb,"margin-left"),Qb=function(e,t,n){var r,o=wt.fromDom(e.getBody()),i=e.inline?o:(r=o,wt.fromDom(Bt(r).dom.documentElement)),a=function(e,t,n,r){var o=function(e){return e.dom.getBoundingClientRect()}(t);return{x:n-(e?o.left+t.dom.clientLeft+Yb(t):0),y:r-(e?o.top+t.dom.clientTop+Xb(t):0)}}(e.inline,i,t,n);return function(e,t,n){var r=Gb(e),o=Jb(e);return t>=0&&n>=0&&t<=r&&n<=o}(i,a.x,a.y)},Zb=function(e){var t,n=e.inline?e.getBody():e.getContentAreaContainer();return(t=n,F.from(t).map(wt.fromDom)).map(ln).getOr(!1)},ey=function(e){var t=[],n=function(){var t,n=e.theme;return n&&n.getNotificationManagerImpl?n.getNotificationManagerImpl():{open:t=function(){throw new Error("Theme did not provide a NotificationManager implementation.")},close:t,reposition:t,getArgs:t}},r=function(){return F.from(t[0])},o=function(){t.length>0&&n().reposition(t)},i=function(e){ee(t,(function(t){return t===e})).each((function(e){t.splice(e,1)}))},a=function(a,c){if(void 0===c&&(c=!0),!e.removed&&Zb(e))return c&&e.fire("BeforeOpenNotification",{notification:a}),Z(t,(function(e){return t=n().getArgs(e),r=a,!(t.type!==r.type||t.text!==r.text||t.progressBar||t.timeout||r.progressBar||r.timeout);var t,r})).getOrThunk((function(){e.editorManager.setActive(e);var c=n().open(a,(function(){i(c),o(),r().fold((function(){return e.focus()}),(function(e){return wt.fromDom(e.getEl()).dom.focus()}))}));return function(e){t.push(e)}(c),o(),e.fire("OpenNotification",{notification:De({},c)}),c}))},c=E(t);return function(e){e.on("SkinLoaded",(function(){var t=function(e){return e.getParam("service_message")}(e);t&&a({text:t,type:"warning",timeout:0},!1),o()})),e.on("show ResizeEditor ResizeWindow NodeChange",(function(){Gr.requestAnimationFrame(o)})),e.on("remove",(function(){$(t.slice(),(function(e){n().close(e)}))}))}(e),{open:a,close:function(){r().each((function(e){n().close(e),i(e),o()}))},getNotifications:c}},ty=dc.PluginManager,ny=dc.ThemeManager;var ry=function(e){var t=[],n=function(){var t,n=e.theme;return n&&n.getWindowManagerImpl?n.getWindowManagerImpl():{open:t=function(){throw new Error("Theme did not provide a WindowManager implementation.")},openUrl:t,alert:t,confirm:t,close:t,getParams:t,setParams:t}},r=function(e,t){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return t?t.apply(e,n):void 0}},o=function(n){t.push(n),function(t){e.fire("OpenWindow",{dialog:t})}(n)},i=function(n){!function(t){e.fire("CloseWindow",{dialog:t})}(n),0===(t=J(t,(function(e){return e!==n}))).length&&e.focus()},a=function(t){e.editorManager.setActive(e),$d(e);var n=t();return o(n),n};return e.on("remove",(function(){$(t,(function(e){n().close(e)}))})),{open:function(e,t){return a((function(){return n().open(e,t,i)}))},openUrl:function(e){return a((function(){return n().openUrl(e,i)}))},alert:function(e,t,o){var i=n();i.alert(e,r(o||i,t))},confirm:function(e,t,o){var i=n();i.confirm(e,r(o||i,t))},close:function(){F.from(t[t.length-1]).each((function(e){n().close(e),i(e)}))}}},oy=function(e,t){e.notificationManager.open({type:"error",text:t})},iy=function(e,t){e._skinLoaded?oy(e,t):e.on("SkinLoaded",(function(){oy(e,t)}))},ay=function(e,t,n){Uf(e,t,{message:n}),console.error(n)},cy=function(e,t,n){return n?"Failed to load "+e+": "+n+" from url "+t:"Failed to load "+e+" url: "+t},uy=function(e,t,n){ay(e,"PluginLoadError",cy("plugin",t,n))},ly=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=window.console;r&&(r.error?r.error.apply(r,Oe([e],t,!1)):r.log.apply(r,Oe([e],t,!1)))},sy=function(e){return fy(e,function(e){var t=e.getParam("content_css");return m(t)?q(t.split(","),Ue):g(t)?t:!1===t||e.inline?[]:["default"]}(e))},fy=function(e,t){var n=e.editorManager.baseURL+"/skins/content",r="content"+e.editorManager.suffix+".css",o=!0===e.inline;return q(t,(function(t){return function(e){return/^[a-z0-9\-]+$/i.test(e)}(t)&&!o?n+"/"+t+"/"+r:e.documentBaseURI.toAbsolute(t)}))},dy=function(e){e.contentCSS=e.contentCSS.concat(sy(e),function(e){return fy(e,tl(e))}(e))},my=function(){var e={},t=function(e,t){return{status:e,resultUri:t}},n=function(t){return t in e};return{hasBlobUri:n,getResultUri:function(t){var n=e[t];return n?n.resultUri:null},isPending:function(t){return!!n(t)&&1===e[t].status},isUploaded:function(t){return!!n(t)&&2===e[t].status},markPending:function(n){e[n]=t(1,null)},markUploaded:function(n,r){e[n]=t(2,r)},removeFailed:function(t){delete e[t]},destroy:function(){e={}}}},py=0,gy=function(e){return e+py+++(t=function(){return Math.round(4294967295*Math.random()).toString(36)},"s"+(new Date).getTime().toString(36)+t()+t()+t());var t},hy=function(e,t){var n={},r=function(e,n,r,o){var i=new XMLHttpRequest;i.open("POST",t.url),i.withCredentials=t.credentials,i.upload.onprogress=function(e){o(e.loaded/e.total*100)},i.onerror=function(){r("Image upload failed due to a XHR Transport error. Code: "+i.status)},i.onload=function(){if(i.status<200||i.status>=300)r("HTTP Error: "+i.status);else{var e,o,a=JSON.parse(i.responseText);if(a&&"string"==typeof a.location)n((e=t.basePath,o=a.location,e?e.replace(/\/$/,"")+"/"+o.replace(/^\//,""):o));else r("Invalid JSON: "+i.responseText)}};var a=new FormData;a.append("file",e.blob(),e.filename()),i.send(a)},o=function(e,t){return{url:t,blobInfo:e,status:!0}},i=function(e,t,n){return{url:"",blobInfo:e,status:!1,error:{message:t,options:n}}},a=function(e,t){bt.each(n[e],(function(e){e(t)})),delete n[e]},c=function(r,c){return r=bt.grep(r,(function(t){return!e.isUploaded(t.blobUri())})),Vr.all(bt.map(r,(function(r){return e.isPending(r.blobUri())?function(e){var t=e.blobUri();return new Vr((function(e){n[t]=n[t]||[],n[t].push(e)}))}(r):function(t,n,r){return e.markPending(t.blobUri()),new Vr((function(c){var u;try{var l=function(){u&&(u.close(),S)};n(t,(function(n){l(),e.markUploaded(t.blobUri(),n),a(t.blobUri(),o(t,n)),c(o(t,n))}),(function(n,r){var o=r||{};l(),e.removeFailed(t.blobUri()),a(t.blobUri(),i(t,n,o)),c(i(t,n,o))}),(function(e){e<0||e>100||F.from(u).orThunk((function(){return F.from(r).map(D)})).each((function(t){u=t,t.progressBar.value(e)}))}))}catch(e){c(i(t,e.message,{}))}}))}(r,t.handler,c)})))};return!1===C(t.handler)&&(t.handler=r),{upload:function(e,n){return t.url||t.handler!==r?c(e,n):new Vr((function(e){e([])}))}}},vy=function(e){return function(){return e.notificationManager.open({text:e.translate("Image uploading..."),type:"info",timeout:-1,progressBar:!0})}},by=function(e,t){return hy(t,{url:Ku(e),basePath:Gu(e),credentials:Ju(e),handler:Xu(e)})},yy=function(e){var t,n,r=function(){var e=[],t=function(e){if(!e.blob||!e.base64)throw new Error("blob and base64 representations of the image are required for BlobInfo to be created");var t,n=e.id||gy("blobid"),r=e.name||n,o=e.blob;return{id:E(n),name:E(r),filename:E(e.filename||r+"."+(t=o.type,{"image/jpeg":"jpg","image/jpg":"jpg","image/gif":"gif","image/png":"png","image/apng":"apng","image/avif":"avif","image/svg+xml":"svg","image/webp":"webp","image/bmp":"bmp","image/tiff":"tiff"}[t.toLowerCase()]||"dat")),blob:E(o),base64:E(e.base64),blobUri:E(e.blobUri||URL.createObjectURL(o)),uri:E(e.uri)}},n=function(t){return Z(e,t).getOrUndefined()},r=function(e){return n((function(t){return t.id()===e}))};return{create:function(e,n,r,o,i){if(m(e))return t({id:e,name:o,filename:i,blob:n,base64:r});if(p(e))return t(e);throw new Error("Unknown input type")},add:function(t){r(t.id())||e.push(t)},get:r,getByUri:function(e){return n((function(t){return t.blobUri()===e}))},getByData:function(e,t){return n((function(n){return n.base64()===e&&n.blob().type===t}))},findFirst:n,removeByUri:function(t){e=J(e,(function(e){return e.blobUri()!==t||(URL.revokeObjectURL(e.blobUri()),!1)}))},destroy:function(){$(e,(function(e){URL.revokeObjectURL(e.blobUri())})),e=[]}}}(),o=my(),i=[],a=function(e){var t=cc(null);e.on("change AddUndo",(function(e){t.set(De({},e.level))}));return{fireIfChanged:function(){var n=e.undoManager.data;ue(n).filter((function(e){return!Av(t.get(),e)})).each((function(t){e.setDirty(!0),e.fire("change",{level:t,lastLevel:ae(n,n.length-2).getOrNull()})}))}}}(e),c=function(t){return function(n){return e.selection?t(n):[]}},u=function(e,t,n){var r=0;do{-1!==(r=e.indexOf(t,r))&&(e=e.substring(0,r)+n+e.substr(r+t.length),r+=n.length-t.length+1)}while(-1!==r);return e},l=function(e,t,n){var r='src="'+n+'"'+(n===mt.transparentSrc?' data-mce-placeholder="1"':"");return e=u(e,'src="'+t+'"',r),e=u(e,'data-mce-src="'+t+'"','data-mce-src="'+n+'"')},s=function(t,n){$(e.undoManager.data,(function(e){"fragmented"===e.type?e.fragments=q(e.fragments,(function(e){return l(e,t,n)})):e.content=l(e.content,t,n)}))},f=function(n){return t||(t=by(e,o)),h().then(c((function(o){var i=q(o,(function(e){return e.blobInfo}));return t.upload(i,vy(e)).then(c((function(t){var i=[],c=q(t,(function(t,n){var a=o[n].blobInfo,c=o[n].image;return t.status&&function(e){return e.getParam("images_replace_blob_uris",!0,"boolean")}(e)?(r.removeByUri(c.src),Ov(e)||function(t,n){var r,o=e.convertURL(n,"src");s(t.src,n),e.$(t).attr({src:qu(e)?(r=n,r+(-1===r.indexOf("?")?"?":"&")+(new Date).getTime()):n,"data-mce-src":o})}(c,t.url)):t.error&&(t.error.options.remove&&(s(c.getAttribute("src"),mt.transparentSrc),i.push(c)),function(e,t){iy(e,fc.translate(["Failed to upload image: {0}",t]))}(e,t.error.message)),{element:c,status:t.status,uploadUri:t.url,blobInfo:a}}));return c.length>0&&a.fireIfChanged(),i.length>0&&(Ov(e)?console.error("Removing images on failed uploads is currently unsupported for RTC"):e.undoManager.transact((function(){$(i,(function(t){e.dom.remove(t),r.removeByUri(t.src)}))}))),n&&n(c),c})))})))},d=function(t){if(Vu(e))return f(t)},g=function(t){return!1!==ne(i,(function(e){return e(t)}))&&(0!==t.getAttribute("src").indexOf("data:")||function(e){return e.getParam("images_dataimg_filter",P,"function")}(e)(t))},h=function(){return n||(n=eb(o,r)),n.findAll(e.getBody(),g).then(c((function(t){return t=J(t,(function(t){return"string"!=typeof t||(iy(e,t),!1)})),Ov(e)||$(t,(function(e){s(e.image.src,e.blobInfo.blobUri()),e.image.src=e.blobInfo.blobUri(),e.image.removeAttribute("data-mce-src")})),t})))},v=function(t){return t.replace(/src="(blob:[^"]+)"/g,(function(t,n){var i=o.getResultUri(n);if(i)return'src="'+i+'"';var a=r.getByUri(n);return a||(a=Y(e.editorManager.get(),(function(e,t){return e||t.editorUpload&&t.editorUpload.blobCache.getByUri(n)}),null)),a?'src="data:'+a.blob().type+";base64,"+a.base64()+'"':t}))};return e.on("SetContent",(function(){Vu(e)?d():h()})),e.on("RawSaveContent",(function(e){e.content=v(e.content)})),e.on("GetContent",(function(e){e.source_view||"raw"===e.format||"tree"===e.format||(e.content=v(e.content))})),e.on("PostRender",(function(){e.parser.addNodeFilter("img",(function(e){$(e,(function(e){var t=e.attr("src");if(!r.getByUri(t)){var n=o.getResultUri(t);n&&e.attr("src",n)}}))}))})),{blobCache:r,addFilter:function(e){i.push(e)},uploadImages:f,uploadImagesAuto:d,scanForImages:h,destroy:function(){r.destroy(),o.destroy(),n=t=null}}},wy=function(e){var t={},n=function(e,r){e&&(m(e)?(g(r)||(r=[r]),$(r,(function(e){b(e.deep)&&(e.deep=!Zs(e)),b(e.split)&&(e.split=!Zs(e)||ef(e)),b(e.remove)&&Zs(e)&&!ef(e)&&(e.remove="none"),Zs(e)&&ef(e)&&(e.mixed=!0,e.block_expand=!0),m(e.classes)&&(e.classes=e.classes.split(/\s+/))})),t[e]=r):me(e,(function(e,t){n(t,e)})))};return n(function(e){var t={valigntop:[{selector:"td,th",styles:{verticalAlign:"top"}}],valignmiddle:[{selector:"td,th",styles:{verticalAlign:"middle"}}],valignbottom:[{selector:"td,th",styles:{verticalAlign:"bottom"}}],alignleft:[{selector:"figure.image",collapsed:!1,classes:"align-left",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"left"},inherit:!1,preview:!1,defaultBlock:"div"},{selector:"img,table,audio,video",collapsed:!1,styles:{float:"left"},preview:"font-family font-size"}],aligncenter:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"center"},inherit:!1,preview:"font-family font-size",defaultBlock:"div"},{selector:"figure.image",collapsed:!1,classes:"align-center",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"img,audio,video",collapsed:!1,styles:{display:"block",marginLeft:"auto",marginRight:"auto"},preview:!1},{selector:"table",collapsed:!1,styles:{marginLeft:"auto",marginRight:"auto"},preview:"font-family font-size"}],alignright:[{selector:"figure.image",collapsed:!1,classes:"align-right",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"right"},inherit:!1,preview:"font-family font-size",defaultBlock:"div"},{selector:"img,table,audio,video",collapsed:!1,styles:{float:"right"},preview:"font-family font-size"}],alignjustify:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"justify"},inherit:!1,defaultBlock:"div",preview:"font-family font-size"}],bold:[{inline:"strong",remove:"all",preserve_attributes:["class","style"]},{inline:"span",styles:{fontWeight:"bold"}},{inline:"b",remove:"all",preserve_attributes:["class","style"]}],italic:[{inline:"em",remove:"all",preserve_attributes:["class","style"]},{inline:"span",styles:{fontStyle:"italic"}},{inline:"i",remove:"all",preserve_attributes:["class","style"]}],underline:[{inline:"span",styles:{textDecoration:"underline"},exact:!0},{inline:"u",remove:"all",preserve_attributes:["class","style"]}],strikethrough:[{inline:"span",styles:{textDecoration:"line-through"},exact:!0},{inline:"strike",remove:"all",preserve_attributes:["class","style"]},{inline:"s",remove:"all",preserve_attributes:["class","style"]}],forecolor:{inline:"span",styles:{color:"%value"},links:!0,remove_similar:!0,clear_child_styles:!0},hilitecolor:{inline:"span",styles:{backgroundColor:"%value"},links:!0,remove_similar:!0,clear_child_styles:!0},fontname:{inline:"span",toggle:!1,styles:{fontFamily:"%value"},clear_child_styles:!0},fontsize:{inline:"span",toggle:!1,styles:{fontSize:"%value"},clear_child_styles:!0},lineheight:{selector:"h1,h2,h3,h4,h5,h6,p,li,td,th,div",defaultBlock:"p",styles:{lineHeight:"%value"}},fontsize_class:{inline:"span",attributes:{class:"%value"}},blockquote:{block:"blockquote",wrapper:!0,remove:"all"},subscript:{inline:"sub"},superscript:{inline:"sup"},code:{inline:"code"},link:{inline:"a",selector:"a",remove:"all",split:!0,deep:!0,onmatch:function(e,t,n){return Cn(e)&&e.hasAttribute("href")},onformat:function(t,n,r){bt.each(r,(function(n,r){e.setAttrib(t,r,n)}))}},lang:{inline:"span",clear_child_styles:!0,remove_similar:!0,attributes:{lang:"%value","data-mce-lang":function(e){var t;return null!==(t=null==e?void 0:e.customValue)&&void 0!==t?t:null}}},removeformat:[{selector:"b,strong,em,i,font,u,strike,s,sub,sup,dfn,code,samp,kbd,var,cite,mark,q,del,ins,small",remove:"all",split:!0,expand:!1,block_expand:!0,deep:!0},{selector:"span",attributes:["style","class"],remove:"empty",split:!0,expand:!1,deep:!0},{selector:"*",attributes:["style","class"],split:!1,expand:!1,deep:!0}]};return bt.each("p h1 h2 h3 h4 h5 h6 div address pre dt dd samp".split(/\s/),(function(e){t[e]={block:e,remove:"all"}})),t}(e.dom)),n(function(e){return e.getParam("formats")}(e)),{get:function(e){return w(e)?t[e]:t},has:function(e){return Ce(t,e)},register:n,unregister:function(e){return e&&t[e]&&delete t[e],t}}},Cy=bt.each,xy=nc.DOM,Sy=function(e,t){var n,r,o,i=t&&t.schema||vi({}),a=function(e){r="string"==typeof e?{name:e,classes:[],attrs:{}}:e;var t=xy.create(r.name);return function(e,t){t.classes.length&&xy.addClass(e,t.classes.join(" ")),xy.setAttribs(e,t.attrs)}(t,r),t},c=function(e,t,n){var r,o,u=t.length>0&&t[0],l=u&&u.name,s=function(e,t){var n="string"!=typeof e?e.nodeName.toLowerCase():e,r=i.getElementRule(n),o=r&&r.parentsRequired;return!(!o||!o.length)&&(t&&-1!==bt.inArray(o,t)?t:o[0])}(e,l);if(s)l===s?(o=t[0],t=t.slice(1)):o=s;else if(u)o=t[0],t=t.slice(1);else if(!n)return e;return o&&(r=a(o)).appendChild(e),n&&(r||(r=xy.create("div")).appendChild(e),bt.each(n,(function(t){var n=a(t);r.insertBefore(n,e)}))),c(r,t,o&&o.siblings)};return e&&e.length?(r=e[0],n=a(r),(o=xy.create("div")).appendChild(c(n,e.slice(1),r.siblings)),o):""},ky=function(e){var t,n={classes:[],attrs:{}};return"*"!==(e=n.selector=bt.trim(e))&&(t=e.replace(/(?:([#\.]|::?)([\w\-]+)|(\[)([^\]]+)\]?)/g,(function(e,t,r,o,i){switch(t){case"#":n.attrs.id=r;break;case".":n.classes.push(r);break;case":":-1!==bt.inArray("checked disabled enabled read-only required".split(" "),r)&&(n.attrs[r]=r)}if("["===o){var a=i.match(/([\w\-]+)(?:\=\"([^\"]+))?/);a&&(n.attrs[a[1]]=a[2])}return""}))),n.name=t||"div",n},Ty=function(e,t){var n,r,o,i="",a=function(e){var t=e.getParam("preview_styles","font-family font-size font-weight font-style text-decoration text-transform color background-color border border-radius outline text-shadow");return m(t)?t:""}(e);if(""===a)return"";var c=function(e){return e.replace(/%(\w+)/g,"")};if("string"==typeof t){if(!(t=e.formatter.get(t)))return;t=t[0]}if("preview"in t){var u=we(t,"preview");if(jn(u,!1))return"";a=u.getOr(a)}n=t.block||t.inline||"span";var l,s=(l=t.selector)&&"string"==typeof l?(l=(l=l.split(/\s*,\s*/)[0]).replace(/\s*(~\+|~|\+|>)\s*/g,"$1"),bt.map(l.split(/(?:>|\s+(?![^\[\]]+\]))/),(function(e){var t=bt.map(e.split(/(?:~\+|~|\+)/),ky),n=t.pop();return t.length&&(n.siblings=t),n})).reverse()):[];s.length?(s[0].name||(s[0].name=n),n=t.selector,r=Sy(s,e)):r=Sy([n],e);var f=xy.select(n,r)[0]||r.firstChild;return Cy(t.styles,(function(e,t){var n=c(e);n&&xy.setStyle(f,t,n)})),Cy(t.attributes,(function(e,t){var n=c(e);n&&xy.setAttrib(f,t,n)})),Cy(t.classes,(function(e){var t=c(e);xy.hasClass(f,t)||xy.addClass(f,t)})),e.fire("PreviewFormats"),xy.setStyles(r,{position:"absolute",left:-65535}),e.getBody().appendChild(r),o=xy.getStyle(e.getBody(),"fontSize",!0),o=/px$/.test(o)?parseInt(o,10):0,Cy(a.split(" "),(function(t){var n=xy.getStyle(f,t,!0);if(!("background-color"===t&&/transparent|rgba\s*\([^)]+,\s*0\)/.test(n)&&(n=xy.getStyle(e.getBody(),t,!0),"#ffffff"===xy.toHex(n).toLowerCase())||"color"===t&&"#000000"===xy.toHex(n).toLowerCase())){if("font-size"===t&&/em|%$/.test(n)){if(0===o)return;n=parseFloat(n)/(/%$/.test(n)?100:1)*o+"px"}"border"===t&&n&&(i+="padding:0 2px;"),i+=t+":"+n+";"}})),e.fire("AfterPreviewFormats"),xy.remove(r),i},Ey=function(e){var t=wy(e),n=cc(null);return function(e){e.addShortcut("meta+b","","Bold"),e.addShortcut("meta+i","","Italic"),e.addShortcut("meta+u","","Underline");for(var t=1;t<=6;t++)e.addShortcut("access+"+t,"",["FormatBlock",!1,"h"+t]);e.addShortcut("access+7","",["FormatBlock",!1,"p"]),e.addShortcut("access+8","",["FormatBlock",!1,"div"]),e.addShortcut("access+9","",["FormatBlock",!1,"address"])}(e),mh(e),{get:t.get,has:t.has,register:t.register,unregister:t.unregister,apply:function(t,n,r){!function(e,t,n,r){Bv(e).formatter.apply(t,n,r)}(e,t,n,r)},remove:function(t,n,r,o){!function(e,t,n,r,o){Bv(e).formatter.remove(t,n,r,o)}(e,t,n,r,o)},toggle:function(t,n,r){!function(e,t,n,r){Bv(e).formatter.toggle(t,n,r)}(e,t,n,r)},match:function(t,n,r,o){return function(e,t,n,r,o){return Bv(e).formatter.match(t,n,r,o)}(e,t,n,r,o)},closest:function(t){return function(e,t){return Bv(e).formatter.closest(t)}(e,t)},matchAll:function(t,n){return function(e,t,n){return Bv(e).formatter.matchAll(t,n)}(e,t,n)},matchNode:function(t,n,r,o){return function(e,t,n,r,o){return Bv(e).formatter.matchNode(t,n,r,o)}(e,t,n,r,o)},canApply:function(t){return function(e,t){return Bv(e).formatter.canApply(t)}(e,t)},formatChanged:function(t,r,o,i){return function(e,t,n,r,o,i){return Bv(e).formatter.formatChanged(t,n,r,o,i)}(e,n,t,r,o,i)},getCssText:N(Ty,e)}},Ay=function(e){switch(e.toLowerCase()){case"undo":case"redo":case"mcerepaint":case"mcefocus":return!0;default:return!1}},_y=function(e){var t=mc(),n=cc(0),r=cc(0),o={data:[],typing:!1,beforeChange:function(){!function(e,t,n){Bv(e).undoManager.beforeChange(t,n)}(e,n,t)},add:function(i,a){return function(e,t,n,r,o,i,a){return Bv(e).undoManager.add(t,n,r,o,i,a)}(e,o,r,n,t,i,a)},undo:function(){return function(e,t,n,r){return Bv(e).undoManager.undo(t,n,r)}(e,o,n,r)},redo:function(){return function(e,t,n){return Bv(e).undoManager.redo(t,n)}(e,r,o.data)},clear:function(){!function(e,t,n){Bv(e).undoManager.clear(t,n)}(e,o,r)},reset:function(){!function(e,t){Bv(e).undoManager.reset(t)}(e,o)},hasUndo:function(){return function(e,t,n){return Bv(e).undoManager.hasUndo(t,n)}(e,o,r)},hasRedo:function(){return function(e,t,n){return Bv(e).undoManager.hasRedo(t,n)}(e,o,r)},transact:function(t){return function(e,t,n,r){return Bv(e).undoManager.transact(t,n,r)}(e,o,n,t)},ignore:function(t){!function(e,t,n){Bv(e).undoManager.ignore(t,n)}(e,n,t)},extra:function(t,n){!function(e,t,n,r,o){Bv(e).undoManager.extra(t,n,r,o)}(e,o,r,t,n)}};return Ov(e)||function(e,t,n){var r=cc(!1),o=function(e){Nv(t,!1,n),t.add({},e)};e.on("init",(function(){t.add()})),e.on("BeforeExecCommand",(function(e){var r=e.command;Ay(r)||(Rv(t,n),t.beforeChange())})),e.on("ExecCommand",(function(e){var t=e.command;Ay(t)||o(e)})),e.on("ObjectResizeStart cut",(function(){t.beforeChange()})),e.on("SaveContent ObjectResized blur",o),e.on("dragend",o),e.on("keyup",(function(n){var i=n.keyCode;n.isDefaultPrevented()||((i>=33&&i<=36||i>=37&&i<=40||45===i||n.ctrlKey)&&(o(),e.nodeChanged()),46!==i&&8!==i||e.nodeChanged(),r.get()&&t.typing&&!1===Av(Sv(e),t.data[0])&&(!1===e.isDirty()&&(e.setDirty(!0),e.fire("change",{level:t.data[0],lastLevel:null})),e.fire("TypingUndo"),r.set(!1),e.nodeChanged()))})),e.on("keydown",(function(e){var i=e.keyCode;if(!e.isDefaultPrevented())if(i>=33&&i<=36||i>=37&&i<=40||45===i)t.typing&&o(e);else{var a=e.ctrlKey&&!e.altKey||e.metaKey;!(i<16||i>20)||224===i||91===i||t.typing||a||(t.beforeChange(),Nv(t,!0,n),t.add({},e),r.set(!0))}})),e.on("mousedown",(function(e){t.typing&&o(e)}));e.on("input",(function(e){e.inputType&&("insertReplacementText"===e.inputType||function(e){return"insertText"===e.inputType&&null===e.data}(e)||function(e){return"insertFromPaste"===e.inputType||"insertFromDrop"===e.inputType}(e))&&o(e)})),e.on("AddUndo Undo Redo ClearUndos",(function(t){t.isDefaultPrevented()||e.nodeChanged()}))}(e,o,n),function(e){e.addShortcut("meta+z","","Undo"),e.addShortcut("meta+y,meta+shift+z","","Redo")}(e),o},Ny=[9,27,Vf.HOME,Vf.END,19,20,44,144,145,33,34,45,16,17,18,91,92,93,Vf.DOWN,Vf.UP,Vf.LEFT,Vf.RIGHT].concat(mt.browser.isFirefox()?[224]:[]),Ry=function(e){return"keydown"===e.type||"keyup"===e.type},Dy=function(e){var t=e.keyCode;return t===Vf.BACKSPACE||t===Vf.DELETE},Oy=function(e){var t=e.dom,n=zu(e),r=function(e){return e.getParam("placeholder",ju.getAttrib(e.getElement(),"placeholder"),"string")}(e),o=function(i,a){if(!function(e){if(Ry(e)){var t=e.keyCode;return!Dy(e)&&(Vf.metaKeyPressed(e)||e.altKey||t>=112&&t<=123||W(Ny,t))}return!1}(i)){var c=e.getBody(),u=!function(e){return Ry(e)&&!(Dy(e)||"keyup"===e.type&&229===e.keyCode)}(i)&&function(e,t,n){if(Wo(wt.fromDom(t),!1)){var r=""===n,o=t.firstElementChild;return!o||!e.getStyle(t.firstElementChild,"padding-left")&&!e.getStyle(t.firstElementChild,"padding-right")&&(r?!e.isBlock(o):n===o.nodeName.toLowerCase())}return!1}(t,c,n);(""!==t.getAttrib(c,"data-mce-placeholder")!==u||a)&&(t.setAttrib(c,"data-mce-placeholder",u?r:null),t.setAttrib(c,"aria-placeholder",u?r:null),function(e,t){e.fire("PlaceholderToggle",{state:t})}(e,u),e.on(u?"keydown":"keyup",o),e.off(u?"keyup":"keydown",o))}};r&&e.on("init",(function(t){o(t,!0),e.on("change SetContent ExecCommand",o),e.on("paste",(function(t){return Gr.setEditorTimeout(e,(function(){return o(t)}))}))}))},Iy=/[\u0591-\u07FF\uFB1D-\uFDFF\uFE70-\uFEFC]/,Py=function(e,t){return xt(wt.fromDom(t),function(e){return e.getParam("inline_boundaries_selector","a[href],code,.mce-annotation","string")}(e))},By=function(e){return"rtl"===nc.DOM.getStyle(e,"direction",!0)||(t=e.textContent,Iy.test(t));var t},My=function(e,t,n){var r=function(e,t,n){return J(nc.DOM.getParents(n.container(),"*",t),e)}(e,t,n);return F.from(r[r.length-1])},Ly=function(e,t){if(!t)return t;var n=t.container(),r=t.offset();return e?go(n)?Nn(n.nextSibling)?gu(n.nextSibling,0):gu.after(n):bo(t)?gu(n,r+1):t:go(n)?Nn(n.previousSibling)?gu(n.previousSibling,n.previousSibling.data.length):gu.before(n):yo(t)?gu(n,r-1):t},Fy=N(Ly,!0),jy=N(Ly,!1),Hy=function(e){return ro(e)||io(e)},Uy=function(e,t){return Et(e,t)?jr(t,Hy,function(e){return function(t){return kt(e,wt.fromDom(t.dom.parentNode))}}(e)):F.none()},zy=function(e){e.dom.isEmpty(e.getBody())&&(e.setContent(""),function(e){var t=e.getBody(),n=t.firstChild&&e.dom.isBlock(t.firstChild)?t.firstChild:t;e.selection.setCursorLocation(n,0)}(e))},Wy=function(e,t){return{from:e,to:t}},Vy=function(e,t){var n=wt.fromDom(e),r=wt.fromDom(t.container());return Uy(n,r).map((function(e){return function(e,t){return{block:e,position:t}}(e,t)}))},qy=function(e,t,n){var r=Vy(e,gu.fromRangeStart(n)),o=r.bind((function(n){return gs(t,e,n.position).bind((function(n){return Vy(e,n).map((function(n){return function(e,t,n){return In(n.position.getNode())&&!1===Wo(n.block)?bs(!1,n.block.dom).bind((function(r){return r.isEqual(n.position)?gs(t,e,r).bind((function(t){return Vy(e,t)})):F.some(n)})).getOr(n):n}(e,t,n)}))}))}));return Hn(r,o,Wy).filter((function(e){return function(e){return!1===kt(e.from.block,e.to.block)}(e)&&function(e){return Lt(e.from.block).bind((function(t){return Lt(e.to.block).filter((function(e){return kt(t,e)}))})).isSome()}(e)&&function(e){return!1===Mn(e.from.block.dom)&&!1===Mn(e.to.block.dom)}(e)}))},$y=function(e){var t=zt(e);return ee(t,eo).fold(E(t),(function(e){return t.slice(0,e)}))},Ky=function(e){var t=$y(e);return $(t,cn),t},Gy=function(e,t){var n=fp(t,e);return Z(n.reverse(),(function(e){return Wo(e)})).each(cn)},Jy=function(e,t,n,r){if(Wo(n))return cp(n),Cs(n.dom);0===J(Ht(r),(function(e){return!Wo(e)})).length&&Wo(t)&&en(r,wt.fromTag("br"));var o=ws(n.dom,gu.before(r.dom));return $(Ky(t),(function(e){en(r,e)})),Gy(e,t),o},Xy=function(e,t,n){if(Wo(n))return cn(n),Wo(t)&&cp(t),Cs(t.dom);var r=xs(n.dom);return $(Ky(t),(function(e){rn(n,e)})),Gy(e,t),r},Yy=function(e,t){return Et(t,e)?function(e,t){var n=fp(t,e);return F.from(n[n.length-1])}(t,e):F.none()},Qy=function(e,t){bs(e,t.dom).map((function(e){return e.getNode()})).map(wt.fromDom).filter(no).each(cn)},Zy=function(e,t,n){return Qy(!0,t),Qy(!1,n),Yy(t,n).fold(N(Xy,e,t,n),N(Jy,e,t,n))},ew=function(e,t,n,r){return t?Zy(e,r,n):Zy(e,n,r)},tw=function(e,t){var n=wt.fromDom(e.getBody()),r=function(e,t,n){return n.collapsed?qy(e,t,n):F.none()}(n.dom,t,e.selection.getRng()).bind((function(e){return ew(n,t,e.from.block,e.to.block)}));return r.each((function(t){e.selection.setRng(t.toRange())})),r.isSome()},nw=function(e,t){var n=wt.fromDom(t),r=N(kt,e);return Fr(n,co,r).isSome()},rw=function(e,t){var n=ws(e.dom,gu.fromRangeStart(t)).isNone(),r=ys(e.dom,gu.fromRangeEnd(t)).isNone();return!function(e,t){return nw(e,t.startContainer)||nw(e,t.endContainer)}(e,t)&&n&&r},ow=function(e){var t=wt.fromDom(e.getBody()),n=e.selection.getRng();return rw(t,n)?function(e){return e.setContent(""),e.selection.setCursorLocation(),!0}(e):function(e,t){var n=t.getRng();return Hn(Uy(e,wt.fromDom(n.startContainer)),Uy(e,wt.fromDom(n.endContainer)),(function(r,o){return!1===kt(r,o)&&(n.deleteContents(),ew(e,!0,r,o).each((function(e){t.setRng(e.toRange())})),!0)})).getOr(!1)}(t,e.selection)},iw=function(e,t){return!e.selection.isCollapsed()&&ow(e)},aw=Bn,cw=Mn,uw=function(e,t,n,r,o){return F.from(t._selectionOverrides.showCaret(e,n,r,o))},lw=function(e,t){return e.fire("BeforeObjectSelected",{target:t}).isDefaultPrevented()?F.none():F.some(function(e){var t=e.ownerDocument.createRange();return t.selectNode(e),t}(t))},sw=function(e,t,n){var r=Kl(1,e.getBody(),t),o=gu.fromRangeStart(r),i=o.getNode();if(El(i))return uw(1,e,i,!o.isAtEnd(),!1);var a=o.getNode(!0);if(El(a))return uw(1,e,a,!1,!1);var c=e.dom.getParent(o.getNode(),(function(e){return cw(e)||aw(e)}));return El(c)?uw(1,e,c,!1,n):F.none()},fw=function(e,t,n){return t.collapsed?sw(e,t,n).getOr(t):t},dw=function(e){return op(e)||ep(e)},mw=function(e){return ip(e)||tp(e)},pw=function(e,t,n,r,o,i){return uw(r,e,i.getNode(!o),o,!0).each((function(n){if(t.collapsed){var r=t.cloneRange();o?r.setEnd(n.startContainer,n.startOffset):r.setStart(n.endContainer,n.endOffset),r.deleteContents()}else t.deleteContents();e.selection.setRng(n)})),function(e,t){Nn(t)&&0===t.data.length&&e.remove(t)}(e.dom,n),!0},gw=function(e,t){return function(e,t){var n=e.selection.getRng();if(!Nn(n.commonAncestorContainer))return!1;var r=t?hu.Forwards:hu.Backwards,o=ss(e.getBody()),i=N(Yl,t?o.next:o.prev),a=t?dw:mw,c=Jl(r,e.getBody(),n),u=Ly(t,i(c));if(!u||!Ql(c,u))return!1;if(a(u))return pw(e,n,c.getNode(),r,t,u);var l=i(u);return!!(l&&a(l)&&Ql(u,l))&&pw(e,n,c.getNode(),r,t,l)}(e,t)},hw=gr([{remove:["element"]},{moveToElement:["element"]},{moveToPosition:["position"]}]),vw=function(e,t,n,r){var o=r.getNode(!1===t);return Uy(wt.fromDom(e),wt.fromDom(n.getNode())).map((function(e){return Wo(e)?hw.remove(e.dom):hw.moveToElement(o)})).orThunk((function(){return F.some(hw.moveToElement(o))}))},bw=function(e,t,n){return gs(t,e,n).bind((function(r){return o=r.getNode(),co(wt.fromDom(o))||io(wt.fromDom(o))||function(e,t,n,r){var o=function(t){return to(wt.fromDom(t))&&!Hl(n,r,e)};return Gl(!t,n).fold((function(){return Gl(t,r).fold(I,o)}),o)}(e,t,n,r)?F.none():t&&Mn(r.getNode())||!1===t&&Mn(r.getNode(!0))?vw(e,t,n,r):t&&ip(n)||!1===t&&op(n)?F.some(hw.moveToPosition(r)):F.none();var o}))},yw=function(e,t,n){return function(e,t){var n=t.getNode(!1===e),r=e?"after":"before";return Cn(n)&&n.getAttribute("data-mce-caret")===r}(t,n)?function(e,t){return e&&Mn(t.nextSibling)?F.some(hw.moveToElement(t.nextSibling)):!1===e&&Mn(t.previousSibling)?F.some(hw.moveToElement(t.previousSibling)):F.none()}(t,n.getNode(!1===t)).fold((function(){return bw(e,t,n)}),F.some):bw(e,t,n).bind((function(t){return function(e,t,n){return n.fold((function(e){return F.some(hw.remove(e))}),(function(e){return F.some(hw.moveToElement(e))}),(function(n){return Hl(t,n,e)?F.none():F.some(hw.moveToPosition(n))}))}(e,n,t)}))},ww=function(e,t){return F.from(jf(e.getBody(),t))},Cw=function(e,t){var n=e.selection.getNode();return ww(e,n).filter(Mn).fold((function(){return function(e,t,n){var r=Kl(t?1:-1,e,n),o=gu.fromRangeStart(r),i=wt.fromDom(e);return!1===t&&ip(o)?F.some(hw.remove(o.getNode(!0))):t&&op(o)?F.some(hw.remove(o.getNode())):!1===t&&op(o)&&Sp(i,o)?kp(i,o).map((function(e){return hw.remove(e.getNode())})):t&&ip(o)&&xp(i,o)?Tp(i,o).map((function(e){return hw.remove(e.getNode())})):yw(e,t,o)}(e.getBody(),t,e.selection.getRng()).exists((function(n){return n.fold(function(e,t){return function(n){return e._selectionOverrides.hideFakeCaret(),eg(e,t,wt.fromDom(n)),!0}}(e,t),function(e,t){return function(n){var r=t?gu.before(n):gu.after(n);return e.selection.setRng(r.toRange()),!0}}(e,t),function(e){return function(t){return e.selection.setRng(t.toRange()),!0}}(e))}))}),P)},xw=function(e,t){var n=e.selection.getNode();return!(!Mn(n)||Ln(n))&&ww(e,n.parentNode).filter(Mn).fold((function(){var n;return n=wt.fromDom(e.getBody()),$(kc(n,".mce-offscreen-selection"),cn),eg(e,t,wt.fromDom(e.selection.getNode())),zy(e),!0}),P)},Sw=function(e){var t=e.dom,n=e.selection,r=jf(e.getBody(),n.getNode());if(Bn(r)&&t.isBlock(r)&&t.isEmpty(r)){var o=t.create("br",{"data-mce-bogus":"1"});t.setHTML(r,""),r.appendChild(o),n.setRng(gu.before(o).toRange())}return!0},kw=function(e,t){return e.selection.isCollapsed()?Cw(e,t):xw(e,t)},Tw=function(e,t){return!!e.selection.isCollapsed()&&function(e,t){var n=gu.fromRangeStart(e.selection.getRng());return gs(t,e.getBody(),n).filter((function(e){return t?Qm(e):Zm(e)})).bind((function(e){return F.from(Ul(t?0:-1,e))})).exists((function(t){return e.selection.select(t),!0}))}(e,t)},Ew=Nn,Aw=function(e){return Ew(e)&&"\ufeff"===e.data[0]},_w=function(e){return Ew(e)&&"\ufeff"===e.data[e.data.length-1]},Nw=function(e){return e.ownerDocument.createTextNode("\ufeff")},Rw=function(e,t){return e?function(e){if(Ew(e.previousSibling))return _w(e.previousSibling)||e.previousSibling.appendData("\ufeff"),e.previousSibling;if(Ew(e))return Aw(e)||e.insertData(0,"\ufeff"),e;var t=Nw(e);return e.parentNode.insertBefore(t,e),t}(t):function(e){if(Ew(e.nextSibling))return Aw(e.nextSibling)||e.nextSibling.insertData(0,"\ufeff"),e.nextSibling;if(Ew(e))return _w(e)||e.appendData("\ufeff"),e;var t=Nw(e);return e.nextSibling?e.parentNode.insertBefore(t,e.nextSibling):e.parentNode.appendChild(t),t}(t)},Dw=N(Rw,!0),Ow=N(Rw,!1),Iw=function(e,t){return Nn(e.container())?Rw(t,e.container()):Rw(t,e.getNode())},Pw=function(e,t){var n=t.get();return n&&e.container()===n&&go(n)},Bw=function(e,t){return t.fold((function(t){bl(e.get());var n=Dw(t);return e.set(n),F.some(gu(n,n.length-1))}),(function(t){return Cs(t).map((function(t){if(Pw(t,e))return gu(e.get(),1);bl(e.get());var n=Iw(t,!0);return e.set(n),gu(n,1)}))}),(function(t){return xs(t).map((function(t){if(Pw(t,e))return gu(e.get(),e.get().length-1);bl(e.get());var n=Iw(t,!1);return e.set(n),gu(n,n.length-1)}))}),(function(t){bl(e.get());var n=Ow(t);return e.set(n),F.some(gu(n,1))}))},Mw=function(e,t){for(var n=0;n<e.length;n++){var r=e[n].apply(null,t);if(r.isSome())return r}return F.none()},Lw=gr([{before:["element"]},{start:["element"]},{end:["element"]},{after:["element"]}]),Fw=function(e,t){var n=jl(t,e);return n||e},jw=function(e,t,n){var r=Fy(n),o=Fw(t,r.container());return My(e,o,r).fold((function(){return ys(o,r).bind(N(My,e,o)).map((function(e){return Lw.before(e)}))}),F.none)},Hw=function(e,t){return null===ks(e,t)},Uw=function(e,t,n){return My(e,t,n).filter(N(Hw,t))},zw=function(e,t,n){var r=jy(n);return Uw(e,t,r).bind((function(e){return ws(e,r).isNone()?F.some(Lw.start(e)):F.none()}))},Ww=function(e,t,n){var r=Fy(n);return Uw(e,t,r).bind((function(e){return ys(e,r).isNone()?F.some(Lw.end(e)):F.none()}))},Vw=function(e,t,n){var r=jy(n),o=Fw(t,r.container());return My(e,o,r).fold((function(){return ws(o,r).bind(N(My,e,o)).map((function(e){return Lw.after(e)}))}),F.none)},qw=function(e){return!1===By(Kw(e))},$w=function(e,t,n){return Mw([jw,zw,Ww,Vw],[e,t,n]).filter(qw)},Kw=function(e){return e.fold(A,A,A,A)},Gw=function(e){return e.fold(E("before"),E("start"),E("end"),E("after"))},Jw=function(e){return e.fold(Lw.before,Lw.before,Lw.after,Lw.after)},Xw=function(e){return e.fold(Lw.start,Lw.start,Lw.end,Lw.end)},Yw=function(e,t,n,r,o,i){return Hn(My(t,n,r),My(t,n,o),(function(t,r){return t!==r&&function(e,t,n){var r=jl(t,e),o=jl(n,e);return r&&r===o}(n,t,r)?Lw.after(e?t:r):i})).getOr(i)},Qw=function(e,t){return e.fold(P,(function(e){return r=t,!(Gw(n=e)===Gw(r)&&Kw(n)===Kw(r));var n,r}))},Zw=function(e,t){return e?t.fold(k(F.some,Lw.start),F.none,k(F.some,Lw.after),F.none):t.fold(F.none,k(F.some,Lw.before),F.none,k(F.some,Lw.end))},eC=function(e,t,n,r){var o=Ly(e,r),i=$w(t,n,o);return $w(t,n,o).bind(N(Zw,e)).orThunk((function(){return function(e,t,n,r,o){var i=Ly(e,o);return gs(e,n,i).map(N(Ly,e)).fold((function(){return r.map(Jw)}),(function(o){return $w(t,n,o).map(N(Yw,e,t,n,i,o)).filter(N(Qw,r))})).filter(qw)}(e,t,n,i,r)}))};N(eC,!1),N(eC,!0);var tC,nC=function(e,t,n){var r=e?1:-1;return t.setRng(gu(n.container(),n.offset()+r).toRange()),t.getSel().modify("move",e?"forward":"backward","word"),!0},rC=function(e,t){var n=t.selection.getRng(),r=e?gu.fromRangeEnd(n):gu.fromRangeStart(n);return!!function(e){return C(e.selection.getSel().modify)}(t)&&(e&&bo(r)?nC(!0,t.selection,r):!(e||!yo(r))&&nC(!1,t.selection,r))};!function(e){e[e.Br=0]="Br",e[e.Block=1]="Block",e[e.Wrap=2]="Wrap",e[e.Eol=3]="Eol"}(tC||(tC={}));var oC,iC=function(e,t){return e===hu.Backwards?re(t):t},aC=function(e,t,n){return e===hu.Forwards?t.next(n):t.prev(n)},cC=function(e,t,n,r){return In(r.getNode(t===hu.Forwards))?tC.Br:!1===Hl(n,r)?tC.Block:tC.Wrap},uC=function(e,t,n,r){for(var o=ss(n),i=r,a=[];i;){var c=aC(t,o,i);if(!c)break;if(In(c.getNode(!1)))return t===hu.Forwards?{positions:iC(t,a).concat([c]),breakType:tC.Br,breakAt:F.some(c)}:{positions:iC(t,a),breakType:tC.Br,breakAt:F.some(c)};if(c.isVisible()){if(e(i,c)){var u=cC(0,t,i,c);return{positions:iC(t,a),breakType:u,breakAt:F.some(c)}}a.push(c),i=c}else i=c}return{positions:iC(t,a),breakType:tC.Eol,breakAt:F.none()}},lC=function(e,t,n,r){return t(n,r).breakAt.map((function(r){var o=t(n,r).positions;return e===hu.Backwards?o.concat(r):[r].concat(o)})).getOr([])},sC=function(e,t){return Y(e,(function(e,n){return e.fold((function(){return F.some(n)}),(function(r){return Hn(ce(r.getClientRects()),ce(n.getClientRects()),(function(e,o){var i=Math.abs(t-e.left);return Math.abs(t-o.left)<=i?n:r})).or(e)}))}),F.none())},fC=function(e,t){return ce(t.getClientRects()).bind((function(t){return sC(e,t.left)}))},dC=N(uC,gu.isAbove,-1),mC=N(uC,gu.isBelow,1),pC=N(lC,-1,dC),gC=N(lC,1,mC),hC=function(e){var t=function(t){return q(t,(function(t){var n=Uc(t);return n.node=e,n}))};if(Cn(e))return t(e.getClientRects());if(Nn(e)){var n=e.ownerDocument.createRange();return n.setStart(e,0),n.setEnd(e,e.data.length),t(n.getClientRects())}},vC=function(e){return te(e,hC)};!function(e){e[e.Up=-1]="Up",e[e.Down=1]="Down"}(oC||(oC={}));var bC,yC,wC=function(e,t,n,r,o,i){var a=0,c=[],u=function(r){var i=vC([r]);-1===e&&(i=i.reverse());for(var u=0;u<i.length;u++){var s=i[u];if(!n(s,l)){if(c.length>0&&t(s,Re(c))&&a++,s.line=a,o(s))return!0;c.push(s)}}},l=Re(i.getClientRects());if(!l)return c;var s=i.getNode();return u(s),function(e,t,n,r){for(;r=Fl(r,e,Bo,t);)if(n(r))return}(e,r,u,s),c},CC=N(wC,oC.Up,Vc,qc),xC=N(wC,oC.Down,qc,Vc),SC=function(e){return function(t){return function(e,t){return t.line>e}(e,t)}},kC=function(e){return function(t){return function(e,t){return t.line===e}(e,t)}},TC=Mn,EC=Fl,AC=function(e,t){return Math.abs(e.left-t)},_C=function(e,t){return Math.abs(e.right-t)},NC=function(e,t){return e>=t.left&&e<=t.right},RC=function(e,t){return e>=t.top&&e<=t.bottom},DC=function(e,t,n){return void 0===n&&(n=P),_e(e,(function(e,r){if(NC(t,r))return n(r)?r:e;if(NC(t,e))return n(e)?e:r;var o=Math.min(AC(e,t),_C(e,t)),i=Math.min(AC(r,t),_C(r,t));return i===o&&xe(r,"node")&&TC(r.node)||i<o?r:e}))},OC=function(e,t,n,r,o){var i=EC(r,e,Bo,t,!o);do{if(!i||n(i))return}while(i=EC(i,e,Bo,t))},IC=function(e,t,n){var r=vC(function(e){return J(le(e.getElementsByTagName("*")),Al)}(e)),o=J(r,N(RC,n)),i=function(e){return!En(e.node)&&!Fn(e.node)},a=DC(o,t,i);if(a){var c=i(a);if((a=DC(function(e,t,n){void 0===n&&(n=!0);var r=[],o=function(e,n){var o=J(vC([n]),(function(n){return!e(n,t)}));return r=r.concat(o),0===o.length};return r.push(t),OC(oC.Up,e,N(o,Vc),t.node,n),OC(oC.Down,e,N(o,qc),t.node,n),r}(e,a,c),t,i))&&Al(a.node))return function(e,t){return{node:e.node,before:AC(e,t)<_C(e,t)}}(a,t)}return null},PC=function(e,t){e.selection.setRng(t),Nd(e,e.selection.getRng())},BC=function(e,t,n){return F.some(fw(e,t,n))},MC=function(e,t,n,r,o,i){var a=t===hu.Forwards,c=ss(e.getBody()),u=N(Yl,a?c.next:c.prev),l=a?r:o;if(!n.collapsed){var s=Kc(n);if(i(s))return uw(t,e,s,t===hu.Backwards,!1)}var f=Jl(t,e.getBody(),n);if(l(f))return lw(e,f.getNode(!a));var d=Ly(a,u(f)),m=ko(n);if(!d)return m?F.some(n):F.none();if(l(d))return uw(t,e,d.getNode(!a),a,!1);var p=u(d);return p&&l(p)&&Ql(d,p)?uw(t,e,p.getNode(!a),a,!1):m?BC(e,d.toRange(),!1):F.none()},LC=function(e,t,n,r,o,i){var a=Jl(t,e.getBody(),n),c=Re(a.getClientRects()),u=t===oC.Down;if(!c)return F.none();var l,s=(u?xC:CC)(e.getBody(),SC(1),a),f=J(s,kC(1)),d=c.left,m=DC(f,d);if(m&&i(m.node)){var p=Math.abs(d-m.left),g=Math.abs(d-m.right);return uw(t,e,m.node,p<g,!1)}if(l=r(a)?a.getNode():o(a)?a.getNode(!0):Kc(n)){var h=function(e,t,n,r){var o,i,a,c,u=ss(t),l=[],s=0,f=function(e){return Re(e.getClientRects())};1===e?(o=u.next,i=qc,a=Vc,c=gu.after(r)):(o=u.prev,i=Vc,a=qc,c=gu.before(r));var d=f(c);do{if(c.isVisible()){var m=f(c);if(!a(m,d)){l.length>0&&i(m,Re(l))&&s++;var p=Uc(m);if(p.position=c,p.line=s,n(p))return l;l.push(p)}}}while(c=o(c));return l}(t,e.getBody(),SC(1),l),v=DC(J(h,kC(1)),d);if(v)return BC(e,v.position.toRange(),!1);if(v=Re(J(h,kC(0))))return BC(e,v.position.toRange(),!1)}return 0===f.length?FC(e,u).filter(u?o:r).map((function(t){return fw(e,t.toRange(),!1)})):F.none()},FC=function(e,t){var n=e.selection.getRng(),r=e.getBody();if(t){var o=gu.fromRangeEnd(n),i=mC(r,o);return ue(i.positions)}o=gu.fromRangeStart(n),i=dC(r,o);return ce(i.positions)},jC=function(e,t,n){return FC(e,t).filter(n).exists((function(t){return e.selection.setRng(t.toRange()),!0}))},HC=function(e,t){var n=e.dom.createRng();n.setStart(t.container(),t.offset()),n.setEnd(t.container(),t.offset()),e.selection.setRng(n)},UC=function(e,t){e?t.setAttribute("data-mce-selected","inline-boundary"):t.removeAttribute("data-mce-selected")},zC=function(e,t,n){return Bw(t,n).map((function(t){return HC(e,t),n}))},WC=function(e,t){if(e.selection.isCollapsed()&&!0!==e.composing&&t.get()){var n=gu.fromRangeStart(e.selection.getRng());gu.isTextPosition(n)&&!1===function(e){return bo(e)||yo(e)}(n)&&(HC(e,vl(t.get(),n)),t.set(null))}},VC=function(e,t,n){return!!al(e)&&function(e,t,n){var r=e.getBody(),o=gu.fromRangeStart(e.selection.getRng()),i=N(Py,e);return eC(n,i,r,o).bind((function(n){return zC(e,t,n)}))}(e,t,n).isSome()},qC=function(e,t,n){return!!al(t)&&rC(e,t)},$C=function(e){var t=cc(null),n=N(Py,e);return e.on("NodeChange",(function(r){!al(e)||mt.browser.isIE()&&r.initial||(function(e,t,n){var r=q(kc(wt.fromDom(t.getRoot()),'*[data-mce-selected="inline-boundary"]'),(function(e){return e.dom})),o=J(r,e),i=J(n,e);$(oe(o,i),N(UC,!1)),$(oe(i,o),N(UC,!0))}(n,e.dom,r.parents),WC(e,t),function(e,t,n,r){if(t.selection.isCollapsed()){var o=J(r,e);$(o,(function(r){var o=gu.fromRangeStart(t.selection.getRng());$w(e,t.getBody(),o).bind((function(e){return zC(t,n,e)}))}))}}(n,e,t,r.parents))})),t},KC=N(qC,!0),GC=N(qC,!1),JC=function(e,t,n){if(al(e)){var r=FC(e,t).getOrThunk((function(){var n=e.selection.getRng();return t?gu.fromRangeEnd(n):gu.fromRangeStart(n)}));return $w(N(Py,e),e.getBody(),r).exists((function(t){var r=Jw(t);return Bw(n,r).exists((function(t){return HC(e,t),!0}))}))}return!1},XC=function(e,t){return function(n){return Bw(t,n).exists((function(t){return HC(e,t),!0}))}},YC=function(e,t,n,r){var o=e.getBody(),i=N(Py,e);e.undoManager.ignore((function(){e.selection.setRng(function(e,t){var n=document.createRange();return n.setStart(e.container(),e.offset()),n.setEnd(t.container(),t.offset()),n}(n,r)),e.execCommand("Delete"),$w(i,o,gu.fromRangeStart(e.selection.getRng())).map(Xw).map(XC(e,t))})),e.nodeChanged()},QC=function(e,t,n,r){var o=function(e,t){var n=jl(t,e);return n||e}(e.getBody(),r.container()),i=N(Py,e),a=$w(i,o,r);return a.bind((function(e){return n?e.fold(E(F.some(Xw(e))),F.none,E(F.some(Jw(e))),F.none):e.fold(F.none,E(F.some(Jw(e))),F.none,E(F.some(Xw(e))))})).map(XC(e,t)).getOrThunk((function(){var c=hs(n,o,r),u=c.bind((function(e){return $w(i,o,e)}));return Hn(a,u,(function(){return My(i,o,r).exists((function(t){return!!function(e){return Hn(Cs(e),xs(e),(function(t,n){var r=Ly(!0,t),o=Ly(!1,n);return ys(e,r).forall((function(e){return e.isEqual(o)}))})).getOr(!0)}(t)&&(eg(e,n,wt.fromDom(t)),!0)}))})).orThunk((function(){return u.bind((function(o){return c.map((function(o){return n?YC(e,t,r,o):YC(e,t,o,r),!0}))}))})).getOr(!1)}))},ZC=function(e,t,n){if(e.selection.isCollapsed()&&al(e)){var r=gu.fromRangeStart(e.selection.getRng());return QC(e,t,n,r)}return!1},ex=function(e){return 1===$t(e)},tx=function(e,t,n,r){var o=N(ph,t),i=q(J(r,o),(function(e){return e.dom}));if(0===i.length)eg(t,e,n);else{var a=function(e,t){var n=ch(!1),r=fh(t,n.dom);return en(wt.fromDom(e),n),cn(wt.fromDom(e)),gu(r,0)}(n.dom,i);t.selection.setRng(a.toRange())}},nx=function(e,t){var n=wt.fromDom(e.getBody()),r=wt.fromDom(e.selection.getStart()),o=J(function(e,t){var n=fp(t,e);return ee(n,eo).fold(E(n),(function(e){return n.slice(0,e)}))}(n,r),ex);return ue(o).exists((function(n){var r,i=gu.fromRangeStart(e.selection.getRng());return!(!function(e,t,n){return Hn(Cs(n),xs(n),(function(r,o){var i=Ly(!0,r),a=Ly(!1,o),c=Ly(!1,t);return e?ys(n,c).exists((function(e){return e.isEqual(a)&&t.isEqual(i)})):ws(n,c).exists((function(e){return e.isEqual(i)&&t.isEqual(a)}))})).getOr(!0)}(t,i,n.dom)||(r=n,Ss(r.dom)&&ih(r.dom)))&&(tx(t,e,n,o),!0)}))},rx=function(e,t){return!!e.selection.isCollapsed()&&nx(e,t)},ox=function(e,t,n){return e._selectionOverrides.hideFakeCaret(),eg(e,t,wt.fromDom(n)),!0},ix=function(e,t){return e.selection.isCollapsed()?function(e,t){var n=t?ep:tp,r=t?hu.Forwards:hu.Backwards,o=Jl(r,e.getBody(),e.selection.getRng());return n(o)?ox(e,t,o.getNode(!t)):F.from(Ly(t,o)).filter((function(e){return n(e)&&Ql(o,e)})).exists((function(n){return ox(e,t,n.getNode(!t))}))}(e,t):function(e,t){var n=e.selection.getNode();return!!Fn(n)&&ox(e,t,n)}(e,t)},ax=function(e){var t=parseInt(e,10);return isNaN(t)?0:t},cx=function(e,t){return(e||"table"===At(t)?"margin":"padding")+("rtl"===Jn(t,"direction")?"-right":"-left")},ux=function(e){var t=sx(e);return!e.mode.isReadOnly()&&(t.length>1||function(e,t){return ne(t,(function(t){var n=cx(el(e),t),r=Yn(t,n).map(ax).getOr(0);return"false"!==e.dom.getContentEditable(t.dom)&&r>0}))}(e,t))},lx=function(e){return oo(e)||io(e)},sx=function(e){return J((t=e.selection.getSelectedBlocks(),q(t,wt.fromDom)),(function(e){return!lx(e)&&!function(e){return Lt(e).exists(lx)}(e)&&jr(e,(function(e){return Bn(e.dom)||Mn(e.dom)})).exists((function(e){return Bn(e.dom)}))}));var t},fx=function(e,t){var n=e.dom,r=e.selection,o=e.formatter,i=function(e){return e.getParam("indentation","40px","string")}(e),a=/[a-z%]+$/i.exec(i)[0],c=parseInt(i,10),u=el(e),l=zu(e);e.queryCommandState("InsertUnorderedList")||e.queryCommandState("InsertOrderedList")||""!==l||n.getParent(r.getNode(),n.isBlock)||o.apply("div"),$(sx(e),(function(e){!function(e,t,n,r,o,i){var a=cx(n,wt.fromDom(i));if("outdent"===t){var c=Math.max(0,ax(i.style[a])-r);e.setStyle(i,a,c?c+o:"")}else{c=ax(i.style[a])+r+o;e.setStyle(i,a,c)}}(n,t,u,c,a,e.dom)}))},dx=function(e,t){if(e.selection.isCollapsed()&&ux(e)){var n=e.dom,r=e.selection.getRng(),o=gu.fromRangeStart(r),i=n.getParent(r.startContainer,n.isBlock);if(null!==i&&hp(wt.fromDom(i),o))return fx(e,"outdent"),!0}return!1},mx=function(e,t){e.getDoc().execCommand(t,!1,null)},px=function(e,t){e.addCommand("delete",(function(){!function(e,t){dx(e)||kw(e,!1)||gw(e,!1)||ZC(e,t,!1)||tw(e,!1)||Rg(e)||Tw(e,!1)||ix(e,!1)||iw(e)||rx(e,!1)||(mx(e,"Delete"),zy(e))}(e,t)})),e.addCommand("forwardDelete",(function(){!function(e,t){kw(e,!0)||gw(e,!0)||ZC(e,t,!0)||tw(e,!0)||Rg(e)||Tw(e,!0)||ix(e,!0)||iw(e)||rx(e,!0)||mx(e,"ForwardDelete")}(e,t)}))},gx=function(e){return void 0===e.touches||1!==e.touches.length?F.none():F.some(e.touches[0])},hx=function(e){var t=mc(),n=cc(!1),r=gc((function(t){e.fire("longpress",De(De({},t),{type:"longpress"})),n.set(!0)}),400);e.on("touchstart",(function(e){gx(e).each((function(o){r.cancel();var i={x:o.clientX,y:o.clientY,target:e.target};r.throttle(e),n.set(!1),t.set(i)}))}),!0),e.on("touchmove",(function(o){r.cancel(),gx(o).each((function(r){t.on((function(o){(function(e,t){var n=Math.abs(e.clientX-t.x),r=Math.abs(e.clientY-t.y);return n>5||r>5})(r,o)&&(t.clear(),n.set(!1),e.fire("longpresscancel"))}))}))}),!0),e.on("touchend touchcancel",(function(o){r.cancel(),"touchcancel"!==o.type&&t.get().filter((function(e){return e.target.isEqualNode(o.target)})).each((function(){n.get()?o.preventDefault():e.fire("tap",De(De({},o),{type:"tap"}))}))}),!0)},vx=function(e,t){return Ce(e,t.nodeName)},bx=function(e,t){return!!Nn(t)||!!Cn(t)&&(!vx(e,t)&&!Bs(t))},yx=function(e,t){if(Nn(t)){if(0===t.nodeValue.length)return!0;if(/^\s+$/.test(t.nodeValue)&&(!t.nextSibling||vx(e,t.nextSibling)))return!0}return!1},wx=function(e){var t,n,r,o=e.dom,i=e.selection,a=e.schema,c=a.getBlockElements(),u=i.getStart(),l=e.getBody(),s=zu(e);if(u&&Cn(u)&&s){var f=l.nodeName.toLowerCase();if(a.isValidChild(f,s.toLowerCase())&&!function(e,t,n){return V(sp(wt.fromDom(n),wt.fromDom(t)),(function(t){return vx(e,t.dom)}))}(c,l,u)){var d=i.getRng(),m=d.startContainer,p=d.startOffset,g=d.endContainer,h=d.endOffset,v=im(e);for(u=l.firstChild;u;)if(bx(c,u)){if(yx(c,u)){n=u,u=u.nextSibling,o.remove(n);continue}t||(t=o.create(s,Wu(e)),u.parentNode.insertBefore(t,u),r=!0),n=u,u=u.nextSibling,t.appendChild(n)}else t=null,u=u.nextSibling;r&&v&&(d.setStart(m,p),d.setEnd(g,h),i.setRng(d),e.nodeChanged())}}},Cx=function(e,t){t.hasAttribute("data-mce-caret")&&(So(t),function(e){e.selection.setRng(e.selection.getRng())}(e),e.selection.scrollIntoView(t))},xx=function(e,t){var n=function(e){return zr(wt.fromDom(e.getBody()),"*[data-mce-caret]").map((function(e){return e.dom})).getOrNull()}(e);if(n)return"compositionstart"===t.type?(t.preventDefault(),t.stopPropagation(),void Cx(e,n)):void(vo(n)&&(Cx(e,n),e.undoManager.add()))},Sx=Mn,kx=function(e,t,n){var r=ss(e.getBody()),o=N(Yl,1===t?r.next:r.prev);if(n.collapsed&&function(e){return""!==zu(e)}(e)){var i=e.dom.getParent(n.startContainer,"PRE");if(!i)return;if(!o(gu.fromRangeStart(n))){var a=function(e){var t=e.dom.create(zu(e));return(!mt.ie||mt.ie>=11)&&(t.innerHTML='<br data-mce-bogus="1">'),t}(e);1===t?e.$(i).after(a):e.$(i).before(a),e.selection.select(a,!0),e.selection.collapse()}}},Tx=function(e,t){var n=t?hu.Forwards:hu.Backwards,r=e.selection.getRng();return function(e,t,n){return MC(t,e,n,op,ip,Sx)}(n,e,r).orThunk((function(){return kx(e,n,r),F.none()}))},Ex=function(e,t){var n=t?1:-1,r=e.selection.getRng();return function(e,t,n){return LC(t,e,n,(function(e){return op(e)||np(e)}),(function(e){return ip(e)||rp(e)}),Sx)}(n,e,r).orThunk((function(){return kx(e,n,r),F.none()}))},Ax=function(e,t){return Tx(e,t).exists((function(t){return PC(e,t),!0}))},_x=function(e,t){return Ex(e,t).exists((function(t){return PC(e,t),!0}))},Nx=function(e,t){return jC(e,t,t?ip:op)},Rx=function(e){return W(["figcaption"],At(e))},Dx=function(e){var t=document.createRange();return t.setStartBefore(e.dom),t.setEndBefore(e.dom),t},Ox=function(e,t,n){n?rn(e,t):nn(e,t)},Ix=function(e,t,n,r){return""===t?function(e,t){var n=wt.fromTag("br");return Ox(e,n,t),Dx(n)}(e,r):function(e,t,n,r){var o=wt.fromTag(n),i=wt.fromTag("br");return Vn(o,r),rn(o,i),Ox(e,o,t),Dx(i)}(e,r,t,n)},Px=function(e,t,n){return t?function(e,t){return mC(e,t).breakAt.isNone()}(e.dom,n):function(e,t){return dC(e,t).breakAt.isNone()}(e.dom,n)},Bx=function(e,t){var n=wt.fromDom(e.getBody()),r=gu.fromRangeStart(e.selection.getRng()),o=zu(e),i=Wu(e);return function(e,t){var n=N(kt,t);return jr(wt.fromDom(e.container()),eo,n).filter(Rx)}(r,n).exists((function(){if(Px(n,t,r)){var a=Ix(n,o,i,t);return e.selection.setRng(a),!0}return!1}))},Mx=function(e,t){return!!e.selection.isCollapsed()&&Bx(e,t)},Lx=function(e,t){return te(function(e){return q(e,(function(e){return De({shiftKey:!1,altKey:!1,ctrlKey:!1,metaKey:!1,keyCode:0,action:S},e)}))}(e),(function(e){return function(e,t){return t.keyCode===e.keyCode&&t.shiftKey===e.shiftKey&&t.altKey===e.altKey&&t.ctrlKey===e.ctrlKey&&t.metaKey===e.metaKey}(e,t)?[e]:[]}))},Fx=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return function(){return e.apply(null,t)}},jx=function(e,t){return Z(Lx(e,t),(function(e){return e.action()}))},Hx=function(e,t){var n=t?hu.Forwards:hu.Backwards,r=e.selection.getRng();return MC(e,n,r,ep,tp,Fn).exists((function(t){return PC(e,t),!0}))},Ux=function(e,t){var n=t?1:-1,r=e.selection.getRng();return LC(e,n,r,ep,tp,Fn).exists((function(t){return PC(e,t),!0}))},zx=function(e,t){return jC(e,t,t?tp:ep)},Wx=function(e,t,n,r,o){var i=kc(wt.fromDom(n),"td,th,caption").map((function(e){return e.dom}));return function(e,t,n){return Y(e,(function(e,r){return e.fold((function(){return F.some(r)}),(function(e){var o=Math.sqrt(Math.abs(e.x-t)+Math.abs(e.y-n)),i=Math.sqrt(Math.abs(r.x-t)+Math.abs(r.y-n));return F.some(i<o?r:e)}))}),F.none())}(J(function(e,t){return te(t,(function(t){var n=function(e,t){return{left:e.left-t,top:e.top-t,right:e.right+2*t,bottom:e.bottom+2*t,width:e.width+t,height:e.height+t}}(Uc(t.getBoundingClientRect()),-1);return[{x:n.left,y:e(n),cell:t},{x:n.right,y:e(n),cell:t}]}))}(e,i),(function(e){return t(e,o)})),r,o).map((function(e){return e.cell}))},Vx=N(Wx,(function(e){return e.bottom}),(function(e,t){return e.y<t})),qx=N(Wx,(function(e){return e.top}),(function(e,t){return e.y>t})),$x=function(e,t){return ce(t.getClientRects()).bind((function(t){return Vx(e,t.left,t.top)})).bind((function(e){return fC(xs(n=e).map((function(e){return dC(n,e).positions.concat(e)})).getOr([]),t);var n}))},Kx=function(e,t){return ue(t.getClientRects()).bind((function(t){return qx(e,t.left,t.top)})).bind((function(e){return fC(Cs(n=e).map((function(e){return[e].concat(mC(n,e).positions)})).getOr([]),t);var n}))},Gx=function(e,t,n){var r=e(t,n);return function(e){return e.breakType===tC.Wrap&&0===e.positions.length}(r)||!In(n.getNode())&&function(e){return e.breakType===tC.Br&&1===e.positions.length}(r)?!function(e,t,n){return n.breakAt.exists((function(n){return e(t,n).breakAt.isSome()}))}(e,t,r):r.breakAt.isNone()},Jx=N(Gx,dC),Xx=N(Gx,mC),Yx=function(e,t,n,r){var o=e.selection.getRng(),i=t?1:-1;return!(!Tl()||!function(e,t,n){var r=gu.fromRangeStart(t);return bs(!e,n).exists((function(e){return e.isEqual(r)}))}(t,o,n))&&(uw(i,e,n,!t,!1).each((function(t){PC(e,t)})),!0)},Qx=function(e,t){var n=t.getNode(e);return Cn(n)&&"TABLE"===n.nodeName?F.some(n):F.none()},Zx=function(e,t,n){var r=Qx(!!t,n),o=!1===t;r.fold((function(){return PC(e,n.toRange())}),(function(r){return bs(o,e.getBody()).filter((function(e){return e.isEqual(n)})).fold((function(){return PC(e,n.toRange())}),(function(o){return function(e,t,n,r){var o=zu(t);o?t.undoManager.transact((function(){var r=wt.fromTag(o);Vn(r,Wu(t)),rn(r,wt.fromTag("br")),e?tn(wt.fromDom(n),r):en(wt.fromDom(n),r);var i=t.dom.createRng();i.setStart(r.dom,0),i.setEnd(r.dom,0),PC(t,i)})):PC(t,r.toRange())}(t,e,r,n)}))}))},eS=function(e,t,n,r){var o=e.selection.getRng(),i=gu.fromRangeStart(o),a=e.getBody();if(!t&&Jx(r,i)){var c=function(e,t,n){return $x(t,n).orThunk((function(){return ce(n.getClientRects()).bind((function(n){return sC(pC(e,gu.before(t)),n.left)}))})).getOr(gu.before(t))}(a,n,i);return Zx(e,t,c),!0}if(t&&Xx(r,i)){c=function(e,t,n){return Kx(t,n).orThunk((function(){return ce(n.getClientRects()).bind((function(n){return sC(gC(e,gu.after(t)),n.left)}))})).getOr(gu.after(t))}(a,n,i);return Zx(e,t,c),!0}return!1},tS=function(e,t,n){return F.from(e.dom.getParent(e.selection.getNode(),"td,th")).bind((function(r){return F.from(e.dom.getParent(r,"table")).map((function(o){return n(e,t,o,r)}))})).getOr(!1)},nS=function(e,t){return tS(e,t,Yx)},rS=function(e,t){return tS(e,t,eS)},oS=function(e,t){e.on("keydown",(function(n){!1===n.isDefaultPrevented()&&function(e,t,n){var r=ot().os;jx([{keyCode:Vf.RIGHT,action:Fx(Ax,e,!0)},{keyCode:Vf.LEFT,action:Fx(Ax,e,!1)},{keyCode:Vf.UP,action:Fx(_x,e,!1)},{keyCode:Vf.DOWN,action:Fx(_x,e,!0)},{keyCode:Vf.RIGHT,action:Fx(nS,e,!0)},{keyCode:Vf.LEFT,action:Fx(nS,e,!1)},{keyCode:Vf.UP,action:Fx(rS,e,!1)},{keyCode:Vf.DOWN,action:Fx(rS,e,!0)},{keyCode:Vf.RIGHT,action:Fx(Hx,e,!0)},{keyCode:Vf.LEFT,action:Fx(Hx,e,!1)},{keyCode:Vf.UP,action:Fx(Ux,e,!1)},{keyCode:Vf.DOWN,action:Fx(Ux,e,!0)},{keyCode:Vf.RIGHT,action:Fx(VC,e,t,!0)},{keyCode:Vf.LEFT,action:Fx(VC,e,t,!1)},{keyCode:Vf.RIGHT,ctrlKey:!r.isOSX(),altKey:r.isOSX(),action:Fx(KC,e,t)},{keyCode:Vf.LEFT,ctrlKey:!r.isOSX(),altKey:r.isOSX(),action:Fx(GC,e,t)},{keyCode:Vf.UP,action:Fx(Mx,e,!1)},{keyCode:Vf.DOWN,action:Fx(Mx,e,!0)}],n).each((function(e){n.preventDefault()}))}(e,t,n)}))},iS=function(e,t){e.on("keydown",(function(n){!1===n.isDefaultPrevented()&&function(e,t,n){jx([{keyCode:Vf.BACKSPACE,action:Fx(dx,e,!1)},{keyCode:Vf.BACKSPACE,action:Fx(kw,e,!1)},{keyCode:Vf.DELETE,action:Fx(kw,e,!0)},{keyCode:Vf.BACKSPACE,action:Fx(gw,e,!1)},{keyCode:Vf.DELETE,action:Fx(gw,e,!0)},{keyCode:Vf.BACKSPACE,action:Fx(ZC,e,t,!1)},{keyCode:Vf.DELETE,action:Fx(ZC,e,t,!0)},{keyCode:Vf.BACKSPACE,action:Fx(Rg,e,!1)},{keyCode:Vf.DELETE,action:Fx(Rg,e,!0)},{keyCode:Vf.BACKSPACE,action:Fx(Tw,e,!1)},{keyCode:Vf.DELETE,action:Fx(Tw,e,!0)},{keyCode:Vf.BACKSPACE,action:Fx(ix,e,!1)},{keyCode:Vf.DELETE,action:Fx(ix,e,!0)},{keyCode:Vf.BACKSPACE,action:Fx(iw,e,!1)},{keyCode:Vf.DELETE,action:Fx(iw,e,!0)},{keyCode:Vf.BACKSPACE,action:Fx(tw,e,!1)},{keyCode:Vf.DELETE,action:Fx(tw,e,!0)},{keyCode:Vf.BACKSPACE,action:Fx(rx,e,!1)},{keyCode:Vf.DELETE,action:Fx(rx,e,!0)}],n).each((function(e){n.preventDefault()}))}(e,t,n)})),e.on("keyup",(function(t){!1===t.isDefaultPrevented()&&function(e,t){jx([{keyCode:Vf.BACKSPACE,action:Fx(Sw,e)},{keyCode:Vf.DELETE,action:Fx(Sw,e)}],t)}(e,t)}))},aS=function(e,t){var n,r=t,o=e.dom,i=e.schema.getMoveCaretBeforeOnEnterElements();if(t){if(/^(LI|DT|DD)$/.test(t.nodeName)){var a=function(e){for(;e;){if(1===e.nodeType||3===e.nodeType&&e.data&&/[\r\n\s]/.test(e.data))return e;e=e.nextSibling}}(t.firstChild);a&&/^(UL|OL|DL)$/.test(a.nodeName)&&t.insertBefore(o.doc.createTextNode(""),t.firstChild)}var c=o.createRng();if(t.normalize(),t.hasChildNodes()){for(var u=new Yr(t,t);n=u.current();){if(Nn(n)){c.setStart(n,0),c.setEnd(n,0);break}if(i[n.nodeName.toLowerCase()]){c.setStartBefore(n),c.setEndBefore(n);break}r=n,n=u.next()}n||(c.setStart(r,0),c.setEnd(r,0))}else In(t)?t.nextSibling&&o.isBlock(t.nextSibling)?(c.setStartBefore(t),c.setEndBefore(t)):(c.setStartAfter(t),c.setEndAfter(t)):(c.setStart(t,0),c.setEnd(t,0));e.selection.setRng(c),Nd(e,c)}},cS=function(e){return F.from(e.dom.getParent(e.selection.getStart(!0),e.dom.isBlock))},uS=function(e,t){return e&&e.parentNode&&e.parentNode.nodeName===t},lS=function(e){return e&&/^(OL|UL|LI)$/.test(e.nodeName)},sS=function(e){var t=e.parentNode;return/^(LI|DT|DD)$/.test(t.nodeName)?t:e},fS=function(e,t,n){for(var r=e[n?"firstChild":"lastChild"];r&&!Cn(r);)r=r[n?"nextSibling":"previousSibling"];return r===t},dS=function(e,t,n,r,o){var i=e.dom,a=e.selection.getRng();if(n!==e.getBody()){var c;lS(c=n)&&lS(c.parentNode)&&(o="LI");var u=o?t(o):i.create("BR");if(fS(n,r,!0)&&fS(n,r,!1))if(uS(n,"LI")){var l=sS(n);i.insertAfter(u,l),!function(e){var t;return(null===(t=e.parentNode)||void 0===t?void 0:t.firstChild)===e}(n)?i.remove(n):i.remove(l)}else i.replace(u,n);else if(fS(n,r,!0))uS(n,"LI")?(i.insertAfter(u,sS(n)),u.appendChild(i.doc.createTextNode(" ")),u.appendChild(n)):n.parentNode.insertBefore(u,n),i.remove(r);else if(fS(n,r,!1))i.insertAfter(u,sS(n)),i.remove(r);else{n=sS(n);var s=a.cloneRange();s.setStartAfter(r),s.setEndAfter(n);var f=s.extractContents();"LI"===o&&function(e,t){return e.firstChild&&e.firstChild.nodeName===t}(f,"LI")?(u=f.firstChild,i.insertAfter(f,n)):(i.insertAfter(f,n),i.insertAfter(u,n)),i.remove(r)}aS(e,u)}},mS=function(e,t){return t&&"A"===t.nodeName&&e.isEmpty(t)},pS=function(e){e.innerHTML='<br data-mce-bogus="1">'},gS=function(e,t){return e.nodeName===t||e.previousSibling&&e.previousSibling.nodeName===t},hS=function(e,t){return t&&e.isBlock(t)&&!/^(TD|TH|CAPTION|FORM)$/.test(t.nodeName)&&!/^(fixed|absolute)/i.test(t.style.position)&&"true"!==e.getContentEditable(t)},vS=function(e,t,n){return!1===Nn(t)?n:e?1===n&&"\ufeff"===t.data.charAt(n-1)?0:n:n===t.data.length-1&&"\ufeff"===t.data.charAt(n)?t.data.length:n},bS=function(e,t){var n,r,o=e.getRoot();for(n=t;n!==o&&"false"!==e.getContentEditable(n);)"true"===e.getContentEditable(n)&&(r=n),n=n.parentNode;return n!==o?r:o},yS=function(e,t){var n=zu(e);n&&n.toLowerCase()===t.tagName.toLowerCase()&&function(e,t,n){var r=e.dom;F.from(n.style).map(r.parseStyle).each((function(e){var n=Qn(wt.fromDom(t)),o=De(De({},n),e);r.setStyles(t,o)}));var o=F.from(n.class).map((function(e){return e.split(/\s+/)})),i=F.from(t.className).map((function(e){return J(e.split(/\s+/),(function(e){return""!==e}))}));Hn(o,i,(function(e,n){var o=J(n,(function(t){return!W(e,t)})),i=Oe(Oe([],e,!0),o,!0);r.setAttrib(t,"class",i.join(" "))}));var a=["style","class"],c=be(n,(function(e,t){return!W(a,t)}));r.setAttribs(t,c)}(e,t,Wu(e))},wS=function(e,t){var n,r,o,i,a,c,u,l,s,f,d=e.dom,m=e.schema,p=m.getNonEmptyElements(),g=e.selection.getRng(),h=function(t){var n,o,a,c=r,u=m.getTextInlineElements();if(a=n=t||"TABLE"===l||"HR"===l?d.create(t||s):i.cloneNode(!1),!1===function(e){return e.getParam("keep_styles",!0)}(e))d.setAttrib(n,"style",null),d.setAttrib(n,"class",null);else do{if(u[c.nodeName]){if(Ss(c)||Bs(c))continue;o=c.cloneNode(!1),d.setAttrib(o,"id",""),n.hasChildNodes()?(o.appendChild(n.firstChild),n.appendChild(o)):(a=o,n.appendChild(o))}}while((c=c.parentNode)&&c!==C);return yS(e,n),pS(a),n},v=function(e){var t,n,a=vS(e,r,o);if(Nn(r)&&(e?a>0:a<r.nodeValue.length))return!1;if(r.parentNode===i&&f&&!e)return!0;if(e&&Cn(r)&&r===i.firstChild)return!0;if(gS(r,"TABLE")||gS(r,"HR"))return f&&!e||!f&&e;var c=new Yr(r,i);for(Nn(r)&&(e&&0===a?c.prev():e||a!==r.nodeValue.length||c.next());t=c.current();){if(Cn(t)){if(!t.getAttribute("data-mce-bogus")&&(n=t.nodeName.toLowerCase(),p[n]&&"br"!==n))return!1}else if(Nn(t)&&!Lo(t.nodeValue))return!1;e?c.prev():c.next()}return!0},b=function(){a=/^(H[1-6]|PRE|FIGURE)$/.test(l)&&"HGROUP"!==x?h(s):h(),function(e){return e.getParam("end_container_on_empty_block",!1)}(e)&&hS(d,u)&&d.isEmpty(i)?a=d.split(u,i):d.insertAfter(a,i),aS(e,a)};od(d,g).each((function(e){g.setStart(e.startContainer,e.startOffset),g.setEnd(e.endContainer,e.endOffset)})),r=g.startContainer,o=g.startOffset,s=zu(e);var y=!(!t||!t.shiftKey),w=!(!t||!t.ctrlKey);Cn(r)&&r.hasChildNodes()&&(f=o>r.childNodes.length-1,r=r.childNodes[Math.min(o,r.childNodes.length-1)]||r,o=f&&Nn(r)?r.nodeValue.length:0);var C=bS(d,r);if(C){(s&&!y||!s&&y)&&(r=function(e,t,n,r,o){var i,a,c,u,l,s,f=t||"P",d=e.dom,m=bS(d,r);if(!(a=d.getParent(r,d.isBlock))||!hS(d,a)){if(s=(a=a||m)===e.getBody()||function(e){return e&&/^(TD|TH|CAPTION)$/.test(e.nodeName)}(a)?a.nodeName.toLowerCase():a.parentNode.nodeName.toLowerCase(),!a.hasChildNodes())return i=d.create(f),yS(e,i),a.appendChild(i),n.setStart(i,0),n.setEnd(i,0),i;for(u=r;u.parentNode!==a;)u=u.parentNode;for(;u&&!d.isBlock(u);)c=u,u=u.previousSibling;if(c&&e.schema.isValidChild(s,f.toLowerCase())){for(i=d.create(f),yS(e,i),c.parentNode.insertBefore(i,c),u=c;u&&!d.isBlock(u);)l=u.nextSibling,i.appendChild(u),u=l;n.setStart(r,o),n.setEnd(r,o)}}return r}(e,s,g,r,o)),i=d.getParent(r,d.isBlock),u=i?d.getParent(i.parentNode,d.isBlock):null,l=i?i.nodeName.toUpperCase():"";var x=u?u.nodeName.toUpperCase():"";"LI"!==x||w||(i=u,u=u.parentNode,l=x),/^(LI|DT|DD)$/.test(l)&&d.isEmpty(i)?dS(e,h,u,i,s):s&&i===e.getBody()||(s=s||"P",po(i)?(a=So(i),d.isEmpty(i)&&pS(i),yS(e,a),aS(e,a)):v()?b():v(!0)?(a=i.parentNode.insertBefore(h(),i),aS(e,gS(i,"HR")?a:i)):((n=function(e){var t=e.cloneRange();return t.setStart(e.startContainer,vS(!0,e.startContainer,e.startOffset)),t.setEnd(e.endContainer,vS(!1,e.endContainer,e.endOffset)),t}(g).cloneRange()).setEndAfter(i),function(e){$(Sc(wt.fromDom(e),Dt),(function(e){var t=e.dom;t.nodeValue=so(t.nodeValue)}))}(c=n.extractContents()),function(e){do{Nn(e)&&(e.nodeValue=e.nodeValue.replace(/^[\r\n]+/,"")),e=e.firstChild}while(e)}(c),a=c.firstChild,d.insertAfter(c,i),function(e,t,n){var r,o=n,i=[];if(o){for(;o=o.firstChild;){if(e.isBlock(o))return;Cn(o)&&!t[o.nodeName.toLowerCase()]&&i.push(o)}for(r=i.length;r--;)(!(o=i[r]).hasChildNodes()||o.firstChild===o.lastChild&&""===o.firstChild.nodeValue||mS(e,o))&&e.remove(o)}}(d,p,a),function(e,t){t.normalize();var n=t.lastChild;n&&!/^(left|right)$/gi.test(e.getStyle(n,"float",!0))||e.add(t,"br")}(d,i),d.isEmpty(i)&&pS(i),a.normalize(),d.isEmpty(a)?(d.remove(a),b()):(yS(e,a),aS(e,a))),d.setAttrib(a,"id",""),e.fire("NewBlock",{newBlock:a}))}},CS=function(e,t,n){var r=e.dom.createRng();n?(r.setStartBefore(t),r.setEndBefore(t)):(r.setStartAfter(t),r.setEndAfter(t)),e.selection.setRng(r),Nd(e,r)},xS=function(e,t){var n,r,o=e.selection,i=e.dom,a=o.getRng();od(i,a).each((function(e){a.setStart(e.startContainer,e.startOffset),a.setEnd(e.endContainer,e.endOffset)}));var c=a.startOffset,u=a.startContainer;if(1===u.nodeType&&u.hasChildNodes()){var l=c>u.childNodes.length-1;u=u.childNodes[Math.min(c,u.childNodes.length-1)]||u,c=l&&3===u.nodeType?u.nodeValue.length:0}var s=i.getParent(u,i.isBlock),f=s?i.getParent(s.parentNode,i.isBlock):null,d=f?f.nodeName.toUpperCase():"",m=!(!t||!t.ctrlKey);"LI"!==d||m||(s=f),u&&3===u.nodeType&&c>=u.nodeValue.length&&(function(e,t,n){for(var r,o=new Yr(t,n),i=e.getNonEmptyElements();r=o.next();)if(i[r.nodeName.toLowerCase()]||r.length>0)return!0}(e.schema,u,s)||(n=i.create("br"),a.insertNode(n),a.setStartAfter(n),a.setEndAfter(n),r=!0)),n=i.create("br"),bu(i,a,n),CS(e,n,r),e.undoManager.add()},SS=function(e,t){var n=wt.fromTag("br");en(wt.fromDom(t),n),e.undoManager.add()},kS=function(e,t){TS(e.getBody(),t)||tn(wt.fromDom(t),wt.fromTag("br"));var n=wt.fromTag("br");tn(wt.fromDom(t),n),CS(e,n.dom,!1),e.undoManager.add()},TS=function(e,t){return n=gu.after(t),!!In(n.getNode())||ys(e,gu.after(t)).map((function(e){return In(e.getNode())})).getOr(!1);var n},ES=function(e){return e&&"A"===e.nodeName&&"href"in e},AS=function(e){return e.fold(I,ES,ES,I)},_S=function(e,t){t.fold(S,N(SS,e),N(kS,e),S)},NS=function(e,t){var n=function(e){var t=N(Py,e),n=gu.fromRangeStart(e.selection.getRng());return $w(t,e.getBody(),n).filter(AS)}(e);n.isSome()?n.each(N(_S,e)):xS(e,t)},RS=function(e,t){return cS(e).filter((function(e){return t.length>0&&xt(wt.fromDom(e),t)})).isSome()},DS=gr([{br:[]},{block:[]},{none:[]}]),OS=function(e,t){return function(e){return RS(e,function(e){return e.getParam("no_newline_selector","")}(e))}(e)},IS=function(e){return function(t,n){return""===zu(t)===e}},PS=function(e){return function(t,n){return function(e){return cS(e).filter((function(e){return io(wt.fromDom(e))})).isSome()}(t)===e}},BS=function(e,t){return function(n,r){return function(e){return cS(e).fold(E(""),(function(e){return e.nodeName.toUpperCase()}))}(n)===e.toUpperCase()===t}},MS=function(e){return BS("pre",e)},LS=function(e){return function(t,n){return function(e){return e.getParam("br_in_pre",!0)}(t)===e}},FS=function(e,t){return function(e){return RS(e,function(e){return e.getParam("br_newline_selector",".mce-toc h2,figcaption,caption")}(e))}(e)},jS=function(e,t){return t},HS=function(e){var t=zu(e),n=function(e,t){var n,r,o=e.getRoot();for(n=t;n!==o&&"false"!==e.getContentEditable(n);)"true"===e.getContentEditable(n)&&(r=n),n=n.parentNode;return n!==o?r:o}(e.dom,e.selection.getStart());return n&&e.schema.isValidChild(n.nodeName,t||"P")},US=function(e,t){return function(n,r){return Y(e,(function(e,t){return e&&t(n,r)}),!0)?F.some(t):F.none()}},zS=function(e,t){(function(e,t){return Mw([US([OS],DS.none()),US([BS("summary",!0)],DS.br()),US([MS(!0),LS(!1),jS],DS.br()),US([MS(!0),LS(!1)],DS.block()),US([MS(!0),LS(!0),jS],DS.block()),US([MS(!0),LS(!0)],DS.br()),US([PS(!0),jS],DS.br()),US([PS(!0)],DS.block()),US([IS(!0),jS,HS],DS.block()),US([IS(!0)],DS.br()),US([FS],DS.br()),US([IS(!1),jS],DS.br()),US([HS],DS.block())],[e,!(!t||!t.shiftKey)]).getOr(DS.none())})(e,t).fold((function(){NS(e,t)}),(function(){wS(e,t)}),S)},WS=function(e){e.on("keydown",(function(t){t.keyCode===Vf.ENTER&&function(e,t){var n;t.isDefaultPrevented()||(t.preventDefault(),(n=e.undoManager).typing&&(n.typing=!1,n.add()),e.undoManager.transact((function(){!1===e.selection.isCollapsed()&&e.execCommand("Delete"),zS(e,t)})))}(e,t)}))},VS=function(e,t){e.on("keydown",(function(n){!1===n.isDefaultPrevented()&&function(e,t,n){jx([{keyCode:Vf.END,action:Fx(Nx,e,!0)},{keyCode:Vf.HOME,action:Fx(Nx,e,!1)},{keyCode:Vf.END,action:Fx(zx,e,!0)},{keyCode:Vf.HOME,action:Fx(zx,e,!1)},{keyCode:Vf.END,action:Fx(JC,e,!0,t)},{keyCode:Vf.HOME,action:Fx(JC,e,!1,t)}],n).each((function(e){n.preventDefault()}))}(e,t,n)}))},qS=ot().browser,$S=function(e){!function(e){var t=pc((function(){e.composing||jp(e)}),0);qS.isIE()&&(e.on("keypress",(function(e){t.throttle()})),e.on("remove",(function(e){t.cancel()})))}(e),e.on("input",(function(t){!1===t.isComposing&&jp(e)}))},KS=ot(),GS=function(e){return e.stopImmediatePropagation()},JS=function(e){return e.keyCode===Vf.PAGE_UP||e.keyCode===Vf.PAGE_DOWN},XS=function(e,t,n){n&&!e.get()?t.on("NodeChange",GS,!0):!n&&e.get()&&t.off("NodeChange",GS),e.set(n)},YS=function(e,t){if(!KS.os.isOSX()){var n=cc(!1);e.on("keydown",(function(t){JS(t)&&XS(n,e,!0)})),e.on("keyup",(function(r){!1===r.isDefaultPrevented()&&function(e,t,n){jx([{keyCode:Vf.PAGE_UP,action:Fx(JC,e,!1,t)},{keyCode:Vf.PAGE_DOWN,action:Fx(JC,e,!0,t)}],n)}(e,t,r),JS(r)&&n.get()&&(XS(n,e,!1),e.nodeChanged())}))}},QS=function(e,t){var n=t.container(),r=t.offset();return Nn(n)?(n.insertData(r,e),F.some(gu(n,r+e.length))):Xl(t).map((function(n){var r=wt.fromText(e);return t.isAtEnd()?tn(n,r):en(n,r),gu(r.dom,e.length)}))},ZS=N(QS,""),ek=N(QS," "),tk=function(e,t){return function(n){return function(e,t){return!Rp(t)&&(Dp(e,t)||_p(e,t)||Np(e,t))}(e,n)?ZS(t):ek(t)}},nk=function(e){var t=gu.fromRangeStart(e.selection.getRng()),n=wt.fromDom(e.getBody());if(e.selection.isCollapsed()){var r=N(Py,e),o=gu.fromRangeStart(e.selection.getRng());return $w(r,e.getBody(),o).bind(function(e){return function(t){return t.fold((function(t){return ws(e.dom,gu.before(t))}),(function(e){return Cs(e)}),(function(e){return xs(e)}),(function(t){return ys(e.dom,gu.after(t))}))}}(n)).bind(tk(n,t)).exists(function(e){return function(t){return e.selection.setRng(t.toRange()),e.nodeChanged(),!0}}(e))}return!1},rk=function(e){e.on("keydown",(function(t){!1===t.isDefaultPrevented()&&function(e,t){jx([{keyCode:Vf.SPACEBAR,action:Fx(nk,e)}],t).each((function(e){t.preventDefault()}))}(e,t)}))},ok=function(e){var t=$C(e);return function(e){e.on("keyup compositionstart",N(xx,e))}(e),oS(e,t),iS(e,t),WS(e),rk(e),$S(e),VS(e,t),YS(e,t),t},ik=function(){function e(e){var t;this.lastPath=[],this.editor=e;var n=this;"onselectionchange"in e.getDoc()||e.on("NodeChange click mouseup keyup focus",(function(n){var r=e.selection.getRng(),o={startContainer:r.startContainer,startOffset:r.startOffset,endContainer:r.endContainer,endOffset:r.endOffset};"nodechange"!==n.type&&Jf(o,t)||e.fire("SelectionChange"),t=o})),e.on("contextmenu",(function(){e.fire("SelectionChange")})),e.on("SelectionChange",(function(){var t=e.selection.getStart(!0);!t||!mt.range&&e.selection.isCollapsed()||_f(e)&&!n.isSameElementPath(t)&&e.dom.isChildOf(t,e.getBody())&&e.nodeChanged({selectionChange:!0})})),e.on("mouseup",(function(t){!t.isDefaultPrevented()&&_f(e)&&("IMG"===e.selection.getNode().nodeName?Gr.setEditorTimeout(e,(function(){e.nodeChanged()})):e.nodeChanged())}))}return e.prototype.nodeChanged=function(e){var t,n,r,o=this.editor.selection;this.editor.initialized&&o&&!this.editor.getParam("disable_nodechange")&&!this.editor.mode.isReadOnly()&&(r=this.editor.getBody(),(t=o.getStart(!0)||r).ownerDocument===this.editor.getDoc()&&this.editor.dom.isChildOf(t,r)||(t=r),n=[],this.editor.dom.getParent(t,(function(e){if(e===r)return!0;n.push(e)})),(e=e||{}).element=t,e.parents=n,this.editor.fire("NodeChange",e))},e.prototype.isSameElementPath=function(e){var t,n=this.editor.$(e).parentsUntil(this.editor.getBody()).add(e);if(n.length===this.lastPath.length){for(t=n.length;t>=0&&n[t]===this.lastPath[t];t--);if(-1===t)return this.lastPath=n,!0}return this.lastPath=n,!1},e}(),ak=function(e){!function(e){e.on("click",(function(t){e.dom.getParent(t.target,"details")&&t.preventDefault()}))}(e),function(e){e.parser.addNodeFilter("details",(function(e){$(e,(function(e){e.attr("data-mce-open",e.attr("open")),e.attr("open","open")}))})),e.serializer.addNodeFilter("details",(function(e){$(e,(function(e){var t=e.attr("data-mce-open");e.attr("open",m(t)?t:null),e.attr("data-mce-open",null)}))}))}(e)},ck=function(e){return Cn(e)&&ro(wt.fromDom(e))},uk=function(e){e.on("click",(function(t){t.detail>=3&&function(e){var t=e.selection.getRng(),n=gu.fromRangeStart(t),r=gu.fromRangeEnd(t);if(gu.isElementPosition(n)){var o=n.container();ck(o)&&Cs(o).each((function(e){return t.setStart(e.container(),e.offset())}))}if(gu.isElementPosition(r)){o=n.container();ck(o)&&xs(o).each((function(e){return t.setEnd(e.container(),e.offset())}))}e.selection.setRng(Og(t))}(e)}))},lk=function(e){var t=e.getBoundingClientRect(),n=e.ownerDocument,r=n.documentElement,o=n.defaultView;return{top:t.top+o.pageYOffset-r.clientTop,left:t.left+o.pageXOffset-r.clientLeft}},sk=function(e,t){return function(e,t,n){return{pageX:n.left-e.left+t.left,pageY:n.top-e.top+t.top}}(function(e){return e.inline?lk(e.getBody()):{left:0,top:0}}(e),function(e){var t=e.getBody();return e.inline?{left:t.scrollLeft,top:t.scrollTop}:{left:0,top:0}}(e),function(e,t){if(t.target.ownerDocument!==e.getDoc()){var n=lk(e.getContentAreaContainer()),r=function(e){var t=e.getBody(),n=e.getDoc().documentElement,r={left:t.scrollLeft,top:t.scrollTop},o={left:t.scrollLeft||n.scrollLeft,top:t.scrollTop||n.scrollTop};return e.inline?r:o}(e);return{left:t.pageX-n.left+r.left,top:t.pageY-n.top+r.top}}return{left:t.pageX,top:t.pageY}}(e,t))},fk=Mn,dk=Bn,mk=function(e,t,n,r){var o=e.dom,i=t.cloneNode(!0);o.setStyles(i,{width:n,height:r}),o.setAttrib(i,"data-mce-selected",null);var a=o.create("div",{class:"mce-drag-container","data-mce-bogus":"all",unselectable:"on",contenteditable:"false"});return o.setStyles(a,{position:"absolute",opacity:.5,overflow:"hidden",border:0,padding:0,margin:0,width:n,height:r}),o.setStyles(i,{margin:0,boxSizing:"border-box"}),a.appendChild(i),a},pk=function(e){e&&e.parentNode&&e.parentNode.removeChild(e)},gk=function(e,t){return function(n){if(function(e){return 0===e.button}(n)){var r=Z(t.dom.getParents(n.target),function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){for(var n=0;n<e.length;n++)if(e[n](t))return!0;return!1}}(fk,dk)).getOr(null);if(c=t.getBody(),fk(u=r)&&u!==c){var o=t.dom.getPos(r),i=t.getBody(),a=t.getDoc().documentElement;e.set({element:r,dragging:!1,screenX:n.screenX,screenY:n.screenY,maxX:(t.inline?i.scrollWidth:a.offsetWidth)-2,maxY:(t.inline?i.scrollHeight:a.offsetHeight)-2,relX:n.pageX-o.x,relY:n.pageY-o.y,width:r.offsetWidth,height:r.offsetHeight,ghost:mk(t,r,r.offsetWidth,r.offsetHeight)})}}var c,u}},hk=function(e,t){return function(n){e.on((function(e){if(e.dragging){if(function(e,t,n){return t!==n&&!e.dom.isChildOf(t,n)&&!fk(t)}(t,(a=t.selection,3===(c=a.getSel().getRangeAt(0).startContainer).nodeType?c.parentNode:c),e.element)){var r=(o=e.element,(i=o.cloneNode(!0)).removeAttribute("data-mce-selected"),i);t.fire("drop",{clientX:n.clientX,clientY:n.clientY}).isDefaultPrevented()||t.undoManager.transact((function(){pk(e.element),t.insertContent(t.dom.getOuterHTML(r)),t._selectionOverrides.hideFakeCaret()}))}t.fire("dragend")}var o,i,a,c})),vk(e)}},vk=function(e){e.on((function(e){pk(e.ghost)})),e.clear()},bk=function(e){var t=mc(),n=nc.DOM,r=document,o=gk(t,e),i=function(e,t){var n=Gr.throttle((function(e,n){t._selectionOverrides.hideFakeCaret(),t.selection.placeCaretAt(e,n)}),0);return t.on("remove",n.stop),function(r){return e.on((function(e){var o,i,a=Math.max(Math.abs(r.screenX-e.screenX),Math.abs(r.screenY-e.screenY));if(!e.dragging&&a>10){if(t.fire("dragstart",{target:e.element}).isDefaultPrevented())return;e.dragging=!0,t.focus()}if(e.dragging){var c=function(e,t){return{pageX:t.pageX-e.relX,pageY:t.pageY+5}}(e,sk(t,r));o=e.ghost,i=t.getBody(),o.parentNode!==i&&i.appendChild(o),function(e,t,n,r,o,i){var a=0,c=0;e.style.left=t.pageX+"px",e.style.top=t.pageY+"px",t.pageX+n>o&&(a=t.pageX+n-o),t.pageY+r>i&&(c=t.pageY+r-i),e.style.width=n-a+"px",e.style.height=r-c+"px"}(e.ghost,c,e.width,e.height,e.maxX,e.maxY),n(r.clientX,r.clientY)}}))}}(t,e),a=hk(t,e),c=function(e,t){return function(){e.on((function(e){e.dragging&&t.fire("dragend")})),vk(e)}}(t,e);e.on("mousedown",o),e.on("mousemove",i),e.on("mouseup",a),n.bind(r,"mousemove",i),n.bind(r,"mouseup",c),e.on("remove",(function(){n.unbind(r,"mousemove",i),n.unbind(r,"mouseup",c)})),e.on("keydown",(function(e){e.keyCode===Vf.ESC&&c()}))},yk=function(e){bk(e),function(e){e.on("drop",(function(t){var n=void 0!==t.clientX?e.getDoc().elementFromPoint(t.clientX,t.clientY):null;(fk(n)||"false"===e.dom.getContentEditableParent(n))&&t.preventDefault()}))}(e),function(e){return e.getParam("block_unsupported_drop",!0,"boolean")}(e)&&function(e){var t=function(t){if(!t.isDefaultPrevented()){var n=t.dataTransfer;n&&(W(n.types,"Files")||n.files.length>0)&&(t.preventDefault(),"drop"===t.type&&iy(e,"Dropped file type is not supported"))}},n=function(n){Qd(e,n.target)&&t(n)},r=function(){var r=nc.DOM,o=e.dom,i=document,a=e.inline?e.getBody():e.getDoc(),c=["drop","dragover"];$(c,(function(e){r.bind(i,e,n),o.bind(a,e,t)})),e.on("remove",(function(){$(c,(function(e){r.unbind(i,e,n),o.unbind(a,e,t)}))}))};e.on("init",(function(){Gr.setEditorTimeout(e,r,0)}))}(e)},wk=Bn,Ck=Mn,xk=function(e,t){return jf(e.getBody(),t)},Sk=function(e){var t,n=e.selection,r=e.dom,o=r.isBlock,i=e.getBody(),a=kl(e,i,o,(function(){return im(e)})),c="sel-"+r.uniqueId(),u=function(e){return e!==i&&(Ck(e)||Fn(e))&&r.isChildOf(e,i)},l=function(e){return op(e)||ip(e)||ep(e)||tp(e)},s=function(e){e&&n.setRng(e)},f=n.getRng,d=function(t,r,o,i){return void 0===i&&(i=!0),e.fire("ShowCaret",{target:r,direction:t,before:o}).isDefaultPrevented()?null:(i&&n.scrollIntoView(r,-1===t),a.show(o,r))},m=function(e){return ho(e)||Co(e)||xo(e)},p=function(e){return m(e.startContainer)||m(e.endContainer)},g=function(t){var n=e.schema.getShortEndedElements(),o=r.createRng(),i=t.startContainer,a=t.startOffset,c=t.endContainer,u=t.endOffset;return Ce(n,i.nodeName.toLowerCase())?0===a?o.setStartBefore(i):o.setStartAfter(i):o.setStart(i,a),Ce(n,c.nodeName.toLowerCase())?0===u?o.setEndBefore(c):o.setEndAfter(c):o.setEnd(c,u),o},h=function(o){var i=o.cloneNode(!0),a=e.fire("ObjectSelected",{target:o,targetClone:i});if(a.isDefaultPrevented())return null;var u=function(t,o,i){var a=e.$,u=zr(wt.fromDom(e.getBody()),"#"+c).fold((function(){return a([])}),(function(e){return a([e.dom])}));0===u.length&&(u=a('<div data-mce-bogus="all" class="mce-offscreen-selection"></div>').attr("id",c)).appendTo(e.getBody());var l=r.createRng();o===i&&mt.ie?(u.empty().append('<p style="font-size: 0" data-mce-bogus="all"></p>').append(o),l.setStartAfter(u[0].firstChild.firstChild),l.setEndAfter(o)):(u.empty().append("").append(o).append(""),l.setStart(u[0].firstChild,1),l.setEnd(u[0].lastChild,0)),u.css({top:r.getPos(t,e.getBody()).y}),u[0].focus();var s=n.getSel();return s.removeAllRanges(),s.addRange(l),l}(o,a.targetClone,i),l=wt.fromDom(o);return $(kc(wt.fromDom(e.getBody()),"*[data-mce-selected]"),(function(e){kt(l,e)||Kn(e,"data-mce-selected")})),r.getAttrib(o,"data-mce-selected")||o.setAttribute("data-mce-selected","1"),t=o,w(),u},v=function(e,t){if(!e)return null;if(e.collapsed){if(!p(e)){var n=t?1:-1,o=Jl(n,i,e),a=o.getNode(!t);if(Al(a))return d(n,a,!!t&&!o.isAtEnd(),!1);var c=o.getNode(t);if(Al(c))return d(n,c,!t&&!o.isAtEnd(),!1)}return null}var l=e.startContainer,s=e.startOffset,f=e.endOffset;if(3===l.nodeType&&0===s&&Ck(l.parentNode)&&(l=l.parentNode,s=r.nodeIndex(l),l=l.parentNode),1!==l.nodeType)return null;if(f===s+1&&l===e.endContainer){var m=l.childNodes[s];if(u(m))return h(m)}return null},b=function(){t&&t.removeAttribute("data-mce-selected"),zr(wt.fromDom(e.getBody()),"#"+c).each(cn),t=null},w=function(){a.hide()};return mt.ceFalse&&!Ov(e)&&function(){e.on("mouseup",(function(t){var n=f();n.collapsed&&Qb(e,t.clientX,t.clientY)&&sw(e,n,!1).each(s)})),e.on("click",(function(t){var o=xk(e,t.target);o&&(Ck(o)&&(t.preventDefault(),e.focus()),wk(o)&&r.isChildOf(o,n.getNode())&&b())})),e.on("blur NewBlock",b),e.on("ResizeWindow FullscreenStateChanged",a.reposition);var m=function(t,n){var i,a,c=r.getParent(t,o),u=r.getParent(n,o);return!y(c)&&(!(t===u||!r.isChildOf(c,u)||!1!==Ck(xk(e,c)))||!r.isChildOf(u,c)&&(i=c,a=u,!(r.getParent(i,o)===r.getParent(a,o)))&&function(e){var t=e.firstChild;if(y(t))return!1;var n=gu.before(t);if(In(n.getNode())&&1===e.childNodes.length)return!l(n);var r=ss(e).next(n);return r&&!l(r)}(c))};e.on("tap",(function(t){var n=t.target,r=xk(e,n);Ck(r)?(t.preventDefault(),lw(e,r).each(v)):u(n)&&lw(e,n).each(v)}),!0),e.on("mousedown",(function(t){var o=t.target;if((o===i||"HTML"===o.nodeName||r.isChildOf(o,i))&&!1!==Qb(e,t.clientX,t.clientY)){var a=xk(e,o);if(a)Ck(a)?(t.preventDefault(),lw(e,a).each(v)):(b(),wk(a)&&t.shiftKey||Hf(t.clientX,t.clientY,n.getRng())||(w(),n.placeCaretAt(t.clientX,t.clientY)));else if(u(o))lw(e,o).each(v);else if(!1===Al(o)){b(),w();var c=IC(i,t.clientX,t.clientY);if(c&&!m(o,c.node)){t.preventDefault();var l=d(1,c.node,c.before,!1);s(l),e.getBody().focus()}}}})),e.on("keypress",(function(e){Vf.modifierPressed(e)||Ck(n.getNode())&&e.preventDefault()})),e.on("GetSelectionRange",(function(e){var n=e.range;if(t){if(!t.parentNode)return void(t=null);(n=n.cloneRange()).selectNode(t),e.range=n}})),e.on("SetSelectionRange",(function(e){e.range=g(e.range);var t=v(e.range,e.forward);t&&(e.range=t)}));e.on("AfterSetSelectionRange",(function(e){var t=e.range,n=t.startContainer.parentNode;p(t)||"mcepastebin"===n.id||w(),function(e){return r.hasClass(e,"mce-offscreen-selection")}(n)||b()})),e.on("copy",(function(e){var t,n=e.clipboardData;if(!e.isDefaultPrevented()&&e.clipboardData&&!mt.ie){var o=(t=r.get(c))?t.getElementsByTagName("*")[0]:t;o&&(e.preventDefault(),n.clearData(),n.setData("text/html",o.outerHTML),n.setData("text/plain",o.outerText||o.innerText))}})),yk(e),function(e){var t=pc((function(){if(!e.removed&&e.getBody().contains(document.activeElement)){var t=e.selection.getRng();if(t.collapsed){var n=fw(e,t,!1);e.selection.setRng(n)}}}),0);e.on("focus",(function(){t.throttle()})),e.on("blur",(function(){t.cancel()}))}(e),function(e){e.on("init",(function(){e.on("focusin",(function(t){var n=t.target;if(Fn(n)){var r=jf(e.getBody(),n),o=Mn(r)?r:n;e.selection.getNode()!==o&&lw(e,o).each((function(t){return e.selection.setRng(t)}))}}))}))}(e)}(),{showCaret:d,showBlockCaretContainer:function(e){e.hasAttribute("data-mce-caret")&&(So(e),s(f()),n.scrollIntoView(e))},hideFakeCaret:w,destroy:function(){a.destroy(),t=null}}},kk=function(e){var t,n,r=bt.each,o=Vf.BACKSPACE,i=Vf.DELETE,a=e.dom,c=e.selection,u=e.parser,l=mt.gecko,s=mt.ie,f=mt.webkit,d=s?"Text":"URL",m=function(t,n){try{e.getDoc().execCommand(t,!1,n)}catch(e){}},p=function(e){return e.isDefaultPrevented()},g=function(){var t=function(e){var t=a.create("body"),n=e.cloneContents();return t.appendChild(n),c.serializer.serialize(t,{format:"html"})};e.on("keydown",(function(n){var r,c,u=n.keyCode;if(!p(n)&&(u===i||u===o)){if(r=e.selection.isCollapsed(),c=e.getBody(),r&&!a.isEmpty(c))return;if(!r&&!function(n){var r=t(n),o=a.createRng();return o.selectNode(e.getBody()),r===t(o)}(e.selection.getRng()))return;n.preventDefault(),e.setContent(""),c.firstChild&&a.isBlock(c.firstChild)?e.selection.setCursorLocation(c.firstChild,0):e.selection.setCursorLocation(c,0),e.nodeChanged()}}))},h=function(){e.shortcuts.add("meta+a",null,"SelectAll")},v=function(){e.inline||a.bind(e.getDoc(),"mousedown mouseup",(function(t){var n;if(t.target===e.getDoc().documentElement)if(n=c.getRng(),e.getBody().focus(),"mousedown"===t.type){if(ho(n.startContainer))return;c.placeCaretAt(t.clientX,t.clientY)}else c.setRng(n)}))},b=function(){Range.prototype.getClientRects||e.on("mousedown",(function(t){if(!p(t)&&"HTML"===t.target.nodeName){var n=e.getBody();n.blur(),Gr.setEditorTimeout(e,(function(){n.focus()}))}}))},y=function(){e.on("click",(function(t){var n=t.target;/^(IMG|HR)$/.test(n.nodeName)&&"false"!==a.getContentEditableParent(n)&&(t.preventDefault(),e.selection.select(n),e.nodeChanged()),"A"===n.nodeName&&a.hasClass(n,"mce-item-anchor")&&(t.preventDefault(),c.select(n))}))},w=function(){e.on("keydown",(function(e){if(!p(e)&&e.keyCode===o&&c.isCollapsed()&&0===c.getRng().startOffset){var t=c.getNode().previousSibling;if(t&&t.nodeName&&"table"===t.nodeName.toLowerCase())return e.preventDefault(),!1}}))},C=function(){(function(e){return e.getParam("readonly")})(e)||e.on("BeforeExecCommand mousedown",(function(){m("StyleWithCSS",!1),m("enableInlineTableEditing",!1),nl(e)||m("enableObjectResizing",!1)}))},x=function(){e.on("SetContent ExecCommand",(function(e){"setcontent"!==e.type&&"mceInsertLink"!==e.command||r(a.select("a"),(function(e){var t=e.parentNode,n=a.getRoot();if(t.lastChild===e){for(;t&&!a.isBlock(t);){if(t.parentNode.lastChild!==t||t===n)return;t=t.parentNode}a.add(t,"br",{"data-mce-bogus":1})}}))}))},k=function(){e.contentStyles.push("img:-moz-broken {-moz-force-broken-image-icon:1;min-width:24px;min-height:24px}")},T=function(){e.inline||e.on("keydown",(function(){document.activeElement===document.body&&e.getWin().focus()}))},E=function(){e.inline||(e.contentStyles.push("body {min-height: 150px}"),e.on("click",(function(t){var n;if("HTML"===t.target.nodeName){if(mt.ie>11)return void e.getBody().focus();n=e.selection.getRng(),e.getBody().focus(),e.selection.setRng(n),e.selection.normalize(),e.nodeChanged()}})))},A=function(){mt.mac&&e.on("keydown",(function(t){!Vf.metaKeyPressed(t)||t.shiftKey||37!==t.keyCode&&39!==t.keyCode||(t.preventDefault(),e.selection.getSel().modify("move",37===t.keyCode?"backward":"forward","lineboundary"))}))},_=function(){e.on("click",(function(e){var t=e.target;do{if("A"===t.tagName)return void e.preventDefault()}while(t=t.parentNode)})),e.contentStyles.push(".mce-content-body {-webkit-touch-callout: none}")},N=function(){e.on("init",(function(){e.dom.bind(e.getBody(),"submit",(function(e){e.preventDefault()}))}))},R=function(){e.on("dragstart",(function(t){!function(t){var n,r;t.dataTransfer&&(e.selection.isCollapsed()&&"IMG"===t.target.tagName&&c.select(t.target),(n=e.selection.getContent()).length>0&&(r="data:text/mce-internal,"+escape(e.id)+","+escape(n),t.dataTransfer.setData(d,r)))}(t)})),e.on("drop",(function(t){if(!p(t)){var n=function(e){var t;return e.dataTransfer&&(t=e.dataTransfer.getData(d))&&t.indexOf("data:text/mce-internal,")>=0?(t=t.substr("data:text/mce-internal,".length).split(","),{id:unescape(t[0]),html:unescape(t[1])}):null}(t);if(n&&n.id!==e.id){t.preventDefault();var r=Gf(t.x,t.y,e.getDoc());c.setRng(r),o=n.html,i=!0,e.queryCommandSupported("mceInsertClipboardContent")?e.execCommand("mceInsertClipboardContent",!1,{content:o,internal:i}):e.execCommand("mceInsertContent",!1,o)}}var o,i}))},D=S;return Ov(e)?(f&&(v(),y(),N(),h(),mt.iOS&&(T(),E(),_())),l&&(b(),C(),k(),A())):(e.on("keydown",(function(t){var n,r;if(!p(t)&&t.keyCode===Vf.BACKSPACE){var o=(n=c.getRng()).startContainer,i=n.startOffset,u=a.getRoot();if(r=o,n.collapsed&&0===i){for(;r&&r.parentNode&&r.parentNode.firstChild===r&&r.parentNode!==u;)r=r.parentNode;"BLOCKQUOTE"===r.tagName&&(e.formatter.toggle("blockquote",null,r),(n=a.createRng()).setStart(o,0),n.setEnd(o,0),c.setRng(n))}}})),g(),mt.windowsPhone||e.on("keyup focusin mouseup",(function(e){Vf.modifierPressed(e)||c.normalize()}),!0),f&&(v(),y(),zu(e)&&e.on("init",(function(){m("DefaultParagraphSeparator",zu(e))})),N(),w(),u.addNodeFilter("br",(function(e){for(var t=e.length;t--;)"Apple-interchange-newline"===e[t].attr("class")&&e[t].remove()})),mt.iOS?(T(),E(),_()):h()),mt.ie>=11&&(E(),w()),mt.ie&&(h(),m("AutoUrlDetect",!1),R()),l&&(e.on("keydown",(function(t){if(!p(t)&&t.keyCode===o){if(!e.getBody().getElementsByTagName("hr").length)return;if(c.isCollapsed()&&0===c.getRng().startOffset){var n=c.getNode(),r=n.previousSibling;if("HR"===n.nodeName)return a.remove(n),void t.preventDefault();r&&r.nodeName&&"hr"===r.nodeName.toLowerCase()&&(a.remove(r),t.preventDefault())}}})),b(),t=function(){var t=a.getAttribs(c.getStart().cloneNode(!1));return function(){var n=c.getStart();n!==e.getBody()&&(a.setAttrib(n,"style",null),r(t,(function(e){n.setAttributeNode(e.cloneNode(!0))})))}},n=function(){return!c.isCollapsed()&&a.getParent(c.getStart(),a.isBlock)!==a.getParent(c.getEnd(),a.isBlock)},e.on("keypress",(function(r){var o;if(!p(r)&&(8===r.keyCode||46===r.keyCode)&&n())return o=t(),e.getDoc().execCommand("delete",!1,null),o(),r.preventDefault(),!1})),a.bind(e.getDoc(),"cut",(function(r){var o;!p(r)&&n()&&(o=t(),Gr.setEditorTimeout(e,(function(){o()})))})),C(),x(),k(),A(),w())),{refreshContentEditable:D,isHidden:function(){if(!l||e.removed)return!1;var t=e.selection.getSel();return!t||!t.rangeCount||0===t.rangeCount}}},Tk=nc.DOM,Ek=function(e){return e.inline?e.getElement().nodeName.toLowerCase():void 0},Ak=function(e){return be(e,(function(e){return!1===b(e)}))},_k=function(e){var t=e.settings,n=e.editorUpload.blobCache;return Ak({allow_conditional_comments:t.allow_conditional_comments,allow_html_data_urls:t.allow_html_data_urls,allow_svg_data_urls:t.allow_svg_data_urls,allow_html_in_named_anchor:t.allow_html_in_named_anchor,allow_script_urls:t.allow_script_urls,allow_unsafe_link_target:t.allow_unsafe_link_target,convert_fonts_to_spans:t.convert_fonts_to_spans,fix_list_elements:t.fix_list_elements,font_size_legacy_values:t.font_size_legacy_values,forced_root_block:t.forced_root_block,forced_root_block_attrs:t.forced_root_block_attrs,padd_empty_with_br:t.padd_empty_with_br,preserve_cdata:t.preserve_cdata,remove_trailing_brs:t.remove_trailing_brs,inline_styles:t.inline_styles,root_name:Ek(e),validate:!0,blob_cache:n,document:e.getDoc(),images_dataimg_filter:t.images_dataimg_filter})},Nk=function(e){var t=e.dom.getRoot();e.inline||_f(e)&&e.selection.getStart(!0)!==t||Cs(t).each((function(t){var n=t.getNode(),r=En(n)?Cs(n).getOr(t):t;mt.browser.isIE()?function(e,t){var n=wt.fromDom(e.getBody()),r=(zd(e)?F.from(t):F.none()).map(Wd).filter(Ud(n));e.bookmark=r.isSome()?r:e.bookmark}(e,r.toRange()):e.selection.setRng(r.toRange())}))},Rk=function(e){e.bindPendingEventDelegates(),e.initialized=!0,function(e){e.fire("Init")}(e),e.focus(!0),Nk(e),e.nodeChanged({initial:!0}),e.execCallback("init_instance_callback",e),function(e){e.settings.auto_focus&&Gr.setEditorTimeout(e,(function(){var t;(t=!0===e.settings.auto_focus?e:e.editorManager.get(e.settings.auto_focus)).destroyed||t.focus()}),100)}(e)},Dk=function(e){return e.inline?e.ui.styleSheetLoader:e.dom.styleSheetLoader},Ok=function(e){var t=Dk(e),n=tl(e),r=e.contentCSS,o=function(){t.unloadAll(r),e.inline||e.ui.styleSheetLoader.unloadAll(n)},i=function(){e.removed?o():e.on("remove",o)};if(e.contentStyles.length>0){var a="";bt.each(e.contentStyles,(function(e){a+=e+"\r\n"})),e.dom.addStyle(a)}var c=Vr.all(function(e,t,n){var r=[new Vr((function(n,r){return Dk(e).loadAll(t,n,r)}))];return e.inline?r:r.concat([new Vr((function(t,r){return e.ui.styleSheetLoader.loadAll(n,t,r)}))])}(e,r,n)).then(i).catch(i);return e.settings.content_style&&function(e,t){var n=wt.fromDom(e.getBody()),r=Yt(Xt(n)),o=wt.fromTag("style");Wn(o,"type","text/css"),rn(o,wt.fromText(t)),rn(r,o),e.on("remove",(function(){cn(o)}))}(e,e.settings.content_style),c},Ik=function(e){var t=e.settings,n=e.getDoc(),r=e.getBody();!function(e){e.fire("PreInit")}(e),t.browser_spellcheck||t.gecko_spellcheck||(n.body.spellcheck=!1,Tk.setAttrib(r,"spellcheck","false")),e.quirks=kk(e),function(e){e.fire("PostRender")}(e);var o=function(e){return e.getParam("directionality",fc.isRtl()?"rtl":void 0)}(e);void 0!==o&&(r.dir=o),t.protect&&e.on("BeforeSetContent",(function(e){bt.each(t.protect,(function(t){e.content=e.content.replace(t,(function(e){return"\x3c!--mce:protected "+escape(e)+"--\x3e"}))}))})),e.on("SetContent",(function(){e.addVisual(e.getBody())})),e.on("compositionstart compositionend",(function(t){e.composing="compositionstart"===t.type}))},Pk=function(e){!0!==e.removed&&(!function(e){Ov(e)||e.load({initial:!0,format:"html"}),e.startContent=e.getContent({format:"raw"})}(e),Rk(e))},Bk=function(e,t){var n=e.settings,r=e.getElement(),o=e.getDoc();n.inline||(e.getElement().style.visibility=e.orgVisibility),t||e.inline||(o.open(),o.write(e.iframeHTML),o.close()),e.inline&&(Tk.addClass(r,"mce-content-body"),e.contentDocument=o=document,e.contentWindow=window,e.bodyElement=r,e.contentAreaContainer=r);var i=e.getBody();i.disabled=!0,e.readonly=!!n.readonly,e.readonly||(e.inline&&"static"===Tk.getStyle(i,"position",!0)&&(i.style.position="relative"),i.contentEditable=e.getParam("content_editable_state",!0)),i.disabled=!1,e.editorUpload=yy(e),e.schema=vi(n),e.dom=nc(o,{keep_values:!0,url_converter:e.convertURL,url_converter_scope:e,hex_colors:n.force_hex_style_colors,update_styles:!0,root_element:e.inline?e.getBody():null,collect:function(){return e.inline},schema:e.schema,contentCssCors:Yu(e),referrerPolicy:Qu(e),onSetAttrib:function(t){e.fire("SetAttrib",t)}}),e.parser=function(e){var t=lb(_k(e),e.schema);return t.addAttributeFilter("src,href,style,tabindex",(function(t,n){for(var r,o,i=t.length,a=e.dom,c="data-mce-"+n;i--;)if((o=(r=t[i]).attr(n))&&!r.attr(c)){if(0===o.indexOf("data:")||0===o.indexOf("blob:"))continue;"style"===n?((o=a.serializeStyle(a.parseStyle(o),r.name)).length||(o=null),r.attr(c,o),r.attr(n,o)):"tabindex"===n?(r.attr(c,o),r.attr(n,null)):r.attr(c,e.convertURL(o,n,r.name))}})),t.addNodeFilter("script",(function(e){for(var t=e.length;t--;){var n=e[t],r=n.attr("type")||"no/type";0!==r.indexOf("mce-")&&n.attr("type","mce-"+r)}})),e.settings.preserve_cdata&&t.addNodeFilter("#cdata",(function(t){for(var n=t.length;n--;){var r=t[n];r.type=8,r.name="#comment",r.value="[CDATA["+e.dom.encode(r.value)+"]]"}})),t.addNodeFilter("p,h1,h2,h3,h4,h5,h6,div",(function(t){for(var n=t.length,r=e.schema.getNonEmptyElements();n--;){var o=t[n];o.isEmpty(r)&&0===o.getAll("br").length&&(o.append(new bm("br",1)).shortEnded=!0)}})),t}(e),e.serializer=pb(function(e){var t=e.settings;return De(De({},_k(e)),Ak({url_converter:t.url_converter,url_converter_scope:t.url_converter_scope,element_format:t.element_format,entities:t.entities,entity_encoding:t.entity_encoding,indent:t.indent,indent_after:t.indent_after,indent_before:t.indent_before,block_elements:t.block_elements,boolean_attributes:t.boolean_attributes,custom_elements:t.custom_elements,extended_valid_elements:t.extended_valid_elements,invalid_elements:t.invalid_elements,invalid_styles:t.invalid_styles,move_caret_before_on_enter_elements:t.move_caret_before_on_enter_elements,non_empty_elements:t.non_empty_elements,schema:t.schema,self_closing_elements:t.self_closing_elements,short_ended_elements:t.short_ended_elements,special:t.special,text_block_elements:t.text_block_elements,text_inline_elements:t.text_inline_elements,valid_children:t.valid_children,valid_classes:t.valid_classes,valid_elements:t.valid_elements,valid_styles:t.valid_styles,verify_html:t.verify_html,whitespace_elements:t.whitespace_elements}))}(e),e),e.selection=qv(e.dom,e.getWin(),e.serializer,e),e.annotator=Lf(e),e.formatter=Ey(e),e.undoManager=_y(e),e._nodeChangeDispatcher=new ik(e),e._selectionOverrides=Sk(e),hx(e),ak(e),Ov(e)||uk(e);var a=function(e){return Ov(e)?cc(null):ok(e)}(e);px(e,a),function(e){zu(e)&&e.on("NodeChange",N(wx,e))}(e),Oy(e);var c=Iv(e);Ik(e),c.fold((function(){Ok(e).then((function(){return Pk(e)}))}),(function(t){e.setProgressState(!0),Ok(e).then((function(){t().then((function(t){e.setProgressState(!1),Pk(e)}),(function(t){e.notificationManager.open({type:"error",text:String(t)}),Pk(e)}))}))}))},Mk=nc.DOM,Lk=function(e){var t=function(e){return e.getParam("doctype","<!DOCTYPE html>")}(e)+"<html><head>";(function(e){return e.getParam("document_base_url","")})(e)!==e.documentBaseUrl&&(t+='<base href="'+e.documentBaseURI.getURI()+'" />'),t+='<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />';var n=function(e){return Hu(e,"body_id","tinymce")}(e),r=function(e){return Hu(e,"body_class","")}(e),o=e.translate(function(e){return e.getParam("iframe_aria_text","Rich Text Area. Press ALT-0 for help.","string")}(e));return Uu(e)&&(t+='<meta http-equiv="Content-Security-Policy" content="'+Uu(e)+'" />'),t+='</head><body id="'+n+'" class="mce-content-body '+r+'" data-id="'+e.id+'" aria-label="'+o+'"><br></body></html>'},Fk=function(e,t){var n,r,o,i,a=e.translate("Rich Text Area"),c=(n=e.id,r=a,t.height,o=function(e){return e.getParam("iframe_attrs",{})}(e),i=wt.fromTag("iframe"),Vn(i,o),Vn(i,{id:n+"_ifr",frameBorder:"0",allowTransparency:"true",title:r}),wc(i,"tox-edit-area__iframe"),i).dom;c.onload=function(){c.onload=null,e.fire("load")};var u=function(e,t){if(document.domain!==window.location.hostname&&mt.browser.isIE()){var n=gy("mce");e[n]=function(){Bk(e)};var r='javascript:(function(){document.open();document.domain="'+document.domain+'";var ed = window.parent.tinymce.get("'+e.id+'");document.write(ed.iframeHTML);document.close();ed.'+n+"(true);})()";return Mk.setAttrib(t,"src",r),!0}return!1}(e,c);return e.contentAreaContainer=t.iframeContainer,e.iframeElement=c,e.iframeHTML=Lk(e),Mk.add(t.iframeContainer,c),u},jk=nc.DOM,Hk=function(e,t,n){var r=ty.get(n),o=ty.urls[n]||e.documentBaseUrl.replace(/\/$/,"");if(n=bt.trim(n),r&&-1===bt.inArray(t,n)){if(bt.each(ty.dependencies(n),(function(n){Hk(e,t,n)})),e.plugins[n])return;try{var i=new r(e,o,e.$);e.plugins[n]=i,i.init&&(i.init(e,o),t.push(n))}catch(t){!function(e,t,n){var r=fc.translate(["Failed to initialize plugin: {0}",t]);Uf(e,"PluginLoadError",{message:r}),ly(r,n),iy(e,r)}(e,n,t)}}},Uk=function(e){return e.replace(/^\-/,"")},zk=function(e){return{editorContainer:e,iframeContainer:e,api:{}}},Wk=function(e){var t=e.getElement();return e.inline?zk(null):function(e){var t=jk.create("div");return jk.insertAfter(t,e),zk(t)}(t)},Vk=function(e){var t=e.getElement();return e.orgDisplay=t.style.display,m(ol(e))?function(e){return e.theme.renderUI()}(e):C(ol(e))?function(e){var t=e.getElement(),n=ol(e)(e,t);return n.editorContainer.nodeType&&(n.editorContainer.id=n.editorContainer.id||e.id+"_parent"),n.iframeContainer&&n.iframeContainer.nodeType&&(n.iframeContainer.id=n.iframeContainer.id||e.id+"_iframecontainer"),n.height=n.iframeHeight?n.iframeHeight:t.offsetHeight,n}(e):Wk(e)},qk=function(e){e.fire("ScriptsLoaded"),function(e){var t=bt.trim($u(e)),n=e.ui.registry.getAll().icons,r=De(De({},qb.get("default").icons),qb.get(t).icons);me(r,(function(t,r){Ce(n,r)||e.ui.registry.addIcon(r,t)}))}(e),function(e){var t=ol(e);if(m(t)){e.settings.theme=Uk(t);var n=ny.get(t);e.theme=new n(e,ny.urls[t]),e.theme.init&&e.theme.init(e,ny.urls[t]||e.documentBaseUrl.replace(/\/$/,""),e.$)}else e.theme={}}(e),function(e){var t=[];bt.each(ul(e).split(/[ ,]/),(function(n){Hk(e,t,Uk(n))}))}(e);var t=Vk(e);!function(e,t){var n={show:F.from(t.show).getOr(S),hide:F.from(t.hide).getOr(S),disable:F.from(t.disable).getOr(S),isDisabled:F.from(t.isDisabled).getOr(I),enable:function(){e.mode.isReadOnly()||F.from(t.enable).map(O)}};e.ui=De(De({},e.ui),n)}(e,F.from(t.api).getOr({}));var n={editorContainer:t.editorContainer,iframeContainer:t.iframeContainer};return e.editorContainer=n.editorContainer?n.editorContainer:null,dy(e),e.inline?Bk(e):function(e,t){var n=Fk(e,t);t.editorContainer&&(Mk.get(t.editorContainer).style.display=e.orgDisplay,e.hidden=Mk.isHidden(t.editorContainer)),e.getElement().style.display="none",Mk.setAttrib(e.id,"aria-hidden","true"),n||Bk(e)}(e,n)},$k=nc.DOM,Kk=function(e){return"-"===e.charAt(0)},Gk=function(e,t){var n=Zu(t),r=function(e){return e.getParam("language_url","","string")}(t);if(!1===fc.hasCode(n)&&"en"!==n){var o=""!==r?r:t.editorManager.baseURL+"/langs/"+n+".js";e.add(o,S,void 0,(function(){!function(e,t,n){ay(e,"LanguageLoadError",cy("language",t,n))}(t,o,n)}))}},Jk=function(e,t,n){return F.from(t).filter((function(e){return e.length>0&&!qb.has(e)})).map((function(t){return{url:e.editorManager.baseURL+"/icons/"+t+"/icons"+n+".js",name:F.some(t)}}))},Xk=function(e,t,n){var r=Jk(t,"default",n),o=function(e){return F.from(function(e){return e.getParam("icons_url","","string")}(e)).filter((function(e){return e.length>0})).map((function(e){return{url:e,name:F.none()}}))}(t).orThunk((function(){return Jk(t,$u(t),"")}));$(function(e){for(var t=[],n=function(e){t.push(e)},r=0;r<e.length;r++)e[r].each(n);return t}([r,o]),(function(n){e.add(n.url,S,void 0,(function(){!function(e,t,n){ay(e,"IconsLoadError",cy("icons",t,n))}(t,n.url,n.name.getOrUndefined())}))}))},Yk=function(e,t){var n=ac.ScriptLoader;!function(e,t,n,r){var o=ol(t);if(m(o)){if(!Kk(o)&&!Ce(ny.urls,o)){var i=function(e){return e.getParam("theme_url")}(t);i?ny.load(o,t.documentBaseURI.toAbsolute(i)):ny.load(o,"themes/"+o+"/theme"+n+".js")}e.loadQueue((function(){ny.waitFor(o,r)}))}else r()}(n,e,t,(function(){Gk(n,e),Xk(n,e,t),function(e,t){bt.each(function(e){return e.getParam("external_plugins")}(e),(function(t,n){ty.load(n,t,S,void 0,(function(){uy(e,t,n)})),e.settings.plugins+=" "+n})),bt.each(ul(e).split(/[ ,]/),(function(n){if((n=bt.trim(n))&&!ty.urls[n])if(Kk(n)){n=n.substr(1,n.length);var r=ty.dependencies(n);bt.each(r,(function(n){var r={prefix:"plugins/",resource:n,suffix:"/plugin"+t+".js"},o=ty.createUrl(r,n);ty.load(o.resource,o,S,void 0,(function(){uy(e,o.prefix+o.resource+o.suffix,o.resource)}))}))}else{var o={prefix:"plugins/",resource:n,suffix:"/plugin"+t+".js"};ty.load(n,o,S,void 0,(function(){uy(e,o.prefix+o.resource+o.suffix,n)}))}}))}(e,t),n.loadQueue((function(){e.removed||qk(e)}),e,(function(){e.removed||qk(e)}))}))},Qk=function(e){var t=e.id;fc.setCode(Zu(e));var n=function(){$k.unbind(window,"ready",n),e.render()};if(_i.Event.domLoaded){if(e.getElement()&&mt.contentEditable){var r=wt.fromDom(e.getElement()),o=function(e){return Y(e.dom.attributes,(function(e,t){return e[t.name]=t.value,e}),{})}(r);e.on("remove",(function(){K(r.dom.attributes,(function(e){return Kn(r,e.name)})),Vn(r,o)})),e.ui.styleSheetLoader=function(e,t){return Xr.forElement(e,{contentCssCors:cl(t),referrerPolicy:Qu(t)})}(r,e),!function(e){return e.getParam("inline")}(e)?(e.orgVisibility=e.getElement().style.visibility,e.getElement().style.visibility="hidden"):e.inline=!0;var i=e.getElement().form||$k.getParent(t,"form");i&&(e.formElement=i,function(e){return e.getParam("hidden_input")}(e)&&!_n(e.getElement())&&($k.insertAfter($k.create("input",{type:"hidden",name:t}),t),e.hasHiddenInput=!0),e.formEventDelegate=function(t){e.fire(t.type,t)},$k.bind(i,"submit reset",e.formEventDelegate),e.on("reset",(function(){e.resetContent()})),!function(e){return e.getParam("submit_patch")}(e)||i.submit.nodeType||i.submit.length||i._mceOldSubmit||(i._mceOldSubmit=i.submit,i.submit=function(){return e.editorManager.triggerSave(),e.setDirty(!1),i._mceOldSubmit(i)})),e.windowManager=ry(e),e.notificationManager=ey(e),function(e){return"xml"===e.getParam("encoding")}(e)&&e.on("GetContent",(function(e){e.save&&(e.content=$k.encode(e.content))})),function(e){return e.getParam("add_form_submit_trigger")}(e)&&e.on("submit",(function(){e.initialized&&e.save()})),function(e){return e.getParam("add_unload_trigger")}(e)&&(e._beforeUnload=function(){!e.initialized||e.destroyed||e.isHidden()||e.save({format:"raw",no_events:!0,set_dirty:!1})},e.editorManager.on("BeforeUnload",e._beforeUnload)),e.editorManager.add(e),Yk(e,e.suffix)}}else $k.bind(window,"ready",n)},Zk=function(e,t){return function(e,t){return Bv(e).editor.addVisual(t)}(e,t)},eT={"font-size":"size","font-family":"face"},tT=function(e,t,n){return Jg(wt.fromDom(n),(function(t){return function(t){return Yn(t,e).orThunk((function(){return"font"===At(t)?we(eT,e).bind((function(e){return $n(t,e)})):F.none()}))}(t)}),(function(e){return kt(wt.fromDom(t),e)}))},nT=function(e){return function(t,n){return F.from(n).map(wt.fromDom).filter(Rt).bind((function(n){return tT(e,t,n.dom).or(function(e,t){return F.from(nc.DOM.getStyle(t,e,!0))}(e,n.dom))})).getOr("")}},rT=nT("font-size"),oT=k((function(e){return e.replace(/[\'\"\\]/g,"").replace(/,\s+/g,",")}),nT("font-family")),iT=function(e){return Cs(e.getBody()).map((function(e){var t=e.container();return Nn(t)?t.parentNode:t}))},aT=function(e,t){return function(e){return F.from(e.selection.getRng()).bind((function(t){var n=e.getBody();return t.startContainer===n&&0===t.startOffset?F.none():F.from(e.selection.getStart(!0))}))}(e).orThunk(N(iT,e)).map(wt.fromDom).filter(Rt).bind(t)},cT=function(e,t){return aT(e,T(F.some,t))},uT=function(e,t){if(/^[0-9.]+$/.test(t)){var n=parseInt(t,10);if(n>=1&&n<=7){var r=function(e){return bt.explode(e.getParam("font_size_style_values","xx-small,x-small,small,medium,large,x-large,xx-large"))}(e),o=function(e){return bt.explode(e.getParam("font_size_classes",""))}(e);return o?o[n-1]||t:r[n-1]||t}return t}return t},lT=function(e){var t=e.split(/\s*,\s*/);return q(t,(function(e){return-1===e.indexOf(" ")||je(e,'"')||je(e,"'")?e:"'"+e+"'"})).join(",")},sT=function(e,t){var n=function(e){if("string"!=typeof e){var t=bt.extend({paste:e.paste,data:{paste:e.paste}},e);return{content:e.content,details:t}}return{content:e,details:{}}}(t);!function(e,t,n){Pv(e).editor.insertContent(t,n)}(e,n.content,n.details)},fT=bt.each,dT=bt.map,mT=bt.inArray,pT=function(){function e(e){this.commands={state:{},exec:{},value:{}},this.editor=e,this.setupCommands(e)}return e.prototype.execCommand=function(e,t,n,r){var o,i=!1,a=this;if(!a.editor.removed){var c;if("mcefocus"!==e.toLowerCase()&&(/^(mceAddUndoLevel|mceEndUndoLevel|mceBeginUndoLevel|mceRepaint)$/.test(e)||r&&r.skip_focus?(c=a.editor,Kd(c).each((function(e){return c.selection.setRng(e)}))):a.editor.focus()),(r=a.editor.fire("BeforeExecCommand",{command:e,ui:t,value:n})).isDefaultPrevented())return!1;var u=e.toLowerCase();if(o=a.commands.exec[u])return o(u,t,n),a.editor.fire("ExecCommand",{command:e,ui:t,value:n}),!0;if(fT(this.editor.plugins,(function(r){if(r.execCommand&&r.execCommand(e,t,n))return a.editor.fire("ExecCommand",{command:e,ui:t,value:n}),i=!0,!1})),i)return i;if(a.editor.theme&&a.editor.theme.execCommand&&a.editor.theme.execCommand(e,t,n))return a.editor.fire("ExecCommand",{command:e,ui:t,value:n}),!0;try{i=a.editor.getDoc().execCommand(e,t,n)}catch(e){}return!!i&&(a.editor.fire("ExecCommand",{command:e,ui:t,value:n}),!0)}},e.prototype.queryCommandState=function(e){var t;if(!this.editor.quirks.isHidden()&&!this.editor.removed){if(e=e.toLowerCase(),t=this.commands.state[e])return t(e);try{return this.editor.getDoc().queryCommandState(e)}catch(e){}return!1}},e.prototype.queryCommandValue=function(e){var t;if(!this.editor.quirks.isHidden()&&!this.editor.removed){if(e=e.toLowerCase(),t=this.commands.value[e])return t(e);try{return this.editor.getDoc().queryCommandValue(e)}catch(e){}}},e.prototype.addCommands=function(e,t){void 0===t&&(t="exec");var n=this;fT(e,(function(e,r){fT(r.toLowerCase().split(","),(function(r){n.commands[t][r]=e}))}))},e.prototype.addCommand=function(e,t,n){var r=this;e=e.toLowerCase(),this.commands.exec[e]=function(e,o,i,a){return t.call(n||r.editor,o,i,a)}},e.prototype.queryCommandSupported=function(e){if(e=e.toLowerCase(),this.commands.exec[e])return!0;try{return this.editor.getDoc().queryCommandSupported(e)}catch(e){}return!1},e.prototype.addQueryStateHandler=function(e,t,n){var r=this;e=e.toLowerCase(),this.commands.state[e]=function(){return t.call(n||r.editor)}},e.prototype.addQueryValueHandler=function(e,t,n){var r=this;e=e.toLowerCase(),this.commands.value[e]=function(){return t.call(n||r.editor)}},e.prototype.hasCustomCommand=function(e){return e=e.toLowerCase(),!!this.commands.exec[e]},e.prototype.execNativeCommand=function(e,t,n){return void 0===t&&(t=!1),void 0===n&&(n=null),this.editor.getDoc().execCommand(e,t,n)},e.prototype.isFormatMatch=function(e){return this.editor.formatter.match(e)},e.prototype.toggleFormat=function(e,t){this.editor.formatter.toggle(e,t),this.editor.nodeChanged()},e.prototype.storeSelection=function(e){this.selectionBookmark=this.editor.selection.getBookmark(e)},e.prototype.restoreSelection=function(){this.editor.selection.moveToBookmark(this.selectionBookmark)},e.prototype.setupCommands=function(e){var t=this;this.addCommands({"mceResetDesignMode,mceBeginUndoLevel":S,"mceEndUndoLevel,mceAddUndoLevel":function(){e.undoManager.add()},mceFocus:function(t,n,r){um(e,r)},"Cut,Copy,Paste":function(n){var r,o=e.getDoc();try{t.execNativeCommand(n)}catch(e){r=!0}if("paste"!==n||o.queryCommandEnabled(n)||(r=!0),r||!o.queryCommandSupported(n)){var i=e.translate("Your browser doesn't support direct access to the clipboard. Please use the Ctrl+X/C/V keyboard shortcuts instead.");mt.mac&&(i=i.replace(/Ctrl\+/g,"+")),e.notificationManager.open({text:i,type:"error"})}},unlink:function(){if(e.selection.isCollapsed()){var t=e.dom.getParent(e.selection.getStart(),"a");t&&e.dom.remove(t,!0)}else e.formatter.remove("link")},"JustifyLeft,JustifyCenter,JustifyRight,JustifyFull,JustifyNone":function(n){var r=n.substring(7);"full"===r&&(r="justify"),fT("left,center,right,justify".split(","),(function(t){r!==t&&e.formatter.remove("align"+t)})),"none"!==r&&t.toggleFormat("align"+r)},"InsertUnorderedList,InsertOrderedList":function(n){var r;t.execNativeCommand(n);var o=e.dom.getParent(e.selection.getNode(),"ol,ul");o&&(r=o.parentNode,/^(H[1-6]|P|ADDRESS|PRE)$/.test(r.nodeName)&&(t.storeSelection(),e.dom.split(r,o),t.restoreSelection()))},"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":function(e){t.toggleFormat(e)},"ForeColor,HiliteColor":function(e,n,r){t.toggleFormat(e,{value:r})},FontName:function(t,n,r){!function(e,t){var n=uT(e,t);e.formatter.toggle("fontname",{value:lT(n)}),e.nodeChanged()}(e,r)},FontSize:function(t,n,r){!function(e,t){e.formatter.toggle("fontsize",{value:uT(e,t)}),e.nodeChanged()}(e,r)},LineHeight:function(t,n,r){!function(e,t){e.formatter.toggle("lineheight",{value:String(t)}),e.nodeChanged()}(e,r)},Lang:function(e,n,r){t.toggleFormat(e,{value:r.code,customValue:r.customCode})},RemoveFormat:function(t){e.formatter.remove(t)},mceBlockQuote:function(){t.toggleFormat("blockquote")},FormatBlock:function(e,n,r){return t.toggleFormat(r||"p")},mceCleanup:function(){var t=e.selection.getBookmark();e.setContent(e.getContent()),e.selection.moveToBookmark(t)},mceRemoveNode:function(n,r,o){var i=o||e.selection.getNode();i!==e.getBody()&&(t.storeSelection(),e.dom.remove(i,!0),t.restoreSelection())},mceSelectNodeDepth:function(t,n,r){var o=0;e.dom.getParent(e.selection.getNode(),(function(t){if(1===t.nodeType&&o++===r)return e.selection.select(t),!1}),e.getBody())},mceSelectNode:function(t,n,r){e.selection.select(r)},mceInsertContent:function(t,n,r){sT(e,r)},mceInsertRawHTML:function(t,n,r){e.selection.setContent("tiny_mce_marker");var o=e.getContent();e.setContent(o.replace(/tiny_mce_marker/g,(function(){return r})))},mceInsertNewLine:function(t,n,r){zS(e,r)},mceToggleFormat:function(e,n,r){t.toggleFormat(r)},mceSetContent:function(t,n,r){e.setContent(r)},"Indent,Outdent":function(t){fx(e,t)},mceRepaint:S,InsertHorizontalRule:function(){e.execCommand("mceInsertContent",!1,"<hr />")},mceToggleVisualAid:function(){e.hasVisual=!e.hasVisual,e.addVisual()},mceReplaceContent:function(t,n,r){e.execCommand("mceInsertContent",!1,r.replace(/\{\$selection\}/g,e.selection.getContent({format:"text"})))},mceInsertLink:function(t,n,r){"string"==typeof r&&(r={href:r});var o=e.dom.getParent(e.selection.getNode(),"a");r.href=r.href.replace(/ /g,"%20"),o&&r.href||e.formatter.remove("link"),r.href&&e.formatter.apply("link",r,o)},selectAll:function(){var t=e.dom.getParent(e.selection.getStart(),Bn);if(t){var n=e.dom.createRng();n.selectNodeContents(t),e.selection.setRng(n)}},mceNewDocument:function(){e.setContent("")},InsertLineBreak:function(t,n,r){return NS(e,r),!0}});var n=function(t){return function(){var n=e.selection,r=n.isCollapsed()?[e.dom.getParent(n.getNode(),e.dom.isBlock)]:n.getSelectedBlocks(),o=dT(r,(function(n){return!!e.formatter.matchNode(n,t)}));return-1!==mT(o,!0)}};t.addCommands({JustifyLeft:n("alignleft"),JustifyCenter:n("aligncenter"),JustifyRight:n("alignright"),JustifyFull:n("alignjustify"),"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":function(e){return t.isFormatMatch(e)},mceBlockQuote:function(){return t.isFormatMatch("blockquote")},Outdent:function(){return ux(e)},"InsertUnorderedList,InsertOrderedList":function(t){var n=e.dom.getParent(e.selection.getNode(),"ul,ol");return n&&("insertunorderedlist"===t&&"UL"===n.tagName||"insertorderedlist"===t&&"OL"===n.tagName)}},"state"),t.addCommands({Undo:function(){e.undoManager.undo()},Redo:function(){e.undoManager.redo()}}),t.addQueryValueHandler("FontName",(function(){return function(e){return cT(e,(function(t){return oT(e.getBody(),t.dom)})).getOr("")}(e)}),this),t.addQueryValueHandler("FontSize",(function(){return function(e){return cT(e,(function(t){return rT(e.getBody(),t.dom)})).getOr("")}(e)}),this),t.addQueryValueHandler("LineHeight",(function(){return function(e){return cT(e,(function(t){var n=wt.fromDom(e.getBody());return Jg(t,(function(e){return Yn(e,"line-height")}),N(kt,n)).getOrThunk((function(){var e=parseFloat(Jn(t,"line-height")),n=parseFloat(Jn(t,"font-size"));return String(e/n)}))})).getOr("")}(e)}),this)},e}(),gT=function(e,t,n){xc(e,t)&&!1===n?function(e,t){vc(e)?e.dom.classList.remove(t):yc(e,t);Cc(e)}(e,t):n&&wc(e,t)},hT=function(e,t,n){try{e.getDoc().execCommand(t,!1,String(n))}catch(e){}},vT=function(e,t){e.dom.contentEditable=t?"true":"false"},bT=function(e,t){var n=wt.fromDom(e.getBody());gT(n,"mce-content-readonly",t),t?(e.selection.controlSelection.hideResizeRect(),e._selectionOverrides.hideFakeCaret(),function(e){F.from(e.selection.getNode()).each((function(e){e.removeAttribute("data-mce-selected")}))}(e),e.readonly=!0,vT(n,!1),$(kc(n,'*[contenteditable="true"]'),(function(e){Wn(e,"data-mce-contenteditable","true"),vT(e,!1)}))):(e.readonly=!1,vT(n,!0),function(e){$(kc(e,'*[data-mce-contenteditable="true"]'),(function(e){Kn(e,"data-mce-contenteditable"),vT(e,!0)}))}(n),hT(e,"StyleWithCSS",!1),hT(e,"enableInlineTableEditing",!1),hT(e,"enableObjectResizing",!1),am(e)&&e.focus(),function(e){e.selection.setRng(e.selection.getRng())}(e),e.nodeChanged())},yT=function(e){return e.readonly},wT=function(e){e.parser.addAttributeFilter("contenteditable",(function(t){yT(e)&&$(t,(function(e){e.attr("data-mce-contenteditable",e.attr("contenteditable")),e.attr("contenteditable","false")}))})),e.serializer.addAttributeFilter("data-mce-contenteditable",(function(t){yT(e)&&$(t,(function(e){e.attr("contenteditable",e.attr("data-mce-contenteditable"))}))})),e.serializer.addTempAttr("data-mce-contenteditable")},CT=function(e,t){if(function(e){return"click"===e.type}(t)&&!Vf.metaKeyPressed(t)){var n=wt.fromDom(t.target);(function(e,t){return Wr(t,"a",(function(t){return kt(t,wt.fromDom(e.getBody()))})).bind((function(e){return $n(e,"href")}))})(e,n).each((function(n){if(t.preventDefault(),/^#/.test(n)){var r=e.dom.select(n+',[name="'+((je(o=n,i="#")?function(e,t){return e.substring(t)}(o,i.length):o)+'"]'));r.length&&e.selection.scrollIntoView(r[0],!0)}else window.open(n,"_blank","rel=noopener noreferrer,menubar=yes,toolbar=yes,location=yes,status=yes,resizable=yes,scrollbars=yes");var o,i}))}},xT=bt.makeMap("focus blur focusin focusout click dblclick mousedown mouseup mousemove mouseover beforepaste paste cut copy selectionchange mouseout mouseenter mouseleave wheel keydown keypress keyup input beforeinput contextmenu dragstart dragend dragover draggesture dragdrop drop drag submit compositionstart compositionend compositionupdate touchstart touchmove touchend touchcancel"," "),ST=function(){function e(e){this.bindings={},this.settings=e||{},this.scope=this.settings.scope||this,this.toggleEvent=this.settings.toggleEvent||I}return e.isNative=function(e){return!!xT[e.toLowerCase()]},e.prototype.fire=function(e,t){var n=e.toLowerCase(),r=xi(n,t||{},this.scope);this.settings.beforeFire&&this.settings.beforeFire(r);var o=this.bindings[n];if(o)for(var i=0,a=o.length;i<a;i++){var c=o[i];if(!c.removed){if(c.once&&this.off(n,c.func),r.isImmediatePropagationStopped())return r;if(!1===c.func.call(this.scope,r))return r.preventDefault(),r}}return r},e.prototype.on=function(e,t,n,r){if(!1===t&&(t=I),t){var o={func:t,removed:!1};r&&bt.extend(o,r);for(var i=e.toLowerCase().split(" "),a=i.length;a--;){var c=i[a],u=this.bindings[c];u||(u=[],this.toggleEvent(c,!0)),u=n?Oe([o],u,!0):Oe(Oe([],u,!0),[o],!1),this.bindings[c]=u}}return this},e.prototype.off=function(e,t){var n=this;if(e)for(var r=e.toLowerCase().split(" "),o=r.length;o--;){var i=r[o],a=this.bindings[i];if(!i)return me(this.bindings,(function(e,t){n.toggleEvent(t,!1),delete n.bindings[t]})),this;if(a){if(t){var c=G(a,(function(e){return e.func===t}));a=c.fail,this.bindings[i]=a,$(c.pass,(function(e){e.removed=!0}))}else a.length=0;a.length||(this.toggleEvent(e,!1),delete this.bindings[i])}}else me(this.bindings,(function(e,t){n.toggleEvent(t,!1)})),this.bindings={};return this},e.prototype.once=function(e,t,n){return this.on(e,t,n,{once:!0})},e.prototype.has=function(e){return e=e.toLowerCase(),!(!this.bindings[e]||0===this.bindings[e].length)},e}(),kT=function(e){return e._eventDispatcher||(e._eventDispatcher=new ST({scope:e,toggleEvent:function(t,n){ST.isNative(t)&&e.toggleNativeEvent&&e.toggleNativeEvent(t,n)}})),e._eventDispatcher},TT={fire:function(e,t,n){if(this.removed&&"remove"!==e&&"detach"!==e)return t;var r=kT(this).fire(e,t);if(!1!==n&&this.parent)for(var o=this.parent();o&&!r.isPropagationStopped();)o.fire(e,r,!1),o=o.parent();return r},on:function(e,t,n){return kT(this).on(e,t,n)},off:function(e,t){return kT(this).off(e,t)},once:function(e,t){return kT(this).once(e,t)},hasEventListeners:function(e){return kT(this).has(e)}},ET=nc.DOM,AT=function(e,t){if("selectionchange"===t)return e.getDoc();if(!e.inline&&/^mouse|touch|click|contextmenu|drop|dragover|dragend/.test(t))return e.getDoc().documentElement;var n=rl(e);return n?(e.eventRoot||(e.eventRoot=ET.select(n)[0]),e.eventRoot):e.getBody()},_T=function(e,t,n){!function(e){return!e.hidden&&!yT(e)}(e)?yT(e)&&CT(e,n):e.fire(t,n)},NT=function(e,t){var n;if(e.delegates||(e.delegates={}),!e.delegates[t]&&!e.removed){var r=AT(e,t);if(rl(e)){if(bC||(bC={},e.editorManager.on("removeEditor",(function(){e.editorManager.activeEditor||bC&&(me(bC,(function(t,n){e.dom.unbind(AT(e,n))})),bC=null)}))),bC[t])return;n=function(n){for(var r=n.target,o=e.editorManager.get(),i=o.length;i--;){var a=o[i].getBody();(a===r||ET.isChildOf(r,a))&&_T(o[i],t,n)}},bC[t]=n,ET.bind(r,t,n)}else n=function(n){_T(e,t,n)},ET.bind(r,t,n),e.delegates[t]=n}},RT=De(De({},TT),{bindPendingEventDelegates:function(){var e=this;bt.each(e._pendingNativeEvents,(function(t){NT(e,t)}))},toggleNativeEvent:function(e,t){"focus"!==e&&"blur"!==e&&(this.removed||(t?this.initialized?NT(this,e):this._pendingNativeEvents?this._pendingNativeEvents.push(e):this._pendingNativeEvents=[e]:this.initialized&&(this.dom.unbind(AT(this,e),e,this.delegates[e]),delete this.delegates[e])))},unbindAllNativeEvents:function(){var e=this,t=e.getBody(),n=e.dom;e.delegates&&(me(e.delegates,(function(t,n){e.dom.unbind(AT(e,n),n,t)})),delete e.delegates),!e.inline&&t&&n&&(t.onload=null,n.unbind(e.getWin()),n.unbind(e.getDoc())),n&&(n.unbind(t),n.unbind(e.getContainer()))}}),DT=["design","readonly"],OT=function(e,t,n,r){var o=n[t.get()],i=n[r];try{i.activate()}catch(e){return void console.error("problem while activating editor mode "+r+":",e)}o.deactivate(),o.editorReadOnly!==i.editorReadOnly&&bT(e,i.editorReadOnly),t.set(r),function(e,t){e.fire("SwitchMode",{mode:t})}(e,r)},IT=function(e){var t=cc("design"),n=cc({design:{activate:S,deactivate:S,editorReadOnly:!1},readonly:{activate:S,deactivate:S,editorReadOnly:!0}});return function(e){e.serializer?wT(e):e.on("PreInit",(function(){wT(e)}))}(e),function(e){e.on("ShowCaret",(function(t){yT(e)&&t.preventDefault()})),e.on("ObjectSelected",(function(t){yT(e)&&t.preventDefault()}))}(e),{isReadOnly:function(){return yT(e)},set:function(r){return function(e,t,n,r){if(r!==n.get()){if(!Ce(t,r))throw new Error("Editor mode '"+r+"' is invalid");e.initialized?OT(e,n,t,r):e.on("init",(function(){return OT(e,n,t,r)}))}}(e,n.get(),t,r)},get:function(){return t.get()},register:function(e,t){n.set(function(e,t,n){var r;if(W(DT,t))throw new Error("Cannot override default mode "+t);return De(De({},e),((r={})[t]=De(De({},n),{deactivate:function(){try{n.deactivate()}catch(e){console.error("problem while deactivating editor mode "+t+":",e)}}}),r))}(n.get(),e,t))}}},PT=bt.each,BT=bt.explode,MT={f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123},LT=bt.makeMap("alt,ctrl,shift,meta,access"),FT=function(e){var t,n={};PT(BT(e.toLowerCase(),"+"),(function(e){e in LT?n[e]=!0:/^[0-9]{2,}$/.test(e)?n.keyCode=parseInt(e,10):(n.charCode=e.charCodeAt(0),n.keyCode=MT[e]||e.toUpperCase().charCodeAt(0))}));var r=[n.keyCode];for(t in LT)n[t]?r.push(t):n[t]=!1;return n.id=r.join(","),n.access&&(n.alt=!0,mt.mac?n.ctrl=!0:n.shift=!0),n.meta&&(mt.mac?n.meta=!0:(n.ctrl=!0,n.meta=!1)),n},jT=function(){function e(e){this.shortcuts={},this.pendingPatterns=[],this.editor=e;var t=this;e.on("keyup keypress keydown",(function(e){!t.hasModifier(e)&&!t.isFunctionKey(e)||e.isDefaultPrevented()||(PT(t.shortcuts,(function(n){if(t.matchShortcut(e,n))return t.pendingPatterns=n.subpatterns.slice(0),"keydown"===e.type&&t.executeShortcutAction(n),!0})),t.matchShortcut(e,t.pendingPatterns[0])&&(1===t.pendingPatterns.length&&"keydown"===e.type&&t.executeShortcutAction(t.pendingPatterns[0]),t.pendingPatterns.shift()))}))}return e.prototype.add=function(e,t,n,r){var o=this,i=o.normalizeCommandFunc(n);return PT(BT(bt.trim(e)),(function(e){var n=o.createShortcut(e,t,i,r);o.shortcuts[n.id]=n})),!0},e.prototype.remove=function(e){var t=this.createShortcut(e);return!!this.shortcuts[t.id]&&(delete this.shortcuts[t.id],!0)},e.prototype.normalizeCommandFunc=function(e){var t=this,n=e;return"string"==typeof n?function(){t.editor.execCommand(n,!1,null)}:bt.isArray(n)?function(){t.editor.execCommand(n[0],n[1],n[2])}:n},e.prototype.createShortcut=function(e,t,n,r){var o=bt.map(BT(e,">"),FT);return o[o.length-1]=bt.extend(o[o.length-1],{func:n,scope:r||this.editor}),bt.extend(o[0],{desc:this.editor.translate(t),subpatterns:o.slice(1)})},e.prototype.hasModifier=function(e){return e.altKey||e.ctrlKey||e.metaKey},e.prototype.isFunctionKey=function(e){return"keydown"===e.type&&e.keyCode>=112&&e.keyCode<=123},e.prototype.matchShortcut=function(e,t){return!!t&&(t.ctrl===e.ctrlKey&&t.meta===e.metaKey&&(t.alt===e.altKey&&t.shift===e.shiftKey&&(!!(e.keyCode===t.keyCode||e.charCode&&e.charCode===t.charCode)&&(e.preventDefault(),!0))))},e.prototype.executeShortcutAction=function(e){return e.func?e.func.call(e.scope):null},e}(),HT=function(){var e=function(){var e={},t={},n={},r={},o={},i={},a={},c=function(e,t){return function(n,r){return e[n.toLowerCase()]=De(De({},r),{type:t})}};return{addButton:c(e,"button"),addGroupToolbarButton:c(e,"grouptoolbarbutton"),addToggleButton:c(e,"togglebutton"),addMenuButton:c(e,"menubutton"),addSplitButton:c(e,"splitbutton"),addMenuItem:c(t,"menuitem"),addNestedMenuItem:c(t,"nestedmenuitem"),addToggleMenuItem:c(t,"togglemenuitem"),addAutocompleter:c(n,"autocompleter"),addContextMenu:c(o,"contextmenu"),addContextToolbar:c(i,"contexttoolbar"),addContextForm:c(i,"contextform"),addSidebar:c(a,"sidebar"),addIcon:function(e,t){return r[e.toLowerCase()]=t},getAll:function(){return{buttons:e,menuItems:t,icons:r,popups:n,contextMenus:o,contextToolbars:i,sidebars:a}}}}();return{addAutocompleter:e.addAutocompleter,addButton:e.addButton,addContextForm:e.addContextForm,addContextMenu:e.addContextMenu,addContextToolbar:e.addContextToolbar,addIcon:e.addIcon,addMenuButton:e.addMenuButton,addMenuItem:e.addMenuItem,addNestedMenuItem:e.addNestedMenuItem,addSidebar:e.addSidebar,addSplitButton:e.addSplitButton,addToggleButton:e.addToggleButton,addGroupToolbarButton:e.addGroupToolbarButton,addToggleMenuItem:e.addToggleMenuItem,getAll:e.getAll}},UT=nc.DOM,zT=bt.extend,WT=bt.each,VT=bt.resolve,qT=mt.ie,$T=function(){function e(e,t,n){var r=this;this.plugins={},this.contentCSS=[],this.contentStyles=[],this.loadedCSS={},this.isNotDirty=!1,this.editorManager=n,this.documentBaseUrl=n.documentBaseURL,zT(this,RT),this.settings=zb(this,e,this.documentBaseUrl,n.defaultSettings,t),this.settings.suffix&&(n.suffix=this.settings.suffix),this.suffix=n.suffix,this.settings.base_url&&n._setBaseUrl(this.settings.base_url),this.baseUri=n.baseURI,this.settings.referrer_policy&&(ac.ScriptLoader._setReferrerPolicy(this.settings.referrer_policy),nc.DOM.styleSheetLoader._setReferrerPolicy(this.settings.referrer_policy)),dc.languageLoad=this.settings.language_load,dc.baseURL=n.baseURL,this.id=e,this.setDirty(!1),this.documentBaseURI=new Em(this.settings.document_base_url,{base_uri:this.baseUri}),this.baseURI=this.baseUri,this.inline=!!this.settings.inline,this.shortcuts=new jT(this),this.editorCommands=new pT(this),this.settings.cache_suffix&&(mt.cacheSuffix=this.settings.cache_suffix.replace(/^[\?\&]+/,"")),this.ui={registry:HT(),styleSheetLoader:void 0,show:S,hide:S,enable:S,disable:S,isDisabled:I};var o=IT(this);this.mode=o,this.setMode=o.set,n.fire("SetupEditor",{editor:this}),this.execCallback("setup",this),this.$=Ja.overrideDefaults((function(){return{context:r.inline?r.getBody():r.getDoc(),element:r.getBody()}}))}return e.prototype.render=function(){Qk(this)},e.prototype.focus=function(e){this.execCommand("mceFocus",!1,e)},e.prototype.hasFocus=function(){return im(this)},e.prototype.execCallback=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r,o=this,i=o.settings[e];if(i)return o.callbackLookup&&(r=o.callbackLookup[e])&&(i=r.func,r=r.scope),"string"==typeof i&&(r=(r=i.replace(/\.\w+$/,""))?VT(r):0,i=VT(i),o.callbackLookup=o.callbackLookup||{},o.callbackLookup[e]={func:i,scope:r}),i.apply(r||o,t)},e.prototype.translate=function(e){return fc.translate(e)},e.prototype.getParam=function(e,t,n){return Vb(this,e,t,n)},e.prototype.hasPlugin=function(e,t){return!!W(ul(this).split(/[ ,]/),e)&&(!t||void 0!==ty.get(e))},e.prototype.nodeChanged=function(e){this._nodeChangeDispatcher.nodeChanged(e)},e.prototype.addCommand=function(e,t,n){this.editorCommands.addCommand(e,t,n)},e.prototype.addQueryStateHandler=function(e,t,n){this.editorCommands.addQueryStateHandler(e,t,n)},e.prototype.addQueryValueHandler=function(e,t,n){this.editorCommands.addQueryValueHandler(e,t,n)},e.prototype.addShortcut=function(e,t,n,r){this.shortcuts.add(e,t,n,r)},e.prototype.execCommand=function(e,t,n,r){return this.editorCommands.execCommand(e,t,n,r)},e.prototype.queryCommandState=function(e){return this.editorCommands.queryCommandState(e)},e.prototype.queryCommandValue=function(e){return this.editorCommands.queryCommandValue(e)},e.prototype.queryCommandSupported=function(e){return this.editorCommands.queryCommandSupported(e)},e.prototype.show=function(){this.hidden&&(this.hidden=!1,this.inline?this.getBody().contentEditable="true":(UT.show(this.getContainer()),UT.hide(this.id)),this.load(),this.fire("show"))},e.prototype.hide=function(){var e=this.getDoc();this.hidden||(qT&&e&&!this.inline&&e.execCommand("SelectAll"),this.save(),this.inline?(this.getBody().contentEditable="false",this===this.editorManager.focusedEditor&&(this.editorManager.focusedEditor=null)):(UT.hide(this.getContainer()),UT.setStyle(this.id,"display",this.orgDisplay)),this.hidden=!0,this.fire("hide"))},e.prototype.isHidden=function(){return!!this.hidden},e.prototype.setProgressState=function(e,t){this.fire("ProgressState",{state:e,time:t})},e.prototype.load=function(e){var t,n=this.getElement();if(this.removed)return"";if(n){(e=e||{}).load=!0;var r=_n(n)?n.value:n.innerHTML;return t=this.setContent(r,e),e.element=n,e.no_events||this.fire("LoadContent",e),e.element=n=null,t}},e.prototype.save=function(e){var t,n,r=this,o=r.getElement();if(o&&r.initialized&&!r.removed)return(e=e||{}).save=!0,e.element=o,e.content=r.getContent(e),e.no_events||r.fire("SaveContent",e),"raw"===e.format&&r.fire("RawSaveContent",e),t=e.content,_n(o)?o.value=t:(!e.is_removing&&r.inline||(o.innerHTML=t),(n=UT.getParent(r.id,"form"))&&WT(n.elements,(function(e){if(e.name===r.id)return e.value=t,!1}))),e.element=o=null,!1!==e.set_dirty&&r.setDirty(!1),t},e.prototype.setContent=function(e,t){return hb(this,e,t)},e.prototype.getContent=function(e){return gb(this,e)},e.prototype.insertContent=function(e,t){t&&(e=zT({content:e},t)),this.execCommand("mceInsertContent",!1,e)},e.prototype.resetContent=function(e){void 0===e?hb(this,this.startContent,{format:"raw"}):hb(this,e),this.undoManager.reset(),this.setDirty(!1),this.nodeChanged()},e.prototype.isDirty=function(){return!this.isNotDirty},e.prototype.setDirty=function(e){var t=!this.isNotDirty;this.isNotDirty=!e,e&&e!==t&&this.fire("dirty")},e.prototype.getContainer=function(){return this.container||(this.container=UT.get(this.editorContainer||this.id+"_parent")),this.container},e.prototype.getContentAreaContainer=function(){return this.contentAreaContainer},e.prototype.getElement=function(){return this.targetElm||(this.targetElm=UT.get(this.id)),this.targetElm},e.prototype.getWin=function(){var e;return this.contentWindow||(e=this.iframeElement)&&(this.contentWindow=e.contentWindow),this.contentWindow},e.prototype.getDoc=function(){var e;return this.contentDocument||(e=this.getWin())&&(this.contentDocument=e.document),this.contentDocument},e.prototype.getBody=function(){var e=this.getDoc();return this.bodyElement||(e?e.body:null)},e.prototype.convertURL=function(e,t,n){var r=this.settings;return r.urlconverter_callback?this.execCallback("urlconverter_callback",e,n,!0,t):!r.convert_urls||n&&"LINK"===n.nodeName||0===e.indexOf("file:")||0===e.length?e:r.relative_urls?this.documentBaseURI.toRelative(e):e=this.documentBaseURI.toAbsolute(e,r.remove_script_host)},e.prototype.addVisual=function(e){Zk(this,e)},e.prototype.remove=function(){yb(this)},e.prototype.destroy=function(e){wb(this,e)},e.prototype.uploadImages=function(e){return this.editorUpload.uploadImages(e)},e.prototype._scanForImages=function(){return this.editorUpload.scanForImages()},e.prototype.addButton=function(){throw new Error("editor.addButton has been removed in tinymce 5x, use editor.ui.registry.addButton or editor.ui.registry.addToggleButton or editor.ui.registry.addSplitButton instead")},e.prototype.addSidebar=function(){throw new Error("editor.addSidebar has been removed in tinymce 5x, use editor.ui.registry.addSidebar instead")},e.prototype.addMenuItem=function(){throw new Error("editor.addMenuItem has been removed in tinymce 5x, use editor.ui.registry.addMenuItem instead")},e.prototype.addContextToolbar=function(){throw new Error("editor.addContextToolbar has been removed in tinymce 5x, use editor.ui.registry.addContextToolbar instead")},e}(),KT=nc.DOM,GT=bt.explode,JT=bt.each,XT=bt.extend,YT=0,QT=!1,ZT=[],eE=[],tE=function(e){var t=e.type;JT(iE.get(),(function(n){switch(t){case"scroll":n.fire("ScrollWindow",e);break;case"resize":n.fire("ResizeWindow",e)}}))},nE=function(e){e!==QT&&(e?Ja(window).on("resize scroll",tE):Ja(window).off("resize scroll",tE),QT=e)},rE=function(e){var t=eE;delete ZT[e.id];for(var n=0;n<ZT.length;n++)if(ZT[n]===e){ZT.splice(n,1);break}return eE=J(eE,(function(t){return e!==t})),iE.activeEditor===e&&(iE.activeEditor=eE.length>0?eE[0]:null),iE.focusedEditor===e&&(iE.focusedEditor=null),t.length!==eE.length},oE="CSS1Compat"!==document.compatMode,iE=De(De({},TT),{baseURI:null,baseURL:null,defaultSettings:{},documentBaseURL:null,suffix:null,$:Ja,majorVersion:"5",minorVersion:"10.3",releaseDate:"2022-02-09",editors:ZT,i18n:fc,activeEditor:null,focusedEditor:null,settings:{},setup:function(){var e,t,n="";t=Em.getDocumentBaseUrl(document.location),/^[^:]+:\/\/\/?[^\/]+\//.test(t)&&(t=t.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,""),/[\/\\]$/.test(t)||(t+="/"));var r,o=window.tinymce||window.tinyMCEPreInit;if(o)e=o.base||o.baseURL,n=o.suffix;else{for(var i=document.getElementsByTagName("script"),a=0;a<i.length;a++){var c;if(""!==(c=i[a].src||"")){var u=c.substring(c.lastIndexOf("/"));if(/tinymce(\.full|\.jquery|)(\.min|\.dev|)\.js/.test(c)){-1!==u.indexOf(".min")&&(n=".min"),e=c.substring(0,c.lastIndexOf("/"));break}}}if(!e&&document.currentScript)-1!==(c=document.currentScript.src).indexOf(".min")&&(n=".min"),e=c.substring(0,c.lastIndexOf("/"))}this.baseURL=new Em(t).toAbsolute(e),this.documentBaseURL=t,this.baseURI=new Em(this.baseURL),this.suffix=n,(r=this).on("AddEditor",N(Zd,r)),r.on("RemoveEditor",N(em,r))},overrideDefaults:function(e){var t=e.base_url;t&&this._setBaseUrl(t);var n=e.suffix;e.suffix&&(this.suffix=n),this.defaultSettings=e;var r=e.plugin_base_urls;void 0!==r&&me(r,(function(e,t){dc.PluginManager.urls[t]=e}))},init:function(e){var t,n=this,r=bt.makeMap("area base basefont br col frame hr img input isindex link meta param embed source wbr track colgroup option table tbody tfoot thead tr th td script noscript style textarea video audio iframe object menu"," "),o=function(e){var t=e.id;return t||(t=we(e,"name").filter((function(e){return!KT.get(e)})).getOrThunk(KT.uniqueId),e.setAttribute("id",t)),t},i=function(e,t){return t.constructor===RegExp?t.test(e.className):KT.hasClass(e,t)},a=function(e){t=e},c=function(){var t,u=0,l=[],s=function(e,r,o){var i=new $T(e,r,n);l.push(i),i.on("init",(function(){++u===t.length&&a(l)})),i.targetElm=i.targetElm||o,i.render()};KT.unbind(window,"ready",c),function(t){var r=e[t];if(r)r.apply(n,[])}("onpageload"),t=Ja.unique(function(e){var t=[];if(mt.browser.isIE()&&mt.browser.version.major<11)return ly("TinyMCE does not support the browser you are using. For a list of supported browsers please see: https://www.tinymce.com/docs/get-started/system-requirements/"),[];if(oE)return ly("Failed to initialize the editor as the document is not in standards mode. TinyMCE requires standards mode."),[];if(e.types)return JT(e.types,(function(e){t=t.concat(KT.select(e.selector))})),t;if(e.selector)return KT.select(e.selector);if(e.target)return[e.target];switch(e.mode){case"exact":var n=e.elements||"";n.length>0&&JT(GT(n),(function(e){var n=KT.get(e);n?t.push(n):JT(document.forms,(function(n){JT(n.elements,(function(n){n.name===e&&(e="mce_editor_"+YT++,KT.setAttrib(n,"id",e),t.push(n))}))}))}));break;case"textareas":case"specific_textareas":JT(KT.select("textarea"),(function(n){e.editor_deselector&&i(n,e.editor_deselector)||e.editor_selector&&!i(n,e.editor_selector)||t.push(n)}))}return t}(e)),e.types?JT(e.types,(function(n){bt.each(t,(function(t){return!KT.is(t,n.selector)||(s(o(t),XT({},e,n),t),!1)}))})):(bt.each(t,(function(e){var t;(t=n.get(e.id))&&t.initialized&&!(t.getContainer()||t.getBody()).parentNode&&(rE(t),t.unbindAllNativeEvents(),t.destroy(!0),t.removed=!0,t=null)})),0===(t=bt.grep(t,(function(e){return!n.get(e.id)}))).length?a([]):JT(t,(function(t){!function(e,t){return e.inline&&t.tagName.toLowerCase()in r}(e,t)?s(o(t),e,t):ly("Could not initialize inline editor on invalid inline target element",t)})))};return n.settings=e,KT.bind(window,"ready",c),new Vr((function(e){t?e(t):a=function(t){e(t)}}))},get:function(e){return 0===arguments.length?eE.slice(0):m(e)?Z(eE,(function(t){return t.id===e})).getOr(null):x(e)&&eE[e]?eE[e]:null},add:function(e){var t=this;return ZT[e.id]===e||(null===t.get(e.id)&&("length"!==e.id&&(ZT[e.id]=e),ZT.push(e),eE.push(e)),nE(!0),t.activeEditor=e,t.fire("AddEditor",{editor:e}),yC||(yC=function(e){var n=t.fire("BeforeUnload");if(n.returnValue)return e.preventDefault(),e.returnValue=n.returnValue,n.returnValue},window.addEventListener("beforeunload",yC))),e},createEditor:function(e,t){return this.add(new $T(e,t,this))},remove:function(e){var t,n,r=this;if(e){if(!m(e))return n=e,h(r.get(n.id))?null:(rE(n)&&r.fire("RemoveEditor",{editor:n}),0===eE.length&&window.removeEventListener("beforeunload",yC),n.remove(),nE(eE.length>0),n);JT(KT.select(e),(function(e){(n=r.get(e.id))&&r.remove(n)}))}else for(t=eE.length-1;t>=0;t--)r.remove(eE[t])},execCommand:function(e,t,n){var r=this.get(n);switch(e){case"mceAddEditor":return this.get(n)||new $T(n,this.settings,this).render(),!0;case"mceRemoveEditor":return r&&r.remove(),!0;case"mceToggleEditor":return r?(r.isHidden()?r.show():r.hide(),!0):(this.execCommand("mceAddEditor",!1,n),!0)}return!!this.activeEditor&&this.activeEditor.execCommand(e,t,n)},triggerSave:function(){JT(eE,(function(e){e.save()}))},addI18n:function(e,t){fc.add(e,t)},translate:function(e){return fc.translate(e)},setActive:function(e){var t=this.activeEditor;this.activeEditor!==e&&(t&&t.fire("deactivate",{relatedTarget:e}),e.fire("activate",{relatedTarget:t})),this.activeEditor=e},_setBaseUrl:function(e){this.baseURL=new Em(this.documentBaseURL).toAbsolute(e.replace(/\/+$/,"")),this.baseURI=new Em(this.baseURL)}});iE.setup();var aE,cE,uE,lE,sE=Math.min,fE=Math.max,dE=Math.round,mE=function(e,t,n){var r=t.x,o=t.y,i=e.w,a=e.h,c=t.w,u=t.h,l=(n||"").split("");return"b"===l[0]&&(o+=u),"r"===l[1]&&(r+=c),"c"===l[0]&&(o+=dE(u/2)),"c"===l[1]&&(r+=dE(c/2)),"b"===l[3]&&(o-=a),"r"===l[4]&&(r-=i),"c"===l[3]&&(o-=dE(a/2)),"c"===l[4]&&(r-=dE(i/2)),pE(r,o,i,a)},pE=function(e,t,n,r){return{x:e,y:t,w:n,h:r}},gE={inflate:function(e,t,n){return pE(e.x-t,e.y-n,e.w+2*t,e.h+2*n)},relativePosition:mE,findBestRelativePosition:function(e,t,n,r){var o,i;for(i=0;i<r.length;i++)if((o=mE(e,t,r[i])).x>=n.x&&o.x+o.w<=n.w+n.x&&o.y>=n.y&&o.y+o.h<=n.h+n.y)return r[i];return null},intersect:function(e,t){var n=fE(e.x,t.x),r=fE(e.y,t.y),o=sE(e.x+e.w,t.x+t.w),i=sE(e.y+e.h,t.y+t.h);return o-n<0||i-r<0?null:pE(n,r,o-n,i-r)},clamp:function(e,t,n){var r=e.x,o=e.y,i=e.x+e.w,a=e.y+e.h,c=t.x+t.w,u=t.y+t.h,l=fE(0,t.x-r),s=fE(0,t.y-o),f=fE(0,i-c),d=fE(0,a-u);return r+=l,o+=s,n&&(i+=l,a+=s,r-=f,o-=d),pE(r,o,(i-=f)-r,(a-=d)-o)},create:pE,fromClientRect:function(e){return pE(e.left,e.top,e.width,e.height)}},hE=(aE={},cE={},{load:function(e,t){var n='Script at URL "'+t+'" failed to load',r='Script at URL "'+t+"\" did not call `tinymce.Resource.add('"+e+"', data)` within 1 second";if(void 0!==aE[e])return aE[e];var o=new Vr((function(o,i){var a=function(e,t,n){void 0===n&&(n=1e3);var r=!1,o=null,i=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];r||(r=!0,null!==o&&(clearTimeout(o),o=null),e.apply(null,t))}},a=i(e),c=i(t);return{start:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];r||null!==o||(o=setTimeout((function(){return c.apply(null,e)}),n))},resolve:a,reject:c}}(o,i);cE[e]=a.resolve,ac.ScriptLoader.loadScript(t,(function(){return a.start(r)}),(function(){return a.reject(n)}))}));return aE[e]=o,o},add:function(e,t){void 0!==cE[e]&&(cE[e](t),delete cE[e]),aE[e]=Vr.resolve(t)}}),vE=bt.each,bE=bt.extend,yE=function(){};yE.extend=uE=function(e){var t=this.prototype,n=function(){var e,t,n,r=this;if(!lE&&(r.init&&r.init.apply(r,arguments),t=r.Mixins))for(e=t.length;e--;)(n=t[e]).init&&n.init.apply(r,arguments)},r=function(){return this};lE=!0;var o=new this;return lE=!1,e.Mixins&&(vE(e.Mixins,(function(t){for(var n in t)"init"!==n&&(e[n]=t[n])})),t.Mixins&&(e.Mixins=t.Mixins.concat(e.Mixins))),e.Methods&&vE(e.Methods.split(","),(function(t){e[t]=r})),e.Properties&&vE(e.Properties.split(","),(function(t){var n="_"+t;e[t]=function(e){return void 0!==e?(this[n]=e,this):this[n]}})),e.Statics&&vE(e.Statics,(function(e,t){n[t]=e})),e.Defaults&&t.Defaults&&(e.Defaults=bE({},t.Defaults,e.Defaults)),me(e,(function(e,n){"function"==typeof e&&t[n]?o[n]=function(e,n){return function(){var r=this,o=r._super;r._super=t[e];var i=n.apply(r,arguments);return r._super=o,i}}(n,e):o[n]=e})),n.prototype=o,n.constructor=n,n.extend=uE,n};var wE,CE=Math.min,xE=Math.max,SE=Math.round,kE={serialize:function(e){var t=JSON.stringify(e);return m(t)?t.replace(/[\u0080-\uFFFF]/g,(function(e){var t=e.charCodeAt(0).toString(16);return"\\u"+"0000".substring(t.length)+t})):t},parse:function(e){try{return JSON.parse(e)}catch(e){}}},TE={callbacks:{},count:0,send:function(e){var t=this,n=nc.DOM,r=void 0!==e.count?e.count:t.count,o="tinymce_jsonp_"+r;t.callbacks[r]=function(i){n.remove(o),delete t.callbacks[r],e.callback(i)},n.add(n.doc.body,"script",{id:o,src:e.url,type:"text/javascript"}),t.count++}},EE=De(De({},TT),{send:function(e){var t,n=0,r=function(){!e.async||4===t.readyState||n++>1e4?(e.success&&n<1e4&&200===t.status?e.success.call(e.success_scope,""+t.responseText,t,e):e.error&&e.error.call(e.error_scope,n>1e4?"TIMED_OUT":"GENERAL",t,e),t=null):Gr.setTimeout(r,10)};if(e.scope=e.scope||this,e.success_scope=e.success_scope||e.scope,e.error_scope=e.error_scope||e.scope,e.async=!1!==e.async,e.data=e.data||"",EE.fire("beforeInitialize",{settings:e}),(t=new XMLHttpRequest).overrideMimeType&&t.overrideMimeType(e.content_type),t.open(e.type||(e.data?"POST":"GET"),e.url,e.async),e.crossDomain&&(t.withCredentials=!0),e.content_type&&t.setRequestHeader("Content-Type",e.content_type),e.requestheaders&&bt.each(e.requestheaders,(function(e){t.setRequestHeader(e.key,e.value)})),t.setRequestHeader("X-Requested-With","XMLHttpRequest"),(t=EE.fire("beforeSend",{xhr:t,settings:e}).xhr).send(e.data),!e.async)return r();Gr.setTimeout(r,10)}}),AE=bt.extend,_E=function(){function e(e){this.settings=AE({},e),this.count=0}return e.sendRPC=function(t){return(new e).send(t)},e.prototype.send=function(e){var t=e.error,n=e.success,r=AE(this.settings,e);r.success=function(e,o){void 0===(e=kE.parse(e))&&(e={error:"JSON Parse error."}),e.error?t.call(r.error_scope||r.scope,e.error,o):n.call(r.success_scope||r.scope,e.result)},r.error=function(e,n){t&&t.call(r.error_scope||r.scope,e,n)},r.data=kE.serialize({id:e.id||"c"+this.count++,method:e.method,params:e.params}),r.content_type="application/json",EE.send(r)},e}();try{var NE="__storage_test__";(wE=window.localStorage).setItem(NE,NE),wE.removeItem(NE)}catch(e){wE=function(){var e={},t=[],n={getItem:function(t){var n=e[t];return n||null},setItem:function(n,r){t.push(n),e[n]=String(r)},key:function(e){return t[e]},removeItem:function(n){t=t.filter((function(e){return e===n})),delete e[n]},clear:function(){t=[],e={}},length:0};return Object.defineProperty(n,"length",{get:function(){return t.length},configurable:!1,enumerable:!1}),n}()}var RE={geom:{Rect:gE},util:{Promise:Vr,Delay:Gr,Tools:bt,VK:Vf,URI:Em,Class:yE,EventDispatcher:ST,Observable:TT,I18n:fc,XHR:EE,JSON:kE,JSONRequest:_E,JSONP:TE,LocalStorage:wE,Color:function(e){var t={},n=0,r=0,o=0,i=function(e){var i;return"object"==typeof e?"r"in e?(n=e.r,r=e.g,o=e.b):"v"in e&&function(e,t,i){if(e=(parseInt(e,10)||0)%360,t=parseInt(t,10)/100,i=parseInt(i,10)/100,t=xE(0,CE(t,1)),i=xE(0,CE(i,1)),0!==t){var a=e/60,c=i*t,u=c*(1-Math.abs(a%2-1)),l=i-c;switch(Math.floor(a)){case 0:n=c,r=u,o=0;break;case 1:n=u,r=c,o=0;break;case 2:n=0,r=c,o=u;break;case 3:n=0,r=u,o=c;break;case 4:n=u,r=0,o=c;break;case 5:n=c,r=0,o=u;break;default:n=r=o=0}n=SE(255*(n+l)),r=SE(255*(r+l)),o=SE(255*(o+l))}else n=r=o=SE(255*i)}(e.h,e.s,e.v):(i=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)[^\)]*\)/gi.exec(e))?(n=parseInt(i[1],10),r=parseInt(i[2],10),o=parseInt(i[3],10)):(i=/#([0-F]{2})([0-F]{2})([0-F]{2})/gi.exec(e))?(n=parseInt(i[1],16),r=parseInt(i[2],16),o=parseInt(i[3],16)):(i=/#([0-F])([0-F])([0-F])/gi.exec(e))&&(n=parseInt(i[1]+i[1],16),r=parseInt(i[2]+i[2],16),o=parseInt(i[3]+i[3],16)),n=n<0?0:n>255?255:n,r=r<0?0:r>255?255:r,o=o<0?0:o>255?255:o,t};return e&&i(e),t.toRgb=function(){return{r:n,g:r,b:o}},t.toHsv=function(){return function(e,t,n){var r,o;o=0;var i=CE(e/=255,CE(t/=255,n/=255)),a=xE(e,xE(t,n));return i===a?{h:0,s:0,v:100*(o=i)}:(r=(a-i)/a,o=a,{h:SE(60*((e===i?3:n===i?1:5)-(e===i?t-n:n===i?e-t:n-e)/(a-i))),s:SE(100*r),v:SE(100*o)})}(n,r,o)},t.toHex=function(){var e=function(e){return(e=parseInt(e,10).toString(16)).length>1?e:"0"+e};return"#"+e(n)+e(r)+e(o)},t.parse=i,t},ImageUploader:function(e){var t=my(),n=by(e,t);return{upload:function(t,r){return void 0===r&&(r=!0),n.upload(t,r?vy(e):void 0)}}}},dom:{EventUtils:_i,Sizzle:la,DomQuery:Ja,TreeWalker:Yr,TextSeeker:jc,DOMUtils:nc,ScriptLoader:ac,RangeUtils:cd,Serializer:pb,StyleSheetLoader:Jr,ControlSelection:$f,BookmarkManager:Ff,Selection:qv,Event:_i.Event},html:{Styles:yi,Entities:ci,Node:bm,Schema:vi,SaxParser:Dm,DomParser:lb,Writer:Fm,Serializer:jm},Env:mt,AddOnManager:dc,Annotator:Lf,Formatter:Ey,UndoManager:_y,EditorCommands:pT,WindowManager:ry,NotificationManager:ey,EditorObservable:RT,Shortcuts:jT,Editor:$T,FocusManager:Gd,EditorManager:iE,DOM:nc.DOM,ScriptLoader:ac.ScriptLoader,PluginManager:ty,ThemeManager:ny,IconManager:qb,Resource:hE,trim:bt.trim,isArray:bt.isArray,is:bt.is,toArray:bt.toArray,makeMap:bt.makeMap,each:bt.each,map:bt.map,grep:bt.grep,inArray:bt.inArray,extend:bt.extend,create:bt.create,walk:bt.walk,createNS:bt.createNS,resolve:bt.resolve,explode:bt.explode,_addCacheSuffix:bt._addCacheSuffix,isOpera:mt.opera,isWebKit:mt.webkit,isIE:mt.ie,isGecko:mt.gecko,isMac:mt.mac},DE=bt.extend(iE,RE);!function(e){window.tinymce=e,window.tinyMCE=e}(DE),function(t){try{e.exports=t}catch(e){}}(DE)}()}).call(this,n("./node_modules/webpack/buildin/global.js"),n("./node_modules/timers-browserify/main.js").setImmediate)},"./node_modules/webpack/buildin/global.js":function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},"./node_modules/window-or-global/lib/index.js":function(e,t,n){"use strict";(function(t){e.exports="object"==typeof self&&self.self===self&&self||"object"==typeof t&&t.global===t&&t||this}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./src/editor-plugins/aeTable/advtable-plugin.js":function(e,t){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}
/*!
 * Tiny Advanced Tables plugin
 *
 * Copyright 2010-2021 Tiny Technologies, Inc. All rights reserved.
 *
 * Version: 1.1.0-rc
 */!function(){"use strict";function e(){}function t(e){return function(){return e}}function r(e){return e}function o(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var o=t.concat(n);return e.apply(null,o)}}var i=t(!1),a=t(!0),c=function(){return u},u={fold:function(e,t){return e()},is:i,isSome:i,isNone:a,getOr:f,getOrThunk:s,getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:t(null),getOrUndefined:t(void 0),or:f,orThunk:s,map:c,each:e,bind:c,exists:i,forall:a,filter:c,equals:l,equals_:l,toArray:function(){return[]},toString:t("none()")};function l(e){return e.isNone()}function s(e){return e()}function f(e){return e}function d(e){return!(null==e)}function m(e,t){return e=e,t=t,-1<z.call(e,t)}function p(e,t){for(var n=0,r=e.length;n<r;n++)if(t(e[n],n))return!0;return!1}function g(e,t){for(var n=[],r=0;r<e;r++)n.push(t(r));return n}function h(e,t){for(var n=e.length,r=new Array(n),o=0;o<n;o++){var i=e[o];r[o]=t(i,o)}return r}function v(e,t){for(var n=0,r=e.length;n<r;n++)t(e[n],n)}function b(e,t){for(var n=[],r=0,o=e.length;r<o;r++){var i=e[r];t(i,r)&&n.push(i)}return n}function y(e,t){if(0===e.length)return[];for(var n=t(e[0]),r=[],o=[],i=0,a=e.length;i<a;i++){var c=e[i],u=t(c);u!==n&&(r.push(o),o=[]),n=u,o.push(c)}return 0!==o.length&&r.push(o),r}function w(e,t,n){return function(e,t){for(var n=e.length-1;0<=n;n--)t(e[n])}(e,(function(e){n=t(n,e)})),n}function C(e,t,n){return v(e,(function(e){n=t(n,e)})),n}function x(e,t){return function(e,t,n){for(var r=0,o=e.length;r<o;r++){var i=e[r];if(t(i,r))return R.some(i);if(n(i,r))break}return R.none()}(e,t,i)}function S(e,t){return function(e){for(var t=[],n=0,r=e.length;n<r;++n){if(!B(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);W.apply(t,e[n])}return t}(h(e,t))}function k(e,t){for(var n=0,r=e.length;n<r;++n)if(!0!==t(e[n],n))return!1;return!0}function T(e){return[e]}function E(e,t){return(e=U.call(e,0)).sort(t),e}function A(e,t){return 0<=t&&t<e.length?R.some(e[t]):R.none()}function _(e,t){for(var n=0;n<e.length;n++){var r=t(e[n],n);if(r.isSome())return r}return R.none()}var N=function e(n){function r(){return l}function o(e){return e(n)}var c=t(n),l={fold:function(e,t){return t(n)},is:function(e){return n===e},isSome:a,isNone:i,getOr:c,getOrThunk:c,getOrDie:c,getOrNull:c,getOrUndefined:c,or:r,orThunk:r,map:function(t){return e(t(n))},each:function(e){e(n)},bind:o,exists:o,forall:o,filter:function(e){return e(n)?l:u},toArray:function(){return[n]},toString:function(){return"some("+n+")"},equals:function(e){return e.is(n)},equals_:function(e,t){return e.fold(i,(function(e){return t(n,e)}))}};return l},R={some:N,none:c,from:function(e){return null==e?u:N(e)}},D=function(e){return function(t){return n(t)===e}},O=function(e){return function(t){return e===t}},I=(zo=function(e){return function(t){return t=n(r=t),(null===r?"null":"object"==t&&(Array.prototype.isPrototypeOf(r)||r.constructor&&"Array"===r.constructor.name)?"array":"object"==t&&(String.prototype.isPrototypeOf(r)||r.constructor&&"String"===r.constructor.name)?"string":t)===e;var r}})("string"),P=zo("object"),B=zo("array"),M=O(null),L=D("boolean"),F=O(void 0),j=D("function"),H=D("number"),U=Array.prototype.slice,z=Array.prototype.indexOf,W=Array.prototype.push,V=function(){return(V=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function q(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,c=i.length;a<c;a++,o++)r[o]=i[a];return r}function $(e,t){var n=String(t).toLowerCase();return x(e,(function(e){return e.search(n)}))}function K(e,t){return-1!==e.indexOf(t)}function G(e){return window.matchMedia(e).matches}function J(e,t){if(1!==(e=e.dom).nodeType)return!1;if(void 0!==e.matches)return e.matches(t);if(void 0!==e.msMatchesSelector)return e.msMatchesSelector(t);if(void 0!==e.webkitMatchesSelector)return e.webkitMatchesSelector(t);if(void 0!==e.mozMatchesSelector)return e.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")}function X(e){return 1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType||0===e.childElementCount}function Y(e,t){return e.dom===t.dom}function Q(e,t){for(var n=We(e),r=0,o=n.length;r<o;r++){var i=n[r];t(e[i],i)}}function Z(e,t){var n=[];return Q(e,(function(e,r){n.push(t(e,r))})),n}function ee(e,t){return qe(e,t)?R.from(e[t]):R.none()}function te(e,t,n){return{element:e,rowspan:t,colspan:n}}function ne(e,t,n){return{element:e,cells:t,section:n}}function re(e,t,n){return{element:e,isNew:t,isLocked:n}}function oe(e,t){return{cells:e,section:t}}function ie(e){return e.dom.nodeName.toLowerCase()}function ae(e){return e.dom.nodeType}function ce(e){return Ue.fromDom(e.dom.ownerDocument)}function ue(e){return Je(e)?e:ce(e)}function le(e){return R.from(e.dom.parentNode).map(Ue.fromDom)}function se(e,t){for(var n=j(t)?t:i,r=e.dom,o=[];null!==r.parentNode&&void 0!==r.parentNode;){var a=r.parentNode,c=Ue.fromDom(a);if(o.push(c),!0===n(c))break;r=a}return o}function fe(e){return R.from(e.dom.nextSibling).map(Ue.fromDom)}function de(e){return h(e.dom.childNodes,Ue.fromDom)}function me(e){return Ue.fromDom(e.dom.host)}function pe(e,t){return n=function(e){return J(e,t)},b(de(e),n);var n}function ge(e,t){return function(e,t){return X(t=void 0===t?document:t.dom)?[]:h(t.querySelectorAll(e),Ue.fromDom)}(t,e)}var he,ve,be,ye,we=function(){return Ce(0,0)},Ce=function(e,t){return{major:e,minor:t}},xe=function(e,t){return t=String(t).toLowerCase(),0===e.length?we():function(e,t){var n=function(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(r.test(t))return r}}(e,t);return n?Ce((e=function(e){return Number(t.replace(n,"$"+e))})(1),e(2)):{major:0,minor:0}}(e,t)},Se=we,ke=(he=/^\s+|\s+$/g,function(e){return e.replace(he,"")}),Te=(O=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(e){return K(e,"edge/")&&K(e,"chrome")&&K(e,"safari")&&K(e,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,c=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/],search:function(e){return K(e,"chrome")&&!K(e,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(e){return K(e,"msie")||K(e,"trident")}},{name:"Opera",versionRegexes:[c,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:(zo=function(e){return function(t){return K(t,e)}})("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:zo("firefox")},{name:"Safari",versionRegexes:[c,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(e){return(K(e,"safari")||K(e,"mobile/"))&&K(e,"applewebkit")}}],D=[{name:"Windows",search:zo("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(e){return K(e,"iphone")||K(e,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:zo("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:zo("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:zo("linux"),versionRegexes:[]},{name:"Solaris",search:zo("sunos"),versionRegexes:[]},{name:"FreeBSD",search:zo("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:zo("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],{browsers:t(O),oses:t(D)}),Ee="Firefox",Ae=function(e){var t=e.current,n=e.version;return{current:t,version:n,isEdge:(e=function(e){return function(){return t===e}})("Edge"),isChrome:e("Chrome"),isIE:e("IE"),isOpera:e("Opera"),isFirefox:e(Ee),isSafari:e("Safari")}},_e=function(){return Ae({current:void 0,version:Se()})},Ne=Ae,Re=(t("Edge"),t("Chrome"),t("IE"),t("Opera"),t(Ee),t("Safari"),"Windows"),De="Android",Oe="Solaris",Ie="FreeBSD",Pe="ChromeOS",Be=function(e){var t=e.current,n=e.version;return{current:t,version:n,isWindows:(e=function(e){return function(){return t===e}})(Re),isiOS:e("iOS"),isAndroid:e(De),isOSX:e("OSX"),isLinux:e("Linux"),isSolaris:e(Oe),isFreeBSD:e(Ie),isChromeOS:e(Pe)}},Me=function(){return Be({current:void 0,version:Se()})},Le=Be,Fe=(t(Re),t("iOS"),t(De),t("Linux"),t("OSX"),t(Oe),t(Ie),t(Pe),function(e,n){var r,o,i=Te.browsers(),a=Te.oses(),c=function(e,t){return $(e,t).map((function(e){var n=xe(e.versionRegexes,t);return{current:e.name,version:n}}))}(i,e).fold(_e,Ne),u=function(e,t){return $(e,t).map((function(e){var n=xe(e.versionRegexes,t);return{current:e.name,version:n}}))}(a,e).fold(Me,Le);return{browser:c,os:u,deviceType:(r=c,o=e,i=n,c=(a=u).isiOS()&&!0===/ipad/i.test(o),e=a.isiOS()&&!c,n=a.isiOS()||a.isAndroid(),u=n||i("(pointer:coarse)"),i=c||!e&&n&&i("(min-device-width:768px)"),n=e||n&&!i,o=r.isSafari()&&a.isiOS()&&!1===/safari/i.test(o),{isiPad:t(c),isiPhone:t(e),isTablet:t(i),isPhone:t(n),isTouch:t(u),isAndroid:a.isAndroid,isiOS:a.isiOS,isWebView:t(o),isDesktop:t(!n&&!i&&!o)})}}),je=(ye=!(ve=function(){return Fe(navigator.userAgent,G)}),function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return ye||(ye=!0,be=ve.apply(null,e)),be}),He=function(e){if(null==e)throw new Error("Node cannot be null or undefined");return{dom:e}},Ue={fromHtml:function(e,t){if((t=(t||document).createElement("div")).innerHTML=e,!t.hasChildNodes()||1<t.childNodes.length)throw console.error("HTML does not have a single root node",e),new Error("HTML must have a single root node");return He(t.childNodes[0])},fromTag:function(e,t){return e=(t||document).createElement(e),He(e)},fromText:function(e,t){return e=(t||document).createTextNode(e),He(e)},fromDom:He,fromPoint:function(e,t,n){return R.from(e.dom.elementFromPoint(t,n)).map(He)}},ze=J,We=Object.keys,Ve=Object.hasOwnProperty,qe=function(e,t){return Ve.call(e,t)},$e=["tfoot","thead","tbody","colgroup"],Ke=(c=("undefined"!=typeof window||Function("return this;")(),function(e){return function(t){return ae(t)===e}}))(1),Ge=c(3),Je=c(9),Xe=c(11),Ye=j(Element.prototype.attachShadow)&&j(Node.prototype.getRootNode)?function(e){return Ue.fromDom(e.dom.getRootNode())}:ue,Qe=function e(t){var n=Ge(t)?t.dom.parentNode:t.dom;if(null==n||null===n.ownerDocument)return!1;var r,o,i=n.ownerDocument;return function(e){var t=Ye(e);return Xe(e=t)&&d(e.dom.host)?R.some(t):R.none()}(Ue.fromDom(n)).fold((function(){return i.body.contains(n)}),(r=e,o=me,function(e){return r(o(e))}))};function Ze(e,t,n){for(var r=e.dom,o=j(n)?n:i;r.parentNode;){r=r.parentNode;var a=Ue.fromDom(r);if(t(a))return R.some(a);if(o(a))break}return R.none()}function et(e,t,n){return Ze(e,(function(e){return J(e,t)}),n)}function tt(e,t){return n=function(e){return J(e,t)},x(e.dom.childNodes,(function(e){return n(Ue.fromDom(e))})).map(Ue.fromDom);var n}function nt(e,t){return function(e,t){return X(t=void 0===t?document:t.dom)?R.none():R.from(t.querySelector(e)).map(Ue.fromDom)}(t,e)}function rt(e,t,n){var r;return r=et,n=n,J(e=e,t=t)?R.some(e):j(n)&&n(e)?R.none():r(e,t,n)}function ot(e,t,n){if(!(I(n)||L(n)||H(n)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",n,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(t,n+"")}function it(e,t,n){ot(e.dom,t,n)}function at(e,t){var n=e.dom;Q(t,(function(e,t){ot(n,t,e)}))}function ct(e,t){return null===(t=e.dom.getAttribute(t))?void 0:t}function ut(e,t){return R.from(ct(e,t))}function lt(e,t){e.dom.removeAttribute(t)}function st(e){return C(e.dom.attributes,(function(e,t){return e[t.name]=t.value,e}),{})}function ft(e){return void 0!==e.style&&j(e.style.getPropertyValue)}function dt(e,t,n){if(!I(n))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",n,":: Element ",e),new Error("CSS value must be a string: "+n);ft(e)&&e.style.setProperty(t,n)}function mt(e,t,n){dt(e=e.dom,t,n)}function pt(e,t){var n=e.dom;Q(t,(function(e,t){dt(n,t,e)}))}function gt(e,t){var n=e.dom,r=window.getComputedStyle(n).getPropertyValue(t);return""!==r||Qe(e)?r:zt(n,t)}function ht(e,t){return e=e.dom,t=zt(e,t),R.from(t).filter((function(e){return 0<e.length}))}function vt(e,t){var n=e.dom;t=t,ft(n=n)&&n.style.removeProperty(t),ut(e,"style").map(ke).is("")&&lt(e,"style")}function bt(e,t,n){return void 0===n&&(n=0),ut(e,t).map((function(e){return parseInt(e,10)})).getOr(n)}function yt(e,t){return bt(e,t,1)}function wt(e){return 1<yt(e,"colspan")}function Ct(e,t){return Vt(e,t,a)}function xt(e,t){return function(e,t,n){return(n=void 0===n?i:n)(t)?R.none():m(e,ie(t))?R.some(t):et(t,e.join(","),(function(e){return J(e,"table")||n(e)}))}(["td","th"],e,t)}function St(e){return Ct(e,"th,td")}function kt(e){return J(e,"colgroup")?pe(e,"col"):S(qt(e),(function(e){return pe(e,"col")}))}function Tt(e,t){return rt(e,"table",t)}function Et(e){return le(e).map((function(e){return e=ie(e),m($e,e)?e:"tbody"})).getOr("tbody")}function At(e,t){return e.cells[t]}function _t(e,t){return At(e,t).element}function Nt(e){return{rows:(e=function(e,t){for(var n=[],r=[],o=0,i=e.length;o<i;o++){var a=e[o];(t(a)?n:r).push(a)}return{pass:n,fail:r}}(e,(function(e){return"colgroup"===e.section}))).fail,cols:e.pass}}function Rt(e){return ut(e,Kt).bind((function(e){return R.from(e.match(/\d+/g))})).map((function(e){return function(e,t){for(var n={},r=0,o=e.length;r<o;r++){var i=e[r];n[String(i)]=t(i,r)}return n}(e,a)}))}function Dt(e){var t={},n=[],r={},o=A(e,0).map((function(e){return e.element})).bind(Tt).bind(Rt).getOr({}),i=0,a=0,c=0;return v(e,(function(e){var u,l,s;"colgroup"===e.section?(l={},s=0,v(e.cells,(function(e){var t=e.colspan;g(t,(function(n){l[n=s+n]={element:e.element,colspan:t,column:n}})),s+=t})),r=l):(u=[],v(e.cells,(function(e){for(var n=0;void 0!==t[c+","+n];)n++;for(var r,i=(r=o,i=n.toString(),qe(r,i)&&void 0!==r[i]&&null!==r[i]),l={element:e.element,rowspan:e.rowspan,colspan:e.colspan,row:c,column:n,isLocked:i},s=0;s<e.colspan;s++)for(var f=0;f<e.rowspan;f++){var d=n+s;t[c+f+","+d]=l,a=Math.max(a,d+1)}u.push(l)})),i++,n.push(ne(e.element,u,e.section)),c++)})),{grid:{rows:i,columns:a},access:t,all:n,columns:r}}function Ot(e,t){return t.column>=e.startCol&&t.column+t.colspan-1<=e.finishCol&&t.row>=e.startRow&&t.row+t.rowspan-1<=e.finishRow}function It(e,t,n){return function(e,t,n){t=Jt.findItem(e,t,Y);var r=Jt.findItem(e,n,Y);return t.bind((function(e){return r.map((function(t){return n=e,t=t,{startRow:Math.min(n.row,t.row),startCol:Math.min(n.column,t.column),finishRow:Math.max(n.row+n.rowspan-1,t.row+t.rowspan-1),finishCol:Math.max(n.column+n.colspan-1,t.column+t.colspan-1)};var n}))}))}(e,t,n).bind((function(t){return function(e,t){for(var n=!0,r=o(Ot,t),i=t.startRow;i<=t.finishRow;i++)for(var a=t.startCol;a<=t.finishCol;a++)n=n&&Jt.getAt(e,i,a).exists(r);return n?R.some(t):R.none()}(e,t)}))}function Pt(e,t,n){return It(e=Xt(e),t,n)}function Bt(e,t){le(e).each((function(n){n.dom.insertBefore(t.dom,e.dom)}))}function Mt(e,t){fe(e).fold((function(){le(e).each((function(e){Yt(e,t)}))}),(function(e){Bt(e,t)}))}function Lt(e,t){(function(e){return function(e,t){return e=e.dom.childNodes,R.from(e[0]).map(Ue.fromDom)}(e)})(e).fold((function(){Yt(e,t)}),(function(n){e.dom.insertBefore(t.dom,n.dom)}))}function Ft(e,t){v(t,(function(t){Yt(e,t)}))}function jt(e){e.dom.textContent="",v(de(e),(function(e){Qt(e)}))}var Ht,Ut,zt=function(e,t){return ft(e)?e.style.getPropertyValue(t):""},Wt=t(10),Vt=function e(t,n,r){return S(de(t),(function(t){return J(t,n)?r(t)?[t]:[]:e(t,n,r)}))},qt=function(e){return Tt(e).fold(t([]),(function(e){return pe(e,"colgroup")}))},$t=function(e,t){return oe(t,e.section)},Kt="data-snooker-locked-cols",Gt=function(e,t){return b(e=S(e.all,(function(e){return e.cells})),t)},Jt={fromTable:function(e){return Dt(e=function(e){var t,n=Ct(e,"tr");return n=q(qt(e),n),t=Et,h(n,(function(e){if("colgroup"===ie(e)){var n=h(kt(e),(function(e){return te(e,1,bt(e,"span",1))}));return ne(e,n,"colgroup")}return ne(e,n=h(St(e),(function(e){return te(e,bt(e,"rowspan",1),bt(e,"colspan",1))})),t(e))}))}(e))},generate:Dt,getAt:function(e,t,n){return void 0!==(n=e.access[t+","+n])?R.some(n):R.none()},findItem:function(e,t,n){return 0<(e=Gt(e,(function(e){return n(t,e.element)}))).length?R.some(e[0]):R.none()},filterItems:Gt,justCells:function(e){return S(e.all,(function(e){return e.cells}))},justColumns:function(e){return Z(e=e.columns,(function(e){return e}))},hasColumns:function(e){return 0<We(e.columns).length},getColumnAt:function(e,t){return R.from(e.columns[t])}},Xt=Jt.fromTable,Yt=function(e,t){e.dom.appendChild(t.dom)},Qt=function(e){null!==(e=e.dom).parentNode&&e.parentNode.removeChild(e)},Zt=(Ht=Ge,"text",{get:function(e){if(!Ht(e))throw new Error("Can only get text value of a text node");return Ut(e).getOr("")},getOption:Ut=function(e){return Ht(e)?R.from(e.dom.nodeValue):R.none()},set:function(e,t){if(!Ht(e))throw new Error("Can only set raw text value of a text node");e.dom.nodeValue=t}}),en=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"];function tn(e){return et(e,"table")}function nn(e,t){return 0<(t=ge(e,t)).length?R.some(t):R.none()}function rn(e,t,n){return function(e,t,n){return nt(e,t).bind((function(t){return nt(e,n).bind((function(e){return n=tn,Tn(En,(function(e,t){return n(t)}),[t,e]).map((function(n){return{first:t,last:e,table:n}}));var n}))}))}(e,t,n).bind((function(t){function n(t){return Y(e,t)}var r="thead,tfoot,tbody,table",o=et(t.first,r,n),i=et(t.last,r,n);return o.bind((function(e){return i.bind((function(n){return Y(e,n)?Pt(t.table,t.first,t.last):R.none()}))}))}))}function on(e,t,n,r){return e.fold(t,n,r)}function an(e){return parseInt(e,10)}function cn(e,t){return 0==(t=e-t)?0:0<t?1:-1}function un(e,t,n){return{major:e,minor:t,patch:n}}function ln(e){return(e=/([0-9]+)\.([0-9]+)\.([0-9]+)(?:(\-.+)?)/.exec(e))?un(an(e[1]),an(e[2]),an(e[3])):un(0,0,0)}function sn(e,t){return!!e&&-1===function(e,t){var n=cn(e.major,t.major);return 0!==n||0!==(n=cn(e.minor,t.minor))?n:0!==(t=cn(e.patch,t.patch))?t:0}(ln([(e=e=e).majorVersion,e.minorVersion].join(".").split(".").slice(0,3).join(".")),ln(t))}function fn(e,t){return void 0===(t=ct(e,t))||""===t?[]:t.split(" ")}function dn(e){return void 0!==e.dom.classList}function mn(e){return fn(e,"class")}function pn(e,t){dn(e)?e.dom.classList.add(t):function(e,t){(function(e,t,n){it(e,t,(n=fn(e,t).concat([n])).join(" "))})(e,"class",t)}(e,t)}function gn(e){return(dn(e)?function(e){for(var t=e.dom.classList,n=new Array(t.length),r=0;r<t.length;r++){var o=t.item(r);null!==o&&(n[r]=o)}return n}:mn)(e)}function hn(e,t,n){return e.isSome()&&t.isSome()?R.some(n(e.getOrDie(),t.getOrDie())):R.none()}function vn(e){return Ue.fromDom(e.getBody())}function bn(e){function t(e){return lt(e,"data-mce-style")}lt(e,"data-mce-style"),v(St(e),t),v(kt(e),t)}function yn(e){return on(e.get(),t([]),r,T)}function wn(e){function t(e,t){return ut(e,t).exists((function(e){return 1<parseInt(e,10)}))}return 0<(e=yn(e)).length&&k(e,(function(e){return t(e,"rowspan")||t(e,"colspan")}))?R.some(e):R.none()}function Cn(e,t,n){return{element:n,mergable:(r=t,o=In,on(e.get(),R.none,(function(e){return e.length<=1?R.none():rn(r,o.firstSelectedSelector,o.lastSelectedSelector).map((function(t){return{bounds:t,cells:e}}))}),R.none)),unmergable:wn(e),selection:yn(e)};var r,o}function xn(e){return{element:e,mergable:R.none(),unmergable:R.none(),selection:[e]}}function Sn(e,t){var n;return Tt(e,t=(n=t,function(e){return Y(e,vn(n))}))}var kn=function(e,t,n){return t.bind((function(t){return n.filter(o(e.eq,t))}))},Tn=function(e,t,n){return 0<n.length?function(e,t,n,r){return w(r,(function(n,r){return r=t(e,r),kn(e,n,r)}),n=t(e,n))}(e,t,(n=n)[0],n.slice(1)):R.none()},En={up:t({selector:et,closest:rt,predicate:Ze,all:se}),down:t({selector:ge,predicate:function e(t,n){var r=[];return v(de(t),(function(t){r=(r=n(t)?r.concat([t]):r).concat(e(t,n))})),r}}),styles:t({get:gt,getRaw:ht,set:mt,remove:vt}),attrs:t({get:ct,set:it,remove:lt,copyTo:function(e,t){at(t,e=st(e))}}),insert:t({before:Bt,after:Mt,afterAll:function(e,t){v(t,(function(n,r){Mt(r=0===r?e:t[r-1],n)}))},append:Yt,appendAll:Ft,prepend:Lt,wrap:function(e,t){Bt(e,t),Yt(t,e)}}),remove:t({unwrap:function(e){var t,n=de(e);0<n.length&&(t=e,v(n,(function(e){Bt(t,e)}))),Qt(e)},remove:Qt}),create:t({nu:Ue.fromTag,clone:function(e){return Ue.fromDom(e.dom.cloneNode(!1))},text:Ue.fromText}),query:t({comparePosition:function(e,t){return e.dom.compareDocumentPosition(t.dom)},prevSibling:function(e){return R.from(e.dom.previousSibling).map(Ue.fromDom)},nextSibling:fe}),property:t({children:de,name:ie,parent:le,document:function(e){return ue(e).dom},isText:Ge,isComment:function(e){return 8===ae(e)||"#comment"===ie(e)},isElement:Ke,isSpecial:function(e){return m(["script","noscript","iframe","noframes","noembed","title","style","textarea","xmp"],e=ie(e))},getText:function(e){return Zt.get(e)},setText:function(e,t){return Zt.set(e,t)},isBoundary:function(e){return!!Ke(e)&&("body"===ie(e)||m(en,ie(e)))},isEmptyTag:function(e){return!!Ke(e)&&m(["br","img","hr","input"],ie(e))},isNonEditable:function(e){return Ke(e)&&"false"===ct(e,"contenteditable")}}),eq:Y,is:ze},An=(O=(zo=function(e){if(!B(e))throw new Error("cases must be an array");if(0===e.length)throw new Error("there must be at least one case");var t=[],n={};return v(e,(function(r,o){var i=We(r);if(1!==i.length)throw new Error("one and only one name per case");var a=i[0],c=r[a];if(void 0!==n[a])throw new Error("duplicate key detected:"+a);if("cata"===a)throw new Error("cannot have a case named cata (sorry)");if(!B(c))throw new Error("case arguments must be an array");t.push(a),n[a]=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var i=n.length;if(i!==c.length)throw new Error("Wrong number of arguments to case "+a+". Expected "+c.length+" ("+c+"), got "+i);return{fold:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];if(t.length!==e.length)throw new Error("Wrong number of arguments to fold. Expected "+e.length+", got "+t.length);return t[o].apply(null,n)},match:function(e){var r=We(e);if(t.length!==r.length)throw new Error("Wrong number of arguments to match. Expected: "+t.join(",")+"\nActual: "+r.join(","));if(!k(t,(function(e){return m(r,e)})))throw new Error("Not all branches were specified when using match. Specified: "+r.join(", ")+"\nRequired: "+t.join(", "));return e[a].apply(null,n)},log:function(e){console.log(e,{constructors:t,constructor:a,params:n})}}}})),n})([{none:[]},{multiple:["elements"]},{single:["element"]}])).none,_n=O.multiple,Nn=O.single,Rn=function(e,t,n){function r(t){lt(t,e.selected),lt(t,e.firstSelected),lt(t,e.lastSelected)}function o(t){it(t,e.selected,"1")}function i(e){a(e),n()}var a=function(t){v(t=ge(t,e.selectedSelector),r)};return{clearBeforeUpdate:a,clear:i,selectRange:function(n,r,a,c){i(n),v(r,o),it(a,e.firstSelected,"1"),it(c,e.lastSelected,"1"),t(r,a,c)},selectedSelector:e.selectedSelector,firstSelectedSelector:e.firstSelectedSelector,lastSelectedSelector:e.lastSelectedSelector}},Dn={structure:!1,style:!0},On={structure:!0,style:!1},In={selected:D="data-mce-selected",selectedSelector:"td[data-mce-selected],th[data-mce-selected]",firstSelected:c="data-mce-first-selected",firstSelectedSelector:"td[data-mce-first-selected],th[data-mce-first-selected]",lastSelected:O="data-mce-last-selected",lastSelectedSelector:"td[data-mce-last-selected],th[data-mce-last-selected]"},Pn=(c=function(e){return function(t){var n,r=Ue.fromDom(t.selection.getStart());return rt(r="col"===(t=ie(r))||"colgroup"===t?Tt(n=r).bind((function(e){return nn(e,In.firstSelectedSelector)})).fold((function(){return n}),(function(e){return e[0]})):r,e)}})("th,td"),Bn=c("th,td,caption"),Mn={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},Ln=(c=["Infinity",(O="[0-9]+")+"\\."+Fn(O)+Fn(c="[eE][+-]?[0-9]+"),"\\."+O+Fn(c),O+Fn(c)].join("|"),new RegExp("^([+-]?(?:"+c+"))(.*)$"));function Fn(e){return"(?:"+e+")?"}function jn(e,t){return R.from(Ln.exec(e)).bind((function(e){var n,r=Number(e[1]);e=e[2];return n=e,p(t,(function(e){return p(Mn[e],(function(e){return n===e}))}))?R.some({value:r,unit:e}):R.none()}))}function Hn(e){return yo.getOuter(e)}function Un(e){return wo.get(e)}function zn(e){return wo.getOuter(e)}function Wn(e,t,n){return function(e,t){return e=parseFloat(e),isNaN(e)?t:e}(gt(e,t),n)}function Vn(e){return function(){var e=je().browser;return e.isIE()||e.isEdge()}()?(n=(t=e).dom.getBoundingClientRect().width,"border-box"===gt(t,"box-sizing")?n:n-Wn(t,"padding-left",0)-Wn(t,"padding-right",0)-(Wn(t,"border-left-width",0)+Wn(t,"border-right-width",0))):Wn(e,"width",Un(e));var t,n}function qn(e,t){mt(e,"width",t+"px")}function $n(e,t){mt(e,"width",t+"%")}function Kn(e){return ht(e,"width").fold((function(){return R.from(ct(e,"width"))}),(function(e){return R.some(e)}))}function Gn(e,t){return e/t.pixelWidth()*100}function Jn(e,t){return Kn(e).fold((function(){return Gn(Un(e),t)}),(function(n){return function(e,t,n){return null!==(t=Co.exec(t))?parseFloat(t[1]):Gn(e=Vn(e),n)}(e,n,t)}))}function Xn(e,t){return Kn(e).fold((function(){return Vn(e)}),(function(n){return function(e,t,n){var r=xo.exec(t);return null!==r?parseInt(r[1],10):null===(t=Co.exec(t))?Vn(e):parseFloat(t[1])/100*n.pixelWidth()}(e,n,t)}))}function Yn(e,t,n){mt(e,"width",t+n)}function Qn(e,t){1===yt(e,"colspan")&&Kn(e).bind((function(e){return jn(e,["fixed","relative","empty"])})).each((function(n){var r=n.value/2;Yn(e,r,n.unit),Yn(t,r,n.unit)}))}function Zn(e){var t=e;return{get:function(){return t},set:function(e){t=e}}}function er(e){return{element:e,colspan:bt(e,"colspan",1),rowspan:bt(e,"rowspan",1)}}function tr(e){return h(e,t(0))}function nr(){function e(e,t,n,r,o){return r=Ao(e,0<=r?n:t,r,o),o=t,t=n+1,n=[r,-r],(r=tr)((e=e).slice(0,o)).concat(n).concat(r(e.slice(t)))}return{resizeTable:function(e,t,n){n&&e(t)},clampTableDelta:function(e,t,n,r,o){return o?0<=n?n:(o=C(e,(function(e,t){return e+t-r}),0),Math.max(-o,n)):Eo(e,t,n,r)},calcLeftEdgeDeltas:e,calcMiddleDeltas:function(t,n,r,o,i,a){return e(t,r,o,i,a)},calcRightEdgeDeltas:function(e,n,r,o,i,a){return a?tr(e):h(e,t(o/=e.length))},calcRedestributedWidths:function(e,t,n,r){return{delta:0,newSizes:e}}}}function rr(e,t){void 0===t&&(t=a);var n=e.grid,o=g(n.columns,r),i=g(n.rows,r);return h(o,(function(n){return _o((function(){return S(i,(function(t){return Jt.getAt(e,t,n).filter((function(e){return e.column===n})).toArray()}))}),(function(e){return 1===e.colspan&&t(e.element)}),(function(){return Jt.getAt(e,0,n)}))}))}function or(e,t){return void 0!==e?e:void 0!==t?t:0}function ir(e){var t=(i=e.dom.ownerDocument).body,n=i.defaultView,r=i.documentElement;if(t===e.dom)return No(t.offsetLeft,t.offsetTop);var o=or(null==n?void 0:n.pageYOffset,r.scrollTop),i=or(null==n?void 0:n.pageXOffset,r.scrollLeft);n=or(r.clientTop,t.clientTop),t=or(r.clientLeft,t.clientLeft);return Ro(e).translate(i-t,o-n)}function ar(e,t){return{row:e,y:t}}function cr(e,t){return{col:e,x:t}}function ur(e){return ir(e).left+zn(e)}function lr(e){return ir(e).left}function sr(e,t){return cr(e,lr(t))}function fr(e,t){return cr(e,ur(t))}function dr(e){return ir(e).top}function mr(e,t){return ar(e,dr(t))}function pr(e,t){return ar(e,dr(t)+Hn(t))}function gr(e,t,n){if(0===n.length)return[];var r=h(n.slice(1),(function(t,n){return t.map((function(t){return e(n,t)}))})),o=n[n.length-1].map((function(e){return t(n.length-1,e)}));return r.concat([o])}function hr(e,t){return ht(e,t).isSome()}function vr(e,t,n,r,o,i){return e.filter(r).fold((function(){return i(function(e,t){if(t<0||t>=e.length-1)return R.none();var n=e[t].fold((function(){return _(function(e){return(e=U.call(e,0)).reverse(),e}(e.slice(0,t)),(function(e,t){return e.map((function(e){return{value:e,delta:t+1}}))}))}),(function(e){return R.some({value:e,delta:0})})),r=e[t+1].fold((function(){return _(e.slice(t+1),(function(e,t){return e.map((function(e){return{value:e,delta:t+1}}))}))}),(function(e){return R.some({value:e,delta:1})}));return n.bind((function(e){return r.map((function(t){var n=t.delta+e.delta;return Math.abs(t.value-e.value)/n}))}))}(n,t))}),(function(e){return o(e)}))}function br(e,t,n,o,i){var a,c=rr(e,(function(e){return hr(e,"width")})),u=Jt.hasColumns(e)?(u=e,h(Jt.justColumns(u),(function(e){return R.from(e.element)}))):c,l=[R.some(Po(t))].concat(h(Io(c,t),(function(e){return e.map((function(e){return e.x}))}))),s=(a=wt,function(e){return!a(e)});return h(u,(function(e,t){return vr(e,t,l,s,(function(e){return!Bo(a=e)||hr(a,"width")?n(e,i):vr(a=(e=r,null!=(a=c[t])?e(a):R.none()),t,l,s,(function(e){return o(R.some(Un(e)))}),o);var a}),o)}))}function yr(e,t,n){return br(e,t,Xn,(function(e){return e.getOrThunk(n.minCellWidth)}),n)}function wr(e,t){var n=Zn(e),o=n.get;return{width:o,pixelWidth:o,getWidths:function(e,n){return yr(e,t,n)},getCellDelta:r,singleColumnWidth:function(e,t){return[Math.max(Wt(),e+t)-e]},minCellWidth:Wt,setElementWidth:qn,adjustTableWidth:function(e){e=o()+e,qn(t,e),n.set(e)},isRelative:!1,label:"pixel"}}function Cr(e,t){return Ue.fromDom(e.dom.cloneNode(t))}function xr(e,t,n,r){n===r?lt(e,t):it(e,t,n)}function Sr(e,t,n){A(t=pe(e,t),t.length-1).fold((function(){return Lt(e,n)}),(function(e){return Mt(e,n)}))}function kr(e,t){function n(e){return h(e,(function(e){e.isNew&&a.push(e.element);var t=e.element;return jt(t),v(e.cells,(function(e){e.isNew&&c.push(e.element),xr(e.element,"colspan",e.colspan,1),xr(e.element,"rowspan",e.rowspan,1),Yt(t,e.element)})),t}))}function r(e){return S(e,(function(e){return h(e.cells,(function(e){return xr(e.element,"span",e.colspan,1),e.element}))}))}function o(t,o){var i,a,c=(jt(c=tt(i=e,a=o).getOrThunk((function(){var e=Ue.fromTag(a,ce(i).dom);return"thead"===a?Sr(i,"caption,colgroup",e):"colgroup"===a?Sr(i,"caption",e):Yt(i,e),e}))),c);Ft(c,t=("colgroup"===o?r:n)(t))}function i(t,n){0<t.length?o(t,n):tt(e,n).each(Qt)}var a=[],c=[],u=[],l=[],s=[],f=[];return v(t,(function(e){switch(e.section){case"thead":u.push(e);break;case"tbody":l.push(e);break;case"tfoot":s.push(e);break;case"colgroup":f.push(e)}})),i(f,"colgroup"),i(u,"thead"),i(l,"tbody"),i(s,"tfoot"),{newRows:a,newCells:c}}function Tr(e,t,n){var r=e.origin();v(t,(function(t){t.each((function(t){pn(t=n(r,t),Lo),Yt(e.parent(),t)}))}))}function Er(e,t,n,r,o){var i,a=ir(n),c=t.isResizable,u=0<(r=0<r.length?Do(r,n):[]).length?(i=c,S(e.all,(function(e,t){return i(e.element)?[t]:[]}))):[];!function(e,t,n,r){Tr(e,t,(function(e,t){var o,i,a,c;return pn(e=(o=t.row,i=n.left-e.left,a=t.y-e.top,c=r,t=7,pt(e=Ue.fromTag("div"),{position:"absolute",left:i+"px",top:a-t/2+"px",height:t+"px",width:c+"px"}),at(e,{"data-row":o,role:"presentation"}),e),Fo),e}))}(t,r=b(r,(function(e,t){return p(u,(function(e){return t===e}))})),a,zn(n));var l,s,f,d=0<(o=0<o.length?Io(o,n):[]).length?(s=c,f=[],g((l=e).grid.columns,(function(e){Jt.getColumnAt(l,e).map((function(e){return e.element})).forall(s)&&f.push(e)})),b(f,(function(e){return k(Jt.filterItems(l,(function(t){return t.column===e})),(function(e){return s(e.element)}))}))):[];!function(e,t,n,r){Tr(e,t,(function(e,t){var o,i,a;return pn(e=(o=t.col,i=t.x-e.left,a=n.top-e.top,7,t=r,pt(e=Ue.fromTag("div"),{position:"absolute",left:i-3.5+"px",top:a+"px",height:t+"px",width:"7px"}),at(e,{"data-column":o,role:"presentation"}),e),jo),e}))}(t,o=b(o,(function(e,t){return p(d,(function(e){return t===e}))})),a,Hn(n))}function Ar(e,t){if(0===e.length)return 0;var n=e[0];return function(e,t){for(var n=0,r=e.length;n<r;n++)if(t(e[n]))return R.some(n);return R.none()}(e,(function(e){return!t(n.element,e.element)})).fold((function(){return e.length}),(function(e){return e}))}function _r(e,t){var n=h(e,(function(e){return h(e.cells,i)}));return h(e,(function(r,o){return{details:S(r.cells,(function(r,i){if(!1!==n[o][i])return[];var a=function(e,t,n,r){var o;return{colspan:Ar(e[t].cells.slice(n),r),rowspan:Ar(t=(o=n,h(e,(function(e){return At(e,o)})).slice(t)),r)}}(e,o,i,t);return function(e,t,r,o){for(var i=e;i<e+r;i++)for(var a=t;a<t+o;a++)n[i][a]=!0}(o,i,a.rowspan,a.colspan),[{element:r.element,rowspan:a.rowspan,colspan:a.colspan,isNew:r.isNew}]})),section:r.section}}))}function Nr(e,t){return h(e,(function(e){var n;return{element:(n=_(n=e.details,(function(e){return le(e.element).map((function(e){return re(e,le(e).isNone(),!1)}))})).getOrThunk((function(){return re(t.row(),!0,!1)}))).element,cells:e.details,section:e.section,isNew:n.isNew}}))}function Rr(e,t){return _(e.all,(function(e){return x(e.cells,(function(e){return Y(t,e.element)}))}))}function Dr(e,t,n){var r=h(t.selection,(function(t){return xt(t).bind((function(t){return Rr(e,t)})).filter(n)}));t=function(e){for(var t=[],n=function(e){t.push(e)},r=0;r<e.length;r++)e[r].each(n);return t}(r);return r=0<t.length,t=t,r?R.some(t):R.none()}function Or(e,n,o,i,a){return function(c,u,l,s,f,d){var m=Jt.fromTable(u);return n(m,l).map((function(t){var n=function(e,t){return function(e,t,n){var r,o=[];Jt.hasColumns(e)&&(r=h(Jt.justColumns(e),(function(e){return re(e.element,!1,!1)})),o.push(oe(r,"colgroup")));for(var i=0;i<e.grid.rows;i++){for(var a=[],c=0;c<e.grid.columns;c++){var u=Jt.getAt(e,i,c).map((function(e){return re(e.element,!1,e.isLocked)})).getOrThunk((function(){return re(t.gap(),!0,!1)}));a.push(u)}var l=oe(a,e.all[i].section);o.push(l)}return o}(e,t)}(m,s),r=e(n,t,Y,a(s));n=function(e){return E(e=Z(e=C(Nt(e).rows,(function(e,t){return v(t.cells,(function(t,n){t.isLocked&&(e[n]=!0)})),e}),{}),(function(e,t){return parseInt(t,10)})))}(r.grid);return{info:t,grid:function(e,t){return Nr(e=_r(e,Y),t)}(r.grid,s),cursor:r.cursor,lockedColumns:n}})).bind((function(e){var n=kr(u,e.grid),a=R.from(f).getOrThunk((function(){return Mo(u)})),l=R.from(d).getOrThunk(nr);return o(u,e.grid,e.info,a,l),i(u),function(e,n){var o,i,a,c,u;!function(e){v(e=ge(e.parent(),"."+Lo),Qt)}(e),e.isResizable(n)&&(o=Jt.fromTable(n),c=g((a=(i=o).grid).rows,r),u=g(a.columns,r),Er(o,e,n,a=h(c,(function(e){return _o((function(){return S(u,(function(n){return Jt.getAt(i,e,n).filter((function(t){return t.row===e})).fold(t([]),(function(e){return[e]}))}))}),(function(e){return 1===e.rowspan}),(function(){return Jt.getAt(i,e,0)}))})),c=rr(o)))}(c,u),lt(u,Kt),0<e.lockedColumns.length&&it(u,Kt,e.lockedColumns.join(",")),R.some({cursor:e.cursor,newRows:n.newRows,newCells:n.newCells})}))}}function Ir(e,t){return xt(t.element).bind((function(t){return Rr(e,t)}))}function Pr(e,t){return Dr(e,t,a)}function Br(e,t){return Dr(e,t,(function(e){return!e.isLocked}))}function Mr(e){return function(e){return e=e,Zt.getOption(e).filter((function(e){return 0!==e.trim().length||-1<e.indexOf("")})).isSome()}(e)||m(Ho,ie(e))}function Lr(){var e=Ue.fromTag("td");return Yt(e,Ue.fromTag("br")),e}function Fr(){return Ue.fromTag("colgroup")}function jr(e,t,n){var r=function(e,t){return Ft(t=function(e,t){return at(t=Ue.fromTag(t),e=st(e)),t}(e,t),e=de(Cr(e,!0))),t}(e,t);return Q(n,(function(e,t){null===e?lt(r,t):it(r,t,e)})),r}function Hr(e,t,n){return function(e){return t=Mr,(n=function(e){for(var r=0;r<e.childNodes.length;r++){var o=Ue.fromDom(e.childNodes[r]);if(t(o))return R.some(o);if((o=n(e.childNodes[r])).isSome())return o}return R.none()})(e.dom);var t,n}(e).map((function(r){return w(function(e,t,n){return r=function(e){return J(e,t)},b(se(e,n),r);var r}(r,n.join(","),(function(t){return Y(t,e)})),(function(e,t){return lt(t=Cr(t,!1),"contenteditable"),Yt(e,t),t}),t)})).getOr(t)}function Ur(e,t,n){function r(e,t){!function(e,t){e=e.dom,t=t.dom,ft(e)&&ft(t)&&(t.style.cssText=e.style.cssText)}(e.element,t),vt(t,"height"),1!==e.colspan&&vt(t,"width")}var o;return{col:function(t){var n=ce(t.element);return r(t,n=Ue.fromTag(ie(t.element),n.dom)),e(t.element,n),n},colgroup:Fr,row:(o=t,function(){return Ue.fromTag("tr",o.dom)}),cell:function(t){var o,i,a=ce(t.element),c=Ue.fromTag(ie(t.element),a.dom);a=0<(a=n.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"])).length?Hr(t.element,c,a):c;return Yt(a,Ue.fromTag("br")),r(t,c),o=t.element,i=c,Q(Uo,(function(e,t){return ut(o,t).filter((function(t){return m(e,t)})).each((function(e){return it(i,t,e)}))})),e(t.element,c),c},replace:jr,gap:Lr}}function zr(e){return Jt.fromTable(e).grid}function Wr(e,t,n,r,o){return h(e,(function(e){var i=0<t&&t<e.cells.length&&r(_t(e,t-1),_t(e,t));i=function(e,t,n,r,o,i,a){return"colgroup"!==n&&r?At(e,t):re(a((o=At(e,o)).element,i),!0,!1)}(e,t,e.section,i,n,r,o);return function(e,t,n){return r=t,o=[n],e=(n=(t=e).cells).slice(0,r),r=n.slice(r),r=e.concat(o).concat(r),$t(t,r);var r,o}(e,t,i)}))}function Vr(e,t,n,r){return h(e,(function(e){return i=function(e){return o=e,p(t,(function(e){return n(o.element,e.element)}))?re(r(e.element,n),!0,e.isLocked):e;var o},oe(i=h(e=(o=e).cells,i),o.section);var o,i}))}function qr(e,t,n,r){return void 0!==_t(e[t],n)&&0<t&&r(_t(e[t-1],n),_t(e[t],n))}function $r(e,t,n){return 0<t&&n(_t(e,t-1),_t(e,t))}function Kr(e,t,n,r){var o=S(o=Nt(e).rows,(function(r,o){return qr(e,o,t,n)||$r(r,t,n)?[]:[At(r,t)]}));return Vr(e,o,n,r)}function Gr(e,t,n,r){var o=Nt(e).rows,i=o[t];return Vr(e,S(i.cells,(function(e,r){return qr(o,t,r,n)||$r(i,r,n)?[]:[e]})),n,r)}function Jr(e,t,n){v(t=function(e,t){return(Jt.hasColumns(e)?function(e,t){return h(e=Jt.justColumns(e),(function(e,n){return{element:e.element,width:t[n],colspan:e.colspan}}))}:function(e,t){return h(e=Jt.justCells(e),(function(e){var n=function(e,t,n){for(var r=0,o=e;o<t;o++)r+=void 0!==n[o]?n[o]:0;return r}(e.column,e.column+e.colspan,t);return{element:e.element,width:n,colspan:e.colspan}}))})(e,t)}(e,t),(function(e){n.setElementWidth(e.element,e.width)}))}function Xr(e){return C(e,(function(e,t){return p(e,(function(e){return e.column===t.column}))?e:e.concat([t])}),[]).sort((function(e,t){return e.column-t.column}))}function Yr(e,t){return{grid:e,cursor:t}}function Qr(e,t,n){var r=Nt(e).rows;return Yr(e,Vo(r,t,n))}function Zr(e){return C(e,(function(e,t){return p(e,(function(e){return e.row===t.row}))?e:e.concat([t])}),[]).sort((function(e,t){return e.row-t.row}))}function eo(e,t){return p(t,(function(e){return 0===e.column&&e.isLocked}))}function to(e,t){var n=rr(e);return C(t=Xr(t),(function(e,t){return e+n[t.column].map(zn).getOr(0)}),0)}function no(e){return e.dom.textContent}function ro(e,t,n){return{value:t+1}}function oo(e,t,n){for(var r="A".charCodeAt(0),o=[],i=t;0<=i;)o.push(String.fromCharCode(r+i%26)),i=Math.floor(i/26)-1;return{value:o.reverse().join("")}}function io(e){return e=parseFloat(e),isNaN(e)?R.none():R.some(e)}function ao(e,t){return e<t?-1:t<e?1:0}function co(e,t){return hn(io(e),io(t),ao).getOrThunk((function(){return n=t,e.localeCompare(n);var n}))}function uo(n,o){function i(e,r,i,c){return function(u,l){bn(u);var s,f,d=(s=(m=o().resizeHandler.lazyWire()).parent(),d=m.view(),f=m.origin(),j(s.dom)?{origin:t(V(V({},f),{left:f.left(),top:f.top()})),parent:t(V(V({},s),{dom:s.dom()})),view:t(V(V({},d),{dom:d.dom()})),isResizable:a}:m),m=Ue.fromDom(n.getDoc());m=Ur(i,m,W);return r(u)?e(d,u,l,m).bind((function(e){return v(e.newRows,(function(e){var t;t=n,e=e.dom,t.fire("newrow",{node:e})})),v(e.newCells,(function(e){var t;t=n,e=e.dom,t.fire("newcell",{node:e})})),e.cursor.map((function(e){var t=n.dom.createRng();return t.setStart(e.dom,0),t.setEnd(e.dom,0),{rng:t,effect:c}}))})):R.none()}}function c(e,t,n){return{grid:e,cursor:(e=e,t=t,r=n,R.from(e[t]).bind((function(e){return R.from(e.cells[r]).bind((function(e){return R.from(e.element)}))})))};var r}function u(e,t,n,r){return S(e=h(e=y(e,(function(e){return e.section})),(function(e){return y(e,(function(e){return ie(At(e,t).element)}))})),(function(e){return S(e,(function(e){return"th"===ie(At(e[0],t).element)?e:function(e){return e=h(e,(function(e){var n=At(e,t);return{row:e,text:R.from(no(n.element)).getOr("")}})),h(e=E(e,(function(e,t){return t=n(e.text,t.text),r?t:-1*t})),(function(e){return e.row}))}(e)}))}))}function l(e,t,n,r){var o=e[t].cells,i=h(o,(function(e){return R.from(no(e.element)).getOr("")}));e=h(e,(function(e){return{zippedCells:h(e.cells,(function(e,t){return{cell:e,reference:o[t],referenceText:i[t]}})),section:e.section}}));return h(e,(function(e){return oe(h(S(y(e.zippedCells,(function(e){return ie(e.reference.element)})),(function(e){return"th"===ie(e[0].reference.element)?e:E(e,(function(e,t){return t=n(e.referenceText,t.referenceText),r?t:-1*t}))})),(function(e){return e.cell})),e.section)}))}function s(e,t,n,r,o){var i=e.slice(0,t);t=e.slice(t,n+1);return{beforeRows:i,afterRows:e.slice(n+1,e.length),selectionGridBefore:t.map((function(e){return{cells:e.cells.slice(0,r),section:e.section}})),selectionGrid:t.map((function(e){return{cells:e.cells.slice(r,o+1),section:e.section}})),selectionGridAfter:t.map((function(e){return{cells:e.cells.slice(o+1,e.cells.length),section:e.section}}))}}function f(e,t){return t=h(t,(function(t,n){var r=e.selectionGridBefore[n].cells;n=e.selectionGridAfter[n].cells;return{cells:r.concat(t.cells).concat(n),section:t.section}})),e.beforeRows.concat(t).concat(e.afterRows)}function d(e,t,n,r,o,i,a,c){return f(i=s(e,n,r,o,i),c=u(i.selectionGrid,t-o,a,c))}function m(e,t,n,r,o,i,a,c){return f(i=s(e,n,r,o,i),c=l(i.selectionGrid,t-n,a,c))}function g(e){return C(e,(function(e,t){return p(e,(function(e){return e.row===t.row}))?e:e.concat([t])}),[]).sort((function(e,t){return e.row-t.row}))}function b(e){return C(e,(function(e,t){return p(e,(function(e){return e.column===t.column}))?e:e.concat([t])}),[]).sort((function(e,t){return e.column-t.column}))}function w(e){return C(e,(function(e,t){return p(e,(function(e){return Y(e.element,t.element)}))?e:e.concat([t])}),[])}function x(e){return q(P(e.attributes)?Z(e.attributes,(function(e,t){return M(e)?function(e){return lt(e,t)}:function(n){return it(n,t,e)}})):[],function(e,t){if(B(e)){for(var n=0,r=e.length;n<r;++n)if(!t(e[n]))return!1;return!0}return!1}(e.classes,I)?h(e.classes,(function(e){return function(t){return pn(t,e)}})):[],[function(t){var n=no(t)||"",r=(r=e.value,H(r)?String(r):I(r)?r:void 0);0<(n=I(r)?r:n).length?(n=n,t.dom.textContent=n):function(e,t){var n=ce(e).dom,r=Ue.fromDom(n.createDocumentFragment());Ft(r,n=function(e,t){return(t=(t||document).createElement("div")).innerHTML=e,de(Ue.fromDom(t))}(t,n)),jt(e),Yt(e,r)}(t,"<br>")}])}function k(e,t,n,r,o,i){var a;v(t,(function(t,c){var u=t.element;t={rowType:i(c).section,cellType:ie(u),classes:gn(u),prev:null==a?void 0:a.raw,direction:n};v(c=x(t=e(t,r(c),o(c))),(function(e){return e(u)})),a=t}))}function T(e,t,n,r,o){return c(r=d(e,o,0,e.length,o,o,n,r),t[0].row,t[0].column)}function A(e,t,n,r,o){var i=g(t),a=b(t);return c(r=d(e,o,i[0].row,i[i.length-1].row,a[0].column,a[a.length-1].column,n,r),t[0].row,t[0].column)}function _(e,t,n,r,o){return c(r=$(e,o,n,r),t.row,t.column)}function N(e,t,n,r,o){return c(r=m(e,o,o,o,0,e[t[0].row].cells.length,n,r),t[0].row,t[0].column)}function D(e,t,n,r,o){var i=g(t),a=b(t);return c(r=m(e,o,i[0].row,i[i.length-1].row,a[0].column,a[a.length-1].column,n,r),t[0].row,t[0].column)}function O(e,t,n,r,o){return c(r=K(e,o,n,r),t.row,t.column)}function L(e,n,o,i){var a=Nt(e).rows;return k(o,w(h(a,(function(e){return At(e,i)}))),"column",r,t(i),(function(e){return a[e]})),c(e,n.row,n.column)}function F(e,n,o,i){var a=Nt(e).rows[i];return k(o,w(a.cells),"row",t(i),r,t(a)),c(e,n.row,n.column)}function U(t,n,r,o,i){return function(a,c,u,l){return Or((function(e,i){return t(e,i,n,r,o)}),i,e,e,To)(a,c,u,l)}}function z(t,n,r,o){return function(i,a,c,u){return Or((function(e,o){return t(e,o,n,r)}),o,e,e,To)(i,a,c,u)}}var W=function(e){return e=e.getParam("table_clone_elements"),I(e)?R.some(e.split(/[ ,]/)):Array.isArray(e)?R.some(e):R.none()}(n),$=u,K=l;return{sortColumnRowsAsc:function(t){return i(U(T,co,!0,t,Pr),a,e,On)},sortColumnRowsDesc:function(t){return i(U(T,co,!1,t,Pr),a,e,On)},sortSelectionRowsAsc:function(t){return i(U(A,co,!0,t,Pr),a,e,On)},sortSelectionRowsDesc:function(t){return i(U(A,co,!1,t,Pr),a,e,On)},sortTableRowsAsc:function(t){return i(U(_,co,!0,t,Ir),a,e,On)},sortTableRowsDesc:function(t){return i(U(_,co,!1,t,Ir),a,e,On)},sortRowColumnsAsc:function(t){return i(U(N,co,!0,t,Pr),a,e,On)},sortRowColumnsDesc:function(t){return i(U(N,co,!1,t,Pr),a,e,On)},sortSelectionColumnsAsc:function(t){return i(U(D,co,!0,t,Pr),a,e,On)},sortSelectionColumnsDesc:function(t){return i(U(D,co,!1,t,Pr),a,e,On)},sortTableColumnsAsc:function(t){return i(U(O,co,!0,t,Ir),a,e,On)},sortTableColumnsDesc:function(t){return i(U(O,co,!1,t,Ir),a,e,On)},insertColumnBefore:i(qo,a,Qn,On),deleteColumn:i($o,(function(e){return 0==("table"===ie(vn(n)))||1<zr(e).columns}),e,On),populateColumn:function(t,n){return i(z(L,n,t,Ir),a,e,Dn)},populateRow:function(t,n){return i(z(F,n,t,Ir),a,e,Dn)}}}function lo(e){return ut(e,Ko)}function so(e){var n,r,o,i=Mo(e),a=Jt.fromTable(e),c=Jt.getAt(a,0,0).bind((function(e){return jn(gt(e.element,"width"),["fixed"])})).map((function(e){return 28-e.value})).getOr(0);n=e,r=c,a=0,e=nr(),c=i,i=Jt.fromTable(n),n=c.getCellDelta(r),o=c.getWidths(i,c),r=a===i.grid.columns-1,n=e.clampTableDelta(o,a,n,c.minCellWidth(),r),a=function(e,n,r,o,i){var a=e.slice(0);return n=n,e=0===(e=e).length?Wo.none():1===e.length?Wo.only(0):0===n?Wo.left(0,1):n===e.length-1?Wo.right(n-1,n):0<n&&n<e.length-1?Wo.middle(n-1,n,n+1):Wo.none(),n=t(h(a,t(0))),e.fold(n,(function(e){return o.singleColumnWidth(a[e],r)}),(function(e,t){return i.calcLeftEdgeDeltas(a,e,t,r,o.minCellWidth(),o.isRelative)}),(function(e,t,n){return i.calcMiddleDeltas(a,e,t,n,r,o.minCellWidth(),o.isRelative)}),(function(e,t){return i.calcRightEdgeDeltas(a,e,t,r,o.minCellWidth(),o.isRelative)}))}(o,a,n,c,e),Jr(i,a=h(a,(function(e,t){return e+o[t]})),c),e.resizeTable(c.adjustTableWidth,n,r)}function fo(e,t){var n=function e(t){var n,r=[];return F(t)?r:("thead"===(n=t).name||"tbody"===n.name||"tfoot"===n.name?r.push.apply(r,e(t.firstChild)):"tr"===t.name&&r.push(t),r.concat(e(t.next)))};e.parser.addAttributeFilter(Ko,(function(e){for(var r=0,o=e;r<o.length;r++){var i=o[r];if("table"===i.name){var a=i.attr(Ko);if(!1===(null===(a=t[a])||void 0===a?void 0:a.resizable))for(var c=0,u=n(i.firstChild);c<u.length;c++){var l=u[c];d(l.firstChild)&&l.firstChild.attr("data-mce-resize","false")}}}}))}function mo(e){return function(t){var n=t.getData();t.close(),e.undoManager.transact((function(){e.execCommand("mceSortTableAdvanced",!1,n),e.focus(),e.addVisual()}))}}function po(e,t){function n(t){var n;return{type:"selectbox",name:"roworcol",label:"column"===t?"Column":"Row",items:"column"===t?function(){var t=a.get().getOrDie("state must be present");return g(t.limit?t.finishCol+1-t.startCol:t.columns,(function(n){var r=t.limit?t.startCol:0,o=function(e){for(var t=e,n="";0<Math.floor(t);)--t,n+=String.fromCharCode("A".charCodeAt(0)+t%26),t/=26;return n.split("").reverse().join("")}(n+r+1);return{text:e.translate(["Column {0}",o]),value:""+(n+r)}}))}():(n=a.get().getOrDie("state must be present"),t=n.limit?n.finishRow+1-n.startRow:n.rows,g(t,(function(t){var r=n.limit?n.startRow:0,o=(t+r+1).toString();return{text:e.translate(["Row {0}",o]),value:""+(t+r)}})))}}function r(e){return{title:"Advanced Sort",size:"normal",body:{type:"panel",items:[{type:"grid",columns:2,items:[i,n(e=e),{type:"selectbox",name:"sort",label:"Sort",items:["column"===e?{text:"Column",value:"column"}:{text:"Row",value:"row"},{text:"Selection",value:"selection"},{text:"Table",value:"table"}]},c]}]},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"sort",text:"Sort",primary:!0}]}}function o(){a.set(R.none())}var i={type:"selectbox",name:"sortby",label:"Sort by",items:[{text:"Column",value:"column"},{text:"Row",value:"row"}]},a=Zn(R.none()),c={type:"selectbox",name:"order",label:"Order",items:[{text:"Ascending",value:"ascending"},{text:"Descending",value:"descending"}]},u=function t(n,i){var c;"sortby"===i.name&&(c=n.getData(),i=a.get().getOrDie("state must be present"),i={roworcol:"column"===c.sortby?""+i.startCol:""+i.startRow},i=V(V({},c),i),i=V(V({},r(c.sortby)),{onChange:t,onClose:o,onSubmit:mo(e),initialData:i}),n.redial(i),n.focus("sortby"))};Pn(e).each((function(n){Sn(n,e).each((function(i){function c(t){a.set(R.some(t)),t={sortby:"column",roworcol:""+t.startCol,sort:"column",order:"ascending"},t=V(V({},r("column")),{onChange:u,onClose:o,onSubmit:mo(e),initialData:t}),e.windowManager.open(t)}var l=Cn(t,i,n),s=zr(i);l.mergable.fold((function(){Pt(i,n,n).each((function(e){c(e=V(V(V({},e),s),{limit:!1}))}))}),(function(e){c(e=V(V(V({},e.bounds),s),{limit:!0}))}))}))}))}function go(e,t,n,r,o){function i(e){return"selection"===e}function a(e){return"ascending"===e}function c(){return Pn(e).bind((function(t){return Sn(t,e).bind((function(e){return Pt(e,t,t).map((function(e){return e.startCol}))}))}))}function u(){return Pn(e).bind((function(t){return Sn(t,e).bind((function(e){return Pt(e,t,t).map((function(e){return e.startRow}))}))}))}e.addCommand("mceSortTableByColumnAsc",(function(){c().each((function(e){r.selection(t.sortTableRowsAsc(e))}))})),e.addCommand("mceSortTableByColumnDesc",(function(){c().each((function(e){r.selection(t.sortTableRowsDesc(e))}))})),e.addCommand("mceSortTableByRowAsc",(function(){u().each((function(e){r.selection(t.sortTableColumnsAsc(e))}))})),e.addCommand("mceSortTableByRowDesc",(function(){u().each((function(e){r.selection(t.sortTableColumnsDesc(e))}))})),e.addCommand("mceSortTableAdvanced",(function(e,n){return function(e){var n,o,c=parseInt(e.roworcol,10);"column"===e.sortby?(o=c,"column"===(n=e).sort?a(n.order)?r.selection(t.sortColumnRowsAsc(o)):r.selection(t.sortColumnRowsDesc(o)):i(n.sort)?a(n.order)?r.selection(t.sortSelectionRowsAsc(o)):r.selection(t.sortSelectionRowsDesc(o)):a(n.order)?r.selection(t.sortTableRowsAsc(o)):r.selection(t.sortTableRowsDesc(o))):(c=c,"row"===(e=e).sort?a(e.order)?r.selection(t.sortRowColumnsAsc(c)):r.selection(t.sortRowColumnsDesc(c)):i(e.sort)?a(e.order)?r.selection(t.sortSelectionColumnsAsc(c)):r.selection(t.sortSelectionColumnsDesc(c)):a(e.order)?r.selection(t.sortTableColumnsAsc(c)):r.selection(t.sortTableColumnsDesc(c)))}(n)})),e.addCommand("mceAdvancedTableSort",(function(){return po(e,n)})),sn(tinymce,"5.7.0")||e.addCommand("mceTableToggleSeries",(function(n,i){var a,c,u=(a=R.from(i.name).filter(I)).bind((function(e){return ee(o,e)})),l=(c=Pn(e).bind((function(t){return Sn(t,e)}))).bind(lo);i=u,u=c,c=function(e,n,o){l.fold((function(){var i,a,c,u,l;i=o,a=t,u=e,l=n,(c=r).column(0,a.insertColumnBefore,!0,!1),so(i),Jo(i,a,c,u,l)}),(function(i){i.toLowerCase()===e.toLowerCase()?function(e,t,n){lt(e,Go),lt(e,Ko),n.column(0,t.deleteColumn,!0,!1)}(o,t,r):Jo(o,t,r,e,n)}))},(a=a).isSome()&&i.isSome()&&u.isSome()?R.some(c(a.getOrDie(),i.getOrDie(),u.getOrDie())):R.none()}))}var ho,vo,bo,yo=(O=function(e,t){function n(n){var r=t(n);return r<=0||null===r?(n=gt(n,e),parseFloat(n)||0):r}function r(e,t){return C(t,(function(t,n){return n=void 0===(n=gt(e,n))?0:parseInt(n,10),isNaN(n)?t:t+n}),0)}return{set:function(t,n){if(!H(n)&&!n.match(/^[0-9]+$/))throw new Error(e+".set accepts only positive integer values. Value was "+n);ft(t=t.dom)&&(t.style[e]=n+"px")},get:n,getOuter:n,aggregate:r,max:function(e,t,n){return(n=r(e,n))<t?t-n:0}}})("height",(function(e){var t=e.dom;return Qe(e)?t.getBoundingClientRect().height:t.offsetHeight})),wo=O("width",(function(e){return e.dom.offsetWidth})),Co=/(\d+(\.\d+)?)%/,xo=/(\d+(\.\d+)?)px|em/,So=t(Co),ko=t(xo),To=function(e,t){function n(n){return"col"!==ie((n=n=t(n)).element)?e.cell(n):e.col(n)}function r(e){var t=n(e);return o.get().isNone()&&o.set(R.some(t)),i=R.some({item:e,replacement:t}),t}void 0===t&&(t=er);var o=Zn(R.none()),i=R.none();return{getOrInit:function(e,t){return i.fold((function(){return r(e)}),(function(n){return t(e,n.item)?n.replacement:r(e)}))},cursor:o.get}},Eo=(c=function(e,t){return function(n){function r(r){var a=n.replace(r,t,{scope:e});return i.push({item:r,sub:a}),o.get().isNone()&&o.set(R.some(a)),a}var o=Zn(R.none()),i=[];return{replaceOrInit:function(e,t){return"col"===ie(e)?e:(n=e,o=t,x(i,(function(e){return o(e.item,n)})).fold((function(){return r(e)}),(function(n){return t(e,n.item)?n.sub:r(e)})));var n,o},cursor:o.get}}},(O=function(e){return function(t,n,r,o){return e(r)?(o=Math.max(o,t[n]-Math.abs(r)),n=Math.abs(o-t[n]),0<=r?n:-n):r}})((function(e){return e<0}))),Ao=O(a),_o=function(e,t,n){var r=e();return x(r,t).orThunk((function(){return R.from(r[0]).orThunk(n)})).map((function(e){return e.element}))},No=function e(t,n){return{left:t,top:n,translate:function(r,o){return e(t+r,n+o)}}},Ro=function(e){var t=e.dom,n=t.ownerDocument.body;return n===t?No(n.offsetLeft,n.offsetTop):Qe(e)?function(e){return e=e.getBoundingClientRect(),No(e.left,e.top)}(t):No(0,0)},Do=function(e){return gr(mr,pr,e)},Oo=(ho={delta:r,edge:lr,positions:function(e){return gr(sr,fr,e)}},vo={delta:function(e){return-e},edge:ur,positions:function(e){return gr(fr,sr,e)}},function(e){return"rtl"===function(e){return"rtl"===gt(e,"direction")?"rtl":"ltr"}(e)?vo:ho}),Io=function(e,t){return Oo(t).positions(e,t)},Po=function(e){return Oo(e).edge(e)},Bo=("col",function(e){return Ke(e)&&"col"===ie(e)}),Mo=function(n){return Kn(n).fold((function(){return function(n){function r(){return Un(n)}var o=t(0);return{width:r,pixelWidth:r,getWidths:function(e,t){return yr(e,n,t)},getCellDelta:o,singleColumnWidth:t([0]),minCellWidth:o,setElementWidth:e,adjustTableWidth:e,isRelative:!0,label:"none"}}(n)}),(function(e){return function(e,t){var n=So().exec(t);if(null!==n)return function(e,t){var n=Zn(parseFloat(e)),r=Zn(Un(t));return{width:n.get,pixelWidth:r.get,getWidths:function(e,n){return br(e,t,Jn,(function(e){return e.fold((function(){return r.minCellWidth()}),(function(e){return e/r.pixelWidth()*100}))}),r=n);var r},getCellDelta:function(e){return e/r.get()*100},singleColumnWidth:function(e,t){return[100-e]},minCellWidth:function(){return Wt()/r.get()*100},setElementWidth:$n,adjustTableWidth:function(e){var o=n.get();$n(t,o=o+e/100*o),n.set(o),r.set(Un(t))},isRelative:!0,label:"percent"}}(n[1],e);if(null!==(t=ko().exec(t))){var r=parseInt(t[1],10);return wr(r,e)}return wr(r=Un(e),e)}(n,e)}))},Lo=(O=(bo="ephox-snooker".replace(/\./g,"-"),{resolve:function(e){return bo+"-"+e}}).resolve)("resizer-bar"),Fo=O("resizer-rows"),jo=O("resizer-cols"),Ho=(O=function(e,t){return Ir(e,t).filter((function(e){return!e.isLocked}))},["img","br"]),Uo={scope:["row","col"]},zo=zo([{none:[]},{only:["index"]},{left:["index","next"]},{middle:["prev","index","next"]},{right:["prev","index"]}]),Wo=V({},zo),Vo=function(e,t,n){return R.from(e[t]).bind((function(e){return R.from(e.cells[n]).bind((function(e){return R.from(e.element)}))}))},qo=Or((function(e,t,n,r){var o=t.detail,i=o.column;return Qr(r=Wr(e,t=o.column,i,n,r.getOrInit),o.row,t)}),(!0,function(e,t){return Ir(e,t).filter((function(e){return!eo(0,[e])})).map((function(t){return{detail:t,pixelDelta:to(e,[t])}}))}),zo=function(e,t,n,r,o){var i=Jt.generate(t),a=r.getWidths(i,r);t=r.pixelWidth(),n=(t=o.calcRedestributedWidths(a,t,n.pixelDelta,r.isRelative)).newSizes,t=t.delta;Jr(i,n,r),r.adjustTableWidth(t)},e,To),$o=Or((function(e,t,n,r){var o,i,a,c=Xr(t.details);return Yr(t=(i=e,o=h(c,(function(e){return e.column})),S(i,(function(e){var t=e.cells;return 0<(t=w(o,(function(e,t){return 0<=t&&t<e.length?e.slice(0,t).concat(e.slice(t+1)):e}),t)).length?[oe(t,e.section)]:[]}))),c=(e=t,i=c[0].row,c=c[0].column,a=Nt(e).rows,Vo(a,i,c).orThunk((function(){return Vo(a,0,0)}))))}),(function(e,t){return Br(e,t).map((function(t){return{details:t,pixelDelta:-to(e,t)}}))}),zo,(function(e){0===St(e).length&&Qt(e)}),To),Ko=(Or((function(e,t,n,r){return Qr(r=Kr(e,t.column,n,r.replaceOrInit),t.row,t.column)}),O,e,e,c("row","th")),Or((function(e,t,n,r){return Qr(e=C(Xr(t),(function(e,t){return Kr(e,t.column,n,r.replaceOrInit)}),e),t[0].row,t[0].column)}),Br,e,e,c("row","th")),Or((function(e,t,n,r){return Qr(r=Kr(e,t.column,n,r.replaceOrInit),t.row,t.column)}),O,e,e,c(null,"td")),Or((function(e,t,n,r){return Qr(e=C(Xr(t),(function(e,t){return Kr(e,t.column,n,r.replaceOrInit)}),e),t[0].row,t[0].column)}),Br,e,e,c(null,"td")),Or((function(e,t,n,r){return Qr(r=Gr(e,t.row,n,r.replaceOrInit),t.row,t.column)}),Ir,e,e,c("col","th")),Or((function(e,t,n,r){return Qr(e=C(Zr(t),(function(e,t){return Gr(e,t.row,n,r.replaceOrInit)}),e),t[0].row,t[0].column)}),Pr,e,e,c("col","th")),Or((function(e,t,n,r){return Qr(r=Gr(e,t.row,n,r.replaceOrInit),t.row,t.column)}),Ir,e,e,c(null,"td")),Or((function(e,t,n,r){return Qr(e=C(Zr(t),(function(e,t){return Gr(e,t.row,n,r.replaceOrInit)}),e),t[0].row,t[0].column)}),Pr,e,e,c(null,"td")),"data-snooker-col-series"),Go="data-snooker-locked-cols",Jo=function(e,t,n,r,o){n.table(e,0,0,t.populateColumn(0,(function(e,t,n){return{raw:n=o.generator(e,t,n),value:n.value,classes:n.classes,attributes:V(V({contenteditable:"false"},n.attributes),{"data-mce-resize":!1===o.resizable?"false":null})}})),!0,!1),it(e,Ko,r),it(e,Go,0)};tinymce.PluginManager.add("advtable",(function(t){var n,o,i,a,c,u,l,s,f,d,p,g;return sn(tinymce,"5.1.2")?console.error("Please use Advanced Tables with TinyMCE 5.1.2 or later."):("table",m(t.getParam("plugins","","string").split(/[ ,]/),"table")?(o=uo(t,n=function(){return t.plugins.table}),d=function(){return vn(t)},p=function(){return Bn(t)},g=In.selectedSelector,a=function(t,n){function o(e,n){return void 0===n&&(n=!0),function(r){var o,i;t.selection.setRng(r.rng),t.focus(),c.clear(e),bn(e),n&&(o=t,i=e.dom,r=r.effect,o.fire("TableModified",V(V({},r),{table:i})))}}function i(e){var n=t.dom.createRng();return n.setStart(e,0),n.setEnd(e,0),n}function a(e,n,a,c,u){Pn(t).each((function(l){Sn(l,t).each((function(t){function s(e,t){return Jt.findItem(f,e,Y).map((function(e){return e[t]}))}var f=Jt.fromTable(t),d=hn(e.orThunk((function(){return s(l,"row")})),d=n.orThunk((function(){return s(l,"column")})),(function(e,t){return Jt.getAt(f,e,t).map((function(e){return e.element}))})).bind(r).bind((function(e){return e=xn(e),a(t,e)}));(c?d.map((function(e){return V(V({},e),{rng:i(l.dom)})})):d).each(o(t,u))}))}))}var c=Rn(In,e,e);return{selection:function(e,r){Pn(t).each((function(i){Sn(i,t).each((function(t){var a=Cn(n,t,i);e(t,a).each(o(t,r))}))}))},row:function(e,t,n,r){return a(R.some(e),R.none(),t,n,r)},column:function(e,t,n,r){return a(R.none(),R.some(e),t,n,r)},table:function(e,n,r,a,c,u){var l=Jt.fromTable(e),s=(r=Jt.getAt(l,n,r).map((function(e){return e.element})),t.selection.getRng()),f=Pn(t),d=f.bind((function(e){return Jt.findItem(l,e,Y)})).isSome(),m=r.bind((function(t){return t=xn(t),a(e,t)}));hn(m,d&&c?f.map((function(e){return i(e.dom)})):d?m.map((function(e){return e.rng})):R.some(s),(function(e,t){return V(V({},e),{rng:t})})).each(o(e,u))}}}(t,i={get:function(){return nn(d(),g).fold((function(){return p().map(Nn).getOrThunk(An)}),(function(e){return _n(e)}))}}),c=t.getParam("advtable_value_series",{numbers:{update:!0,resizable:!1,generator:ro},alpha:{update:!0,resizable:!1,generator:oo}}),go(t,o,i,a,c),function(e,t,n){function r(t,n){return function(){return e.execCommand(t,!1,n)}}e.on("init",(function(){var o=t().selectionTargets.onSetupCellOrRow,i=[{type:"menuitem",text:"Sort table by column ascending",onAction:r("mceSortTableByColumnAsc"),onSetup:o},{type:"menuitem",text:"Sort table by column descending",onAction:r("mceSortTableByColumnDesc"),onSetup:o},{type:"separator"},{type:"menuitem",text:"Advanced sort...",onAction:function(){return po(e,n)},onSetup:o}];e.ui.registry.addNestedMenuItem("advtablesort",{type:"nestedmenuitem",text:"Sort",getSubmenuItems:function(){return i}})}))}(t,n,i),sn(tinymce,"5.7.0")||(l=o,s=a,f=c,(u=t).on("TableModified",(function(e){var t=Ue.fromDom(e.table),n=lo(t),r=n.bind((function(e){return ee(f,e)}));hn(n,r,(function(n,r){1===Jt.fromTable(t).grid.columns?Pn(u).bind(Tt).exists((function(e){return Y(t,e)}))?u.execCommand("mceTableDelete"):u.undoManager.transact((function(){Qt(t)})):!0===r.update&&!1!==e.structure&&Jo(t,l,s,n,r)}))})),u.on("PreInit",(function(){fo(u,f)})))):console.log("Please use the Advanced Tables Plugin together with the Tables plugin.")),{}}))}()},"./src/editor-plugins/confcharmap/charmap.css":function(e,t,n){var r=n("./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/confcharmap/charmap.css");"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n("./node_modules/style-loader/lib/addStyles.js")(r,o);r.locals&&(e.exports=r.locals)},"./src/editor-plugins/draggable/draggable.css":function(e,t,n){var r=n("./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/draggable/draggable.css");"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n("./node_modules/style-loader/lib/addStyles.js")(r,o);r.locals&&(e.exports=r.locals)},"./src/editor-plugins/insert-files/insert-files.css":function(e,t,n){var r=n("./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/insert-files/insert-files.css");"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n("./node_modules/style-loader/lib/addStyles.js")(r,o);r.locals&&(e.exports=r.locals)},"./src/editor-plugins/insertwiki/insert-wiki-markup.css":function(e,t,n){var r=n("./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/insertwiki/insert-wiki-markup.css");"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n("./node_modules/style-loader/lib/addStyles.js")(r,o);r.locals&&(e.exports=r.locals)},"./src/editor-plugins/iosediting/iosediting.css":function(e,t,n){var r=n("./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/iosediting/iosediting.css");"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n("./node_modules/style-loader/lib/addStyles.js")(r,o);r.locals&&(e.exports=r.locals)},"./src/editor-plugins/propertypanel/css/property-panel.css":function(e,t,n){var r=n("./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/propertypanel/css/property-panel.css");"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n("./node_modules/style-loader/lib/addStyles.js")(r,o);r.locals&&(e.exports=r.locals)},"./src/editor-plugins/status-macro/editor-content.scss":function(e,t,n){var r,o=0,i=n("./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/status-macro/editor-content.scss"),a={hmr:!0};a.insertInto=function(){return window.document.getElementById("wysiwygTextarea_ifr").contentDocument.head},"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(t.locals=i.locals),t.use=t.ref=function(){return o++||(r=n("./node_modules/style-loader/lib/addStyles.js")(i,a)),t},t.unuse=t.unref=function(){o>0&&!--o&&(r(),r=null)}},"./src/editor-plugins/status-macro/styles.scss":function(e,t,n){var r=n("./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/status-macro/styles.scss");"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n("./node_modules/style-loader/lib/addStyles.js")(r,o);r.locals&&(e.exports=r.locals)},"./src/editor-plugins/theme-atlassian/editor-content.scss":function(e,t,n){var r,o=0,i=n("./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/theme-atlassian/editor-content.scss"),a={hmr:!0};a.insertInto=function(){return window.document.getElementById("wysiwygTextarea_ifr").contentDocument.head},"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(t.locals=i.locals),t.use=t.ref=function(){return o++||(r=n("./node_modules/style-loader/lib/addStyles.js")(i,a)),t},t.unuse=t.unref=function(){o>0&&!--o&&(r(),r=null)}},"./src/helpers/browser.ts":function(e,t,n){"use strict";(function(e){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n.d(t,"a",(function(){return o}));var o=function(){function t(n){var r,o,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),i=void 0,(o="userAgent")in(r=this)?Object.defineProperty(r,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[o]=i,this.userAgent=n||e.window.navigator.userAgent}var n,o,i;return n=t,(o=[{key:"isFirefox",value:function(){return-1!==this.userAgent.indexOf("Firefox/")}},{key:"notFirefox",value:function(){return!this.isFirefox()}},{key:"isMSEdge",value:function(){return-1!==this.userAgent.indexOf("Edge/")}},{key:"notMSEdge",value:function(){return!this.isMSEdge()}},{key:"isIE",value:function(){return-1!==this.userAgent.indexOf("MSIE")||-1!==this.userAgent.indexOf("Trident/")||this.isMSEdge()}},{key:"notIE",value:function(){return!this.isIE()}},{key:"isChrome",value:function(){return-1!==this.userAgent.indexOf("Chrome/")}},{key:"notChrome",value:function(){return!this.isChrome()}},{key:"isSafari",value:function(){return-1!==this.userAgent.indexOf("Safari/")&&-1===this.userAgent.indexOf("Chrome/")}},{key:"notSafari",value:function(){return!this.isSafari()}},{key:"isPhantom",value:function(){return-1!==this.userAgent.indexOf("PhantomJS")}},{key:"notPhantom",value:function(){return!this.isPhantom()}},{key:"version",value:function(){if(this.isIE()){var e=this.userAgent.match(/MSIE\s([\d.]+)/)||this.userAgent.match(/rv:([\d.]+)/)||this.userAgent.match(/Edge\/([\d.]+)/);return parseInt(e[1])}return this.isChrome()?parseInt(this.userAgent.match(/Chrome\/([\d.]+)/)[1]):this.isSafari()?parseInt(this.userAgent.match(/Version\/([\d.]+)/)[1]):this.isFirefox()?parseInt(this.userAgent.match(/Firefox\/([\d.]+)/)[1]):0}},{key:"friendlyName",value:function(){return this.isMSEdge()?"MSEdge":this.isIE()?"IE":this.isChrome()?"Chrome":this.isSafari()?"Safari":this.isFirefox()?"Firefox":void 0}}])&&r(n.prototype,o),i&&r(n,i),t}()}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./src/index.ts":function(e,t,n){"use strict";n.r(t);var r=n("./node_modules/window-or-global/lib/index.js"),o=n.n(r);n("./node_modules/tinymce/tinymce.js"),n("./node_modules/tinymce/plugins/table/index.js"),n("./node_modules/tinymce/plugins/lists/index.js"),n("./node_modules/tinymce/plugins/paste/index.js");function i(e){for(var t=e.split("."),n=window[t.shift()];void 0!==n&&t.length;)n=n[t.shift()];return n}r.tinymce.confluenceEditorVersion="4.0.8";var a=n("confluence.web.resources:jquery/require('jquery')"),c=n.n(a);function u(e,t,n){return"function"==typeof n?c()(o.a).bind(e,t,n):c()(o.a).bind(e,t)}function l(e,t){return c()(o.a).unbind(e,t)}function s(e,t){return c()(o.a).trigger(e,t)}var f="confluence.spa.editor";function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var m=function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),d(this,"value",void 0),d(this,"toJSON",void 0),this.value=t,this.valueOf=this.toString=this.toJSON=function(){return n.value}},p=function(e){return new m(e)},g=function(e,t){Object.keys(t).forEach((function(e){t[e]=p(t[e])})),s("analytics",{name:"".concat(f,".plugins.").concat(e),data:t})},h=n("confluence.web.resources:ajs/require('ajs')"),v=n.n(h);function b(e){return e&&3===e.nodeType&&0===e.nodeValue.length}var y={isCursorAtStartOf:function(e,t){return t.collapsed&&this.isRangeAtStartOf(e,t)},isRangeAtStartOf:function(e,t){if(!t||!t.startContainer)throw new Error("range is invalid. received: ".concat(t));if(!e||!e.nodeType)throw new Error("context is invalid. received: ".concat(e));var n,o=t.startContainer;if(3===o.nodeType){if(0!==t.startOffset)return!1;n=o}else if(void 0===(n=o.childNodes[t.startOffset])&&o.childNodes.length>0)return!1;var i,a=new r.tinymce.dom.TreeWalker(n,e);do{i=a.prev(!0)}while(b(i));return void 0===i},isCursorAtEndOf:function(e,t){return t.collapsed&&this.isRangeAtEndOf(e,t)},isRangeAtEndOf:function(e,t){if(!t||!t.endContainer)throw new Error("range is invalid. received: ".concat(t));if(!e||!e.nodeType)throw new Error("container is invalid. received: ".concat(e));var n,o=t.endContainer;if(3===o.nodeType){if(t.endOffset!=o.nodeValue.length)return!1;n=o}else n=o.childNodes[0===t.endOffset?t.endOffset:t.endOffset-1];var i,a=new r.tinymce.dom.TreeWalker(n,e);do{i=a.next(!0)}while(b(i));return void 0===i||"BR"===i.nodeName&&void 0===a.next(!0)},setCursorAtStartOfContents:function(e){if(!e)throw new Error("element is required.");if(1!==e.nodeType&&3!==e.nodeType)throw new Error("invalid argument: expected a DOM element or text node, got: ".concat(e));var t=r.tinymce.activeEditor,n=t.dom.createRng();["br","img"].includes(e.nodeName.toLowerCase())?(n.setStartBefore(e),n.setEndBefore(e),t.selection.setRng(n)):(t.selection.select(e,!0),t.selection.collapse(!0))},isCursorAtEnd:function(e,t){var n=e.selection.getSel();if(!n||!n.isCollapsed)return!1;var r=t.endContainer;if(3==r.nodeType)return r.wholeText.length==t.endOffset;var o=r.childNodes[t.endOffset];return c()(o).is(":last-child")}},w=y;function C(e,t){var n=e.selection.getSel();if(!n||!n.isCollapsed)return!1;var r,o=t.startContainer;return 3==o.nodeType?!o.previousSibling&&0===t.startOffset&&function(e){if(0==c()(e).closest("td").length)return!0;for(var t=e.parentNode;t&&"td"!=t.nodeName.toLowerCase();){if(c()(t).prevAll().contents().filter((function(){return 3==this.nodeType})).length)return!1;t=t.parentNode}return!0}(o):c()(o).is("p:first-child")?0===t.startOffset:c()(o).is(".wysiwyg-macro-body")?1==t.startOffset&&(3==(r=t.startContainer.childNodes[0]).nodeType&&"\n"==r.nodeValue):void 0}function x(e,t,n){var r=e.dom.create("p",{},'<br data-mce-bogus="1" />');n?t.after(r):t.before(r),e.selection.select(r,!0),e.selection.collapse()}function S(){var e=r.tinymce.activeEditor;r.tinymce.Env.gecko&&e.on("KeyPress",(function(t){if(t.charCode==r.tinymce.util.VK.SPACE){var n=e.selection.getNode(),o=c()(n).closest("a"),i=e.selection.getRng();o.length&&w.isCursorAtEnd(e,e.selection.getRng())&&(i.setStartAfter(o[0]),i.setEndAfter(o[0]),e.selection.setRng(i),e.selection.collapse())}})),e.on("KeyPress",(function(t){if(13==t.keyCode&&!t.shiftKey){var n=e.selection.getNode(),o=c()(n).closest("pre");if(o.length&&!r.tinymce.confluence.MacroUtils.isInMacro(o)&&w.isCursorAtEnd(e,e.selection.getRng()))return x(e,o,!0),r.tinymce.dom.Event.cancel(t);var i=c()(n).closest("blockquote");if(i.length){var a=c()(n).closest("p");if(a.is(":first-child")&&C(e,e.selection.getRng()))return x(e,i,!1),r.tinymce.dom.Event.cancel(t);if(a.is(":last-child")&&function(e){var t=e.contents();if(!t.length)return!0;if(1==t.length){if(t.is("br"))return!0;if("&nbsp;"==t.html()||160==t.text().charCodeAt(0))return!0;if(3==t[0].nodeType&&t[0].nodeValue==v.a.Rte.HIDDEN_CHAR)return!0}return!1}(a))return e.dom.remove(a[0],!1),x(e,i,!0),r.tinymce.dom.Event.cancel(t)}}return!0}),!0)}function k(e,t,n,r){return"function"==typeof r?c()(e).bind(t,n,r):c()(e).bind(t,n)}function T(e,t,n){return c()(e).unbind(t,n)}function E(e,t,n){return c()(e).trigger(t,n)}var A={},_=function(e){if(!A.hasOwnProperty(e)){var t=o.a.document.querySelector("meta[name=ajs-enabled-dark-features]");if(t){var n=t.content.split(",");A[e]=n.indexOf(e)>-1&&-1===n.indexOf("".concat(e,".disable"))}}return A[e]},N=function(e,t){return"<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?c()(e,t||r.document):c()("<div>".concat(e,"</div>"),t||r.document).contents()},R=function(e,t){e.is("ul.inline-task-list")?t.each((function(){var e=c()(this);e.attr("data-inline-task-id")||e.attr("data-inline-task-id","")})):t.removeAttr("data-inline-task-id").removeAttr("data-pasted-task")},D=function(e){var t=3===e.startContainer.nodeType?e.startContainer.parentNode:e.startContainer;return"LI"===t.nodeName&&1===t.childNodes.length&&"BR"===t.firstChild.nodeName},O=function(e,t){if(!t.collapsed||0!=t.startOffset)return!1;var n=c()(t.startContainer).closest("ol, ul",e.getBody());if(0===n.length)return!1;var o=new r.tinymce.dom.TreeWalker(t.startContainer,n[0]).prev(!0);return void 0===o||c()(o).is("li")},I=function(e){var t=e.filter("ol,ul").length;return e.length===t},P=function(e,t,n){var r=null;return B.forEach((function(o){if(o.shouldInsert(e,t,n))return r=o,!1})),r},B=[{shouldInsert:function(e,t,n){var r=D(t);return(r=r&&I(n))&&n.children("li").length>0},insert:function(e,t,n){var r=c()(3===t.startContainer.nodeType?t.startContainer.parentNode:t.startContainer),o=n.children();e.undoManager.beforeChange(),e.undoManager.add(),R(r.parent(),o),r.replaceWith(o),e.selection.select(o.last()[0],!0),e.selection.collapse(),e.undoManager.add()}},{shouldInsert:function(e,t,n){var r=O(e,t);return(r=r&&I(n))&&n.children("li").length>0},insert:function(e,t,n){var r=c()(t.startContainer).closest("li",e.getBody()),o=n.children();e.undoManager.beforeChange(),e.undoManager.add(),R(r.parent(),o),r.before(o),e.selection.select(r[0],!0),e.selection.collapse(!0),e.undoManager.add()}},{shouldInsert:function(e,t,n){return function(e,t){if(!t.collapsed)return!1;if(3===t.startContainer.nodeType&&t.startOffset!=t.startContainer.nodeValue.length)return!1;if(1===t.startContainer.nodeType&&t.startOffset!=t.startContainer.childNodes.length)return!1;var n=c()(t.startContainer).closest("ol, ul",e.getBody());if(0===n.length)return!1;var o=new r.tinymce.dom.TreeWalker(t.startContainer,n[0]).next(!0);return void 0===o||c()(o).is("li")}(e,t)&&n.length===n.filter("ol,ul").length&&n.children("li").length>0},insert:function(e,t,n){var r=c()(t.startContainer).closest("li",e.getBody()),o=n.children();e.undoManager.beforeChange(),e.undoManager.add(),R(r.parent(),o),r.after(o),e.selection.select(o.last()[0],!0),e.selection.collapse(!1),e.undoManager.add()}},{shouldInsert:function(e,t,n){var r=n.length>1;return r=(r=(r=r&&!D(t))&&O(e,t))&&function(e){var t=e.filter("ol,ul"),n=e[e.length-1];return 1===t.length&&t[0]===n}(n)},insert:function(e,t,n){var r=c()(t.startContainer).closest("li",e.getBody());e.undoManager.beforeChange(),e.undoManager.add(),R(r.parent(),n.children("li"));var o=c()("<li></li>").append(n);r.before(o),e.undoManager.add()}},{shouldInsert:function(e,t,n){return!t.collapsed&&(!!c()(t.commonAncestorContainer).is("table.confluenceTable > tbody, table.confluenceTable > tbody > tr")&&n.is("table:not(.wysiwyg-macro)"))},insert:function(e,t,n){var r=n.children("tbody").length>0?n.children("tbody").children("tr"):n.children("tr"),o=r.children("td, th"),i=c()(".mceSelected",e.getDoc()),a=i.parent();function u(e,t){for(var n=e.shift(),r=t.shift();n&&r;n=e.shift(),r=t.shift())c()(r).html(c()(n).html())}if(e.undoManager.beforeChange(),e.undoManager.add(),1===a.length)u(c.a.makeArray(o),c.a.makeArray(i));else for(var l=c.a.makeArray(r),s=c.a.makeArray(a),f=l.shift(),d=s.shift();f&&d;f=l.shift(),d=s.shift())u(c.a.makeArray(c()(f).children()),c.a.makeArray(c()(d).children()));e.selection.setRng(t),e.undoManager.add()}},{shouldInsert:function(e,t,n){if(_("confluence.editor.tinymce.tables"))return!1;var r=c()(t.startContainer).closest("td.confluenceTd, th.confluenceTh",".mceContent");if(0===r.length)return!1;var o=r.closest("table.confluenceTable",".mceContent");if(0===o.length||0===o.children("tbody").length)return!1;if(!n.is("table:not(.wysiwyg-macro)"))return!1;var i=!1;return o.find("*[colspan], *[rowspan]").each((function(e,t){if(parseInt(c()(t).attr("rowspan"))>1||parseInt(c()(t).attr("colspan"))>1)return i=!0,!1})),!i},insert:function(e,t,n){var r=c()(t.startContainer).closest("td.confluenceTd, th.confluenceTh",".mceContent"),o=r.closest("table.confluenceTable",".mceContent"),i=n.children("tbody").length>0?n.children("tbody").children("tr"):n.children("tr"),a=o.children("tbody").children("tr"),u=i.length,l=i.first().children("td, th").length,s=a.length,f=a.first().children("td, th").length,d=r.parent().index(),m=r.index();e.undoManager.beforeChange(),e.undoManager.add();var p=m+l-f,g=d+u-s;p=p<0?0:p,g=g<0?0:g,a.each((function(e,t){for(var n=c()(t),r=n.children().last(),o=0;o<p;o++)n.append(r.clone().html("<br/>"))}));for(var h=a.last(),v=0;v<g;v++){for(var b=c()("<tr></tr>").insertAfter(h),y=0;y<f+p;y++)b.append('<td class="confluenceTd"><br/></td>');h=b}var w=[];o.children("tbody").children("tr").slice(d).each((function(e,t){w.push(c.a.makeArray(c()(t).children("th, td").slice(m)))}));var C=[];i.each((function(e,t){C.push(c.a.makeArray(c()(t).children("th, td")))}));for(var x=C.shift(),S=w.shift();x&&S;x=C.shift(),S=w.shift())for(var k=x.shift(),T=S.shift();k&&T;k=x.shift(),T=S.shift())c()(T).html(c()(k).html());e.selection.select(r[0],!0),e.selection.collapse(!0),e.undoManager.add()}},{shouldInsert:function(e,t){return c()(t.startContainer).closest("[data-macro-body-type='PLAIN_TEXT']").length>0},insert:function(e,t,n){n.raw&&e.selection.setContent(n.raw())}},{shouldInsert:function(e,t,n){var r=c()(t.startContainer).closest("table").length>0,o=1===n.length&&n.is("table.wysiwyg-macro");return r&&o},insert:function(e,t,n){e.execCommand("mceInsertContent",!1,n[0].outerHTML)}},{shouldInsert:function(e,t,n){var r=c()(t.startContainer).closest("table").is("table.wysiwyg-macro"),o=1===n.length&&n.is("table.confluenceTable");return r&&o},insert:function(e,t,n){e.execCommand("mceInsertContent",!1,n[0].outerHTML)}}],M={insert:function(e,t,n,r){var o=e.selection.getRng();if(o){var i,a,c,u=(i=e,a=t.content,c={content:a,format:"html",selection:!0},i.fire("BeforeSetContent",c),c.content),l=N(u,e.getDoc());l.raw=!!n&&function(){return n};var s=P(e,o,l);s?(s.insert(e,o,l),e.fire("SetContent",{content:u,format:"html",selection:!0}),e.addVisual()):(e.selection.isCollapsed()||e.undoManager.ignore((function(){e.execCommand("mceDelete",!1,null,{skip_undo:!0})})),t.wasProcessed=!0,e.execCommand("mceInsertContent",!1,t,{skip_undo:r}))}},parse:N},L=n("confluence.web.resources:meta/require('confluence/meta')"),F=n.n(L).a,j=function(e){e.parentNode.removeChild(e)},H=function(e){return function(t){var n=t.classList;n.remove.apply(n,e),""===t.className&&t.removeAttribute("class")}},U=function(e,t,n){r.tinymce.util.Tools.each(e.querySelectorAll(t),n)};var z={apply:function(e,t){!function(e){var t;U(e,"img:not([data-emoticon-name]):not(.editor-inline-macro):not(.confluence-embedded-image):not(.template-constiable)",(t=["confluence-embedded-image","confluence-external-resource"],function(e){var n=e.classList;n.add.apply(n,t)}))}(e),function(e){U(e,"span.Apple-style-span",H(["Apple-style-span"]))}(e),function(e){U(e,"br.Apple-interchange-newline",j)}(e),function(e){U(e,"meta",j)}(e),function(e,t){U(e,"ul.inline-task-list > li[data-inline-task-id]",(function(n){var o,i,a=n.getAttribute("data-inline-task-id");r.tinymce.util.Tools.grep(t.querySelectorAll('li[data-inline-task-id="'.concat(a,'"]')),(i=e,o=function(e){return function(e,t){for(;e;){if(t===e)return!0;e=e.parentNode}return!1}(e,i)},function(e){return!o(e)})).length>0&&n.setAttribute("data-inline-task-id","")}))}(e,t),function(e){var t;U(e,".mceSelected",H(["mceSelected"])),U(e,"[data-mce-selected]",(t="data-mce-selected",function(e){e.removeAttribute(t)}))}(e),function(e){var t=F.get("base-url");U(e,"a:not([data-base-url='".concat(t,"'])[data-base-url]"),(function(e){for(var n=e.attributes.href?e.attributes.href.value:t;e.attributes.length>0;)e.removeAttribute(e.attributes[0].name);e.setAttribute("href",n)}))}(e)}},W=function(e){return c()("<br>").add(e.contents())},V=function(e){return(e.nodeType===Node.ELEMENT_NODE||e.nodeType===Node.TEXT_NODE)&&c.a.trim(e.textContent)},q=function(e){var t=!1;return e.parent().contents().each((function(){if(V(this))return this===e[0]&&(t=!0,!1)})),t},K=function(e){var t=e.attr("style"),n=c()("<p></p>").append(e.contents());t&&n.attr("style",t),e.replaceWith(n)},G=function(e){var t=e.prev("p");t.length?(t.append(W(e)),e.remove()):q(e)?K(e):e.replaceWith(W(e))},J=function(e,t){var n=c()('<table class="wysiwyg-macro" data-macro-name="'.concat(e,'" data-macro-body-type="RICH_TEXT">')+'<tbody><tr><td class="wysiwyg-macro-body"></td></tr></tbody></table>');return n.find(".wysiwyg-macro-body").append(t),n},X=function(e){return!e.text()&&!e.find("img").length},Y=K,Q=[function(e){e.find(".expand-container").replaceWith((function(){var e=c()(this).find(".expand-content").first().contents();return e.length?J("expand",e):c()("")}))},function(e){e.find("span:empty").remove()},function(e){e.find("p + br").remove()},function(e){var t=!1;e.find("div:not(.content-wrapper)").each((function(){var e=c()(this);X(e)?(e.remove(),t=!0):e.find("div, p, pre").length?e.replaceWith(e.contents()):(t?Y(e):G(e),t=!1)}))}];var Z={repair:function(e){var t=c()("<div></div>").html(e);return Q.forEach((function(e){e(t)})),t.html()}},ee=[{repair:function(e){var t=/(<td.*<\/td>)<br class="Apple-interchange-newline">/.exec(e);return t?'<table class="confluenceTable"><tbody><tr>'.concat(t[1],"</tr></tbody></table>"):e}},{repair:function(e){var t=/(<tr.*<\/tr>)<br class="Apple-interchange-newline">/.exec(e);return t?'<table class="confluenceTable"><tbody>'.concat(t[1],"</tbody></table>"):e}}],te=function(e){return e?(ee.forEach((function(t){e=t.repair(e)})),e):e},ne={apply:function(e){return e=function(e){return _("editor.advanced.paste.disable")?e:Z.repair(e)}(e=te(e))},repair:te};function re(e){var t={repair:ne.repair,parse:M.parse},n=null;e.on("PastePreProcess",(function(e){e.content=ne.apply(e.content),E(r.document,"prePaste",[t,e])})),e.on("PastePostProcess",(function(n){z.apply(n.node,e.getBody()),E(r.document,"postPaste",[t,n])})),e.on("BeforeExecCommand",(function(t){var r=t.command,o=t.value;"mceInsertContent"===r&&o&&!0===o.paste&&!o.wasProcessed&&(t.preventDefault(),M.insert(e,o,n,!1))})),e.on("paste",(function(e){n=null;var t=function(e){return(e||"").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(?:\r\n|\r|\n)/g,"<br />")}(e.clipboardData.getData("text/plain"));n=t}),!0)}var oe,ie,ae=[],ce={};function ue(e){var t='<span class="text-placeholder">'.concat(oe,"</span>"),n=c()("<div></div>").append(t);e&&n.find(".text-placeholder").html(e),r.tinymce.activeEditor.execCommand("mceInsertContent",!1,n.html())}function le(e){var t=r.tinymce.activeEditor,n=c()(t.getBody()),o=oe,i=e&&e.parentElement;i&&"LI"===i.nodeName&&(o=ie);var a=t.dom.create("span",{id:"placeholder-cursor"},"&nbsp;");i&&e&&i.replaceChild(a,e);var u=n.find("#placeholder-cursor")[0];t.selection.select(u.firstChild),t.dom.remove(u,!1),t.execCommand("mceInsertContent",!1,o)}function se(){return ae}function fe(e){return ce[e]}ie=oe=r.tinymce.Env.webKit?"\ufeff{$caret}<br>":"\ufeff{$caret}";var de={insertTextPlaceHolder:ue,removePlaceholder:le,addPlaceholderType:function(e){e&&e.type&&(ae.push(e),ce[e.type]=e)},getPlaceholderTypes:se,getPlaceholderType:fe};function me(){return r.AJS.Rte}var pe={"editor.autocomplete.macros.header.text":"Macro suggestions","editor.autocomplete.macros.dialog.browse":"Open macro browser","editor.autocomplete.macros.error.load.header":"Failed to get macro details","editor.autocomplete.macros.error.load.retrylink":"Try again","editor.autocomplete.links.header.text":"Link suggestions","editor.autocomplete.links.dialog.search":"Search for &lsquo;{0}&rsquo;","editor.autocomplete.links.dialog.search.no.text":"Search","editor.autocomplete.links.web.link":"Insert web link","editor.autocomplete.links.create.link":"Insert link to create page","editor.autocomplete.file.header.text":"File suggestions","editor.autocomplete.media.header.text":"Media suggestions","editor.autocomplete.media.files.dialog.browse":"Open file library","editor.autocomplete.media.macros.dialog.browse":"Insert other media","editor.autoformat.sampletext.firstcell":"first cell","editor.autoformat.sampletext.heading":"heading","calendar3.helptip.learn.more":"Learn More","tinymce.confluence.placeholder.inline.tasks":"Type your task here, using \u0022@\u0022 to assign to a user and \u0022//\u0022 to select a due date","tinymce.confluence.files":"Files","tinymce.confluence.conf_file_desc":"Insert files and images","tinymce.confluence.conf_file_shortcut":"Ctrl+M","tinymce.confluence.conf_wikimarkup_conversion_errors":"Wiki markup conversion errors","tinymce.confluence.conf_wikimarkup_timeout":"The server took too long to convert the wiki markup. This may only be a temporary problem so you could try again.","tinymce.confluence.conf_wikimarkup_info_title":"Enter wiki markup or markdown below. Confluence will convert your content to editor format and insert it into your page.","tinymce.confluence.conf_wikimarkup.insert.label":"Insert","tinymce.confluence.conf_wikimarkup_preview_label":"Preview","editor.minor.edit":"Notify watchers","property.panel.textplaceholder.display.default":"Text","property.panel.textplaceholder.display.default.tooltip":"Instructional text is replaced with empty content when a person types.","property.panel.textplaceholder.remove":"Remove","editor.shared.draft.done.desc":"Save draft and close editor","editor.change.comment":"What did you change?","tinymce.tablepicker.insert_table_title":"Insert table","com.atlassian.confluence.extra.team-calendars.calendar.helptip.close":"Got it, thanks!","comment.notification.enable":"Watch this page"},ge=function(e){var t=pe[e];return void 0!==t?t:e};function he(){return{name:"textplaceholder",canHandleElement:function(e){return e.hasClass("text-placeholder")},handle:function(e){if("click"===e.e.type||"mouseup"===e.e.type){var t,n=se(),o=e.containerEl,i=o.getAttribute("data-placeholder-type"),a=[],u=f("default",ge("property.panel.textplaceholder.display.default"),ge("property.panel.textplaceholder.display.default.tooltip"));u.selected=!i,a.push(u);for(var l=0,s=n.length;l<s;l++)t=n[l],a.push(f(t.type,t.label,t.tooltip));a.push(null),a.push({className:"text-placeholder-property-panel-remove-button",text:ge("property.panel.textplaceholder.remove"),click:function(){r.Confluence.PropertyPanel.destroy(),le(o)}}),r.Confluence.PropertyPanel.createFromButtonModel("textplaceholder",o,a,{anchorIframe:me().getEditorFrame()})}function f(e,t,n){return{className:"text-placeholder-property-panel-type-item text-placeholder-property-panel-type-".concat(e),text:t,tooltip:n,selected:i===e,click:function(){!function(e){"default"===e?o.removeAttribute("data-placeholder-type"):o.setAttribute("data-placeholder-type",e);var t=c()(".text-placeholder-property-panel-type-".concat(e));t.parent().find(".text-placeholder-property-panel-type-item").removeClass("selected"),t.addClass("selected")}(e)}}}}}}function ve(){var e={click:!1,keypress:!0},t=r.tinymce.VK,n=r.tinymce.dom.Event,o="template"===F.get("content-type");function i(e){s("cursor-target-refresh"),c()("#rte-button-insert-placeholder").click((function(e){e.preventDefault(),ue()})),e.on("KeyDown",(function(t){if(13===t.keyCode&&!t.shiftKey){var n=e.selection.getNode(),o=c()(n).closest(".text-placeholder"),i=e.selection.getRng();if(o.length&&i&&w.isCursorAtEnd(e,i))return x(e,o,!0),r.tinymce.dom.Event.cancel(t)}}),!0)}var a={UL:!0,OL:!0,LI:!0,TABLE:!0,TBODY:!0};function u(e){return!a[e.nodeName]}function l(o){function i(){var e=d();e&&o.selection.select(e)}function a(e){e.off("KeyDown",l),e.off("KeyPress",f),e.off("Click",f)}function l(e){var r=d();return e.keyCode===t.LEFT||e.keyCode===t.UP?(function(e,t){for(var n,r=t&&t.previousSibling;t&&!r;)r=(t=t.parentNode).previousSibling;if(r){for(n=r;!u(n)&&n.lastChild;)n=n.lastChild;e.selection.select(n.lastChild||n),e.selection.collapse(!1),e.selection.normalize()}}(o,r),n.cancel(e)):e.keyCode===t.RIGHT||e.keyCode===t.DOWN?(function(e,t){for(var n,r=t&&t.nextSibling;t&&!r;)r=(t=t.parentNode).nextSibling;if(r){for(n=r;!u(n)&&n.firstChild;)n=n.firstChild;e.selection.select(n.firstChild||n),e.selection.collapse(!0),e.selection.normalize()}}(o,r),n.cancel(e)):e.keyCode===t.BACKSPACE||e.keyCode===t.DELETE?(le(r),n.cancel(e)):void 0}function f(t){if(!r.tinymce.Env.gecko||t.isChar||"keypress"!==t.type){var n,o,i,a=d();if(a){var u=a.getAttribute("data-placeholder-type");n=u,o=t.type,i=n&&fe(n),c.a.extend({},e,i&&i.activation)[o]&&(le(a),s("editor.text-placeholder.activated",{placeholderType:u||"",triggerEvent:t}))}}}function d(){var e=c()(o.getBody()).find(".text-placeholder.selected");return e.length?e[0]:(a(o),null)}o.on("NodeChange",(function(e){var t=e.element,n=c()(t).closest(".text-placeholder");c()(o.getBody()).find(".text-placeholder.selected").not(n).removeClass("selected"),n.length?(n.hasClass("selected")||(n.addClass("selected"),function(e){e.on("KeyDown",l,!0),e.on("KeyPress",f,!0),e.on("Click",f,!0)}(o)),setTimeout(i,0)):a(o)}),!0)}return{init:function(e){e.on("init",(function(){(o?i:l)(e),function(e){c()(e.getDoc()).find("head").append('<style type="text/css">.wiki-content .text-placeholder { display: inline-block; }</style>')}(e)}))},getInfo:function(){return{longname:"Text Placeholder Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com",version:"1.0"}}}}var be,ye=F.get("context-path"),we=0,Ce={updateNode:function(e,t){var n=r.tinymce.activeEditor,o=c()(e,n.getDoc()),i="confluence.update-node-".concat(we++);s("synchrony.stop",{id:i});var a=Ce.prepareNodeForUpdate(o);return Ce.replaceNode(o,t).fail(a).always((function(){s("synchrony.start",{id:i})})).promise()},storeNodeState:function(e,t){for(var n,r={},o=0,i=t.length;o<i;o++)n=t[o],r[n]=e.attr(n);return function(){for(var t in r)e.attr(t,r[t])}},prepareNodeForUpdate:function(e){var t;return e.is("img")&&(t=Ce.storeNodeState(e,["width","height","src","class"]),e.addClass("image-hotswap").attr({src:"".concat(ye,"/images/border/spacer.gif"),width:e.attr("width"),height:e.attr("height")})),t},replaceNode:function(e,t){var n=Ce.getDoc(),o=c()(t,n),i=c()(e,n),a="confluence.replace-node-".concat(we++);return s("synchrony.stop",{id:a}),c.a.Deferred((function(){var e=this;o.is("img")?(o[0].onload=function(){this.onload=null,e.resolve(this)},r.tinymce.Env.opera&&(o[0].src=o.attr("src")),n.createDocumentFragment().appendChild(o[0])):(o.is("table.wysiwyg-macro")&&o.attr("data-mce-resize","false"),e.resolve(o[0]))})).always((function(){s("synchrony.start",{id:a})})).done((function(e){i.replaceWith(e)})).promise()},replaceSelection:function(e){var t=r.tinymce.activeEditor,n=t.selection.getRng(),o=t.getDoc().createRange(),i=c()(e).clone(!0,!1)[0];n.deleteContents(),3===n.startContainer.nodeType&&""===n.startContainer.nodeValue&&(n.startContainer.nodeValue=me().HIDDEN_CHAR),n.insertNode(i);var a=t.getDoc().createTextNode(me().HIDDEN_CHAR);t.dom.insertAfter(a,i);var u=a;return o.setStartBefore(u),o.setEndAfter(u),o.collapse(!1),t.selection.setRng(o),i},normalize:function(e){var t,n,o=r.tinymce.activeEditor,i=o.selection.getRng(),a=null,c=[];if(e&&e.childNodes){if(r.tinymce.Env.webkit?a=i:r.tinymce.Env.gecko&&i&&(a=i.cloneRange(),((t={startIndex:Array.from(e.childNodes).indexOf(i.startContainer),startOffset:a.startOffset,endIndex:Array.from(e.childNodes).indexOf(i.endContainer),endOffset:a.endOffset}).startIndex>-1||t.endIndex>-1)&&(c=function(e){var t=[],n=0;return Array.prototype.forEach.call(e.childNodes,(function(e,r){var o={},i=t[r-1]||{};o.isTextNode=3===e.nodeType,o.textNodesBefore=(o.isTextNode&&i.isTextNode?1:0)+~~i.textNodesBefore,o.precedingTextLength=n,n=o.isTextNode&&e.nodeValue?n+e.nodeValue.length:0,t.push(o)})),t}(e))),e.normalize(),r.tinymce.Env.gecko&&a){if(n=c[t.startIndex]){var u=t.startIndex-n.textNodesBefore,l=t.startOffset+n.precedingTextLength;a.setStart(e.childNodes[u],l)}if(n=c[t.endIndex]){var s=t.endIndex-n.textNodesBefore,f=t.endOffset+n.precedingTextLength;a.setEnd(e.childNodes[s],f)}}a&&o.selection.setRng(a)}},getDoc:function(){return r.tinymce.Env.gecko||r.tinymce.Env.opera?document:r.tinymce.activeEditor.getDoc()},isolateSelectedRange:function(){var e=r.tinymce.activeEditor,t=Ce.getDoc(),n=e.selection,o=n.getRng();if(o){var i,a=o.startContainer,u=o.startOffset,l=o.endContainer,s=o.endOffset;if(o.collapsed)return o;a===l&&(i=s-u);var f=m(a,u);f&&o.setStartBefore(f),a!==o.startContainer&&(s=i||s);var d=m(l,s,!0);return d&&o.setEndAfter(d),n.setRng(o),o}function m(n,r,o){var i=e.dom.getParent(n,e.dom.isBlock);i||(i=e.getBody());var a=function(e,n,r,o){var i,a,u=null,l=null,s=o?"nextSibling":"previousSibling";if(!(i=0===n)&&o&&(i=3===e.nodeType?n===e.length:n===e.childNodes.length),i)for(u=e[s],l=e;null===u;){if(l===r)return;if(l.parentNode===r)break;u=(l=l.parentNode)[s]}else 3===e.nodeType?(a=e.data,e.data=a.slice(n),u=t.createTextNode(a.slice(0,n)),l=e,c()(u).insertBefore(l),o&&(a=l,l=u,u=a)):u=(l=e.childNodes[n-(o?1:0)])[s];return[l,u]}(n,r,i,o);return a?a[1]?function(e,t,n,r){for(var o,i,a,u;t!==n&&t.parentNode!==n;){if(o=(i=t.parentNode).cloneNode(!1),r)for(c()(o).insertAfter(i),a=e;a;)u=a.nextSibling,o.appendChild(a),a=u;else for(c()(o).insertBefore(i),a=i.firstChild;a!==t;)u=a.nextSibling,o.appendChild(a),a=u;e=o,t=i}return t}(a[1],a[0],i,o):a[0]:void 0}}},xe=Ce;var Se=function(){var e,t=r.tinymce.activeEditor,n=Te();t.focus(!1);var o=t.selection.getRng();e=o&&o.cloneRange&&"function"==typeof o.cloneRange?o.cloneRange():o.duplicate&&o.duplicate()||o,be={scrollX:n.scrollX,scrollY:n.scrollY,range:e}},ke=function(){var e=r.tinymce.activeEditor.selection,t=r.tinymce.activeEditor.getWin();be&&(Ee(be),t.focus(),e.setRng(be.range)),be=null},Te=function(){var e=r.tinymce.DOM.getViewPort(r.tinymce.activeEditor.getWin());return{scrollX:e.x,scrollY:e.y}},Ee=function(e){e&&r.tinymce.activeEditor.getWin().scrollTo(e.scrollX,e.scrollY)},Ae={storeBookmark:Se,restoreBookmark:ke,getScroll:Te,restoreScroll:Ee};function _e(){var e=F.get("content-id");return+e||(e=F.get("page-id")),+e||(e="0"),e}function Ne(e){return c()(e).hasClass("wysiwyg-macro")}function Re(e,t){var n;if(e.macro&&e.contentId)n={type:"POST",url:"".concat(ye,"/rest/tinymce/1/macro/placeholder"),contentType:"application/json; charset=utf-8",data:JSON.stringify(e),dataType:"text"};else{if(!e.url||!e.type)throw new Error("illegal argument received: ".concat(e));n=e}var o,i=c.a.Deferred(),a=r.tinymce.activeEditor;if(!t){var u="macro-".concat((new Date).getTime());o=a.dom.create("span",{id:u}),a.selection.setNode(o),t=o=a.dom.select("#".concat(u))[0],i.fail((function(){c()(o).remove()}))}return c.a.extend(n,{timeout:this.DEFAULT_INSERT_MACRO_TIMEOUT}),v.a.Editor.UI.setButtonsState(!1),c.a.ajax(n).done((function(e){var n=e;function r(e){return e&&e.parentNode}"<"!==n[0]&&(n=document.createTextNode(n)),r(t)?xe.updateNode(t,n).done((function(e){i.resolve(e,n)})).fail(i.reject):i.rejectWith(this,Array.from(arguments))})).fail((function(e,t,n){i.rejectWith(this,Array.from(arguments))})),i.done((function(e,t){v.a.Editor.UI.setButtonsState(!0),Ne(e)&&/P|H\d/.test(e.parentNode.nodeName)&&a.dom.split(e.parentNode,e),function(e){var t=r.tinymce.activeEditor,n=t.getDoc(),o=t.selection.getRng();if(Ne(e)){c()("p, pre",e).each((function(e,t){0===t.childNodes.length&&t.appendChild(n.createElement("br"))}));var i=t.dom.select(".wysiwyg-macro-body",e)[0].firstChild;i&&(o.setStart(i,0),o.setEnd(i,0))}else o.setStartAfter(e),o.setEndAfter(e);t.selection.setRng(o)}(e),a.nodeChanged(),me().showElement(e),a.fire("SetContent",{content:t,format:"html",selection:!0}),r.tinymce.activeEditor.undoManager.add(),s("macro-browser.macro-inserted")})).fail((function(){v.a.Editor.UI.setButtonsState(!0)})),i.promise()}var De,Oe={DEFAULT_INSERT_MACRO_TIMEOUT:5e3,insertMacro:Re,isInMacro:function(e){return c()(e).closest(".wysiwyg-macro").length>0},updateMacro:function(e,t,n,r){return Re({contentId:_e(),macro:{name:n,params:e,body:t||""}},r)}},Ie=Oe;var Pe=De={storedRange:null,bookmark:null,editedMacroDiv:null,editedMacro:null,getCurrentNode:function(){return c()(r.tinymce.activeEditor.selection.getNode())},isMacroDiv:function(e){return c()(e).hasClass("wysiwyg-macro")},isMacroTag:function(e){var t=c()(e);return t.hasClass("wysiwyg-macro")||t.hasClass("editor-inline-macro")},isBodylessMacro:function(e){return c()(e).hasClass("editor-inline-macro")},isMacroWithBody:function(e){return c()(e).hasClass("wysiwyg-macro")},isMacroStartTag:function(e){return c()(e).hasClass("wysiwyg-macro-starttag")},isMacroEndTag:function(e){return c()(e).hasClass("wysiwyg-macro-endtag")},isMacroBody:function(e){return c()(e).hasClass("wysiwyg-macro-body")},hasMacroBody:function(e){return"true"==c()(e).attr("macrohasbody")},getNestingMacros:function(e){var t=c()(e||De.getCurrentNode()),n=[];return t.parents(".wysiwyg-macro").each((function(e,t){n.push(c()(t).attr("data-macro-name"))})),n},logMCESelection:function(e){r.tinymce.activeEditor.selection},getSelectedMacro:function(){var e=De.getCurrentNode();return De.isMacroDiv(e)?e:Ie.isInMacro(e)},openMacro:function(e){v.a.MacroBrowser.open({selectedMacro:e,onComplete:De.macroBrowserComplete,onCancel:De.macroBrowserCancel})},editMacro:function(e){var t=c()(e);De.editedMacroDiv=t[0];var n=r.tinymce.activeEditor.serializer.serialize(t.clone()[0],{forced_root_block:!1});r.tinymce.activeEditor.selection.select(t[0]),Se(),c.a.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:"".concat(ye,"/rest/tinymce/1/macro/definition"),data:JSON.stringify({contentId:_e(),macroHtml:n}),dataType:"text",success:function(e){De.openMacro(JSON.parse(e))}})},macroBrowserToolbarButtonClicked:function(e){var t=r.tinymce.activeEditor,n=De.getCurrentNode();Se();var o=c.a.extend({presetMacroName:null,nestingMacros:De.getNestingMacros(n),onComplete:De.macroBrowserComplete,onCancel:De.macroBrowserCancel,mode:"insert",selectedHtml:"",selectedText:""},e);if((!e||e&&!e.ignoreEditorSelection)&&(o.selectedHtml=t.selection.getContent(),o.selectedText=t.selection.getContent({format:"text"})),"function"!=typeof v.a.MacroBrowser.Model.addMacro)return v.a.MacroBrowser.open(o);var i=o.presetMacroMetadata&&o.presetMacroMetadata.macroName||o.presetMacroName,a=v.a.MacroBrowser.getMacroMetadata(i);a?(o.presetMacroMetadata=o.presetMacroMetadata||a,v.a.MacroBrowser.open(o)):v.a.MacroBrowser.Rest.fetchMacroMetadataDetails({id:o.presetMacroName,successCallback:function(e){e&&e.details?(v.a.MacroBrowser.Model.addMacro(e.details),o.presetMacroMetadata=v.a.MacroBrowser.getMacroMetadata(o.presetMacroName),u("reset.complete",(function e(){v.a.MacroBrowser.open(o),l("reset.complete",e)})),s("reset.rte")):v.a.MacroBrowser.open(o)},errorCallback:function(e){console.log("AJS.MacroBrowser.Rest.fetchMacroMetadataDetails ERROR",e)}})},macroBrowserComplete:function(e){var t={contentId:F.get("content-id")||"0",macro:{name:e.name,params:e.params,defaultParameterValue:e.defaultParameterValue,body:e.bodyHtml}};ke(),De.editedMacroDiv?(Ie.insertMacro(t,De.editedMacroDiv),delete De.editedMacroDiv):Ie.insertMacro(t)},macroBrowserCancel:function(){ke(),De.editedMacroDiv=null,De.editedMacro=null}};n("./src/editor-plugins/propertypanel/css/property-panel.css");var Be=function(){var e=r.Confluence.PropertyPanel,t=[];return u("add-handler.property-panel",(function(e,n){n&&t.push(n)})),{init:function(n){var o=function(){return!!e.current},i=function(i,a){var u={focusedEl:a,focusedNodeName:a.nodeName&&a.nodeName.toLowerCase(),ed:n,e:c.a.extend({},i)},l=function(e){if(e.is("img"))return e[0];var t=e.closest("a,table,.wysiwyg-macro,.editor-inline-macro,.text-placeholder");return t.length?t[0]:""}(c()(a)),f=!!c()(a).closest("table:not(.wysiwyg-macro,.editor-inline-macro)").length,d=!!c()(".toolbar-contextual").length;if(u.containerEl=l,s("user-blurred-rte-element",u),l&&!function(e){return"click"==e.type&&(e.which?3===e.which:e.button?2==e.button:void 0)}(i)&&!o()&&e.shouldCreate)for(var m=0,p=t.length;m<p;m++)if(t[m].canHandleElement(c()(l))){if(d||!f)return t[m].handle(u);!function(e){k(r.document,"shown.contextToolbar",(function(){e.handle(u)}))}(t[m])}};function a(e,t){i(e,t.elem)}function f(t,n){o()&&(!n.containerEl||e.current.hasAnchorChanged(n.containerEl)?e.destroy():s("same-anchor.property-panel"))}function d(){setTimeout((function(){me().bindScroll("property-panel",(function(){e.destroy()}))}),0),c()(n.getDoc()).bind("keydown.property-panel.escape",(function(t){27===t.keyCode&&o()&&e.destroy()}))}function m(){me().unbindScroll("property-panel"),c()(n.getDoc()).unbind("keydown.property-panel.escape")}n.on("Click",(function(e){i(e,e.target)})),n.on("KeyUp",(function(e){27!==e.keyCode&&i(e,n.selection.getNode())}),!0),n.on("ContextMenu",(function(){e.destroy()})),u("trigger.property-panel",a),u("user-blurred-rte-element",f),u("created.property-panel",d),u("destroyed.property-panel",m),n.on("Remove",(function(){l("trigger.property-panel",a),l("user-blurred-rte-element",f),l("created.property-panel",d),l("destroyed.property-panel",m)}))},getInfo:function(){return{longname:"Image, Link and Macro Property Panels",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}}};n("./src/editor-plugins/confcharmap/charmap.css");var Me=/^\u200b?(\[)$/;function Le(e){return e.dom.getParent(e.selection.getStart(),"UL,OL")}function Fe(e){return!(!e||"ul"!==e.nodeName.toLowerCase()||!e.classList.contains("inline-task-list"))}function je(e){return e&&"ul"===e.nodeName.toLowerCase()&&!Fe(e)}function He(e){e&&e.classList.contains("inline-task-list")&&(e.classList.remove("inline-task-list"),0===e.classList.length&&e.removeAttribute("class"),e.removeAttribute("data-inline-tasks-content-id"),Array.prototype.slice.call(e.children).forEach((function(e){e.removeAttribute("data-inline-task-id"),e.classList.remove("checked"),e.style.backgroundImage=""})))}function Ue(){return!(e=F.get("use-inline-tasks"),"true"===e||!0===e||"page"===F.get("content-type")||"blogpost"===F.get("content-type")||"template"===F.get("content-type"));var e}var ze=function(){return!!F.get("collaborative-content")&&We()},We=function(){var e=F.get("content-type");return"page"===e||"blogpost"===e};n("./src/editor-plugins/aeTable/advtable-plugin.js");function Ve(){return c()("#table-highlight-group").attr("data-highlight-colour")||""}function qe(e,t,n){if(!t.length)return c()("");for(var r=function(e,t){var n=c()(e.selection.getNode());return!!n.length&&(n[0]===t[0]||!!n.closest(t).length)}(e,t),o=t[0],i=o.ownerDocument.createElement(n),a=o.attributes,u=0,l=a.length;u<l;u++){var s=a[u];i.setAttribute(s.nodeName,s.nodeValue)}for(;o.hasChildNodes();)i.appendChild(o.firstChild);return o.parentNode.replaceChild(i,o),r&&(e.selection.select(i,!0),e.selection.collapse()),c()(i)}var $e={convertToNormalCells:function(e,t){t.filter("th").each((function(){var t=c()(this);(t=qe(e,t,"td")).removeClass("confluenceTh"),t.addClass("confluenceTd")}))},convertToHeadingCells:function(e,t){t.filter("td").each((function(){var t=c()(this);(t=qe(e,t,"th")).removeClass("confluenceTd"),t.addClass("confluenceTh")}))},areCellsHeadings:function(e){var t=e.filter("th").length;return e.length===t},isColumnHeading:function(e,t){var n=c()(e).children("tbody").children("tr");return 1!==n.length&&n.children().filter("th:nth-child(".concat(t,")")).length===n.length},areCellsHighlighted:function(e){var t=e.filter("td[data-highlight-colour],th[data-highlight-colour]"),n=t.length;return e.length===n&&function(e){var t,n,r=Ve();for(t=0,n=e.length;t<n;t++)if((e.eq(t).attr("data-highlight-colour")||"")!==r)return!1;return!0}(t)},isColumnHighlighted:function(e,t){var n=c()(e).children("tbody").children("tr").children("th,td").nthCol(t),r=n.filter("td[data-highlight-colour],th[data-highlight-colour]").length;if(n.length!==r)return!1;for(var o=n.eq(0).attr("data-highlight-colour"),i=1,a=n.length;i<a;i++)if(o!==n.eq(i).attr("data-highlight-colour"))return!1;return!0},getSelectedHighlightColour:Ve},Ke=n("com.atlassian.confluence.plugins.confluence-frontend:table-styles-editor/require('confluence/table-color-names')"),Ge=n.n(Ke),Je=function(e){function t(t){var r,o,i=function(t){return e.translate(t)};n(t),$e.getSelectedHighlightColour()&&(r=$e.getSelectedHighlightColour(),o=i([i("table.cell_background_color"),Ge.a.colorNames[r.substring(1,r.length)]]),t.attr("data-highlight-colour",r),t.attr("title",o),t.children().attr("title",""),t.addClass("highlight-".concat(r)))}function n(e){var t,n,r;for(t=0,n=e.length;t<n;t++)(r=e.eq(t)).attr("data-highlight-colour")&&r.removeAttr("data-highlight-colour"),r.attr("title")&&r.removeAttr("title"),r[0].className=r[0].className.replace(/( |^)highlight-[#\w]+/g,"")}e.on("init",(function(){var o=function(e){return c()(e.selection.getNode()).closest("th.confluenceTh,td.confluenceTd")},i=function(e){var t=c()(e.getBody()).find("th.confluenceTh[data-mce-selected],td.confluenceTd[data-mce-selected]");return t.length?t:o(e)},a=function(e){return 0===e.find("tbody > tr > td").length};function u(e){return c()(e).parents("table").is(".confluenceTable")}function l(t){if(9===t.keyCode){var n=e.selection.getNode();if(u(n)&&!function(t){var n=e.dom.getParent(t,"UL,OL,TR").tagName;return"UL"===n||"OL"===n}(n)){var r=t.shiftKey?"mceTableMoveCaretToPrevCell":"mceTableMoveCaretToNextCell";return e.execCommand(r),t.preventDefault(),!1}}}e.addCommand("confTableRowToggleHeading",(function(){var t=function(e){var t=c()(e.getBody()).find("td[data-mce-selected],th[data-mce-selected]");t.length||(t=c()(e.selection.getNode()));for(var n=t.closest("tr"),r=n.parent(),o=r.is("tbody")?n.parent().parent():r;0!==n.length&&!o.is(".confluenceTable");)n=o.closest("tr"),o=(r=n.parent()).is("tbody")?n.parent().parent():r;return n}(this),n=t.children("td,th"),r=0;return $e.areCellsHeadings(n)?(a(t.closest("table"))||(n=n.filter((function(){var e=c()(this),t=e.closest("table");return r+=parseInt(e.attr("colspan"))||1,!$e.isColumnHeading(t,r)}))),$e.convertToNormalCells(e,n)):$e.convertToHeadingCells(e,n),!1})),e.addCommand("confTableColumnToggleHeading",(function(){var t=function(e){var t=c()([]);return e.each((function(){var e=c()(this),n=e.index()+1,r=e.closest("table.confluenceTable").children("tbody").children("tr");t=t.add(r.children().nthCol(n))})),t}(i(this));return $e.areCellsHeadings(t)?(a(t.closest("table"))||(t=t.filter((function(){var e=c()(this).parent("tr").children(),t=e.filter("th");return e.length!==t.length}))),$e.convertToNormalCells(e,t)):$e.convertToHeadingCells(e,t),!1})),e.addCommand("confTableSelectionToggleHighlight",(function(e,r){var o=r&&r.alwaysHighlight,a=i(this);return $e.areCellsHighlighted(a)&&!o||c()("#table-highlight-group").attr("data-remove-highlight")?n(a):t(a),!1})),_("confluence.editor.tinymce.tables")||e.on("KeyDown",(function(t){function n(t,n){var r=e.selection.getRng();if(!r)return!1;var o=r.startContainer;if(r.collapsed){var i=function(e,t,n){for(;e!=t;){if(e[n])return!1;e=e.parentNode}return!0}(o,t,n);return 3===o.nodeType?i&&r.startOffset==("nextSibling"==n?o.length:0):o==t?r.startOffset==("nextSibling"==n?o.childNodes.length-1:0):i}return!1}if((37===t.keyCode||39===t.keyCode)&&!t.shiftKey){var i=o(this);if(i.length){var a=i[0];if(37===t.keyCode&&n(a,"previousSibling")&&(u=e.selection.getNode(),c()(u).parents("table").first().find("tr:first-child").children().first()[0]!=u))return e.execCommand("mceTableMoveCaretToPrevCell"),r.tinymce.dom.Event.cancel(t);if(39===t.keyCode&&n(a,"nextSibling")&&!function(){var t=e.selection.getNode();return c()(t).parents("table").first().find("tr:last-child").children().last()[0]==t}())return e.execCommand("mceTableMoveCaretToNextCell"),r.tinymce.dom.Event.cancel(t)}}var u})),e.on("KeyDown",(function(t){_("confluence.editor.tinymce.tables")||l(t),function(t){if(t.altKey&&(38===t.keyCode||40===t.keyCode)){var n=e.selection.getRng(),r=c()(n.startContainer).closest("td.confluenceTd, th.confluenceTh",".mceContent");if(0!==r.length){e.execCommand(38===t.keyCode?"mceTableInsertRowBefore":"mceTableInsertRowAfter");var o=r.parent()[38===t.keyCode?"prev":"next"]().find("td:first-child")[0],i=c()(o);i.hasClass("numberingColumn")&&(o=i.next()[0]),n&&(n.setStart(o,0),n.setEnd(o,0),e.selection.setRng(n)),t.preventDefault()}}}(t)})),e.on("Click",(function(){var t=o(this);t.hasClass("numberingColumn")&&!t.hasClass("confluenceTh")&&e.execCommand("mceTableMoveCaretToNextCell")})),e.on("KeyDown",(function(t){if((38===t.keyCode||40===t.keyCode)&&u(e.selection.getNode())&&o(this).hasClass("numberingColumn"))return e.execCommand("mceTableMoveCaretToNextCell"),t.preventDefault(),!1}),!0)})),e.on("init",(function(){c()(e.getBody()).find(".confluenceTd.numberingColumn").attr("contenteditable","false")}))};function Xe(e){return(Xe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Ye,Qe=r.tinymce.each;function Ze(e,t){return parseInt(e.getAttribute(t)||"1")}function et(e){Ye=e}var tt,nt=function(e,t,n){var o,i,a,u,l,s,f=t.dom;g();var d,m;function p(e,t){return(e=e.cloneNode(t)).removeAttribute("id"),t&&N()&&e.removeChild(e.children[0]),e}function g(){var t=0;o=[],Qe(["thead","tbody","tfoot"],(function(n){var r=f.select("> ".concat(n," > tr"),e);Qe(r,(function(e,r){r+=t,Qe(f.select("> td, > th",e),(function(e,t){var i,a;if(o[r])for(;o[r][t];)t++;var c=Ze(e,"rowspan"),u=Ze(e,"colspan");for(a=r;a<r+c;a++)for(o[a]||(o[a]=[]),i=t;i<t+u;i++)o[a][i]={part:n,real:a==r&&i==t,elm:e,rowspan:c,colspan:u}}))})),t+=r.length}))}function h(e,t){var n=o[t];if(n)return n[e]}function v(e,t,n){e&&(1===n?e.removeAttribute(t):e.setAttribute(t,n.toString()))}function b(e){return e&&e.elm&&(e.elm.hasAttribute("data-mce-selected")||e==l)}function y(){var t=[];return Qe(e.rows,(function(e){Qe(e.cells,(function(n){if(n&&n.hasAttribute("data-mce-selected")||n==l.elm)return t.push(e),!1}))})),t}function w(e){var t;return r.tinymce.walk(e,(function(n){var o;if(3===n.nodeType)return Qe(f.getParents(n.parentNode,void 0,e).reverse(),(function(e){e=p(e,!1),t?o&&o.appendChild(e):t=o=e,o=e})),o&&(o.innerHTML=r.tinymce.isIE?"&nbsp;":'<br data-mce-bogus="1" />'),!1}),"childNodes"),v(e=p(e,!1),"rowSpan",1),v(e,"colSpan",1),t?e.appendChild(t):r.tinymce.isIE||(e.innerHTML='<br data-mce-bogus="1" />'),c()(e).attr("contenteditable","true").removeClass("numberingColumn"),e}function C(){var t=f.createRng();if(Qe(f.select("tr",e),(function(e){0===e.cells.length&&f.remove(e)})),0===f.select("tr",e).length)return t.setStartAfter(e),t.setEndAfter(e),n.setRng(t),void f.remove(e);Qe(f.select("thead,tbody,tfoot",e),(function(e){0===e.rows.length&&f.remove(e)})),function(){var e;g();var t=o[Math.min(o.length-1,i.y)];t&&(e=t[Math.min(t.length-1,i.x)].elm)&&(a=e,r.tinymce.isIE9||r.tinymce.isIE10up?(n.setCursorLocation(a,0),n.collapse(!0)):(n.select(a,!0),n.collapse(!0)));var a}()}function x(e,t,n,r){var i,a,c,u,l;for(i=o[t][e].elm.parentNode,c=1;c<=n;c++)if(i=f.getNext(i,"tr")){for(a=e;a>=0;a--)if((l=o[t+c][a].elm).parentNode==i){for(u=1;u<=r;u++)f.insertAfter(w(l),l);break}if(-1==a)for(u=1;u<=r;u++)i.insertBefore(w(i.cells[0]),i.cells[0])}}function S(){Qe(o,(function(e,t){Qe(e,(function(e,n){var r,o,i;if(b(e)){var a=e.elm;if(r=Ze(a,"colspan"),o=Ze(a,"rowspan"),r>1||o>1){for(v(a,"rowSpan",1),v(a,"colSpan",1),i=0;i<r-1;i++)f.insertAfter(w(a),a);x(n,t,o-1,r)}}}))}))}function k(e){var t,n,i,a,c,u,l,s,d,m,g;for(Qe(o,(function(n,r){if(Qe(n,(function(n){if(b(n)&&(c=n.elm.parentNode,u=p(c,!1),t=r,e))return!1})),e)return!t})),a=0;a<o[0].length;a++)if(o[t][a]&&(n=o[t][a].elm)!=i){if(e){if(t>0&&o[t-1][a]&&(d=Ze(s=o[t-1][a].elm,"rowSpan"))>1){v(s,"rowSpan",d+1);continue}}else if((d=Ze(n,"rowspan"))>1){v(n,"rowSpan",d+1);continue}(l=(g=T(a))?f.create("th"):f.create("td")).colSpan=n.colSpan,l.width=n.width,l.innerHTML=r.tinymce.isIE9?"":r.tinymce.isIE?"&nbsp;":'<br data-mce-bogus="1" />',l.className=n.className,g||(f.removeClass(l,r.tinymce.settings.confluence_table_heading_style),f.addClass(l,r.tinymce.settings.confluence_table_cell_style)),m=f.getAttrib(n,"data-highlight-colour",""),E(a)?f.setAttrib(l,"data-highlight-colour",m):f.removeClass(l,"highlight-".concat(m)),u.appendChild(l),i=n}u.hasChildNodes()&&(e?c.parentNode.insertBefore(u,c):f.insertAfter(u,c)),_()}function T(e){if(1===o.length)return!1;for(var t=0;t<o.length;t++)if(o[t]&&o[t][e]&&"TH"!==o[t][e].elm.tagName.toUpperCase())return!1;return!0}function E(e){var t=o[0][e].elm.getAttribute("data-highlight-colour");if(null===t)return!1;for(var n=0;n<o.length;n++)if(o[n][e].elm.getAttribute("data-highlight-colour")!==t)return!1;return!0}function A(e){var t,n,i=[];return Qe(o,(function(n){if(Qe(n,(function(n,r){if(b(n)&&(t=r,e))return!1})),e)return!t})),0==t&&e&&N()?[]:(Qe(o,(function(o,a){var u,l;if(o[t]){var s=o[t].elm;if(0===a){var d=c()(s).closest("table"),m=d.find(">colgroup>col").eq(t),p=c()("<col>");e?p.insertBefore(m):p.insertAfter(m),d.hasClass("fixed-table")&&(Ye&&0!==parseFloat(Ye)?p.css({width:Ye}):p.css({width:29}))}if(s!=n){if(l=Ze(s,"colspan"),u=Ze(s,"rowspan"),1==l){var g=function(e){var t=f.create(e.tagName);t.colSpan=e.colSpan,t.width=e.width,t.className=e.className,t.innerHTML=r.tinymce.isIE?"&nbsp;":'<br data-mce-bogus="1"/>';var n=f.getAttrib(e,"data-highlight-colour","");return n&&f.setAttrib(t,"data-highlight-colour",n),c()(t).attr("contenteditable","true").removeClass("numberingColumn"),t}(s);e?(s.parentNode.insertBefore(g,s),x(t,a,u-1,l)):(f.insertAfter(g,s),x(t,a,u-1,l)),i.push(g)}else v(s,"colSpan",s.colSpan+1);n=s}}})),i)}function _(){if(N()){s=1;var t=0,n=0;Qe(e.rows,(function(e){var r=c()(e);$e.areCellsHeadings(r.children())?r.children(":first").addClass("numberingColumn").attr("contenteditable","true"):n>0?n--:(r.children(":first").html(s.toString()).attr("contenteditable","false").addClass("numberingColumn"),(t=parseInt(r.children(":first").attr("rowspan")))>1&&(n=t-1),s++)}))}}function N(){return c()(e.rows[0]).children(":first").hasClass("numberingColumn")}function R(t){if(t){c()(e.rows[0]).children(":first").addClass("numberingColumn");var n=c()(e),r=n.find(">colgroup>col").eq(0),o=c()("<col>");o.insertBefore(r),n.hasClass("fixed-table")&&o.css({width:29})}else c()(e.rows[0]).children(":first").removeClass("numberingColumn"),c()(e).find(">colgroup>col").eq(0).remove()}function D(){var e=[];Qe(o,(function(t){Qe(t,(function(t,n){b(t)&&-1===r.tinymce.inArray(e,n)&&(c()(t.elm).closest("table").find(">colgroup>col").eq(n).remove(),Qe(o,(function(e){if(e[n]){var t=e[n].elm,r=Ze(t,"colSpan");r>1?v(t,"colSpan",r-1):f.remove(t)}})),e.push(n))}))})),C()}function O(){var e={};return Qe(o,(function(t){Qe(t,(function(t,n){b(t)&&(Ye=c()(t.elm).closest("table").find(">colgroup>col").eq(n).css("width"),0===parseFloat(Ye)&&(Ye="".concat(t.elm.getBoundingClientRect().width)),e[n]||(e[n]=[]))}))})),Qe(o,(function(t){Qe(t,(function(t,n){e[n]&&e[n].push(t.elm.innerHTML)}))})),e}function I(e){e&&e.parentNode&&(n.select(e.parentNode),n.collapse(!0))}function P(e,t){var o=h(e.x,e.y).elm,i=void 0===t||t,a=null;if((r.tinymce.isGecko||r.tinymce.isIE)&&o.firstChild&&(a=o.firstChild),r.tinymce.isIE9||r.tinymce.isIE10up){var c=n.getRng();if(!c)return;i?(c.setStart(a||o,0),c.setEnd(a||o,0)):(c.setStartAfter(a||o),c.setEndAfter(a||o)),n.setRng(c)}else n.select(a||o,!0),n.collapse(i)}function B(){var e,t=o[0].length;return i.x==t-1&&i.y==o.length-1||(i.x==t-1&&N()?(e={x:1,y:i.y+1},$e.areCellsHeadings(c()(o[e.y][0].elm).parent().children())&&(e.x=0)):e=i.x==t-1?{x:0,y:i.y+1}:{x:i.x+1,y:i.y}),e}function M(){var e,t;return 0==i.x&&0==i.y||(1==i.x&&N()&&i.y>0?(t=i.y-1,e={x:o[t].length-1,y:t}):i.x>0?e={x:i.x-1,y:i.y}:(t=i.y-1,e={x:o[t].length-1,y:t})),e}function L(e){var t;return Qe(o,(function(n,r){return Qe(n,(function(n,o){if(n.elm==e)return t={x:o,y:r},!1})),!t})),t}(u=f.select("td[data-mce-selected],th[data-mce-selected]")[0]||c()(n.getStart()).closest(["table.confluenceTable > tbody > tr > th","table.confluenceTable > tbody > tr > td","table.confluenceTable > thead > tr > th","table.confluenceTable > thead > tr > td"].join(","))[0])&&(i=L(u),d=m=0,Qe(o,(function(e,t){Qe(e,(function(e,n){var r,i;b(e)&&(e=o[t][n],n>d&&(d=n),t>m&&(m=t),e.real&&(r=e.colspan-1,i=e.rowspan-1,r&&n+r>d&&(d=n+r),i&&t+i>m&&(m=t+i)))}))})),a={x:d,y:m},l=h(i.x,i.y)),r.tinymce.extend(this,{deleteTable:function(){var t=f.createRng();t.setStartAfter(e),t.setEndAfter(e),n.setRng(t),f.remove(e)},split:S,merge:function(e,t,n){var c,u,l,s,d,m,p,b,y;if(e){var w=L(e);c=w.x,u=w.y,l=c+(t-1),s=u+(n-1)}else c=i.x,u=i.y,l=a.x,s=a.y;if(0!=c||!N()){p=h(c,u);var x=h(l,s);if(p&&x&&p.part==x.part){var k=function(){if(S(),g(),!(p=h(c,u)))return{v:void 0};var t=p.elm;for(v(t,"colSpan",l-c+1),v(t,"rowSpan",s-u+1),m=u;m<=s;m++)for(d=c;d<=l;d++)o[m]&&o[m][d]&&(e=o[m][d].elm)!=t&&(b=r.tinymce.grep(e.childNodes),Qe(b,(function(e){t.appendChild(e)})),b.length&&(b=r.tinymce.grep(t.childNodes),y=0,Qe(b,(function(e){"BR"===e.nodeName&&f.getAttrib(e,"data-mce-bogus","")&&y++<b.length-1&&t.removeChild(e)}))),f.remove(e));C()}();if("object"===Xe(k))return k.v}}},insertRow:k,insertCol:A,insertNumCol:function(){var e;N()?(Qe(o,(function(e){var t=e[0].elm;c()(t).hasClass("numberingColumn")&&null!==t.parentNode&&t.parentNode.removeChild(t)})),R(!1)):(Qe(o,(function(t){var n=t[0].elm;if(e!=n){var r=w(n);n.parentNode.insertBefore(r,n),n.rowSpan>1&&(r.rowSpan=n.rowSpan),e=n}})),R(!0)),_()},updateNumCol:_,deleteCols:D,deleteRows:function(){var e=y();(r.tinymce.isIE9||r.tinymce.isIE10)&&I(e[0]),Qe(e.reverse(),(function(e){!function(e){var t,n;Qe(e.cells,(function(e){var n=Ze(e,"rowSpan");n>1&&(v(e,"rowSpan",n-1),x((t=L(e)).x,t.y,1,1))})),t=L(e.cells[0]),Qe(o[t.y],(function(e){var t,r=e.elm;r!=n&&((t=Ze(r,"rowSpan"))<=1?f.remove(r):v(r,"rowSpan",t-1),n=r)}))}(e)})),C(),_()},cutRows:function(){var e=y();return(r.tinymce.isIE9||r.tinymce.isIE10)&&I(e[0]),f.remove(e),C(),_(),e},copyRows:function(){var e=y();return Qe(e,(function(t,n){e[n]=p(t,!0)})),e},pasteRows:function(e,t){var n=y(),r=n[t?0:n.length-1],i=r.cells.length;Qe(o,(function(e){var t;if(i=0,Qe(e,(function(e){e.real&&(i+=e.colspan),e.elm.parentNode==r&&(t=1)})),t)return!1})),Qe(e,(function(e){var n,o=e.cells.length;for(c()(e.cells[0]).hasClass("numberingColumn")&&(e.removeChild(e.cells[0]),o--),s=0;s<o;s++)v(n=e.cells[s],"colSpan",1),v(n,"rowSpan",1);for(N()&&(e.insertBefore(e.firstChild.cloneNode(!1),e.firstChild),c()(e.firstChild).addClass("numberingColumn"),o++);i<o;)A(!1),i++;for(s=o;s<i;s++)e.appendChild(w(e.cells[o-1]));t?r.parentNode.insertBefore(e,r):f.insertAfter(e,r)})),_()},getPos:L,setStartCell:function(e){i=L(e)},setEndCell:function(e){var n,r,u,l,s,f,d,m,p;if(a=L(e),i&&a){n=Math.min(i.x,a.x),r=Math.min(i.y,a.y),s=u=Math.max(i.x,a.x),f=l=Math.max(i.y,a.y);for(var g=r;g<=f;g++)(p=o[g][n]).real||n-(p.colspan-1)<n&&(n-=p.colspan-1);for(var h=n;h<=s;h++)(p=o[r][h]).real||r-(p.rowspan-1)<r&&(r-=p.rowspan-1);for(var v=r;v<=l;v++)for(var b=n;b<=u;b++)(p=o[v][b]).real&&((d=p.colspan-1)&&b+d>s&&(s=b+d),(m=p.rowspan-1)&&v+m>f&&(f=v+m));c()("td[data-mce-selected],th[data-mce-selected]",t.getBody()).removeAttr("data-mce-selected");for(var y=r;y<=f;y++)for(var w=n;w<=s;w++)o[y][w]&&o[y][w].elm.setAttribute("data-mce-selected","1")}},moveCaretToNextCell:function(){var e=B();e||(k(!1),g(),e=B()),P(e)},moveCaretToPrevCell:function(){var e=M();e||(k(!0),g(),i=L(f.getParent(n.getStart(),"th,td")),e=M()),P(e,!1)},cutColumns:function(){var e=O();return D(),e},copyColumns:O,pasteColumns:function(e,t){var n=Object.keys(e);t||n.reverse(),c.a.each(n,(function(n,r){var o=A(t);for(n=0;n<o.length;n++)o[n].innerHTML=e[r][n]||""}))},prepareTableForColPasteAndCheckIfNeedToRepaint:function(e){var t,n,r=e[Object.keys(e)[0]].length,i=!1;if(Qe(o,(function(e,o){r--,t=o,Qe(e,(function(e,t){n=t}))})),r>0)for(i=!0,l=h(n,t),s=0;s<r;s++)k(!1);return i},toggleFluidColumnWidth:function(){e&&e.rows&&(c()(e).toggleFluidColumnWidth(),c()("#table-mode-picker .dropdown-text").text(t.translate("table.responsive")))},toggleFixedColumnWidth:function(){e&&e.rows&&(c()(e).toggleFixedColumnWidth(),c()("#table-mode-picker .dropdown-text").text(t.translate("table.fixed_width")))}})},rt={},ot=0,it=function(e,t){if(e&&(rt[e]?rt[e]++:rt[e]=1,t)){var n="".concat(e,"Size");rt[n]?rt[n]+=t:rt[n]=t}},at=function e(){rt.pageID=F.get("page-id"),rt.editorVersion=p("4.0.8"),s("analytics",{name:"confluence.editor.action",data:rt}),rt={},Object(r.clearTimeout)(tt),tt=Object(r.setTimeout)(e,6e4)},ct={Bold:"bold",confCharmap:"insert.symbol",confMonospace:"monospace",confTableRowToggleHeading:"table.row.toggle.heading",confTableColumnToggleHeading:"table.column.toggle.heading",confTableSelectionToggleHighlight:"table.selection.toggle.highlight",ForeColor:"foreground.color",FormatBlock:"format.block",Indent:"indent",InsertHorizontalRule:"insert.horizontal.rule",InsertOrderedList:"insert.ordered.list",InsertUnorderedList:"insert.unordered.list",InsertWikiMarkup:"insert.wiki.markup",Italic:"italic",JustifyCenter:"justify.center",JustifyLeft:"justify.left",JustifyRight:"justify.right",mceConfimage:"insert.files.images",mceConflink:"insert.link",mceConfMacroBrowser:"open.other.macros.browser",mceEmotion:"insert.emoticon",mceTableCopyRow:"table.copy.row",mceTableCutRow:"table.cut.row",mceTableDelete:"table.delete",mceTableDeleteCol:"table.delete.column",mceTableDeleteRow:"table.delete.row",mceTableInsertColAfter:"table.insert.column.after",mceTableInsertColBefore:"table.insert.column.before",mceTableInsertRowAfter:"table.insert.row.after",mceTableInsertRowBefore:"table.insert.row.before",mceTableMergeCells:"table.merge.cells",mceTablePasteRowBefore:"table.paste.row.before",mceTableSplitCells:"table.split.cells",mcePageLayoutsToolbar:"page.layouts.toolbar.toggle",mcePageLayoutAddSection:"page.layouts.toolbar.add.section",mcePageLayoutRemoveSection:"page.layouts.toolbar.remove.section",mcePageLayoutMoveSectionDown:"page.layouts.toolbar.movedown.section",mcePageLayoutMoveSectionUp:"page.layouts.toolbar.moveup.section",mcePageLayoutChangeSection:"page.layouts.toolbar.change.section",mceConfShortcutDialog:"open.help.dialog",mceSearchReplaceToolbar:"search.replace.toolbar.toggle",mceConfSearchClose:"search.replace.toolbar.close",mceConfSearch:"search",mceConfReplace:"replace",mceConfReplaceAll:"replace.all",Outdent:"outdent",Redo:"redo",Strikethrough:"strikethrough",subscript:"subscript",superscript:"superscript",Underline:"underline",Undo:"undo",InsertInlineTaskList:"insert.inline.tasklist",InsertInlineTaskListNoToggle:"insert.inline.tasklist.no.toggle"},ut=it;var lt=function(e){_("confluence.editor.tinymce.tables")?e.on("BeforeExecCommand",(function(t){if("mceInsertTable"===t.command&&!t.value){e.execCommand("mceInsertTable",!1,{columns:3,rows:4,options:{headerRows:1}}),t.preventDefault()}})):(e.addCommand("confInsertTable",(function(t,n){return function(e,t,n,r){var o,i,a,c,u,l='<br data-mce-bogus="1">';for(a='<table id="__mce" class="confluenceTable"><tbody>',o=0;o<n;o++){var s=0===o&&r,f=s?"confluenceTh":"confluenceTd";for(a+="<tr>",i=0;i<t;i++)a+=s?"<th class=".concat(f,">").concat(l,"</th>"):"<td class=".concat(f,">").concat(l,"</td>");a+="</tr>"}a+="</tbody></table>",e.undoManager.transact((function(){e.insertContent(a),(c=e.dom.get("__mce"))&&e.dom.setAttrib(c,"id",""),e.$("tr",c).each((function(t,n){e.fire("newrow",{node:n}),e.$("th,td",n).each((function(t,n){u=u||n,e.fire("newcell",{node:n})}))})),c&&e.dom.setAttribs(c,e.settings.table_default_attributes||{}),c&&e.dom.setStyles(c,e.settings.table_default_styles||{})})),e.selection.select(u,!0),e.selection.collapse(!0)}(e,n.cols,n.rows,n.heading),ut("insert.table"),!1})),e.addCommand("mceInsertTable",(function(){return r.tinymce.execCommand("confInsertTable",!1,{rows:4,cols:3,heading:!0}),!1})))},st=function(e){var t,n,r=/([\+\-]?\d*)[nN]([\+\-]?\d*)/;e.fn.nthCol=function(o){var i,a,c,u,l,s,f,d,m;return c={multiplier:0,offset:0},"even"===(i=o)?i="2n":"odd"===i?i="2n+1":/^\d*$/.test(i)&&(i="0n+".concat(i)),null!==(a=r.exec(i))&&(c.multiplier=a[1]-0,c.offset=a[2]-0),n=c,u=this,f=[],d=0,m=[],e.each(u,(function(e,t){var n=0,r=0,o=t.rowSpan||1,i=t.colSpan||1;for(t.parentNode!==l&&((l=t.parentNode).parentNode!==s&&(s=l.parentNode,f=[]),d=0,void 0===f[l.rowIndex]&&(f[l.rowIndex]=[])),n=0;n<f[l.rowIndex].length+1;n+=1)if(void 0===f[l.rowIndex][n]){d=n;break}for(m[e]=d,n=l.rowIndex;n<l.rowIndex+o;n+=1)for(void 0===f[n]&&(f[n]=[]),r=d;r<d+i;r+=1)f[n][r]=!0})),t=m,e(this).filter((function(e){return r=t[e]-(n.offset-1),0===n.multiplier?0===r:r%n.multiplier==0&&r/n.multiplier>=0;var r}))}};function ft(e){var t=0;e.find(">tbody >tr").each((function(){var e=0;c()(this).find(">th,>td").each((function(){var t=c()(this);t.attr("colspan")?e+=parseInt(t.attr("colspan")):e++})),e>t&&(t=e)}));var n=e.find(">colgroup"),r=n.find("col"),o=r.length;if(o!==t){var i=n.length>0;if(i||(n=c()("<colgroup>")),t>o)for(var a=0;a<t-o;a++){var u=c()("<col>");n.append(u)}else for(var l=0;l<o-t;l++)r.last().remove();return i||e.prepend(n),n}}function dt(e,t,n){var o=e.find(">colgroup>col");0===o.length&&(ft(e),o=e.find(">colgroup>col"));for(var i,a,u,l=o.length,s=e.find(">thead>tr,>tbody>tr,>tr"),f=0;f<s.length;f++)if(l===s.eq(f).find(">th, >td").length){i=s.eq(f);break}if(i)a=i.find(">th, >td");else{var d=c()("<tr>");(u=c()("<tfoot>")).append(d);for(var m=0;m<l;m++)d.append(c()("<td>"));e.append(u),a=d.find(">td")}for(var p=e.outerWidth()-1,g=[],h=[],v=0;v<l;v++){var b=a.eq(v),y=b[0].getBoundingClientRect(),w=t?"".concat(y.width/p*100,"%"):b.outerWidth();g[v]=w,h[v]=y}var C=0;r.tinymce.activeEditor&&(C=r.tinymce.activeEditor.getWin().pageXOffset);for(var x=0;x<l;x++)_("confluence.editor.tinymce.tables")||o.eq(x).attr("data-resize-pixel",h[x].width).attr("data-resize-percent",h[x].width/p*100).attr("data-offset-left",h[x].left+C).attr("data-offset-right",h[x].right+C).removeAttr("data-mce-style"),(!n||x===n.index()&&x===n.next().index())&&o.eq(x).css({width:g[x]});u&&u.remove(),e.removeAttr("data-mce-style")}function mt(e,t,n){var r={},o=!1,i=t.find("body");return n.each((function(){var t=c()(this);wt(t)&&t.find("th, td").each((function(){if(!r[t]){var n=c()(this),a=n.offset().left+n.innerWidth();Math.abs(a-parseInt(e.attr("data-offset-right")))<=0&&(r[t]=!0,o=!0,function(e,t){c()('<div contenteditable="false" class="resize-alignment-bar">').css({top:gt(e[0],i[0]),left:t,height:e.height()}).appendTo(i)}(t,a))}}))})),o}function pt(e){e.find(".resize-alignment-bar").remove()}function gt(e,t){return parseInt(e.getBoundingClientRect().top-t.getBoundingClientRect().top,10)}var ht=function(e){var t={$doc:c()(r.document)},n=this,o=n.data("uuid");if(!n.data("initialized")){o||(o=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return"".concat(e()+e(),"-").concat(e(),"-").concat(e(),"-").concat(e(),"-").concat(e()).concat(e()).concat(e())}(),n.data("uuid",o)),e=c.a.extend(t,e||{});var i,a,u,l,f,d,m,p,g,h,v=e.$doc,b=e.editor,y=v.find("body"),w=!1,C=-1,x=!1,S=c()('<div contenteditable="false" class="synchrony-exclude" id="resize-indicator">'),k=c()('<div contenteditable="false" class="synchrony-exclude resize-width-holder" unselectable="on">'),T=!1,E=function(){S.remove(),n.removeClass("active-resizable"),T=!1,m=void 0,l=null,f=null,y.attr("data-table-resizing",!1)},A=function(e){v.find("#resize-indicator").length>0?S=v.find("#resize-indicator"):S.appendTo(y),n.addClass("active-resizable"),S.css({top:gt(n[0],y[0]),left:e,height:n.height()}),T=!0},N=function(e){y.outerWidth(!0)!==y[0].scrollWidth&&(e&&bt(n),y.find("#".concat(o,"-holder")).length||(k.css("width",n.width()+parseInt(c()(b.getBody()).css("margin-right"))),k.attr("id","".concat(o,"-holder")),n.after(k)))};return n.on("mousemove.table-resizable".concat(o),"th, td",(function(e){if(!w&&!(c()(this).parents("table.confluenceTable").length>1||Ct(n)&&_("confluence.table.resizable.hide-indicator-on-fluid"))){ft(n);var t,r=c()(this),o=r.offset().left,a=Math.round(S.outerWidth()/2),u=r.index(),l=r.parent().children();C=-1;var s=r.closest("tr").index();if(r.closest("table.confluenceTable tr").prevAll("tr").each((function(){var e=c()(this),t=e.index();e.children("td, th").each((function(){if(r.offset().left>c()(this).offset().left){var e=parseInt(c()(this).attr("colspan")),n=parseInt(c()(this).attr("rowspan"));e&&n?t+n>s&&(u+=e):n&&t+n>s&&(u+=1)}}))})),x=!1,e.pageX-r.offset().left<r.outerWidth()/2){if(0===(u-=1)&&r.prev().hasClass("numberingColumn"))return;if(u<0){x=!0;var f=l.eq(0);f.attr("colspan")?C+=parseInt(f.attr("colspan")):C++}else for(var m=0;m<=u;m++){var p=l.eq(m);p.attr("colspan")?C+=parseInt(p.attr("colspan")):C++}t=x?o+r.outerWidth()-a:o-a}else{if(0===u&&r.hasClass("numberingColumn"))return;for(var g=0;g<=u;g++){var h=l.eq(g);h.attr("colspan")?C+=parseInt(h.attr("colspan")):C++}t=o+r.outerWidth()-a}i=r.closest("table").find("col").eq(C),function(){if(Math.abs(d-t)<=1)if(T){if(Math.abs(e.pageX-t-a)<=4)return;E()}else{if(!(Math.abs(e.pageX-t-a)<=4))return;A(t)}else Math.abs(e.pageX-t-a)<=4?A(t):E()}(),d=t,wt(n)&&N()}})),n.on("mousedown.table-resizable".concat(o),(function(e){D(e)})),n.on("mouseout.table-resizable".concat(o),(function(){w||E()})),v.on("keypress.table-resizable".concat(o),(function(){T&&E()})),v.on("mousemove.table-resizable".concat(o),(function(e){w&&(s("synchrony.stop",{id:"confluence.table-resize-plugin"}),R(e.pageX-a,!0,e),e.preventDefault())})),v.on("mouseup.table-resizable".concat(o),(function(){w&&(n[0].releaseCapture&&n[0].releaseCapture(),w=!1,E(),pt(v),bt(n),i&&i.width()!==u&&(Ct(n)&&n.addClass("relative-table"),s("analytics",{name:"confluence.table.resize.from.".concat(h),data:{pageId:F.get("page-id")}})),yt(n)&&vt(n),wt(n)&&(N(!0),n.addClass("fixed-table").removeClass("fixed-width")),b&&(b.undoManager.add(),s("synchrony.start",{id:"confluence.table-resize-plugin"})))})),n.data("initialized",!0),this}function R(e,t,r){u||(u=i.width()),i.attr("data-mce-style")&&i.removeAttr("data-mce-style");var o=!1;if(p){var a=e-p,s=n.parent().width(),d=n.width()/s*100;yt(n)&&d>99.9&&a>1&&(o=!0,!f&&(f=i.width()+i.next().width()));var h=Math.abs(Math.abs(e)-Math.abs(p));if(h>=7&&(m=!1),m&&h<7)return}var b=u+e;if(b<29&&(b=29),i.width(b),(o||l)&&(i.next().width(f-b),!l&&(l=r.pageX)),l&&l>r.pageX&&(l=null),dt(n,!1,i),!x&&t&&(S.css({display:"block",top:gt(n[0],y[0]),left:parseInt(i.attr("data-offset-right"))-1,height:n.height()}),wt(n))){var w=mt(i,v,g)||function(e,t,n){var r;return Math.abs(parseInt(e.next().attr("data-resize-pixel"))-parseInt(e.attr("data-resize-pixel")))<=1&&(r=!0,n.find(".resizable-align-right").remove(),c()('<div contenteditable="false" class="resize-alignment-bar resizable-align-right">').css({height:t.height(),top:gt(t[0],n[0]),left:parseInt(e.next().attr("data-offset-right"))-1}).appendTo(n).clone().css({left:parseInt(e.attr("data-offset-left"))-1}).appendTo(n)),Math.abs(parseInt(e.prev().attr("data-resize-pixel"))-parseInt(e.attr("data-resize-pixel")))<=1&&(r=!0,c()('<div contenteditable="false" class="resize-alignment-bar">').css({height:t.height(),top:gt(t[0],n[0]),left:parseInt(e.prev().attr("data-offset-right"))-1}).appendTo(n).clone().css({left:parseInt(e.prev().attr("data-offset-left"))-1}).appendTo(n)),r}(i,n,y);w&&(m=!0),!w&&pt(y)}p=Math.abs(e)}function D(e){i&&T&&(h=wt(n)?"fixed":yt(n)?"relative":"fluid",w=!0,dt(n),n.updateTableModeInToolbar(),_("confluence.table.resizable.relative.keep.width")&&i.next().length||n.css({width:""}),a=e.pageX,n[0].setCapture&&n[0].setCapture(),v.find("body").attr("data-table-resizing",!0),u=i.width(),g=function(e){var t=e.nextAll(".confluenceTable").first(),n=e.prevAll(".confluenceTable").first();return c.a.merge(n,t)}(n),e.preventDefault())}},vt=function(e){var t=e.parent().width(),n=e.width()/t*100;return n>100&&(n=100),e.css({width:"".concat(n,"%")}).attr("data-resize-percent",n),function(e){dt(e,!0)}(e),e},bt=function(e){return e.parent("body").find("#".concat(e.data("uuid"),"-holder")).remove(),e},yt=function(e){return e.hasClass("relative-table")},wt=function(e){return e.hasClass("fixed-table")||e.hasClass("fixed-width")},Ct=function(e){return!yt(e)&&!wt(e)},xt=function(e){var t={$doc:c()(r.document)},n=(e=c.a.extend(t,e||{})).$doc,o=this.data("uuid");return n.find("#resize-indicator").remove(),this.off("mousemove.table-resizable".concat(o)),this.off("mouseout.table-resizable".concat(o)),this.off("mousedown.table-resizable".concat(o)),n.off("keypress.table-resizable".concat(o)),n.off("mousemove.table-resizable".concat(o)),n.off("mouseup.table-resizable".concat(o)),this.data("initialized",!1),this},St=function(){return bt(c()(this)).removeClass("relative-table fixed-table fixed-width").removeAttr("style").find(">colgroup").remove(),this},kt=function(){var e=c()(this);return bt(e),function(e){return dt(e),e}(e).css("width","").removeClass("relative-table").addClass("fixed-table"),e.find(">tbody >tr >td, >tbody >tr >th").each((function(e,t){t.style.width=""})),this},Tt=function(){var e=r.tinymce.activeEditor;if(this.parent().closest("table.confluenceTable").length)return c()("#table-mode-picker .dropdown-text").text(e.translate("table.responsive")),void c()("#table-mode-picker .aui-dd-parent").addClass("disabled");c()("#table-mode-picker .aui-dd-parent").removeClass("disabled"),wt(this)?c()("#table-mode-picker .dropdown-text").text(e.translate("table.fixed_width")):c()("#table-mode-picker .dropdown-text").text(e.translate("table.responsive"))},Et=function(e,t,n){if(n||n.content){var r=c()("<div/>").append(n.content);r.find("table.confluenceTable.relative-table, table.confluenceTable.relative-table > colgroup > col").each((function(){var e;(e=c()(this)).data("resize-percent")?e.css({width:"".concat(e.data("resize-percent"),"%")}):e.attr("style",e.data("mce-style"))})),n.content=r.html()}},At=function(e){var t=c()(e.getWin().document);function n(){t.find("table.confluenceTable").each((function(){c()(this).removeTableResizable({$doc:t})})),t.find("#resize-indicator").remove(),t.find(".resize-width-holder").remove(),c()(e.getBody()).removeAttr("data-table-resizing")}return e.on("Change",(function(){var n=e.selection.getNode(),r=c()(n).parent().closest("table.confluenceTable").not("table.confluenceTable table.confluenceTable");r.is(".confluenceTable")&&r.removeTableResizable({$doc:t}).tableResizable({$doc:t,editor:e,force:!0})})),u("confluence.editor.on.save",n),e.on("Remove",(function(){l("confluence.editor.on.save",n)})),t.on("mousemove","table.confluenceTable",(function(){var n=c()(this);n.parents("table.confluenceTable").length||n.data("initialized")||n.tableResizable({$doc:t,editor:e})})),r.tinymce.isWebKit&&c()(r.document).bind("prePaste",Et),this};function _t(e){c.a.fn.tableResizable=ht,c.a.fn.removeTableResizable=xt,c.a.fn.toggleFluidColumnWidth=St,c.a.fn.toggleFixedColumnWidth=kt,c.a.fn.updateTableModeInToolbar=Tt,e.on("init",(function(){At(e)}))}function Nt(e){!function(e){e.on("ObjectResizeStart",(function(t){var n=t.target;if("bar-col"===t.origin&&e.dom.is(n,"table")){if(n.style.width||(n.classList.contains("fixed-table")?(n.classList.remove("fixed-table"),n.classList.add("fixed-width")):n.classList.contains("fixed-width")||n.classList.add("relative-table")),ft(c()(n)),""===e.dom.getStyle(n,"width")){var o=n.offsetParent;if(null!==o){var i=n.offsetWidth/o.offsetWidth*100;e.dom.setStyle(n,"width","".concat(i,"%"))}}var a=r.tinymce.grep(n.children,(function(t){return e.dom.is(t,"colgroup")}))[0].children,u=r.tinymce.map(a,(function(e){return{value:parseFloat(e.style.width),changed:!1,raw:e.style.width}})),l=-1!==n.style.width.indexOf("%");r.tinymce.each(n.rows,(function(t){var n=0;r.tinymce.each(t.cells,(function(t,r){var o=e.dom.getAttrib(t,"colspan",1);if(1===o){var i=u[r+n],a=l?t.offsetWidth/t.offsetParent.offsetWidth*100:t.offsetWidth;i&&!i.changed&&i.value!==a&&(i.value=a,i.changed=!0)}else n+=o-1}))}));var s=c()(n).closest(".wysiwyg-macro-body, body#tinymce")[0].offsetWidth/parseInt(getComputedStyle(n.parentElement).getPropertyValue("width")),f=l?"%":"px",d=l?n.offsetWidth/n.offsetParent.offsetWidth*100*s:n.offsetWidth;e.dom.setStyle(n,"width",d+f),r.tinymce.each(u,(function(t,n){t.changed&&e.dom.setStyle(a[n],"width",t.value+f)}))}}),!0),e.on("ObjectResized",(function(t){var n=t.target;"bar-col"===t.origin&&e.dom.is(n,"table")&&n.classList.contains("relative-table")&&n.setAttribute("data-resize-percent",parseFloat(e.dom.getStyle(n,"width")).toString())}))}(e),c.a.fn.updateTableModeInToolbar=Tt,function(e){var t=function(t,n){var r=e.dom.getParent(e.selection.getNode(),"table.confluenceTable");e.undoManager.transact((function(){r&&r.classList.contains("fixed-table")&&""===e.dom.getStyle(r,"width")&&e.dom.setStyle(r,"width","".concat(r.offsetWidth,"px")),e.execCommand("mceTableSizingMode",!1,t),r&&(r.classList[n]("fixed-width"),r.classList.remove("relative-table"),r.classList.remove("fixed-table"))})),c()("#table-mode-picker .dropdown-text").text(e.translate("table.".concat("responsive"===t?"responsive":"fixed_width")))};e.addCommand("mceAutoWidth",(function(){t("responsive","remove")})),e.addCommand("mceFixedWidth",(function(){t("fixed","add")}))}(e),r.tinymce.isWebKit&&c()(r.document).bind("prePaste",Et)}function Rt(e){Array.from(e.getBody().querySelectorAll(".confluenceTable.fixed-table >tbody >tr >td, .confluenceTable.fixed-table >tbody >tr >th")).forEach((function(e){e.style.width=""}))}var Dt,Ot=function(){var e=r.tinymce.each,t=r.AJS.storageManager;st(c.a);var n=t("atlassian.editor","tables");return{init:function(t){var o=!0;function i(e){var n=t.selection;e=e||n.getNode().parentNode;var r=t.dom.getParent(e,"table.confluenceTable");if(r)return new nt(r,t,n)}function a(){t.getBody().style.webkitUserSelect="",o&&(c()("td[data-mce-selected],th[data-mce-selected]",t.getBody()).removeAttr("data-mce-selected"),o=!1)}function u(e){for(var r,o=[],i=0;i<e.length;i++)o.push(t.serializer.serialize(e[i],{}));r="<tr>".concat(o.join("</tr><tr>"),"</tr>"),n.setItem("copied",r,7200)}function l(){var e,r=c()(""),o=n.getItem("copied")||"";return o&&((e=t.getDoc().createElement("div")).innerHTML="<table>".concat(o,"</table>"),r=c()(e).find("tr")),r}function s(e){n.setItem("copiedCols",JSON.stringify(e))}function f(){return JSON.parse(n.getItem("copiedCols"))||{}}_("confluence.editor.tinymce.tables")||(t.on("PreProcess",(function(e){var n,r,o,i=t.dom,a=i.select("table",e.node);for(n=a.length;n--;)r=a[n],i.setAttrib(r,"data-mce-style",""),(o=i.getAttrib(r,"width"))&&(i.setStyle(r,"width",o),i.setAttrib(r,"width","")),(o=i.getAttrib(r,"height"))&&(i.setStyle(r,"height",o),i.setAttrib(r,"height",""))})),t.on("init",(function(){t.on("Undo",(function(){o=t.dom.select("td[data-mce-selected], th[data-mce-selected]").length>0})),t.on("KeyUp",(function(){a()})),r.tinymce.isWebKit&&t.on("KeyDown",(function(n){var o=r.tinymce.util.VK,i=n.keyCode;function a(e,n,o){var i=e?"previousSibling":"nextSibling",s=t.dom.getParent(n,"tr"),f=s[i];if(f)return l(t,n,f,e),r.tinymce.dom.Event.cancel(o),!0;var d=t.dom.getParent(s,"table"),m=s.parentNode,p=m.nodeName.toLowerCase();if("tbody"===p||p===(e?"tfoot":"thead")){var g=function(e,n,r,o){var i=t.dom.select(">".concat(o),n),a=i.indexOf(r);if(e&&0===a||!e&&a===i.length-1)return function(e,n){var r=e?"thead":"tfoot",o=t.dom.select(">".concat(r),n);return 0!==o.length?o[0]:null}(e,n);if(-1===a){var c="thead"===r.tagName.toLowerCase()?0:i.length-1;return i[c]}return i[a+(e?-1:1)]}(e,d,m,"tbody");if(null!==g)return function(e,n,o,i){var a=c(n,e);return a&&l(t,o,a,e),r.tinymce.dom.Event.cancel(i),!0}(e,g,n,o)}return function(e,n,o,i,l){var s=i[o];if(s)return u(s),!0;var f=t.dom.getParent(i,"td,th");return f?a(e,f,l):(u(c(n,!e)),r.tinymce.dom.Event.cancel(l))}(e,s,i,d,o)}function c(e,n){var r=e&&e[n?"lastChild":"firstChild"];return r&&"BR"===r.nodeName?t.dom.getParent(r,"td,th"):r}function u(e){t.selection.setCursorLocation(e,0)}function l(t,n,r,o){var i=function(t,n){var r=0,o=0;return e(t.children,(function(e,t){if(r+=Ze(e,"colspan"),o=t,r>n)return!1})),o}(r,function(e){for(var t=0,n=e;n.previousSibling;)t+=Ze(n=n.previousSibling,"colspan");return t}(t.dom.getParent(n,"td,th"))),a=r.childNodes[i];u(c(a,o)||a)}function s(e){var n,r,o=t.selection.getNode(),i=t.dom.getParent(o,"td,th"),a=t.dom.getParent(e,"td,th");return i&&i!==a&&(n=i,r=a,t.dom.getParent(n,"TABLE")===t.dom.getParent(r,"TABLE"))}if((i==o.UP||i==o.DOWN)&&function(e){var t=e.selection.getNode();return null!==e.dom.getParent(t,"tr")}(t)){var f=t.selection.getNode();setTimeout((function(){s(f)&&a(!n.shiftKey&&i===o.UP,f,n)}),0)}}))}))),t.on("copy",(function(){!0===t.selection.isCollapsed()&&t.getBody().querySelectorAll("th[data-mce-selected],td[data-mce-selected]").length>1&&t.selection.select(t.selection.getNode())}),!0),_("confluence.editor.tinymce.tables")?(t.on("newcell",(function(e){var t=e.node;"TD"===t.nodeName?t.classList.add("confluenceTd"):"TH"===t.nodeName&&t.classList.add("confluenceTh")})),t.on("BeforeExecCommand",(function(e){if(e.command.startsWith("mceTable")){var n=t.selection.getNode().closest("table");if(n&&n.classList.contains("wysiwyg-macro")){var r=n.closest("th.confluenceTh, td.confluenceTd");r?t.selection.setCursorLocation(r):e.preventDefault()}}})),Nt(t)):(e({mceTableSplitCells:function(e){e.split()},mceTableMergeCells:function(e){t.dom.select("td[data-mce-selected],th[data-mce-selected]").length&&e.merge()},mceTableInsertRowBefore:function(e){e.insertRow(!0)},mceTableInsertRowAfter:function(e){e.insertRow()},mceTableInsertNumberingCol:function(e){e.insertNumCol()},mceTableUpdateNumberingCol:function(e){e.updateNumCol()},mceAutoWidth:function(e){e.toggleFluidColumnWidth()},mceFixedWidth:function(e){e.toggleFixedColumnWidth()},mceTableInsertColBefore:function(e){et(null),e.insertCol(!0)},mceTableInsertColAfter:function(e){et(null),e.insertCol()},mceTableDeleteCol:function(e){e.deleteCols()},mceTableDeleteRow:function(e){e.deleteRows()},mceTableCutRow:function(e){u(e.cutRows())},mceTableCopyRow:function(e){u(e.copyRows())},mceTablePasteRowBefore:function(e){e.pasteRows(l(),!0)},mceTablePasteRowAfter:function(e){e.pasteRows(l())},mceTableDelete:function(e){e.deleteTable()},mceTableMoveCaretToNextCell:function(e){e.moveCaretToNextCell()},mceTableMoveCaretToPrevCell:function(e){e.moveCaretToPrevCell()},mceTableCopyCol:function(e){s(e.copyColumns())},mceTableCutCol:function(e){s(e.cutColumns())},mceTablePasteColBefore:function(e){var n=f();e.prepareTableForColPasteAndCheckIfNeedToRepaint(n)&&(t.execCommand("mceRepaint"),e=i()),e.pasteColumns(n,!0)},mceTablePasteColAfter:function(e){e.pasteColumns(f(),!1)}},(function(e,n){t.addCommand(n,(function(){var n=i();return n&&(e(n),t.execCommand("mceRepaint"),a()),!1}))})),_t(t)),lt(t),Je(t),ze()?c()(window).one("rte-collab-ready",(function(){Rt(t)})):c()(window).one("rte-ready",(function(){Rt(t)}))}}},It="data-snooker-col-series",Pt="data-snooker-locked-cols";function Bt(e){return function e(t){var n=[];return t?(!function(e){return"thead"===e.name||"tbody"===e.name||"tfoot"===e.name}(t)?"tr"===t.name&&n.push(t):n.push.apply(n,e(t.firstChild)),n.concat(e(t.next))):n}(e.firstChild)}function Mt(e){for(var t=[],n=e.firstChild;n;)"td"!==n.name&&"th"!==n.name||t.push(n),n=n.next;return t}function Lt(e,t,n){return n.indexOf(e)===t}function Ft(e,t,n){(e.attr("class")||"").split(" ").some((function(e){return e.toLowerCase()==="numberingColumn".toLowerCase()}))&&(t.isSeriesTable=!0,e.attr("contenteditable","false"),t.isResizable||e.attr("data-mce-resize","false"),t.lockedColumns.push(n))}function jt(e){for(var t=Dt.getParam("advtable_value_series"),n=t?t.numbers:void 0,r=!n||!1!==n.resizable,o=0;o<e.length;o++){var i=e[o];if("wysiwyg-macro"===i.attr("class"))void 0===i.attr("data-mce-resize")&&i.attr("data-mce-resize","false");else if(!i.attr(It)){for(var a={isResizable:r,isSeriesTable:!1,lockedColumns:[]},c=Bt(i),u=0;u<c.length;u++)for(var l=0,s=Mt(c[u]),f=0;f<s.length;f++){var d=s[f];Ft(d,a,l),l+=parseInt(d.attr("colspan"),10)||1}if(a.isSeriesTable&&i.attr(It,"numbers"),a.lockedColumns.length>0){var m=(i.attr(Pt)||"").split(",").map((function(e){return parseInt(e,10)})).concat(a.lockedColumns).filter(Lt).sort();i.attr(Pt,m.join(","))}}}}function Ht(e){return function(){var t=Dt.getDoc().querySelectorAll(e);t.length>0&&Array.prototype.forEach.call(t,(function(e){e.setAttribute("data-mce-resize","false")}))}}function Ut(e){var t,n;Dt=e,e.parser.addNodeFilter("table",jt),t="data-mce-resize",(n=Dt.serializer.getAttributeFilters().find((function(e){return e.name===t})))&&(n.callbacks=[]),e.on("SetContent",Ht("table.confluenceTable table.confluenceTable:not([data-mce-resize])")),ze()&&(u("rte-collab-ready editor-shared-drafts-published editor-shared-drafts-discarded",Ht("table.wysiwyg-macro:not([data-mce-resize])")),u("rte-collab-ready",Ht("table.confluenceTable table.confluenceTable:not([data-mce-resize])")),u("rte-collab-ready",(function(){Array.prototype.forEach.call(Dt.getDoc().querySelectorAll("table.confluenceTable:not([data-snooker-col-series])"),(function(e){var t=e.querySelectorAll(".numberingColumn");t.length&&(e.setAttribute(Pt,"0"),e.setAttribute(It,"numbers"),Array.prototype.forEach.call(t,(function(e){e.setAttribute("contenteditable","false"),e.setAttribute("data-mce-resize","false")})))}))})))}n("./src/editor-plugins/iosediting/iosediting.css");var zt=function(e){return e.replace(/[&"'<>`]/g,(function(e){var t={"<":"&lt;",">":"&gt;","&":"&amp;","'":"&#39;","`":"&#96;"};return"string"==typeof t[e]?t[e]:"&quot;"}))};function Wt(e,t,n){"cl.ly"==e.host?c.a.get("".concat(ye,"/rest/autoconvert/1.0/cloudappembed?resource=").concat(e.path.substr(1)),(function(e){if(e)switch(e.item_type){case"image":var r=zt(e.content_url);n(c()('<img class="confluence-embedded-image confluence-external-resource" src="'.concat(r,'" data-image-src="').concat(r,'"/>'))[0]);break;case"bookmark":t.text(e.name),t.attr("href",zt(e.redirect_url)),n(t)}else n()})):n()}function Vt(){var e=this,t=function(e,t){return t.anchor&&0!==t.anchor.indexOf("comment-")?"".concat(e,"#").concat(t.anchor.substring(t.anchor.indexOf("-")+1)):e},n=function(n,i,a){if(o(n)){var u=function(e){return ye?e.path.substring(ye.length+1):e.path.substring(1)}(n),l=decodeURIComponent(u).split("/"),s="";n.queryKey=n.queryKey||{},n.queryKey.focusedCommentId?(s="$".concat(n.queryKey.focusedCommentId),s=t(s,n)):n.queryKey.pageId?(s="$".concat(n.queryKey.pageId),s=t(s,n)):"display"===l[0]?s=function(e,n,r){return 2===r.length&&0===r[1].indexOf("~")?n=r[1]:3===r.length?(n="".concat(r[1],":").concat(r[2].replace(/\+/g," ")),n=t(n,e)):4===r.length&&"status"===r[1]?n="$".concat(r[3]):6===r.length&&(n="".concat(r[1],":")+"/".concat(r[2],"/").concat(r[3],"/").concat(r[4],"/").concat(r[5].replace(/\+/g," ")),n=t(n,e)),n}(n,s,l):"spaces"===l[0]?s=(s=(s=e.spaViewPageLinkHandler(l))||e.spaBlogPostLinkHandler(l))?t(s,n):function(e,n,r){return 2!==r.length&&3!==r.length||-1!==r[1].indexOf(".action")||(n="".concat(r[1],":")+"",n=t(n,e)),n}(n,s,l):"users"===l[0]?s=function(e,t,n){return 2===n.length&&"viewuserprofile.action"==n[1]?t="~".concat(e.queryKey.username):2===n.length&&"viewmyprofile.action"==n[1]&&(t="~".concat(F.get("remote-user"))),t}(n,s,l):"pages"===l[0]&&"viewpage.action"===l[1]&&n.queryKey&&n.queryKey.spaceKey&&n.queryKey.title&&(s="".concat(n.queryKey.spaceKey,":").concat(n.queryKey.title.replace(/\+/g," "))),s?(s="[".concat(s,"]"),r.tinymce.plugins.Autoconvert.getHtmlFromWikiMarkup(s,(function(e){a(c()(e).children()[0])}),(function(){a()}))):a()}else a()},o=function(e){var t=!0;return t=t&&e.authority===r.document.location.host,t=t&&(!ye||0===e.path.indexOf(ye)),t};this.init=function(){r.tinymce.plugins.Autoconvert.autoConvert.addHandler(n)}}Vt.prototype.spaViewPageLinkHandler=function(e){var t="spaces"===e[0]&&"pages"===e[2],n="edit"===e[3]?e[4]:e[3];if(t&&n)return"$".concat(n)},Vt.prototype.spaBlogPostLinkHandler=function(e){var t="spaces"===e[0]&&"blog"===e[2],n=e[1],r=e[3],o=e[4],i=e[5],a=e[6],c=e[7];if(t&&n&&r&&o&&i&&a&&c)return"".concat(n,":/").concat(r,"/").concat(o,"/").concat(i,"/").concat(c.replace(/\+/g," "))};function qt(){r.tinymce.plugins.Autoconvert.autoConvert.addHandler((function(e,t,n){if(e.host.match(/google.*/)&&"/url"===e.path&&e.queryKey&&e.queryKey.url){var r=decodeURIComponent(e.queryKey.url);(t=c()(t)).attr("href",r),t.attr("data-mce-href",r),t.text(r),n(t)}else n()}))}var $t={issueKeyOnlyRegEx:/\/(i#)?browse\/([\x00-\x19\x21-\x22\x24\x27-\x3E\x40-\x7F]+-[0-9]+$)/,singleTicketXMLEx:/\/jira\.issueviews:issue-xml\/([\x00-\x19\x21-\x22\x24\x27-\x3E\x40-\x7F]+-[0-9]+)\//,issueKeyWithinRegex:/\/(i#)?browse\/([\x00-\x19\x21-\x22\x24\x27-\x3E\x40-\x7F]+-[0-9]+)(?:\?|#)/,jqlRegEx:/jqlQuery\=([^&]+)/,jqlRegExAlternateFormat:/jql\=([^&]+)/,_getMatchedServerFromLink:function(e,t){var n=null;for(var r in t)if(t.hasOwnProperty(r)){var o=t[r],i=o.url;if("/"!==o.url[o.url.length-1]&&(i+="/"),0===e.indexOf(i)){n=o;break}}return n},pasteHandler:function(e,t,n){var o=v.a.Editor.JiraConnector.servers;if(!o)return n(),null;var i=v.a.Editor.JiraAnalytics,a={},c=$t._getMatchedServerFromLink(e.source,o),u=null;if(c){var l="",s=$t.jqlRegEx.exec(e.source)||$t.jqlRegExAlternateFormat.exec(e.source),f=v.a.JQLHelper.isFilterUrl(e.source),d=$t.issueKeyOnlyRegEx.exec(e.source)||$t.issueKeyWithinRegex.exec(e.source);if(d?(l=d[2],i&&(a.type=i.linkTypes.jql)):(d=$t.singleTicketXMLEx.exec(e.source))&&(l=d[1],i&&(a.type=i.linkTypes.xml)),s)a.is_single_issue=!1,a.type=v.a.JQLHelper.checkQueryType(e.source),u={name:"jira",params:{server:c.name,serverId:c.id,jqlQuery:decodeURIComponent(s[1].replace(/\+/g,"%20"))}};else if(f){var m=e.source;a.is_single_issue=!1,a.type=v.a.JQLHelper.checkQueryType(m),u={name:"jira",params:{server:c.name,serverId:c.id,jqlQuery:v.a.JQLHelper.getFilterFromFilterUrl(m)}}}else l&&(a.is_single_issue=!0,u={name:"jira",params:{server:c.name,serverId:c.id,key:l}})}u?(r.tinymce.plugins.Autoconvert.convertMacroToDom(u,n,n),i&&i.triggerPasteEvent(a)):n()}};var Kt=function(){var e=[],t=function(e){return e.indexOf("%s")>=0?e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&").replace("%s","(.*)"):"".concat(e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"(.*)")};r.tinymce.plugins.Autoconvert.autoConvert.addHandler((function(t,n,r){if(t.source===n.text()){for(var o=0;o<e.length;o++){var i=e[o],a=t.source.match(i.regex);if(a){var u=a[1];if(i.defaultAlias){var l=i.defaultAlias.replace(/%s/,u);return void r(c()(n).text(l))}return void r(c()(n).text(u))}}r()}else r()})),setTimeout((function(){c.a.ajax({url:"".concat(ye,"/rest/autoconvert/latest/shortcutlinkconfigurations"),type:"GET",dataType:"json",success:function(n){e=n.configurations;for(var r=0;r<e.length;r++){var o=e[r];try{o.regex=new RegExp(t(o.expandedValue))}catch(e){console.log("Failed to generated regex for ".concat(o))}}},error:function(e){console.log("Failed to load shortcut link configurations ".concat(e.statusText))}})}),0)},Gt=function(e,t,n){"www.skitch.com"===e.host||"skitch.com"===e.host?c.a.get("".concat(ye,"/rest/autoconvert/1.0/skitchembed?url=").concat(e.source),(function(e){e&&e.url?n(c()('<img class="confluence-embedded-image confluence-external-resource" src="'.concat(e.url,'" data-image-src="').concat(e.url,'"/>'))[0]):n()})):n()},Jt=/^\/(.*?)\/status\/([^/]+\/?$)/,Xt=/^\/(.*?)\/statuses\/([^/]+\/?$)/,Yt=function(e,t,n){var o,i,a;e.host.match(/^twitter.com/)?((o=decodeURI(e.path).match(Jt))?i="".concat(e.protocol,"://twitter.com/").concat(o[1],"/status/").concat(o[2]):(o=decodeURI(e.path).match(Xt))&&(i="".concat(e.protocol,"://twitter.com/").concat(o[1],"/statuses/").concat(o[2])),i?(a={name:"widget",params:{url:i}},r.tinymce.plugins.Autoconvert.convertMacroToDom(a,n,n)):n()):n()};function Qt(){var e=[/youtube-nocookie.com\/embed\/?/,/youtube.com\/watch\?/,/vimeo.com\/[0-9]+/,/[^\.]\.wufoo\.com\/(?:forms|reports)/];r.tinymce.plugins.Autoconvert.autoConvert.addHandler((function(t,n,o){for(var i=decodeURI(t.source),a=0;a<e.length;a++)if(i.match(e[a])){var c={name:"widget",params:{url:i}};return void r.tinymce.plugins.Autoconvert.convertMacroToDom(c,o,o)}o()}))}function Zt(){r.tinymce.plugins.Autoconvert.autoConvert.addHandler((function(e,t,n){if(e.host.match(".*youtu.be.*")){var r=e.path.substr(1),o="http://youtube.com/watch?v=".concat(r);n(c()(t).attr("href",o).text(o))}else n()}))}function en(){u("init.rte",(function(){r.tinymce.plugins.Autoconvert.autoConvert.addHandler(Wt)})),u("init.rte",(new Vt).init),u("init.rte",qt),u("init.rte",Kt),u("init.rte",(function(){r.tinymce.plugins.Autoconvert.autoConvert.addHandler(Gt)})),u("init.rte",Qt),u("init.rte",Zt),u("init.rte",(function(){r.tinymce.plugins.Autoconvert.autoConvert.addHandler($t.pasteHandler)})),u("init.rte",(function(){return r.tinymce.plugins.Autoconvert.autoConvert.addHandler(Yt)}))}var tn,nn,rn,on,an='img[src^="data:image"]:not(.editor-inline-macro)',cn=!1,un={initializeEditor:function(){r.AJS&&r.AJS.Rte&&r.AJS.Rte.BootstrapManager&&r.AJS.Rte.BootstrapManager.addOnInitCallback((function(){var e=r.tinymce.activeEditor;e&&e.on("Paste",(function(e){if(e.clipboardData){nn=[],rn=0,tn=e.clipboardData.items;var t=function(e){return"file"===e.kind};(on=Array.from(tn).some(t))&&(tn=Array.from(tn).filter(t)),un.onPaste(e),on&&r.tinymce.dom.Event.cancel(e)}}))}))},onPaste:function(e){cn||(r.Confluence.Uploader.bind("FileUploaded",ln),cn=!0),Array.from(tn).forEach((function(t){if("file"===t.kind){var n=t.getAsFile();n&&un.uploadFile(n)}else if("string"===t.kind&&"text/html"===t.type&&e.clipboardData){var r=e.clipboardData.getData("text/html");(new DOMParser).parseFromString(r,"text/html").querySelectorAll(an).forEach((function(e,t){un.uploadBase64Image(e,t)}))}else e.clipboardData&&e.clipboardData.getData("text/plain")&&!e.clipboardData.getData("text/html")&&setTimeout((function(){e.currentTarget&&e.currentTarget.querySelectorAll(an).forEach((function(e,t){un.uploadBase64Image(e,t)}))}))}))},uploadFile:function(e){var t=un.createUploadFile(e,e.size);r.Confluence.Uploader.upload([t])},uploadBase64Image:function(e,t){try{var n=e.getAttribute("src"),o=decodeURI(n).split(",")[1].split(" ").join("").replace(/\r?\n|\r/g,""),i=atob(o).length;r.Confluence.Uploader.upload([un.createUploadFile(o,i,"base64",t)])}catch(t){r.Confluence.EditorNotification.notify("warning",r.tinymce.activeEditor.translate("base64image.warning")),e.remove(),console.error("Fail to decode: ",e.getAttribute("src")),console.error(t)}},createUploadFile:function(e,t,n,r){var o,i=new Date,a=i.getMonth()+1;if(e.name&&"image.png"!=e.name)o=e.name;else{var c=r?"-".concat(r):"";o="image".concat(i.getFullYear(),"-").concat(a,"-").concat(i.getDate(),"_").concat(i.getHours(),"-").concat(i.getMinutes(),"-").concat(i.getSeconds()).concat(c,".png")}return{fileName:o,fileSize:t,slice:function(t,n){return e.slice(t,t+n)},getAsBinary:function(){return e},getData:function(){return e},encoding:n}}},ln=function(e,t,n){nn.length||(nn=r.tinymce.activeEditor.getDoc().querySelectorAll(an)),nn.length&&(on?nn[rn].remove():nn[rn].outerHTML=JSON.parse(n.response).htmlForEditor,rn++)};n("./src/editor-plugins/draggable/draggable.css");var sn=function(){var e,t,n,o,i,a,u,l,f,d,m,p,g,h=r.Confluence.PropertyPanel,v=[800,800,400,400,400,300,300,300,300,300,300,300,300,300,300,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100];var b="p,h1,h2,h3,h4,h5,h6,blockquote,li,td,th,img";function y(t){var r=!!o.children(".contentLayout,.contentLayout2").length;function i(){return n.find("#move-indicator")}function a(e){return"move-indicator"===e.attr("id")}function u(e){return r?e.is("div.innerCell,div.cell"):e.is("body")}function l(e,t,r){return e.is("img")?function(e,t){var r=e.offset();return t+n.scrollLeft()-r.left}(e,t)<e.width()/2:s(e,r)<e.height()/2}function s(e,t){var r=e.offset();return t+n.scrollTop()-r.top}return{positionNear:function(e,r){var f=function(e,r){var f=c()(n[0].elementFromPoint(e,r)),d=!0;if(function(e){if(e.is(b)&&!a(e))return(!e.is("td.wysiwyg-macro-body")||"PLAIN_TEXT"!==e.closest("table").attr("data-macro-body-type"))&&!(e.is("img")&&!t.is("img"));return!1}(f))return{target:f,before:l(f,e,r)};if(u(f)){if(function(e,t){return s(e.children().first(),t)<0}(f=function(e){if(e.is("div.cell"))return e.children("div.innerCell").first();return e}(f),r))f=f.children().first();else if(function(e,t){return function(e,t){var n=s(e,t),r=e.height();return n-r}(e.children().last(),t)>0}(f,r))f=f.children().last(),d=!1;else{if(m=f,i().length>0&&i().parent(m).length>0)return null;f=function(e){var n=t.parent(b);n.length||(n=e.find(b).last());n.length||(n=o.find(b).last());return n}(f),d=!1}return{target:f,before:d}}var m;return null}(e,r);f&&function(e,t){if(a(e))return;var n=i();if(e.is("li,td,th")&&e.find(n).length)return;n.length?n.detach():n=c()('<span id="move-indicator">|</span>');!(e=function(e){if(e.is("li,td,th")){var t=e.children().first();t.is("p,h1,h2,h3,h4,h5,h6,blockquote")&&(e=t)}return e}(e)).is("img")&&me().Cursor.isTextContainerEmpty(e[0])?e.prepend(n):e.is("li,td,th")?t?e.prepend(n):e.append(n):t?e.before(n):e.after(n)}(f.target,f.before)},replaceWith:function(t){var n=i();n.length?(t.is("img")&&u(n.parent())&&(t=c()("<p></p>").append(t)),n.replaceWith(t),e.dom.isBlock(t[0])&&t.parent().is("p")&&t.unwrap(),me().showElement(t),e.selection.select(t[0]),e.selection.collapse(!0)):e.undoManager.undo(),me().Cursor.fixCursorTargets(e.getBody())},destroy:function(){var t=i();t.length&&(t.remove(),me().Cursor.fixCursorTargets(e.getBody()))}}}function w(t){if(1===t.which&&t.target===t.currentTarget)if(f)k(t);else{f=c()(t.target),e.selection.select(t.target),t.preventDefault(),n.bind({"mousemove.moveable-zone":S,"mouseup.moveable-zone":k,"keydown.moveable-zone":C,"mouseover.moveable-zone":x});var r,o=f.offset();u=t.pageX,l=t.pageY,i=o.top-l,a=o.left-u,m=!0,d=(r=f).attr("style")||"",f=r}}function C(t){27===t.keyCode&&(p.cancelScrolling(),n.unbind(".moveable-zone"),e.undoManager.undo(),e.selection.select(f[0]),e.selection.collapse(!1),f=null)}function x(){n.find(".mceSelected").removeClass("mceSelected")}function S(n){if(m){if(function(e){var t=Math.abs(u-e.pageX),n=Math.abs(l-e.pageY);return t<10&&n<10}(n))return;Se(),e.undoManager.beforeChange(),e.undoManager.typing=!0,e.undoManager.add(),s("synchrony.stop",{id:"confluence.draggable-plugin"}),(r=e.selection.getSel())&&r.removeAllRanges&&r.removeAllRanges(),f.css({position:"absolute",width:f.css("width"),"max-width":"50%"}),h.current&&h.destroy(),f.detach(),me().Cursor.fixCursorTargets(e.getBody()),o.append(f),g=y(f),m=!1}var r;n.preventDefault(),f.hide(),function(e,n){var r=v.length;if((n=Math.max(n,0))<r)return void p.scrollUp(v[n]);var o=t.height(),i=Math.max(0,o-n);if(i<r)return void p.scrollDown(v[i]);p.cancelScrolling()}(n.clientX,n.clientY),g.positionNear(n.clientX,n.clientY);var c=Math.min(n.pageY+i,p.scrollHeight()-f.outerHeight()),d=n.pageX+a;f.css({top:c,left:d,opacity:.5}),f.show()}function k(t){n.unbind(".moveable-zone"),p.cancelScrolling(),m?f=null:(t.preventDefault(),f.detach(),f.attr("style",d),g.replaceWith(f),g.destroy(),f=null,g=null,x(),e.undoManager.add(),s("synchrony.start",{id:"confluence.draggable-plugin"}))}return{init:function(i){e=i,i.on("Init",(function(){var e,a,u;t=c()(i.getWin()),n=c()(i.getDoc()),o=c()(i.getBody()),e=r.tinymce.Env.webkit?o:n.find("html"),a=e,u=0,p={scrollUp:function(e){if(u!==-e){u=-e;var t=a.scrollTop()/e*1e3;a.stop(!1,!1),a.animate({scrollTop:0},{duration:t})}},scrollDown:function(e){if(u!==e){var t=a[0].scrollHeight,n=(t-a.scrollTop())/e*1e3;a.stop(!1,!1),a.animate({scrollTop:t},{duration:n})}},cancelScrolling:function(){a.stop(!0,!1)},scrollHeight:function(){return a[0].scrollHeight}},n.delegate("img.confluence-embedded-image,img.editor-inline-macro,table.wysiwyg-macro",{mousedown:w})}))},getInfo:function(){return{longname:"Draggable objects (images, tables, placeholders) around the document via drag and drop",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"1.0"}}}};n("./src/editor-plugins/insert-files/insert-files.css");var fn=function e(t,n){var i;if(!F.get("remote-user")||!F.get("confluence.prefs.editor.disable.autoformat")){E.prototype={registerHandler:function(e,t){this.handlers[e]||(this.handlers[e]=[]),this.handlers[e].push(t)},executeHandlers:function(e,t,n,r){var o=!0;return c.a.each(this.handlers[e]||[],(function(e,i){if(i.handles(t))return o=i.execute(t,n,r),!1})),o}};var a,u=n.editor,l=new E,f=[new A(")",e.regularExpressions._REGEXES_EMOTICON.SMILE,"smile","emotions_dlg.smile","smile.svg"),new A("(",e.regularExpressions._REGEXES_EMOTICON.SAD,"sad","emotions_dlg.sad","sad.svg"),new A("P",e.regularExpressions._REGEXES_EMOTICON.CHEEKY,"cheeky","emotions_dlg.tongue","tongue.svg"),new A("p",e.regularExpressions._REGEXES_EMOTICON.CHEEKY_2,"cheeky","emotions_dlg.tongue","tongue.svg"),new A("D",e.regularExpressions._REGEXES_EMOTICON.LAUGH,"laugh","emotions_dlg.biggrin","biggrin.svg"),new A(")",e.regularExpressions._REGEXES_EMOTICON.WINK,"wink","emotions_dlg.wink","wink.svg"),new A(")",e.regularExpressions._REGEXES_EMOTICON.THUMBS_UP,"thumbs-up","emotions_dlg.thumbs_up","thumbs_up.svg"),new A(")",e.regularExpressions._REGEXES_EMOTICON.THUMBS_DOWN,"thumbs-down","emotions_dlg.thumbs_down","thumbs_down.svg"),new A(")",e.regularExpressions._REGEXES_EMOTICON.INFORMATION,"information","emotions_dlg.information","information.svg"),new A(")",e.regularExpressions._REGEXES_EMOTICON.TICK,"tick","emotions_dlg.check","check.svg"),new A(")",e.regularExpressions._REGEXES_EMOTICON.CROSS,"cross","emotions_dlg.error","error.svg"),new A(")",e.regularExpressions._REGEXES_EMOTICON.WARNING,"warning","emotions_dlg.warning","warning.svg"),new A(")",e.regularExpressions._REGEXES_EMOTICON.PLUS,"plus","emotions_dlg.add","add.svg"),new A(")",e.regularExpressions._REGEXES_EMOTICON.MINUS,"minus","emotions_dlg.forbidden","forbidden.svg"),new A(")",e.regularExpressions._REGEXES_EMOTICON.QUESTION,"question","emotions_dlg.help_16","help_16.svg"),new A(")",e.regularExpressions._REGEXES_EMOTICON.LIGHT_ON,"light-on","emotions_dlg.lightbulb_on","lightbulb_on.svg"),new A(")",e.regularExpressions._REGEXES_EMOTICON.LIGHT_OFF,"light-off","emotions_dlg.lightbulb","lightbulb.svg"),new A(")",e.regularExpressions._REGEXES_EMOTICON.YELLOW_STAR,"yellow-star","emotions_dlg.star_yellow","star_yellow.svg"),new A(")",e.regularExpressions._REGEXES_EMOTICON.YELLOW_STAR_2,"yellow-star","emotions_dlg.star_yellow","star_yellow.svg"),new A(")",e.regularExpressions._REGEXES_EMOTICON.RED_STAR,"red-star","emotions_dlg.star_red","star_red.svg"),new A(")",e.regularExpressions._REGEXES_EMOTICON.GREEN_STAR,"green-star","emotions_dlg.star_green","star_green.svg"),new A(")",e.regularExpressions._REGEXES_EMOTICON.BLUE_STAR,"blue-star","emotions_dlg.star_blue","star_blue.svg"),new A("3",e.regularExpressions._REGEXES_EMOTICON.HEART,"heart","emotions_dlg.heart","heart.svg"),new A("3",e.regularExpressions._REGEXES_EMOTICON.BROKEN_HEAR,"broken-heart","emotions_dlg.broken_heart","broken_heart.svg")],d=[];for(a=0;a<f.length;a++)d[a]=new o.a.Image,d[a].src=f[a].imagePath;for(c.a.each({"*":"bold",_:"italic","~":"subscript","^":"superscript","+":"underline","-":"strikethrough","`":"monospace"},(function(e,t){var n=new RegExp("(?:[\\s\\xA0\\u200b\\uFEFF]+|^)(\\".concat(e,"(?=[^\\s").concat(e,"])([^").concat(e,"]*?[^\\s]))$"));l.registerHandler(e.charCodeAt(0),k(n,(function(e){_(t,e[2])}),!0))})),u.formatter.register("code",{inline:"code"}),l.registerHandler("}".charCodeAt(0),k(/(?:[\s\xA0\u200b]+|^)({{(?=[^\s])([^}]*?[^\s])})$/,(function(e){_("code",e[2])}),!0)),a=1;a<=6;a++)!function(e){l.registerHandler(" ".charCodeAt(0),k(new RegExp("^\\u200b?(h".concat(e,"\\.)$")),(function(){u.execCommand("formatBlock",!1,"h".concat(e),{skip_undo:!0})}),!0))}(a);l.registerHandler(" ".charCodeAt(0),k(/^\u200b?(bq\.)$/,(function(){u.execCommand("formatBlock",!1,"blockquote",{skip_undo:!0})}),!0));var m=k(/^\u200b?(\-\-\-\-)$/,(function(){u.execCommand("mceInsertContent",!1,"<hr />",{skip_undo:!0})}),!0);l.registerHandler(" ".charCodeAt(0),m),l.registerHandler(13,m),l.registerHandler(" ".charCodeAt(0),k(/^\u200b?(\#)$/,(function(){u.execCommand("InsertOrderedList")}),!0)),l.registerHandler(" ".charCodeAt(0),k(/^\u200b?(\*)$/,(function(){u.execCommand("InsertUnorderedList")}),!0)),l.registerHandler(" ".charCodeAt(0),k(/^\u200b?(1\.)$/,(function(){u.execCommand("InsertOrderedList")}),!0)),l.registerHandler(" ".charCodeAt(0),k(/^\u200b?(\-)$/,(function(){var e=u.dom;u.execCommand("InsertUnorderedList");var t=e.getParent(u.selection.getNode(),"OL,UL");t&&(e.setStyles(t,{listStyleType:"square"}),t.removeAttribute("data-mce-style"))}),!0)),s("confluence.editor.registerHandlers",{handlerManager:l,createHandler:k,ed:u});var p=k(/((\<\-\-?\>)([^\s-]*))$/,(function(e){u.execCommand("mceInsertContent",!1,""+e[3],{skip_undo:!0})}),!1);l.registerHandler(" ".charCodeAt(0),p),l.registerHandler(13,p);var g=k(/((\-\-?\>)([^\s-]*))$/,(function(e){u.execCommand("mceInsertContent",!1,""+e[3],{skip_undo:!0})}),!1);l.registerHandler(" ".charCodeAt(0),g),l.registerHandler(13,g);var h=k(/((\<\-\-?)([^\s-]*))$/,(function(e){u.execCommand("mceInsertContent",!1,""+e[3],{skip_undo:!0})}),!1);l.registerHandler(" ".charCodeAt(0),h),l.registerHandler(13,h),l.registerHandler(" ".charCodeAt(0),k(/[^-]*[\s](\-\-\-?)$/,(function(e){var t=2===e[1].length?"":"";u.execCommand("mceInsertContent",!1,t,{skip_undo:!0})}),!1));var v=k(/(([^\s-]+)(\-\-\-?)([^\s-]+))$/,(function(e){var t=2===e[3].length?"":"";u.execCommand("mceInsertContent",!1,e[2]+t+e[4],{skip_undo:!0})}),!1);l.registerHandler(" ".charCodeAt(0),v),l.registerHandler(13,v),l.registerHandler(13,k(/(^\u200b?\|\|\s*(?:[^|]*\s?\|\|\s?)+$)/,(function(e){var t='<table class="confluenceTable"><tr>',n="",r=!0,o=c()(e[1].slice(2,-2).split("||")).map((function(e){return e=c.a.trim(this),r=r&&""===e,e}));r&&(o[0]=ge("editor.autoformat.sampletext.firstcell"));for(var i=0,a=o.length;i<a;i++)t+='<th class="confluenceTh">'.concat(o[i],"</th>"),n+='<td class="confluenceTd">'.concat(me().ZERO_WIDTH_WHITESPACE,"</td>");t+="</tr><tr>".concat(n,"</tr></table>"),u.execCommand("mceInsertContent",!1,t,{skip_undo:!0}),u.selection.select(c()(u.selection.getRng().commonAncestorContainer).parents("table").find(r?"th":"td")[0].childNodes[0]),c()(u.selection.getRng().startContainer).parent().closest('[contenteditable="true"]').focus()}),!0)),l.registerHandler(13,k(/(^\u200b?\|\s?(?:[^|]*\s?\|\s?)+$)/,(function(e){var t='<table class="confluenceTable"><tr>',n=!0,r=c()(e[1].slice(1,-1).split("|")).map((function(e){return e=c.a.trim(this),n=n&&""==e,e}));n&&(r[0]=ge("editor.autoformat.sampletext.firstcell"));for(var o=0,i=r.length;o<i;o++)t+='<td class="confluenceTd">'.concat(r[o],"</td>");t+="</tr></table>",u.execCommand("mceInsertContent",!1,t,{skip_undo:!0}),n&&u.selection.select(c()(u.selection.getRng().commonAncestorContainer).parents("table").find("td")[0].childNodes[0]),c()(u.selection.getRng().startContainer).parent().closest('[contenteditable="true"]').focus()}),!0));var b=k(/\b(((https?|ftp):\/\/|(www\.))[\w\.\$\-_\+!\*'\(\),/\?:@=&%#~;\[\]]+)$/,(function(e){var t=e[3]?e[1]:"http://".concat(e[1]),n=u.dom.create("a",{href:t});n.appendChild(r.document.createTextNode(e[1])),u.execCommand("mceInsertContent",!1,x(n),{skip_undo:!0}),u.getDoc().execCommand("unlink",!1,{})}),!1,"a");l.registerHandler(" ".charCodeAt(0),b),l.registerHandler(13,b);var y=k(/\b((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)$/i,(function(e){var t=u.dom.create("a",{href:"mailto:".concat(e[1])});t.appendChild(r.document.createTextNode(e[1])),u.execCommand("mceInsertContent",!1,x(t),{skip_undo:!0}),u.getDoc().execCommand("unlink",!1,{})}),!1,"a");l.registerHandler(" ".charCodeAt(0),y),l.registerHandler(13,y);var w=function(e,t){var n=k(e,(function(){u.execCommand("mceInsertContent",!1,t,{skip_undo:!0})}),!1);l.registerHandler(" ".charCodeAt(0),n),l.registerHandler(13,n)};w(/(?:\b|^)(jira)$/,"Jira"),w(/(?:\b|^)(bitbucket)$/,"Bitbucket"),w(/(?:\b|^)(atlassian)$/,"Atlassian"),w(/(?:\b|^)(hipchat)$/,"Hipchat"),w(/(?:\b|^)(statuspage)$/,"Statuspage"),w(/(?:\b|^)(sourcetree)$/,"Sourcetree"),w(/(?:\b|^)(trello)$/,"Trello");var C={"]":e.regularExpressions._REGEXES.WIKI_LINK,"}":e.regularExpressions._REGEXES.WIKI_MACRO,"!":e.regularExpressions._REGEXES.WIKI_EMBED};c.a.each(C,(function(e,t){l.registerHandler(e.charCodeAt(0),k(t,(function(t){var n=t[1]+e,o={type:"POST",contentType:"application/json; charset=utf-8",url:"".concat(F.get("context-path"),"/rest/tinymce/1/wikixhtmlconverter"),data:JSON.stringify({wiki:n,entityId:F.get("content-id"),spaceKey:F.get("space-key"),contextType:F.get("content-type"),suppressFirstParagraph:!0}),dataType:"text",timeout:5e3};"}"==e?r.tinymce.confluence.MacroUtils.insertMacro(o):"!"==e?c.a.ajax(o).done((function(e){!n===e?r.tinymce.confluence.ImageUtils.insertImagePlaceholder(e):u.execCommand("mceInsertContent",!1,e,{skip_undo:!0})})):c.a.ajax(o).done((function(e){u.execCommand("mceInsertContent",!1,e,{skip_undo:!0})}))}),!0))})),l.registerHandler("`".charCodeAt(0),k(/(``)$/,(function(e){var t={contentId:F.get("content-id"),macro:{name:"code",body:""}};r.tinymce.confluence.MacroUtils.insertMacro(t)}),!0)),u.on("KeyPress",(function(e){return l.executeHandlers(T(e),u,e,t)})),u.on("KeyDown",(function(e){if(13===T(e))return l.executeHandlers(13,u,e,t)}),!0);return{getHandlerCount:function(){return Object.keys(l.handlers).length}}}function x(e){return c()("<div>").append(e.cloneNode(!0)).html()}function S(e){var t,n;if(!e||!e.collapsed)throw new Error("range is null or not collapsed");if(t=e.startContainer,n=e.startOffset,1===t.nodeType&&n>0){if(3!==(t=t.childNodes[e.startOffset-1]).nodeType)return"";n=t.nodeValue.length}else if(3!==t.nodeType)return"";for(var r=t.nodeValue.substring(0,n),o=t.previousSibling;o&&3===o.nodeType;o=o.previousSibling)r=o.nodeValue+r;return r}function k(e,t,n,o){return{handles:function(t){var n=t.selection.getRng();if(!n||!n.collapsed)return!1;var r=n.commonAncestorContainer||{};return!c()(r).closest("pre,.text-placeholder").length&&((!o||!c()(r).closest(o).length)&&e.test(S(n)))},execute:function(o,a,u){var l,s=1,f=T(a);if(32===f?o.execCommand("mceInsertContent",!1,"&nbsp;"):o.execCommand("mceInsertContent",!1,String.fromCharCode(f)),o.undoManager.transact((function(){var n=o.selection.getRng();if(n){"|"==(l=S(n))[l.length-1]&&(l+=" ",s=0);var r=e.exec(l.substring(0,l.length-1)),a=function(e,t,n){var r,o;if(t){3!==t.nodeType&&(n=(t=t.childNodes[n-1]).length);for(var i=t,a=n;i&&3===i.nodeType;i=i.previousSibling){if(-1==a&&(a=i.nodeValue.length),a>e)return{container:i,offset:a-e};if(a==e){for(o=0,r=i.parentNode;i=i.previousSibling;)o++;return{container:r,offset:o}}e-=a,a=-1}return null}}(r[1].length+s,n.commonAncestorContainer,n.startOffset);n.setStart(a.container,a.offset);var u=c()(n.commonAncestorContainer);o.selection.setRng(n),u.closest(".wysiwyg-macro-body").length&&n.toString()==u.text()?(u[0].innerHTML="<br>",o.selection.select(u[0].childNodes[0]),o.selection.collapse(!0)):o.execCommand("delete",!1,{},{skip_undo:!0}),t(r,o.selection.getRng()),i=o.selection.getRng()}})),n)return u.preventDefault(),u.stopPropagation(),r.tinymce.dom.Event.cancel(a),i&&me().showElement(i.startContainer),!1}}}function T(e){return e.which}function E(){this.handlers={}}function A(e,t,n,r,o){var i=e.charCodeAt(0),a="".concat(me().getResourceUrlPrefix(),"/images/icons/emoticons/").concat(o),c=k(t,(function(){var e=u.dom.createHTML("img",{src:a,alt:u.translate("tinymce.".concat(r)),title:u.translate("tinymce.".concat(r)),border:0,class:"emoticon emoticon-".concat(n),"data-emoticon-name":n});u.execCommand("mceInsertContent",!1,e,{skip_undo:!0})}),!0);this.imagePath=a,l.registerHandler(i,c)}function _(e,t){var n=u.formatter.get(e)[0],o=u.dom.create(n.inline,{style:n.styles,class:n.classes});o.appendChild(r.document.createTextNode(t)),u.execCommand("mceInsertContent",!1,"".concat(x(o),"&nbsp;"),{skip_undo:!0})}},dn=(fn.regularExpressions={_REGEXES:{WIKI_MACRO:/(?:\s|^)(\{[^{^}]+)$/,WIKI_LINK:/(?:\s|^)(\[[^\[^\]]+)$/,WIKI_EMBED:/(?:\s|^)(![^!]{5,})$/},_REGEXES_EMOTICON:{SMILE:/\B(:-?)$/,SAD:/\B(:-?)$/,CHEEKY:/\B(:-?)$/,CHEEKY_2:/\B(:-?)$/,LAUGH:/\B(:-?)$/,WINK:/\B(;-?)$/,THUMBS_UP:/\B(\(y)$/,THUMBS_DOWN:/\B(\(n)$/,INFORMATION:/\B(\(i)$/,TICK:/\B(\(\/)$/,CROSS:/\B(\(x)$/,WARNING:/\B(\(!)$/,PLUS:/\B(\(\+)$/,MINUS:/\B(\(-)$/,QUESTION:/\B(\(\?)$/,LIGHT_ON:/\B(\(on)$/,LIGHT_OFF:/\B(\(off)$/,YELLOW_STAR:/\B(\(\*)$/,YELLOW_STAR_2:/\B(\(\*y)$/,RED_STAR:/\B(\(\*r)$/,GREEN_STAR:/\B(\(\*g)$/,BLUE_STAR:/\B(\(\*b)$/,HEART:/\B(<)$/,BROKEN_HEAR:/\B(<\/)$/}},0),mn={fixedOffset:0,leftOffset:0,marginTop:0,objDocument:o.a.document,objHead:"head",objWindow:o.a,scrollableArea:o.a,cacheHeaderHeight:!1};function pn(e,t){var n=this;n.$el=c()(e),n.el=e,n.id=dn++,n.$el.bind("destroyed",c.a.proxy(n.teardown,n)),n.$clonedHeader=null,n.$originalHeader=null,n.cachedHeaderHeight=null,n.isSticky=!1,n.hasBeenSticky=!1,n.leftOffset=null,n.topOffset=null,n.init=function(){n.setOptions(t),n.$el.each((function(){var e=c()(this);e.css("padding",0),n.$originalHeader=c()("thead:first",this),n.$clonedHeader=n.$originalHeader.clone(),e.trigger("clonedHeader.".concat("stickyTableHeaders"),[n.$clonedHeader]),n.$clonedHeader.addClass("tableFloatingHeader"),n.$clonedHeader.css("display","none"),n.$originalHeader.addClass("tableFloatingHeaderOriginal"),n.$originalHeader.after(n.$clonedHeader),n.$printStyle=c()('<style type="text/css" media="print">.tableFloatingHeader{display:none !important;}.tableFloatingHeaderOriginal{position:static !important;}</style>'),n.$head.append(n.$printStyle)})),n.updateWidth(),n.toggleHeaders(),n.bind()},n.destroy=function(){n.$el.unbind("destroyed",n.teardown),n.teardown()},n.teardown=function(){n.isSticky&&n.$originalHeader.css("position","static"),c.a.removeData(n.el,"plugin_".concat("stickyTableHeaders")),n.unbind(),n.$clonedHeader.remove(),n.$originalHeader.removeClass("tableFloatingHeaderOriginal"),n.$originalHeader.css("visibility","visible"),n.$printStyle.remove(),n.el=null,n.$el=null},n.bind=function(){n.$scrollableArea.on("scroll.".concat("stickyTableHeaders"),n.toggleHeaders),n.isWindowScrolling||(n.$window.on("scroll.".concat("stickyTableHeaders").concat(n.id),n.setPositionValues),n.$window.on("resize.".concat("stickyTableHeaders").concat(n.id),n.toggleHeaders)),n.$scrollableArea.on("resize.".concat("stickyTableHeaders"),n.toggleHeaders),n.$scrollableArea.on("resize.".concat("stickyTableHeaders"),n.updateWidth)},n.unbind=function(){n.$scrollableArea.off(".".concat("stickyTableHeaders"),n.toggleHeaders),n.isWindowScrolling||(n.$window.off(".".concat("stickyTableHeaders").concat(n.id),n.setPositionValues),n.$window.off(".".concat("stickyTableHeaders").concat(n.id),n.toggleHeaders)),n.$scrollableArea.off(".".concat("stickyTableHeaders"),n.updateWidth)},n.debounce=function(e,t){var n=null;return function(){var r=this,o=arguments;clearTimeout(n),n=setTimeout((function(){e.apply(r,o)}),t)}},n.toggleHeaders=n.debounce((function(){n.$el&&n.$el.each((function(){var e,t=c()(this),r=n.isWindowScrolling?isNaN(n.options.fixedOffset)?n.options.fixedOffset.outerHeight():n.options.fixedOffset:n.$scrollableArea.offset().top+(isNaN(n.options.fixedOffset)?0:n.options.fixedOffset),o=t.offset(),i=n.$scrollableArea.scrollTop()+r,a=n.$scrollableArea.scrollLeft(),u=n.options.cacheHeaderHeight?n.cachedHeaderHeight:n.$clonedHeader.height(),l=n.isWindowScrolling?i>o.top:r>o.top,s=(n.isWindowScrolling?i:0)<o.top+t.height()-u-(n.isWindowScrolling?0:r);l&&s?(e=o.left-a+n.options.leftOffset,n.$originalHeader.css({position:"fixed","margin-top":n.options.marginTop,left:e,"z-index":3}),n.leftOffset=e,n.topOffset=r,n.$clonedHeader.css("display",""),n.isSticky||(n.isSticky=!0,n.updateWidth(),t.trigger("enabledStickiness.".concat("stickyTableHeaders"))),n.setPositionValues()):n.isSticky&&(n.$originalHeader.css("position","static"),n.$clonedHeader.css("display","none"),n.isSticky=!1,n.resetWidth(c()("td,th",n.$clonedHeader),c()("td,th",n.$originalHeader)),t.trigger("disabledStickiness.".concat("stickyTableHeaders")))}))}),0),n.setPositionValues=n.debounce((function(){var e=n.$window.scrollTop(),t=n.$window.scrollLeft();!n.isSticky||e<0||e+n.$window.height()>n.$document.height()||t<0||t+n.$window.width()>n.$document.width()||n.$originalHeader.css({top:n.topOffset-(n.isWindowScrolling?0:e),left:n.leftOffset-(n.isWindowScrolling?0:t)})}),0),n.updateWidth=n.debounce((function(){if(n.isSticky){n.$originalHeaderCells||(n.$originalHeaderCells=c()("th,td",n.$originalHeader)),n.$clonedHeaderCells||(n.$clonedHeaderCells=c()("th,td",n.$clonedHeader));var e=n.getWidth(n.$clonedHeaderCells);n.setWidth(e,n.$clonedHeaderCells,n.$originalHeaderCells),n.$originalHeader.css("width",n.$clonedHeader.width()),n.options.cacheHeaderHeight&&(n.cachedHeaderHeight=n.$clonedHeader.height())}}),0),n.getWidth=function(e){var t=[];return e.each((function(e){var r,i=c()(this);if("border-box"===i.css("box-sizing")){var a=i[0].getBoundingClientRect();r=a.width?a.width:a.right-a.left}else{if("collapse"===c()("th",n.$originalHeader).css("border-collapse"))if(o.a.getComputedStyle)r=parseFloat(o.a.getComputedStyle(this,null).width);else{var u=parseFloat(i.css("padding-left")),l=parseFloat(i.css("padding-right")),s=parseFloat(i.css("border-width"));r=i.outerWidth()-u-l-s}else r=i.width()}t[e]=r})),t},n.setWidth=function(e,t,n){t.each((function(t){var r=e[t];n.eq(t).css({"min-width":r,"max-width":r})}))},n.resetWidth=function(e,t){e.each((function(e){var n=c()(this);t.eq(e).css({"min-width":n.css("min-width"),"max-width":n.css("max-width")})}))},n.setOptions=function(e){n.options=c.a.extend({},mn,e),n.$window=c()(n.options.objWindow),n.$head=c()(n.options.objHead),n.$document=c()(n.options.objDocument),n.$scrollableArea=c()(n.options.scrollableArea),n.isWindowScrolling=n.$scrollableArea[0]===n.$window[0]},n.updateOptions=function(e){n.setOptions(e),n.unbind(),n.bind(),n.updateWidth(),n.toggleHeaders()},n.init()}c.a.fn.stickyTableHeaders=function(e){return this.each((function(){var t=c.a.data(this,"plugin_".concat("stickyTableHeaders"));t?"string"==typeof e?t[e].apply(t):t.updateOptions(e):"destroy"!==e&&c.a.data(this,"plugin_".concat("stickyTableHeaders"),new pn(this,e))}))};var gn=function(e){return!(e.parents("table").length>0)},hn=function(e){return!(e.closest(".columnLayout").length>0)},vn=function(){return!c()("body").hasClass("theme-documentation")},bn=function(e){var t=c()(e);return vn()&&function(e){return!e.hasClass("stickyTableHeaders")}(t)&&hn(t)&&gn(t)&&function(e){return e.find("> thead:first").is(":visible")}(t)&&function(e){return 1===e.find("thead").children().length}(t)&&function(e){return 1===e.find(".confluenceTh").parent().length}(t)&&function(e){return e.find(".confluenceTh").siblings().hasClass("confluenceTh")}(t)},yn=function(e,t){var n=t||c()(window);e.closest(".table-wrap").scroll((function(){n.trigger("scroll.stickyTableHeaders")}))},wn=function(e){c()(e).each((function(){var e=c()(this),t=e.find(".confluenceTh[rowspan]").length>0,n=e.find("> :first-child > :first-child .confluenceTh"),r=n.length&&n.closest("thead").length>0,o=n.length&&0===n.parent().index();if(gn(e)&&hn(e)&&!r&&o&&!t){var i=c()("<thead />").append(n.parent());e.prepend(i)}}))},Cn=vn,xn=function(e,t){var n=e.filter((function(){return bn(this)}));n.stickyTableHeaders(t).addClass("stickyTableHeaders"),u("sticky-table-headers.change.options",(function(e,t){n.stickyTableHeaders(t)})),yn(n)},Sn=function(){var e=c()(".confluenceTable"),t=c()(window);if(Cn()){if(wn(e),window.MutationObserver){var n=document.querySelector("#page");if(!n)return;var r=/sticky|tableFloating|confluenceTh/;new MutationObserver(c.a.debounce((function(e){for(var n,o=!1,i=0,a=e.length;i<a;i++)if(n=e[i].target.className,!r.test(n)){o=!0;break}o&&t.trigger("resize.stickyTableHeaders")}),0)).observe(n,{subtree:!0,attributes:!0,childList:!0})}xn(e,{cacheHeaderHeight:!0})}},kn=function(e,t){var n=r.tinymce.activeEditor;if(n){var o=function(e){var t={};return t.objWindow=c()(e.getWin()),t.scrollableArea=t.objWindow,t.objDocument=c()(e.getDoc()),t.objHead=t.objDocument.find("head"),t}(n),i=c.a.extend({},o,t),a=e.filter((function(){return bn(this)}));a.stickyTableHeaders(i).addClass("stickyTableHeaders"),yn(a,i.objWindow)}},Tn=function(){var e=r.tinymce.activeEditor;if(e){var t=c()(e.getBody()).find(".confluenceTable");wn(t),kn(t)}};var En={init:function(e){var t=r.Confluence.Editor;function n(){if(t.UI.isFormEnabled()&&e.isDirty()&&!t.isEmpty())return e.translate("unsaved.comment.lost")}e.on("Init",(function(){u("beforeunload",n)})),e.on("Remove",(function(){l("beforeunload",n)}))},getInfo:function(){return{longname:"Confluence Leave Comment",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}};var An={init:function(e){var t=r.Confluence.Editor;function n(){if(t.UI.isFormEnabled()&&e.isDirty()&&!t.isEmpty())return e.translate("unsaved.template.lost")}e.on("Init",(function(){u("beforeunload",n)})),e.on("Remove",(function(){l("beforeunload",n)}))},getInfo:function(){return{longname:"Confluence Leave Template",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}};var _n=function(){return{init:function(e){var t,n=r.Confluence.Editor.Drafts,i=r.Confluence.Editor;function a(){var e,t,n;e=F.get("draft-id"),t=F.get("draft-share-id"),0!==parseInt(e)&&o.a.history&&o.a.history.replaceState&&o.a.history.replaceState(null,"","".concat(ye,"/pages/resumedraft.action?draftId=").concat(e,"&draftShareId=").concat(t,"&").concat(void 0===(n=o.a.location.search)?"":("?"===n.charAt(0)&&(n=n.substr(1)),n.split("&").filter((function(e){return 0===e.indexOf("username=")||0===e.indexOf("userFullName=")||0===e.indexOf("accessType=")||0===e.indexOf("grantAccess=")||0===e.indexOf("src.")})).join("&")))),i.UI.cancelButton.attr("data-tooltip",ge("editor.shared.draft.done.desc")),i.UI.cancelButton.on("click",(function(){s("analytics",{name:"confluence.editor.done.button.clicked"}),s("analytics",{name:"confluence.editor.close",data:{source:"closeButton",contentId:F.get("content-id"),currentVersion:F.get("page-version")||"null"}})}))}function f(){if(!F.get("has-collaborated")&&r.AJS.Rte.Content.editorHasContentChanged()){F.set("has-collaborated",!0);var e=F.get("remote-user-key"),t=F.get("content-id");c.a.ajax({type:"PUT",url:"".concat(ye,"/rest/experimental/relation/user/").concat(e,"/collaborator/toContent/").concat(t,"?targetStatus=draft"),error:function(){F.set("has-collaborated",!1)}}),c.a.ajax({type:"DELETE",url:"".concat(ye,"/rest/experimental/relation/touched/from/user/current/to/content/").concat(t,"?targetStatus=current")}),c.a.ajax({type:"PUT",url:"".concat(ye,"/rest/experimental/relation/user/").concat(e,"/touched/toContent/").concat(t,"?targetStatus=draft"),error:function(){F.set("has-collaborated",!1)}})}}var d=function(e){return c()("#draft-status").show(),n.bindUnloadMessage(),i.UI.cancelButton.click((function(){F.getBoolean("shared-drafts")||n.save({skipErrorHandler:!0})})),F.getBoolean("shared-drafts")&&a(),o.a.setInterval(n.save,+F.get("draft-save-interval")||3e4)};e.on("Init",(function(){u("editor.local.change",f)})),e.on("Remove",(function(){l("editor.local.change",f)})),u("rte-ready",(function(){t=d()})),u("rte-destroyed",(function(){clearInterval(t)}))},getInfo:function(){return{longname:"Confluence Drafts",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}}};var Nn={init:function(e){e.on("Init",(function(){e.addCommand("mceConfMacroBrowser",r.tinymce.confluence.macrobrowser.macroBrowserToolbarButtonClicked)}))},getInfo:function(){return{longname:"Confluence Macro Browser",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}},Rn={init:function(e){e.on("init",(function(){if(F.get("use-watch")){var e={userWatchingOwnContent:F.get("user-watching-own-content")};c()("#rte-savebar-tinymce-plugin-point").append((t=function(e){return ge(e)},'\n    <ul class="toolbar-group toolbar-group-watch-page" id="toolbar-group-watch-page-after-comment">\n        <li class="toolbar-item">\n            <input id="watchPage" name="watchPageAfterComment" value="true" type="checkbox" '.concat(e.userWatchingOwnContent?'checked="checked"':"",'/>\n            <label for="watchPage">').concat(t("comment.notification.enable"),"</label>\n        </li>\n    </ul>\n")))}var t}))},getInfo:function(){return{longname:"Confluence Watch",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}},Dn={init:function(e){var t=function(e){c()(".tablesorter",e.node).each((function(e,t){var n,r,o=c()(t).find("thead");1===o.length&&"THEAD"===(o=o[0]).nodeName&&1===o.childNodes.length&&(r=o.removeChild(o.childNodes[0]),n=c()(t).find("tbody")[0],t.removeChild(o),n.insertBefore(r,n.childNodes[0]))}))};e.on("PastePostProcess",t),e.on("remove",(function(){e.off("PastePostProcess",t)}))},getInfo:function(){return{longname:"ConfluenceSortableTablesPlugin",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com",version:"1.0"}}},On={init:function(e){e.on("Init",(function(){e.getBody().classList.add("resizable")}));var t=0;if(!e.getParam("fullscreen_is_enabled")){var n=parseInt(e.getParam("autoresize_min_height","".concat(e.getElement().offsetHeight))),o=parseInt(e.getParam("autoresize_max_height","0"));e.on("Change SetContent Paste KeyUp Init",i),e.addCommand("mceAutoResize",i)}function i(a){var u=e.getDoc(),l=u.body,s=u.documentElement,f=r.tinymce.DOM,d=n,m=a===Object(a)&&a.forceExec||!1,p=c()(u).height();if(p>n&&(d=p),o&&p>o?(d=o,l.style.overflowY="auto",s.style.overflowY="auto"):(l.style.overflowY="hidden",s.style.overflowY="hidden",l.scrollTop=0),m||d!==t){var g=d-t;f.setStyle(document.querySelectorAll("div.tox-tinymce")[0],"height","".concat(d,"px")),f.setStyle(f.get("".concat(e.id,"_ifr")),"height","".concat(d,"px")),t=d,r.tinymce.Env.webkit&&g<0&&i()}return!0}},getInfo:function(){return{longname:"Auto Resize",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/autoresize",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}},In=function(){function e(e){return e.nodeValue.toLowerCase()}return{search:function(t,n,r,o,i){var a=t.getSel(),c=function e(t){var n=[];if(t.nodeType===Node.TEXT_NODE)n.push(t);else for(var r=t.childNodes,o=0,i=r.length;o<i;++o)n.push.apply(n,e(r[o]));return n}(o);n=n.replace(/\s/g,"").toLowerCase();var u=c.map(e).join("");r=function(e,t,n){var r=e.getRng();if(r&&r.endContainer.nodeValue){var o=n.indexOf(r.endContainer.nodeValue.toLowerCase(),t)+r.endOffset;t=t!==o&&-1!==t?o:t}return t}(t,r,u);var l,s,f,d,m,p=(l=u,s=n,f=r,(m=(d=i)?l.lastIndexOf(s,f-1):l.indexOf(s,f))<0&&!d?m=l.indexOf(s):0===m&&0===f&&d&&(m=l.lastIndexOf(s)),m);if(p<0)return[!1,p];var g=function(e,t,n){for(var r,o,i,a,c=0,u=0;u<t.length;u++){if(t[u].nodeType===Node.TEXT_NODE){var l=e+n.length;!o&&t[u].length+c>=l&&(o=t[u],a=l-c),!r&&t[u].length+c>e&&(r=t[u],i=e-c),c+=t[u].length}if(r&&o)return{startNode:r,startIndex:i,endNode:o,endIndex:a}}}(p,c,n),h=document.createRange();return h.setStart(g.startNode,g.startIndex),h.setEnd(g.endNode,g.endIndex),a&&a.removeAllRanges(),a&&a.addRange(h),h.startContainer.parentNode&&h.startContainer.parentNode.scrollIntoView(),[!0,p]}}},Pn=function(){var e=In(),t=r.tinymce.Env.browser.isEdge,n=function e(t){var n=t,r=null,o=null,i=null,a=null,c=null,u={initialised:!1,find:function(e,t,n){var o=r.getFindInput().val(),a=i.findText(o,!0,e);a&&t?t():!a&&n&&n()},replace:function(e,t){var n=r.getFindInput(),o=r.getReplaceInput(),a="";o&&(a=o.val());var c=i.replaceText(n.val(),a,!0);c&&e?e():!c&&t&&t()},replaceAll:function(e,t){var n=r.getFindInput(),o=r.getReplaceInput(),a="";o&&(a=o.val());var c=i.replaceAll(n.val(),a);c&&e?e():!c&&t&&t()},focus:function(){r.focusFindTextBox()},isVisible:function(){return null!=r},init:function(){r=e.UI(n,a,c),(o=new e.MarkManager).addListener(r),i=null,i=new e.impl(r,o),r.getFindInput().focus()},onVisible:function(e){if(null!=e&&e.length>0){var t=r.getFindInput(),n=t.val();t.val(n+e)}r.onVisible()},onHide:function(){a=r.getFindInput().val(),c=r.getReplaceInput().val(),i.destroy(),i=null,r.destroy(),r=null,o.destroy(),o=null},_clearSavedValues:function(){a=null,c=null}};return u};return n.utils={moveCursorToEnd:function(e){if(r.tinymce.Env.gecko){var t=c()(e).val().length;e.setSelectionRange(t,t)}},createTextRange:function(e,t){return e.selection?e.selection.createRange():t.getBody().createTextRange()}},n.impl=function(n,o){var i=new r.tinymce.html.Writer,a=o,c=-1,u=function n(o,i,u){if(!o)return!1;var l=r.tinymce.activeEditor,s=l.selection,f=l.getWin();function d(){return l.undoManager.ignore((function(){a.markCurrentlySelectedRange()})),!0}function m(){return l.undoManager.ignore((function(){a.removeCurrentMark(!0),r.tinymce.activeEditor.selection.isCollapsed()||r.tinymce.activeEditor.selection.collapse()})),!1}if(a.isCursorAtCurrentMark()&&l.undoManager.ignore((function(){s=a.selectCurrentMark()})),s.isCollapsed()||s.collapse(u),r.tinymce.Env.gecko)return f.find(o,!1,u)?d():i?(s.select(l.getBody(),!1),s.collapse(!u),n(o,!1,u)):m();if(!t())return f.find(o,!1,u,!0,!1,!1,!1)?d():m();var p=e.search(s,o,c,l.getBody(),u);return c=p[1],p[0]?d():void 0},l=function(e){var t=r.tinymce.activeEditor;i.text(e,!1),t.selection.setContent(i.getContent(),{format:"raw"}),i.reset(),t.selection.collapse(!0)},s={};return s.findText=u,s.replaceText=function(e,t,n){var o=r.tinymce.activeEditor;return a.hasCurrentMark()?(o.undoManager.transact((function(){var e=a.replaceCurrentMark(t);e&&o.selection.select(e)})),u(e,n)):u(e,n)},s.replaceAll=function(n,o){var i=r.tinymce.activeEditor,c=0;return i.undoManager.transact((function(){var u=i.selection,s=i.getWin();if(a.removeCurrentMark(!1),i.execCommand("selectAll"),i.selection.collapse(!0),t())for(var f=-1;;){var d=e.search(u,n,f,i.getBody(),!1);if(!d[0])break;f=d[1],l(o),c++}else for(;s.find(n,!1,!1,!1,!1,!1,!1);)l(o),c++;if(0===c)r.Confluence.EditorNotification.notify("info",i.translate("searchreplace_dlg.notfound"));else if(1===c)r.Confluence.EditorNotification.notify("success",i.translate("searchreplace_dlg.allreplacedsingular"));else if(c>1){var m=i.translate("searchreplace_dlg.allreplacedplural");r.Confluence.EditorNotification.notify("success",m.replace("{0}",c))}})),c},s.destroy=function(){a=null,i=null},s},n.UI=function(e,t,o){var i=null,a=n.utils.moveCursorToEnd;r.tinymce.activeEditor&&r.tinymce.activeEditor.plugins&&r.tinymce.activeEditor.plugins.customtoolbar&&(i=r.tinymce.activeEditor.plugins.customtoolbar.getToolbarRow(e));var u=function(){return c()(".toolbar-find-input",i)},l=function(){return c()(".toolbar-replace-input",i)},s=function(e){if("input"===e.type||"propertychange"===e.type){var t=u(),n="string"==typeof t.val()&&t.val().length>0;d(n),m(n)}},f=function(){var e=u();h(e&&e.val())},d=function(e){e?(r.tinymce.activeEditor.plugins.customtoolbar.enableToolbarButton("search-toolbar-find-next-button"),r.tinymce.activeEditor.plugins.customtoolbar.enableToolbarButton("search-toolbar-find-previous-button")):(r.tinymce.activeEditor.plugins.customtoolbar.disableToolbarButton("search-toolbar-find-next-button"),r.tinymce.activeEditor.plugins.customtoolbar.disableToolbarButton("search-toolbar-find-previous-button"))},m=function(e){var t=u();p().toggleClass("default-action",e&&t.val().length>0)},p=function(){return c()(".search-toolbar-find-next-button",i).closest(".aui-button")},g=function(e){var t=r.tinymce.activeEditor.plugins.customtoolbar;e?t.enableToolbarButton("search-toolbar-replace-button"):t.disableToolbarButton("search-toolbar-replace-button")},h=function(e){var t=r.tinymce.activeEditor.plugins.customtoolbar;e?t.enableToolbarButton("search-toolbar-replaceall-button"):t.disableToolbarButton("search-toolbar-replaceall-button")},v={};return v.getFindInput=u,v.getReplaceInput=l,v.focusFindTextBox=function(){top.focus(),u().focus()},v.onVisible=function(){var e=u();e.focus(),e.val().length>0&&(a(e[0]),d(!0),h(!0))},v.destroy=function(){},v.marked=function(){g(!0)},v.markRemoved=function(){g(!1)},function(e,t){var n=u(),r=!1;(e&&e.length&&(n.val(e),r=!0),t&&t.length)&&l().val(t);!function(){function e(e,t){e&&e.bind("input",t)}var t=u();e(t,s),e(t,f),c()(i).focusin((function(){m(!0)})).focusout((function(){m(!1)})),t.focus((function(){m(!0)}))}(),d(r),h(r),g(!1)}(t,o),v},n.MarkManager=function(){var e=null,t=new r.tinymce.html.Writer,n=null,o=[],i=function(){l()},a=function(){if(!e)return null;var t=r.tinymce.activeEditor;return t.selection.select(e[0]),t.selection},u=function(t){g(),(s(e,t)||n&&r.tinymce.activeEditor.selection.getRng().toString()==n)&&(e=null,n=null,c.a.each(o,(function(e,t){t.markRemoved()})))},l=function(){g(),c()("mark",r.tinymce.activeEditor.getDoc()).each((function(e,t){s(c()(t),!1)})),e=null,n=null,c.a.each(o,(function(e,t){t.markRemoved()}))},s=function(e,t){var n=r.tinymce.activeEditor.selection.getRng();if(!e)return!1;var o=function(e,t){if(e.intersectsNode)return e.intersectsNode(t);var n=r.tinymce.activeEditor.getDoc().createRange();return n.selectNodeContents(t),!(e.compareBoundaryPoints(Range.START_TO_END,n)<=0||e.compareBoundaryPoints(Range.END_TO_START,n)>=0)}(n,e[0]),i=null,a=null;if(e.contents().each((function(t,n){e.before(n),i||(i=n),a=n})),o||t){var c=r.tinymce.activeEditor.selection.getRng();c.setStartBefore(i),c.setEndAfter(a),t||c.collapse(!1),r.tinymce.activeEditor.selection.setRng(c)}return e.remove(),!0},f=function(){return!!e||(n?r.tinymce.activeEditor.selection.getRng().toString()==n:void 0)},d=function(){l()},m=function(){g(),c.a.each(o,(function(e,t){t.markRemoved()}))},p=function(e){var t=r.tinymce.activeEditor;t.on("Change",i),t.on("BeforeSetContent",i),e&&(t.on("Click",m),t.on("DblClick",m))},g=function(){var e=r.tinymce.activeEditor;e.off("Change",i),e.off("BeforeSetContent",i),e.off("Click",m),e.off("DblClick",m)},h={markCurrentlySelectedRange:function(){var t=r.tinymce.activeEditor;if(e){var i=t.selection.getBookmark();u(!1),t.selection.moveToBookmark(i)}n=null;var l=t.selection.getRng();if(e=c()('<mark data-searching class="find-current"></mark>',t.getDoc()),l)try{l.surroundContents(e[0]),p(!1)}catch(t){1==t.code&&(n=l.toString(),e=null,p(!0))}if(c.a.each(o,(function(e,t){t.marked()})),!n){var s=a();s&&s.collapse()}}};return h.removeCurrentMark=u,h.removeAllMarks=l,h.selectCurrentMark=a,h.isCursorAtCurrentMark=function(){if(!e)return!1;var t=r.tinymce.activeEditor.selection;t.isCollapsed()||t.collapse();var n=t.getRng();if(n){if(3===n.startContainer.nodeType)return n.startContainer.parentNode&&n.startContainer.parentNode.normalize(),n.startContainer.nextSibling===e[0]||n.startContainer.previousSibling===e[0];if(1===n.startContainer.nodeType){var o=n.startContainer.childNodes,i=n.startOffset;return i>0&&o[i-1]===e[0]||i+1<o.length&&o[i+1]===e[0]}}},h.hasCurrentMark=f,h.replaceCurrentMark=function(n){if(function(n){if(e||!f())return!1;var o=r.tinymce.activeEditor;return o.undoManager.transact((function(){t.text(n,!1),o.selection.setContent(t.getContent(),{format:"raw"}),t.reset()})),o.undoManager.ignore((function(){u(!1)})),!0}(n))return null;if(!e)return null;var o=r.tinymce.activeEditor,i=[];o.undoManager.ignore((function(){e.contents().each((function(e,t){i.push(t)})),u(!1)}));var a=void 0;return o.undoManager.transact((function(){a=c()(i[0]).before(o.getDoc().createTextNode(n))[0].previousSibling;for(var e=i.length-1;e>=0;e--)c()(i[e]).remove()})),a},h.addListener=function(e){o.push(e)},h.destroy=function(){u(!0),r.tinymce.activeEditor.off("BeforeGetContent",d)},r.tinymce.activeEditor.on("BeforeGetContent",d),h},n},Bn=function(){k(r.document,"initContextToolbars.Toolbar",(function(e,t){var n;r.Confluence.Editor.searchToolbar=(n=r.Confluence.Editor,{initContextToolbars:function(e,t){var o=function(e){if(r.tinymce.Env.gecko){var t=c()(e).val().length;e.setSelectionRange(t,t)}},i=function(e){top.focus(),r.tinymce.activeEditor.plugins.customtoolbar.focusToolbarButton(e)},a=function(){top.focus();var e=c()("#search-toolbar-find-text");e.focus(),o(e[0])},u=function(){top.focus();var e=c()("#search-toolbar-replace-text");e.focus(),o(e[0])},l=function(){if(r.tinymce.Env.gecko){var e=r.tinymce.activeEditor;e.focus(),e.selection.select(e.getBody()),e.selection.collapse(!1),e.focus()}},s=new n.Toolbar.Components.TextBox({id:"search-toolbar-find-text",text:t.translate("searchreplace_dlg.findlabel"),name:"find",keydown:function(e){if((e.ctrlKey||r.tinymce.isMac&&e.metaKey)&&70===e.which)e.preventDefault();else if(13===e.which){e.preventDefault();var t={backwards:!1,onFound:a,onNotFound:a};r.tinymce.activeEditor.undoManager.ignore((function(){r.tinymce.activeEditor.execCommand("mceConfSearch",!1,t,{skip_undo:!0})}))}else 27===e.which&&(e.preventDefault(),r.tinymce.activeEditor.undoManager.ignore((function(){r.tinymce.activeEditor.execCommand("mceSearchReplaceToolbar",!1,!1,{skip_undo:!0})})))},cssClass:"toolbar-find-input"}),f=new n.Toolbar.Components.TextBox({id:"search-toolbar-replace-text",text:t.translate("searchreplace_dlg.replacelabel"),name:"replace",keydown:function(e){if((e.ctrlKey||r.tinymce.isMac&&e.metaKey)&&70===e.which)e.preventDefault();else if(13===e.which){e.preventDefault();var t=r.tinymce.activeEditor.undoManager.ignore((function(){r.tinymce.activeEditor.execCommand("mceConfSearch",!1,{backwards:!1,onFound:u,onNotFound:a},{skip_undo:!0})}));g(u,a,t)}else 27===e.which&&(e.preventDefault(),r.tinymce.activeEditor.undoManager.ignore((function(){r.tinymce.activeEditor.execCommand("mceSearchReplaceToolbar",!1,!1,{skip_undo:!0})})))},cssClass:"toolbar-replace-input"}),d=new n.Toolbar.Components.TextButton({text:t.translate("searchreplace_dlg.findprevious"),click:function(){var e={backwards:!0,onFound:function(){top.focus(),i("search-toolbar-find-previous-button")},onNotFound:a};t.undoManager.ignore((function(){t.execCommand("mceConfSearch",!1,e,{skip_undo:!0})}))},textClass:"search-toolbar-find-previous-button"}),m=new n.Toolbar.Components.TextButton({text:t.translate("searchreplace_dlg.findnext"),click:function(){var e={backwards:!1,onFound:function(){top.focus(),i("search-toolbar-find-next-button")},onNotFound:a};t.undoManager.ignore((function(){t.execCommand("mceConfSearch",!1,e,{skip_undo:!0})}))},textClass:"search-toolbar-find-next-button"}),p=new n.Toolbar.Components.TextButton({text:t.translate("searchreplace_dlg.replace"),click:function(){g((function(){top.focus(),i("search-toolbar-replace-button")}),a)},textClass:"search-toolbar-replace-button"}),g=function(e,t,n){r.Confluence.Editor.searchManager&&(r.tinymce.activeEditor.plugins.customtoolbar.isToolbarButtonEnabled("search-toolbar-replace-button")?r.Confluence.Editor.searchManager.replace(e,t):n&&n())},h=new n.Toolbar.Components.TextButton({text:t.translate("searchreplace_dlg.replaceall"),click:function(){var e={onReplaced:l,onNotReplaced:a};t.undoManager.transact((function(){t.execCommand("mceConfReplaceAll",!1,e)}))},textClass:"search-toolbar-replaceall-button"}),v=new n.Toolbar.Components.Button({text:t.translate("searchreplace_dlg.close"),iconClass:"icon aui-icon aui-icon-small aui-iconfont-close-dialog",click:function(){t.undoManager.ignore((function(){t.execCommand("mceConfSearchClose",!1,null)}))}});return{Buttons:[new n.Toolbar.Components.Group([v],{groupClass:"close"}),new n.Toolbar.Components.Group([s,f],{groupClass:"no-separator"}),new n.Toolbar.Components.Group([d,m]),new n.Toolbar.Components.Group([p,h])]}}}).initContextToolbars(e,t)}))};function Mn(){var e=r.Confluence.Editor,t=null,n=!1,o=function(e){e.preventDefault(),e.stopPropagation()},i=function(e){o(e);var n=e.which;n||(n=e.charCode?e.charCode:e.keyCode),n<48||t.push(n)},a=function(e){var t=c()("#rte-button-searchreplace a");t.length&&(e?t.unbind("click",!1):t.bind("click",!1))},u=function(){if(!n){n=!0;var u=c()("#rte-button-searchreplace"),l=!u.hasClass("active"),s=c()("body"),f=!s.hasClass("no-tools")||s.hasClass("no-tools-toolbars-visible");l?(u.addClass("active"),e.searchManager||(e.searchManager=new e.SearchManager("searchreplace")),c()(r.document).trigger("createContextToolbarRow.Toolbar",{id:"searchreplace",buttons:e.searchToolbar.Buttons,topToolbar:!0,editorAdjacent:!0,animate:f,onVisible:function(){var c=function(){var e=r.tinymce.activeEditor;e.off("KeyDown",i),e.off("KeyPress",o),e.off("KeyUp",o);for(var n,a="",c=0;c<t.length;c++)a+=(n=t[c])>65535?(n-=65536,String.fromCharCode(55296+(n>>10),56320+(1023&n))):String.fromCharCode(n);return a.toLowerCase()}();e.searchManager.onVisible(c),a(!0),n=!1,e.searchManager.initialised=!0}}).trigger("enableContextToolbarRow.Toolbar"),function(){var e=r.tinymce.activeEditor;t=[],e.on("KeyDown",i),e.on("KeyPress",o),e.on("KeyUp",o)}(),e.searchManager.init(),a(!1)):(u.removeClass("active"),e.searchManager.onHide(),c()(r.document).trigger("removeContextToolbarRow.Toolbar",{id:"searchreplace",animate:f,onHide:function(){c()(r.document).trigger("contextToolbarRowRemoved.Toolbar"),a(!0),n=!1,e.searchManager.initialised=!1}}),a(!1),r.tinymce.Env.gecko||frames.wysiwygTextarea_ifr.focus(),r.tinymce.activeEditor.focus())}};return{init:function(t){t.addCommand("mceSearchReplaceToolbar",(function(){return t.undoManager.ignore((function(){u()})),!1})),t.addCommand("mceConfSearch",(function(n,r){return!!e.searchManager&&((r=r||{}).backwards&&!t.plugins.customtoolbar.isToolbarButtonEnabled("search-toolbar-find-previous-button")?(e.searchManager.focus(),!1):r.backwards||t.plugins.customtoolbar.isToolbarButtonEnabled("search-toolbar-find-next-button")?(e.searchManager.find(r.backwards,r.onFound,r.onNotFound),!1):(e.searchManager.focus(),!1))})),t.addCommand("mceConfReplaceAll",(function(n,r){return!!e.searchManager&&(r=r||{},!!t.plugins.customtoolbar.isToolbarButtonEnabled("search-toolbar-replaceall-button")&&(e.searchManager.replaceAll(r.onReplaced,r.onNotReplaced),!1))})),t.addCommand("mceConfSearchClose",(function(){return!!e.searchManager&&(t.undoManager.ignore((function(){t.execCommand("mceSearchReplaceToolbar",!1,null)})),!1)})),t.ui.registry.addButton("searchreplace",{text:"searchreplace.search_desc",onAction:function(){t.execCommand("mceSearchReplaceToolbar")}}),t.shortcuts.add("meta+f","searchreplace.search_desc",(function(){e.searchManager&&e.searchManager.isVisible()?e.searchManager.focus():t.undoManager.ignore((function(){t.execCommand("mceSearchReplaceToolbar",!1,!1,{skip_undo:!0})}))}))},getInfo:function(){return{longname:"Search/Replace",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}}}function Ln(e){return(Ln="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Fn="object"===("undefined"==typeof window?"undefined":Ln(window))?window.localStorage:{},jn=function(e,t){var n=F.get("remote-user")||"",r="".concat(e,".").concat(n,".").concat(t),o=!1,i=/\d+#/,a=function(e){if(!o)return null;var t,n=Fn.getItem("".concat(r,".").concat(e));return n&&(t=i.exec(n))&&(n=n.replace(t[0],""),+new Date>Number(t[0].replace("#","")))?(Fn.removeItem("".concat(r,".").concat(e)),null):n};try{o=Object.keys(Fn).length}catch(e){console.log("Browser does not support localStorage, Confluence.storageManager will not work.")}return{getItem:a,getAllItems:function(){if(!o)return null;var e={};for(var t in Fn)if(Fn.hasOwnProperty(t)&&t.indexOf("".concat(r,"."))>-1){var n=t.split("".concat(r,"."))[1];e[n]=a(n)}return e},doesContain:function(e){return!!a(e)},getItemAsBoolean:function(e){var t=a(e);return"false"!==t&&("true"===t||!!t)},setItem:function(e,t,n){var i;o&&(t=((i=1e3*(n||0))?+new Date+i+"#":"")+t,Fn.setItem("".concat(r,".").concat(e),t))},setItemQuietly:function(e,t,n){try{this.setItem(e,t,n)}catch(n){console.log("Unable to write to localStorage. key: ".concat(e,", value: ").concat(t,", cause: ").concat(n))}},removeItem:function(e){o&&Fn.removeItem("".concat(r,".").concat(e))}}}("confluence","userSettings");function Hn(e,t){return t?"".concat(e,".").concat(t.replace(/\./g,"-")):e}var Un,zn={get:function(e,t,n){var r=Hn(e,t),o=jn.getItem(r);return null!==o?JSON.parse(o):void 0!==n?n:null},set:function(e,t,n,r){var o=Hn(e,t);if(r===n)jn.removeItem(o);else{jn.setItem(o,JSON.stringify(r),2592e3)}}},Wn={init:function(e){e.on("init",(function(){var e={contentId:F.get("content-id")},t=c()("#rte-savebar-tinymce-plugin-point");t.append('\n    <span class="minor-edit toolbar-item">\n        <input id="notifyWatchers" name="notifyWatchers" value="true" type="checkbox" checked>\n        <label for="notifyWatchers">\n          <span>'.concat(function(e){return ge(e)}("editor.minor.edit"),"</span>\n        </label>\n    </span>\n"));var n=t[0].querySelector('input[id="notifyWatchers"]'),r=zn.get("notifyWatchers",e.contentId,!0);null!==r&&(n.checked=r),k(n,"change",(function(){zn.set("notifyWatchers",e.contentId,!0,n.checked)}))}))},getInfo:function(){return{longname:"Confluence Notify Watchers",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}};function Vn(e,t){var n=c.a.parseHTML(e),r=[Node.ELEMENT_NODE,Node.DOCUMENT_NODE,Node.DOCUMENT_FRAGMENT_NODE],o=!1;return n.forEach((function(e){(Un.dom.is(e,t)||r.includes(e.nodeType)&&e.querySelector(t))&&(o=!0)})),o}function qn(){s("analytics",{name:"confluence.table.image.insert",data:{pageId:F.get("page-id"),tableMode:Kn()}})}function $n(){return!!c()(Un.selection.getNode()).closest("table.confluenceTable").length}function Kn(){var e=c()(Un.selection.getNode()).closest("table.confluenceTable");return e.hasClass("fixed-table")||e.hasClass("fixed-width")?"fixed":e.hasClass("relative-table")?"relative":"fluid"}function Gn(){var e=c()(Un.getBody()).find("table.confluenceTable");s("analytics",{name:"confluence.table.quality.in.page",data:{pageId:F.get("page-id"),total:e.length,fixed:e.filter(".fixed-table,.fixed-width").length,fluid:e.filter(":not(.fixed-table,.relative-table,.fixed-width)").length,relative:e.filter(".relative-table").length,nested:e.find("table.confluenceTable").length}})}var Jn={init:function(e){function t(e,t){$n()&&function(e){var t,n;e&&e.name&&e.name.indexOf("confluence.editor.image.resize")>=0&&s("analytics",{name:"confluence.table.img.resize",data:{pageId:F.get("page-id"),tableMode:Kn(),isImgBiggerCell:(t=c()(Un.selection.getNode()),n=t.closest("th, td"),t.width()>n.width())}})}(t)}Un=e,e.on("ExecCommand",(function(e){switch(e.command){case"mceAutoWidth":case"mceRelativeWidth":case"mceFixedWidth":s("analytics",{name:"confluence.table.mode.to.".concat(Kn()),data:{pageId:F.get("page-id")}});break;case"mceTableCopyRow":s("analytics",{name:"confluence.table.row.copy",data:{pageId:F.get("page-id")}});break;case"mceTablePasteRowBefore":case"mceTablePasteRowAfter":s("analytics",{name:"confluence.table.row.paste",data:{pageId:F.get("page-id")}});break;case"mceTableCopyCol":s("analytics",{name:"confluence.table.col.copy",data:{pageId:F.get("page-id")}});break;case"mceTablePasteColBefore":case"mceTablePasteColAfter":s("analytics",{name:"confluence.table.col.paste",data:{pageId:F.get("page-id")}});break;case"mceInsertContent":Vn(t=e.value,"img")&&$n()&&qn(),Vn(t,"table.confluenceTable")&&s("analytics",{name:"confluence.table.paste",data:{pageId:F.get("page-id")}});break;case"confTableSelectionToggleHighlight":s("analytics",{name:"confluence.editor.table.selection.toggle.highlight",data:{color:c()("#table-highlight-group").attr("data-highlight-colour")}})}var t})),e.on("Init",(function(){e.on("SetContent",(function(e){$n()&&e&&function(e){Vn(e.content,".confluence-embedded-image")&&qn()}(e)}))})),u("analyticsEvent",t),u("rte.safe-save.success",Gn),e.on("Remove",(function(){l("analyticsEvent",t),l("rte.safe-save.success",Gn)}))},getInfo:function(){return{longname:"Table Analytics Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}};function Xn(e,t,n){n&&n.node&&c()(".inline-comment-marker",n.node).contents().unwrap()}var Yn={init:function(e){e.on("beforeExecCommand",(function(t){if("Indent"===t.command||"Outdent"===t.command){var n=e.selection.getNode(),r=n.nodeName.toLowerCase();if("li"!==r&&"body"!==r){var o=parseInt(e.dom.getStyle(n,"margin-left",!1)||0,10)+parseInt(e.dom.getStyle(n,"padding-left",!1)||0,10);if(0!==o){var i=e.settings.indentation,a=/[a-z%]+/i.exec(i);e.dom.setStyle(n,"padding-left",""),e.dom.setStyle(n,"margin-left",o+a[0])}}}}))},getInfo:function(){return{longname:"Confluence Indentation",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}},Qn=function(e){if(!e)return null;var t=e.endOffset;return 3===e.endContainer.nodeType?e.endContainer:e.endContainer.childNodes[t-1]},Zn=function(e,t){if(t&&t.previousSibling&&t.previousSibling.hasChildNodes()){var n=t.previousSibling,r=n.childNodes.length,o=n.childNodes[r-1],i=o.length,a=e.dom.createRng();a.setStart(o,i),a.setEnd(o,i),e.selection.setRng(a)}},er={init:function(e){e.on("KeyDown",(function(t){r.tinymce.VK.modifierPressed(t)||32!==t.keyCode||function(e){var t=e.selection.getNode(),n=c()(t).closest("a"),r=e.selection.getRng();n.length&&r&&w.isCursorAtEnd(e,r)&&(r.setStartAfter(n[0]),r.setEndAfter(n[0]),e.selection.setRng(r),e.selection.collapse())}(e),r.tinymce.VK.modifierPressed(t)||8!==t.keyCode&&37!==t.keyCode||function(e){if(e.selection.isCollapsed()&&!function(e){return!!e.dom.getParents(e.selection.getNode(),"#autocomplete-search-text").length}(e)){var t=Qn(e.selection.getRng());t&&t.nodeValue&&65279===t.nodeValue.charCodeAt(0)&&function(e,t){return 1==t.nodeValue.length&&1==e.selection.getNode().childNodes.length}(e,t)&&e.undoManager.ignore((function(){Zn(e,t),t.parentNode&&t.parentNode.removeChild(t)}))}}(e)}))}};function tr(e){for(var t=e.offsetTop;e.offsetParent;)t+=(e=e.offsetParent).offsetTop;return t}function nr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function rr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var or=new(function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),rr(this,"_namespace",void 0),rr(this,"_sessionStorageSupported",void 0);var o=F.get("remote-user")||"";this._namespace="".concat(t,".").concat(o,".").concat(n),this._sessionStorageSupported=!!r.sessionStorage}var t,n,o;return t=e,(n=[{key:"getItem",value:function(e){return this._sessionStorageSupported?r.sessionStorage.getItem("".concat(this._namespace,".").concat(e)):null}},{key:"doesContain",value:function(e){return!!this.getItem(e)}},{key:"setItem",value:function(e,t){if(this._sessionStorageSupported)try{r.sessionStorage.setItem("".concat(this._namespace,".").concat(e),t)}catch(n){console.error("Unable to write to sessionStorage. key: ".concat(e,", value: ").concat(t,", cause: ").concat(n))}}},{key:"removeItem",value:function(e){this._sessionStorageSupported&&r.sessionStorage.removeItem("".concat(this._namespace,".").concat(e))}}])&&nr(t.prototype,n),o&&nr(t,o),e}())("atlassian","frontend"),ir=function(e){var t=[];return Array.from(e).forEach((function(e,n){(function(e,t){var n=t?t.documentElement:r.document.documentElement;if(e&&n){var o=e.getBoundingClientRect(),i=o.top,a=o.bottom,c=n.offsetHeight;return 0<=i&&i<c||0<=a&&a<=c||i<=0&&0<=a&&a>=c}})(e)&&t.push({targetElementIndex:n,visibleBlockEl:e})})),t},ar=function(e){var t=ir(e),n=null;return t.some((function(e){return!!function(e,t){var n=t?t.documentElement:r.document.documentElement;if(e&&n){var o=e.getBoundingClientRect().top,i=n.offsetHeight;return 0<=o&&o<i}}(e.visibleBlockEl)&&(n=e,!0)})),!n&&t.length>0?t[0]:n||{targetElementIndex:-1,visibleBlockEl:null}};function cr(e,t){if(!e||0===t)return null;var n={targetElementIndex:-1,offsetBetweenTargetAndCurrentScroll:0,columnLayoutPosition:{columnIndex:-1,rowIndex:-1}};if(function(e){if(!e)return!1;var t=e.children[0];return t&&t.classList.contains("contentLayout2")}(e)){var r=e.children[0].children,o=ar(r),i=o.targetElementIndex,a=o.visibleBlockEl;if(a){var c=function(e){var t={targetElementIndexInColumn:-1,columnIndex:-1,visibleBlockEl:null};return Array.from(e).some((function(e,n){var r=ar(e.children),o=r.visibleBlockEl,i=r.targetElementIndex;return!!o&&(t.columnIndex=n,t.targetElementIndexInColumn=i,t.visibleBlockEl=o,!0)})),t}(a.getElementsByClassName("innerCell")),u=c.columnIndex,l=c.targetElementIndexInColumn,s=c.visibleBlockEl;s&&(n.targetElementIndex=l,n.offsetBetweenTargetAndCurrentScroll=t-tr(s),n.columnLayoutPosition={rowIndex:i,columnIndex:u})}}else{var f=ar(e.children),d=f.targetElementIndex,m=f.visibleBlockEl;m&&(n.targetElementIndex=d,n.offsetBetweenTargetAndCurrentScroll=t-tr(m),delete n.columnLayoutPosition)}return-1!==n.targetElementIndex?n:null}var ur={_saveScrollPosition:function(e){var t,n,i,a,c,u,l,s;e.getDoc()&&e.getWin()&&(t={contentId:_e(),isInViewPage:!1,docObject:e.getDoc(),winObject:e.getWin()},n=t.contentId,i=t.isInViewPage,a=t.docObject,c=void 0===a?r.document:a,u=t.winObject,l=void 0===u?o.a:u,(s=cr(i?c.getElementById("main-content"):c.body,l.pageYOffset))&&(s.contentId=n,s.isInViewPage=i,or.setItem("editor-persit-scroll-position",JSON.stringify(s))))},_restoreScrollPositionIfNeeded:function(e){e.getDoc()&&e.getWin()&&function(e){var t=e.contentId,n=e.isInViewPage,i=e.docObject,a=void 0===i?r.document:i,c=e.winObject,u=void 0===c?o.a:c,l=or.getItem("editor-persit-scroll-position");try{l=JSON.parse(l)}catch(e){0}finally{or.removeItem("editor-persit-scroll-position")}if(l&&l.contentId===t&&l.isInViewPage!==n){var s;s=n?a.getElementById("main-content"):a.body;var f,d=l.columnLayoutPosition;if(d){var m=s.children[0].children[d.rowIndex].getElementsByClassName("innerCell")[d.columnIndex];f=m&&m.children[l.targetElementIndex]}else f=s.children[l.targetElementIndex];if(f){var p=tr(f)+l.offsetBetweenTargetAndCurrentScroll;setTimeout((function(){return u.scrollTo(0,p)}),1)}}}({contentId:_e(),isInViewPage:!1,docObject:e.getDoc(),winObject:e.getWin()})},init:function(e){var t=F.get("content-type");"page"!==t&&"blogpost"!==t||(u("rte-collab-ready",(function(){ur._restoreScrollPositionIfNeeded(e)})),u("rte-ready",(function(){r.Confluence.Editor.UI.cancelButton.click((function(){return ur._saveScrollPosition(e)})),r.Confluence.Editor.UI.saveButton.click((function(){return ur._saveScrollPosition(e)}))})))},getInfo:function(){return{longname:"Persist scroll position for transition between view page and edit page",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}},lr={init:function(e){e.on("init",(function(){e.getBody().classList.add("template-editor")}))}};function sr(e){return e.parentNode&&e.parentNode.childNodes||[]}function fr(e){var t=sr(e);return function(e){var t=!0,n=/TABLE|TH|TD/;return t=(t=(t=!n.test(e.nodeName))&&e.previousSibling?!n.test(e.previousSibling.nodeName):t)&&e.nextSibling?!n.test(e.nextSibling.nodeName):t}(e)&&(function(e){var t=function(e){return e&&e.innerHTML&&(e.innerHTML.replace(/\uFEFF|\u200B/g,"")||"&nbsp;")}(e);return/^&nbsp;$/.test(t)}(e)||t.length>1&&"BR"==t[0].nodeName)}function dr(e,t){e.dom.remove(t)}var mr={init:function(e){var t=e.getParam("atl_macro_class","wysiwyg-macro"),n=function(e){return 3===e.nodeType},o=function(t,n){return e.dom.getParent(t,n)},i=function(e){return n(e)?e.length:e.childNodes.length},a=function(e){return o(e,"table."+t)},c=function(e){return null!==a(e)},u=function(e,t){return e.bottom<=t.top&&e.top<t.bottom},l=function(e,t){return e.top>=t.bottom&&e.bottom>t.top},s=function(e,t){var n=e.childNodes;if(0===n.length)return{node:e,offset:t};if(t<n.length)return{node:n[t],offset:0};var r=n[n.length-1];return"img"===e.nodeName.toLowerCase()?{node:r,offset:1}:{node:r,offset:i(r)}},f=function(t){if(function(e){return 1===e.nodeType}(t))return r.tinymce.toArray(t.getClientRects());if(n(t)){var o=e.dom.createRng();return o.selectNode(t),r.tinymce.toArray(o.getClientRects())}return[]},d=function(t,o){return function(t,r){var o=e.selection.getRng();if(o){var i=s(1===t?o.startContainer:o.endContainer,1===t?o.startOffset:o.endOffset),a=i.node;if(n(a)&&i.offset>0){var c=a.splitText(i.offset),u=r(1===t?a:c);return 0===c.length&&e.dom.remove(c),u}return r(a)}}(o,(function(e){return function(e,t,n,o){var i,a=new r.tinymce.dom.TreeWalker(e,t),c=1===n?a.prev:a.next,s=1===n?u:l,d=e,m=0,p=[];do{var g=f(d).filter((function(e){return 0!==e.height&&0!==e.width}));if(0!==g.length&&(1===n&&g.reverse(),g.forEach((function(e){if(0!==e.height&&0!==e.width){i&&s(e,i)&&m++;var t=p[m];p[m]=t?t.concat([e]):[e],i=e}})),o(p)))return p}while(d=c());return p}(e,t,o,(function(e){return e.length>1})).length<=1}))},m=function(t,n){var r=e.selection.getRng();if(r){var o=1===n?r.startContainer:r.endContainer,a=1===n?r.startOffset:r.endOffset;return(1===n&&a<=0||-1===n&&a>=i(o))&&function(e,t,n){for(var r,o=s(n?t.startContainer:t.endContainer,n?t.startOffset:t.endOffset),a={node:e,offset:n?0:i(e)};!r||a.node!==r.node;){if(o.node===a.node&&o.offset===a.offset)return!0;r=a,a=s(a.node,a.offset)}return!1}(t,r,1===n)}};e.on("init",(function(){e.on("keydown",(function(t){var n,o,u=e.selection.getRng(),l=function(e){return(e.keyCode===r.tinymce.util.VK.LEFT||e.keyCode===r.tinymce.util.VK.RIGHT)&&e.shiftKey}(t),f=function(e){return(e.keyCode===r.tinymce.util.VK.UP||e.keyCode===r.tinymce.util.VK.DOWN)&&e.shiftKey}(t);if((l||f)&&u&&function(e){return c(e.startContainer)&&c(e.endContainer)}(u)){var p=(n=u.startContainer,o=a(n),e.dom.select("th,td",o)[0]),g=t.keyCode===r.tinymce.util.VK.UP||t.keyCode===r.tinymce.util.VK.LEFT?1:-1,h=f&&d(p,g),v=l&&m(p,g);(h||v)&&(!function(t,n){var r=e.selection.getRng();if(r){var o=r.cloneRange(),a=s(t,n?0:i(t));n?o.setStart(a.node,a.offset):o.setEnd(a.node,a.offset),e.selection.setRng(o,!n)}}(p,1===g),t.preventDefault(),t.stopImmediatePropagation())}if(t.keyCode===r.tinymce.util.VK.ENTER||t.keyCode===r.tinymce.util.VK.BACKSPACE||t.keyCode===r.tinymce.util.VK.DELETE){if(!u||u.collapsed)return;e.getDoc().querySelectorAll("".concat("td.wysiwyg-macro-body","[data-mce-selected]")).forEach((function(e){e.removeAttribute("data-mce-selected")}))}}),!0),e.on("mouseup",(function(t){if(3===t.detail){var n=e.selection.getRng();if(n){var r=o(n.startContainer,"td.wysiwyg-macro-body"),i=o(n.endContainer,"td.wysiwyg-macro-body");if(r===i)return;if(null!==r&&!r.contains(n.endContainer)&&r.lastChild){var a=e.dom.createRng();a.setStart(n.startContainer,n.startOffset),a.setEndAfter(r.lastChild),e.selection.setRng(a,!0)}if(null!==i&&!i.contains(n.startContainer)&&i.firstChild){var c=e.dom.createRng();c.setStartBefore(i.firstChild),c.setEnd(n.endContainer,n.endOffset),e.selection.setRng(c,!0)}}}}))}))},getInfo:function(){return{longname:"Macro Navigation",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}},pr={offset:function(e){var t=c()(e).offset(),n=r.tinymce.activeEditor.iframeElement,o=c()(n).offset(),i=n.contentWindow.document,a=c()(r.tinymce.activeEditor.getBody()),u=c.a.support.boxModel&&i.documentElement.scrollTop||a.scrollTop(),l=c.a.support.boxModel&&i.documentElement.scrollLeft||a.scrollLeft();return{top:t.top-u+o.top,left:t.left-l+o.left}},getSelectedText:function(){var e=r.tinymce.activeEditor.selection;return e.getRng().text||e.getSel()&&e.getSel().toString&&e.getSel().toString()||""},setHtml:function(e){e&&r.tinymce.activeEditor.setContent(e)},getHtml:function(){return"".concat(r.tinymce.activeEditor.getContent())},isEmpty:function(){var e=r.tinymce.activeEditor.getContent().replace("&nbsp;","").replace("<br />","");return"<p></p>"===e.trim()||0===e.length},editorHasContentChanged:function(){return r.tinymce.activeEditor.isDirty()},editorResetContentChanged:function(){r.tinymce.activeEditor.setDirty(!1)},getChildIndex:function(e,t){for(var n=e.childNodes,r=0,o=n.length;r<o;r++)if(n[r]==t)return r;return-1}},gr=function(){void 0!==r.AJS.Rte&&void 0===r.AJS.Rte.Content&&(r.AJS.Rte.Content=pr)};function hr(){r.tinymce.activeEditor.getBody().style.height="auto"}function vr(){return"undefined"!=typeof window?window.location:void 0}function br(){if(window&&window.require){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return window.require.apply(window,t)}}var yr=function(){u("init.rte",(function(){var e;r.Confluence.EditorNotification={notify:function(t,n,r){var o=br("aui/flag");void 0!==e&&"true"!==e.getAttribute("aria-hidden")&&e.close(),void 0===r&&(r="error"===t?"manual":"auto"),e=o({type:t,body:n,close:r})}}}))},wr=n("./node_modules/@atlassian/aui-template/src/template.js"),Cr=n.n(wr);function xr(){return{component:function(e){var t,n=function(e){0};return e=e||{},e=c.a.extend({},{keypressListener:function(r){if(27===r.keyCode)n(),c()(".aui-dropdown",t.popup.element).is(":visible")||("function"==typeof e.onCancel?e.onCancel():t.hide());else if(13===r.keyCode){if(n(),!c()(".aui-dropdown",t.popup.element).is(":visible"))"textarea"!=(r.target.nodeName&&r.target.nodeName.toLowerCase())&&"function"==typeof e.onSubmit&&setTimeout(e.onSubmit)}},width:865,height:530},e),t=new v.a.Dialog(e),r.document.addEventListener("hideLayer",(function(n,r,o){"popup"==r&&o==t&&"function"==typeof e.onCancel&&e.onCancel()})),t},initialiser:function(e){var t=this;u("show.dialog",(function(e,t){var n,r=F.get("page-id"),o=F.get("space-key"),i=F.get("editor-mode"),a=F.get("new-page");v.a.EventQueue=v.a.EventQueue||[],v.a.EventQueue.push({name:t.dialog.id,properties:(n={},r&&(n.pageid=r),o&&(n.spacekey=o),i&&(n.editormode=i),a&&(n.newpage=a),n)})})),r.document.addEventListener("showLayer",(function(t,n,o){r.Confluence.runBinderComponents(),"popup"==n&&o&&function(t){var n,o=e(t);if(!o.attr("data-lasttab-override")){o.attr("data-tab-default")&&(n=o.attr("data-tab-default"));var i=r.Confluence.storageManager(o.attr("id")),a=i.getItem("last-tab"),c=null!=a?a:n;c&&e(".page-menu-item:visible:eq(".concat(c,") button"),o).click(),o.attr("data-lasttab-bound")||(e(".page-menu-item",o).each((function(t,n){e(n).click((function(){i.setItem("last-tab",t)}))})),o.attr("data-lasttab-bound","true"))}}(o.element)})),v.a.Dialog.prototype.overrideLastTab=function(){e(t.popup.element).attr("data-lasttab-override","true")},v.a.Dialog.prototype.addHelpText=function(n,r){if(n){var o=n;r&&(o=Cr()(n).fill(r).toString());var i=t.page[t.curpage];i.buttonpanel||i.addButtonPanel();var a=e("<div class='dialog-tip'></div>").html(o);i.buttonpanel.append(a),e("a",a).click((function(){var e=window.open(t.href,"_blank");return e&&e.focus(),e&&e.opener&&(e.opener=null),!1}))}},v.a.Dialog.prototype.getTitle=function(){return e("#".concat(t.id,".dialog-components:visible h2")).text()},v.a.Dialog.prototype.isVisible=function(){return e("#".concat(t.id)).is(":visible")}}}}var Sr=function(){var e={Button:function(e){var t=e.text,n=e.tooltip,r=e.triggerText,o=e.iconClass,i=e.click,a=!!e.disabled,u=e.id;this.render=function(){var e=c()('<button type="button"></button>').addClass("aui-button aui-button-subtle").attr("data-tooltip",n||t);if(u&&e.attr("id",u),a&&e.prop("disabled",!0).attr("aria-disabled","true"),e.click((function(){e.prop("disabled")||i()})),o){var l=c()("<span />");l.addClass("icon ".concat(o)),l.text(t),e.append(l)}if(r){var s=c()("<span />");s.addClass("trigger-text"),s.text(r),e.append(s)}return e[0]}},DropDownButton:function(e){var t,n=e.id,r=e.tooltip,o=e.text||"",i=e.iconClass,a=!!e.disabled,u=e.dropDownContent;this.render=function(){var e=c()("<div></div>").addClass("toolbar-item").addClass("toolbar-dropdown").attr("data-tooltip",r);e.attr("id",n);var l=c()("<div/>").addClass("aui-dd-parent"),s=c()("<a href='#'></a>");if(s.addClass("toolbar-trigger").addClass("aui-dd-trigger").addClass("aui-button"),o&&s.append('<span class="dropdown-text">'.concat(o,"</span>")),a&&(e.addClass("disabled"),s.addClass("disabled")),i){var f=c()("<span />");f.addClass("icon ".concat(i)),f.text(o),s.append(f)}var d=c()("<span/>");return d.addClass("icon").addClass("icon-dropdown"),s.append(d),t=c()("<div/>").addClass("hidden").addClass("aui-dropdown"),u&&t.append(u),l.append(s),l.append(t),e.append(l),e[0]}},TextButton:function(e){var t=e.text,n=e.textClass,r=e.click,o=!!e.disabled,i=e.tooltip;this.render=function(){var e=c()('<button type="button"></button>').addClass("aui-button aui-button-subtle").addClass(n).text(t);return i&&e.attr("data-tooltip",i),o&&e.prop("disabled",!0).attr("aria-disabled","true"),e.click((function(){e.prop("disabled")||r()})),e[0]}},TextBox:function(e){var t=e.id,n=e.text,r=e.name,o=e.keydown,i=e.cssClass;this.render=function(){var e=c()("<div></div>").addClass("toolbar-item");e.append(c()('<label for="'.concat(t,'">').concat(n,"</label>")));var a=c()('<input id="'.concat(t,'" type="text" name="').concat(r,'" class="').concat(i,' text" autocomplete="off">'));return a.keydown((function(e){o(e)})),e.append(a),e[0]}},Group:function(e,t){var n=e;this.render=function(){var e=c()("<div></div>");e.addClass("aui-buttons"),t&&(t.id&&e.attr("id",t.id),t.groupClass&&e.addClass(t.groupClass));for(var r=0,o=n.length;r<o;r++)e.append(n[r].render());return e[0]}}};return e.SplitGroup=function(e,t){var n=e,r=t&&t.dropDownOptions||{};this.render=function(){var e=c()("<div></div>");e.addClass("aui-buttons"),t&&(t.id&&e.attr("id",t.id),t.groupClass&&e.addClass(t.groupClass));for(var o=0,i=n.length;o<i;o++)e.append(n[o].render());return e.append(function(){var e=r.id,t=r.disabled,n=r.dropDownContent,o=r.title,i=r.alignment,a=c()("<div></div>").addClass("toolbar-item").addClass("toolbar-dropdown").addClass("toolbar-splitbutton");e&&a.attr("id",e),o&&a.attr({"data-tooltip":o}),i&&a.data("dropdown-alignment",i);var u=c()("<div/>").addClass("aui-dd-parent"),l=c()("<a href='#'></a>");l.addClass("toolbar-trigger aui-dd-trigger aui-button"),t&&(a.addClass("disabled"),l.addClass("disabled"));var s=c()("<span/>");s.addClass("icon").addClass("icon-dropdown"),l.append(s);var f=c()("<div/>").addClass("hidden").addClass("aui-dropdown");return n&&f.append(n),u.append(l),u.append(f),a.append(u),a[0]}()),t&&t.postProcess&&t.postProcess(e),e[0]}},o.a.Confluence.Editor.Toolbar={},o.a.Confluence.Editor.Toolbar.Components=e,e},kr=function(){var e,t,n,o,i,a,u,l,s,f,d,m,p,g,h,v,b,y,w={},C=!1;var x=function(){u.css({top:c()("#insert-table-dropdown").outerHeight(!0)}),x=function(){}};function S(){var t;u.hasClass("hidden")||(t=c()(r.tinymce.activeEditor.getDoc()),e.unbind(".atlassian-table-picker"),t.unbind(".atlassian-table-picker"),u.addClass("hidden"),n.addClass("hidden"),a.removeClass("active"))}function k(e,t){e==v&&t==b||(e=Math.max(1,Math.min(15,e)),t=Math.max(1,Math.min(20,t)),g=Math.max(4,e),h=Math.max(4,t),v=e,b=t,l.width(25*g+1),l.height(17*h+20),E(s,g,h),E(d,v,b),E(f,g,1),E(m,v,1),T(),p.text("".concat(v," x ").concat(b)))}function T(){f.toggleClass("hidden",!y),m.toggleClass("hidden",!y)}function E(e,t,n){e.width(25*t+1),e.height(17*n+1)}function A(t){var n=s.offset(),r=n.top-e.scrollTop(),o=n.left-e.scrollLeft(),i=r+s.outerHeight(!0)+0,a=i-17-0,c=o+s.outerWidth(!0)+0,u=c-25-0,l=t.clientY,f=t.clientX,d=g,m=h;f>c?d+=~~((f-c)/25+1):f<u&&(d+=~~((f-u)/25-1)),l>i?m+=~~((l-i)/17+1):l<a&&(m+=~~((l-a)/17-1)),k(d,m)}function N(e){var n=function(e){var t=1+~~(~~(e.offsetX||e.originalEvent.layerX)/25),n=1+~~(~~(e.offsetY||e.originalEvent.layerY)/17);return t<1||t>15||n<1||n>20?null:{width:t,height:n}}(e);if(e.preventDefault(),n)if(S(),_("confluence.editor.tinymce.tables")){var o={columns:n.width,rows:n.height,options:{headerRows:y?1:0}};r.tinymce.activeEditor.execCommand("mceInsertTable",!1,o)}else!function(e,n,o){var i,a;0;var u=c()("#tinymce-table-form");u.length?(u.find('input[name="rows"]').val(n),u.find('input[name="cols"]').val(e)):(i=r.AJS.renderTemplate("tableForm",n,e),(a=c()("<div></div>").addClass("hidden")).append(i),t.append(a));c()("#table-heading-checkbox").prop("checked",o),ke(),r.tinymce.activeEditor.undoManager.beforeChange();var l={cols:e,rows:n,heading:o};r.tinymce.activeEditor.execCommand("confInsertTable",!1,l),a&&a.remove()}(n.width,n.height,y)}function R(e){0===e.charCode&&function(e){e!=y&&(y=e,T())}(!e.shiftKey),27===e.keyCode&&S()}function D(){S()}return w.insertTable=N,{bindToControl:function(){e=c()(r.document),t=e.find("body"),o=c()("#insert-table-dropdown"),i=c()("#rte-button-insert-table"),a=o.find(".aui-dd-parent"),u=c()("#table-picker-container"),l=u.find(".table-picker-box"),s=u.find(".picker-cell"),f=u.find(".picker-heading"),d=u.find(".picker-selected-cell"),m=u.find(".picker-selected-heading"),p=l.find(".desc"),n=c()("<div></div>").attr("id","table-picker-backdrop").addClass("hidden").appendTo(o),i.click((function(t){var o;t.preventDefault(),C||(Se(),x(),y=!0,k(1,1),o=c()(r.tinymce.activeEditor.getDoc()),e.bind("mousemove.atlassian-table-picker",A),e.bind("keydown.atlassian-table-picker",R),e.bind("keyup.atlassian-table-picker",R),o.bind("keydown.atlassian-table-picker",R),o.bind("keyup.atlassian-table-picker",R),n.removeClass("hidden"),u.removeClass("hidden"),a.addClass("active"),i.focus())})),n.click(D),d.click(N),m.click(N)},disable:function(){C=!0,o.addClass("disabled")},enable:function(){C=!1,o.removeClass("disabled"),i.attr("data-tooltip",ge("tinymce.tablepicker.insert_table_title"))},close:S,_internal:w}};var Tr=[];function Er(){c()(".tipsy").remove()}function Ar(){var e=/\+/g;setTimeout((function(){c()("#rte-savebar .aui-button[title]").each((function(){var t=c()(this),n=t.attr("title");if(t.removeAttr("title"),r.tinymce.Env.mac){var o=n.indexOf("(");o>=0&&(n=n.substr(0,o)+n.substr(o).replace(e,""))}t.attr("data-tooltip",n)}))}),0)}function _r(e,t,n){if("dropdown"===t&&(c()(".tipsy").remove(),n&&n.trigger&&n.trigger.jquery)){var r=n.trigger.data("tipsy");r&&(r.hoverState="out")}}function Nr(){(function(e){e.fn.tipsy.autoBounds2=function(t,n){return function(){var r={},o=e(document).scrollTop()+t,i=e(document).scrollLeft()+t,a=e(this);return n.length>1?(r.ns=n[0],r.ew=n[1]):"e"==n[0]||"w"==n[0]?r.ew=n[0]:r.ns=n[0],a.offset().top<o&&(r.ns="n"),a.offset().left<i&&(r.ew="w"),e(window).width()+e(document).scrollLeft()-(a.offset().left+a.width())<t&&(r.ew="e"),e(window).height()+e(document).scrollTop()-(a.offset().top+a.height())<t&&(r.ns="s"),r.ns?r.ns+(r.ew?r.ew:""):r.ew}}})(c.a);var e={live:!0,gravity:"n",title:function(){return c()(this).attr("data-tooltip")||""},delayIn:250,delayOut:0},t=c.a.fn.tipsy.autoBounds2(50,"n"),n=c.a.fn.tipsy.autoBounds2(50,"w"),o=c.a.extend({},e,{gravity:t}),i=c.a.extend({},e,{gravity:n}),a=c.a.extend({},e,{gravity:"se"});c()("#rte-toolbar [data-tooltip]:not(.dropdown-item)").tooltip(o),c()("#rte-toolbar .dropdown-item[data-tooltip]").tooltip(i),c()("#rte-savebar [data-tooltip]").tooltip(a),c()("#editor-precursor [data-tooltip]").tooltip(o),c()("#property-panel [data-tooltip]").tooltip(o),k(r.document,"showLayer",_r),k(r.document,"hideLayer",_r),u("created.property-panel",Er),u("destroyed.property-panel",Er),u("register-contexts.keyboardshortcuts",Ar)}function Rr(){var e=r.Confluence.Editor,t=!1;function n(e){var t=function(){e&&e.hide()};k(r.document,"showLayer",(function(n,o,i){if("dropdown"==o&&i==e){var a=r.tinymce.activeEditor;a.on("Click",t),a.on("KeyUp",t)}})),k(r.document,"hideLayer",(function(n,o,i){if("dropdown"==o&&i==e){var a=r.tinymce.activeEditor;a.off("Click",t),a.off("KeyUp",t)}}))}function i(e){e.addCallback("show",(function(){e.$.parents(".disabled").length&&e.hide()}))}function a(e,n){if(!t){var r=p(n);c()("#".concat(r)).removeClass("disabled")}}function u(e,t){var n=p(t);c()("#".concat(n)).addClass("disabled")}function s(e,n){n?e.closest(".aui-button").prop("disabled",!0).attr("aria-disabled","true").toggleClass("disabled",n):t||e.closest(".aui-button").prop("disabled",!1).removeAttr("aria-disabled").toggleClass("disabled",n)}function f(e,n,r,o){var i=!!t||e,a=!!t||n,u=!!t||r,l=c()("#toolbar"),s=l.find(".toolbar-item"),f=c()("#insert-menu, #more-menu"),d=c()("#insert-menu, #color-picker-control"),m=c()("#format-dropdown"),p=o||function(){return!0};s.toggleClass("disabled",i),f.toggleClass("disabled",i),d.toggleClass("disabled",i),m.toggleClass("disabled",!!a),me().TablePicker[i?"disable":"enable"](),void 0!==u&&l.find("button, input").filter(p).toggleClass("disabled",u).prop("disabled",u)}var d,m=function(){return function(e){var t,n,r=e.element,o=(t=r,n=c()(t).closest("PRE,BLOCKQUOTE,.text-placeholder"),function(e){return n.is(e)}),i=o("BLOCKQUOTE"),a=o("PRE"),u=o(".text-placeholder");if(a)f(!0,c()(r).parents("table").is("[data-macro-body-type='PLAIN_TEXT']"));else if(u)f(!0);else if(i){f(!1),c()("#rte-button-justifyleft, #rte-button-justifycenter, #rte-button-justifyright").toggleClass("disabled",!0)}else f(!1)}};function p(e){var t="default";return e&&e.id&&(t=e.id),"rte-toolbar-row-".concat(t)}function g(e){return c()("#".concat(e)).length>0}function h(e,t){var n=t.animate;null==n&&(n=!0);var i=function(){c()(this).remove(),E(r.document,"resize.resizeplugin"),t.onHide&&t.onHide()};clearTimeout(d),d=o.a.setTimeout((function(){var e=p(t),r=c()("#".concat(e));n?r.slideUp(400,i):(r.hide(),i.call(r))}),100)}function v(e,n){if(!t){var i=p(n),a=n.animate;if(null==a&&(a=!0),g(i))c()("#".concat(i,":hidden")).slideDown(400,(function(){0}));else{var u=c()("<div></div>").addClass("toolbar-split toolbar-split-row toolbar-contextual");u.attr("id",i),n.editorAdjacent&&u.addClass("editor-adjacent");for(var l=n.topToolbar?c()("#rte-toolbar.aui-toolbar:visible"):c()("#savebar-container .aui-toolbar:visible"),s=0,f=n.buttons.length;s<f;s++){var m=n.buttons[s];u.append(m.render())}if(u.css({display:"none"}),n.editorAdjacent)l.append(u);else{var h=c()(".editor-adjacent",l).filter(":first");h.length?h.before(u):l.append(u)}u.find(".toolbar-dropdown").each((function(){b(this)}));var v=function(){E(r.document,"resize.resizeplugin"),E(r.document,"shown.contextToolbar"),n.onVisible&&n.onVisible()};clearTimeout(d),d=o.a.setTimeout((function(){a?u.slideDown(400,v):(u.show(),v())}),100)}}}function b(e){var o=c()(e),a=o.dropDown("Standard",{alignment:o.data("dropdown-alignment")||"left"})[0];o.find(".dropdown-item").click((function(e){!function(e){if(!t){var n=e.attr("data-macro-name"),o=e.attr("data-command"),i=e.attr("data-format"),a=e.attr("data-control-id"),c=r.tinymce.activeEditor;n&&Pe.macroBrowserToolbarButtonClicked({presetMacroName:n}),o&&c.execCommand(o,!1),i&&c.plugins.atlassiantheme.controlHandlers.formatselect.click.dispatch(i),a&&c.plugins.atlassiantheme.controlHandlers.buttons.click.dispatch(a.toLowerCase())}}(c()(this)),a.hide(),e.preventDefault()})),i(a),n(a)}function y(){var e=[];for(var t in{})e.push("hints.".concat(t));var n=function(e){if(!Array.isArray(e))throw new Error("Hints passed in must be an array of strings");var t=Math.floor(Math.random()*e.length);return{getNextHint:function(){var n=e[t];return t=(t+1)%e.length,n}}}(e),o=function(){c()("#rte-savebar .hints-text").html(r.tinymce.activeEditor.translate("tinymce.".concat(n.getNextHint())))};o(),c()("#rte-savebar a.hints-close").click((function(e){c()(this).closest(".toolbar-split").addClass("hidden"),e.preventDefault()})),c()("#rte-savebar a.hints-next").click((function(e){o(),e.preventDefault()}))}return{init:function(t){var o,s;b("#format-dropdown"),b("#more-menu .aui-dd-parent"),b("#insert-menu .aui-dd-parent"),c()("#pagelayout-menu").length&&b("#pagelayout-menu .aui-dd-parent"),c()("#template-menu").length&&b("#template-menu .aui-dd-parent"),function(){var e=c()("#color-picker-control");if(e.length){var t=e.find(".aui-dd-parent"),o=c()("#rte-button-color"),a=o.find(".selected-color"),u=t.dropDown("Standard",{alignment:"left"})[0],l=o.attr("data-color");a.css("background-color","#".concat(l)),e.delegate("a[data-color]","click",(function(e){var t=c()(this),n=t.attr("data-color");e.preventDefault(),t.closest(".disabled").length||(r.tinymce.execCommand("ForeColor",!1,"#".concat(n)),o.attr("data-color",n),a.css("background-color","#".concat(n)))})),i(u),n(u)}}(),me().TablePicker.bindToControl(r.tinymce.activeEditor,c()("#insert-table-dropdown")),(o=c()("#rte-button-source-mode")).click((function(){o.hasClass("active")?e.changeMode(e.MODE_RICHTEXT):e.changeMode(e.MODE_SOURCE)})),y(),s=t,E(r.document,"initContextToolbars.Toolbar",s),k(r.document,"createContextToolbarRow.Toolbar",v),k(r.document,"removeContextToolbarRow.Toolbar",h),k(r.document,"enableContextToolbarRow.Toolbar",a),k(r.document,"disableContextToolbarRow.Toolbar",u);var f=c()("#format-dropdown"),d=f.find("span.dropdown-text");t.on("BeforeExecCommand",(function(e){var n=e.command,r=e.value;if(c.a.each(["pre","blockquote"],(function(){"FormatBlock"==n&&r==this&&(t.formatter.remove("alignleft"),t.formatter.remove("aligncenter"),t.formatter.remove("alignright"))})),c()(t.selection.getNode()).closest("pre,.text-placeholder").length)for(var o=["Bold","Italic","Underline","Strikethrough","InsertUnorderedList","InsertOrderedList","InsertInlineTaskList","InsertInlineTaskListNoToggle","superscript","subscript","mceConfMacroBrowser","mceConfimage","mceConfAttachments","mceEmotion","InsertWikiMarkup","mceConflink","mceInsertTable","mceConfAutocompleteLink"],i=o.length,a=0;a<i;a++)n==o[a]&&e.preventDefault();if("FormatBlock"==n&&"pre"==r&&(t.undoManager.add(),t.execCommand("removeFormat")),"FormatBlock"==n&&"p"==r){var u=f.find(".dropdown-item[data-format='blockquote']").text();d.text()==u&&t.execCommand("FormatBlock",!1,"blockquote")}})),t.on("ExecCommand",(function(e){var t=e.command,n=e.value;if("FormatBlock"==t){var r=f.find(".dropdown-item[data-format='".concat(n,"']"));r.length||(r=f.find(".dropdown-item[data-format='p']")),d.text(r.text())}})),t.on("NodeChange",m()),t.on("init",(function(){var e={};c()(".aui-toolbar").find("[data-control-id]").each((function(n,r){var o=c()(r),i=o.attr("data-control-id");i&&("formatselect"==i?t.plugins.atlassiantheme.controlHandlers[i].state.add((function(e){if("p"==e){var n=t.selection.getNode();c()(n).closest("p").parent().is("blockquote")&&(e="blockquote")}var r=f.find(".dropdown-item[data-format='".concat(e,"']")).text();r&&d.text(r)})):e[i.toLowerCase()]=o)}));var n=t.plugins.atlassiantheme.controlHandlers.buttons;n.state.add((function(t,n,r){var o=e[t];if(o){var i=o.find(".icon-check"),a=o.closest(".toolbar-item");i.length?i.toggleClass("hidden",!r):a.toggleClass(n,r)}})),c()(".aui-toolbar").delegate(".toolbar-item","click",(function(e){var t=c()(this);if(t.hasClass("disabled"))e.preventDefault();else{var r=t.children(".toolbar-trigger[data-control-id]").attr("data-control-id");r&&(n.click.dispatch(r.toLowerCase()),e.preventDefault())}})),c.a.support.shrinkWrapBlocks=!1,Nr()})),t.on("Remove",(function(){T(r.document,"showLayer",_r),T(r.document,"hideLayer",_r),l("created.property-panel",Er),l("destroyed.property-panel",Er),l("register-contexts.keyboardshortcuts",Ar)}))},toggleToolbarButton:s,disableToolbarButton:function(e){s(c()(".".concat(e.replace(".",""))),!0)},enableToolbarButton:function(e){t||s(c()(".".concat(e.replace(".",""))),!1)},focusToolbarButton:function(e){t||c()(".".concat(e.replace(".",""))).closest(".aui-button").focus()},isToolbarRowEnabled:function(e){var t=p({id:e});return g(t)&&!c()("#".concat(t)).hasClass("disabled")},getToolbarRow:function(e){var t=p({id:e}),n=c()("#".concat(t));return n.length?n[0]:null},isToolbarButtonEnabled:function(e){return!c()(".".concat(e.replace(".",""))).closest(".aui-button").prop("disabled")},bindDropdownMenu:b,toggleToolbarButtons:f,disableToolbar:function(e){t=!!e},getInfo:function(){return{longname:"customtoolbar",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com/",version:"1.0"}}}}var Dr=n("./node_modules/querystring-es3/index.js"),Or=n.n(Dr);function Ir(e){return this.message=e.message,this.statusCode=e["status-code"],this.stack=(new Error).stack,this}Ir.prototype=new Error;var Pr=Ir;function Br(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Mr(e,t,n[t])}))}return e}function Mr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Lr=function(e,t){return e.replace(/:([a-zA-Z]+)\?*/g,(function(e,n){var r=t[n];return"string"==typeof r&&-1===r.indexOf("=")?encodeURIComponent(decodeURIComponent(r)):r.toString()}))};function Fr(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return function(r){if(r instanceof Pr){if(401===r.statusCode)return e.onUnauthorized&&e.onUnauthorized(),t(r);var o=n[r.statusCode];return o?o(r,t):t(r)}if(r instanceof TypeError)return t(r);throw r}}function jr(e,t,n){var r=t.body,o=t.callback,i=t.headers,a=t.method,c=t.extraConfig,u=t.responseTransformer,l=r,s=i["Content-Type"];return s||delete i["Content-Type"],s&&-1!==s.indexOf("application/x-www-form-urlencoded")?l=Or.a.stringify(r):"application/json"===s&&(l=JSON.stringify(r)),fetch(e,{headers:i,credentials:"include",method:a,body:l}).then((function(e){if(!e.ok){var t=e.status;return e.text().then((function(e){throw new Pr({message:e,"status-code":t})}))}return c&&c.ignoreResponseJson?null:204!==e.status?e.json():e})).then((function(t){if(t&&t["status-code"])throw new Pr(t);return o(null,u?u(t,e,n.contextPath,r):t)})).catch(Fr(n,o))}var Hr,Ur=(Hr={endpoint:null,contextPath:null,onUnauthorized:function(){},extraHeaders:{}},{configure:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Hr=Br({},Hr,e)},getConfig:function(){return Hr},getFullPath:function(e,t){var n=Hr.contextPath+e;return t?Lr(n,t):n},getExternalServicePath:function(e,t){if("function"!=typeof e)throw"getExternalServicePath expects path to be a function so it can be lazy evaluated";var n=e();return Lr(n,t)},get:function(e,t){var n=t.callback,r=t.headers,o=t.responseTransformer;return jr(e,{callback:n,headers:Br({Accept:"application/json","Content-Type":"application/json"},Hr.extraHeaders,r),method:"GET",responseTransformer:o},Hr)},post:function(e,t){var n=t.body,r=t.callback,o=t.headers,i=t.extraConfig,a=t.responseTransformer;return jr(e,{body:n,callback:r,headers:Br({"Content-Type":"application/x-www-form-urlencoded"},Hr.extraHeaders,o),method:"POST",extraConfig:i,responseTransformer:a},Hr)},put:function(e,t){var n=t.body,r=t.callback,o=t.headers,i=t.responseTransformer;return jr(e,{body:n,callback:r,headers:Br({Accept:"application/json","Content-Type":"application/json"},Hr.extraHeaders,o),method:"PUT",responseTransformer:i},Hr)},delete:function(e,t){var n=t.callback,r=t.headers,o=t.extraConfig,i=t.responseTransformer;return jr(e,{callback:n,headers:Br({Accept:"application/json","Content-Type":"application/json"},Hr.extraHeaders,r),method:"DELETE",extraConfig:o,responseTransformer:i},Hr)},postLegacyResource:function(e,t){var n=t.body,r=t.callback,o=t.headers,i=t.responseTransformer;return fetch(e,{headers:Br({"Content-Type":"application/x-www-form-urlencoded"},Hr.extraHeaders,o),credentials:"include",method:"POST",body:"string"==typeof n?n:Or.a.stringify(n)}).then((function(e){if(!e.ok)return new Error("Request failed with ".concat(e.status));var t=e.headers.get("content-type");return t&&-1===t.indexOf("text/html")&&-1===t.indexOf("text/plain")?e.json():e.text()})).then((function(t){return t instanceof Error?r(t):r(null,i?i(t,e,Hr.contextPath,n):t)})).catch(Fr(Hr,r))},fetch:function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t){return fetch(e,t)}))}),zr={configure:function(e){Ur.configure(e)},getPluginCodeLanguages:function(e){var t=Ur.getFullPath("/plugins/newcode/getlanguages.action");Ur.get(t,{callback:e})},getWikiConfluenceToXhtml:function(e,t){var n=Ur.getFullPath("/rest/tinymce/1/wikixhtmlconverter");Ur.postLegacyResource(n,{body:e,callback:t,headers:{Accept:"text/plain, */*","Content-Type":"application/json; charset=utf-8"}})},getWikiMarkdownToXhtml:function(e,t){var n=Ur.getFullPath("/rest/tinymce/1/markdownxhtmlconverter");Ur.postLegacyResource(n,{body:e,callback:t,headers:{Accept:"text/plain, */*","Content-Type":"application/json; charset=utf-8"}})}};function Wr(){Object(r.redirect)("".concat(ye,"/login.action?os_destination=").concat(Object(r.location)().pathname.replace(ye,"")))}zr.configure({endpoint:("undefined"==typeof window?"http://localhost:8080":"".concat(vr().protocol,"//").concat(vr().host))+ye,contextPath:ye,onUnauthorized:Wr});var Vr=zr,qr=(n("./src/editor-plugins/insertwiki/insert-wiki-markup.css"),function(){return!_("editor.insert-wiki-markdown")}),$r={HELP_REST_API:"".concat(ye,"/plugins/tinymce/helplink.action"),WIKI:{CONFLUENCE:{api:Vr.getWikiConfluenceToXhtml,val:"CONFLUENCE",label:"confluence.conf_wikimarkup_confluence_label",helpLink:"help.insert.wiki.markup",restApi:"/rest/tinymce/1/wikixhtmlconverter"},MARKDOWN:{api:Vr.getWikiMarkdownToXhtml,val:"MARKDOWN",label:"confluence.conf_wikimarkup_markdown_label",helpLink:"help.insert.wiki.markup.markdown",restApi:"/rest/tinymce/1/markdownxhtmlconverter"}}},Kr={dialog:{id:"insert-wiki-markup-dialog",content:"",width:980,height:500,popup:!1,name:"confluence.conf_wikimarkup_desc"},markupEditId:"insert-wiki-textarea",previewAreaId:"insert-wiki-textarea-preview",selectionMenuId:"wiki-parser-selection-tool",serverRequestTimer:300,entityId:F.get("content-id"),spaceKey:F.get("space-key")},Gr=null,Jr=function(){var e=zn.get("insert-wiki-markup-dialog.parser","global","CONFLUENCE");return $r.WIKI[e]},Xr=function(e,t){var n=c()(function(e,t,n){return'\n    <span class="wiki-parser-selector">\n        <form action="#" method="post" id="d" class="aui">\n            <select class="select medium-field" id="wiki-parser-selection-tool" name="wiki-parser-selection-tool" title="wiki parser selector">\n                <option value="'.concat(t.val,'">').concat(e(t.label),"</option>\n                ").concat(Object.keys(n).filter((function(e){return n[e].val!==t.val})).map((function(t){return'<option value="'.concat(n[t].val,'">').concat(e(n[t].label),"</option>")})),"\n            </select>\n        </form>\n    </span>\n")}(e,t,$r.WIKI));return c()("#insert-wiki-insert-title").append(n),c()("#".concat(Kr.selectionMenuId))},Yr=function(){var e=c()("#".concat(Kr.selectionMenuId));return e.length?e.val():Jr().val},Qr=function(e){var t={wiki:(e=e||{}).textToConvert,entityId:Kr.entityId,spaceKey:Kr.spaceKey};e.api(JSON.stringify(t),(function(t,n){t?e.errorCallback(t):e.successCallback(n)}))},Zr=function(){var e=c()("#".concat(Kr.markupEditId)).val();c.a.trim(e)?Qr({api:$r.WIKI[Yr()].api,textToConvert:e,successCallback:function(e){Gr.html(e)},errorCallback:function(){Gr.html(to(e))}}):Gr.html(e)},eo=function(){var e,t,n,r=Yr();zn.set("insert-wiki-markup-dialog.parser","global","CONFLUENCE",r),e=r,t=c()("#".concat(Kr.dialog.id)).find(".dialog-help-link"),n=$r.WIKI[e].helpLink,t.load($r.HELP_REST_API,{linkUrlKey:n}),Zr()};function to(e){if("string"!=typeof e)return"";var t={"<":"&lt;",">":"&gt;","&":"&amp;","'":"&#39;","`":"&#96;"};return e.replace(/[&"'<>`]/g,(function(e){return"string"==typeof t[e]?t[e]:"&quot;"}))}var no={init:function(e,t){var n;Kr.dialog.content=qr()?'\n    <p id="insert-wiki-info-title">'.concat((n=function(e){return ge(e)})("tinymce.confluence.conf_wikimarkup_info_title"),'</p>\n    <form action="#" method="post" id="insert-wiki-markup-form" class="aui">\n        <h3 class="wiki-title">\n            <span id="insert-wiki-insert-title">').concat(n("tinymce.confluence.conf_wikimarkup.insert.label"),'</span>\n            <span id="insert-wiki-preview-title">').concat(n("tinymce.confluence.conf_wikimarkup_preview_label"),'</span>\n        </h3>\n        <textarea class="monospaceInput textarea" id="insert-wiki-textarea" name="wikitext"></textarea>\x3c!--\n            --\x3e<div class="example-container" id="insert-wiki-textarea-preview"></div>\n    </form>\n'):' \n    <form action="#" method="post" id="insert-wiki-markup-form" class="aui">\n        <textarea class="monospaceInput textarea originalDefault" id="insert-wiki-textarea" name="wikitext"></textarea>\n    </form>\n';var i=function(t){var n,o,i,a=Kr.dialog.id,u=Yr();e.windowManager.setBusy(a,!1),r.tinymce.EditorManager.activeEditor.windowManager.close(a),qr()&&(s("analytics",{name:"insert-wiki-markup-dialog.".concat(u)}),"MARKDOWN"===u&&(n=t,(o=c()(n)).find("img").addClass("confluence-embedded-image"),t=c()("<div>").append(o.clone()).html())),e.execCommand("mceInsertContent",!1,t),i=e,r.tinymce.each(i.dom.select("p > p"),(function(e){try{e.parentNode&&i.dom.split(e.parentNode,e)}catch(e){}}))},a=function(t,n,o){e.windowManager.setBusy(Kr.dialog.id,!1);var i=function(e,t){return'\n        <p class="warning">\n            '.concat(e,'\n        </p>\n        <p class="exception-report">\n            <span class="exceptionMessage">\n                ').concat(t,"\n            </span>\n        </p>\n")}(e.translate("confluence.conf_wikimarkup_conversion_errors"),"timeout"===n?e.translate("confluence.conf_wikimarkup_timeout"):"".concat(to(n||t.message)," : ").concat(to(o)));r.tinymce.EditorManager.activeEditor.windowManager.alert(i)};e.addCommand("InsertWikiMarkup",(function(){var n,r=Jr();return e.windowManager.open(Kr.dialog,{buttons:[{label:"confluence.conf_insert_button_title",action:function(){e.windowManager.setBusy(Kr.dialog.id,!0),Qr({api:$r.WIKI[Yr()].api,successCallback:i,errorCallback:a,textToConvert:c()("#".concat(Kr.markupEditId)).val(),setBusy:!0})}}],plugin_url:t,helpLink:r.helpLink,hintText:"confluence.conf_wikimarkup_hint",cssClass:"insert-wiki-markup-panel"}),qr()&&(!function(e){var t=c()("#wysiwygTextarea_ifr").contents().find("head").html(),n=c()("<iframe tabindex='-1' id='insert-wiki-markup-preview' />");c()("#".concat(e)).append(n);var r=n.contents(),o=r[0];o.open(),o.write('\n    <!DOCTYPE html>\n    <html class="insert-wiki-markup-dialog">\n        <head>\n        </head>\n        <body class="wiki-content previewWiki">\n        </body>\n    </html>\n'),o.close(),r.find("head").html(t),Gr=r.find("body")}(Kr.previewAreaId),Xr((function(t){return e.translate(t)}),r).on("change",eo),c()("#".concat(Kr.markupEditId)).on("keydown",(function(){clearTimeout(n),n=o.a.setTimeout(Zr,Kr.serverRequestTimer)}))),!1})),e.ui.registry.addButton("insertwikimarkup",{text:"confluence.conf_wikimarkup_desc",onAction:function(){e.execCommand("InsertWikiMarkup")}})},getInfo:function(){return{longname:"InsertWikiMarkip",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com/",version:"1.1"}}};var ro={fields:{string:{language:function(e,t){var n,o=c()(r.Confluence.Templates.MacroBrowser.macroParameterSelect()),i=c()("select",o);return null==t&&(t={}),t.setValue=function(e){if(0==i.find("option[value='".concat(e,"']")).length){var t=c()("<option/>");t.val(e),t.text(e),i.append(t)}},n=i,Vr.getPluginCodeLanguages((function(e,t){if(!e&&t.length){var r=n.val();n.empty(),n.append(c()("<option/>").attr("value","")),t.forEach((function(e){var t=c()("<option />");t.val(e.aliases[0]),t.text(e.friendlyName),n.append(t)})),n.val(r)}})),new r.AJS.MacroBrowser.Field(o,i,t)}}}};function oo(){var e;function t(){var t=c()("#breadcrumbs");t.detach(),!t.find(".edited-page-title").length&&e.length&&t.append(e),c()("#editor-precursor .cell").prepend(t)}if("comment"!==F.get("content-type")){var n=c()("#quickedit-breadcrumbs");n.length>0&&(c()("#breadcrumbs").detach(),n.attr("id","breadcrumbs"),c()("#breadcrumb-section").append(n)),e=c()(".edited-page-title").parent().detach(),t(),k(r.document,"mode-changed",(function(n,r){var o;"preview"===r?(o=c()("#breadcrumbs").detach(),e.detach(),c()("#breadcrumb-section").append(o)):"richtext"===r&&t()}))}}var io={};function ao(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function co(e){return(co="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var uo=function(e){return function(t,n,r){var o=null!=r&&"object"!==co(r),i=null!=r?o?" = ".concat(r):" >":"";console.log("".concat(e," - ").concat(t," : ").concat(n||null).concat(i)),r&&!o&&console.log(r)}},lo=function e(t,n){var o=uo("Autocompleter.Control"),i={},a=t.selection,u=a.getRng();if(!u)return null;var l=u.startOffset,s=u.startContainer,f=s.nodeValue,d=n.leadingChar,m=t.getDoc(),p=n.backWords||0,g=n.insertedFromMenu||!1,h=io[d||"["],v=h&&void 0!==h.preventStartNodes?h.preventStartNodes:"div.code, a[href], img, pre";if(c()("#".concat("autocomplete"),m).length)return o("init","Autocomplete already exists, returning null."),null;i.backWords=p,i.maxResults=n.maxResults||10,null==f&&u.collapsed&&l&&s.childNodes[l-1]&&(l=(f=(s=s.childNodes[l-1]).nodeValue)&&f.length||0);var b="";if(null!=f){b="".concat(f).substring(0,l);for(var y=s.previousSibling;y&&3===y.nodeType;)b=y.nodeValue+b,y=y.previousSibling}var w;if(!p&&b&&!function(e,t){for(var n=0,r=t.length;n<r;n++)if(t[n].test(e))return!0;return!1}(b+d,[/([("'<\(\u201c\u2018]\[|[\ufeff\u200b\u2014\s\xa0].)$/,/(\([^!])$/,/(\/\/)$/]))return o("init","Cursor is in wrong word location to start autocomplete, returning null."),null;if(c()(s).closest(v).length)return o("init","Cursor is in wrong node to start autocomplete, returning null."),null;if(r.Confluence.PropertyPanel&&r.Confluence.PropertyPanel.current&&(r.Confluence.PropertyPanel.shouldCreate=!1,r.Confluence.PropertyPanel.destroy()),d||null!=f||(o("init","No text available for suggestion, range is",u),f=""),i.getContainer=function(){return c()("#".concat("autocomplete"),m)},u.collapsed&&p&&f){var C=function(e,t,n){var r,o;function i(e,t,n){!t.global&&(t=new RegExp(t.source,"g".concat(t.ignoreCase?"i":"").concat(t.multiline?"m":""))),null==n?n=e.length:n<0&&(n=0);for(var r,o=e.substring(0,n+1),i=-1,a=0;null!=(r=t.exec(o));)i=r.index,t.lastIndex=++a;return i}for(var a=0;a<n;a++)for(t=i(r=e.nodeValue.substring(0,t),/\s+/,t);-1==t;){if(!(o=e.previousSibling)||3!==o.nodeType){a=n;break}e=o,(r=o.nodeValue)&&(t=i(r,/\s+/,r.length))}return{node:e,offset:t+1}}(s,l,p),x=a.getRng();x&&(x.setStart(C.node,C.offset),x.setEnd(s,l),a.setRng(x))}w=a&&a.getNode()&&a.getNode().classList.contains("placeholder-inline-tasks")?"":a.getContent({format:"text"}).replace("\n",""),o("init","suggestionHtml",w);var S,k=function(e,t,n){var o=r.document.createElement(e);return t&&o.setAttribute("id",t),n&&o.appendChild(r.document.createTextNode(n)),o},T=k("span","autocomplete");if(n.classNames)if("string"==typeof n.classNames)(S=T.classList).add.apply(S,ao(n.classNames.split(" ")));else if(Array.isArray(n.classNames)){var E;(E=T.classList).add.apply(E,ao(n.classNames))}d&&T.appendChild(k("span","autocomplete-trigger",d));var A=k("span","autocomplete-search-text",r.AJS.Rte.HIDDEN_CHAR);T.appendChild(A),a.setNode(c()(T)[0]);var _=i.getContainer();i.previousSearchText="",i.settings=h,!1===h.cache||h.cacheManager?!1!==h.cache||h.cacheManager||(h.cacheManager={get:c.a.noop,put:c.a.noop}):h.cacheManager=new r.AJS.Confluence.localStorageCacheManager(h.ch);var N=c()("#".concat("autocomplete-search-text"),i.getContainer()),R=c()(m.createElement("span")).text(w||r.AJS.Rte.HIDDEN_CHAR);N.empty().append(R),a.select(R[0],!0),a.collapse();var D,O,I=function(e){if(i.onBeforeKey&&!i.onBeforeKey(e,i.text()))return r.tinymce.dom.Event.cancel(e),o("before","blocked by onBeforeKey: ".concat(e.keyCode)),!1},P=function(e){var t=a.getRng();if(t){var n=i.getContainer(),c=t.startContainer,u=c.parentNode;3===c.nodeType&&u&&(u=u.parentNode);var l=u?u.parentNode:null,s=l?l.parentNode:null,f=u!==n[0]&&l!==n[0]&&s!==n[0];if(27===e.keyCode||f)o("after","dying because of: ".concat(f?"outside search span":"escape pressed")),i.die();else if(i.onAfterKey&&!i.onAfterKey(e,i.text()))return r.tinymce.dom.Event.cancel(e),o("after","blocked by onAfterKey: ".concat(e.keyCode)),!1}},B=function(e){if(i.onKeyPress&&!i.onKeyPress(e,i.text()))return r.tinymce.dom.Event.cancel(e),o("press","blocked by onKeyPress: ".concat(e.keyCode)),!1},M=function(e){i.getContainer()[0]!=e.target.parentNode&&(o("click","Clicked outside of autocomplete, closing."),i.die())};t.on("KeyDown",I,!0),t.on("KeyUp",P,!0),t.on("KeyPress",B,!0),t.on("Click",M,!0),i.word="",n.keepAlias?o("init","No suggestion based on previous or selected text"):i.word=w,r.AJS.Rte.showElement(_[0]),D=r.tinymce.DOM.getPos(_[0]),O=_.height(),i.left=D.x,i.top=D.y+O,i.text=function(e){var t=c()("#".concat("autocomplete-search-text"),i.getContainer());return null!=e?(t.text(e),this):(e=r.AJS.escapeEntities(t.text())).replace(r.AJS.Rte.HIDDEN_CHAR,"")},i.plainText=function(e){var t=c()("#".concat("autocomplete-search-text"),i.getContainer());return null!=e?(t.text(e),this):(e=t.text()).replace(r.AJS.Rte.HIDDEN_CHAR,"")};var L=function(t,n){var r=i.getContainer();return e.replaceWithTextAndGetRange(r,t,n)};return i.replaceWithSelectedSearchText=function(){var e=i.text();return o("replaceWithSelectedSearchText",e),L(e,!1),e},i.die=function(e){if(i.dying)o("die","Already dying, returning.");else{if(i.dying=!0,r.Confluence.PropertyPanel&&(r.Confluence.PropertyPanel.shouldCreate=!0),i.getContainer().length){o("die","Tearing down autocomplete, cleaning up autocompleter");var a=(e||n.backWords||g?"":i.settings.ch)+i.text();u=L(a,!0)}setTimeout((function(){o("die","Removing autocomplete-control keyboard listeners."),t.off("KeyDown",I),t.off("KeyUp",P),t.off("Click",M),t.off("KeyPress",B)}),1),r.AJS.Rte.unbindScroll("autocomplete"),c()(r.document).unbind("click.autocomplete-outside"),this.onDeath&&this.onDeath()}},r.AJS.Rte.bindScroll("autocomplete",(function(){o("scrolling:"),r.AJS.Rte.isAnyPartShown(_)?i.onScroll():i.die()})),c()(r.document).bind("click.autocomplete-outside",(function(e){var t=e.srcElement&&"rte-insert-date"===e.srcElement.id;c()(e.target).closest("#autocomplete-dropdown, .aui-datepicker-dialog, .ui-datepicker-header").length||t||i.die()})),r.AJS.Rte.getEditor().on("BeforeExecCommand",(function(e){"mceConfSavePage"==e.command&&i.die()})),i.update=function(e){Se(),L("",!0),this.settings.update(this,e)},i.removeSpan=function(){i.getContainer().remove()},i};lo.removeOrphanedControl=function(){var e=c()(r.AJS.Rte.getEditor().getDoc()),t=e.find("#".concat("autocomplete"));if(!t.length)return null;var n=e.find("#".concat("autocomplete-trigger")).text(),o=e.find("#".concat("autocomplete-search-text")).text();return lo.replaceWithTextAndGetRange(t,o,!1),{leadingChar:n,content:o}},lo.replaceWithTextAndGetRange=function(e,t,n){if(e.length){t=t||"",n=n||!t;var o=r.AJS.Rte.getEditor(),i=e[0].parentNode,a=r.AJS.Rte.Content.getChildIndex(i,e[0]),c=n?1:0,u=o.selection.getRng();return u.setStart(i,a+c),u.setEnd(i,a+1),e.before(t||r.AJS.Rte.HIDDEN_CHAR).remove(),o.selection.setRng(u),u}console.log("replaceWithTextAndGetRange Error: attempting to replace a non-existent element")};var so=function e(t){if(!(this instanceof e))return new e(t);this.cache={},this.cacheStack=[],this.cacheSize=t||30};so.prototype.get=function(e){var t=this.cache[e];if(t){var n=this.cacheStack[this.cacheStack.length-1][0]+1;return t.weight=n,this.cacheStack.push([n,e]),t.value}},so.prototype.put=function(e,t){var n,r,o,i=this.cacheStack.length?this.cacheStack[this.cacheStack.length-1][0]+1:0;for(this.cache[e]={weight:i,value:t},this.cacheStack.push([i,e]);this.cacheStack.length>this.cacheSize;)r=(n=this.cacheStack.shift())[0],o=n[1],r===this.cache[o].weight&&delete this.cache[o]},so.prototype.clear=function(){this.cache={},this.cacheStack=[]};var fo=so,mo=function(e,t){var n,r;if(e&&e.length&&e[0]){for(var o=[],i=0,a=e.length;i<a;i++){var c=e[i];c&&o.push(c.replace(/[\.\*\+\?\|\(\)\[\]{}\\]/g,"\\$"))}n=new RegExp("(".concat(o.join("|"),")"),"gi"),r=Cr()(t||"<strong>{highlight}</strong>").fill({highlight:"$1"}).toString()}return{highlight:function(e,t){return e?(t||(e=Cr.a.escape(e)),n?e.replace(n,r):e):e},safeHighlight:function(e){if(!e)return e;var t,o;if(n&&r){var i=r.split("$1");t=i[0],o=i[1],e=e.replace(n,"@@@hl@@@$1@@@endhl@@@")}return zt(e).replace(/@@@hl@@@/gi,t).replace(/@@@endhl@@@/gi,o)}}},po=function(e,t){var n=e.options;n.ajsDropDownOptions=n.ajsDropDownOptions||{};var o,i=(n.ajsDropDownOptions.Highlighter||mo)(t.queryTokens||[t.query]);n.ajsDropDownOptions.alignment||(n.ajsDropDownOptions.alignment="left"),n.ajsDropDownOptions.selectionHandler=n.ajsDropDownOptions.selectionHandler||go,(o=e.dd)&&(o.hide(),o.$.remove());var a=e.dd=r.AJS.dropDown(t.matrix,n.ajsDropDownOptions)[0];if(n.ajsDropDownOptions.className&&a.$.addClass(n.ajsDropDownOptions.className),a.$.find("li a:not(.dropdown-prevent-highlight) span").each((function(){var e=c()(this);e.html(i.safeHighlight(e.text()))})),a.$.hasClass("fabric")){var u=a.$.find(".insert-mentions-dropdown-option");u.length===t.matrix[1].length&&t.matrix[1].forEach((function(e,t){var n=i.safeHighlight(e.username);if(n){e.lozenge&&(n+=" &middot; ".concat(e.lozenge));var r=c()("<span>").addClass("dropdown-lozenge").html(n);u.eq(t).append(r)}}))}return n.dropdownPlacement?n.dropdownPlacement(a.$):(console.log("No dropdownPlacement function specified. Appending dropdown to the body."),c()("body").append(a.$)),function(e){var t=e.$.closest(".aui-dd-parent").width();t||(e.$.width("25em"),t=e.$.width()),c()("a span:not(.icon)",e.$).each((function(){var e=c()(this),n=r.document.createElement("var");n.innerHTML="&#8230;";var o=c()(n),i=o.width(),a=!1;e.wrapInner(c()("<em>")),c()("em",e).each((function(){var e=c()(this);if(e.show(),this.offsetLeft+this.offsetWidth+i>t-20){for(var n=this.childNodes,r=!1,o=n.length-1;o>=0;o--){var u=n[o],l=1,s=3===u.nodeType?"nodeValue":"innerHTML",f=u[s];do{if(!(l<=f.length))break;u[s]=f.substr(0,f.length-l++)}while(this.offsetLeft+this.offsetWidth+i>t-20);if(l<=f.length){r=!0;break}}r?a=!0:e.hide()}})),a&&(e.append(o),this.elpss=o)}))}(a),function(e){c()("a span:not(.icon)",e.$).each((function(){var e,t=c()(this);try{var n=t.data("properties");e=n?n.spaceName:null}catch(e){console.error("Problem getting space name: ",e.message)}var r=t.text();e&&(r+=" (".concat(c()("<i></i>").html(e).text(),")")),t.attr("title",r)}))}(a),n.dropdownPostprocess&&n.dropdownPostprocess(a.$),a.show(e._effect),"function"==typeof n.onShow&&n.onShow.call(a,a.$),a},go=function(e,t){if("click"!=e.type){var n=c()("a",t).first(),i=n.attr("href");if("keydown"===e.type&&(e.metaKey||e.ctrlKey)&&13===e.which){var a=o.a.open(i,"_blank");a&&a.opener&&(a.opener=null)}else n.click(),r.document.location=i;e.preventDefault()}};function ho(e,t){this._effect="appear",this._timer=null,this.id=e,this.options=t,this.inactive=!1,this.busy=!1,this.cacheManager=fo()}ho.prototype.clearCache=function(){this.cacheManager.clear()},ho.prototype.change=function(e,t,n){var r=this;if(e!=r._value){r._value=e,r.busy=!1,o.a.clearTimeout(r._timer);var i=r.options.minLengthForGetData||2,a=new RegExp("\\S{".concat(i,",}"));if(t||a.test(e)){var c=r.cacheManager.get(e);if(c)po(r,c);else{r.busy=!0;var u=function(){r.options.getDataAndRunCallback.call(r,e,(function(){r.show.apply(this,arguments),n&&n(e)}))};0===r.options.dropDownDelay?u():r._timer=o.a.setTimeout((function(){u()}),r.options.dropDownDelay||200)}}else r.dd&&r.dd.hide(),n&&n(e)}},ho.prototype.hide=function(){this.dd&&this.dd.hide()},ho.prototype.remove=function(){var e=this.dd;e&&(this.hide(),e.$.remove()),this.inactive=!0,this.options.onDeath&&this.options.onDeath()},ho.prototype.show=function(e,t,n){if(this.inactive)console.log("Quick search abandoned before server response received, ignoring. ",this);else{var r={matrix:e,query:t,queryTokens:n};this.cacheManager.put(t,r),po(this,r),this.busy=!1}};var vo,bo;uo("Autocompleter.Manager");var yo=function(e){var t=io[e.leadingChar];if(e=c.a.extend({minLengthForGetData:t.minLengthForGetData,displayHandler:t.displayHandler,Highlighter:t.Highlighter,classNames:t.autocompleteClassNames},e),!(vo=lo(r.AJS.Rte.getEditor(),e)))return!1;function n(e){return c.a.data(e,"properties")}s("synchrony.stop",{id:"confluence.autocomplete-plugin"});var o,i=c()(r.window).width(),a=function(e){var t,n,a=c()("#autocomplete-dropdown"),u=vo.getContainer();a.length||(a=c()("<div></div>").addClass("aui-dd-parent quick-nav-drop-down").attr("id","autocomplete-dropdown").appendTo("body"));var l=r.AJS.Position.spaceAboveBelow(r.AJS.Rte.getEditorFrame(),u);e.find("ol:has(a.menu-header)").addClass("top-menu-item"),e.find("ol:empty").hide(),a.append(e);var s=r.AJS.Rte.Content.offset(u),f=Math.max(a.width()+s.left-i+10,0),d=s.left-f-0,m=e.outerHeight(!0),p=m+10;o&&(function(e,t){return 1==o?e.above>=t:e.below>=t}(l,p)||(o=null)),o||(o=function(e,t){return e.below>=t?2:e.above>=t?1:e.below>e.above?2:1}(l,p)),(n=a.find(".autocomplete-dropdown-arrow")).length||(n=c()("<div>").addClass("autocomplete-dropdown-arrow").addClass(vo.settings.autocompleteClassNames)),1===o?(n.addClass("autocomplete-dropdown-bottom-arrow").css({top:m-1}),t=s.top-m-10):(n.removeClass("autocomplete-dropdown-bottom-arrow").css("top",""),t=s.top+u.height()+10),n.css({left:f}).appendTo(a),a.css({position:"absolute",top:t,left:d})};bo=function(e){return new ho("inputdriven-dropdown",e)}({onShow:function(e){s("rte-autocomplete-on-show",{triggerChar:vo.settings.ch});var t=r.AJS.Rte.getEditorFrame();t&&t.shim&&t.shim.hide(),e.find("a.menu-header").unbind().click((function(e){e.preventDefault(),vo.die()})),this.reset(),vo.settings.selectFirstItem&&e.find("a:not('.menu-header')").length&&r.AJS.dropDown.current.moveDown()},dropdownPlacement:a,onDeath:function(){c()("#autocomplete-dropdown").remove()},ajsDropDownOptions:{selectionHandler:function(e,t){e.preventDefault();var r=n(t[0]);r&&"function"==typeof r.callback?r.callback(vo):"menu-header"!==r.className&&vo.update(r),vo.die()},moveHandler:function(e,t){var n=r.AJS.dropDown.current;e&&e.find("a").is(".menu-header")&&("up"==t?n.moveUp():n.moveDown())},className:"autocomplete ".concat(vo.settings.dropDownClassName),displayHandler:e.displayHandler,Highlighter:e.Highlighter},getDataAndRunCallback:function(e){vo&&vo.settings.getDataAndRunCallback&&vo.settings.getDataAndRunCallback(vo,e,(function(t,n,r,o){t.unshift([{className:"menu-header dropdown-prevent-highlight",href:"#",name:vo.settings.getHeaderText(vo,e)}]),t.push(vo.settings.getAdditionalLinks(vo,e,r)),bo&&bo.show(t,n,o||[n])}))},dropDownDelay:vo.settings.dropDownDelay,minLengthForGetData:vo.settings.minLengthForGetData}),vo.onBeforeKey=function(e,t){return 40===e.keyCode||38===e.keyCode||13===e.keyCode?(r.tinymce.dom.Event.cancel(e),!1):!(27===e.keyCode||9===e.keyCode||8===e.keyCode&&!t)||(this.die(8===e.keyCode),!1)},vo.onKeyPress=function(e){var t=String.fromCharCode(e.which);return 13===e.keyCode?(r.tinymce.dom.Event.cancel(e),!1):(this.settings.endChars.includes(t)&&vo.die(),!0)};var u=e.minLengthForGetData||2,l=new RegExp("\\S{".concat(u,",}"));vo.onAfterKey=function(e,t){if(40===e.keyCode||38===e.keyCode||13===e.keyCode){var n=r.AJS.dropDown.current;return!!n&&(-1==n.getFocusIndex()&&13===e.keyCode?(wo(),!0):(e.which||(e.which=e.keyCode),n.moveFocus(e)))}var o=8===e.keyCode&&!t||f(t);return(o||l.test(t))&&bo&&bo.change(t,o),!0};var f=function(e){return/[\u4E00-\u9FFF]/gi.test(e)};return vo.onDeath=function(){bo&&(bo.remove(),bo.closing=!0),s("synchrony.start",{id:"confluence.autocomplete-plugin"})},vo.onScroll=function(){bo&&bo.dd&&a(bo.dd.$)},vo.getCurrentItem=function(){if(!bo||!bo.dd)return null;var e=bo.dd,t=e.getFocusIndex();return t<0?null:n(e.links[t])},bo&&bo.change(vo.text(),!0),!0},wo=function(){vo.die(),vo=null},Co={getInputDrivenDropdown:function(){return bo},triggerListener:function(e){if(!e.metaKey){bo&&bo.closing&&(bo=null);var t=String.fromCharCode(e.which);!bo&&t in io&&yo({leadingChar:t})&&r.tinymce.dom.Event.cancel(e)}},shortcutFired:function(e,t){var n=t?0:1;return bo&&bo.closing&&(bo=null),bo&&(n=t?0:vo.backWords+1,wo()),yo({leadingChar:e,backWords:n})},reattach:function(){var e=lo.removeOrphanedControl();e&&Co.shortcutFired(e.leadingChar)}},xo=n("com.atlassian.confluence.restplugin:confluence-rest/require('confluence-rest/confluence-rest')"),So=n.n(xo),ko=function(e,t){io[e]=t},To=function(e,t,n){return'<a href="#" class="'.concat(t||"",'"><span class="icon ').concat(n||"",'"></span><span>').concat(e,"</span></a>")},Eo=function(e,t,n,r,o){var i;if(e.statusMessage)i=[[{html:e.statusMessage,className:"error"}]];else{var a=t?So.a.REST.makeRestMatrixFromSearchData(e):So.a.REST.makeRestMatrixFromData(e,r);i=So.a.REST.convertFromRest(a)}n(i,t,(function(e,t){o&&"function"==typeof o&&o(i,e,t)}))},Ao=function(e,t,n,r,o,i,a){var u,l=t(r),s=e.settings.cacheManager,f=s.get(r);l?((u=c.a.ajax({type:"GET",url:l,data:n(e,r),dataType:"json",global:!1,timeout:5e3})).done((function(e){s.put(r,e)})),f?Eo(f,r,o,i,a):(u.done((function(e){Eo(e,r,o,i,a)})),u.fail((function(e,t){"timeout"==t&&Eo({statusMessage:"Timeout",query:r},r,o,i)})))):o([],r)};function _o(e){return(_o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}"object"!==_o(o.a.Confluence)&&(o.a.Confluence={}),void 0===o.a.Confluence.Editor&&(o.a.Confluence.Editor={}),o.a.Confluence.Editor.Autocompleter={Settings:io,log:uo,Util:{dropdownLink:To,getRestData:Ao},Control:lo,Manager:Co},Object(r.define)("confluence-editor/tinymce3/plugins/autocomplete/autocomplete-manager",(function(){return Co})),Object(r.define)("confluence-editor/tinymce3/plugins/autocomplete/autocomplete-settings",(function(){return{Settings:io,log:uo}}));var No=function(e){e.on("PostRender",(function(){console.log("Autocomplete enabled, adding keyPress listener"),e.on("keypress",Co.triggerListener,!0),s("ready-editor-autocomplete")})),e.on("Undo",Co.reattach),e.on("Redo",Co.reattach)};var Ro=n("confluence.web.components:confluence/require('confluence/root')"),Do=function(e){return e?"".concat(ye,"/rest/prototype/1/search.json"):F.get("remote-user")?"".concat(ye,"/rest/prototype/1/session/history.json"):null},Oo=function(e,t){var n={"max-results":e.maxResults};return t&&(n.query=Object(Ro.unescapeEntities)(t),n.search="name",n.preferredSpaceKey=F.get("space-key")),n},Io=function(){return ko("[",{ch:"[",cache:!1,endChars:["]"],dropDownClassName:"autocomplete-links",selectFirstItem:!0,getHeaderText:function(){return ge("editor.autocomplete.links.header.text")},getAdditionalLinks:function(e,t,n){var o;if(t){var i=ge("editor.autocomplete.links.dialog.search");o=r.AJS.format(i,t)}else o=ge("editor.autocomplete.links.dialog.search.no.text");var a=r.Confluence.Editor.LinkBrowser,c=[{className:"search-for",name:o,href:"#",callback:function(e){e.replaceWithSelectedSearchText();var t=a.open({panelKey:a.SEARCH_PANEL});t.doSearch(t.getLocationPresenter().getRawLinkText())}},{className:"dropdown-insert-link",html:To(ge("editor.autocomplete.links.web.link"),"dropdown-prevent-highlight","editor-icon"),callback:function(e){e.replaceWithSelectedSearchText(),a.open({panelKey:a.WEBLINK_PANEL})}}];return n&&n(t,c),c},getDataAndRunCallback:function(e,t,n){Ao(e,Do,Oo,t,n,"content",(function(e,t,n){var o;t&&(e.length<2||("page"!==(o=e[1][0].restObj).type||o.space.key!=F.get("space-key")||o.title.toLowerCase()!==t.toLowerCase()))&&n.push({className:"insert-create-page-link",html:To(ge("editor.autocomplete.links.create.link"),"dropdown-prevent-highlight","editor-icon"),callback:function(e){var n=Object(Ro.unescapeEntities)(t),o=r.Confluence.Link.createLinkToNewPage(n,F.get("space-key"));e.update(o)}})}))},update:function(e,t){t.restObj&&(t=r.Confluence.Link.fromREST(t.restObj)),t&&t.insert()}})},Po=function(e){e.addCommand("mceConfAutocompleteLink",(function(){return Co.shortcutFired("["),!1})),e.addShortcut("meta+shift+k",e.translate("AutoCompleteLink"),"mceConfAutocompleteLink"),Io()},Bo=n("com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js/require('confluence-macro-browser/macro-browser')"),Mo=n.n(Bo);function Lo(){return{init:function(){!function(){function e(e){c()("#autocomplete-dropdown .top-menu-item").spin(e)}function t(){Mo.a.reset(),Mo.a.preLoadMacro()}function n(e,t){var n=t.presetMacroMetadata;e.replaceWithSelectedSearchText(),n?Mo.a.hasRequiredParameters(n)||n.alwaysShowConfig?Pe.macroBrowserToolbarButtonClicked(t):(Se(),Ie.insertMacro({contentId:F.get("content-id")||"0",macro:{name:n.macroName,body:""}})):Pe.macroBrowserToolbarButtonClicked(t)}function r(e){if(e.hidden&&!Mo.a.isHiddenMacroShown(e))return null;var t={className:"autocomplete-macro-".concat(e.macroName),callback:function(t){n(t,{ignoreEditorSelection:!0,presetMacroMetadata:e})}};return e.icon?(t.name=e.title,t.href="#",t.icon=(e.icon.relative?F.get("static-resource-url-prefix"):"")+e.icon.location):t.html=To(e.title),t}ko("{",{ch:"{",cache:!1,endChars:["}",":","{"],dropDownClassName:"autocomplete-macros",dropDownDelay:0,selectFirstItem:!0,getHeaderText:function(){return ge("editor.autocomplete.macros.header.text")},getAdditionalLinks:function(){return[{className:"dropdown-insert-macro",html:To(ge("editor.autocomplete.macros.dialog.browse"),"dropdown-prevent-highlight","editor-icon"),callback:function(e){var t=e.text();n(e,{searchText:t})}}]},getDataAndRunCallback:function(n,o,i){var a=Mo.a.getMetadataPromise(),u=this,l=arguments;function f(e){var t=[];return c()("#macro-insert-list li").each((function(n,o){var i=c()(o),a=e.find((function(e){return e.macroName===i.attr("data-macro-name")}));if(a){var u=r(a);u&&t.push(u)}})),t}function d(e){for(var t=[],o=Mo.a.searchSummaries(e,{keywordsField:"keywordsNoDesc"}),i=0,a=o.length;i<a;i++){var c=r(o[i]);if(c&&t.push(c)==n.maxResults)break}return t}function m(){var t;t=o?d(o):f(Mo.a.metadataList),e(!1),i([t],o)}function p(e){e.preventDefault(),e.stopPropagation(),s("analytics",{name:"autocomplete-macrobrowser.load-retry"}),t(),u.getDataAndRunCallback.apply(u,l)}u.alreadyBinded||(u.alreadyBinded=!0,a.always((function(){m(),u.alreadyBinded=!1})),a.fail((function(){s("analytics",{name:"autocomplete-macrobrowser.fail-to-load"}),v.a.messages.warning("#autocomplete-dropdown ol:nth(1)",{title:ge("editor.autocomplete.macros.error.load.header"),body:'<p><a id="macro-retry-link" href="#">'.concat(ge("editor.autocomplete.macros.error.load.retrylink"),"</a></p>")}),c()("#macro-retry-link").click(p),c()("#autocomplete-dropdown ol").eq(1).show()}))),"pending"===a.state()&&(i([],o),e(!0))},update:function(){throw new Error("All items in the Macro Autocomplete dropdown must have a callback function")}})}()},getInfo:function(){return{longname:"Auto Complete Macro",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}}}var Fo=n("com.atlassian.confluence.editor:attachments-insert-utils-resources/require('confluence-editor/utils/attachments-insert-utils')"),jo=n.n(Fo),Ho=n("confluence.web.resources:macro-js-overrides/require('confluence/macro-js-overrides')"),Uo=n.n(Ho);function zo(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Wo=function(e){var t=F.get("content-id");return e?"".concat(ye,"/rest/prototype/1/search.json"):+t?"".concat(ye,"/rest/prototype/1/content/").concat(t,"/attachments.json"):null},Vo=function(e,t){var n=r.AJS.MacroBrowser.getMacroMetadata("view-file")?[]:["image","word","excel","pdf","powerpoint","multimedia"];return t?{type:"attachment",attachmentType:n,search:"name","max-results":e.maxResults,query:t}:{attachmentType:n,"max-results":e.maxResults}},qo=function(){return ko("!",{ch:"!",cache:!1,endChars:["!"],dropDownClassName:"autocomplete-media",selectFirstItem:!0,getHeaderText:function(){return r.AJS.MacroBrowser.getMacroMetadata("view-file")?ge("editor.autocomplete.file.header.text"):ge("editor.autocomplete.media.header.text")},getAdditionalLinks:function(){var e=ge("editor.autocomplete.media.files.dialog.browse");return[{className:"dropdown-insert-image",html:To(e,"dropdown-prevent-highlight","editor-icon"),callback:function(e){e.replaceWithSelectedSearchText(),r.Confluence.Editor.defaultInsertImageDialog()}},{className:"dropdown-insert-macro",html:To(ge("editor.autocomplete.media.macros.dialog.browse"),"dropdown-prevent-highlight","editor-icon"),callback:function(e){e.replaceWithSelectedSearchText(),r.tinymce.confluence.macrobrowser.macroBrowserToolbarButtonClicked({selectedCategory:"media"})}}]},getDataAndRunCallback:function(e,t,n){Ao(e,Wo,Vo,t,n,"attachment")},update:function(e,t){s("rte-autocomplete-on-insert",{triggerChar:"!",selectedFile:t});var n=t.restObj,o=r.AJS.REST.wikiLink(n),i=n&&n.title||t.name;if("Image"==n.niceType){var a=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){zo(e,t,n[t])}))}return e}({filename:i,contentId:t.ownerId||n.ownerId},o.params);r.tinymce.confluence.ImageUtils.insertFromProperties(a)}else{var c=!!r.AJS.MacroBrowser.getMacroMetadata("view-file"),u=n.contentType,l="VANILLA"!==F.get("confluence-flavour");if(c&&(l&&!(u&&"application/x-shockwave-flash"===u)||u&&("audio/mp3"===u||"video/mp4"===u)||"Multimedia"!==n.niceType)){var f={name:i,page:n.parentTitle,space:n.space?n.space.key:"",date:n.datePath,ownerId:n.ownerId};jo.a.insertFilePlaceholder(f)}else this._insertFile(i,t,o)}},_insertFile:function(e,t,n){var o;switch(t.restObj.niceType){case"PDF Document":o="viewpdf";break;case"Word Document":o="viewdoc";break;case"Excel Spreadsheet":o="viewxls";break;case"PowerPoint Presentation":o="viewppt";break;case"Multimedia":o="multimedia"}var i={page:n.destination.substring(0,n.destination.indexOf("^")),name:e};Uo.a.get("viewdoc").beforeParamsRetrieved(i),i.page||delete i.page;var a={contentId:F.get("content-id")||"0",macro:{name:o,params:i,body:""}};r.tinymce.confluence.MacroUtils.insertMacro(a)}})},$o=function(){u("init.rte",(function(){u("rte-autocomplete-on-show",(function(e,t){"!"===t.triggerChar&&s("analytics",{name:"confluence.editor.autocomplete.trigger",data:{type:"media"}})})),u("rte-autocomplete-on-insert",(function(e,t){var n;"!"===t.triggerChar&&(n=t.selectedFile)&&n.name&&s("analytics",{name:"confluence.editor.autocomplete.insert",data:{extension:n.name.split(".").pop(),type:"media"}})}))})),u("rte-destroyed",(function(){l("rte-autocomplete-on-insert"),l("rte-autocomplete-on-show")}))},Ko=function(e){e.addCommand("mceConfAutocompleteImage",(function(){return Co.shortcutFired("!"),!1})),e.addShortcut("meta+shift+m",e.translate("AutoCompleteImage"),"mceConfAutocompleteImage"),qo(),$o()};var Go=function(){return{initContextToolbars:function(){var e,t,n,o,i=r.tinymce.activeEditor,a=Sr(),u="aui-icon aui-icon-small aui-iconfont-",l=r.AJS.storageManager("atlassian.editor","tables"),s=function(e){var t=i.translate(e),n="".concat(e,"_shortcut"),r=i.translate(n);return r&&r!==n&&(t+=" (".concat(r,")")),t},f={Buttons:[new a.Group([new a.Button({text:s("table.row_before_desc"),iconClass:"".concat(u,"insert-row-before"),click:function(){r.tinymce.execCommand("mceTableInsertRowBefore",!1,"")}}),new a.Button({text:s("table.row_after_desc"),iconClass:"".concat(u,"insert-row-after"),click:function(){r.tinymce.execCommand("mceTableInsertRowAfter",!1,"")}}),new a.Button({text:s("table.delete_row_desc"),iconClass:"".concat(u,"remove-row"),click:function(){r.tinymce.execCommand("mceTableDeleteRow",!1,"")}})]),new a.Group([new a.Button({text:s("table.cut_row_desc"),iconClass:"".concat(u,"cut-table-row"),click:function(){r.tinymce.execCommand("mceTableCutRow",!1,""),i.plugins.customtoolbar.enableToolbarButton("aui-iconfont-paste-table-row")}}),new a.Button({text:s("table.copy_row_desc"),iconClass:"".concat(u,"copy-table-row"),click:function(){r.tinymce.execCommand("mceTableCopyRow",!1,""),i.plugins.customtoolbar.enableToolbarButton("aui-iconfont-paste-table-row")}}),new a.Button({text:s("table.paste_row_before_desc"),iconClass:"".concat(u,"paste-table-row"),click:function(){r.tinymce.execCommand("mceTablePasteRowBefore",!1,"")},disabled:!l.doesContain("copied")})]),new a.Group([new a.Button({text:s("table.col_before_desc"),iconClass:"".concat(u,"insert-column-before"),click:function(){r.tinymce.execCommand("mceTableInsertColBefore",!1,"")}}),new a.Button({text:s("table.col_after_desc"),iconClass:"".concat(u,"insert-column-after"),click:function(){r.tinymce.execCommand("mceTableInsertColAfter",!1,"")}}),new a.Button({text:s("table.delete_col_desc"),iconClass:"".concat(u,"remove-column"),click:function(){r.tinymce.execCommand("mceTableDeleteCol",!1,"")}})]),new a.Group([new a.Button({text:s("table.merge_cells_desc"),iconClass:"".concat(u,"merge-table-cells"),click:function(){r.tinymce.execCommand("mceTableMergeCells",!1,"")}}),new a.Button({text:s("table.split_cells_desc"),iconClass:"".concat(u,"split-merged-table-cells"),click:function(){r.tinymce.execCommand("mceTableSplitCells",!1,"")}})]),new a.Group([new a.Button({text:s("table.row_highlight"),iconClass:"".concat(u,"heading-row"),click:function(){r.tinymce.execCommand("confTableRowToggleHeading",!1),r.tinymce.execCommand("mceTableUpdateNumberingCol",!1)}}),new a.Button({text:s("table.col_highlight"),iconClass:"".concat(u,"heading-column"),click:function(){r.tinymce.execCommand("confTableColumnToggleHeading",!1)}}),new a.Button({text:s("table.numbering_column_desc"),iconClass:"aui-icon aui-icon-small aui-iconfont-insert-numbered-column",id:"insert-numbering-column",click:function(){_("confluence.editor.tinymce.tables")?i.execCommand("mceTableToggleSeries",!1,{name:"numbers"}):r.tinymce.execCommand("mceTableInsertNumberingCol",!1,"")}})]),new a.SplitGroup([new a.Button({text:s("table.selection_highlight"),iconClass:"".concat(u,"paint-bucket"),click:function(){r.tinymce.execCommand("confTableSelectionToggleHighlight",!1)}})],{id:"table-highlight-group",dropDownOptions:{id:"table-highlight-colour",dropDownContent:(e=c()("<ul/>").addClass("table-highlight-picker"),c.a.each(Ge.a.colorValues,(function(t,n){var r=c()("<li/>"),o=c()("<a href='#'></a>"),i=Ge.a.colorNames[n];"clear"===n?o.addClass("remove-highlight").attr("data-remove-highlight","true"):o.addClass("highlight-#".concat(n)).attr("data-highlight-colour","#".concat(n)),o.attr("title",i),o.attr("aria-label",i),o.tooltip(),r.append(o),e.append(r)})),e),alignment:"left"},postProcess:function(e){e.attr("data-highlight-colour","grey"),e.addClass("highlight-grey");var t=c()("<span>&nbsp;</span>");t.addClass("highlight-indicator"),e.find(".icon.aui-iconfont-paint-bucket").after(t)}}),new a.Group([new a.Button({text:s("table.del"),iconClass:"".concat(u,"remove-table"),click:function(){r.tinymce.execCommand("mceTableDelete",!1,"")}})])],Events:Tr},d=function(e){var t=c()(e).closest("td,th"),n=c()(".mceSelected",t.closest("table"));!function(e){function t(e,t){return parseInt(e.attr(t),10)}return e.filter((function(){var e=c()(this);return t(e,"rowspan")>1||t(e,"colspan")>1})).length>=1}(t.add(n))?i.plugins.customtoolbar.disableToolbarButton("aui-iconfont-table-split"):i.plugins.customtoolbar.enableToolbarButton("aui-iconfont-table-split")};function m(e){var t=c()(this),n=c()("#table-highlight-group"),r=n.attr("data-highlight-colour"),o=n.attr("data-remove-highlight");r&&(n.removeClass("highlight-".concat(r)),n.removeAttr("data-highlight-colour")),n.removeClass("remove-highlight"),o&&n.removeAttr("data-remove-highlight");var a=t.attr("data-highlight-colour");a&&(n.addClass("highlight-".concat(a)),n.attr("data-highlight-colour",a)),t.attr("data-remove-highlight")&&(n.addClass("remove-highlight"),n.attr("data-remove-highlight","true")),i.focus(!1),i.execCommand("confTableSelectionToggleHighlight",!1,{alwaysHighlight:!0}),e.preventDefault()}return i.on("NodeChange",(function(e){var n,o=e.element,i=c()("body"),a=!i.hasClass("no-tools")||i.hasClass("no-tools-toolbars-visible");t||null==o.parentNode||"BODY"===o.nodeName||(t=!0,n=o,c()(n).closest("table:not(.wysiwyg-macro)").length?(E(r.document,"createContextToolbarRow.Toolbar",{buttons:f.Buttons,topToolbar:!0,animate:a}),E(r.document,"enableContextToolbarRow.Toolbar",{id:"default"}),function(e){c.a.fn.updateTableModeInToolbar&&c()(e).closest("table").updateTableModeInToolbar()}(o),d(o),function(e){c()(e).closest("table").find(".numberingColumn").length>0?c()("#insert-numbering-column").addClass("active"):c()("#insert-numbering-column").removeClass("active")}(o)):E(r.document,"disableContextToolbarRow.Toolbar",{animate:a}),t=!1)})),i.on("Undo",(function(){i.nodeChanged()})),i.initialized?c()(r.document).on("click","#table-highlight-colour .aui-dropdown a",m):i.on("init",(function(){c()(r.document).on("click","#table-highlight-colour .aui-dropdown a",m)})),i.on("Remove",(function(){c()(r.document).off("click","#table-highlight-colour .aui-dropdown a",m)})),f.Buttons.splice(0,0,new a.Group([new a.DropDownButton({id:"table-mode-picker",text:s("table.responsive"),dropDownContent:(n=c()("<ul/>").addClass("table-mode-list"),o=[{name:s("table.responsive"),mceCmd:"mceAutoWidth",tooltip:s("table.responsive_tooltip")},{name:s("table.fixed_width"),mceCmd:"mceFixedWidth",tooltip:s("table.fixed_width_tooltip")}],c.a.each(o,(function(e,t){var o=c()("<li/>").addClass("dropdown-item").attr("data-tooltip",t.tooltip),i=c()('<a href="#">'.concat(t.name,"</a>")).addClass("item-link");o.on("click",(function(){r.tinymce.execCommand(t.mceCmd,!1,"")})),n.append(o.append(i))})),n)})])),_("confluence-table-enhancements.copy-cut-paste-cols.disabled")||f.Buttons.splice(3,0,new a.Group([new a.Button({text:s("table.col_cut_desc"),iconClass:"".concat(u,"cut-table-column"),click:function(){r.tinymce.execCommand("mceTableCutCol",!1,""),i.plugins.customtoolbar.enableToolbarButton("aui-iconfont-paste-table-column")}}),new a.Button({text:s("table.col_copy_desc"),iconClass:"".concat(u,"copy-table-column"),click:function(){r.tinymce.execCommand("mceTableCopyCol",!1,""),i.plugins.customtoolbar.enableToolbarButton("aui-iconfont-paste-table-column")}}),new a.Button({text:s("table.col_paste_desc"),iconClass:"".concat(u,"paste-table-column"),click:function(){r.tinymce.execCommand("mceTablePasteColBefore",!1,"")},disabled:!l.doesContain("copied")})])),f}}};function Jo(){var e=function(e){this.fileTypes=e};e.prototype.beforeParamsSet=function(e){if(!e.page&&!e.date&&!e.space){var t=F.get("content-type");"page"==t||"blogpost"==t?e.page=r.document.getElementById("content-title").value:"comment"==t&&(e.page=F.get("page-title"))}if(e.date){var n=e.date.split("/");e.page=["",n[2],n[0],n[1],e.page].join("/")}return e.space&&(e.page="".concat(e.space,":").concat(e.page)),e},e.prototype.beforeParamsRetrieved=function(e){if(e.page){var t=e.page.split(":");t.length>1&&(e.space=t[0],e.page=t[1]);var n=e.page.split("/");n.length>1&&(e.date=[n[2],n[3],n[1]].join("/"),e.page=n[4]);var o=F.get("content-type");(("page"==o||"blogpost"==o)&&e.page==r.document.getElementById("content-title").value||"comment"==o&&e.page==F.get("page-title"))&&delete e.page}return e},e.prototype.fields={attachment:function(e){var t={fileTypes:this.fileTypes},n=r.AJS.MacroBrowser.ParameterFields.attachment(e,t);return n.dependencyUpdated=function(e,t){var n,o,i=(n={},o=t.split(":",2),n.spaceKey=2==o.length&&o[0]||F.get("space-key"),n.title=o[o.length-1],0==n.title.indexOf("/")&&(n.postingDay=n.title.substr(1,10),n.title=n.title.substr(12)),n.title==r.document.getElementById("content-title").value&&(n.title=""),n.title||(F.get("new-page")?n.draftId=F.get("content-id"):n.pageId=F.get("page-id")),n);this.getData(i)},n},spacekey:function(e){return r.AJS.MacroBrowser.ParameterFields._hidden(e,{})},date:function(e){return r.AJS.MacroBrowser.ParameterFields._hidden(e,{})},"confluence-content":function(e){return r.AJS.MacroBrowser.ParameterFields["confluence-content"](e,{dependencies:["name"]})}},r.AJS.MacroBrowser.Macros.viewdoc=new e(["doc","docx"]),r.AJS.MacroBrowser.Macros.viewpdf=new e(["pdf"]),r.AJS.MacroBrowser.Macros.viewxls=new e(["xls","xlsx"]),r.AJS.MacroBrowser.Macros.viewppt=new e(["ppt","pptx"]),r.AJS.MacroBrowser.Macros.viewfile={updateSelectedMacro:function(e){var t=e.params[""]||e.params.name;if(t){var n=t.lastIndexOf(".");if(n>0){var r=t.substring(n+1);r&&("doc"==r&&"docx"==r&&(e.name="viewdoc"),"pdf"==r&&(e.name="viewpdf"),"ppt"==r&&"pptx"==r&&(e.name="viewppt"),"xls"==r&&"xlsx"==r&&(e.name="viewxls"))}}}}}var Xo,Yo,Qo,Zo,ei=n("./src/editor-plugins/status-macro/editor-content.scss"),ti=n.n(ei),ni=(n("./src/editor-plugins/status-macro/styles.scss"),["Grey","Red","Yellow","Green","Blue"]),ri=ni[0];function oi(){ii();var e=r.Confluence.MacroParameterSerializer.deserialize(c()(Yo).attr("data-macro-parameters")),t=!1,n=!1;return e&&Qo&&(t=e.title!==Qo.title,n=e.colour!==Qo.colour),t||n}function ii(){if(Zo){var e=ci(Qo)==Zo.val(),t=""===Zo.val();e||t?delete Qo.title:Qo.title=Zo.val()}}function ai(){if(!Xo||!Xo.state||"pending"!==Xo.state()){ii();var e={contentId:r.Confluence.Editor.getContentId(),macro:{name:"status",params:Qo,defaultParameterValue:"",body:""}};(Xo=r.tinymce.confluence.MacroUtils.insertMacro(e,Yo)).done((function(e){var t;t=Yo=e,r.tinymce.activeEditor.selection.select(t),Se(),r.tinymce.activeEditor.selection.collapse()})).fail((function(e){0}))}}function ci(e){return e.colour||e.color||ri}function ui(){var e=c()("<input/>");return e.attr("class","status-macro-title first last editable"),e.keyup((function(e){return 13!==e.keyCode||(r.Confluence.PropertyPanel.destroy(),!1)})),e.keydown((function(e){return 27!==e.keyCode||(Zo=null,!0)})),e}function li(e){(Zo=ui()).val(e.find("span.panel-button-text").text()),e.replaceWith(Zo),Zo.select().focus()}function si(e){e.on("init",(function(){ti.a.use()})),e.on("Remove",(function(){ti.a.unuse()}))}var fi=n("./src/editor-plugins/theme-atlassian/editor-content.scss"),di=n.n(fi);function mi(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){hi(e,t,n[t])}))}return e}function pi(e){return(pi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function gi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function hi(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var vi=function(e,t){if("number"==typeof e)return e;if("string"==typeof e&&/^\d+/.test(e))try{return parseInt(e)}catch(e){return t}return t},bi=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),hi(this,"scope",void 0),hi(this,"listeners",void 0),hi(this,"inDispatch",void 0),this.inDispatch=!1,this.scope=t||this,this.listeners=[]}var t,n,o;return t=e,(n=[{key:"add",value:function(e,t){return this.listeners.push({cb:e,scope:t||this.scope}),e}},{key:"addToTop",value:function(e,t){var n={cb:e,scope:t||this.scope};return this.inDispatch?this.listeners=[n].concat(this.listeners):this.listeners.unshift(n),e}},{key:"remove",value:function(e){var t=this.listeners,n=null;return r.tinymce.each(t,(function(r,o){if(e==r.cb)return n=r,t.splice(o,1),!1})),n}},{key:"dispatch",value:function(){var e,t,n,r=this,o=arguments,i=r.listeners;for(r.inDispatch=!0,t=0;t<i.length&&!1!==(n=(e=i[t]).cb.apply(e.scope,o.length>0?o:[e.scope]));t++);return r.inDispatch=!1,n}}])&&gi(t.prototype,n),o&&gi(t,o),e}();function yi(e){return"object"===pi(e)&&e.name}function wi(e,t){return"string"==typeof t?e.queryCommandState(t):!!yi(t)&&e.queryCommandState(t.name)}function Ci(e){this.init=this.init(e)}function xi(e){var t={},n={bold:"Bold",italic:"Italic",underline:"Underline",strikethrough:"Strikethrough",justifyleft:"JustifyLeft",justifycenter:"JustifyCenter",justifyright:"JustifyRight",bullist:"InsertUnorderedList",numlist:"InsertOrderedList",tasklist:"InsertInlineTaskList",outdent:"Outdent",indent:"Indent",cut:"Cut",copy:"Copy",paste:"Paste",undo:"Undo",redo:"Redo",removeformat:"RemoveFormat",sub:"subscript",sup:"superscript",forecolor:"ForeColor",forecolorpicker:"mceForeColor",backcolor:"HiliteColor",backcolorpicker:"mceBackColor",charmap:"mceCharMap",visualaid:"mceToggleVisualAid",anchor:"mceInsertAnchor",newdocument:"mceNewDocument",blockquote:"mceBlockQuote",help:"mceConfShortcutDialog"},o=["bold","italic","underline","bullist","numlist","tasklist","justifyleft","justifycenter","justifyright","strikethrough","sub","sup","monospace"];function i(e){var n=e.undoManager;t.buttons.state.dispatch("undo","disabled",!n.hasUndo()&&!n.typing),t.buttons.state.dispatch("redo","disabled",!n.hasRedo())}function a(t){var r=e.ui.registry.getAll().buttons[t];if(!r)return!1;r.cmd?n[t]=r.cmd:n[t]={func:r.onAction,name:t}}function u(){r.tinymce.each(r.tinymce.explode(e.settings.theme_advanced_buttons1),(function(n){if(!a(n))switch(n){case"formatselect":t.formatselect={},t.formatselect.state=new bi,t.formatselect.click=new bi,t.formatselect.click.add((function(t){e.execCommand("FormatBlock",!1,t)}))}})),t.buttons={},t.buttons.state=new bi,t.buttons.click=new bi,t.buttons.click.add((function(t){var r=n[t];"string"===pi(r)?e.execCommand(n[t]):yi(r)&&r.func()})),function(){var t={toolbar:"toolbar-primary",title:"",tooltip:"",cmd:"",className:"",locationGroup:null,weight:1/0,onclick:null},n=e.ui.registry.getAll().buttons,r=[];for(var o in n)r.push(mi({},t,n[o],{id:o,weight:vi(n[o].weight,1/0)}));r=r.filter((function(e){return!!e.locationGroup})),["toolbar-primary"].forEach((function(e){var t=c()(".".concat(e));r.filter((function(t){return t.toolbar===e})).sort((function(e,t){return e.weight-t.weight})).forEach((function(e){a(e.id);var n,r=t.find(".".concat(e.locationGroup)),o=c()('<li id="'.concat((n=e).id,'" class="toolbar-item ').concat(n.className,'" data-tooltip="').concat(n.tooltip,'" data-weight="').concat(n.weight,'">\n                            <a class="toolbar-trigger aui-button aui-button-subtle" href="#" data-control-id="').concat(n.id,'">\n                                <span class="icon ').concat(n.icon,'"></span>\n                                <span class="trigger-text">').concat(n.title,"</span>\n                            </a>\n                        </li>"));r.append(o).removeClass("hidden")}))}))}()}var l=Ci.shouldInit();return l&&Ci.suppressIncompatiblePlugins(),e.on("init",(function(){u(),e.settings.readonly||(e.on("NodeChange",(function(a){!function(e,a){r.tinymce.each(o,(function(r){t.buttons.state.dispatch(r,"active",!!wi(e,n[r]))})),i(e),t.buttons.state.dispatch("outdent","disabled",!wi(e,"Outdent"));var c=function(e){for(var t=a.parents,n=0;n<t.length;n++)if(e(t[n]))return t[n]}(e.dom.isBlock);c&&t.formatselect.state.dispatch(c.nodeName.toLowerCase())}(e,{parents:a.parents})})),e.on("keyup",(function(){i(e)})),e.on("MouseUp",(function(){i(e)})),e.dom.bind(e.dom.getRoot(),"dragend",(function(){i(e)})),l&&new Ci(e)),di.a.use()})),e.on("Remove",(function(){di.a.unuse()})),{controlHandlers:t}}Ci.INCOMPATIBLE_PLUGINS=["dfe"],Ci.shouldInit=function(){var e=c()("body");return e.hasClass("edit")||e.hasClass("create")||e.hasClass("copy-page")},Ci.suppressIncompatiblePlugins=function(){for(var e=function(){},t=0,n=Ci.INCOMPATIBLE_PLUGINS.length;t<n;t++)r.tinymce.PluginManager.lookup[Ci.INCOMPATIBLE_PLUGINS[t]]=e},Ci.prototype.init=function(e){var t=r.tinymce.util.VK,n=c()("#content-title"),i=c()("form.editor"),a=c()(e.getBody()),u=c()(e.getDoc()),l=c()("#editor-precursor"),s=c()(e.getWin()),f=c()("#toolbar"),d=u.scrollTop(),m=parseInt(a.css("padding-top"),10)+parseInt(a.css("margin-top"),10),p=parseInt(l.css("padding-top"),10),g=o.a.requestAnimationFrame||o.a.webkitRequestAnimationFrame;function h(t){var n=this;e.plugins.customtoolbar.toggleToolbarButtons(t,t,t,(function(){return!c()(n).parent().hasClass("close")}))}function v(e){return e.getBoundingClientRect().top+document.body.scrollTop}function b(){var e=d-u.scrollTop(),t=v(f[0])-v(i[0]),n=l.outerHeight(),r=f.outerHeight();l.css("top","".concat(t+r+e+p,"px")),a.css("padding-top","".concat(n+m,"px"))}return n.on("keydown",(function(n){var r=n.keyCode||n.which;r!==t.ENTER&&r!==t.DOWN||(n.preventDefault(),n.stopPropagation(),e.focus(!1))})).on("focus click",(function(){h(!0)})),s.on("focus",(function(){h(!1)})),function(e){!function t(){e(t),b()}(),a.on("scroll mousewheel",(function(){setTimeout(b,0)}))}(g),!0};function Si(e){function t(e){var t,o,i,a={id:!0,class:!0,style:!0,rowspan:!0,colspan:!0,"data-mce-style":!0,"data-mce-bogus":!0,"data-macro-name":!0,"data-macro-parameters":!0,"data-macro-body-type":!0,"data-highlight-colour":!0,"data-highlight-class":!0,"data-mce-resize":!0,"data-snooker-col-series":!0,"data-snooker-locked-cols":!0,contenteditable:!0},c=["highlight","nohighlight","relative-table","fixed-table","fixed-width","numberingColumn"],u=0,l=[],s=$(e);if(!e||r(e))return e;if(function(e){var t;e&&e.getAttribute&&(t=e.getAttribute("class"));return t&&t.indexOf("table-wrap")>=0}(e)){var f=$("table",e);if(!f.length)return null;$(f).unwrap(),e=f[0]}if(function(e){return!!e.tagName&&("TABLE"===e.tagName||("TR"===e.tagName||("TH"===e.tagName||("TD"===e.tagName||("TBODY"===e.tagName||("THEAD"===e.tagName||("TFOOT"===e.tagName||("COL"===e.tagName||("COLGROUP"===e.tagName||"CAPTION"===e.tagName)))))))))}(e)&&e.attributes){for(;u<=e.attributes.length;)(t=e.attributes[u])&&!0===t.specified&&!a[t.name]?e.removeAttribute(t.name):u++;n(e)&&l.push(n(e));for(var d=0,m=c.length;d<m;d++)s.hasClass(c[d])&&l.push(c[d]);(o=s.attr("data-highlight-class"))&&l.push(o),(i=s.attr("data-highlight-colour"))&&l.push("highlight-"+i),s.attr("class",l.join(" "))}return e}function n(e){return e.tagName?"TABLE"===e.tagName?"confluenceTable":"TH"===e.tagName?"confluenceTh":"TD"===e.tagName?"confluenceTd":"":""}function r(e){var t;return e&&e.getAttribute&&(t=e.getAttribute("class")),!!e.tagName&&("TABLE"===e.tagName&&(!!t&&-1!==t.indexOf("wysiwyg-macro")))}function o(e,n,o){o.node=function(e,t){for(var n,o,i,a=e;a&&("function"==typeof t&&(a=t(a)),a);)!a.firstChild||(o=a,(i=n)&&i.parentNode===o)||r(a)?a.nextSibling?(n=a,a=a.nextSibling):(n=a,a=a.parentNode):(n=a,a=a.firstChild);return e}(o.node,t)}e.on("Init",(function(){k(document,"postPaste",o)})),e.on("Remove",(function(){T(document,"postPaste",o)}))}var ki=[function(){var e;function t(){}function n(t){!e&&o.a&&o.a.console&&(e=!0,console.log("Deprecated TinyMCE API call: ".concat(t)))}function i(e,r,o,i){e=e||this;var a=[];r?(this.add=function(t,c,u){function l(n){var a=[];if("string"==typeof o&&(o=o.split(" ")),o&&"function"!=typeof o)for(var u=0;u<o.length;u++)a.push(n[o[u]]);("function"!=typeof o||(a=o(r,n,e)))&&(o||(a=[n]),a.unshift(i||e),!1===t.apply(c||i||e,a)&&n.stopImmediatePropagation())}n("<target>.on".concat(r,".add(..)")),e.on(r,l,u);var s={original:t,patched:l};return a.push(s),l},this.addToTop=function(e,t){this.add(e,t,!0)},this.remove=function(t){return a.forEach((function(n,o){if(n.original===t)return a.splice(o,1),e.off(r,n.patched)})),e.off(r,t)},this.dispatch=function(){return e.fire(r),!0}):this.add=this.addToTop=this.remove=this.dispatch=t}function a(e){function o(t,n){r.tinymce.each(t.split(" "),(function(t){e["on".concat(t)]=new i(e,t,n)}))}function a(e,t,n){return[t.level,n]}function c(e){return function(t,n){if(!n.selection&&!e||n.selection==e)return[n]}}if(!e.controlManager){e.controlManager={buttons:{},setDisabled:function(e,t){n("controlManager.setDisabled(..)"),this.buttons[e]&&this.buttons[e].disabled(t)},setActive:function(e,t){n("controlManager.setActive(..)"),this.buttons[e]&&this.buttons[e].active(t)},onAdd:new i,onPostRender:new i,add:function(e){return e},createButton:u,createColorSplitButton:u,createControl:u,createDropMenu:u,createListBox:u,createMenuButton:u,createSeparator:u,createSplitButton:u,createToolbar:u,createToolbarGroup:u,destroy:t,get:t,setControlType:u},o("PreInit BeforeRenderUI PostRender Load Init Remove Activate Deactivate","editor"),o("Click MouseUp MouseDown DblClick KeyDown KeyUp KeyPress ContextMenu Paste Submit Reset"),o("BeforeExecCommand ExecCommand","command ui value args"),o("PreProcess PostProcess LoadContent SaveContent Change"),o("BeforeSetContent BeforeGetContent SetContent GetContent",c(!1)),o("SetProgressState","state time"),o("VisualAid","element hasVisual"),o("Undo Redo",a),o("NodeChange",(function(t,n){return[e.controlManager,n.element,e.selection.isCollapsed(),n]}));e.addButton;e.addButton=function(t,n){var o,i,a;n.title&&(n.text=(o=n.title,i=[e.settings.language||"en",o].join("."),a=r.tinymce.i18n.translate(i),i!==a?a:r.tinymce.i18n.translate(o))),n.cmd&&(n.onAction=function(){ed.execCommand(n.cmd)}),e.ui.registry.addButton(t,n)},e.on("init",(function(){var t=e.undoManager,n=e.selection;t.onUndo=new i(e,"Undo",a,null,t),t.onRedo=new i(e,"Redo",a,null,t),t.onBeforeAdd=new i(e,"BeforeAddUndo",null,t),t.onAdd=new i(e,"AddUndo",null,t),n.onBeforeGetContent=new i(e,"BeforeGetContent",c(!0),n),n.onGetContent=new i(e,"GetContent",c(!0),n),n.onBeforeSetContent=new i(e,"BeforeSetContent",c(!0),n),n.onSetContent=new i(e,"SetContent",c(!0),n)})),e.on("BeforeRenderUI",(function(){var t=e.windowManager;t.onOpen=new i,t.onClose=new i,t.createInstance=function(e,t,o,i,a,c){return n("windowManager.createInstance(..)"),new(r.tinymce.resolve(e))(t,o,i,a,c)}})),e.getLang=function(t,n){return e.editorManager.i18n.data[(e.settings.language||"en")+"."+t]||(void 0!==n?n:"{#"+t+"}")}}function u(){var e={};function t(){return u()}return n("editor.controlManager.*"),r.tinymce.each("add addMenu addSeparator collapse createMenu destroy displayColor expand focus getLength hasMenus hideMenu isActive isCollapsed isDisabled isRendered isSelected mark postRender remove removeAll renderHTML renderMenu renderNode renderTo select selectByIndex setActive setAriaProperty setColor setDisabled setSelected setState showMenu update".split(" "),(function(n){e[n]=t})),e}}r.tinymce.util.Dispatcher=i,r.tinymce.onBeforeUnload=new i(r.tinymce,"BeforeUnload"),r.tinymce.onAddEditor=new i(r.tinymce,"AddEditor","editor"),r.tinymce.onRemoveEditor=new i(r.tinymce,"RemoveEditor","editor"),r.tinymce.util.Cookie={get:t,getHash:t,remove:t,set:t,setHash:t},r.tinymce.on("SetupEditor",(function(e){a(e.editor)})),r.tinymce.PluginManager.add("compat3x",a),r.tinymce.addI18n=function(e,t){var n=r.tinymce.util.I18n,o=r.tinymce.each;if("string"!=typeof e||-1!==e.indexOf("."))if(n.data=n.data||{},r.tinymce.is(e,"string"))if(r.tinymce.is(t,"string")){var i=e.split("."),a=i.shift(),c={};c[i.join()]=t,n.add(a,c)}else o(t,(function(t,r){n.data["".concat(e,".").concat(r)]=t;var o=e.split("."),i=o.shift();o.push(r);var a={};a[o.join(".")]=t,n.add(i,a)}));else o(e,(function(e,t){o(e,(function(e,r){o(e,(function(e,o){var i={};"common"===r?(n.data["".concat(t,".").concat(o)]=e,i[o]=e):(n.data["".concat(t,".").concat(r,".").concat(o)]=e,i["".concat(r,".").concat(o)]=e),n.add(t,i)}))}))}));else n.add(e,t)}},function(){r.tinymce.PluginManager.add("atlassiantheme",xi)},function(){u("init.rte",S)},function(){r.tinymce.PluginManager.add("aePaste",re)},function(){r.tinymce.PluginManager.add("tablePasteFilter",Si)},function(){r.tinymce.create("tinymce.plugins.ConfList",{init:function(e){e.editorCommands.addCommands({outdent:function(){var t=e.selection,n=e.dom;function r(t){var r=n.getParent(t,n.isBlock);return r&&parseInt(e.dom.getStyle(r,"margin-left",!1)||0,10)+parseInt(e.dom.getStyle(r,"padding-left",!1)||0,10)>0}return r(t.getStart())||r(t.getEnd())||e.queryCommandState("InsertOrderedList")||e.queryCommandState("InsertUnorderedList")||e.queryCommandState("InsertInlineTaskList")}},"state")}}),r.tinymce.PluginManager.add("conflist",r.tinymce.plugins.ConfList)},function(){r.tinymce.PluginManager.add("tasklist",(function(e){var t=function(){var t=Le(e);t&&function(t){var n=e.dom.getParent(t.parentElement,"UL");return t&&"UL"===t.tagName&&n&&n.classList.contains("inline-task-list")&&t!=n}(t)&&function(e){return Array.from(e.childNodes).every((function(e){return e.hasAttribute("data-inline-task-id")}))}(t)&&e.undoManager.ignore((function(){t.classList.add("inline-task-list")}))},n=function(){return"page"!==F.get("content-type")&&"blogpost"!==F.get("content-type")&&"template"!==F.get("content-type")||e.undoManager.transact((function(){je(Le(e))&&(e.execCommand("InsertOrderedList"),He(Le(e))),function(e){var t=e.dom.uniqueId();e.execCommand("InsertUnorderedList",!1,{"list-attributes":{"data-task-list-id":t,class:"inline-task-list"},"list-item-attributes":{"data-inline-task-id":""}}),e.dom.select('[data-task-list-id="'.concat(t,'"]')).forEach((function(t){var n=t.querySelectorAll("li")[0];n&&e.dom.isEmpty(t)&&(n.innerHTML='<span class="placeholder-inline-tasks">'.concat(ge("tinymce.confluence.placeholder.inline.tasks"),"</span>"),e.selection.select(n.firstChild,!0)),t.removeAttribute("data-task-list-id")}))}(e)})),!1};function o(t,n){if(!Ue()){var r=n.handlerManager,o=n.createHandler;r.registerHandler("]".charCodeAt(0),o(Me,(function(){e.execCommand("InsertInlineTaskList")}),!0))}}function i(){e.addQueryStateHandler("InsertInlineTaskList",(function(){return Fe(Le(e))})),e.addQueryStateHandler("InsertUnorderedList",(function(){return je(Le(e))}))}function a(t,n,r){if(Ue()){var o=e.dom.createFragment("");o.appendChild(r.node),Array.prototype.slice.call(o.querySelectorAll("ul.inline-task-list, ol.inline-task-list")).forEach((function(e){return He(e)}))}}e.addCommand("InsertInlineTaskListNoToggle",(function(){return Fe(Le(e))||n(),!1})),e.addCommand("InsertInlineTaskList",n),e.on("BeforeExecCommand",(function(t){"InsertUnorderedList"===t.command&&Fe(Le(e))&&!t.value?e.undoManager.ignore((function(){e.execCommand("InsertOrderedList"),He(Le(e))})):"InsertOrderedList"!==t.command||t.value||e.undoManager.ignore((function(){He(Le(e))}))})),e.on("execCommand",(function(e){"Indent"===e.command&&t()})),e.on("Click",(function(t){var n=t.target;if("LI"===n.tagName){var o=e.dom.getParent(n,"ul,ol");"UL"===o.tagName&&e.dom.hasClass(o,"inline-task-list")&&function(t,n){var o,i;if(r.tinymce.Env.gecko){var a=n.getBoundingClientRect();o=t.pageX-(a.left+r.tinymce.DOM.getViewPort(e.getWin()).x),i=t.pageY-(a.top+r.tinymce.DOM.getViewPort(e.getWin()).y)}else o=t.offsetX,i=t.offsetY;return o>=3&&o<=14&&i>=3&&i<=14}(t,n)&&(e.dom.hasClass(n,"checked")?e.dom.removeClass(n,"checked"):e.dom.addClass(n,"checked"))}})),e.on("KeyUp",(function(t){if(t.keyCode===r.tinymce.util.VK.ENTER&&!t.shiftKey){var n=(o=e.selection.getStart())&&o.tagName&&"LI"===o.tagName.toUpperCase()?o:e.dom.getParent(o,"li");if(n){if(e.dom.removeClass(n,"checked"),!n.parentNode)return;e.dom.hasClass(n.parentNode,"inline-task-list")?n.setAttribute("data-inline-task-id",""):n.removeAttribute("data-inline-task-id")}}var o})),e.on("KeyDown",(function(e){e.shiftKey||e.keyCode!==r.tinymce.util.VK.TAB||r.tinymce.util.VK.metaKeyPressed(e)||t()})),u("confluence.editor.registerHandlers",o),u("rte-ready",i),k(r.document,"postPaste",a),e.on("Remove",(function(){l("confluence.editor.registerHandlers",o),l("rte-ready",i),T(r.document,"postPaste",a)}))}))},function(){u("init.rte",fn)},function(){r.tinymce.create("tinymce.plugins.DeleteCommandPlugin",{init:function(e){e.addCommand("mceDelete",(function(t,n){return function(){if(r.tinymce.Env.webkit){var t=e.selection.getRng();if(!t||t.collapsed)return!1;var n=c()(t.startContainer).closest(".wysiwyg-macro-body",e.getBody())[0];if(n&&w.isRangeAtStartOf(n,t)&&w.isRangeAtEndOf(n,t)){var o=c()(n.firstChild).is("pre")?"pre":"p",i=c()("<".concat(o,'><br data-mce-bogus="1"></').concat(o,">"))[0];return c()(n).html(i),e.selection.select(i,!0),!0}}return!1}()||e.getDoc().execCommand("Delete",t),!1}))},getInfo:function(){return{longname:"Delete Command Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}}),r.tinymce.PluginManager.add("deletecommand",r.tinymce.plugins.DeleteCommandPlugin)},function(){},function(){var e,t,n=(e=o.a.Raphael,t=new r.tinymce.util.Dispatcher,{AUIWindowManager:{init:function(e){e.on("init",(function(){e.windowManager=new r.tinymce.AUIWindowManager(e)}))},getInfo:function(){return{longname:"AUIWindowManager",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}},WindowManager:{AUIWindowManager:function(e){var n=this;n.eventDispatcher=t,n.editor=e,n.params={},n.features={},n.modalDialogsStack=[],n.dialogs={},n.count=0,n.tinymceWM=e.windowManager},open:function(e,t){var n=this;if(e.title===n.editor.translate("Accessibility Checker"))return n.tinymceWM.open(e,t);e=e||{},n.initialiseSettings(e),t=t||{},(t=this.setDefaultParameters(t)).mce_width=e.width,t.mce_height=e.height,t.mce_auto_focus=e.auto_focus,n.features=e,n.params=t,n.eventDispatcher.dispatch("open",{t:n,settings:e,params:t});var o=e.height;e.name&&(o+=56),(t.cancelLink||t.buttons)&&(o+=51),o+=40,e.popup&&(o+=8);var i=e.id||r.tinymce.DOM.uniqueId(),a=(new xr).component({width:e.width,height:o,id:i,onCancel:function(){a.hide().remove()}});e.name&&a.addHeader(this.editor.translate(e.name)),this.createDialogButtons(a,t,i),e.file=e.file||e.url,e.file&&(e.file=e.file),this.createDialogContent(a,e,t,i),t.helpLink&&this.createHelpLink(a,t.helpLink,t.helpName,i),t.hintText&&this.createHintText(a,t.hintText,i);var c={id:i,settings:e,params:t,dialog:a};return this.modalDialogsStack.push(c),this.dialogs[i]=c,this.count++,Se(),a.show(),null!=a.takeFocus&&a.takeFocus(),i},initialiseSettings:function(e){e.width=parseInt((e.width||400).toString(),10),e.height=parseInt((e.height||250).toString(),10),e.resizable=!1,null==e.popup&&(e.popup=!0),e.popup&&null!=e.content&&(e.popup=!1),e.scrollbars?e.scrollbars="yes":e.scrollbars="no"},createDialogButtons:function(e,t,n){if(t.buttons)for(var o=0;o<t.buttons.length;o++){var i=t.buttons[o];e.addButton(this.editor.translate("".concat(i.label)),i.action)}t.cancelLink&&e.addCancel(this.editor.translate("auiwindowmanager.cancel"),(function(){return r.tinymce.activeEditor.windowManager.close(n)}))},createDialogContent:function(e,t,n,r){var o=this.createContentId(r),i="panel_".concat(o);t.popup?(e.addPanel(i,c()('<iframe id="'.concat(o,'" width="100%" height="').concat(t.height,'px" frameborder="0" name="auidialogiframe" src="').concat(t.file,'" scrolling="').concat(t.scrollbars,'"></iframe>')),n.cssClass),e.takeFocus=function(){c()("#".concat(o)).focus()}):(null==t.content?(e.addPanel(i,c()('<div id="'.concat(o,'"/>')),n.cssClass),c()("#".concat(o)).load(t.file)):e.addPanel(i,c()('<div id="'.concat(o,'">').concat(t.content,"</div>")),n.cssClass),e.takeFocus=function(){var e=c()("#".concat(o,":input"));if(e.length)c()(e[0]).focus();else{var t=c()("#".concat(o," .button-panel button"));t.length&&c()(t[0]).focus()}}),e.gotoPanel(0,0)},createHintText:function(e,t,n){var o=c()("<div></div>").addClass("dialog-tip");o.text(r.tinymce.activeEditor.translate("".concat(t))),c()("#".concat(n," .dialog-button-panel")).append(o)},createHelpLink:function(e,t,n,r){var o=c()("<div></div>").addClass("dialog-help-link");o.load("".concat(ye,"/plugins/tinymce/helplink.action"),{linkUrlKey:t,linkNameKey:n||""}),c()("#".concat(r," .dialog-components .dialog-title")).prepend(o)},close:function(e,t){var n,o;return"string"==typeof e?n=e:t?n=t:(o=this.modalDialogsStack.pop())&&(n=o.id),this.dialogs[n]&&(this.count--,(o=this.dialogs[n]).dialog.remove(),this.dialogs[n]=null,r.tinymce.activeEditor.focus(),ke()),!1},alert:function(e,t,n){if("Please use Ctrl+V/Cmd+V keyboard shortcuts to paste contents."!==e){var o,i={content:"<p>".concat(e,"</p>"),width:500,height:160,popup:!1},a={buttons:[{label:"auiwindowmanager.ok",action:function(){r.tinymce.activeEditor.windowManager.toggleOtherDialogs(o,!0),r.tinymce.activeEditor.windowManager.close(o),t&&t.call(n||this)}}],cancelLink:!1,cssClass:"tinymce-auidialog-alert"};o=this.open(i,a),this.toggleOtherDialogs(o,!1)}},createInstance:function(e,t,n,o,i,a){return new(r.tinymce.resolve(e))(t,n,o,i,a)},toggleOtherDialogs:function(e,t){for(var n=0;n<this.modalDialogsStack.length;n++){var r=this.modalDialogsStack[n];r.id!=e&&c()("".concat(r.id," .dialog-button-panel")).toggle(t)}},confirm:function(e,t,n,r){r=r||o.a,t.call(n||this,r.confirm(this._decode(this.editor.translate(e))))},setBusy:function(t,n){var r=this.dialogs[t],o="#".concat(this.createBusyContentId(t)),i="#".concat(this.createContentId(t)),a=c()(i),u=c()(o);if(r)if(n){var l=c()(i);l.hide();var s=l.parent(),f=c()(o,s);f.length||(s.append(c()('<div id="'.concat(o,'" class="spinner"></div>'))),f=c()(o,s),e.spinner(f[0],50,"#666")),c()(".button-panel button",c()("#".concat(t))).each((function(e,t){c()(t).prop("disabled",!0)})),c()(f[0]).show()}else u.length&&u.hide(),c()(".button-panel button",c()("#".concat(t))).each((function(e,t){c()(t).prop("disabled",!1)})),a.show()},logMCESelection:function(e){r.tinymce.activeEditor.selection},setDefaultParameters:function(e){return e.inline=!1,e.cssClass||(e.cssClass="tinymce-auidialog"),0!=e.cancelLink&&(e.cancelLink=!0),e},createContentId:function(e){return"content_".concat(e)},createBusyContentId:function(e){return"content_busy_".concat(e)},resizeBy:function(){}}});r.tinymce.create("tinymce.plugins.AUIWindowManager",n.AUIWindowManager),r.tinymce.create("tinymce.AUIWindowManager:tinymce.WindowManager",n.WindowManager),r.tinymce.PluginManager.add("auiwindowmanager",r.tinymce.plugins.AUIWindowManager)},function(){var e;e=he(),r.Confluence.PropertyPanel.TextPlaceholder=e,u("init.rte",(function(){"template"===F.get("content-type")&&s("add-handler.property-panel",e)})),r.tinymce.create("tinymce.plugins.TextPlaceholderPlugin",ve()),r.tinymce.PluginManager.add("textplaceholders",r.tinymce.plugins.TextPlaceholderPlugin)},function(){r.tinymce.create("tinymce.plugins.EmotionsPlugin",{init:function(e,t){e.addCommand("mceEmotion",(function(){return e.windowManager.open({file:"".concat(r.tinymce.settings.editor_plugin_action_base_path,"/emotions.action"),width:190,height:125,inline:1,id:"insert-emoticon-dialog",name:"emotions_dlg.title"},{plugin_url:t}),!1})),e.ui.registry.addButton("emotions",{text:"emotions.emotions_desc",onAction:function(){e.execCommand("mceEmotion")}}),e.on("Click",(function(t){var n,o=t.target;if("IMG"===o.nodeName&&o.classList.contains("emoticon"))return(n=e.selection.getRng())&&((t.offsetX||t.layerX-o.x)<o.width/2?(n.setStartBefore(o),n.setEndBefore(o)):(n.setStartAfter(o),n.setEndAfter(o)),e.selection.setRng(n)),e.selection.collapse(),r.tinymce.dom.Event.cancel(t)}))},getInfo:function(){return{longname:"Emotions",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/emotions",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}}),r.tinymce.PluginManager.add("emotions",r.tinymce.plugins.EmotionsPlugin)},function(){r.tinymce.create("tinymce.plugins.ConfluencePlugin",{init:function(e){e.addCommand("mceConfUnlink",(function(t,n){var o=e.selection,i=n||o.getNode(),a=c()(i);if("A"!==i.nodeName){var u=a.closest("a");if(!u.length)return!1;i=u[0],a=u}var l,s,f=a.attr("href");if(f||(f="#",a.attr("href",f)),!a.attr("data-linked-resource-id")&&r.Confluence.Link.isExternalLink(f)&&a.text()==(null!=(s=/(.*)[\/]$/.exec(l=f))?s[1]:l)){var d=e.dom.create("span",{class:"nolink"},f);e.dom.replace(d,i,!1)}else o.select(i),a.removeClass("createlink unresolved"),e.execCommand("UnLink");return!1})),e.ui.registry.addButton("confimage",{text:"confluence.confimage_desc",onAction:function(){e.execCommand("mceConfimage")}}),e.ui.registry.addButton("conf_macro_browser",{text:"confluence.conf_macro_browser_desc",onAction:function(){e.execCommand("mceConfMacroBrowser")}})},getInfo:function(){return{longname:"Confluence TinyMCE Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}}),r.tinymce.PluginManager.add("confluence",r.tinymce.plugins.ConfluencePlugin)},function(){var e;r.tinymce.create("tinymce.plugins.MacroPlaceHolderPlugin",(e=r.tinymce.util.VK,{init:function(t){var n=this;function o(e){t.on("KeyDown",e),r.tinymce.isGecko&&(t.on("KeyPress",e),t.on("KeyUp",e))}function i(e,t){return e&&1===e.childNodes.length&&c()(e).is(t)&&c()(e.firstChild).is("br")}function a(e){if(!e.collapsed)return!1;var t=3===e.startContainer.nodeType?e.startContainer.parentNode:e.startContainer;if(!t||!t.parentNode)return!1;for(;t&&!c()(t).is(".wysiwyg-macro-body");){if(t.previousSibling||t.nextSibling)return!1;t=t.parentNode}return!0}t.on("Init",(function(){t.on("SetContent",(function(e){e.selection&&r.tinymce.each(t.dom.select("p > .wysiwyg-macro"),(function(e){var n=t.dom.getParent(e.parentNode,"p");try{t.dom.split(n,e)}catch(e){}}))}))})),t.on("SetContent",(function(){r.tinymce.each(t.dom.select('.wysiwyg-macro[data-macro-body-type="PLAIN_TEXT"] .wysiwyg-macro-body'),(function(e){t.dom.select("pre",e).length||t.dom.setHTML(e,"<pre><br /></pre>")}))})),t.on("KeyDown",(function(n){var o=t.selection,i=[e.BACKSPACE,e.DELETE,e.ENTER,e.ESCAPE];if(-1==c.a.inArray(n.keyCode,i)&&!function(t){var n=!1;return 0===t.charCode&&(n=-1!=c.a.inArray(t.keyCode,[e.SHIFT,e.CTRL,e.ALT,e.META])),n}(n)&&!o.isCollapsed()&&!(n.ctrlKey||n.metaKey||!r.tinymce.isMac&&n.altKey)){var a=o.getNode();if(Pe.isMacroWithBody(a)){var u=c()(".wysiwyg-macro-body",a);u.length>0&&o.select(u[0],!0)}}})),t.on("DblClick",(function(e){var t=c()(e.target),n=t.closest("[data-macro-name]");if(n.length){if(n.attr("data-macro-body-type")&&t.closest(".wysiwyg-macro-body").length)return;Pe.editMacro(n),r.Confluence.PropertyPanel&&r.Confluence.PropertyPanel.current&&r.Confluence.PropertyPanel.destroy()}})),t.addCommand("mceConfRemoveMacro",(function(e){c()(e).remove(),r.tinymce.isGecko&&t.execCommand("mceRepaint",!1)})),n._isCursorInMostNestedElement=a,function(){function e(e){if(!e.collapsed)return!1;var t=3===e.startContainer.nodeType?e.startContainer.parentNode:e.startContainer;return t&&t.previousSibling&&!t.nextSibling&&i(t,"p, pre")}(r.tinymce.isWebKit||r.tinymce.isGecko)&&o((function(n){var o=t.selection.getRng();if(46===n.keyCode&&o&&e(o))return r.tinymce.dom.Event.cancel(n)})),n._isCursorInLastParagraphOrPre=e}(),r.tinymce.isWebKit&&o((function(e){if(8!==e.keyCode&&46!==e.keyCode)return!0;var n=t.selection.getRng();if(!n)return!0;var o=3===n.startContainer.nodeType?n.startContainer.parentNode:n.startContainer;return!(function(e){if(!e.collapsed)return!1;var t=3===e.startContainer.nodeType?e.startContainer.parentNode:e.startContainer;return a(e)&&t&&1===t.childNodes.length&&c()(t.firstChild).is("br")}(n)&&(8!==e.keyCode||!c()(o).is("li")))||r.tinymce.dom.Event.cancel(e)})),function(){function e(e){if(!e.collapsed)return!1;var t=3===e.startContainer.nodeType?e.startContainer.parentNode:e.startContainer;return t&&0===e.startOffset&&c()(t).is(".wysiwyg-macro-body > ul > li")&&1===t.childNodes.length&&c()(t.firstChild).is("br")}r.tinymce.isWebKit&&o((function(n){var o=t.selection.getRng();return 8!==n.keyCode||!o||!e(o)||(t.execCommand("Outdent"),r.tinymce.dom.Event.cancel(n))})),n._isCursorInsideMacroPlacholderInsideListItemContainingSoloBr=e}(),function(){function e(e){var t=3===e.startContainer.nodeType?e.startContainer.parentNode:e.startContainer,n=c()(t);return 0===e.startOffset&&i(t,"p, pre")&&n.parent().is("td.wysiwyg-macro-body")&&t&&!t.previousSibling&&t.nextSibling&&i(t.nextSibling,"p, pre")}r.tinymce.isWebKit&&o((function(n){var o=t.selection.getRng();if(46!==n.keyCode||!o)return!0;var i=3===o.startContainer.nodeType?o.startContainer.parentNode:o.startContainer,a=c()(i);if(e(o)){var u=i.nextSibling;return a.remove(),t.selection.select(u,!0),r.tinymce.dom.Event.cancel(n)}})),n._isCursorInFirstParagraphWhenThereAreTwoEmptyParagraphs=e}(),function(){function e(e){var t=3===e.startContainer.nodeType?e.startContainer.parentNode:e.startContainer,n=c()(t);return 0===e.startOffset&&i(t,"p, pre")&&n.parent().is("td.wysiwyg-macro-body")&&t&&!t.nextSibling&&t.previousSibling&&!t.previousSibling.previousSibling&&i(t.previousSibling,"p, pre")}r.tinymce.isWebKit&&o((function(n){var o=t.selection.getRng();if(8!==n.keyCode||!o)return!0;var i=3===o.startContainer.nodeType?o.startContainer.parentNode:o.startContainer,a=c()(i);if(e(o)){var u=i.previousSibling;return a.remove(),t.selection.select(u,!0),r.tinymce.dom.Event.cancel(n)}})),n._isCursorInSecondParagraphWhenThereAreTwoEmptyParagraphs=e}(),function(){function e(e){if(!e||!e.collapsed)return!1;var t=3===e.startContainer.nodeType?e.startContainer.parentNode:e.startContainer,n=c()(t);return!(!t||e.startOffset>0)&&(xe.normalize(t),t&&0===e.startOffset&&i(t,"p, pre")&&n.parent().is("td.wysiwyg-macro-body")&&!t.previousSibling&&!t.nextSibling)}(r.tinymce.isWebKit||r.tinymce.isGecko)&&o((function(n){return 8!==n.keyCode&&46!==n.keyCode||(e(t.selection.getRng())?r.tinymce.dom.Event.cancel(n):void 0)})),n._isCursorInSoloParagraphOrPreInsidePlaceholder=e}(),function(){function e(e){return e&&e.parentNode&&"BR"===e.nodeName&&e===e.parentNode.lastChild}function i(t){if(!t.collapsed)return!1;var n=t.startContainer;return n&&0===t.startOffset&&3===n.nodeType&&a(t)&&1===n.nodeValue.length&&!n.previousSibling&&(!n.nextSibling||e(n.nextSibling))}function u(t){if(!t.collapsed)return!1;var n=t.startContainer;return n&&1===t.startOffset&&3===n.nodeType&&a(t)&&1===n.nodeValue.length&&!n.previousSibling&&(!n.nextSibling||e(n.nextSibling))}function l(e){if(!e.collapsed)return!1;var t=e.startContainer;return t&&0===e.startOffset&&1===t.nodeType&&1===t.childNodes.length&&a(e)&&!t.previousSibling&&!t.nextSibling}function s(e){if(!e.collapsed)return!1;var t=e.startContainer;return t&&1===e.startOffset&&1===t.nodeType&&1===t.childNodes.length&&a(e)&&!t.previousSibling&&!t.nextSibling}(r.tinymce.isWebKit||r.tinymce.isGecko)&&o((function(e){if(8!==e.keyCode&&46!==e.keyCode)return!0;var n=t.selection.getRng();if(!n)return!0;var o=3===n.startContainer.nodeType?n.startContainer.parentNode:n.startContainer;return!c()(o).closest(".wysiwyg-macro-body").size()||(xe.normalize(o),!(46===e.keyCode&&(i(n)||l(n))||8===e.keyCode&&(u(n)||s(n)))||(o.lastChild&&!c()(o.lastChild).is("br")&&c()(o).append("<br/>"),c()(o.firstChild).remove(),t.selection.select(o,!0),r.tinymce.dom.Event.cancel(e)))})),n._isCursorBehindOnlyCharacterInNestedElement=i,n._isCursorAfterOnlyCharacterInNestedElement=u,n._isCursorBehindOnlyChildInNestedElement=l,n._isCursorAfterOnlyChildInNestedElement=s}(),function(){function e(e){return!e.collapsed&&(0===e.startOffset&&i(e.startContainer,(function(e){return!e.previousSibling}))&&(t=e.endContainer,n=e.endOffset,!!t&&(3===t.nodeType?n===t.nodeValue.length:1===t.nodeType&&(1===t.childNodes.length&&c()(t.firstChild).is("br")?0===n:n===t.childNodes.length)))&&i(e.endContainer,(function(e){return!e.nextSibling})));var t,n}function i(e,t){if(!e)return!1;if(c()(e).is(".wysiwyg-macro-body"))return!0;do{if(!t(e))return!1;e=e.parentNode}while(e&&!c()(e).is(".wysiwyg-macro-body"));return!0}r.tinymce.isWebKit&&o((function(n){if(8!==n.keyCode&&46!==n.keyCode)return!0;var o=t.selection.getRng();if(o&&e(o)){var i=c()(o.startContainer).closest(".wysiwyg-macro-body");if(i.length>0){var a,u=c()(i[0].firstChild).is("pre");return t.undoManager.add(),i.empty(),a=u?c()("<pre><br/></pre>").appendTo(i):c()("<p><br/></p>").appendTo(i),t.selection.select(a[0],!0),r.tinymce.dom.Event.cancel(n)}}return!0})),n._isMacroBodySelected=e}(),function(){function e(e){if(!e||!e.collapsed)return!1;var t=3===e.startContainer.nodeType?e.startContainer.parentNode:e.startContainer,n=c()(t);return 0===e.startOffset&&i(t,"p")&&n.next().is("table")}r.tinymce.isWebKit&&o((function(n){if(46===n.keyCode&&e(t.selection.getRng()))return r.tinymce.dom.Event.cancel(n)})),n._isCursorInEmptyParagraphPrecedingPlaceholder=e}(),function(){function i(e){return e?3===e.nodeType?e:i(e.firstChild)||i(e.nextSibling):null}function a(e){return e&&"PRE"!==e.nodeName&&"TD"!==e.nodeName?"BR"===e.nodeName?e:a(e.previousSibling)||a(e.parentNode):null}function u(e){var t,n;return c()(e.commonAncestorContainer).closest(".wysiwyg-macro td").length>0&&(a(e.startContainer)||(t=i(function e(t){return!t||c()(t.parentNode).is(".wysiwyg-macro td")?null:c()(t.parentNode).is("p")?t.parentNode:e(t.parentNode)}(e.startContainer)))),(n=c()(e.commonAncestorContainer).closest(".wysiwyg-macro td > pre")).length>0&&(a(e.startContainer)||(t=i(n[0]))),t&&(e=e.cloneRange()).setStart(t,0),e}r.tinymce.isWebKit&&r.tinymce.isMac&&o((function(n){var o=t.selection.getRng();if(o&&(n.metaKey||n.ctrlKey)&&n.shiftKey&&n.keyCode===e.LEFT){var i=u(o);if(i!==o)return t.selection.setRng(i),r.tinymce.dom.Event.cancel(n)}})),n._selectTillStart=u}(),t.on("KeyDown",(function(e){if(e.keyCode===r.tinymce.util.VK.TAB){var n=t.selection.getRng();if(n){var o=3===n.startContainer.nodeType?n.startContainer.parentNode:n.startContainer;if(c()(o).is(".wysiwyg-macro-body > pre")){t.undoManager.beforeChange(),t.undoManager.add();var i=t.getDoc().createTextNode("\t");return n.insertNode(i),t.selection.setCursorLocation(i,1),t.undoManager.add(),r.tinymce.dom.Event.cancel(e)}}}}),!0)},getInfo:function(){return{longname:"Macro Place Holder plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"1.0"}}})),r.tinymce.PluginManager.add("macroplaceholder",r.tinymce.plugins.MacroPlaceHolderPlugin)},function(){k(r.document,"initContextToolbars.Toolbar",(function(){Go().initContextToolbars(),function(e){var t={},n={},r=function(e,n){var r,o;for(o in t)if(t.hasOwnProperty(o)&&t[o].isEnabled)for(var i=0,a=t[o].events.length;i<a;i++)(r=t[o].events[i]).type.toLowerCase().indexOf(n.type)>-1&&(r.shouldTrigger(e,n)?r.callback.apply(this,[n.target]):r.missed&&r.missed())};return{addEventsForComponent:function(o,i){o in t||(t[o]={},t[o].events=[],t[o].isEnabled=!0);for(var a=function(a,c){var u;!(i[a].type in n)&&(n[i[a].type]=!0,e[i[a].type].add(r)),"function"!=typeof i[a].shouldTrigger&&(u=i[a].shouldTrigger,i[a].shouldTrigger=function(e,t){return t.target.tagName.toLowerCase()==u}),t[o].events.push(i[a])},c=0,u=i.length;c<u;c++)a(c)},disableEventsForComponent:function(e){for(var n=0,r=t.length;n<r;n++)if(e in t)return t[e].isEnabled=!1,!0;return!1},enableEventsForComponent:function(e){for(var n=0,r=t.length;n<r;n++)if(e in t)return t[e].isEnabled=!0,!0;return!1}}}(r.tinymce).addEventsForComponent("TableToolbar",Tr)}))},function(){Sr(),r.AJS.Rte=me()||{},r.AJS.Rte.TablePicker=kr(),r.tinymce.create("tinymce.plugins.customtoolbar",Rr()),r.tinymce.PluginManager.add("customtoolbar",r.tinymce.plugins.customtoolbar)},function(){r.tinymce.create("tinymce.plugins.InsertWikiMarkupPlugin",no),r.tinymce.PluginManager.add("insertwikimarkup",r.tinymce.plugins.InsertWikiMarkupPlugin)},function(){r.tinymce.create("tinymce.plugins.PropertyPanel",Be()),r.tinymce.PluginManager.add("propertypanel",r.tinymce.plugins.PropertyPanel)},function(){},function(){r.tinymce.create("tinymce.plugins.ConfMonospacePlugin",{init:function(e){e.addCommand("confMonospace",(function(){return e.formatter.toggle("monospace",void 0),!1})),e.on("Init",(function(){e.formatter.register({monospace:{inline:"code"}}),e.editorCommands.addCommands({confMonospace:function(){return e.formatter.match("monospace")}},"state")})),e.ui.registry.addButton("monospace",{text:"monospace",onAction:function(){e.execCommand("confMonospace")}})},getInfo:function(){return{longname:"Monospace Formatting",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}}),r.tinymce.PluginManager.add("confmonospace",r.tinymce.plugins.ConfMonospacePlugin)},function(){r.tinymce.create("tinymce.plugins.ConfCharmapPlugin",{init:function(e){e.addCommand("confCharmap",(function(){return e.windowManager.open({id:"insert-char-dialog",url:"".concat(r.tinymce.settings.editor_plugin_action_base_path,"/charmap.action"),width:600,height:290,inline:!0,name:"advanced.charmap_desc"},{}),!1}))},getInfo:function(){return{longname:"Confluence Charmap Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}}),r.tinymce.PluginManager.add("confcharmap",r.tinymce.plugins.ConfCharmapPlugin)},function(){var e=this,t=".wysiwyg-macro,.placeholder,table";r.tinymce.create("tinymce.plugins.CursorTargetPlugin",{init:function(n){var o=r.tinymce.util.VK;function i(e,n){c()(t,e).each((function(e,r){!function(e,n){var r=c()(e);function o(e){if(0===e.length)throw new Error("no paragraph element specified");ze()&&e.addClass("auto-cursor-target");var t=e[0];return 0===t.childNodes.length&&(t.innerHTML="<br />"),t}function i(e){return!c()(e).is("ol, ul, p, pre, table, blockquote, div, h1, h2, h3, h4, h5, h6")}function a(e,t){var n=c()("<p/>");if(c()(e.parentNode).is("li, td, th"))for(;e[t]&&i(e[t]);)n["previousSibling"==t?"prepend":"append"](e[t]);return o(n)}(!r.prev().length||r.prev(t).length||c()(e.parentNode).is("li, td, th")&&i(e.previousSibling))&&r.before(a(e,"previousSibling")),(!r.next().length||r.next(".synchrony-container").length||c()(e.parentNode).is("li, td, th")&&i(e.nextSibling))&&r.after(a(e,"nextSibling")),ze()&&r.next().length&&!r.next().next().length&&s(r.next()[0])&&r.next().addClass("auto-cursor-target"),n&&function(e){function n(e){("BR"===e[0].nodeName||s(e[0]))&&e.replaceWith(o(c()("<p/>")))}var r=e.prev();r.length&&function(e){for(var n=e.prev();n.length&&!n.is(t);){var r=n[0];if("BR"!==r.nodeName&&"P"!==r.nodeName)return!1;n=n.prev()}return!0}(r)&&n(r);var i=e.next();i.length&&function(e){for(var n=e.next();n.length&&!n.is(t);){var r=n[0];if("BR"!==r.nodeName&&"P"!==r.nodeName)return!1;n=n.next()}return!0}(i)&&n(i)}(r)}(r,n)}))}function a(e){return c()("p",e).each((function(e,t){s(t)&&f(t)&&c()(t).attr("data-tag","marked-for-deletion")})),c()("p[data-tag=marked-for-deletion]",e).remove(),e}function s(e){return 1===e.nodeType&&0===e.childNodes.length||function(e){for(var t=0,n=0,r=0,o=e.childNodes.length;r<o;r++){var i=e.childNodes[r];if("BR"===i.nodeName){if(++t>1)return!1}else if(/^[\s|\u00A0]$/.test(i.nodeValue)){if(++n>1)return!1}else if(""!==i.nodeValue)return!1}return!0}(e)}function f(e){if(!e||1!==e.nodeType)return!1;var n=m(e,!1),r=m(e,!0),o=d(n)||c()(n).is(t),i=d(r)||c()(r).is(t),a=d(n)&&d(r);return o&&i&&!a}function d(e){return!e||e.className&&/cell|header|footer/.test(e.className)}function m(e,t){var n=c()(e);do{var r=t?n[0].nextSibling:n[0].previousSibling;if(r)return r;n=n.parent()}while(n.length>0&&!n.is(".cell, .mceContentBody, td, li"));return null}function p(e){var t=e.startContainer;return 3===t.nodeType?!(t.previousSibling&&(3===t.previousSibling.nodeType||c()(t.previousSibling).is("br")))&&0===e.startOffset:1===t.nodeType&&0===e.startOffset}function g(e,t){return t.startContainer==t.endContainer&&1===t.startContainer.nodeType&&function(e,t){var n=t.startOffset;return e||n--,n>=0&&n<t.startContainer.childNodes.length&&"TABLE"===t.startContainer.childNodes[n].nodeName}(e,t)}function h(e){if(!e.collapsed)return!1;if(!function(e){for(var t=/^(TABLE|TR|TD)$/,n=e.startContainer;n&&n;){if(t.test(n.nodeName))return!0;n=n.parentNode}return!1}(e))return!1;var t,n=e.startContainer;if(3===n.nodeType)return t=m(n,!0),e.startOffset==n.nodeValue.length&&(null==t||c()(t).is("br"));if(1===n.nodeType){if(c()(n).is("td, th")&&0===e.startOffset&&n.childNodes.length>0)return c()(n.childNodes[0]).is("br");var r=0===e.startOffset?0:e.startOffset-1;return null==(t=m(n.parentNode.childNodes[r],!0))||c()(t).is("br")}return!1}function v(e){return e&&1===e.childNodes.length&&c()(e.childNodes[0]).is("br")}function b(e,t){return!!(t&&(r.tinymce.isWebKit&&g(!1,t)||r.tinymce.isGecko&&(h(t)||f(e)&&0===t.startOffset&&v(e))))}function y(e,t){return!!(t&&(r.tinymce.isWebKit&&(g(!0,t)||p(t)&&f(e)||function(e){var t=n.getBody();return!!t.childNodes.length&&e.collapsed&&0===e.startOffset&&t.childNodes[0]==e.startContainer}(t))||r.tinymce.isGecko&&p(t)&&f(e)&&v(e)))}function w(e){var t=e.keyCode;return t!==o.BACKSPACE&&t!==o.DELETE||(n.selection.isCollapsed()?(t===o.BACKSPACE&&y(n.selection.getNode(),n.selection.getRng())||t===o.DELETE&&b(n.selection.getNode(),n.selection.getRng()))&&r.tinymce.dom.Event.cancel(e):i(n.getBody())),!0}var C=function(){i(n.getBody(),!0)},x=function(e){i(e,!1)};function S(){x(n.getBody())}ze()?(u("cursor-target-refresh",S),n.on("Remove",(function(){l("cursor-target-refresh",S)}))):(n.on("SetContent",(function(){var e;i(n.getBody()),e=n.getBody(),c()("p, td.confluenceTd, th.confluenceTh",e).each((function(e,t){(function(e){return e&&e.childNodes&&1===e.childNodes.length&&3===e.childNodes[0].nodeType&&e.childNodes[0].nodeValue&&1===e.childNodes[0].nodeValue.length&&160===e.childNodes[0].nodeValue.charCodeAt(0)})(t)&&c()(t).html("<br/>")}))})),n.on("GetContent",(function(e){if(""!==e.content){var t="<div class='root-node'>"+e.content+"</div>",r=a(c()(t)),o=c.a.extend({},e,{getInner:!1}),i=n.serializer.serialize(r[0],o);e.content=i.substring("<div class='root-node'>".length,i.length-"</div>".length)}})),n.on("init",(function(){n.dom.events.bind(n.selection,"SetContent",C),n.dom.events.bind(n.getBody(),"cut",C),u("cursor-target-refresh",C)})),n.on("Remove",(function(){l("cursor-target-refresh",C)})),r.tinymce.isGecko&&n.on("KeyDown",(function(e){e.keyCode!==o.ENTER&&e.keyCode!==o.BACKSPACE&&e.keyCode!==o.DELETE||n.selection.normalize()})),n.on("KeyDown",w),n.on("KeyUp",w),r.tinymce.isGecko&&n.on("KeyPress",w),n.on("Paste",C)),c.a.extend(e,{isCursorBeforeAfterTable:g,isCursorTarget:f,_isTextContainerEmpty:s,_removeCollaborativeEditorCursorTargets:function(e){var t=c()("<div>");return t.html(e),t.find("p.auto-cursor-target").each((function(e,t){t.remove()})),t.html()},_processCursorTargets:a,_isCursorAtStartOfContainer:p,_isCursorAtEndOfContainer:function(e){var t=e.startContainer;if(3===t.nodeType)return!(t.nextSibling&&(3===t.nextSibling.nodeType||c()(t.nextSibling).is("br")))&&e.endOffset==t.nodeValue.length;if(1===t.nodeType){var n=t.childNodes[e.startOffset];return!(!c()(n).is("br")||null!=n.nextSibling)||e.endOffset==t.childNodes.length}return!1},_getSiblingWithinBlockDisregardingNesting:m,_doesContainerHaveNestedContent:function e(t){var n,r=c()(t).children();for(n=0;n<r.length;n++)if(!s(r[n])&&(c()(r[n]).contents().filter((function(){return 3===this.nodeType})).length||e(r[n])))return!0;return!1},_addCursorTargetParagraphsToContent:i,_isCursorAtEndOfBottomRightCellInTable:h,_shouldCancelDelete:b,_shouldCancelBackspace:y,_collabEditingCursorTargetRefresh:x}),r.AJS.Rte.Cursor=me().Cursor||{},c.a.extend(r.AJS.Rte.Cursor,{isTextContainerEmpty:s,fixCursorTargets:i})},getInfo:function(){return{longname:"Cursor Target plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"1.0"}}}),r.tinymce.PluginManager.add("cursorTarget",r.tinymce.plugins.CursorTargetPlugin)},function(){r.tinymce.create("tinymce.plugins.iOSEditing",{init:function(e){r.tinymce.Env.iOS&&setTimeout((function(){c()(e.getBody()).addClass("ios")}),0)},getInfo:function(){return{longname:"iOS Comments Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}}),r.tinymce.PluginManager.add("iosediting",r.tinymce.plugins.iOSEditing)},function(){r.tinymce.create("tinymce.plugins.aeTable",Ot()),r.tinymce.PluginManager.add("aeTable",r.tinymce.plugins.aeTable)},function(){var e=function(){var e=function(e){var t=this;e.on("Undo",(function(){t.cleanLinks(e)})),this.editor=e,this.weightedHandlers=[],this.handlers=[]};function t(e){for(var n=t.options,r=n.parser[n.strictMode?"strict":"loose"].exec(e),o={},i=14;i--;)o[n.key[i]]=r[i]||"";return o[n.q.name]={},o[n.key[12]].replace(n.q.parser,(function(e,t,r){return t&&(o[n.q.name][t]=r),""})),o}e.prototype={addHandler:function(e,t){this.weightedHandlers.push({handler:e,weight:t||0}),this.weightedHandlers.sort((function(e,t){return e.weight-t.weight})),this.handlers=[];for(var n=this.weightedHandlers.length,r=0;r<n;r++)this.handlers.push(this.weightedHandlers[r].handler)},cleanLinks:function(e){return c()("a.atlassian-autoconvert",e.getDoc()).removeClass("atlassian-autoconvert"),!0},callHandlers:function(e){var i=0,a=this,u=c()(e),l=c()(e).clone(),s=l.attr("href"),f=t(n(s));function d(e){if(e&&(1!==e.length||!e.attr("href")))return p(e);if(e)i=0,f=t((l=e).attr("href")),m(a.handlers[i],f,l);else{if(!(++i<a.handlers.length))return p(l);m(a.handlers[i],f,l)}}function m(e,t,n){var i,c=d;i=o.a.setTimeout((function(){c=function(){0},d()}),r.tinymce.plugins.Autoconvert.callbackTimeout),e(t,n,(function(){clearTimeout(i),c.apply(a,arguments),c=function(){0}}))}function p(e){a.editor.undoManager.beforeChange();var t=a.editor.selection,n=a.editor.selection.getBookmark();u.replaceWith(e),t.moveToBookmark(n),a.editor.undoManager.add()}0!==this.handlers.length&&m(this.handlers[0],f,l)}},e.callbackTimeout=5e3,e.convertMacroToDom=function(e,t,n){var r={macro:e,contentId:F.get("content-id")};c.a.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:"".concat(ye,"/rest/tinymce/1/macro/placeholder"),data:JSON.stringify(r),dataType:"text",success:t,error:n,timeout:45e3})},e.convertMacroToDomViaWikiText=function(t,n,r){var o=["{",t.name],i=!0;for(var a in t.defaultParameterValue&&(o.push(":",t.defaultParameterValue),i=!1),t.params)i?(o.push(":"),i=!1):o.push("|"),o.push(a,"=",t.params[a]);o.push("}"),e.getHtmlFromWikiMarkup(o.join(""),(function(e){n(c()(e)[0])}),(function(){r()}))},e.getHtmlFromWikiMarkup=function(e,t,n){var r={wiki:e,entityId:F.get("content-id"),contextType:F.get("content-type"),spaceKey:F.get("space-key")};c.a.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:"".concat(ye,"/rest/tinymce/1/wikixhtmlconverter"),data:JSON.stringify(r),dataType:"text",success:t,error:n,timeout:45e3})},t.options={strictMode:!1,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}};var n=function(e){return e.replace(/^(.*?\/\/[^/]*?\/.*?)(@)/,"$1%40")},i={init:function(t){var n=new e(t);function o(e,r,o){var i=c()(o.node).children("a");1===i.length&&"A"===i[0].tagName&&i.text()===i.attr("href")&&(i.attr("class","atlassian-autoconvert"),setTimeout((function(){var e=c()("a.atlassian-autoconvert",c()(t.selection.getNode().ownerDocument)).removeClass("atlassian-autoconvert");n.callHandlers(e)}),0))}r.tinymce.plugins.Autoconvert.autoConvert=n,t.on("init",(function(){c()(document).on("postPaste",o),t.addCommand("addAutoconverter",(function(e,t){return n.addHandler(t),!1}))})),t.on("remove",(function(){c()(document).off("postPaste",o)}))},getInfo:function(){return{longname:"Atlassian Autoconvert",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com",version:"1.0"}}};return{autoConverter:e,plugin:i}}();r.tinymce.plugins.Autoconvert=e.autoConverter,r.tinymce.create("tinymce.plugins.AutoconvertPlugin",e.plugin),r.tinymce.PluginManager.add("autoconvert",r.tinymce.plugins.AutoconvertPlugin),en()},function(){u("rte-ready",un.initializeEditor)},function(){r.tinymce.create("tinymce.plugins.draggable",sn()),r.tinymce.PluginManager.add("draggable",r.tinymce.plugins.draggable)},function(){r.tinymce.create("tinymce.plugins.InsertFiles",{init:function(e){e.ui.registry.addButton("confluence-insert-files",{text:ge("tinymce.confluence.files"),tooltip:"".concat(ge("tinymce.confluence.conf_file_desc")," (").concat(e.translate("toolbar.insert_files_shortcut_tooltip"),")"),className:"insert-files",icon:"aui-icon aui-icon-small aui-iconfont-image",locationGroup:"rte-toolbar-group-files",weight:0,onAction:function(){e.execCommand("mceConfimage")}})},getInfo:function(){return{longname:"Insert Files",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com/",version:"1.0"}}}),r.tinymce.PluginManager.add("insertfiles",r.tinymce.plugins.InsertFiles)},function(){r.tinymce.create("tinymce.plugins.flextofullsizeplugin",{init:function(e){e.on("Init",(function(){c()(e.getBody()).addClass("fullsize")}))},getInfo:function(){return{longname:"flex editor to full size plugin",description:"adjusts height of editor so it always occupies the right space in between the toolbars",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"1.0"}}}),r.tinymce.PluginManager.add("flextofullsize",r.tinymce.plugins.flextofullsizeplugin)},function(){r.tinymce.create("tinymce.plugins.Referrer",{init:function(e){e.on("Init",(function(){var e=c()("#createpageform"),t=e.find("#originalReferrer");e.length&&!t.val()&&document.referrer&&t.val(document.referrer)}))},getInfo:function(){return{longname:"Confluence Cancel Return Url",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}}),r.tinymce.PluginManager.add("referrer",r.tinymce.plugins.Referrer)},function(){var e,t;r.tinymce.create("tinymce.plugins.TableContentWrapperPlugin",(e=["img:not(.editor-inline-macro, .emoticon)"].concat(["time.non-editable",".editor-inline-macro","a.confluence-link[data-linked-resource-type='userinfo']"]).concat([".wysiwyg-macro"]).join(","),t="<div class='content-wrapper'>",{init:function(n){function r(){c()(n.dom.select("table.confluenceTable:not(.".concat("wrapped",")"))).each((function(n,r){c()(r).addClass("wrapped").find("> tbody > tr > th, > tbody > tr > td, > thead > tr > th").each((function(n,r){var o=c()(r);!o.find("> .content-wrapper").length&&o.find(e).length&&o.wrapInner(t)}))}))}u("rte-ready",r),n.on("Remove",(function(){l("rte-ready",r)})),n.on("Change",(function(){var r=n.selection;function o(){return r.getBookmark()}function i(e){r.moveToBookmark(e),Se()}var a=r.getNode(),u=c()(a);if(a&&u.closest("table.confluenceTable").not("table.confluenceTable table.confluenceTable").length){!function(e){var t=r.getRng();if(e.is("tr")&&t&&c()(t.startContainer).is("tr")&&t.collapsed){var n=e.find(">td, >th").first(),o=n.find(":first-child:not(.content-wrapper)")[0]||n[0].firstChild;t.setStart(o,0),t.setEnd(o,0),r.setRng(t)}}(u);var l,s=u.closest("table.confluenceTable > tbody > tr > th, table.confluenceTable > tbody > tr > td, table.confluenceTable > thead > tr > th");if(s.find(e).length){var f=s.find("> .content-wrapper");f.length?(l=o(),function(e){for(var t=0;t<e.length;t++)e.eq(t).find("> p, > table, > ul, > ol").length||e.eq(t).wrapInner("<p/>"),t>0&&(e.eq(0).append(e.eq(t).children()),e.eq(t).remove())}(f),i(l)):s.find("> p").length?(l=o(),s.wrapInner(t),i(l)):(l=o(),s.wrapInner("<p/>").wrapInner(t),i(l))}}c()(n.getWin().document).find(".content-wrapper:empty").remove()}))},getInfo:function(){return{longname:"Table Content Wrapper Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"1.0"}}})),r.tinymce.PluginManager.add("tableContentWrapper",r.tinymce.plugins.TableContentWrapperPlugin)},function(){var e;r.tinymce.create("tinymce.plugins.LinkBrowser",(e=r.Confluence.Editor.LinkBrowser,{init:function(t){t.ui.registry.addButton("linkbrowserbutton",{text:"confluence.conflink_desc",className:"mce_conflink",onAction:function(){t.execCommand("mceConflink")}}),t.addCommand("mceConflink",(function(){return e.open({bookmarkManager:Ae}),!1})),t.addCommand("mceConfAttachments",(function(){return e.open({panelKey:e.ATTACHMENTS_PANEL,bookmarkManager:Ae}),!1}))},getInfo:function(){return{longname:"Confluence Link Browser",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}})),r.tinymce.PluginManager.add("linkbrowser",r.tinymce.plugins.LinkBrowser)},function(){r.tinymce.create("tinymce.plugins.ConfluenceVersionComment",{init:function(e){e.on("Init",(function(){var e=F.get("version-comment");c()("#rte-savebar-tinymce-plugin-point").append(function(e,t){return'\n<span class="rte-toolbar-comment toolbar-item">\n    <input id="versionComment" name="versionComment" '.concat(t?'value="'.concat(t,'"'):"",'\n           placeholder="').concat(e("editor.change.comment"),'"\n           class="text" type="text" size="35">\n    <label for="versionComment" class="assistive">').concat(e("editor.change.comment"),"</label>\n</span>\n")}((function(e){return ge(e)}),e))}))},getInfo:function(){return{longname:"Confluence Version Comment",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}}),r.tinymce.PluginManager.add("confluenceversioncomment",r.tinymce.plugins.ConfluenceVersionComment)},function(){r.tinymce.PluginManager.add("autocomplete",No)},function(){},function(){r.tinymce.PluginManager.add("autocompletelink",Po)},function(){r.tinymce.create("tinymce.plugins.AutoCompleteMacro",Lo()),r.tinymce.PluginManager.add("autocompletemacro",r.tinymce.plugins.AutoCompleteMacro)},function(){r.tinymce.PluginManager.add("autocompletemedia",Ko)},function(){_("confluence-table-enhancements.sticky-headers.disabled")||c()(document).ready(Sn),_("confluence-table-enhancements.sticky-headers-editor")&&(u("rte-ready",Tn),u("rte-quick-edit-push-state",Tn),u("rte-quick-edit-push-hash",Tn))},function(){r.tinymce.create("tinymce.plugins.ConfluenceLeaveComment",En),r.tinymce.PluginManager.add("confluenceleavecomment",r.tinymce.plugins.ConfluenceLeaveComment)},function(){r.tinymce.create("tinymce.plugins.ConfluenceLeaveTemplate",An),r.tinymce.PluginManager.add("confluenceleavetemplate",r.tinymce.plugins.ConfluenceLeaveTemplate)},function(){r.Confluence.Editor.SearchManager=Pn(),Bn(),r.tinymce.create("tinymce.plugins.AtlassianSearchReplacePlugin",Mn()),r.tinymce.PluginManager.add("searchreplace",r.tinymce.plugins.AtlassianSearchReplacePlugin)},function(){r.tinymce.create("tinymce.plugins.ConfluenceDrafts",_n()),r.tinymce.PluginManager.add("confluencedrafts",r.tinymce.plugins.ConfluenceDrafts)},function(){var e=function(e){return!!e.querySelector(".contentLayout, .contentLayout2")},t=function(e){return Array.from(e.querySelectorAll(".contentLayout2 .columnLayout.single"))},n=function(e,t){e.undoManager.ignore((function(){t.forEach((function(t){return t.appendChild(function(e){return e.dom.create("div",{class:"pagelayout-delete-stub synchrony-exclude",style:"display:none;",contenteditable:"true"},".")}(e))}))}))},o=function(e,t){var n=Array.from(t.querySelectorAll(".pagelayout-delete-stub"));e.undoManager.ignore((function(){n.forEach((function(e){return e.parentNode&&e.parentNode.removeChild(e)}))}))};u("rte-ready",(function(){var i=r.tinymce.activeEditor,a=i.getDoc(),c=i.getBody();c.addEventListener("keydown",(function(r){if((8===r.keyCode||46===r.keyCode)&&e(a))if(i.dom.isEmpty(i.getBody()))r.stopImmediatePropagation();else{var o=t(a);o.length>0&&(n(i,o),r.stopImmediatePropagation())}}),!0),c.addEventListener("keyup",(function(t){8!==t.keyCode&&46!==t.keyCode||!e(a)||o(i,a)}),!0),i.on("beforeExecCommand",(function(r){if("delete"===r.command&&e(a)){var o=t(a);o.length>0&&n(i,o)}})),i.on("ExecCommand",(function(t){"delete"===t.command&&e(a)&&o(i,a)})),i.on("BeforeGetContent",(function(){o(i,a)}))}))},function(){},function(){r.tinymce.create("tinymce.plugins.ConfluenceMacroBrowser",Nn),r.tinymce.PluginManager.add("confluencemacrobrowser",r.tinymce.plugins.ConfluenceMacroBrowser)},function(){r.tinymce.PluginManager.add("statusmacro",si),r.Confluence.PropertyPanel.Macro.registerInitHandler((function(e,t){var n,o;Yo=e,function(e){var t=function(e){for(var t=0;t<e.length;t++)if(e[t].className.indexOf("macro-placeholder-property-panel-edit-button")>-1)return e[t];return null}(e),n=function(e){Pe.editMacro(e)};t&&(t.click=function(){r.Confluence.PropertyPanel.destroy(),oi()?Xo.always(n):n(Yo)})}(t),Qo=r.Confluence.MacroParameterSerializer.deserialize(c()(Yo).attr("data-macro-parameters")),Zo=null,t.splice(1,0,(n=(o=Qo).title||ci(o),{className:"status-macro-title first last editable",text:zt(n),click:li}))}),"status"),c.a.each(ni,(function(e,t){r.Confluence.PropertyPanel.Macro.registerButtonHandler(t,(function(){Qo.colour=t,r.Confluence.PropertyPanel.destroy()}),"status")})),u("destroyed.property-panel",(function(){oi()&&ai()}))},function(){},function(){},function(){},function(){r.AJS.MacroBrowser.Macros.code=ro},function(){},function(){r.tinymce.create("tinymce.plugins.ConfluenceWatch",Rn),r.tinymce.PluginManager.add("confluencewatch",r.tinymce.plugins.ConfluenceWatch)},function(){r.tinymce.create("tinymce.plugins.ConfluenceSortableTablesPlugin",Dn),r.tinymce.PluginManager.add("confluencesortabletablesplugin",r.tinymce.plugins.ConfluenceSortableTablesPlugin)},function(){r.tinymce.create("tinymce.plugins.AutoResizePlugin",On),r.tinymce.PluginManager.add("autoresize",r.tinymce.plugins.AutoResizePlugin)},function(){},function(){},function(){r.tinymce.create("tinymce.plugins.ConfluenceNotifyWatchers",Wn),r.tinymce.PluginManager.add("confluencenotifywatchers",r.tinymce.plugins.ConfluenceNotifyWatchers)},function(){},function(){r.Confluence.PropertyPanel.Macro.registerButtonHandler("office-connector-download-file-button",(function(e,t){for(var n=(t=t.nodeType?t:t[0]).getAttribute("data-macro-parameters").split("|"),r={},o=0;o<n.length;o++){var i=n[o].split("=");i.length>1&&(r[i[0]]=i[1])}var a=F.get("page-id"),c=F.get("content-type");function u(e,t,n){return e&&t&&("?"!=n.charAt(n.length-1)&&(n+="&"),n="".concat(n).concat(e,"=").concat(encodeURI(t))),n}r.space||(r.space=F.get("space-key"));var l=F.get("context-path")+"/plugins/servlet/oc/getattachment?";l=u("title",r.page,l),l=u("date",r.date,l),l=u("space",r.space,l),l=u("filename",r.name,l),l=u("contextid",a,l),l=u("contexttype",c,l);var s=window.open(l,"download-office-attachment");s&&s.opener&&(s.opener=null)})),Jo()},function(){u("rte-ready",(function(){!function(){Object(r.clearTimeout)(tt),tt=Object(r.setTimeout)(at,6e4);r.tinymce.activeEditor.on("ExecCommand",(function(e){var t,n="mceToggleFormat"===e.command?(t=e.value).charAt(0).toUpperCase()+t.slice(1):e.command;it(ct[n])})),r.tinymce.activeEditor.on("KeyPress",(function(){it("keys")})),r.tinymce.activeEditor.on("KeyUp",(function(e){46===e.keyCode?it("delete",ot):8===e.keyCode&&it("backspace",ot),ot=r.tinymce.activeEditor.selection.getContent().length})),r.tinymce.activeEditor.on("MouseUp",(function(){ot=r.tinymce.activeEditor.selection.getContent().length})),r.tinymce.activeEditor.on("PastePostProcess",(function(e){var t=e&&e.node?e.node.innerText||e.node.textContent:"";it("paste",t.length)})),r.tinymce.activeEditor.on("Remove",(function(){at(),Object(r.clearTimeout)(tt)}))}(),o.a.addEventListener("beforeunload",(function(){at()}))}))},function(){r.tinymce.create("tinymce.plugins.TableAnalytics",Jn),r.tinymce.PluginManager.add("tableAnalytics",r.tinymce.plugins.TableAnalytics)},function(){u("init.rte",oo)},function(){u("init.rte",(function(){T(r.document,"postPaste",Xn),k(r.document,"postPaste",Xn),r.tinymce.activeEditor&&r.tinymce.activeEditor.on("Remove",(function(){T(r.document,"postPaste",Xn)}))}))},function(){r.tinymce.create("tinymce.plugins.ConfIndentation",Yn),r.tinymce.PluginManager.add("confindentation",r.tinymce.plugins.ConfIndentation)},function(){},function(){r.tinymce.create("tinymce.plugins.TextPatternPlugin",er),r.tinymce.PluginManager.add("aetextpattern",r.tinymce.plugins.TextPatternPlugin)},function(){r.tinymce.Env.gecko&&u("rte-ready",hr)},function(){r.tinymce.create("tinymce.plugins.PersistScrollPosition",ur),r.tinymce.PluginManager.add("persit_scroll_position",r.tinymce.plugins.PersistScrollPosition)},function(){r.tinymce.create("tinymce.plugins.templateeditor",lr),r.tinymce.PluginManager.add("templateeditor",r.tinymce.plugins.templateeditor)},function(){r.tinymce.PluginManager.add("preserve-paragraph-formatting-on-delete",(function(e){return e.on("KeyDown",(function(t){!function(e,t){var n,o,i=r.tinymce.VK,a=i.BACKSPACE,c=i.DELETE,u=e.selection.getNode(),l=u.nextSibling;if(e.selection.isCollapsed()&&u!=e.dom.getRoot())if(t.keyCode===a){if(n=e.selection,(o=n.getRng())&&0===o.startOffset){var s=u.previousSibling;s&&fr(s)&&(dr(e,s),r.tinymce.dom.Event.cancel(t))}}else if(t.keyCode==c){if(sr(u).length<=1||u.childNodes.length>1)return;l&&fr(u)&&(dr(e,u),r.tinymce.dom.Event.cancel(t),function(e,t){var n=e.selection,r=n.getRng();e.focus(!1),t.focus(),r&&(r.setStart(t,0),r.setEnd(t,0),n.setRng(r))}(e,l))}}(e,t)})),{getMetadata:function(){return{name:"Preserve paragraph formatting when deleting empty line",author:"Atlassian",url:"http://www.atlassian.com"}}}}))},function(){r.tinymce.create("tinymce.plugins.macroNavigation",mr),r.tinymce.PluginManager.add("macroNavigation",r.tinymce.plugins.macroNavigation)}],Ti=function(){return ki.forEach((function(e,t){try{e()}catch(n){g("initError",{fnName:e.name||t,message:n.message||"",exceptionName:n.name||""})}})),!0},Ei=function(){return new Promise((function(e){!function(e,t){e.listener;var n=e.globalProperty,r=e.interval,o=void 0===r?250:r;if(i(n))return t(),null;var a=setInterval((function(){i(n)&&(clearInterval(a),t())}),o)}({listener:"editor-plugins/index",globalProperty:"AJS.Confluence.PropertyPanel.Macro",interval:20},(function(){e()}))}))},Ai=!1,_i=function(){if(Ai)return g("initError",{message:"Editor was loaded already, stop re-running init phase"}),Promise.reject();var e=o.a.tinymce;return e.VK=e.util.VK,e.confluence=e.confluence||{},r.tinymce.confluence=r.tinymce.confluence||{},r.tinymce.confluence.macrobrowser=De,gr(),r.tinymce.confluence=r.tinymce.confluence||{},r.tinymce.confluence.NodeUtils=Ce,r.tinymce.confluence=r.tinymce.confluence||{},r.tinymce.confluence.MacroUtils=Oe,yr(),v.a.EditorUtils=y,v.a.Rte=v.a.Rte||{},v.a.Rte.Cursor=v.a.Rte.Cursor||{},c.a.extend(v.a.Rte.Cursor,{insertParagraph:x,isCursorAtStart:C,isCursorAtEnd:w.isCursorAtEnd}),Ai=!0,Ei().then(Ti)};function Ni(e){return(e=e&&e.jquery?e[0]:e)?("BR"!==e.tagName&&3!==e.nodeType||(e=e.parentNode),e&&9===e.nodeType&&(e=null),e):null}var Ri={};Ri.Rte={HIDDEN_CHAR:"\ufeff",ZERO_WIDTH_WHITESPACE:"&#x200b;",editorId:"wysiwygTextArea",isQuickEdit:!1,getEditor:function(){return r.tinymce.activeEditor},getCurrentBaseUrl:function(){if(!this.currentBaseUrl){var e=r.document.location;this.currentBaseUrl="".concat(e.protocol,"//").concat(e.hostname).concat(e.port?":".concat(e.port):"")}return this.currentBaseUrl},showSelection:function(e){me().showElement(r.tinymce.activeEditor.selection.getStart(),e)},isAnyPartShown:function(e){var t=Ni(e);if(!t)return!1;var n=c()(t),r=n.offset().top,o=r+n.outerHeight(),i=c()(me().getEditor().getDoc()).scrollTop(),a=i+c()(me().getEditorFrame()).height();return o>i&&r<a},showElement:function(e,t){var n=Ni(e);if(n){var r=c()(n),o=me().getEditor(),i=c()(o.getDoc()),a=r.offset().top,u=a+r.outerHeight(),l=i.scrollTop(),s=l+c()(me().getEditorFrame()).height(),f=function(){me().bindScroll("AJS.Rte.showElement",(function(){me().unbindScroll("AJS.Rte.showElement"),setTimeout(t,1)}))};a<l?(me().scrollTo(a),t&&f()):u>s?(me().scrollTo(Math.min(a,l+u-s)),t&&f()):t&&t()}},scrollTo:function(e){var t=me().getEditor();e=Math.ceil(e),c()(t.getDoc()).scrollTop(e)},bindScroll:function(e,t){var n=me().getEditor();c()(r.document).add(n.getDoc()).add(n.getWin()).bind("scroll.".concat(e),t)},unbindScroll:function(e){var t=me().getEditor();c()(r.document).add(t.getDoc()).add(t.getWin()).unbind("scroll.".concat(e))},getMainEditor:function(){var e=r.tinymce.EditorManager.editors[me().editorId];if(!e)throw new Error("Main editor has not been initialised yet and is therefore not accessible via tinymce.EditorManager.editors");return e},getEditorContainer:function(){return r.document.getElementById("wysiwyg")},getEditorFrame:function(){return r.document.getElementById("".concat(me().getEditor().id,"_ifr"))},getEditorTable:function(){return r.document.getElementById("".concat(me().getEditor().id,"_tbl"))},webResourcePath:"/download/resources/com.atlassian.confluence.tinymceplugin%3Atinymceeditor/",getResourceUrlPrefix:function(){return this.resourceUrlPrefix||(this.resourceUrlPrefix=this.getCurrentBaseUrl()+F.get("editor-plugin-resource-prefix")),this.resourceUrlPrefix},getTinyMceBaseUrl:function(){return this.absoluteUrl||(this.absoluteUrl="".concat(this.getResourceUrlPrefix()+this.webResourcePath,"tinymcesource/")),this.absoluteUrl},getMinEditorHeight:function(){return+F.get("min-editor-height")},getTinyMceEditorMinHeight:function(e){e=e||0;var t=me().getMinEditorHeight(),n=0;return t||(Array.prototype.forEach.call(r.document.querySelectorAll("#editor-precursor,#header-precursor,#header"),(function(e){n+=c()(e).outerHeight(!0)})),c()(o.a).height()-n-e)},fixEditorFocus:function(){0},editorFocus:function(e){if(e&&!e.destroyed){var t,n=(t=e.dom.getRoot(),r.tinymce.isWebKit&&!c()(t).parents("body").length&&(t=c()(e.getBody()).find("p:first-child")[0]),t);n&&(e.selection.select(n,!0),e.selection.collapse(!0),n.focus()),e.getBody().focus(),e.getWin().focus()}}},Ri.KEYS={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESCAPE:27,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46,META:91};var Di=Ri;function Oi(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Ii(e,t,n[t])}))}return e}function Ii(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Pi=function(){void 0===r.AJS.Rte&&(r.AJS.Rte=Oi({},Di.Rte)),void 0===r.AJS.Rte.getEditor&&(r.AJS.Rte=Oi({},r.AJS.Rte,Di.Rte))},Bi=!1,Mi="",Li={},Fi={},ji=function(){Bi&&(s("analytics",function(){for(var e={},t={name:Mi,data:e},n=Hi.getEntriesByType("measure"),r=0;r<n.length;r++){var o=n[r],i=o.name;Li[i]&&(e["".concat(i,".startTime")]=o.startTime,e["".concat(i,".duration")]=o.duration)}return t}()),Bi=!1)};var Hi=o.a.performance,Ui=function(e){return"".concat(e,".start")};function zi(e){!function(e){if(Hi&&Hi.mark&&Li[e]){Bi||(Bi=!0);var t=Ui(e);Hi.mark(t)}}(e)}function Wi(e){!function(e){if(Hi&&Hi.mark&&Li[e]){var t=Ui(e);if(0!==Hi.getEntriesByName(t,"mark").length){var n=function(e){return"".concat(e,".end")}(e);Hi.mark(n),Hi.measure(e,t,n),Fi[e]&&ji()}else o.a.console.warn("Calling debugTimeEnd for ".concat(e," before debugTime"))}}(e)}var Vi={Formatting:".rte-toolbar-group-formatting",Style:".rte-toolbar-group-style",Indentation:".rte-toolbar-group-indentation",Lists:".rte-toolbar-group-lists",Tasks:".rte-toolbar-group-task-lists",Justification:".rte-toolbar-group-justification",Links:".rte-toolbar-group-link",Table:".rte-toolbar-group-table",Insert:".rte-toolbar-group-insert",Undo:".rte-toolbar-group-undo",PageLayouts:"#page-layout-2-group",SearchReplace:".rte-toolbar-group-searchreplace",Help:".rte-toolbar-group-help"},qi=function(e,t,n){!1===t&&function(e,t){Array.prototype.forEach.call(r.document.getElementById(e).querySelectorAll(t),(function(e){e.style.display="none"}))}(e,n)};function $i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Ki(e,t,n[t])}))}return e}function Ki(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Gi(e){return(Gi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Ji,Xi=!1,Yi={_tinyMceHasInit:!1,_beforeInitCallbacks:[],_tinymcePluginInits:[],_settings:null,isInitComplete:function(){return Yi._tinyMceHasInit},isEditorActive:function(){return!!(Yi.isInitComplete()&&r.tinymce&&r.tinymce.activeEditor)},onInit:function(){Yi._tinyMceHasInit=!0;var e=r.AJS.Rte.getEditor();if(e.getBody().classList.add("notranslate"),s("init.rte",{editor:e}),!1!==F.get("editor-auto-focus")){var t=r.document.getElementById("content-title");t&&""===t.value?t.focus():r.AJS.Rte.editorFocus(e)}else 0},addOnInitCallback:function(e){if("function"!=typeof e)throw new Error("Attempt made to register an oninit callback that is not a function. Received: ".concat(e));Yi._tinyMceHasInit?e():u("init.rte",e)},addBeforeInitCallback:function(e){Yi._beforeInitCallbacks.push(e)},addTinyMcePluginInit:function(e){Yi._tinymcePluginInits.push(e)},preInitialise:function(e){Yi._settings=e,Xi&&(Xi=!1,Yi.initialise(Ji))},initialise:function(e){if(zi("confluence.editor.tinymce"),!Yi._settings)return Xi=!0,void(Ji=e);e=$i({},e);var t,n,o,i,a=$i({},Yi._settings);r.AJS.Rte.isQuickEdit=e.isQuickEdit||!1,Yi._beforeInitCallbacks.forEach((function(e){e(a)})),s("rte-pre-resolveplugins");for(var c=0,u=Yi._tinymcePluginInits.length;c<u;c++)"function"==typeof Yi._tinymcePluginInits[c]&&Yi._tinymcePluginInits[c](a);!function(e){var t=br("confluence-editor/i18n/translations.i18n");Gi(t);var n=new RegExp("".concat(t.ctrl_key,"\\+"),"g"),o=new RegExp("".concat(t.shift_key,"\\+"),"g"),i=function(e){return e.replace(n,"").replace(o,"")};for(var a in t){var c=t[a];if("object"===Gi(c))for(var u in c)r.tinymce.Env.mac&&(c[u]=i(c[u]));r.tinymce.EditorManager.addI18n("".concat(e,".").concat(a),t[a])}r.tinymce.ScriptLoader.markDone("".concat(r.tinymce.baseURL,"/langs/").concat(e,".js")),r.tinymce.Env.mac&&Array.prototype.forEach.call(r.document.querySelectorAll("#rte-toolbar .toolbar-item, #rte-toolbar .dropdown-item, #rte-savebar .aui-button"),(function(e){var t=e.getAttribute("title"),n=e.dataset.tooltip;t&&e.setAttribute("title",i(t)),n&&(e.dataset.tooltip=i(n))}))}(a.locale),function(e,t){var n;if(!1!==t)for(n in t=t||{})t.hasOwnProperty(n)&&Vi[n]&&qi(e,t[n],Vi[n]);else r.document.getElementById(e).style.display="none"}("toolbar",e.toolbar),a.plugins=(t=a.plugins,n="string"==typeof e.plugins?e.plugins.split(","):e.plugins||[],o=e.excludePlugins||[],i=t.split(","),n.forEach((function(e){i.indexOf(e)<0&&i.push(e)})),(i=i.filter((function(e){return o.indexOf(e)<0}))).join(",")),a.setup=function(t){t.on("PreInit",(function(){t.dom.loadCSS=function(){},_("confluence.editor.tinymce.tables")&&Ut(t)})),e&&"function"==typeof e.onInitialise&&e.onInitialise(t)},a.init_instance_callback=function(e){var t=ze();Pi(),r.tinymce.FocusManager.isEditorUIElement=function(e){for(var t=e,n=!1;t;){if("rte-toolbar"===t.id){n=!0;break}t=t.parentElement}return n};try{var n=a.contentCssTags,o=e.getDoc().querySelectorAll("head");if(void 0===o[0])throw"No editor <head>";o[0].innerHTML=n+o[0].innerHTML}catch(e){}r.AJS.Rte.BootstrapManager.onInit(e),pr.editorResetContentChanged(),r.AJS.Rte.getEditorFrame().setAttribute("tabindex",100),t&&e.on("AddUndo",(function(t){var n={level:null,lastLevel:null,originalEvent:t};return e.fire("change",n)})),Wi("confluence.editor.tinymce"),s("rte-ready"),t&&s("rte-begin-collab-editing"),We()&&e.getBody().classList.add("page-edit")},r.tinymce.IconManager.add("default",{icons:{}}),r.tinymce.init(a)}},Qi=Yi,Zi=n("./src/helpers/browser.ts");function ea(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){ta(e,t,n[t])}))}return e}function ta(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var na="".concat(o.a.location.protocol,"//").concat(o.a.location.host),ra=["compat3x","atlassiantheme","auiwindowmanager","table","emotions","confluence","macroplaceholder","customtoolbar","insertwikimarkup","propertypanel","keyboardshortcuts","confmonospace","confcharmap","lists","conflist","tasklist","paste","aePaste","cursorTarget","aeTable","tablePasteFilter","pagelayoutplugin","iosediting","autoconvert","deletecommand","draggable","confluencesortabletablesplugin","textplaceholders","linkbrowser","insertfiles","tableAnalytics","aetextpattern","persit_scroll_position","confindentation","preserve-paragraph-formatting-on-delete","tableContentWrapper","statusmacro","macroNavigation"];function oa(){var e=new Zi.a;return e.isChrome()&&96==e.version()}var ia=function(){var e,t={theme:"default"};return _("confluence.editor.tinymce.tables")?(ra.push("advtable"),t=ea({},t,{table_default_attributes:{class:"confluenceTable"},table_default_styles:{},table_header_type:"cells",table_resize_bars:!0,table_use_colgroups:!0,table_column_resizing:"resizetable",advtable_value_series:{numbers:{update:!0,resizable:!1,generator:function(e){var t=e.prev?e.prev.count:0;if("tbody"===e.rowType&&"td"===e.cellType){var n=t+1;return{value:n,count:n,classes:["numberingColumn"]}}return{count:t,classes:["numberingColumn"]}}}}}),((e=new Zi.a).isChrome()&&e.version()<80||e.isFirefox()&&e.version()<80)&&!o.a.QUnit&&0===F.get("remote-user").indexOf("testuser")&&(t=ea({},t,{object_resizing:!1}))):t=ea({},t,{object_resizing:!1}),t=ea({},t,{autoresize_min_height:"100%",width:"100%",height:"100%",document_base_url:"".concat(na).concat(ye,"/"),plugins:ra.join(","),theme_advanced_buttons1:"formatselect,confimage,conf_macro_browser,code,customtoolbar,monospace,searchreplace,linkbrowserbutton",theme_advanced_toolbar_location:"top",theme_advanced_toolbar_align:"left",theme_advanced_resizing:!1,theme_advanced_resize_horizontal:!1,theme_advanced_statusbar_location:"none",theme_advanced_path:!1,theme_advanced_blockformats:"p,h1,h2,h3,h4,h5,h6,pre,blockquote",toolbar:!1,menubar:!1,skin:!1,statusbar:!1,table_toolbar:"",contextmenu:!1,mode:"specific_textareas",editor_selector:"tinymce-editor",body_class:"aui-theme-default mceContentBody wiki-content",popup_css:!1,content_css:!1,editor_css:!1,custom_undo_redo:!0,custom_undo_redo_levels:20,context_path:ye,plugin_action_base_path:"".concat(ye,"/plugins/tinymce"),editor_plugin_action_base_path:"".concat(ye,"/plugins/editor/tinymce"),page_id:F.get("page-id"),draft_type:null,form_name:F.get("form-name"),space_key:encodeURI(F.get("space-key")),confluence_popup_width:620,confluence_popup_height:550,editor_id:"wysiwygTextarea",indent:!1,table_tab_navigation:_("confluence.editor.tinymce.tables"),inline_boundaries:!1,indent_use_margin:!0,end_container_on_empty_block:!0,atlassian:!0,keep_values:!0,convert_urls:!0,relative_urls:!1,remove_script_host:!1,button_tile_map:!0,apply_source_formatting:!1,list_outdent_on_enter:!0,visual:!1,confluence_table_style:"confluenceTable",confluence_table_cell_style:"confluenceTd",confluence_table_heading_style:"confluenceTh",confluence_table_default_rows:4,confluence_table_default_cols:3,confluence_table_default_heading:!0,cleanup:!0,cleanup_on_startup:!0,fix_list_elements:!1,fix_table_elements:!0,valid_elements:"@[id|class|style|title|wysiwyg|dir<ltr?rtl|lang|xml::lang|onclick|ondblclick|onmousedown|onmouseup|onmouseover|onmousemove|onmouseout|onkeypress|onkeydown|onkeyup],a[*],strong/b,em/i,s,u,#p[align|user],-ol[type|compact],-ul[type|compact],li,br,img[imagetext|longdesc|usemap|src|border|alt=|title|hspace|vspace|width|height|align],-sub,-sup,-blockquote[cite|markup],-table[*],-tr[rowspan|width|height|align|valign|bgcolor|background|bordercolor],tbody,thead,tfoot,#td[colspan|rowspan|width|height|align|valign|bgcolor|background|bordercolor|scope|contenteditable],#th[colspan|rowspan|width|height|align|valign|scope|contenteditable],caption,#div[*],span[*],-code,#pre[*],address,-h1,-h2,-h3,-h4,-h5,-h6,hr[size|noshade],-font[face|size|color],dd,dl,dt,cite,abbr,acronym,del[datetime|cite],ins[datetime|cite],object[classid|width|height|codebase|*],param[name|value],embed[type|width|height|src|*],map[name],area[shape|coords|href|alt|target],bdo,button,col[align|char|charoff|span|valign|width],colgroup[align|char|charoff|span|valign|width],dfn,fieldset,form[action|accept|accept-charset|enctype|method],input[accept|alt|checked|disabled|maxlength|name|readonly|size|src|type|value],kbd,label[for],legend,noscript,optgroup[label|disabled],option[disabled|label|selected|value],q[cite],samp,select[disabled|multiple|name|size],small,textarea[cols|rows|disabled|name|readonly],tt,var,big",extended_valid_elements:"img[*],time[class|datetime|contenteditable|onselectstart|unselectable|oncontrolselect]",formats:{alignleft:[{selector:"p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li",styles:{textAlign:"left"}},{selector:"img.confluence-embedded-image",classes:"image-left"},{selector:"img,table",collapsed:!1,styles:{float:"left"}}],aligncenter:[{selector:"p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li",styles:{textAlign:"center"}},{selector:"img.confluence-embedded-image",classes:"image-center"},{selector:"table",collapsed:!1,styles:{marginLeft:"auto",marginRight:"auto"}}],alignright:[{selector:"p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li",styles:{textAlign:"right"}},{selector:"img.confluence-embedded-image",classes:"image-right"},{selector:"img,table",collapsed:!1,styles:{float:"right"}}],bold:[{inline:"strong",remove:"all",preserve_attributes:["class"]},{inline:"span",styles:{fontWeight:"bold"}}],italic:[{inline:"em",remove:"all",preserve_attributes:["class"]},{inline:"span",styles:{fontStyle:"italic"}}],underline:[{inline:"u",remove:"all"},{inline:"span",styles:{textDecoration:"underline"},exact:!0}],strikethrough:[{inline:"s",remove:"all"}],removeformat:[{selector:"h1,h2,h3,h4,h5,h6,pre",remove:"all",split:!0,expand:!1,block_expand:!0,deep:!0,block:"*"},{selector:"address,article,b,big,blockquote,center,cite,code,date,dd,del,dfn,dl,dt,em,embed,font,footer,header,hgroup,i,ins,kbd,link,menu,nav,object,param,q,s,samp,script,section,small,strike,strong,style,sub,sup,time,tt,u,var",remove:"all",split:!0,expand:!1,block_expand:!0,deep:!0},{selector:"span",attributes:["style","class"],remove:"empty",split:!0,expand:!1,deep:!0},{selector:"table",attributes:["cellpadding","cellspacing","border"],split:!1,expand:!1,deep:!0},{selector:":not(li)",attributes:["style","color","bgcolor","title","lang"],split:!1,expand:!1,deep:!0}]},forced_root_block:"p",force_p_newlines:!0,force_br_newlines:!1,padd_empty_with_br:!0,allow_unsafe_link_target:!0,paste_remove_styles_if_webkit:!1,automatic_uploads:!1,allow_html_data_urls:!0,images_dataimg_filter:function(){return!1},browser_spellcheck:!oa()})};var aa={createProfileForCommentEditor:function(){return{plugins:["searchreplace","confluenceimagedialog","autocompletemacro","confluencemacrobrowser","confluenceleavecomment","confluencewatch","autoresize"]}},createProfileForPageEditor:function(e){var t=["searchreplace","confluencedrafts","confluenceimagedialog","autocompletemacro","confluencemacrobrowser","flextofullsize","referrer"];return e&&e.versionComment&&t.push("confluenceversioncomment"),e&&e.notifyWatchers&&t.push("confluencenotifywatchers"),{plugins:t}},createProfileForTemplateEditor:function(){return{plugins:["searchreplace","confluenceimagedialog","autocompletemacro","confluencemacrobrowser","confluenceleavetemplate","flextofullsize","templateeditor"]}}},ca=function(){return{renderUI:function(){return{iframeContainer:r.tinymce.DOM.get("rte"),editorContainer:"wysiwyg"}}}};function ua(e){return(ua="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Pi(),gr(),void 0!==r.AJS.Rte&&void 0===r.AJS.Rte.BootstrapManager&&(r.AJS.Rte.BootstrapManager=Qi),void 0!==r.AJS.Rte&&void 0===r.AJS.Rte.Placeholder&&(r.AJS.Rte.Placeholder=de),void 0!==r.AJS.Rte&&void 0===r.AJS.Rte.BookmarkManager&&(r.AJS.Rte.BookmarkManager=Ae),Object(r.define)("confluence-editor/loader/tinymce-bootstrap",(function(){return Qi})),Object(r.define)("confluence-editor/editor/atlassian-editor",(function(){return Di})),Object(r.define)("confluence-editor/editor/atlassian-editor-content",(function(){return pr})),Object(r.define)("confluence-editor/utils/tinymce-node-utils",(function(){return xe})),Object(r.define)("confluence-editor-v4/build/editor",(function(){_i().then((function(){var e={locale:F.get("user-locale").replace("_","-")};r.AJS.toInit((function(){!function(e){r.tinymce.ThemeManager.requireLangPack("advanced"),r.tinymce.ThemeManager.add("default",ca),o.a.requestAnimFrame=o.a.requestAnimationFrame||o.a.webkitRequestAnimationFrame;var t=ia();0===Number(t.page_id)&&(t.page_id=null,t.draft_type=F.get("draft-type")),Qi.addBeforeInitCallback((function(e){e.contentCssTags=r.document.querySelector('script[title="editor-css"]').innerHTML,e.language=F.get("action-locale").replace("_","-");var t=F.get("min-editor-height");t&&(e.autoresize_min_height=t)}));var n=!(F.get("remote-user")&&F.get("confluence.prefs.editor.disable.autocomplete"));if(n&&(t.plugins+=",autocomplete,autocompletelink,autocompletemedia"),t.locale="object"===ua(e)&&void 0!==e.locale?e.locale:"",!!F.get("auto-start")){if(s("rte-loaded",{editPermission:!0}),ze()){var i=r.document.getElementById(t.editor_id);s("rte-collaborative-content-ready",{title:F.get("page-title")||F.get("original-content-title")||"",editorContent:i.value,confRev:F.get("conf-revision"),syncRev:r.document.getElementById("syncRev").value,syncRevSource:F.get("sync-revision-source")})}zi("confluence.editor"),n&&(t.plugins+=",autocompletemacro");var a="0"==="".concat(F.get("page-id")),c=function(e,t){if("template"===e)return aa.createProfileForTemplateEditor();if("comment"===e)return aa.createProfileForCommentEditor();var n={versionComment:!t,notifyWatchers:!t};return aa.createProfileForPageEditor(n)}(F.get("content-type"),a).plugins.join(",");c&&(t.plugins+=",".concat(c)),Qi.preInitialise(t),Qi.initialise(),Wi("confluence.editor")}else Qi.preInitialise(t)}(e)}))}))}))},0:function(e,t,n){e.exports=n("./src/index.ts")},"com.atlassian.confluence.editor:attachments-insert-utils-resources/require('confluence-editor/utils/attachments-insert-utils')":function(e,t){e.exports=require("confluence-editor/utils/attachments-insert-utils")},"com.atlassian.confluence.plugins.confluence-frontend:table-styles-editor/require('confluence/table-color-names')":function(e,t){e.exports=require("confluence/table-color-names")},"com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js/require('confluence-macro-browser/macro-browser')":function(e,t){e.exports=require("confluence-macro-browser/macro-browser")},"com.atlassian.confluence.restplugin:confluence-rest/require('confluence-rest/confluence-rest')":function(e,t){e.exports=require("confluence-rest/confluence-rest")},"confluence.web.components:confluence/require('confluence/root')":function(e,t){e.exports=require("confluence/root")},"confluence.web.resources:ajs/require('ajs')":function(e,t){e.exports=require("ajs")},"confluence.web.resources:jquery/require('jquery')":function(e,t){e.exports=require("jquery")},"confluence.web.resources:macro-js-overrides/require('confluence/macro-js-overrides')":function(e,t){e.exports=require("confluence/macro-js-overrides")},"confluence.web.resources:meta/require('confluence/meta')":function(e,t){e.exports=require("confluence/meta")}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:bookmark-manager-conf-frontend', location = 'bookmark/atlassian-editor-bookmark-manager.js' */
define("confluence-editor/atlassian-editor-bookmark-manager",["tinymce","ajs"],function(c,e){var b;return{storeBookmark:function(){var a=c.activeEditor,d=c.DOM.getViewPort(c.activeEditor.getWin());a.focus();a=a.selection.getRng();a=a.cloneRange&&"function"===typeof a.cloneRange?a.cloneRange():a.duplicate&&a.duplicate()||a;b={scrollX:d.x,scrollY:d.y,range:a};e.log("Storing bookmark");e.log(b)},restoreBookmark:function(){var a=c.activeEditor.selection,d=c.activeEditor.getWin();e.log("Restoring bookmark");
e.log(b);b&&(d.scrollTo(b.scrollX,b.scrollY),d.focus(),a.setRng(b.range));b=null}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/atlassian-editor-bookmark-manager","AJS.Rte.BookmarkManager");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:analytics', location = 'analytics/editor-ready-collab-mode-analytics.js' */
define("confluence-editor/analytics/editor-ready-collab-mode-analytics",["ajs","confluence/dark-features","confluence/meta"],function(a,d,b){return{trigger:function(){if(a.Rte&&a.Rte.getEditor()&&(a.$("#editpageform").length||a.$("#createpageform").length)){var c;c="confluence.editor.ready.collab.mode."+(d.isEnabled("site-wide.shared-drafts")?"on":"off");var e=b.get("synchrony-connection-order")?b.get("synchrony-connection-order"):"",f=b.get("synchrony-connection-type")?b.get("synchrony-connection-type"):
"";a.trigger("analyticsEvent",{name:c,data:{connectionOrder:e,connectionType:f}})}}}});require("confluence/module-exporter").safeRequire("confluence-editor/analytics/editor-ready-collab-mode-analytics",function(a){require("ajs").bind("rte-ready",function(){a.trigger()})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:unpublished-changes', location = 'unpublished-changes/unpublished-changes.soy' */
// This file was automatically generated from unpublished-changes.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.UnpublishedChanges.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.UnpublishedChanges == 'undefined') { Confluence.Templates.UnpublishedChanges = {}; }


Confluence.Templates.UnpublishedChanges.lozenge = function(opt_data, opt_ignored) {
  return '<a id="unpublished-changes-lozenge" href="#" class="view-diff-link" title="' + soy.$$escapeHtml(opt_data.tooltip) + '"><span class="aui-lozenge aui-lozenge-complete aui-lozenge-subtle unpublished-changes-lozenge">' + soy.$$escapeHtml(opt_data.label) + '</span></a>';
};
if (goog.DEBUG) {
  Confluence.Templates.UnpublishedChanges.lozenge.soyTemplateName = 'Confluence.Templates.UnpublishedChanges.lozenge';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:unpublished-changes', location = 'unpublished-changes/unpublished-changes.js' */
define("confluence-editor/unpublished-changes/unpublished-changes",["jquery","confluence/legacy","ajs","underscore","tinymce"],function(c,a,g,i,h){return{init:function(e){var f=c(a.Templates.UnpublishedChanges.lozenge({tooltip:g.I18n.getText("editor.unpublished.changes.lozenge.tooltip"),label:g.I18n.getText("editor.unpublished.changes.lozenge.label")})),h=function(d){d=i.isBoolean(d)?d:!0;a.Editor.UI.setButtonState(d,c("#rte-button-publish"))},j=function(d,b){var a=b||function(){};(i.isBoolean(d)?
d:1)?f.addClass("visible").fadeIn("fast",a):f.fadeOut("fast",function(){c(this).hide().removeClass("visible");a()})},b={show:function(){f.hasClass("visible")||j(!0,h)},hide:function(){j(!1);h(!1)}};g.bind("rte-ready",function(){var a=c("#content-title-div");b.hide();f.insertBefore(a);f.tooltip();c("#content-title").on("keydown change",b.show);e.onChange.add(b.show);e.onKeyDown.add(b.show);e.onLoad.add(function(){c(e.startContent).text().trim()&&0<g.Meta.get("draft-id")&&b.show()});f.on("mouseenter.tipsy",
function(){g.trigger("analytics",{name:"confluence.editor.unpublished-changes.lozenge.hover"})});e.addCommand("mceConf.UnpublishedChangesLozenge.show",b.show);e.addCommand("mceConf.UnpublishedChangesLozenge.hide",b.hide)})},getInfo:function(){return{longname:"Unpublished Changes",author:"Atlassian",authorurl:"http://www.atlassian.com",version:h.majorVersion+"."+h.minorVersion}}}});
require("confluence/module-exporter").safeRequire("confluence-editor/unpublished-changes/unpublished-changes",function(c){var a=require("tinymce");a.create("tinymce.plugins.UnpublishedChanges",c);a.PluginManager.add("unpublishedchanges",a.plugins.UnpublishedChanges)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-v3-v4-shared-resources', location = 'tinymce3/plugins/confluencelist/editor_plugin_src.js' */
define("confluence-editor/tinymce3/plugins/confluencelist/editor_plugin_src",["jquery","ajs","tinymce"],function(b,g,h){return{init:function(l){!h.isIE8&&l.onKeyDown.add(function(d,k){function j(a){a&&a.lastChild&&!d.dom.isBlock(a.lastChild)&&!b(a.lastChild).is("br")&&b(a).append("<br/>")}if(8===k.keyCode){var c=d.selection.getRng(!0),e=b(c.startContainer).closest("li",d.getBody());if(0!==e.length&&g.EditorUtils.isCursorAtStartOf(e[0],c)){var c=e.prev("li"),f,i=e[0],a;if(0<c.length)return f=c[0],
a=b(i.firstChild),h.isIE9&&0===a.length?a=b("<br/>").appendTo(e):a.is("p")&&(a=a.contents().first()),d.undoManager.beforeChange(),d.undoManager.add(),b(f.lastChild).is("p")&&!d.dom.isBlock(i.firstChild)?(j(f.lastChild),e.contents().each(function(a,c){if(d.dom.isBlock(c))return!1;b(f.lastChild).append(b(c).detach())})):b(i.firstChild).is("p")&&!d.dom.isBlock(f.lastChild)?(j(f),b.each(b.makeArray(c.contents()).reverse(),function(a,c){if(d.dom.isBlock(c))return!1;b(i.firstChild).prepend(b(c).detach())})):
j(f),c.append(e.detach().contents()),a[0]&&g.EditorUtils.setCursorAtStartOfContents(a[0]),d.undoManager.add(),h.dom.Event.cancel(k)}}})},getInfo:function(){return{longname:"Confluence List Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:h.majorVersion+"."+h.minorVersion}}}});
require("confluence/module-exporter").safeRequire("confluence-editor/tinymce3/plugins/confluencelist/editor_plugin_src",function(b){var g=require("tinymce");g.create("tinymce.plugins.ConfluenceListPlugin",b);g.PluginManager.add("confluencelist",g.plugins.ConfluenceListPlugin)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-v3-v4-shared-resources', location = 'tinymce3/plugins/confluencepastetable/editor_plugin_src.js' */
define("confluence-editor/tinymce3/plugins/confluencepastetable/editor_plugin_src",["jquery","document"],function(g,c){return{init:function(i){function m(a){var d={id:!0,"class":!0,style:!0,rowspan:!0,colspan:!0,"data-mce-style":!0,"data-mce-bogus":!0,"data-macro-name":!0,"data-macro-parameters":!0,"data-macro-body-type":!0,"data-highlight-colour":!0,"data-highlight-class":!0},f=["highlight","nohighlight","relative-table","fixed-table"],b,e=0,c=[],h=g(a);if(!a||j(a))return a;a&&a.getAttribute&&(b=
a.getAttribute("class"));if(b&&0<=b.indexOf("table-wrap"))if(a=g("table",a),a.length)g(a).unwrap(),a=a[0];else return null;if((!a.tagName?0:"TABLE"===a.tagName||"TR"===a.tagName||"TH"===a.tagName||"TD"===a.tagName||"TBODY"===a.tagName||"THEAD"===a.tagName||"TFOOT"===a.tagName||"COL"===a.tagName||"COLGROUP"===a.tagName||"CAPTION"===a.tagName)&&a.attributes){for(;e<=a.attributes.length;)(b=a.attributes[e])&&!0===b.specified&&!d[b.name]?a.removeAttribute(b.name):e++;k(a)&&c.push(k(a));d=0;for(e=f.length;d<
e;d++)f[d].exec||h.hasClass(f[d])&&c.push(f[d]);(f=h.attr("data-highlight-class"))&&c.push(f);(f=h.attr("data-highlight-colour"))&&c.push("highlight-"+f);h.attr("class",c.join(" "))}return a}function k(a){return!a.tagName?"":"TABLE"===a.tagName?"confluenceTable":"TH"===a.tagName?"confluenceTh":"TD"===a.tagName?"confluenceTd":""}function j(a){var d="";a&&a.getAttribute&&(d=a.getAttribute("class"));return!a.tagName?!1:"TABLE"!==a.tagName?!1:!d?!1:-1!==d.indexOf("wysiwyg-macro")}function l(a,d,c){for(var a=
c.node,d=m,b=a,e="";b;)if("function"===typeof d&&(b=d(b)),b)b.firstChild&&e.parentNode!==b&&!j(b)?(e=b,b=b.firstChild):b.nextSibling?(e=b,b=b.nextSibling):(e=b,b=b.parentNode);else break;c.node=a}i.on("init",function(){g(c).bind("postPaste",l)});i.on("remove",function(){g(c).unbind("postPaste",l)})},getInfo:function(){return{longname:"ConfluencePasteTablePlugin",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com",version:"1.0"}}}});
require("confluence/module-exporter").safeRequire("confluence-editor/tinymce3/plugins/confluencepastetable/editor_plugin_src",function(g){var c=require("tinymce");c.create("tinymce.plugins.ConfluencePasteTablePlugin",g);c.PluginManager.add("confluencepastetableplugin",c.plugins.ConfluencePasteTablePlugin)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-v3-v4-shared-resources', location = 'tinymce3/plugins/confcleanup/editor_plugin_src.js' */
define("confluence-editor/tinymce3/plugins/confcleanup/editor_plugin_src",["tinymce","jquery"],function(d,f){return{init:function(g){if(d.isWebKit){var h={},i=function(a,c){var b=a[c];b||(b={},a[c]=b);return b};f("#format-dropdown").find("ul.aui-dropdown li").each(function(){var a=f("a",this),c=a.css("font-size"),b=a.css("font-weight"),a=a.css("color"),a=i(h,a),b=i(a,b);b[c]||(b[c]=f(this).attr("data-format"))});g.onNodeChange.add(function(a){for(var c=a.dom.select("span.Apple-style-span",a.dom.doc.body),
b=a.dom.select("font.Apple-style-span",a.dom.doc.body),c=c.concat(b),b=0,k=c.length;b<k&&!a.dom.is(c[b],'[face="mceinline"]');b++){var e;a:{e=f(c[b]);var d=h[e.css("color")],g=void 0;if(d&&(g=d[e.css("font-weight")])){e=g[e.css("font-size")];break a}e=null}e&&(d=a.selection.getBookmark(),e&&a.dom.remove(c[b],1),a.selection.moveToBookmark(d),a.execCommand("FormatBlock",!1,e))}})}g.onNodeChange.add(function(a){for(var c=a.dom.select("img",a.dom.doc.body),b=c.length,d=0;d<b;d++)"file:///"===c[d].src.substr(0,
8)&&a.dom.remove(c[d])});if(d.isIE9){var j=function(a){a.getBody().childNodes.length||a.setContent("<p></p>")};g.onNodeChange.add(j);g.onSetContent.add(j)}},getInfo:function(){return{longname:"ConfluenceCleanupPlugin",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com",version:"1.0"}}}});
require("confluence/module-exporter").safeRequire("confluence-editor/tinymce3/plugins/confcleanup/editor_plugin_src",function(d){var f=require("tinymce");f.create("tinymce.plugins.ConfluenceCleanupPlugin",d);f.PluginManager.add("confluencecleanupplugin",f.plugins.ConfluenceCleanupPlugin)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.reliablesave:reliable-save-conf-frontend', location = 'templates/reliable-save.soy' */
// This file was automatically generated from reliable-save.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Editor.Reliable.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Editor == 'undefined') { Confluence.Templates.Editor = {}; }
if (typeof Confluence.Templates.Editor.Reliable == 'undefined') { Confluence.Templates.Editor.Reliable = {}; }


Confluence.Templates.Editor.Reliable.draftMessage = function(opt_data, opt_ignored) {
  var output = '<div id="draft-messages">';
  if (opt_data.isNewPage) {
    if (opt_data.existingDraft.title) {
      var escapedTitle__soy8 = '' + soy.$$escapeHtml(opt_data.existingDraft.title);
      output += soy.$$filterNoAutoescape(AJS.format('A new page you were adding on {0} called \x26#8216;{1}\x26#8217; was saved as a draft.',opt_data.existingDraft.date,escapedTitle__soy8));
    } else {
      output += soy.$$filterNoAutoescape(AJS.format('A new page you were adding on {0} was saved as a draft.',opt_data.existingDraft.date));
    }
    output += ' ' + soy.$$filterNoAutoescape(AJS.format('Do you want to {0}resume editing{1} or {2}discard{3} it?','<a href="#" class="use-draft"> ','</a>','<a href="#" class="discard-draft"> ','</a>'));
  } else {
    output += soy.$$filterNoAutoescape(AJS.format('A version of this page you were editing at {0} was saved as a draft.',opt_data.existingDraft.date)) + ((opt_data.mergeRequired) ? ' ' + soy.$$escapeHtml('The page has since been updated. Your changes will be merged with the latest version.') : '') + ((opt_data.conflictFound) ? ' ' + soy.$$filterNoAutoescape(AJS.format('The page has since been updated. The changes made conflict with your changes and cannot be merged. Do you want to {0}view the conflict{1} or {2}discard{3} your changes?','<a href="?pageId=' + opt_data.pageId + '&viewConflict=true&spaceKey=' + opt_data.spaceKey + '" >','</a>','<a href="#" class="discard-draft">','</a>','<a href="' + "" + '/users/viewmydrafts.action">','</a>')) : (opt_data.mergeRequired) ? ' ' + soy.$$filterNoAutoescape(AJS.format('Do you want to {0}view{1}, {2}merge and resume editing{3} or {4}discard{5} it?','<a id="view-diff-link-notification" href="#" class="view-diff-link">','</a>','<a href="#" class="use-draft"> ','</a>','<a href="#" class="discard-draft">','</a>')) : ' ' + soy.$$filterNoAutoescape(AJS.format('Do you want to {0}view the change{1}, {2}resume editing{3} or {4}discard{5} it?','<a id="view-diff-link-notification" href="#" class="view-diff-link">','</a>','<a href="#" class="use-draft"> ','</a>','<a href="#" class="discard-draft">','</a>')));
  }
  output += '</div>';
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Reliable.draftMessage.soyTemplateName = 'Confluence.Templates.Editor.Reliable.draftMessage';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.reliablesave:reliable-save-conf-frontend', location = 'js/reliable-save.js' */
define("confluence-editor-reliable-save/reliable-save","ajs confluence/legacy underscore jquery window document confluence/api/constants confluence-editor/editor/page-editor-message confluence-editor/editor/page-editor-quit-dialog".split(" "),function(a,c,n,e,u,L,p,b,D){function v(){return a.Meta.get("shared-drafts")}function w(){return a.Meta.getBoolean("new-page")}function x(){c.Editor.UI.toggleSavebarBusy(!1)}function q(c){var e="There was an error processing the request.";b.closeMessages(["generic-error"]);
b.handleMessage("generic-error",{type:"error",message:e},f);a.logError("Generic error: "+JSON.stringify(c))}function f(){var b=e("#draft-messages");0<b.length&&(b.is(":visible")&&a.Confluence.Analytics.publish("rte.notification.draft"),b.find("a.use-draft").click(function(b){b.stopPropagation();b.preventDefault();c.Editor.Drafts.useDraft();a.Confluence.Analytics.publish("rte.notification.draft.resume")}),b.find("a.discard-draft").click(function(b){b.stopPropagation();b.preventDefault();h.Draft.discardDraft(a.Meta.get("page-id"),
a.Meta.get("existing-draft-id")).done(h.Draft.onSuccessDiscardDraft).fail(h.Draft.onErrorDiscardDraft)}))}function G(){e("#editor-restore-title-link").click(function(c){c.stopPropagation();c.preventDefault();e("#content-title").val(a.Meta.get("latest-published-page-title"));b.closeMessages(["rename-during-limited-mode"])})}function r(){a.Meta.set("access-mode","READ_ONLY");b.closeMessages(["read-only-mode"]);b.handleMessage("read-only-mode",{title:"This site is read-only",
type:"error",message:"Starting now, any changes you make won\u0027t be saved. We\u0027ll let you know when you can start editing again."});c.Editor.UI.setButtonsState(!0);c.Editor.UI.toggleSavebarBusy(!1);c.Editor.UI.setButtonState(!1,c.Editor.UI.saveButton);c.Editor.UI.setButtonState(!1,c.Editor.UI.cancelButton)}function A(c){var e="Looks like your session expired. Log in again to keep working.\n \u003cdiv\u003e\u003ca href=\u0022dashboard.action\u0022 target=\u0022_blank\u0022\u003eLogin\u003c/a\u003e\u003c/div\u003e";b.closeMessages(["noauthorized"]);b.handleMessage("noauthorized",{title:"Can\u0027t connect to the server",type:"error",message:e},f);c&&a.trigger("rte.safe-save.invalid-xsrf-token")}
function E(){var c="Unable to communicate with server. Saving is not possible at the moment.";b.closeMessages(["server-offline"]);b.handleMessage("server-offline",{type:"error",message:c},f)}var F=[],t=!1,h={Draft:{discardDraft:function(b,c){b={draftId:c,pageId:b,type:a.Meta.get("draft-type"),spaceKey:a.Meta.get("space-key")};return e.ajax({type:"DELETE",url:p.CONTEXT_PATH+"/rest/tinymce/1/drafts/discard",data:e.toJSON(b),contentType:"application/json",dataType:"json"})},onSuccessDiscardDraft:function(){w()||a.Meta.set("draft-id",
"0");b.closeMessages(["draft-message"]);b.handleMessage("discarding-successfull",{type:"info",message:"Your draft has been discarded.",close:"auto"},f);a.Confluence.Analytics.publish("rte.notification.draft.discard")},onErrorDiscardDraft:function(c){switch(c.status){case 403:A(!0);break;case 404:b.handleMessage("draft-deleted",{type:"info",message:"This draft has been discarded."},f);break;case 405:r();break;case 422:b.handleMessage("discarding-invalid",{type:"error",
message:"This draft is invalid. It can be deleted by someone or looks like your session expired."},f);break;default:b.handleMessage("discarding-error",{type:"error",message:"An unknown error has occurred. Please check your logs."},f)}}}};h._internal=c.SafeSafe&&c.SafeSave._internal?c.SafeSave._internal:{};h._internal.onSuccessfulResponse=function(b){e("#rte-button-overwrite").unbind("click.overwrite");var f={dataType:"json",contentId:a.Meta.get("content-id"),draftType:a.Meta.get("draft-type")};a.safe.post(p.CONTEXT_PATH+"/json/stopheartbeatactivity.action",
f,function(){a.log("Stop heartbeat activity on",f.draftType,"id",f.contentId)},"json").fail(function(b,c,e){a.logError("Server error on stop heartbeat activity request:");a.log(e)}).always(function(){var a=b._links.webui;a?0!==a.indexOf("/")?u.location=a:u.location=p.CONTEXT_PATH+a:(c.Editor.isPublishing(!1),x())})};h.resetUnrecoverableEditorError=function(){t=!1};h.initialize=function(){function z(d){x();switch(d.status){case 400:b.closeMessages(["empty-title","duplicate-title","title-too-long",
"legacy-draft-deprecated","utf8-validation-failed"]);0<=d.responseText.indexOf(k.duplicatedTitle)?b.handleMessage("duplicate-title",{type:"error",message:a.format("A page with the title \u0027\u0027{0}\u0027\u0027 already exists in this space. Enter a different title for your page.",a.escapeHtml(e("#content-title").val()))}):0<=d.responseText.indexOf(k.titleTooLong)?b.handleMessage("title-too-long",{type:"error",message:"Title cannot be longer than 255 characters."},f):0<=d.responseText.indexOf(k.publishNewDraftDeprecated)||0<=d.responseText.indexOf(k.existingDraftNotFound)?
a.Meta.get("new-page")&&v()&&!c.Editor.hasContentChanged()?(a.trigger("rte.legacy-draft-can-be-migrated"),b.handleMessage("legacy-draft-deprecated",{type:"error",message:a.format("Collaborative editing is here! So that you can keep working on this page, we need to migrate the content to a new draft for you.\u003cbr\u003e \u003ca href={0}\u003eMigrate now\u003c/a\u003e",p.CONTEXT_PATH+"/pages/resumedraft.action?draftId\x3d"+a.Meta.get("draft-id"))},f)):(a.trigger("rte.legacy-draft-cannot-be-migrated"),b.handleMessage("legacy-draft-deprecated",{type:"error",message:"Collaborative editing is here! That means we need a little help from you to restart your editing session. All you need to do is copy the content, edit this page again, then paste it in and save."},f)):0<=d.responseText.indexOf(k.utf8ValidationFailed)?
(d=d.responseJSON.message.split(k.utf8ValidationFailed)[1],b.handleMessage("utf8-validation-failed",{title:"Unsupported character",type:"error",message:a.format("We can\u0027\u0027t save because the {0} character isn\u0027\u0027t supported by your database.\u003cbr\u003e\u003cbr\u003eRemove this character or use a Confluence symbol or emoticon instead. \u003ca href = \u0022https://confluence.atlassian.com/x/BYfsNg\u0022 target=\u0022_blank\u0022\u003eLearn more\u003c/a\u003e",d)},f)):q(d);break;case 403:A(!0);break;case 404:b.closeMessages(["page-not-accessible","noauthorized"]);b.handleMessage("page-not-accessible",{title:"This content cannot be accessed.",type:"error",message:a.format("Your session may have expired, you can attempt to \u003ca href=\u0022dashboard.action\u0022 target=\u0022_blank\u0022\u003elog in\u003c/a\u003e.",
a.Meta.get("space-key"))},f);break;case 405:r();break;case 410:b.closeMessages(["page-deleted"]);b.handleMessage("page-deleted",{title:"This content has been deleted",type:"error",message:a.format("Copy your content, then add it to a new page or \u003cdiv\u003e\u003ca href=\u0022viewtrash.action?key={0}\u0022 target=\u0022_blank\u0022\u003erestore this page from the trash\u003c/a\u003e and try again.\u003c/div\u003e",a.Meta.get("space-key"))},f);break;case 413:b.closeMessages(["page-too-big"]);b.handleMessage("page-too-big",{type:"error",message:"This page is too big to save. You could split it into multiple pages, then use the \u003ca href=\u0022https://confluence.atlassian.com/conf51/include-page-macro-336169384.html\u0022 target=\u0022_blank\u0022\u003einclude page macro\u003c/a\u003e to display the content."},f);break;case 0:case 500:case 503:E();break;case 501:0<=d.responseText.indexOf(k.renameDuringLimitedMode)?
b.handleMessage("rename-during-limited-mode",{type:"error",message:"Changing page titles isn\u0027t possible right now, as collaborative editing is offline. \u003cdiv\u003e\u003ca id=\u0022editor-restore-title-link\u0022 href=\u0022#\u0022\u003eRestore the page title\u003c/a\u003e if you\u0027d like to publish the page.\u003c/div\u003e"},G):q(d);break;default:q(d)}}function y(d){function I(c){B<J?(B++,C.push(setTimeout(function(){y()},K))):(a.trigger("analyticsEvent",{name:"editor.save.error.conflict"}),B=0,b.handleMessage("page-conflict",{title:"Can\u0027t sync with the server.",type:"error",message:a.format("Refresh the page to try to re-establish the connection.",g.space.key)},f),k(c))}function k(b){a.trigger("rte.safe-save.error",
{status:b.status})}function n(){c.Editor.isPublishing(!0);e.ajax({type:r,url:l,contentType:"application/json; charset\x3dutf-8",dataType:"json",data:JSON.stringify(g),success:function(b){"page"!==g.type&&"blogpost"!==g.type||a.trigger("analytics",{name:"confluence.editor.close",data:{source:"publishButton"}});a.trigger("rte.safe-save.success",b);h._internal.onSuccessfulResponse(b)},error:function(b){c.Editor.isPublishing(!1);x();var d=!1;switch(b.status){case 409:v()?(d=!0,I(b)):(c.Editor.restoreDefaultSave(),
c.Editor.UI.saveButton.click());break;case 0:case 500:case 503:for(;C.length;)clearTimeout(C.shift());z(b);break;default:z(b)}d||k(b);a.trigger("synchrony.start",{id:"confluence.editor.publish"})}})}a.trigger("synchrony.stop",{id:"confluence.editor.publish"});d&&d.preventDefault();var m=e("#content-title");if(m.hasClass("placeholded")||""===m.val().trim())a.trigger("rte.safe-save.error"),a.trigger("synchrony.start",{id:"confluence.editor.publish"}),b.closeMessages(["title-too-long","duplicate-title"]),
b.handleMessage("empty-title",{title:"This page needs a name",type:"error",message:"Add a page title before hitting publish."},f),x();else{c.Editor.Drafts.unBindUnloadMessage();var g={};d=a.Meta.get("draft-id");var t=a.Meta.get("content-id"),l=p.CONTEXT_PATH+"/rest/api/content",q=e("#sourceTemplateId").val();g.status="current";g.title=m.val();g.space={key:a.Meta.get("space-key")};g.body={editor:{value:function(a){F.forEach(function(b){a=b(a)});return a}(a.Rte.getEditor().getContent()),
representation:"editor"}};q&&(g.extensions={sourceTemplateId:q});m=(m=c.Editor.UI.postingDatePicker)&&m.getDate();"blogpost"===u.type&&m&&m.toISOString&&(g.history={createdDate:m.toISOString()});if(w()&&!a.Meta.get("shared-drafts")){var r="POST";a.Meta.get("is-blueprint-page")&&(l=l+"/blueprint/instance/"+d);l+="?status\x3ddraft";g.id=d;g.type=a.Meta.get("content-type");g.body.editor.content={id:d}}else r="PUT",w()&&a.Meta.get("is-blueprint-page")&&(l+="/blueprint/instance"),l=l+"/"+t,w()&&v()?(g.id=
d,g.body.editor.content={id:d}):(g.id=a.Meta.get("page-id"),g.body.editor.content={id:a.Meta.get("page-id")}),l="0"===d?l+"?status\x3dcurrent":l+"?status\x3ddraft",d=a.Meta.getNumber("page-version")||0,g.type=a.Meta.get("content-type"),g.version={number:d+1,message:e("#versionComment").val(),minorEdit:!e("#notifyWatchers").is(":checked"),syncRev:e("#syncRev").val()};d=function(){var b={};b.id=a.Meta.get("parent-page-id")||"0";b.type=a.Meta.get("content-type");var c=a.Meta.get("parent-page-id");c&&
g.space.key===a.Meta.get("space-key")||(b.id="0");c&&b.id!==c&&(b.id=e("#parentPageString").val()===a.Meta.get("from-page-title")?b.id:c);return b}();"0"!==d.id&&(g.ancestors=[d]);(d=c.Editor.Drafts.getDraftSavingPromise())?d.always(n):n()}}if(0!==e("#editpageform").length||0!==e("#createpageform").length){var k={duplicatedTitle:"A page with this title already exists",titleTooLong:"Title cannot be longer than 255 characters.",publishNewDraftDeprecated:"Unsupported call to publishNewDraft",existingDraftNotFound:"Could not find existing draft, perhaps you're trying to publish a personal draft?",
renameDuringLimitedMode:"Unable to perform a page rename when limited mode is enabled",utf8ValidationFailed:"Unsupported character found in content: "},u={existingDraftId:a.Meta.get("existing-draft-id")?a.Meta.get("existing-draft-id"):0,pageId:a.Meta.get("page-id"),type:a.Meta.get("draft-type"),spaceKey:a.Meta.get("space-key")};if(!0===a.Meta.get("show-draft-message")){if(0<e("#conflict-diffs").length)return;e.ajax({type:"GET",url:p.CONTEXT_PATH+"/rest/tinymce/1/drafts/message",data:u,contentType:"application/json",
dataType:"text json",success:function(d){d&&d.draftData&&(d=c.Templates.Editor.Reliable.draftMessage({existingDraft:d.draftData,conflictFound:d.conflictFound,mergeRequired:d.mergeRequired,isNewPage:d.newPage,pageId:a.Meta.get("page-id"),spaceKey:a.Meta.get("space-key")}),b.handleMessage("draft-message",{type:"info",message:d},f))}})}var H=0<e("#editor-notifications-container #all-messages .aui-message-error").length;v()?(D.init({saveHandler:y,cancelErrorHandler:z}),c.Editor.overrideSave(D.process)):
H?c.Editor.restoreDefaultSave():c.Editor.overrideSave(y);e("#rte-button-overwrite").bind("click.overwrite",y);var B=0,J=3,K=1E3,C=[];a.bind("rte.heartbeat-error",function(d,e){switch(e.status){case 401:case 403:b.isDisplayed(["page-not-accessible"])||A(!1);break;case 405:if(e.responseText){d=JSON.parse(e.responseText);b.isDisplayed(["read-only-mode"])||"READ_ONLY"!==d.reason||r();break}case 0:case 404:case 500:case 503:c.Editor.metadataSyncRequired()||E();break;default:a.logError("Heartbeat action error: "+
JSON.stringify(e))}});a.bind("rte.heartbeat",function(d){var e=!1;n.each(b.displayedErrors(),function(a){n.contains(["noauthorized","server-offline","page-not-accessible","read-only-mode"],a)&&(e=!0,b.closeMessages([a]))});(d="READ_ONLY"===a.Meta.get("access-mode"))&&a.Meta.set("access-mode","READ_WRITE");(e||d)&&b.handleMessage("reconnect",{type:"info",title:"Successfully reconnected",message:"We\u0027re back in business. You\u0027re free to save your page again.",close:"auto"},f);c.Editor.UI.isButtonEnabled(c.Editor.UI.saveButton)||
t||c.Editor.UI.setButtonState(!0,c.Editor.UI.saveButton);c.Editor.UI.isButtonEnabled(c.Editor.UI.cancelButton)||t||c.Editor.UI.setButtonState(!0,c.Editor.UI.cancelButton)});a.bind("synchrony.history.evicted",function(){t=!0})}};h.registerCleanupFunction=function(a){F.push(a)};return h});
require("confluence/module-exporter").safeRequire("confluence-editor-reliable-save/reliable-save",function(a){var c=require("ajs"),n=0<window.document.referrer.indexOf("createDialog\x3dtrue\x26flashId");if(c.DarkFeatures.isEnabled("editor.ajax.save")&&""!==c.Meta.get("remote-user")&&!n){var e=require("confluence/legacy");c.bind("rte.init.ui",function(){a.initialize();e.Editor=e.Editor||{};e.Editor.SafeSave=e.Editor.SafeSave||{};e.Editor.SafeSave.Draft=a.Draft;e.Editor.SafeSave._internal=a._internal||
{}})}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.reliablesave:reliable-save-conf-frontend', location = 'js/ajax-login.js' */
define("confluence-editor-reliable-save/ajax-login",["confluence/dark-features","confluence/meta","ajs","jquery","document"],function(p,k,b,f,y){return function(){function z(A,g,a){function h(a){a=a.getResponseHeader("X-AUSERNAME");return v===a}function k(a){for(var d=0,B=a.length;d<B;d++){var e=a[d];b.debug("Rerunning ajax query to: "+e.url,e);w.call(f,e.url,e.settings).done(function(){b.debug("Rerunning done");e.deferred.resolve(arguments)}).fail(function(){b.debug("Rerunning failed");e.deferred.reject(arguments)})}}
function p(a){r.push({deferred:l,url:A,settings:g,defaultCallback:a});t||(u=!1,m||(m=new b.Dialog(840,700),m.addPanel("ajax-login","ajax-login-content","ajax-login-panel",1),a=f(".ajax-login-panel"),n=f("\x3ciframe\x3e\x3c/iframe\x3e"),n.bind("load",function(a){(a=n[0].contentDocument.location.pathname)&&0<=a.indexOf("/ajaxlogincomplete.action")&&(t=!1,u=!0,m.hide(),n.attr("src","about:blank"))}),a.append(n),f(y).bind("hideLayer",function(a,d,e){if("popup"===d&&e===m.popup){b.debug("hiding login dialog");
if(u)k(r);else for(a=r,d=0,e=a.length;d<e;d++){var c=a[d];b.debug("Executing with original response for: "+c.url,c);c.defaultCallback&&c.defaultCallback()}r=[]}})),n.attr("src",C),m.show(),t=!0)}function q(a,b,f,e){function d(){c.readyState=a.readyState;c.status=a.status;c.statusText=a.statusText;a.responseXML?c.responseXML=a.responseXML:c.responseText=a.responseText;b.apply(f,e)}h(a)?d():p(d)}b.debug("Using authenticatingPromise");var c={abort:function(){a.abort.apply(a,arguments)},getAllResponseHeaders:function(){a.getAllResponseHeaders.apply(a,
arguments)},getResponseHeader:function(){a.getResponseHeader.apply(a,arguments)},overrideMimeType:function(){a.overrideMimeType.apply(a,arguments)},readyState:a.readyState,setRequestHeader:function(c,b){a.setRequestHeader.apply(a,arguments)},state:function(){a.state.apply(a,arguments)},status:a.status,statusCode:function(){a.statusCode.apply(a,arguments)},statusText:a.statusText},l=f.Deferred();l.promise(c);c.success=c.done;c.error=c.fail;a.done(function(a,c,b){q(b,l.resolve,l,arguments)});a.fail(function(a,
c,b){q(a,l.reject,l,arguments)});return c}if(p.isEnabled("ajax.login")){b.debug("AJAX login support enabled");var t=!1,m,n,u,r=[],w=f.ajax,v=k.get("remote-user"),q=k.get("base-url"),x=k.get("context-path"),C=k.get("context-path")+"/login.action?os_destination\x3d%2Fajaxlogincomplete.action";f.ajax=function(b,g){var a=w.call(f,b,g);var h=b&&b.url;h=v&&(!g||g&&!g.preventAjaxLogin)&&h&&(q&&0===h.indexOf(q)||x&&0===h.indexOf(x));return h?z(b,g,a):a}}}});
require("confluence/module-exporter").safeRequire("confluence-editor-reliable-save/ajax-login",function(p){require("ajs").toInit(p)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-resources-v4', location = 'tinymce3/plugins/confluencepaste/linkify.js' */
define("confluence-editor/tinymce3/plugins/confluencepaste/linkify",function(){return{RE_EMAIL_PATTERN:"(?:\\s|\\A|^)[\\w.-]+\\+*[\\w.-]+@(?:(?:[\\w-]+\\.)+[A-Za-z]{2,6}|(?:\\d{1,3}\\.){3}\\d{1,3})",RE_URL_SCHEME:"(?:[\\w-]{2,}):/{1,3}",RE_TLD:"(?:aero|arpa|biz|com|coop|edu|gov|info|int|mil|museum|name|net|org|travel|ac|ad|ae|af|ag|ai|al|am|an|ao|aq|ar|as|at|au|aw|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cu|cv|cx|cy|cz|de|dj|dk|dm|do|dz|ec|ee|eg|eh|er|es|et|fi|fj|fk|fm|fo|fr|ga|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|qa|re|ro|ru|rw|sa|sb|sc|sd|se|sg|si|sj|sk|sl|sm|sn|so|sr|st|sv|sy|sz|tc|td|tf|tg|th|tj|tk|tm|tn|to|tp|tr|tt|tv|tw|tz|ua|ug|uk|um|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|yu|za|zm|zw)",
RE_URL_MIDCHAR:"(?:[^\\s()]+|\\((\\S+)\\))",RE_URL_ENDCHAR:"(?:\\((\\S+)\\)|[^\\s`!()\\[\\]{};:'\".,<>?])",init:function(){this.RE_URL_ENDING||(this.RE_URL_ENDING="(?:"+this.RE_URL_MIDCHAR+"*"+this.RE_URL_ENDCHAR+")?",this.RE_FULL_URL=this.RE_URL_SCHEME+"\\w+(?:.\\w+)"+this.RE_URL_ENDING,this.RE_OTHER_URL="\\w[\\w_-]*(?:\\.\\w[\\w_-]*)*\\."+this.RE_TLD+"(?:[\\/\\?#]"+this.RE_URL_ENDING+"|\\b)")},linkify:function(f,b,i){this.init();f=this.match_and_replace(this.RE_EMAIL_PATTERN,f,!0,!1,b,i);
f=this.match_and_replace(this.RE_FULL_URL,f,!1,!1,b,i);return f=this.match_and_replace(this.RE_OTHER_URL,f,!1,!0,b,i)},match_and_replace:function(f,b,i,o,k,h){for(var c=0,a=0,d=0,c=0,l=/<\/[aA]>/,f=RegExp(f,"g"),p=h.hasOwnProperty("add_wbrs")?h.add_wbrs:null,j=h.hasOwnProperty("truncate_length")?h.truncate_length:100,m=h.hasOwnProperty("link_target")?h.link_target:"_blank",h=h.hasOwnProperty("link_titles")?h.link_titles:null,d={},n=0;d=f.exec(b);){n++;if(20<n)break;c=d.index;d=d[0].length;if(0<=b.substring(a,
c).search(/<[aA]/)){l.lastIndex=a;c=b.substring(a,b.length).search(l);if(0>c)break;c+=a;f.lastIndex=c+4;a=c+4}else{var a=b.substr(c,d),g=a.search(/&(amp|gt|lt)$/);if(0<g&&b.length>c+d&&";"==b[c+d]){d-=a.length-g;for(a=b.substr(c,d);!a.match(this.RE_URL_ENDCHAR+"$")&&0<d;)d--,a=b.substr(c,d)}g=a;o&&(g="http://"+g);var e="<a";m&&(e+=' target="'+m+'"');e+=' href="';i&&(e+="mailto:");g=g.replace(/"/g,"%22");e+=g+'"';h&&(e+=' title="'+(i?"Email "+g:g)+'"');j&&a.length>j&&(a=a.substr(0,j)+"...");p&&(a=
a.replace(/([/=])/g,"<wbr>$1"));e+=">"+a+"</a>";k&&k.push(g);b=b.slice(0,c)+e+b.slice(c+d,b.length);f.lastIndex=c+e.length;a=c+e.length}}return b}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/tinymce3/plugins/confluencepaste/linkify","linkify");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-resources-v4', location = 'tinymce3/plugins/confluencepaste/post-paste-node-filter.js' */
define("confluence-editor/tinymce3/plugins/confluencepaste/post-paste-node-filter","jquery confluence/legacy confluence-editor/tinymce3/plugins/confluencepaste/linkify ajs document tinymce".split(" "),function(e,B,q,r,y,z){function u(a,b){for(var f=e(a).find("["+b+"]"),c="",d="",g="",h=0,k=f.length;h<k;h++){d=(c=e(f[h]))&&["/",c.attr(b)].join("");g=c&&["/",c.attr("data-mce-"+b)].join("");r.contextPath()&&d.indexOf(r.contextPath())===0&&(f[h]=c.attr(b,d));r.contextPath()&&g.indexOf(r.contextPath())===
0&&(f[h]=c.attr("data-mce-"+b,g))}return f}function m(a,b,f){var a=e(a).find("["+b+"]"),c="",d,g;if(a)for(var h=0,k=a.length;h<k;h++){d=e(a[h]);g=f.standard;for(var n in f)if(f.hasOwnProperty(n)&&d.is(n)){g=f[n];break}if(b.indexOf("style")>-1){var c=d,i=g;g=[];for(var o="",o=void 0,p=c.attr("style"),l=c.attr("data-mce-style"),j=0,m=i.length;j<m;j++)if(p&&p.toLowerCase().indexOf(i[j])>-1)g.push(i[j]+": "+c.css(i[j])+";");else if(l&&l.toLowerCase().indexOf(i[j])>-1){o=RegExp(i[j]+":.+?(?:;|$)");o=l.match(o);
g.push(o[0].indexOf(";")>-1?o:o+";")}c=g.join(" ")}else{c=d;i=b;p=[];if(g){l=0;for(j=g.length;l<j;l++)c.is("["+i+"~="+g[l]+"]")&&p.push(g[l])}c=p.join(" ")}d.removeAttr(b);c.length&&d.attr(b,c)}}function A(a,b){function f(f){var d;if(c.index){d=a.splitText(c.index);a&&b.push(a);a=d}(d=a.splitText(c[0].length))&&b.push(d);e(a).wrap("<a href='"+f+a.data+"'></a>")}var c,d,g;d=s.exec(a.data);g=t.exec(a.data);if(d){c=d;f("mailto:")}else if(g){d=(c=g)&&c[0].indexOf("://")===-1?"http://":"";f(d)}}var t;
q.init();var v=RegExp(q.RE_FULL_URL),w=RegExp(q.RE_OTHER_URL);t={exec:function(a){return v.exec(a)||w.exec(a)},test:function(a){return v.test(a)||w.test(a)}};var s,x=RegExp(q.RE_EMAIL_PATTERN);s={exec:function(a){if((a=x.exec(a))&&/\s/.test(a[0][0])){a[0]=a[0].replace(/\s/,"");a.index++}return a},test:function(a){return x.test(a)}};e(y).bind("postPaste",function(a,b,f){a=f.node;b={standard:["text-decoration","text-align","margin-left"],".wysiwyg-macro":["background-image"],p:["margin-left","text-align"],
span:["color","text-decoration"],pre:["margin-left"]};b.td=b.th=["text-align"];b.li=["list-style-type","background-image"];b.col=["width"];b["table.confluenceTable.relative-table"]=["width"];m(a,"style",b);m(a,"data-mce-style",b);if(e.browser.mozilla){u(a,"src");u(a,"href")}m(a,"face",{standard:[]});m(a,"id",{standard:[]});m(a,"data-mce-href",{standard:[]});a=f.node;b=[];b.push({elements:["div"],attribute:"class",blackValue:"aui-buttons"});for(var c=0;c<b.length;c++)for(var d=b[c],g=0;g<d.elements.length;g++)for(var h=
e(a).find(d.elements[g]+"["+d.attribute+"]"),k=0;k<h.length;k++){var n=h.eq(k).attr(d.attribute),n=n.replace(d.blackValue,"");h.eq(k).attr(d.attribute,n)}var i=f.node;e.each([".contentLayout",".contentLayout2",".columnLayout",".header",".footer",".cell",".innerCell",".panelContent",".panel",".panelHeader",".Apple-converted-space","font",".jira-status",".jira-issue",".diff-html-removed",".diff-html-added",".diff-html-changed"],function(a,b){e(b,i).contents().unwrap()});e("img",i).map(function(){e(this).attr("data-attachment-copy",
"");!e(this).attr("src")&&e(this).remove()});e("dl",i).map(function(){e(this).replaceWith(e("<p></p>").text(e(this).text()))});e("a",i).map(function(){e(this).removeClass("confluence-userlink userLogoLink")});for(a=e.makeArray(f.node.childNodes);a.length;){b=a.pop();e(b).is("a")||(b.nodeType===3?A(b,a):b.nodeType===1&&(b.childNodes&&b.nodeName.toLowerCase()!=="pre")&&(a=a.concat(e.makeArray(b.childNodes))))}if(a=e.browser.mozilla){a=e(f.node);a=a.children("br").length&&!a.find(":not(br)").length&&
!e(z.activeEditor.selection.getStart()).closest("[data-macro-body-type='PLAIN_TEXT']").length}if(a){f=e(f.node);a="<p>"+f.html().replace(/<br>/gi,"</p><p>")+"</p>";f.html(a)}});return{URL:t,EMAIL:s}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/tinymce3/plugins/confluencepaste/post-paste-node-filter","Confluence.Editor.regex");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-resources-v4', location = 'com/atlassian/confluence/tinymceplugin/tinymce-adapter-deprecated.js' */
define("confluence-editor/tinymceplugin/tinymce-adapter-deprecated",["tinymce","ajs","confluence/legacy","jquery"],function(e,a,g,h){return{putCursorAtPostionInElement:function(b,a,c){var d=e.activeEditor,i=d.getDoc(),b=h(b,c||i),b=b.contents().filter(function(){return 3===this.nodeType})[0],c=d.selection.getRng(!0);c.setStart(b,a);c.setEnd(b,a);d.selection.setRng(c)},storeCurrentSelectionState:a.Rte.BookmarkManager.storeBookmark,restoreSelectionState:a.Rte.BookmarkManager.restoreBookmark,insertLink:function(b,
f){f&&a.Rte.getEditor().selection.select(f);g.Editor.LinkAdapter.setLink(b)},getCurrentBaseUrl:a.Rte.getCurrentBaseUrl,addOnInitCallback:function(b){a.debug("Adding callback to AJS.Rte.BootstrapManager. AJS.Rte.BootstrapManager = "+a.Rte.BootstrapManager);a.Rte.BootstrapManager.addOnInitCallback(b)},bindScroll:function(b,f){a.Rte.bindScroll(b,f)},unbindScroll:function(b){a.Rte.unbindScroll(b)},getTinyMceHasInit:function(){return a.Rte.BootstrapManager.isInitComplete()},getEditor:a.Rte.getEditor,addTinyMcePluginInit:function(b){a.Rte.BootstrapManager.addTinyMcePluginInit(b)},
isExternalLink:function(a){return g.Link.isExternalLink(a)},isInMacroPlaceholder:function(a){return e.confluence.MacroUtils.isInMacro(a)},initialiseTinyMce:function(){var b=a.Editor.Adapter;e.EditorManager.preInit.apply(e.EditorManager);e.EditorManager.init(b.settings)},offset:function(b){a.Rte.Content.offset(b)},getSelectedText:function(){return a.Rte.Content.getSelectedText()},setEditorValue:function(b){a.Rte.Content.setHtml(b)},getEditorHTML:function(){return""+a.Rte.getEditor.getContent()},editorHasContentChanged:function(){return a.Rte.getEditor().isDirty()},
editorResetContentChanged:function(){a.Rte.getEditor().setDirty(!1)},getChildIndex:function(a,f){for(var c=a.childNodes,d=0,e=c.length;d<e;d++)if(c[d]==f)return d;return-1},getMainEditor:function(){return a.Rte.getMainEditor()},getEditorContainer:function(){return a.Rte.getEditorContainer()},getEditorFrame:function(){return a.Rte.getEditorFrame()},getEditorTable:function(){return a.Rte.getEditorTable()},webResourcePath:a.Rte.webResourcePath,getResourceUrlPrefix:function(){return a.Rte.getResourceUrlPrefix()},
getTinyMceBaseUrl:function(){return a.Rte.getTinyMceBaseUrl()},getMinEditorHeight:function(){return a.Rte.getMinEditorHeight()},getTinyMceEditorMinHeight:function(b){return a.Rte.getTinyMceEditorMinHeight(b)}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/tinymceplugin/tinymce-adapter-deprecated","AJS.Editor.Adapter");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:editor-resources-v4-exporter', location = 'editor-plugins/tinymce-exporter.js' */
try{require("confluence-editor-v4/build/editor")}catch(a){};
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:jiraAnalytics', location = '/jira/jiraanalytics.js' */
AJS.Editor.JiraAnalytics={events:{paste:{key:"confluence.jira.plugin.paste"},search:{key:"confluence.jira.plugin.search"},trigger:{key:"confluence.jira.plugin.trigger"},customizeColumn:{key:"confluence.jira.plugin.column.customize"}},linkTypes:{jqlDirect:"direct_jql",jql:"jql_link",xml:"xml_link",rss:"rss_link",filter:"filter_link"},getDisplayType:function(b){var a="single";b.container.find("#opt-table").is(":checked")?a="table":b.container.find("#opt-total").is(":checked")&&(a="count");return a},
setupAnalyticPanelActionObject:function(b,a,d){return{name:b.analyticPanelActionName,properties:this.setupPanelActionProperties(b,a,d)}},setupPanelActionProperties:function(b,a,d){var c={};a===AJS.Editor.JiraConnector.source.instructionalText&&("confluence.jira.plugin.issuecreated"===b.analyticPanelActionName?c.issueType=b.container.find('select[name\x3d"issuetype"] :selected').text():"confluence.jira.plugin.searchadded"===b.analyticPanelActionName&&(c.display=this.getDisplayType(b)),c.label=d);return c},
triggerPasteEvent:function(b){AJS.EventQueue=AJS.EventQueue||[];AJS.EventQueue.push({name:AJS.Editor.JiraAnalytics.events.paste.key,properties:b})},triggerPannelActionEvent:function(b){AJS.EventQueue=AJS.EventQueue||[];AJS.EventQueue.push(b)},triggerSearchEvent:function(b){AJS.EventQueue=AJS.EventQueue||[];AJS.EventQueue.push({name:AJS.Editor.JiraAnalytics.events.search.key,properties:b})},triggerMarkupEvent:function(b){this.triggerSearchEvent(b)},triggerPannelTriggerEvent:function(b){AJS.EventQueue=
AJS.EventQueue||[];AJS.EventQueue.push({name:AJS.Editor.JiraAnalytics.events.trigger.key,properties:b})},triggerCustomizeColumnEvent:function(b){AJS.EventQueue=AJS.EventQueue||[];AJS.EventQueue.push({name:AJS.Editor.JiraAnalytics.events.customizeColumn.key,properties:b})}};
(function(b){b.aop.before({target:AJS.MacroBrowser,method:"loadMacroInBrowser"},function(a,d){a&&a[0]&&"confluence.extra.jira"==a[0].pluginKey&&AJS.Editor.JiraAnalytics.triggerPannelTriggerEvent({source:AJS.Editor.JiraConnector.source.macroBrowser})});b.aop.before({target:tinymce.confluence.macrobrowser,method:"macroBrowserToolbarButtonClicked"},function(a,d){a&&a[0]&&a[0].presetMacroMetadata&&"confluence.extra.jira"==a[0].presetMacroMetadata.pluginKey&&AJS.Editor.JiraAnalytics.triggerPannelTriggerEvent({source:AJS.Editor.JiraConnector.source.editorBraceKey})});
AJS.bind("init.rte",function(){b.aop.before({target:tinyMCE.activeEditor,method:"execCommand"},function(a,d){if(a&&"mceInsertContent"==a[0]&&a[2]&&(d=[Node.ELEMENT_NODE],a=b.parseHTML(a[2]),a.length)){var c=a[0];if(d.includes(c.nodeType)&&(d=c.getAttribute("data-macro-name"),["jira","jiraissues"].includes(d)&&(d=AJS.Editor.JiraAnalytics,a={source:"wiki_markup"},c.getAttribute("data-macro-parameters")))){c=c.getAttribute("data-macro-parameters").split("|");for(var f=0;f<c.length;f++){var e=b.trim(c[f]);
if(0==e.indexOf("jql")||0==e.indexOf("jqlQuery")){a.type=d.linkTypes.jqlDirect;break}else if(0==e.indexOf("url")){c=b.trim(e.substring(e.indexOf("\x3d")+1,e.length));a.type=AJS.JQLHelper.checkQueryType(c);break}else if(0==e.indexOf("http")){c=e;a.type=AJS.JQLHelper.checkQueryType(c);break}}"undefined"===typeof a.type&&(a.type=d.linkTypes.jqlDirect);d.triggerMarkupEvent(a)}}})})})(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-frontend:split_jquery-selection-plugin', location = 'jquery-selection-plugin.js' */
(window.atlassianWebpackJsonpe19a4f58490c3d96a3072d1e47cd0e73=window.atlassianWebpackJsonpe19a4f58490c3d96a3072d1e47cd0e73||[]).push([[17],{401:function(t,e,n){"use strict";n.r(e);var s=n(13),o=n(105);!function(t,e){if(e.selection){const n=function(t){return t.replace(/\u000D/g,"")};t.fn.selection=function(t){const n=this[0];if(this.focus(),!n)return!1;if(null==t)return e.selection.createRange().text;const{scrollTop:s}=n,o=e.selection.createRange();o.text=t,o.select(),n.focus(),n.scrollTop=s},t.fn.selectionRange=function(t,s){const o=this[0];this.focus();const c=e.selection.createRange();if(null==t){const t=this.val(),e=t.length,s=c.duplicate();s.moveToElementText(o),s.setEndPoint("StartToEnd",c);let i=e-n(s.text).length;s.setEndPoint("StartToStart",c);const l=e-n(s.text).length;return i!==l&&"\n"===t.charAt(i+1)&&(i+=1),{end:i,start:l,text:t.substring(l,i),textBefore:t.substring(0,l),textAfter:t.substring(i)}}c.moveToElementText(o),c.collapse(!0),c.moveStart("character",t),c.moveEnd("character",s-t),c.select()}}else t.fn.selection=function(t){const e=this[0];if(!e)return!1;if(null==t)return!!e.setSelectionRange&&e.value.substring(e.selectionStart,e.selectionEnd);const{scrollTop:n}=e;if(e.setSelectionRange){const{selectionStart:n}=e;e.value=e.value.substring(0,n)+t+e.value.substring(e.selectionEnd),e.selectionStart=n,e.selectionEnd=n+t.length}e.focus(),e.scrollTop=n},t.fn.selectionRange=function(t,e){if(null==t){const t={start:this[0].selectionStart,end:this[0].selectionEnd},e=this.val();return t.text=e.substring(t.start,t.end),t.textBefore=e.substring(0,t.start),t.textAfter=e.substring(t.end),t}this[0].selectionStart=t,this[0].selectionEnd=e};t.fn.wrapSelection=function(t,e){this.selection(t+this.selection()+(e||""))}}(n.n(o).a,s.document)}},[[401,0,1,4,6]]]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:dialogsJs', location = '/jira/datatable.js' */
(function(d){AJS.DataTable=function(a,b,c){c=null;a&&a.jquery?c=a:"string"==typeof a&&(c=d(a));c.addClass("data-table");if(b&&b.length){this.columns=b;a=d("\x3ctr\x3e\x3c/tr\x3e").appendTo(c);a.addClass("data-table-header");for(var e=0;e<b.length;e++){var f=b[e];a.append('\x3cth class\x3d"'+f.className+'"\x3e'+f.title+"\x3c/th\x3e")}}this.tbl=c;this.rowIdx=0};AJS.DataTable.prototype.addRow=function(a){for(var b=d("\x3ctr\x3e\x3c/tr\x3e").appendTo(this.tbl),c=this.columns,e=0;e<this.columns.length;e++){var f=
c[e],h=d("\x3ctd\x3e\x3c/td\x3e").appendTo(b);h.addClass(f.className);f.renderCell(h,a)}b.data("row-data",a);this._bindRowJs(b,this.rowIdx,"selected","hover");this.rowIdx+=1;b.attr("tabindex","-1")};AJS.DataTable.prototype.selectRow=function(a){a=d("tbody tr",this.tbl)[a+1];d(a).focus()};AJS.DataTable.prototype._bindRowJs=function(a,b,c,e){var f=this;a.click(function(g){c&&(d(f.tbl).find("."+c).removeClass(c),d(this).addClass(c));g=a.data("row-data");f.tbl.trigger("row-select",[g])});var h=function(g){switch(g.keyCode){case 13:var k,
l=a.data("row-data");a.keyup(k=function(m){f.tbl.trigger("row-action",[l]);a.unbind("keyup",k);m.stopPropagation();return!1});g.stopPropagation();return!1;case 38:return 0<b&&a.prev().focus(),g.stopPropagation(),!1;case 40:var n=d("tbody tr",f.tbl).length;b<n-1&&a.next().focus();g.stopPropagation();return!1}};d.browser.mozilla?a.keypress(h):a.keydown(h);a.focus(function(g){a.click()});e&&a.hover(function(){d(this).addClass(e)},function(){d(this).removeClass(e)})}})(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:dialogsJs', location = '/jira/dialogs.js' */
(function(){tinymce.create("tinymce.plugins.JiraLink",{init:function(e){e.addCommand("mceJiralink",AJS.Editor.JiraConnector.hotKey);e.on("PostRender",function(){AJS.$.ajax({url:Confluence.getContextPath()+"/rest/jiraanywhere/1.0/servers",async:!1,success:function(k){AJS.Editor.JiraConnector.servers=k}});AJS.$("#jiralink").click(function(k){AJS.Editor.JiraConnector.open(AJS.Editor.JiraConnector.source.editorDropdownLink,!0);k.stopPropagation();return!1});AJS.$("#insert-menu .macro-jiralink").show();
e.addShortcut("ctrl+shift+j","","mceJiralink")})},getInfo:function(){return{longname:"Confluence Jira Connector",author:"Atlassian",authorurl:"http://www.atlassian.com",version:tinymce.majorVersion+"."+tinymce.minorVersion}}});tinymce.PluginManager.add("jiraconnector",tinymce.plugins.JiraLink)})();AJS.Editor.Adapter.addTinyMcePluginInit(function(e){e.plugins+=",jiraconnector";var k=e.theme_advanced_buttons1,p=k.indexOf("confimage");e.theme_advanced_buttons1=k.substring(0,p)+"jiralinkButton,"+k.substring(p)});
AJS.Editor.JiraConnector=function(e){var k=require("confluence/form-state-control"),p="Insert Jira Issue/Filter",v="Insert",w="Cancel",q=AJS.format("Hint: type \u0022{0}+Shift+J\u0022 in the editor to quickly access this dialog.",-1!=navigator.platform.toLowerCase().indexOf("mac")?"Cmd":"Ctrl"),l,m,f,x=function(){var a=e("#createPageLabelsString");0<a.length?(m=a.val().split(" ").join(),AJS.Editor.JiraAnalytics.triggerPannelTriggerEvent({source:l,
label:m})):e.getJSON(AJS.Meta.get("base-url")+"/rest/ui/1.0/content/"+AJS.Meta.get("page-id")+"/labels",function(c){var b=[];e.each(c.labels,function(h,n){b.push(n.name)});m=b.join();AJS.Editor.JiraAnalytics.triggerPannelTriggerEvent({source:l,label:m})})},t=function(a){if(!f){f=new AJS.ConfluenceDialog({width:840,height:590,id:"jira-connector"});f.addHeader(p);for(var c=AJS.Editor.JiraConnector.Panels,b=0;b<c.length;b++){f.addPanel(c[b].title());var h=f.getCurrentPanel();c[b].init(h)}f.addLink("Select Macro",
function(){f.hide();AJS.MacroBrowser.open(!1)},"dialog-back-link");f.addHelpText(q);e("#jira-connector .dialog-tip").attr("title",q);f.addButton(v,function(){var g=f.getCurrentPanel().id;g=c[g];var r=c[0];AJS.Editor.JiraAnalytics&&(AJS.Editor.JiraConnector.analyticPanelActionObject=AJS.Editor.JiraAnalytics.setupAnalyticPanelActionObject(g,l,m),r.customizedColumn&&AJS.Editor.JiraAnalytics.triggerCustomizeColumnEvent({columns:r.customizedColumn}));g.insertLink()},"insert-issue-button");k.disableElement(AJS.$(".insert-issue-button"));
f.addCancel(w,function(){AJS.Editor.JiraConnector.closePopup()});f.gotoPanel(0);if(AJS.Editor.JiraConnector.servers)for(b=0;b<AJS.Editor.JiraConnector.servers.length;b++){var n=AJS.Editor.JiraConnector.servers[b];AppLinks.makeRequest({appId:n.id,type:"GET",url:"/rest/api/2/field",dataType:"json",serverIndex:b,success:function(g){g&&g.length&&(AJS.Editor.JiraConnector.servers[this.serverIndex].columns=g)},error:function(){AJS.log("Jira Issues Macro: unable to retrieve fields from AppLink: "+n.id)}})}e("#jira-connector ul.dialog-page-menu").append(Confluence.Templates.ConfluenceJiraPlugin.addCrossMacroLink({id:"open-jira-chart-dialog",
label:"Jira Charts"}));e("#jira-connector .dialog-page-menu button").click(function(){var g=AJS.Editor.JiraConnector.Panels[f.getCurrentPanel().id];g.setInsertButtonState&&g.setInsertButtonState();g.focusForm&&g.focusForm()});e("#open-jira-chart-dialog").click(function(){AJS.Editor.JiraConnector.closePopup();AJS.Editor.JiraChart&&AJS.Editor.JiraChart.open()})}AJS.Editor.JiraConnector.Panels[0].refreshSearchForm();if(a){f.gotoPanel(1);var d=AJS.Editor.JiraConnector.Panels[1];
d.setSummary(a);setTimeout(function(){d.focusForm&&d.focusForm()},0)}else f.gotoPanel(0);f.overrideLastTab();f.show()},u=function(){AJS.Editor.JiraConnector.clickConfigApplink&&AJS.$.ajax({url:Confluence.getContextPath()+"/rest/jiraanywhere/1.0/servers",async:!1,success:function(a){AJS.Editor.JiraConnector.servers=a}});if("undefined"===typeof AJS.Editor.JiraConnector.servers||0===AJS.Editor.JiraConnector.servers.length)return AJS.Editor.JiraConnector.warningPopup(AJS.Meta.get("is-admin")),!1;AJS.Editor.JiraConnector.clickConfigApplink=
!1;AJS.Editor.JiraConnector.refreshAppLink&&(AJS.Editor.JiraConnector.refreshAppLink.call(),AJS.Editor.JiraConnector.refreshAppLink=!1);return!0};return{warningPopup:function(a){var c=new AJS.ConfluenceDialog({width:600,height:400,id:"warning-applink-dialog"}),b="Connect Confluence To Jira";c.addHeader(b);b=Confluence.Templates.ConfluenceJiraPlugin.warningDialog({isAdministrator:a});c.addPanel("Panel 1",b);c.get("panel:0").setPadding(0);a?(c.addButton("Set connection",
function(h){AJS.Editor.JiraConnector.clickConfigApplink=!0;h.hide();tinymce.confluence.macrobrowser.macroBrowserCancel();window.open(Confluence.getContextPath()+"/admin/listapplicationlinks.action").opener=null},"create-dialog-create-button app_link"),c.popup.element.find(".create-dialog-create-button").removeClass("button-panel-button").addClass("aui-button aui-button-primary")):c.addButton("Contact admin",function(h){h.hide();tinymce.confluence.macrobrowser.macroBrowserCancel();
window.open(Confluence.getContextPath()+"/wiki/contactadministrators.action").opener=null});c.addLink("Cancel",function(h){h.hide();tinymce.confluence.macrobrowser.macroBrowserCancel()});c.show();c.gotoPanel(0)},closePopup:function(){f.hide();tinymce.confluence.macrobrowser.macroBrowserCancel()},open:function(a,c){if(u()){AJS.Editor.Adapter.storeCurrentSelectionState();l=a;AJS.Editor.JiraAnalytics&&l&&(l===AJS.Editor.JiraConnector.source.instructionalText?
x():(m=null,AJS.Editor.JiraAnalytics.triggerPannelTriggerEvent({source:l})));a=tinymce.confluence.macrobrowser;var b=a.getCurrentNode();a.isMacroTag(b)&&"jira"==e(b).attr("data-macro-name")?a.editMacro(b):AJS.Editor.JiraConnector.openCleanDialog(c)}},openCleanDialog:function(a){a=a&&tinyMCE.activeEditor.selection&&tinyMCE.activeEditor.selection.getContent({format:"text"});t(a);AJS.Editor.JiraConnector.Panels[0].setMacroParams(null)},edit:function(a){if(u())if("undefined"==typeof a.params)AJS.Editor.JiraConnector.openCleanDialog(!1);
else{m=l="";var c={};if(a.params.url)c.searchStr=a.params.url;else{c.maximumIssues=a.params.maximumIssues;var b;if(!(b=a.defaultParameterValue))b:if(b=a.params,b.hasOwnProperty("jqlQuery"))b=b.jqlQuery;else{var h=/^([0-9]\d*)$/,n="count columns columnIds title renderMode cache width height server serverId anonymous baseurl showSummary".split(" ");for(d in b)if(-1==e.inArray(d,n)&&b.hasOwnProperty(d)){b=h.test(d)?b[d]:d+(" \x3d "+b[d]);break b}b=""}var d=b;c.searchStr="undefined"==typeof d?"":d;if("undefined"!=
typeof a.params.server)c.serverName=a.params.server;else for(d=0;d<AJS.Editor.JiraConnector.servers.length;d++)if(AJS.Editor.JiraConnector.servers[d].selected){c.serverName=AJS.Editor.JiraConnector.servers[d].name;break}c.columnIds=a.params.columnIds}d=a.params.count;"undefined"===typeof d&&(d="false");c.count=d;d=a.params.columns;"undefined"!=typeof d&&d.length&&(c.columns=d);a&&!AJS.Editor.inRichTextMode()&&e("#markupTextarea").selectionRange(a.startIndex,a.startIndex+a.markup.length);t();c.searchStr&&
(f.gotoPanel(0),d=AJS.Editor.JiraConnector.Panels[0],d.setMacroParams(c),a={searchValue:c.searchStr,serverName:c.serverName,isJqlQuery:a.params.hasOwnProperty("jqlQuery"),isAutoSearch:!0},d.doSearch(a))}},source:{macroBrowser:"macro_browser",editorBraceKey:"editor_brace_key",editorHotKey:"editor_hot_key",editorDropdownLink:"editor_dropdown_link",instructionalText:"instructional text"}}}(AJS.$);AJS.MacroBrowser.setMacroJsOverride("jira",{opener:AJS.Editor.JiraConnector.edit});
AJS.MacroBrowser.setMacroJsOverride("jiraissues",{opener:AJS.Editor.JiraConnector.edit});AJS.Editor.JiraConnector.Panels=[];AJS.Editor.JiraConnector.clickConfigApplink=!1;AJS.Editor.JiraConnector.hotKey=function(){AJS.Editor.JiraConnector.open(AJS.Editor.JiraConnector.source.editorHotKey,!0)};
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:dialogsJs', location = '/jira/panelhelper.js' */
(function(AJS){var FormStateControl=require("confluence/form-state-control");AJS.Editor.JiraConnector.Panel=function(){};AJS.Editor.JiraConnector.Panel.prototype={SHOW_MESSAGE_ON_TOP:false,insertIssueLink:function(key){this.insertIssueLinkWithParams({"key":key})},insertJqlLink:function(jql){this.insertIssueLinkWithParams({"jqlQuery":jql})},insertIssueLinkWithParams:function(params){var insertMacroAtSelectionFromMarkup=function(macro){tinymce.confluence.macrobrowser.macroBrowserComplete(macro)};params["server"]=
this.selectedServer.name;params["serverId"]=this.selectedServer.id;if(AJS.Editor.inRichTextMode())insertMacroAtSelectionFromMarkup({name:"jira","params":params});else{var markup="{jira:";for(var key in params)markup=markup+key+"\x3d"+params[key]+"|";if(markup.charAt(markup.length-1)=="|")markup=markup.substr(0,markup.length-1);var textArea=AJS.$("#markupTextarea");var selection=textArea.selectionRange();textArea.selectionRange(selection.start,selection.end);textArea.selection(markup);selection=textArea.selectionRange();
textArea.selectionRange(selection.end,selection.end)}if(AJS.Editor.JiraAnalytics&&AJS.Editor.JiraConnector.analyticPanelActionObject){AJS.Editor.JiraAnalytics.triggerPannelActionEvent(AJS.Editor.JiraConnector.analyticPanelActionObject);AJS.Editor.JiraConnector.analyticPanelActionObject=null}AJS.Editor.JiraConnector.closePopup()},disableInsert:function(){FormStateControl.disableElement(AJS.$(".insert-issue-button"))},isInsertDisabled:function(){return AJS.$(".insert-issue-button").is(":disabled")},
getOAuthRealm:function(xhr){var authHeader=xhr.getResponseHeader("WWW-Authenticate")||"";var realmRegEx=/OAuth realm="([^"]+)"/;var matches=realmRegEx.exec(authHeader);if(matches)return matches[1];else return null},enableInsert:function(){FormStateControl.enableElement(AJS.$(".insert-issue-button"))},handleInsertWaiting:function(isWaiting){var $insertButton=AJS.$(".insert-issue-button");return isWaiting?$insertButton.before(aui.icons.icon({icon:"wait"})):$insertButton.prev(".aui-icon.aui-icon-wait").remove()},
msg:function(container,messageObject,messageType){if(aui&&aui.message)try{var auiMessageContainer=AJS.$('\x3cdiv class\x3d"aui-message-container"/\x3e');var message=messageObject;if(messageObject.html)message=messageObject.html();var templateParameters={"content":message};var formattedMessage;switch(messageType){case "error":formattedMessage=aui.message.error(templateParameters);break;case "success":formattedMessage=aui.message.success(templateParameters);break;case "warning":formattedMessage=aui.message.warning(templateParameters);
break;default:formattedMessage=aui.message.info(templateParameters)}auiMessageContainer.append(formattedMessage);messageObject=auiMessageContainer}catch(e){if(AJS&&AJS.logError)AJS.logError("jira-connector",e)}container.append(messageObject)},errorMsg:function(container,messageObject){this.removeError(container);var errorBlock=this.SHOW_MESSAGE_ON_TOP?AJS.$('\x3cdiv class\x3d"jira-error"\x3e\x3c/div\x3e').prependTo(container):AJS.$('\x3cdiv class\x3d"jira-error"\x3e\x3c/div\x3e').appendTo(container);
this.msg(errorBlock,messageObject,"error")},warningMsg:function(container,messageObject){this.removeError(container);var warningBlock=this.SHOW_MESSAGE_ON_TOP?AJS.$('\x3cdiv class\x3d"jira-error"\x3e\x3c/div\x3e').prependTo(container):AJS.$('\x3cdiv class\x3d"jira-error"\x3e\x3c/div\x3e').appendTo(container);this.msg(warningBlock,messageObject,"warning")},noServerMsg:function(container,messageObject){var dataContainer=AJS.$('\x3cdiv class\x3d"data-table jiraSearchResults" \x3e\x3c/div\x3e').appendTo(container);
var messagePanel=this.SHOW_MESSAGE_ON_TOP?AJS.$('\x3cdiv class\x3d"message-panel"/\x3e').prependTo(dataContainer):AJS.$('\x3cdiv class\x3d"message-panel"/\x3e').appendTo(dataContainer);this.msg(messagePanel,messageObject,"info")},ajaxError:function(xhr,onOauthFail){if(xhr.status==401){var authUrl=this.getOAuthRealm(xhr);this.selectedServer.authUrl=authUrl;onOauthFail.call(this)}else this.errorMsg(this.container,"Received the following HTTP error code from the server"+": "+xhr.status)},removeError:function(container){AJS.$("div.jira-error",
container).remove()},setActionOnEnter:function(input,f,source){input.unbind("keydown").keydown(function(e){if(e.which==13){var keyup=function(e){input.unbind("keyup",keyup);f(source);e.stopPropagation();return false};input.keyup(keyup);e.stopPropagation();return false}})},createOauthForm:function(success){var server=this.selectedServer;var oauthCallbacks={onSuccess:function(){server.authUrl=null;success(server)},onFailure:function(){}};var oauthMessage='\x3ca class\x3d"oauth-init" href\x3d"javascript:void(0)"\x3e'+
"Login & Approve"+"\x3c/a\x3e "+"to retrieve data from"+" "+AJS.escapeHtml(this.selectedServer.name);var oauthForm=AJS.$('\x3cdiv class\x3d"jira-oauth-message-marker"/\x3e');if(!(aui&&aui.message))oauthForm.addClass("oauth-message");this.msg(oauthForm,oauthMessage,"info");AJS.$(".oauth-init",oauthForm).click(function(e){AppLinks.authenticateRemoteCredentials(server.authUrl,oauthCallbacks.onSuccess,oauthCallbacks.onFailure);e.preventDefault()});
return oauthForm},applinkServerSelect:function(container,onchange){var servers=AJS.Editor.JiraConnector.servers;AJS.$(servers).each(function(){var option="\x3coption ";if(this.selected){selectedServer=this;option+='selected\x3d"selected"'}option+='value\x3d"'+this.id+'"\x3e\x3c/option\x3e';option=AJS.$(option);option.text(this.name);AJS.$(container).append(option);option.data("jiraapplink",this)});AJS.$(container).change(function(e){var option=AJS.$("option:selected",container);var server=option.data("jiraapplink");
onchange(server)})},showSpinner:function(element,radius,centerWidth,centerHeight){AJS.$.data(element,"spinner",Raphael.spinner(element,radius,"#666"));if(centerWidth)AJS.$(element).css("marginLeft",-radius*1.2);if(centerHeight)AJS.$(element).css("marginTop",-radius*1.2)},hideSpinner:function(element){AJS.$(element).css("marginTop","");AJS.$(element).css("marginLeft","");var spinner=AJS.$.data(element,"spinner");if(spinner){spinner();delete spinner;AJS.$.data(element,"spinner",null)}},setSelectedIssue:function(issue){this.selectedIssue=
issue;this.enableInsert()},insertSelected:function(){if(this.selectedIssue)this.insertIssueLink(this.selectedIssue.key)},createIssueTableFromUrl:function(container,appId,url,selectHandler,enterHandler,noRowsHandler,onSuccess,onError,isShowCheckBox){AJS.$("div.data-table",container).remove();var dataContainer=AJS.$('\x3cdiv class\x3d"data-table jiraSearchResults" \x3e\x3c/div\x3e').appendTo(container);var spinnyContainer=AJS.$('\x3cdiv class\x3d"loading-data"\x3e\x3c/div\x3e').appendTo(dataContainer);
this.removeError(container);this.showSpinner(spinnyContainer[0],50,true,true);var thiz=this;this.currentXhr=AppLinks.makeRequest({appId:appId,type:"GET",url:url,dataType:"xml",success:function(data){spinnyContainer.remove();var issues=AJS.$("item",data);FormStateControl.enableElement(AJS.$(":disabled",container));if(issues.length){var table=AJS.$('\x3ctable class\x3d"my-result aui"\x3e\x3c/table\x3e');AJS.$(".jiraSearchResults",container).append(table);var columns=[];if(isShowCheckBox){var checkBoxColumn=
{className:"issue-checkbox-column",title:'\x3cinput type\x3d"checkbox" name\x3d"jira-issue-all" checked/\x3e',renderCell:function(td,issue){var issueCheckbox=Confluence.Templates.ConfluenceJiraPlugin.issueCheckbox({"issueKey":issue.key});AJS.$(issueCheckbox).appendTo(td)}};columns.push(checkBoxColumn)}var defaultColumns=[{className:"issue-key-column",title:"Key",renderCell:function(td,issue){var issueKey=Confluence.Templates.ConfluenceJiraPlugin.issueKey({"issueIconUrl":issue.iconUrl,
"issueKey":issue.key});AJS.$(issueKey).appendTo(td)}},{className:"issue-summary-column",title:"Summary",renderCell:function(td,issue){td.text(issue.summary)}}];columns=columns.concat(defaultColumns);var dataTable=new AJS.DataTable(table,columns);AJS.$(issues).each(function(){var issue={iconUrl:AJS.$("type",this).attr("iconUrl"),key:AJS.$("key",this).text(),summary:AJS.$("summary",this).text(),url:AJS.$("link",this).text()};dataTable.addRow(issue)});table.bind("row-action",
function(e,data){enterHandler.call(thiz,data)});table.bind("row-select",function(e,data){selectHandler.call(thiz,data)});dataTable.selectRow(0);if(onSuccess){var totalIssues=AJS.$("issue",data).attr("total");onSuccess.call(thiz,totalIssues)}}else{if(noRowsHandler)noRowsHandler();var message="No search results found.";var messagePanel=AJS.$('\x3cdiv class\x3d"message-panel"/\x3e');thiz.msg(messagePanel,message,"info");AJS.$(".jiraSearchResults",container).append(messagePanel)}},
error:function(xhr){FormStateControl.enableElement(AJS.$(":disabled",container));spinnyContainer.remove();onError.call(thiz,xhr)}})},retrieveJson:function(appId,url,onSuccess,onError){AppLinks.makeRequest({appId:appId,type:"GET",url:url,dataType:"json",success:onSuccess,error:onError})}}})(AJS);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:dialogsJs', location = '/jira/searchpanel.js' */
AJS.Editor.JiraConnector.Panel.Search=function(){this.jql_operators=/=|!=|~|>|<|!~| is | in /i};AJS.Editor.JiraConnector.Select2=AJS.Editor.JiraConnector.Select2||{};AJS.Editor.JiraConnector.Panel.Search.prototype=AJS.$.extend(AJS.Editor.JiraConnector.Panel.Search.prototype,AJS.Editor.JiraConnector.Panel.prototype);
AJS.Editor.JiraConnector.Panel.Search.prototype=AJS.$.extend(AJS.Editor.JiraConnector.Panel.Search.prototype,{defaultColumns:"key,summary,type,created,updated,due,assignee,reporter,priority,status,resolution",defaultColumnIds:"issuekey,summary,issuetype,created,updated,duedate,assignee,reporter,priority,status,resolution",aliases:[{id:"issuekey",clauseName:"key"},{id:"issuetype",clauseName:"type"},{id:"duedate",clauseName:"due"}],DEFAULT_MAX_ISSUES_VAL:20,MAXIMUM_MAX_ISSUES_VAL:1E3,MINIMUM_MAX_ISSUES_VAL:1,
title:function(){return "Search"},init:function(a){var c=require("confluence/form-state-control");a.html('\x3cdiv id\x3d"my-jira-search"\x3e\x3c/div\x3e');var b=this,d=AJS.$("#my-jira-search");this.container=d;var f=function(){d.children(":not(div.jira-search-form)").remove()},p=function(){c.enableElement(AJS.$("input.text,button",d))},n=function(){c.disableElement(AJS.$("input.text,button",d))},l=function(e){f();b.disableInsert();e&&(b.selectedServer=e);b.selectedServer.authUrl?
(n(),e=b.createOauthForm(function(){f();p()}),d.append(e)):(p(),AJS.$(".search-help").show())};this.authCheck=l;this.doSearch=function(e){var m=e&&e.searchValue,g=e&&e.serverName;m&&AJS.$("input:text",d).val(m);if(g&&g!=this.selectedServer.name){for(var q=AJS.Editor.JiraConnector.servers,t=!1,r=0;r<q.length;r++)if(q[r].name==g){AJS.$('option[value\x3d"'+q[r].id+'"]',d).attr("selected","selected");AJS.$("select",d).change();t=!0;break}if(!t){k(AJS.Meta.get("is-admin"));return}}this.currentXhr&&4!=
this.currentXhr.readyState||(g=m||AJS.$("input",d).val(),AJS.Editor.JiraAnalytics&&(m=AJS.JQLHelper.checkQueryType(g))&&AJS.Editor.JiraAnalytics.triggerSearchEvent({type:m,source:"dialog"}),m=function(w,v,x){v=d.find("#jiraIssueColumnSelector");var y=v.val()&&v.val();c.disableElement(AJS.$("select",d));n();b.lastSearch=w;b.createIssueTableFromUrl(d,b.selectedServer.id,"/sr/jira.issueviews:searchrequest-xml/temp/SearchRequest.xml?jqlQuery\x3d"+encodeURIComponent(w)+"\x26returnMax\x3dtrue\x26tempMax\x3d20\x26field\x3dsummary\x26field\x3dtype\x26field\x3dlink",
b.selectHandler,b.insertLinkFromForm,function(){b.addDisplayOptionPanel();b.loadMacroParams(y);b.bindEventToDisplayOptionPanel(!0,e);b.enableInsert()},function(u){b.addDisplayOptionPanel();b.loadMacroParams(y);b.bindEventToDisplayOptionPanel(!1,e);b.updateTotalIssuesDisplay(u);b.checkAutoSelectColumns();e&&e.isAutoSearch&&b.focusForm()},function(u){b.disableInsert();400==u.status?x?x():(AJS.$("div.data-table",d).remove(),b.warningMsg(d,AJS.format("The Jira server didn\u0027\u0027t understand your search query. If you entered JQL, please ensure that it\u0027\u0027s correctly formed. If you entered an issue key, ensure that it exists and you have permission to view it. {0}",Confluence.Templates.ConfluenceJiraPlugin.learnMore()))):
(AJS.$("div.data-table",d).remove(),b.ajaxError(u,l));e&&e.isAutoSearch&&b.focusForm()},!0)},AJS.JQLHelper.isFilterUrl(g)?(g=decodeURIComponent(g),q=AJS.JQLHelper.findServerIndexFromUrl(g,AJS.Editor.JiraConnector.servers),-1!=q?(AJS.$('option[value\x3d"'+AJS.Editor.JiraConnector.servers[q].id+'"]',d).attr("selected","selected"),AJS.$("select",d).change(),(g=AJS.JQLHelper.getFilterFromFilterUrl(g))?(AJS.$("input",d).val(g),m(g)):(f(),b.warningMsg(d,AJS.format("The Jira server didn\u0027\u0027t understand your search query. If you entered JQL, please ensure that it\u0027\u0027s correctly formed. If you entered an issue key, ensure that it exists and you have permission to view it. {0}",
Confluence.Templates.ConfluenceJiraPlugin.learnMore())))):(f(),b.disableInsert(),k(AJS.Meta.get("is-admin")))):AJS.JQLHelper.isIssueUrlOrXmlUrl(g)?(g=decodeURIComponent(g),g=AJS.JQLHelper.getJqlAndServerIndexFromUrl(g,AJS.Editor.JiraConnector.servers),h(g)&&(AJS.$("input",d).val(g.jqlQuery),m(g.jqlQuery,!1,null))):g.match(b.jql_operators)?m(g,!1,null):AJS.JQLHelper.isSingleKeyJQLExp(g)?m("key \x3d "+g,!0):AJS.JQLHelper.isMultipleSingleKeyJQLExp(g)?m("key in ("+g+")",!0):m('summary ~ "'+g+'" OR description ~ "'+
g+'"',!1,null))};b.addSearchForm();var h=function(e){if(-1!=e.serverIndex)if(AJS.$('option[value\x3d"'+AJS.Editor.JiraConnector.servers[e.serverIndex].id+'"]',d).attr("selected","selected"),AJS.$("select",d).change(),0==e.jqlQuery.length)f(),b.errorMsg(d,"The Jira server didn\u0027t understand your search query. If you entered JQL, please ensure that it\u0027s correctly formed. If you entered an issue key, ensure that it exists and you have permission to view it. {0}");else var m=e.jqlQuery;else f(),b.disableInsert(),k(AJS.Meta.get("is-admin"));return m};b.processJiraParams=h;var k=function(e){e=Confluence.Templates.ConfluenceJiraPlugin.showMessageNoServer({isAdministrator:e,
contextPath:Confluence.getContextPath()});b.noServerMsg(d,e);AJS.$("#open_applinks").bind("click",function(){AJS.Editor.JiraConnector.clickConfigApplink=!0;AJS.Editor.JiraConnector.refreshAppLink=function(){b.refreshSearchForm()}})};b.bindPasteEvent();AJS.$(a).select(function(){b.validate()});$(document).tooltip({live:".jql-display-opts-open.disabled",title:function(){return AJS.$(".jql-display-opts-open.disabled").data("title")},gravity:"s",delayIn:300,delayOut:0})},focusForm:function(){AJS.$('input[name\x3d"jiraSearch"]',
this.container).focus()},addSearchForm:function(){var a=this;a.container.empty();var c=AJS.Editor.JiraConnector.servers;a.selectedServer=c[0];var b=!1;1<c.length&&(b=!0);b=Confluence.Templates.ConfluenceJiraPlugin.searchForm({isMultiServer:b});b=AJS.$(b).appendTo(a.container);1<c.length&&(c=AJS.$('\x3cselect class\x3d"select" tabindex\x3d"0"\x3e\x3c/select\x3e').insertAfter("div.search-input",b),a.applinkServerSelect(c,a.authCheck));a.authCheck(a.selectedServer);AJS.$("button",a.container).click(function(){a.doSearch()});
a.setActionOnEnter(AJS.$("input.text",a.container),a.doSearch)},bindPasteEvent:function(){var a=this;AJS.$("#my-jira-search input:text").bind("paste",function(){var c=this;setTimeout(function(){var b=AJS.$(c).val();AJS.JQLHelper.isFilterUrl(b)?a.doSearch():AJS.JQLHelper.isIssueUrlOrXmlUrl(b)&&(b=decodeURIComponent(b),b=AJS.JQLHelper.getJqlAndServerIndexFromUrl(b,AJS.Editor.JiraConnector.servers),a.processJiraParams(b)&&(AJS.$(c).val(b.jqlQuery),a.doSearch()))},100)})},refreshSearchForm:function(){this.container.empty();
this.addSearchForm();this.bindPasteEvent()},validate:function(a,c){var b=this.container,d=AJS.$("input:checkbox[name\x3djira-issue]",b),f=AJS.Editor.JiraConnector.Panel.Search.prototype;d.length||a?(b=AJS.$("input:checkbox[name\x3djira-issue]:checked",b).length,0<b||a?f.enableInsert():f.disableInsert(),f.changeInsertOptionStatus(b,a,c)):(AJS.$(".jira-oauth-message-marker",b).length&&f.authCheck(this.selectedServer),AJS.$("input",b).focus(),f.disableInsert());f.isInsertDisabled()||f.validateMaxIssues()},
isValidMaxIssues:function(a){return AJS.$.isNumeric(a)&&this.MINIMUM_MAX_ISSUES_VAL<=a&&a<=this.MAXIMUM_MAX_ISSUES_VAL},validateMaxIssues:function(a){function c(){b.next("#jira-max-number-error").remove()}var b=AJS.$("#jira-maximum-issues");switch(AJS.$("input:radio[name\x3dinsert-advanced]:checked").val()){case "insert-single":case "insert-count":c();b.attr("disabled","disabled");break;case "insert-table":var d=AJS.Editor.JiraConnector.Panel.Search.prototype;b.removeAttr("disabled");var f=b.val();
if(""===AJS.$.trim(f)){if(a&&"keyup"===a.type){c();break}if(a&&"blur"===a.type){f=d.MAXIMUM_MAX_ISSUES_VAL;b.val(f);break}}d.isValidMaxIssues(f)?(c(),d.enableInsert()):(c(),b.after(Confluence.Templates.ConfluenceJiraPlugin.warningValMaxiumIssues()),d.disableInsert())}},customizedColumn:null,checkAndSetDefaultValueMaximumIssues:function(a){if(a){var c=a.element||AJS.$("#jira-maximum-issues");a=a.defaultVal||this.MAXIMUM_MAX_ISSUES_VAL;""===AJS.$.trim(c.val())&&c.val(a)}else AJS.log("Cannot set default value for Maximum Issues")},
setMacroParams:function(a){this.macroParams=a},getMacroParamsFromUserInput:function(){var a=this,c="insert-count"==AJS.$("input:radio[name\x3dinsert-advanced]:checked").val(),b=[],d=[],f=[],p=[],n=[],l={};AJS.$("#my-jira-search .my-result.aui input:checkbox[name\x3djira-issue]").each(function(h){h=AJS.$(this);h.is(":checked")?d[d.length]=h.val():f[f.length]=h.val()});if(c)l.count="true";else{if(!AJS.Editor.JiraConnector.Panel.Search.jiraColumnSelectBox){l.columns=this.defaultColumns;l.columnIds=this.defaultColumnIds;
return}b=AJS.Editor.JiraConnector.Panel.Search.jiraColumnSelectBox.select2("data");b.length?(l.columns=b.map(function(h){return a.selectedServer.columns.find(function(k){return k.id===h.id}).custom?h.text.replace(/%/g,encodeURIComponent("%")).replace(/,/g,encodeURIComponent(",")).replace(/;/g,encodeURIComponent(";")):h.id}).map(function(h){var k=a.aliases.find(function(e){return e.id===h});return k?k.clauseName:h}).join(","),l.columnIds=b.map(function(h){return h.id}).join(","),(p=a.selectedServer.columns.find(function(h){return h.clauseNames.find(function(k){k=
k.toLowerCase();return"epic link"===k||"gh.epic.link.name"===k})}))&&!b.some(function(h){return h.id===p.id})&&(n=a.selectedServer.columns.filter(function(h){return h.clauseNames.find(function(k){k=k.toLowerCase();return"epic name"===k||"gh.epic.label.name"===k||"epic colour"===k||"gh.epic.color.name"===k||"epic status"===k||"gh.epic.status.name"===k})}),b.some(function(h){return n.some(function(k){return k.id===h.id})})&&(l.epicLinkId=p.id))):(l.columns=this.defaultColumns,l.columnIds=this.defaultColumnIds)}c=
AJS.$("input:radio[name\x3dinsert-advanced]:checked").val();"insert-single"===c?l.key=d.toString():l.jqlQuery=0==f.length?this.lastSearch+" ":1==d.length?"key \x3d "+d.toString():"key in ("+d.toString()+")";"insert-table"===c&&(l.maximumIssues=AJS.$("#jira-maximum-issues").val());return l},insertLinkFromForm:function(){var a=this.container;AJS.$("input:checkbox[name\x3djira-issue]",a).length&&0<AJS.$("input:checkbox[name\x3djira-issue]:checked",a).length&&this.insertLink()},insertLink:function(a){a=
a&&"function"===typeof a.insertIssueLinkWithParams?a:this;var c=a.getMacroParamsFromUserInput();a.insertIssueLinkWithParams(c);return!0},loadMacroParams:function(a){var c=this.macroParams;c?(c.maximumIssues||AJS.$("#jira-maximum-issues").attr("disabled","disabled"),"true"==c.count?AJS.$("#opt-total").prop("checked",!0):(AJS.$("#opt-table").prop("checked",!0),AJS.$("#jira-maximum-issues").removeAttr("disabled"),this.checkAndSetDefaultValueMaximumIssues({defaultVal:c.maximumIssues||this.DEFAULT_MAX_ISSUES_VAL}))):
this.checkAndSetDefaultValueMaximumIssues({defaultVal:20});this.prepareColumnSelect(a)},selectHandler:function(){var a=this.container.find("tr.selected");a.length&&a.unbind("keydown.space").bind("keydown.space",function(c){32!=c.which&&32!=c.keyCode||a.find("[type\x3dcheckbox]").trigger("click")})},addDisplayOptionPanel:function(){var a=Confluence.Templates.ConfluenceJiraPlugin.displayOptsOverlayHtml;AJS.$(".jiraSearchResults").after(a());AJS.$("#jiraMacroDlg").unbind("submit").on("submit",function(c){return!1})},
updateTotalIssuesDisplay:function(a){var c=this.selectedServer.url+"/issues/?jql\x3d"+this.lastSearch;20<a&&AJS.$(".my-result.aui").after(Confluence.Templates.ConfluenceJiraPlugin.viewAll({jiraIssuesLink:c}));a=AJS.format("{0} issues",a);AJS.$(".total-issues-text").html(a);AJS.$(".total-issues-link").attr("href",c)},prepareColumnSelect:function(a){var c=this,b=!(this.macroParams&&!this.macroParams.columnIds),d=a||this.macroParams&&this.macroParams.columnIds&&this.macroParams.columnIds.split(",")||
this.macroParams&&this.macroParams.columns&&this.macroParams.columns.toLowerCase().split(",")||this.defaultColumnIds.split(","),f=this.selectedServer,p=function(n){var l=AJS.$("#jiraIssueColumnSelector"),h="",k="";n.filter(function(e){return e.navigable}).sort(function(e,m){var g=d.map(function(q){var t=c.aliases.find(function(r){return r.clauseName===q});return t?t.id:q});return g.indexOf(b||!e.custom?e.id:e.name.toLowerCase())-g.indexOf(b||!m.custom?m.id:m.name.toLowerCase())}).forEach(function(e){d.find(function(m){return b?
m===e.id:e.clauseNames.includes(m)||m===e.name.toLowerCase()})?k+=AJS.template('\x3coption selected\x3d"true" value\x3d"{fieldId}"\x3e{fieldName}\x3c/option\x3e').fill({fieldId:e.id,fieldName:e.name}):h+=AJS.template('\x3coption value\x3d"{fieldId}"\x3e{fieldName}\x3c/option\x3e').fill({fieldId:e.id,fieldName:e.name})});l.hide();l.html(k+h);l.show();l.auiSelect2({width:"415px",containerCssClass:"select2-container-jira-issue-columns"});AJS.Editor.JiraConnector.Panel.Search.jiraColumnSelectBox=l};f.columns&&
0<f.columns.length?p(f.columns):this.retrieveJson(f.id,"/rest/api/2/field",function(n){n&&n.length&&(f.columns=n,p(f.columns))})},expandDisplayOptPanel:function(){var a=AJS.$(".jql-display-opts-overlay"),c=a.height();a.css("top","");a.css("bottom",-(c-40)+"px");a.animate({bottom:0},500)},minimizeDisplayOptPanel:function(){var a=AJS.$(".jql-display-opts-overlay");a.css("top",a.position().top+"px");a.css("bottom","");a.animate({top:414},500)},disableAutoSelectColumns:function(){AJS.Editor.JiraConnector.Panel.Search.jiraColumnSelectBox.auiSelect2("enable",
!1)},enableAutoSelectColumns:function(){AJS.Editor.JiraConnector.Panel.Search.jiraColumnSelectBox.auiSelect2("enable",!0)},checkAutoSelectColumns:function(){AJS.$("#opt-table").prop("checked")?this.enableAutoSelectColumns():(this.disableAutoSelectColumns(),this.enableInsert())},bindEventToDisplayOptionPanel:function(a,c){var b=this,d=AJS.$(".jql-display-opts-close, .jql-display-opts-open"),f=AJS.$(".jql-display-opts-overlay"),p=AJS.$(".jql-display-opts-inner .radio"),n=AJS.$("#my-jira-search input:checkbox[name\x3djira-issue-all]"),
l=AJS.$("#my-jira-search input:checkbox[name\x3djira-issue]");AJS.$("#jira-maximum-issues").on("blur keyup",AJS.Editor.JiraConnector.Panel.Search.prototype.validateMaxIssues);f.css("top","414px");d.click(function(h){h.preventDefault();AJS.$(this).hasClass("disabled")||(AJS.$(this).hasClass("jql-display-opts-open")?(b.expandDisplayOptPanel(),jQuery(this).addClass("jql-display-opts-close"),jQuery(this).removeClass("jql-display-opts-open")):(b.minimizeDisplayOptPanel(),jQuery(this).removeClass("jql-display-opts-close"),
jQuery(this).addClass("jql-display-opts-open")))});p.change(function(){b.checkAutoSelectColumns();b.validateMaxIssues()});n.bind("click",function(){AJS.$(this).prop("checked")?l.prop("checked","checked"):l.removeAttr("checked");b.validate()});l.change(function(){0<AJS.$("#my-jira-search input:checkbox[name\x3djira-issue]:not(:checked)").length?n.removeAttr("checked"):n.prop("checked","checked");b.validate()});b.validate(a,c)},changeInsertOptionStatus:function(a,c,b){var d=AJS.$("#opt-single"),f=AJS.$("#opt-total"),
p=AJS.$("#opt-table"),n=AJS.$("#my-jira-search input:checkbox[name\x3djira-issue]:checked");a="checked"===AJS.$("#my-jira-search input:checkbox[name\x3djira-issue-all]").attr("checked");var l=1===n.length,h=1<n.length;n=0===n.length;var k=AJS.JQLHelper.isSingleKeyJQLExp(AJS.$("#my-jira-search input[name\x3djiraSearch]").val()),e=function(){b&&b.isJqlQuery?p.click():d.click()},m=function(){f.attr("disabled","disabled");p.removeAttr("disabled");d.removeAttr("disabled");e();setTimeout(function(){e()},
100)},g=function(){d.attr("disabled","disabled");f.removeAttr("disabled");"insert-single"===AJS.$("input[name\x3dinsert-advanced]:checked").val()&&setTimeout(function(){p.removeAttr("disabled").click()},100)},q=function(){p.removeAttr("disabled","disabled");f.removeAttr("disabled","disabled");d.removeAttr("disabled","disabled");"insert-single"===AJS.$("input:radio[name\x3dinsert-advanced]:checked").val()&&setTimeout(function(){p.click()},100)};AJS.$(".jql-display-opts-open").removeClass("disabled");
d.removeAttr("disabled");f.removeAttr("disabled");p.removeAttr("disabled");a&&l&&k?m():a&&l&&!k?q():h?g():l&&!a?m():c?g():n&&(d.attr("disabled","disabled"),f.attr("disabled","disabled"),p.attr("disabled","disabled"),AJS.$(".jql-display-opts-close").click(),AJS.$(".jql-display-opts-open").addClass("disabled"))},isInsertTableType:function(){return"insert-table"===AJS.$("input:radio[name\x3dinsert-advanced]:checked").val()},setInsertButtonState:function(){var a=AJS.$(".jql-display-opts-close, .jql-display-opts-open"),
c=AJS.$("#jira-maximum-issues");!a.length||a.length&&this.isInsertTableType()&&!this.isValidMaxIssues(c.val())?this.disableInsert():this.enableInsert()},analyticPanelActionName:"confluence.jira.plugin.searchadded"});AJS.Editor.JiraConnector.Panels.push(new AJS.Editor.JiraConnector.Panel.Search);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:dialogsJs', location = '/jira/jip_createissuepanel.js' */
AJS.Editor.JiraConnector.Panel.Create=function(){};AJS.Editor.JiraConnector.Panel.Create.prototype=AJS.$.extend(AJS.Editor.JiraConnector.Panel.Create.prototype,AJS.Editor.JiraConnector.Panel.prototype);
AJS.Editor.JiraConnector.Panel.Create.prototype=AJS.$.extend(AJS.Editor.JiraConnector.Panel.Create.prototype,{DEFAULT_PROJECT_VALUE:"-1",SHOW_MESSAGE_ON_TOP:!0,EXCLUDED_FIELDS:["project","issuetype","summary","description"],PROJECTS_META:{},setSummary:function(a){var b=AJS.$('.field-group [name\x3d"summary"]',this.jipForm.formEl);b.length&&b.val(a)},resetIssue:function(){AJS.$(".issue-summary",this.container).empty();AJS.$(".issue-description",this.container).empty()},focusForm:function(){var a=AJS.$("select.server-select",
this.container);a.length?a.focus():(a=AJS.$(".project-select",this.container),a.length&&a.focus())},authCheck:function(){this.selectedServer=this.jipForm.getCurrentServer();this.selectedServer.authUrl?this.showOauthChallenge():this.serverSelect()},ajaxAuthCheck:function(a){var b=this;this.endLoading();this.ajaxError(a,function(){b.authCheck(b.jipForm.getCurrentServer())})},showOauthChallenge:function(){AJS.$("div.field-group",this.container).not(".servers").hide();AJS.$(".jira-oauth-message-marker",
this.container).remove();var a=this,b=this.createOauthForm(function(){a.serverSelect()});this.container.append(b)},projectOk:function(){var a=AJS.$(".project-select option:selected",this.container).val();return a&&a.length&&a!=this.DEFAULT_PROJECT_VALUE},setInsertButtonState:function(){if(!1===this.formHasError&&this.projectOk())return this.enableInsert(),!0;this.disableInsert();return!1},startLoading:function(){var a=require("confluence/form-state-control");this.removeError(this.container);AJS.$(".loading-blanket",
this.container).removeClass("hidden");a.disableElement(AJS.$("input,select,textarea",this.container));this.disableInsert();this.handleInsertWaiting(!0)},endLoading:function(){var a=require("confluence/form-state-control");AJS.$(".loading-blanket",this.container).addClass("hidden");a.enableElement(AJS.$("input,select,textarea",this.container));AJS.$(".project-select",this.container).val()===this.DEFAULT_PROJECT_VALUE&&a.disableElement(AJS.$(".issuetype-select",this.container));this.setInsertButtonState();
this.handleInsertWaiting(!1)},bindEvent:function(){var a=this;AJS.$('.field-group [name\x3d"summary"]',this.jipForm.formEl).keyup(function(){a.setInsertButtonState()});this.container.on("focus","input[data-aui-dp-uuid]",function(){var b=AJS.$(this).attr("data-aui-dp-uuid");setTimeout(function(){AJS.$("[data-aui-dp-popup-uuid\x3d"+b+"]").parents(".aui-inline-dialog").addClass("datepicker-patch")},0)})},title:function(){return "Create New Issue"},init:function(a){var b=this;
a.html('\x3cdiv class\x3d"create-issue-container"\x3e\x3c/div\x3e');this.container=AJS.$("div.create-issue-container");this.selectedServer=AJS.Editor.JiraConnector.servers[0];this.jipForm=new (require("jira-integration-plugin/jira-create-issue-form"))({container:".create-issue-container",renderSummaryAndDescription:!0,onError:function(){AJS.$(".field-group .error",this.container).remove();b.formHasError=!0;b.disableInsert()},onServerChanged:function(){AJS.$(".field-group .error",this.container).remove();
b.setInsertButtonState();b.selectedServer=this.getCurrentServer()},onRequiredFieldsRendered:function(f,d){AJS.$(".field-group .error",this.container).remove();b.formHasError=!!d.length;b.setInsertButtonState()},ajax:AJS.$.ajax});a.onselect=function(){b.onselect()};this.bindEvent()},convertFormToJSON:function(a){const b=require("jira-integration-plugin/fields");if(!b)return AJS.logError("Jira integration plugin is missing!"),"";var f={issues:[]},d={};d.fields={project:{id:AJS.$(".project-select option:selected",
a).val()},issuetype:{id:AJS.$(".issuetype-select option:selected",a).val()},summary:AJS.$('.field-group [name\x3d"summary"]',a).val(),description:AJS.$('.field-group [name\x3d"description"]',a).val()};a.children(".create-issue-required-fields").children(".jira-field").children("input,select,textarea").not(".select2-input").each(function(c,e){c=AJS.$(e);d.fields[c.attr("name")]=b.getJSON(c)});f.issues.push(d);return JSON.stringify(f)},validateRequiredFieldInForm:function(a){var b=!0,f="placeholder"in
document.createElement("input");a.find(".field-group .icon-required, .field-group .aui-icon-required").each(function(d,c){c=AJS.$(c).parent();d=c.text();var e=c.nextAll("input,select,textarea"),g=AJS.$.trim(e.val());if(!g||!f&&g==e.attr("placeholder"))b=!1,c=c.parent(),d=AJS.format("{0} is required",d),c.append(aui.form.fieldError({message:d}))});return b},clearFieldErrors:function(){AJS.$("form div.error",this.container).remove()},insertLink:function(){var a=this,b=Confluence.getContextPath()+
"/rest/jira-integration/1.0/issues",f=AJS.$("div.create-issue-container form"),d=this.jipForm.getCurrentServer();a.clearFieldErrors();a.validateRequiredFieldInForm(f)&&(this.startLoading(),AJS.$.ajax({type:"POST",contentType:"application/json",url:b+"?applicationId\x3d"+this.selectedServer.id,data:this.convertFormToJSON(f),success:function(c){var e=c&&c.issues&&c.issues[0]&&c.issues[0].issue&&c.issues[0].issue.key;e?(a.insertIssueLink(e,d.displayUrl+"/browse/"+e),a.resetIssue()):(_.isEmpty(c.errors[0].elementErrors.errorMessages)||
(e=Confluence.Templates.ConfluenceJiraPlugin.renderCreateErrorPanel({errors:c.errors[0].elementErrors.errorMessages,serverUrl:d.displayUrl}),a.errorMsg(AJS.$("div.create-issue-container"),e)),_.each(c.errors[0].elementErrors.errors,function(g,h){g=aui.form.fieldError({message:g});AJS.$(AJS.format(".field-group [name\x3d{0}]",h),f).after(g)}));a.endLoading()},error:function(c,e){a.ajaxAuthCheck(c)}}))},onselect:function(){var a=!!AJS.$(".aui-message \x3e .oauth-init",this.container).length;this.selectedServer&&
!this.selectedServer.authUrl&&a?this.jipForm.defaultFields.server.trigger("change"):this.setInsertButtonState()},analyticPanelActionName:"confluence.jira.plugin.issuecreated"});AJS.Editor.JiraConnector.Panels.push(new AJS.Editor.JiraConnector.Panel.Create);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:dialogsJs', location = '/jira/recentlyviewedpanel.js' */
AJS.Editor.JiraConnector.Panel.Recent=function(){};AJS.Editor.JiraConnector.Panel.Recent.prototype=AJS.$.extend(AJS.Editor.JiraConnector.Panel.Recent.prototype,AJS.Editor.JiraConnector.Panel.prototype);
AJS.Editor.JiraConnector.Panel.Recent.prototype=AJS.$.extend(AJS.Editor.JiraConnector.Panel.Recent.prototype,{title:function(){return "Recently Viewed"},init:function(d){var a=AJS.Editor.JiraConnector.servers;d.html('\x3cdiv id\x3d"my-recent-issues" '+(1<a.length?'class\x3d"multi-server" ':"")+"\x3e\x3c/div\x3e");var b=this;this.selectedServer=a[0];1<a.length&&(a=AJS.$('\x3cdiv class\x3d"jira-server-select"\x3e\x3cform action\x3d"#" method\x3d"post" class\x3d"aui"\x3e\x3cdiv class\x3d"field-group"\x3e\x3clabel\x3eServer\x3c/label\x3e\x3cselect class\x3d"select" \x3e\x3c/select\x3e\x3c/div\x3e\x3c/form\x3e\x3c/div\x3e').appendTo("div#my-recent-issues"),
this.applinkServerSelect(AJS.$(".select",a),function(e){b.selectedServer=e;b.onselect()}));d.onselect=function(){b.onselect()}},insertLink:function(){this.insertSelected()},onselect:function(){var d=require("confluence/form-state-control"),a=this,b=AJS.$("div#my-recent-issues");this.container=b;var e=function(){b.children().not(".jira-server-select").remove()},g=function(){if(a.selectedServer.authUrl){e();var c=a.createOauthForm(function(){f()});b.append(c)}else f()};var f=function(){if(!a.currentXhr||
4==a.currentXhr.readyState){var c=AJS.$(".select",b);d.disableElement(c);e();a.createIssueTableFromUrl(b,a.selectedServer.id,"/sr/jira.issueviews:searchrequest-xml/temp/SearchRequest.xml?jqlQuery\x3dkey+in+issueHistory()+ORDER+BY+lastViewed+DESC\x26field\x3dsummary\x26field\x3dtype\x26field\x3dlink\x26tempMax\x3d50\x26returnMax\x3dtrue",a.setSelectedIssue,a.insertLink,a.disableInsert,function(){c.length&&c.focus()},function(h){AJS.$("div.data-table",b).remove();a.ajaxError(h,g)},!1)}};g()},analyticPanelActionName:"confluence.jira.plugin.recentlyviewadded"});
AJS.Editor.JiraConnector.Panels.push(new AJS.Editor.JiraConnector.Panel.Recent);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:dialogsJs', location = 'templates/soy/dialog.soy' */
// This file was automatically generated from dialog.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.ConfluenceJiraPlugin.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.ConfluenceJiraPlugin == 'undefined') { Confluence.Templates.ConfluenceJiraPlugin = {}; }


Confluence.Templates.ConfluenceJiraPlugin.displayOptsHtml = function(opt_data, opt_ignored) {
  return '<div class=\'jql-display-opts-bar data-table\'><a href="javascript:void(0)" class=\'jql-display-opts-open\' data-title="' + soy.$$escapeHtml('Display options panel is not available without a selection.') + '"><span></span><strong>' + soy.$$escapeHtml('Display options') + '</strong></a></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.displayOptsHtml.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.displayOptsHtml';
}


Confluence.Templates.ConfluenceJiraPlugin.displayOptsOverlayHtml = function(opt_data, opt_ignored) {
  return '<div class=\'jql-display-opts-overlay data-table\' data-js="display-option-wrapper"><form id="jiraMacroDlg" class="aui" action="#"><div class=\'jql-display-opts-inner\'><a href="javascript:void(0)" class=\'jql-display-opts-open\' data-js="display-option-trigger" data-title="' + soy.$$escapeHtml('Display options panel is not available without a selection.') + '"><span></span><strong>' + soy.$$escapeHtml('Display options') + '</strong></a><fieldset class="group"><legend><span>' + soy.$$escapeHtml('Display as') + '</span></legend><div class="radio"><input type=\'radio\' class=\'radio\' name=\'insert-advanced\' id=\'opt-single\' value=\'insert-single\'><label for=\'opt-single\'>' + soy.$$escapeHtml('Single issue') + '</label><div class=\'description\'>' + soy.$$escapeHtml('Display the macro as a single issue.') + '</div></div><div class="radio"><input type=\'radio\' class=\'radio\' name=\'insert-advanced\' id=\'opt-total\' value=\'insert-count\'><label for=\'opt-total\'>' + soy.$$escapeHtml('Total issue count') + '</label><div class=\'description\'>' + soy.$$escapeHtml('Display total number of issues as a link. E.g.') + '<a class=\'total-issues-link\' target=\'_blank\' href=\'#\'><span class=\'total-issues-text\'>' + soy.$$escapeHtml(AJS.format('{0} issues',12)) + '</span></a></div></div><div class="radio"><input type=\'radio\' class=\'radio\' checked=\'checked\' name=\'insert-advanced\' id=\'opt-table\' value=\'insert-table\'><label for=\'opt-table\'>' + soy.$$escapeHtml('Table') + '</label><div class=\'description\'>' + soy.$$escapeHtml('Customize your columns below.') + '</div></div></fieldset><fieldset><div class="field-group"><label>' + soy.$$escapeHtml('Maximum issues') + '</label><input type="text" name="jira-maximum-issues" id="jira-maximum-issues" class="text short-field" /><div class="description">' + soy.$$escapeHtml('Leave empty to get all issues.') + '</div></div></fieldset><fieldset><div class="field-group"><label>' + soy.$$escapeHtml('Columns to display') + '</label><select id="jiraIssueColumnSelector" data-placeholder="' + soy.$$escapeHtml('Start typing to see possible columns') + '" multiple="true" class="select long-field"></select></div></fieldset></div></form></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.displayOptsOverlayHtml.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.displayOptsOverlayHtml';
}


Confluence.Templates.ConfluenceJiraPlugin.searchForm = function(opt_data, opt_ignored) {
  return '<div class=\'jira-search-form\'><form class=\'aui\'><fieldset class=\'inline\'>' + ((opt_data.isMultiServer == true) ? '<div class=\'search-input\'><input type=\'text\' class=\'text search-text\' name=\'jiraSearch\' placeholder="' + soy.$$escapeHtml('e.g. filter \x3d \x22My Jira filter\x22') + '"/></div>' : '<div class=\'search-input one-server\'><input type=\'text\' class=\'text one-server long-field\' name=\'jiraSearch\' placeholder="' + soy.$$escapeHtml('e.g. filter \x3d \x22My Jira filter\x22') + '"/></div>') + '<button type=\'button\' title="' + soy.$$escapeHtml('Search') + '" class=\'button\'><span class="aui-icon aui-icon-small aui-iconfont-search"></span></button></fieldset><div class=\'search-help\'>' + soy.$$escapeHtml('Search using any issue key, search URL, Jira link, JQL, plain text or filter') + '</div></form></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.searchForm.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.searchForm';
}


Confluence.Templates.ConfluenceJiraPlugin.warningDialog = function(opt_data, opt_ignored) {
  return '<div class=\'warning-body\'><p>' + soy.$$escapeHtml('If you connect Confluence to Jira you can easily link issues...') + '</p>' + ((opt_data.isAdministrator == false) ? '<p>' + soy.$$escapeHtml('Your administrator can set this up.') + '</p>' : '') + '</div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.warningDialog.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.warningDialog';
}


Confluence.Templates.ConfluenceJiraPlugin.issueCheckbox = function(opt_data, opt_ignored) {
  return '<input type=\'checkbox\' name=\'jira-issue\' value=\'' + soy.$$escapeHtml(opt_data.issueKey) + '\' checked/>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.issueCheckbox.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.issueCheckbox';
}


Confluence.Templates.ConfluenceJiraPlugin.issueKey = function(opt_data, opt_ignored) {
  return '<span><img class="icon" src="' + soy.$$escapeHtml(opt_data.issueIconUrl) + '"/> ' + soy.$$escapeHtml(opt_data.issueKey) + '</span>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.issueKey.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.issueKey';
}


Confluence.Templates.ConfluenceJiraPlugin.showMessageNoServer = function(opt_data, opt_ignored) {
  return '' + ((opt_data.isAdministrator == true) ? soy.$$escapeHtml('No server found match with your URL.') + '<a id="open_applinks" target="_blank" href="' + soy.$$escapeHtml(opt_data.contextPath) + '/admin/listapplicationlinks.action">' + soy.$$escapeHtml('Click here to set this up') + '</a>' : soy.$$escapeHtml('No server found match with your URL. Your administrator can set this up.') + '<a id="open_applinks" target="_blank" href="' + soy.$$escapeHtml(opt_data.contextPath) + '/wiki/contactadministrators.action">' + soy.$$escapeHtml('Click here to contact your admin') + '</a>');
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.showMessageNoServer.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.showMessageNoServer';
}


Confluence.Templates.ConfluenceJiraPlugin.viewAll = function(opt_data, opt_ignored) {
  return '<div class=\'view-all\'>' + soy.$$escapeHtml('Displaying first 20 results.') + '<a href=\'' + soy.$$escapeHtml(opt_data.jiraIssuesLink) + '\' target=\'_blank\'>' + soy.$$escapeHtml('View all.') + '</a></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.viewAll.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.viewAll';
}


Confluence.Templates.ConfluenceJiraPlugin.learnMore = function(opt_data, opt_ignored) {
  return '<a href="' + soy.$$escapeHtml('https://confluence.atlassian.com/display/DOC/Jira+Issues+Macro') + '" target=\'_blank\'>' + soy.$$escapeHtml('Learn More') + '</a>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.learnMore.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.learnMore';
}


Confluence.Templates.ConfluenceJiraPlugin.contentJiraChart = function(opt_data, opt_ignored) {
  return '<div id="jira-chart-content-' + soy.$$escapeHtml(opt_data.chartType) + '"><div class=\'jira-chart-search\'><form class=\'aui\'><fieldset class=\'inline\'>' + ((opt_data.isMultiServer == true) ? '<div class=\'jira-chart-search-input\'><input type=\'text\' id="jira-chart-search-input" class=\'text search-text\' name=\'jiraSearch\' placeholder="' + soy.$$escapeHtml('e.g. filter \x3d \x22My Jira filter\x22') + '"/></div><select id="jira-chart-servers" class="select" name="server" tabindex="0"></select>' : '<div class=\'jira-chart-search-input one-server\'><input type=\'text\' id="jira-chart-search-input" class=\'text one-server long-field\' name=\'jiraSearch\' placeholder="' + soy.$$escapeHtml('e.g. filter \x3d \x22My Jira filter\x22') + '"/></div>') + '<button id="jira-chart-search-button" type=\'button\' class=\'button\'>' + soy.$$escapeHtml('Preview') + '</button></fieldset><div class=\'search-help\'>' + soy.$$escapeHtml('Search using any issue key, search URL, Jira link, JQL, plain text or filter') + '</div></form></div><div class="jira-chart-img"></div><div class="jira-chart-option" data-js="display-option-wrapper" ><form action="#" class="aui" id="jiraChartMacroOption"><div class="jiraChartOption"><a class="jirachart-display-opts-open" data-js="display-option-trigger" href="javascript:void(0)"><span class="display-option-icon"></span><strong>' + soy.$$escapeHtml('Display options') + '</strong></a>' + ((opt_data.chartType == 'pie') ? Confluence.Templates.ConfluenceJiraPlugin.piechartForm(null) : (opt_data.chartType == 'createdvsresolved') ? Confluence.Templates.ConfluenceJiraPlugin.createdVsResolved(null) : (opt_data.chartType == 'twodimensional') ? Confluence.Templates.ConfluenceJiraPlugin.twoDimensional(null) : '') + '</div></form></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.contentJiraChart.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.contentJiraChart';
}


Confluence.Templates.ConfluenceJiraPlugin.piechartForm = function(opt_data, opt_ignored) {
  return '<fieldset><div class="field-group"><label for="jira-chart-statType">' + soy.$$escapeHtml('Chart by') + '</label><select name="type" id="jira-chart-statType" class="select"></select></div></fieldset><fieldset class="group"><div class="field-group"><label for="jira-chart-width">' + soy.$$escapeHtml('Width') + '</label><input type="text" name="jira-chart-width" id="jira-chart-width" class="text short-field"><span class="aui-icon aui-icon-small aui-iconfont-help help-aligment widthInfo" title="' + soy.$$escapeHtml('Enter pixels, percent or leave blank to auto-resize.') + '"></span><div class="checkbox"><input type="checkbox" id="jira-pie-chart-show-border" class="checkbox jira-chart-show-border"><label for="jira-pie-chart-show-border">' + soy.$$escapeHtml('Show border') + '</label></div><div class="checkbox"><input type="checkbox" id="jira-pie-chart-show-infor" class="checkbox jira-chart-show-infor"><label for="jira-pie-chart-show-infor">' + soy.$$escapeHtml('Show chart information') + '</label></div></div></fieldset>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.piechartForm.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.piechartForm';
}


Confluence.Templates.ConfluenceJiraPlugin.createdVsResolved = function(opt_data, opt_ignored) {
  return '<fieldset><div class="field-group"><label for="created-vs-resolved-chart-periodName">' + soy.$$escapeHtml('Period') + '</label><select class="select" id="created-vs-resolved-chart-periodName" name="created-vs-resolved-chart-periodName"><option value="hourly">' + soy.$$escapeHtml('Hourly') + '</option><option value="daily">' + soy.$$escapeHtml('Daily') + '</option><option value="weekly">' + soy.$$escapeHtml('Weekly') + '</option><option value="monthly">' + soy.$$escapeHtml('Monthly') + '</option><option value="quarterly">' + soy.$$escapeHtml('Quarterly') + '</option><option value="yearly">' + soy.$$escapeHtml('Yearly') + '</option></select><div class="error"></div></div><div class="field-group"><label for="created-vs-resolved-chart-daysprevious">' + soy.$$escapeHtml('Days previously') + '<span class="aui-icon icon-required"></span></label><input type="text" class="text" id="created-vs-resolved-chart-daysprevious" value="30"><span class="aui-icon aui-icon-small aui-iconfont-help help-aligment daysPreviousInfo" title="' + soy.$$escapeHtml('Number of days to include (counting back from today).') + '"></span><div class="error days-previous-error"></div></div><fieldset class="group"><div class="checkbox"><input type="checkbox" id="created-vs-resolved-chart-cumulative" name="created-vs-resolved-chart-cumulative" class="checkbox"><label for="created-vs-resolved-chart-cumulative">' + soy.$$escapeHtml('Cumulative totals') + '</label><span class="aui-icon aui-icon-small aui-iconfont-help help-aligment cumulativeInfo" title="' + soy.$$escapeHtml('Progressively add totals (1, 2, 3) or show individual values (1,1,1).') + '"></span></div><div class="checkbox"><input type="checkbox" id="created-vs-resolved-chart-showunresolvedtrend" name="created-vs-resolved-chart-showunresolvedtrend" class="checkbox"><label for="created-vs-resolved-chart-showunresolvedtrend">' + soy.$$escapeHtml('Show unresolved trend') + '</label><span class="aui-icon aui-icon-small aui-iconfont-help help-aligment showunresolvedtrendInfo" title="' + soy.$$escapeHtml('Include a subplot showing unresolved issues.') + '"></span></div></fieldset><div class="field-group"><label for="created-vs-resolved-chart-versionLabel">' + soy.$$escapeHtml('Show versions') + '</label><select class="select" id="created-vs-resolved-chart-versionLabel" name="created-vs-resolved-chart-versionLabel"><option value="all">' + soy.$$escapeHtml('All versions') + '</option><option value="major">' + soy.$$escapeHtml('Only major versions') + '</option><option value="none">' + soy.$$escapeHtml('None') + '</option></select><span class="aui-icon aui-icon-small aui-iconfont-help help-aligment versionLabelInfo" title="' + soy.$$escapeHtml('Mark version release dates in the chart.') + '"></span><div class="error"></div></div></fieldset><fieldset class="group"><div class="field-group"><label for="jira-chart-width">' + soy.$$escapeHtml('Width') + '</label><input type="text" name="jira-chart-width" id="jira-chart-width" class="text short-field"><span class="aui-icon aui-icon-small aui-iconfont-help help-aligment widthInfo" title="' + soy.$$escapeHtml('Enter pixels, percent or leave blank to auto-resize.') + '"></span><div class="checkbox"><input type="checkbox" id="jira-createdvsresolved-chart-show-border" class="checkbox jira-chart-show-border"><label for="jira-createdvsresolved-chart-show-border">' + soy.$$escapeHtml('Show border') + '</label></div><div class="checkbox"><input type="checkbox" id="jira-createdvsresolved-chart-show-infor" class="checkbox jira-chart-show-infor"><label for="jira-createdvsresolved-chart-show-infor">' + soy.$$escapeHtml('Show chart information') + '</label></div></div></fieldset>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.createdVsResolved.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.createdVsResolved';
}


Confluence.Templates.ConfluenceJiraPlugin.twoDimensional = function(opt_data, opt_ignored) {
  return '<fieldset><div id="jira-chart-support-all-version" class="hidden"></div><div class="field-group"><label for="twodimensional-xaxis">' + soy.$$escapeHtml('XAxis') + '</label><select class="select" id="twodimensional-xaxis"><option value="statuses">' + soy.$$escapeHtml('Status') + '</option><option value="priorities">' + soy.$$escapeHtml('Priority') + '</option><option value="assignees">' + soy.$$escapeHtml('Assignee') + '</option><option value="allFixfor">' + soy.$$escapeHtml('Fix For Versions (all)') + '</option><option value="components">' + soy.$$escapeHtml('Component') + '</option><option value="issuetype">' + soy.$$escapeHtml('Issue Type') + '</option></select></div><div class="field-group"><label for="twodimensional-yaxis">' + soy.$$escapeHtml('YAxis') + '</label><select class="select" id="twodimensional-yaxis"><option value="statuses">' + soy.$$escapeHtml('Status') + '</option><option value="priorities">' + soy.$$escapeHtml('Priority') + '</option><option value="assignees">' + soy.$$escapeHtml('Assignee') + '</option><option value="allFixfor">' + soy.$$escapeHtml('Fix For Versions (all)') + '</option><option value="components">' + soy.$$escapeHtml('Component') + '</option><option value="issuetype">' + soy.$$escapeHtml('Issue Type') + '</option></select></div><div class="field-group"><label for="twodimensional-number-of-result">' + soy.$$escapeHtml('Rows to display') + '</label><input type="text" name="twodimensional-number-of-result" id="twodimensional-number-of-result" class="text short-field"><div class="error twodimensional-number-of-result-error"></div></div></fieldset>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.twoDimensional.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.twoDimensional';
}


Confluence.Templates.ConfluenceJiraPlugin.jiraChartErrorMessage = function(opt_data, opt_ignored) {
  return '<div class="aui-message-container"><div class="aui-message error closeable shadowed"><span class=\'message\'>' + soy.$$escapeHtml(opt_data.message) + '</span><span class="aui-icon icon-close" role="button" tabindex="0"></span></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.jiraChartErrorMessage.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.jiraChartErrorMessage';
}


Confluence.Templates.ConfluenceJiraPlugin.noServerWarning = function(opt_data, opt_ignored) {
  return '<div class="aui-message-container"><div class="aui-message warning">' + ((opt_data.isAdministrator == true) ? soy.$$escapeHtml('No server found match with your URL.') + '<a id="open_applinks" target="_blank" href="' + soy.$$escapeHtml(opt_data.contextPath) + '/admin/listapplicationlinks.action">' + soy.$$escapeHtml('Click here to set this up') + '</a>' : soy.$$escapeHtml('No server found match with your URL. Your administrator can set this up.') + '<a id="open_applinks" target="_blank" href="' + soy.$$escapeHtml(opt_data.contextPath) + '/wiki/contactadministrators.action">' + soy.$$escapeHtml('Click here to contact your admin') + '</a>') + '</div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.noServerWarning.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.noServerWarning';
}


Confluence.Templates.ConfluenceJiraPlugin.addMoreToComeLink = function(opt_data, opt_ignored) {
  return '<li class="page-menu-item"><button class="item-button moreToCome"><a target="_blank" href="http://go.atlassian.com/confluencejiracharts">' + soy.$$escapeHtml('More to come...') + '</a></button></li>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.addMoreToComeLink.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.addMoreToComeLink';
}


Confluence.Templates.ConfluenceJiraPlugin.addCrossMacroLink = function(opt_data, opt_ignored) {
  return '<li class="page-menu-item"><hr><span class="aui-nav-heading jira-padding-left-10px"><strong>' + soy.$$escapeHtml('OTHER Jira CONTENT') + '</strong></span><nav class="aui-navgroup aui-navgroup-vertical"><div class="aui-navgroup-inner"><ul class="aui-nav"><li><button class="item-button jira-left-panel-link" id="' + soy.$$escapeHtml(opt_data.id) + '">' + soy.$$escapeHtml(opt_data.label) + '</button></li></ul></div></nav></li>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.addCrossMacroLink.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.addCrossMacroLink';
}


Confluence.Templates.ConfluenceJiraPlugin.jqlInvalid = function(opt_data, opt_ignored) {
  return '<div class="aui-message-container"><div class="aui-message warning">' + soy.$$escapeHtml('The Jira server didn\x27t understand your search query. If you entered JQL, please ensure that it\x27s correctly formed. If you entered an issue key, ensure that it exists and you have permission to view it.') + '</div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.jqlInvalid.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.jqlInvalid';
}


Confluence.Templates.ConfluenceJiraPlugin.warningValWidthColumn = function(opt_data, opt_ignored) {
  return '<div class="error width-error">' + ((opt_data.error == 'wrongFormat') ? soy.$$escapeHtml('The width must be in correct format') : (opt_data.error == 'wrongNumber') ? soy.$$escapeHtml('The width must be a number between 100 and 9000') : '') + '</div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.warningValWidthColumn.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.warningValWidthColumn';
}


Confluence.Templates.ConfluenceJiraPlugin.warningValMaxiumIssues = function(opt_data, opt_ignored) {
  return '<div id="jira-max-number-error" class="error">' + soy.$$escapeHtml('Must be a number between 1 and 1000.') + '</div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.warningValMaxiumIssues.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.warningValMaxiumIssues';
}


Confluence.Templates.ConfluenceJiraPlugin.showJiraUnsupportedVersion = function(opt_data, opt_ignored) {
  return '<div class="jira-unsupported-version aui-message-container"><div class="aui-message warning">' + soy.$$escapeHtml('Jira Charts are not available for your version of Jira. Upgrade to Jira 6.1.1 or later to use this macro.') + '</div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.showJiraUnsupportedVersion.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.showJiraUnsupportedVersion';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:dialogsJs', location = 'templates/soy/create_issues.soy' */
// This file was automatically generated from create_issues.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.ConfluenceJiraPlugin.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.ConfluenceJiraPlugin == 'undefined') { Confluence.Templates.ConfluenceJiraPlugin = {}; }


Confluence.Templates.ConfluenceJiraPlugin.createIssuesForm = function(opt_data, opt_ignored) {
  return '<form action="#" method="post" class="aui" id="create-issues-form"><div class="loading-blanket hidden"><div class="loading-data"></div></div><div class="field-group servers"><label>' + soy.$$escapeHtml('Server') + '</label><select class="select server-select"></select></div><div class="field-group project-select-parent" ><label>' + soy.$$escapeHtml('Project') + '</label><select class="select project-select" name="pid"></select></div><div class="field-group type-select-parent issues-type-group" ><label>' + soy.$$escapeHtml('Issue Type') + '</label><select class="select type-select" name="issuetype"></select></div><div class="field-group"><label>' + soy.$$escapeHtml('Summary') + '<span class="aui-icon icon-required"></span></label><input class="text issue-summary" type="text" name="summary"/></div><div id="jira-required-fields-panel"></div><div class="field-group"><label>' + soy.$$escapeHtml('Description') + '</label><textarea class="issue-description textarea" rows="5" name="description"></textarea></div></form>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.createIssuesForm.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.createIssuesForm';
}


Confluence.Templates.ConfluenceJiraPlugin.renderOptions = function(opt_data, opt_ignored) {
  var output = '';
  var optionList15 = opt_data.options;
  var optionListLen15 = optionList15.length;
  for (var optionIndex15 = 0; optionIndex15 < optionListLen15; optionIndex15++) {
    var optionData15 = optionList15[optionIndex15];
    output += '<option value="' + soy.$$escapeHtml(optionData15.id) + '">' + soy.$$escapeHtml(optionData15.name) + '</option>';
  }
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.renderOptions.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.renderOptions';
}


Confluence.Templates.ConfluenceJiraPlugin.renderOption = function(opt_data, opt_ignored) {
  return '<option value="' + soy.$$escapeHtml(opt_data.option.id) + '" data-jira-option-key="' + soy.$$escapeHtml(opt_data.option.key) + '">' + soy.$$escapeHtml(opt_data.option.name) + '</option>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.renderOption.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.renderOption';
}


Confluence.Templates.ConfluenceJiraPlugin.renderCreateErrorPanel = function(opt_data, opt_ignored) {
  var output = '<div>' + soy.$$escapeHtml('There were errors creating an issue in') + '<a target="_blank" href=' + soy.$$escapeHtml(opt_data.serverUrl) + '>Jira</a></div><ul>';
  var errorList36 = opt_data.errors;
  var errorListLen36 = errorList36.length;
  for (var errorIndex36 = 0; errorIndex36 < errorListLen36; errorIndex36++) {
    var errorData36 = errorList36[errorIndex36];
    output += '<li>' + soy.$$escapeHtml(errorData36) + '</li>';
  }
  output += '</ul>';
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.renderCreateErrorPanel.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.renderCreateErrorPanel';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:text-placeholders-jira', location = '/jira/placeholder.js' */
(function(){AJS.bind("init.rte",function(){AJS.bind("editor.text-placeholder.activated",function(b,a){a&&"jira"===a.placeholderType&&AJS.Editor.JiraConnector.open(AJS.Editor.JiraConnector.source.instructionalText)});AJS.Rte.Placeholder&&AJS.Rte.Placeholder.addPlaceholderType&&AJS.Rte.Placeholder.addPlaceholderType({type:"jira",label:"Jira Macro",tooltip:"Instructional text is replaced with a Jira Macro on click.",activation:{click:!0,keypress:!1}})})})(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:jirachart-macro', location = '/jirachart/jirachart-dialog.js' */
AJS.Editor.JiraChart=function(h){var l=require("confluence/form-state-control"),x="Insert",y="Cancel",z="Insert Jira Chart",c,d,u=function(a){if(!c){c=new AJS.ConfluenceDialog({width:840,height:590,id:"jira-chart"});c.addHeader(z);d=AJS.Editor.JiraChart.Panels;for(var b=0;b<d.length;b++){"function"===typeof d[b].title?c.addPanel(d[b].title()):void 0!==d[b].title&&c.addPanel(d[b].title);
var f=c.getCurrentPanel();d[b].init(f)}h("#jira-chart ul.dialog-page-menu").show().append(Confluence.Templates.ConfluenceJiraPlugin.addCrossMacroLink({id:"open-jira-issue-dialog",label:"Jira Issue/Filter"}));c.addButton(x,function(){var e=d[c.getCurrentPanel().id],g=e.chartType;0<c.getCurrentPanel().body.find("#jira-chart-content-"+g).length&&e.isImageChartExisted()?(e=e.getMacroParamsFromDialog(),t(e),AJS.Editor.JiraChart.close()):m(h("#jira-chart-content-"+e.chartType))},"insert-jira-chart-macro-button");
c.addLink("Select Macro",function(){c.hide();AJS.MacroBrowser.open(!1)},"dialog-back-link");c.addCancel(y,function(){AJS.Editor.JiraChart.close()})}AJS.$("#jira-chart .dialog-page-menu button").click(function(){var e=d[c.getCurrentPanel().id],g=c.getCurrentPanel().body,n=AJS.Editor.JiraChart.Helper.getSelectedServer(g);p(g,n);k(g);e.handleInsertButton();e.focusForm();e.resetDisplayOption()});b=c.getCurrentPanel().body;k(b);var q=q||function(e){var g={};_.each(e,
function(n,A){g[n.chartType]=A});return g}(d);B(q,a);r();b=c;f=b.gotoPanel;a=a&&a.params?q[a.params.chartType]:0;f.call(b,a);c.overrideLastTab();c.show();C()},D=function(){_.each(AJS.Editor.JiraChart.Panels,function(a){a.preBinding&&"function"===typeof a.preBinding&&a.preBinding()})},C=function(){h("#open-jira-issue-dialog").click(function(){AJS.Editor.JiraChart.close();AJS.Editor.JiraConnector&&AJS.Editor.JiraConnector.openCleanDialog(!1)})},m=function(a){void 0!==AJS.Editor.JiraChart.Helper.convertSearchTextToJQL(a)&&
d[c.getCurrentPanel().id].renderChart()},k=function(a){if(a.find("#jira-chart-support-all-version").length)return!0;var b=AJS.Editor.JiraChart.Helper.getSelectedServer(a).buildNumber;return-1==b||6109<=b&&6155>b?(a.find(".jira-chart-img").html(Confluence.Templates.ConfluenceJiraPlugin.showJiraUnsupportedVersion()),a.find("#jira-chart-search-input").attr("disabled","disabled"),a.find("#jira-chart-search-button").attr("disabled","disabled"),a=a.find(".jirachart-display-opts-close, .jirachart-display-opts-open"),
a.hasClass("jirachart-display-opts-close")&&a.click(),a.addClass("disabled"),r(),!1):!0},t=function(a){AJS.Editor.inRichTextMode()&&tinymce.confluence.macrobrowser.macroBrowserComplete({name:"jirachart",params:a})},B=function(a,b){for(var f=0;f<d.length;f++)d[f].resetDialogValue();D();b&&b.params&&d[a[b.params.chartType]].bindingDataFromMacroToForm(b.params)},v=function(a){a.find(".jira-oauth-message-marker").remove();a.find(".jira-chart-img").empty();a.find("#jira-chart-search-input").empty()},r=
function(){l.disableElement(h("#jira-chart").find(".insert-jira-chart-macro-button"))},p=function(a,b){h(".jira-oauth-message-marker",a).remove();var f={selectedServer:b,msg:AJS.Editor.JiraConnector.Panel.prototype.msg};b&&b.authUrl&&(b=AJS.Editor.JiraConnector.Panel.prototype.createOauthForm.call(f,function(){h(".jira-oauth-message-marker",a).remove();AJS.Editor.JiraChart.search(a)}),a.find("div.jira-chart-search").append(b))},w=function(a){a.find("#jira-chart-search-input").removeAttr("disabled");
a.find("#jira-chart-search-button").removeAttr("disabled");a.find(".jirachart-display-opts-open").removeClass("disabled")};return{close:function(){c.hide();tinymce.confluence.macrobrowser.macroBrowserCancel()},edit:function(a){if(void 0===AJS.Editor.JiraConnector.servers||0===AJS.Editor.JiraConnector.servers.length){AJS.Editor.JiraConnector.warningPopup(AJS.Meta.get("is-admin"));var b=!1}else b=!0;b&&(u(a),b=c.getCurrentPanel().body,k(b)&&(w(b),void 0!==a.params&&void 0!==a.params.serverId&&m(b),
a=AJS.Editor.JiraChart.Helper.getSelectedServer(b),p(b,a)))},search:m,disableInsert:r,enableInsert:function(){var a=AJS.$("#jira-chart").find(".insert-jira-chart-macro-button");a.is(":disabled")&&l.enableElement(a)},disableSearch:function(a){l.disableElement(a.find("#jira-chart-search-button"))},enableSearch:function(a){a.find("#jira-chart-search-button").is(":disabled")&&l.enableElement(a.find("#jira-chart-search-button"))},insertJiraChartMacroWithParams:t,open:u,clearChartContent:v,loadServers:function(a){0<
AJS.Editor.JiraConnector.servers.length&&AJS.Editor.JiraConnector.Panel.prototype.applinkServerSelect(a.find("#jira-chart-servers"),function(b){v(a);k(a)&&(p(a,b),w(a))})},validateServerSupportedChart:k}}(AJS.$);AJS.Editor.JiraChart.Panels=[];AJS.MacroBrowser.setMacroJsOverride("jirachart",{opener:AJS.Editor.JiraChart.edit});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:jirachart-macro', location = '/jirachart/jirachart-helper.js' */
AJS.Editor.JiraChart.Helper=function(p){var m=/^\d+$/,f={},g=function(a){a=a&&"string"===typeof a?a.replace("px",""):"";"auto"===a&&(a="");0<a.indexOf("%")&&(a=4*a.replace("%",""));return a},k=function(a){return m.test(a)},h=function(a){var b=AJS.Editor.JiraConnector.servers;return 1<b.length?a.find("#jira-chart-servers option:selected").data("jiraapplink"):b[0]};return{getSelectedServer:h,bindingCommonChartElements:function(a){return{jql:a.find("#jira-chart-search-input"),width:a.find("#jira-chart-width"),
border:a.find(".jira-chart-show-border"),showinfor:a.find(".jira-chart-show-infor"),displayOption:a.find(".jirachart-display-opts-close, .jirachart-display-opts-open"),server:a.find("#jira-chart-servers")}},bindingCommonDataFromMacroToForm:function(a,b){a.jql.val(decodeURIComponent(b.jql));a.width.val(b.width);a.border.attr("checked","true"===b.border);a.showinfor.attr("checked","true"===b.showinfor);1<AJS.Editor.JiraConnector.servers.length&&a.server.val(b.serverId)},getCommonMacroParamsFromDialog:function(a,
b){b=h(b);return{jql:encodeURIComponent(a.jql.val()),width:g(a.width.val()),border:a.border.prop("checked"),showinfor:a.showinfor.prop("checked"),serverId:b.id,server:b.name,isAuthenticated:!b.authUrl}},getCommonChartParamsRequest:function(a,b){return{contentId:AJS.Meta.get("page-id"),macro:{name:"jirachart",params:{jql:a.jql,serverId:a.serverId,width:a.width,border:a.border,showinfor:a.showinfor,chartType:b}}}},convertSearchTextToJQL:function(a){var b=AJS.Editor.JiraConnector.servers,c=a.find("#jira-chart-search-input").val();
if(0===c.indexOf("http")){var e=AJS.JQLHelper.findServerIndexFromUrl(c,b);if(-1!==e)e=b[e].id,a.find("#jira-chart-servers").val(e);else{b=Confluence.Templates.ConfluenceJiraPlugin.noServerWarning({isAdministrator:AJS.Meta.get("is-admin"),contextPath:Confluence.getContextPath()});a.find(".jira-chart-img").html(b);AJS.Editor.JiraChart.disableInsert();return}}(b=AJS.JQLHelper.convertToJQL(c,e))?a.find("#jira-chart-search-input").val(b):(a.find(".jira-chart-img").html(Confluence.Templates.ConfluenceJiraPlugin.jqlInvalid()),
AJS.Editor.JiraChart.disableInsert());return b},convertFormatWidth:g,isChartWidthValid:function(a){a.next().next(".width-error").remove();var b=g(a.val());if(b)if(k(b)){if(100>b||9E3<b)var c="wrongNumber"}else c="wrongFormat";return c?(a.next().after(Confluence.Templates.ConfluenceJiraPlugin.warningValWidthColumn({error:c})),AJS.Editor.JiraChart.disableInsert(),!1):!0},isNumber:k,isJqlNotEmpty:function(a){return a?""!==AJS.$.trim(a.val())&&a.val()!==a.attr("placeholder"):!1},populateStatType:function(a,
b){var c=h(a);if(b){var e=f[c.id];e||AppLinks.makeRequest({appId:c.id,type:"GET",url:"/rest/gadget/1.0/statTypes",dataType:"json",async:!1,success:function(d){d&&(e=f[c.id]=d)},error:function(d){if(d)try{f[c.id]=JSON.parse(d.responseText),e=JSON.parse(d.responseText)}catch(n){AJS.error("Error contacting the server "+c.id+" with response "+d.response)}AJS.log("Jira Chart Macro: unable to retrieve statTypes from AppLink: "+c.id)}}).fail(function(d){if(d)try{f[c.id]=JSON.parse(d.responseText),e=JSON.parse(d.responseText)}catch(n){AJS.error("Error contacting the server "+
c.id+" with response "+d.response)}});var l="";e&&"undefined"!==typeof e.stats&&_.each(e.stats,function(d){l+="\x3coption value \x3d '"+d.value+"'\x3e"+AJS.escapeHtml(d.label)+" \x3c/option\x3e"});b.html(l)}}}}(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:jirachart-macro', location = '/jirachart/jirachart-panel.js' */
AJS.Editor.JiraChart.Panel=function(){};
AJS.Editor.JiraChart.Panel.prototype={init:function(a){var d=Confluence.Templates.ConfluenceJiraPlugin.contentJiraChart({isMultiServer:1<AJS.Editor.JiraConnector.servers.length,chartType:this.chartType});a.html(d);this.container=AJS.$(this.containerId);AJS.Editor.JiraChart.clearChartContent(this.container);AJS.Editor.JiraChart.loadServers(this.container);this.bindingChartElements();this.bindingActions()},bindingActions:function(){var a=this,d=function(){a.isFormValid()?AJS.Editor.JiraChart.search(a.container):
AJS.Editor.JiraChart.disableInsert()};a.container.find(a.clickableElements).click(d);a.container.find(a.onChangeElements).change(d);a.chartElements.jql.change(function(){this.value!==a.jqlWhenEnterKeyPress&&(a.container.find(".jira-chart-img").empty(),AJS.Editor.JiraChart.disableInsert());a.jqlWhenEnterKeyPress=""}).bind("paste",function(){setTimeout(function(){a.isFormValid()&&(a.jqlWhenEnterKeyPress=a.chartElements.jql.val(),AJS.Editor.JiraChart.search(a.container))},100)});var c=a.container.find("input[type\x3d'text']");
c.unbind("keydown").keydown(function(b){if(13==b.which){var f=function(e){c.unbind("keyup",f);a.isFormValid()&&AJS.Editor.JiraChart.search(a.container);"jira-chart-search-input"===c.attr("id")&&(a.jqlWhenEnterKeyPress=c.val());e.stopPropagation();return!1};c.keyup(f);b.stopPropagation();return!1}});a.bindSelectOption();a.bindingServerChange()},bindingServerChange:function(){var a=this;a.chartElements.server.change(function(){a.isFormValid()&&AJS.Editor.JiraChart.validateServerSupportedChart(a.container)?
AJS.Editor.JiraChart.search(a.container):AJS.Editor.JiraChart.disableInsert()})},renderChart:function(){var a=this,d=this.getChartParamsRequest(),c=Confluence.getContextPath()+"/rest/tinymce/1/macro/preview",b=this.container.find(".jira-chart-img");b.html('\x3cdiv class\x3d"loading-data"\x3e\x3c/div\x3e');var f=b.find(".loading-data")[0];AJS.$.data(f,"spinner",Raphael.spinner(f,50,"#666"));a.request&&a.request.abort();a.request=AJS.$.ajax({url:c,type:"POST",contentType:"application/json",data:JSON.stringify(d)}).done(function(e){b.html("").hide();
var g=AJS.$('\x3ciframe frameborder\x3d"0" id\x3d"chart-preview-iframe"\x3e\x3c/iframe\x3e');g.appendTo(b);var k=g[0].contentWindow,h=k.document;g.on("load",function(){k.AJS.$("#main").addClass("chart-preview-main");b.show();a.handleInsertButton()});e=e.replace("window.onload","var chartTest");h.open();h.write(e);h.close()}).error(function(e){"abort"!=e.statusText&&(AJS.log("Jira Chart Macro - Fail to get data from macro preview"),b.html(Confluence.Templates.ConfluenceJiraPlugin.jiraChartErrorMessage({message:"Unable to render Jira chart macro due to an execution error."})));
AJS.Editor.JiraChart.disableInsert()})},resetDialogValue:function(){var a=AJS.$("input",this.container);a.filter(":text").val("");a.filter(":checked").removeAttr("checked");this.container.find("#jira-chart-search-input").val();this.container.find(".jira-chart-img").empty();this.resetDisplayOption()},resetDisplayOption:function(){var a=this,d=this.chartElements.displayOption;d.addClass("jirachart-display-opts-open");d.removeClass("jirachart-display-opts-close");setTimeout(function(){var c=a.container.find(".jira-chart-option");
c.scrollTop(0);c.css({overflow:"hidden",top:"430px"})},0)},bindSelectOption:function(){var a=this.container.find(".jira-chart-option"),d=function(c){var b=a.position().top+"px",f="",e={top:430};c?(b="",f=40-a.find("#jiraChartMacroOption").height()+"px",e={bottom:0},a.css("overflow","auto")):a.css("overflow","hidden");a.css("top",b);a.css("bottom",f);a.animate(e,500)};a.css("top","430px");this.chartElements.displayOption.click(function(c){var b=AJS.$(this);c.preventDefault();b.hasClass("disabled")||
(b.hasClass("jirachart-display-opts-open")?(d(!0),b.addClass("jirachart-display-opts-close"),b.removeClass("jirachart-display-opts-open")):(d(),b.removeClass("jirachart-display-opts-close"),b.addClass("jirachart-display-opts-open")))})},isImageChartExisted:function(){return 0<this.container.find("#chart-preview-iframe").contents().find(".jira-chart-macro-img").length},focusForm:function(){this.container.find("#jira-chart-search-input").focus()},handleInsertButton:function(){this.isFormValid()&&this.isResultValid()?
AJS.Editor.JiraChart.enableInsert():AJS.Editor.JiraChart.disableInsert()}};
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:jirachart-macro', location = '/jirachart/piechart-panel.js' */
AJS.Editor.JiraChart.Panel.PieChart=function(d){AJS.Editor.JiraChart.Panel.call(this);var b=this;this.title="Pie Chart";this.chartType="pie";this.containerId="#jira-chart-content-pie";this.clickableElements=".jira-chart-search button, .jira-chart-show-border, .jira-chart-show-infor";this.onChangeElements="#jira-chart-statType, #jira-chart-width";this.isFormValid=function(){return AJS.Editor.JiraChart.Helper.isChartWidthValid(b.chartElements.width)&&AJS.Editor.JiraChart.Helper.isJqlNotEmpty(b.chartElements.jql)};
this.isResultValid=function(){return this.container.find("#chart-preview-iframe").contents().find(".jira-chart-macro-wrapper").length};this.bindingActions=function(){AJS.Editor.JiraChart.Panel.prototype.bindingActions.call(this);this.container.find(".widthInfo").tooltip({gravity:"w"})};this.bindingServerChange=function(){b.chartElements.server.change(function(){AJS.Editor.JiraChart.Helper.populateStatType(b.container,b.chartElements.statType);b.isFormValid()?AJS.Editor.JiraChart.search(b.container):
AJS.Editor.JiraChart.disableInsert()})};this.bindingChartElements=function(){this.chartElements=AJS.Editor.JiraChart.Helper.bindingCommonChartElements(this.container);this.chartElements.statType=this.container.find("#jira-chart-statType")};this.getChartParamsRequest=function(){var a=this.getMacroParamsFromDialog(),c=AJS.Editor.JiraChart.Helper.getCommonChartParamsRequest(a,this.chartType);c.macro.params.statType=a.statType;return c};this.getMacroParamsFromDialog=function(){var a=AJS.Editor.JiraChart.Helper.getCommonMacroParamsFromDialog(this.chartElements,
this.container);a.chartType="pie";a.statType=this.chartElements.statType.val();return a};this.bindingDataFromMacroToForm=function(a){a&&(AJS.Editor.JiraChart.Helper.bindingCommonDataFromMacroToForm(this.chartElements,a),this.chartElements.statType.val(a.statType))};this.preBinding=function(){AJS.Editor.JiraChart.Helper.populateStatType(this.container,this.container.find("#jira-chart-statType"))}};AJS.Editor.JiraChart.Panel.PieChart.prototype=AJS.Editor.JiraChart.Panel.prototype;
AJS.Editor.JiraChart.Panel.PieChart.prototype.constructor=AJS.Editor.JiraChart.Panel.PieChart;AJS.Editor.JiraChart.Panels.push(new AJS.Editor.JiraChart.Panel.PieChart(AJS.$));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:jirachart-macro', location = '/jirachart/createdvsresolvedchart-panel.js' */
AJS.Editor.JiraChart.Panel.CreatedVsResolvedChart=function(e){AJS.Editor.JiraChart.Panel.call(this);var c=this,f=function(){c.container.find("#created-vs-resolved-chart-periodName").val("daily");c.container.find("#created-vs-resolved-chart-daysprevious").val("30")},g=function(){var a=c.chartElements.periodName.val(),b=e.trim(c.chartElements.daysprevious.val()),d=c.container.find(".days-previous-error");if(""===b)return c.container.find(".days-previous-error").html("Days Previously is required field."),
!1;if(!AJS.Editor.JiraChart.Helper.isNumber(b)||0>b)return d.html("Days Previously must be a number and positive."),!1;switch(a){case "hourly":(isValid=10>=b)||d.html(AJS.format("Days must not exceed {0} for {1} period",10,a));break;case "daily":(isValid=300>=b)||d.html(AJS.format("Days must not exceed {0} for {1} period",300,a));break;case "weekly":(isValid=1750>=b)||d.html(AJS.format("Days must not exceed {0} for {1} period",
1750,a));break;case "monthly":(isValid=7500>=b)||d.html(AJS.format("Days must not exceed {0} for {1} period",7500,a));break;case "quarterly":(isValid=22500>=b)||d.html(AJS.format("Days must not exceed {0} for {1} period",22500,a));break;case "yearly":(isValid=36500>=b)||d.html(AJS.format("Days must not exceed {0} for {1} period",36500,a));break;default:isValid=!1}isValid&&d.empty();return isValid};this.title="Created vs Resolved";
this.chartType="createdvsresolved";this.containerId="#jira-chart-content-createdvsresolved";this.clickableElements=".jira-chart-search button, .jira-chart-show-border, .jira-chart-show-infor, #created-vs-resolved-chart-cumulative, #created-vs-resolved-chart-showunresolvedtrend";this.onChangeElements="#created-vs-resolved-chart-periodName, #created-vs-resolved-chart-daysprevious, #created-vs-resolved-chart-versionLabel, #jira-chart-width";this.isFormValid=function(){var a=AJS.Editor.JiraChart.Helper.isChartWidthValid(c.chartElements.width);
return g()&&a&&AJS.Editor.JiraChart.Helper.isJqlNotEmpty(c.chartElements.jql)};this.isResultValid=function(){return this.container.find("#chart-preview-iframe").contents().find(".jira-chart-macro-wrapper").length};this.init=function(a){AJS.Editor.JiraChart.Panel.prototype.init.call(this,a);f()};this.bindingChartElements=function(){this.chartElements=AJS.Editor.JiraChart.Helper.bindingCommonChartElements(this.container);this.chartElements.periodName=this.container.find("#created-vs-resolved-chart-periodName");
this.chartElements.daysprevious=this.container.find("#created-vs-resolved-chart-daysprevious");this.chartElements.isCumulative=this.container.find("#created-vs-resolved-chart-cumulative");this.chartElements.showUnresolvedTrend=this.container.find("#created-vs-resolved-chart-showunresolvedtrend");this.chartElements.versionLabel=this.container.find("#created-vs-resolved-chart-versionLabel")};this.bindingActions=function(){AJS.Editor.JiraChart.Panel.prototype.bindingActions.call(this);this.container.find(".widthInfo").tooltip({gravity:"w"});
this.container.find(".showunresolvedtrendInfo").tooltip({gravity:"w"});this.container.find(".cumulativeInfo").tooltip({gravity:"w"});this.container.find(".versionLabelInfo").tooltip({gravity:"w"});this.container.find(".daysPreviousInfo").tooltip({gravity:"w"})};this.getChartParamsRequest=function(){var a=this.getMacroParamsFromDialog(),b=AJS.Editor.JiraChart.Helper.getCommonChartParamsRequest(a,this.chartType);b.macro.params.periodName=a.periodName;b.macro.params.daysprevious=a.daysprevious;b.macro.params.isCumulative=
a.isCumulative;b.macro.params.showUnresolvedTrend=a.showUnresolvedTrend;b.macro.params.versionLabel=a.versionLabel;return b};this.getMacroParamsFromDialog=function(){var a=AJS.Editor.JiraChart.Helper.getCommonMacroParamsFromDialog(this.chartElements,this.container);a.chartType="createdvsresolved";a.periodName=this.chartElements.periodName.val();a.daysprevious=e.trim(this.chartElements.daysprevious.val());a.isCumulative=this.chartElements.isCumulative.prop("checked");a.showUnresolvedTrend=this.chartElements.showUnresolvedTrend.prop("checked");
a.versionLabel=this.chartElements.versionLabel.val();return a};this.resetDialogValue=function(){AJS.Editor.JiraChart.Panel.prototype.resetDialogValue.call(this);f()};this.bindingDataFromMacroToForm=function(a){a&&(AJS.Editor.JiraChart.Helper.bindingCommonDataFromMacroToForm(c.chartElements,a),c.chartElements.isCumulative.attr("checked","false"!==a.isCumulative),c.chartElements.showUnresolvedTrend.attr("checked","true"===a.showUnresolvedTrend),c.chartElements.periodName.val(""===a.periodName?"daily":
a.periodName),c.chartElements.versionLabel.val(a.versionLabel),c.chartElements.daysprevious.val(""===a.daysprevious?"30":a.daysprevious))}};AJS.Editor.JiraChart.Panel.CreatedVsResolvedChart.prototype=AJS.Editor.JiraChart.Panel.prototype;AJS.Editor.JiraChart.Panel.CreatedVsResolvedChart.prototype.constructor=AJS.Editor.JiraChart.Panels.CreatedVsResolvedChart;AJS.Editor.JiraChart.Panels.push(new AJS.Editor.JiraChart.Panel.CreatedVsResolvedChart(AJS.$));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:jirachart-macro', location = '/jirachart/twodimensionalchart-panel.js' */
AJS.Editor.JiraChart.Panel.TwoDimensionalChart=function(d){AJS.Editor.JiraChart.Panel.call(this);var b=this,e=function(){b.chartElements.numberToShow.val(5);b.chartElements.xstattype.val("statuses");b.chartElements.ystattype.val("assignees")};this.title="Two Dimensional";this.chartType="twodimensional";this.containerId="#jira-chart-content-twodimensional";this.clickableElements=".jira-chart-search button, .jira-chart-show-border, .jira-chart-show-infor, #twodimensional-show-total";
this.onChangeElements="#twodimensional-xaxis, #twodimensional-yaxis, #twodimensional-number-of-result";this.isFormValid=function(){var a=d(".twodimensional-number-of-result-error");var c=b.chartElements.numberToShow.val();AJS.Editor.JiraChart.Helper.isNumber(c)&&0<c?(a.empty(),a=!0):(a.html("The number of rows should be a positive integer"),a=!1);return a&&AJS.Editor.JiraChart.Helper.isJqlNotEmpty(b.chartElements.jql)};this.isResultValid=function(){return this.container.find("#chart-preview-iframe").contents().find(".two-dimensional-chart-table").length};
this.init=function(a){AJS.Editor.JiraChart.Panel.prototype.init.call(this,a);e()};this.bindingChartElements=function(){this.chartElements=AJS.Editor.JiraChart.Helper.bindingCommonChartElements(this.container);this.chartElements.xstattype=this.container.find("#twodimensional-xaxis");this.chartElements.ystattype=this.container.find("#twodimensional-yaxis");this.chartElements.sortBy=this.container.find("#twodimensional-sortby");this.chartElements.sortDirection=this.container.find("#twodimensional-sort-direction");
this.chartElements.showTotals=this.container.find("#twodimensional-show-total");this.chartElements.numberToShow=this.container.find("#twodimensional-number-of-result")};this.getChartParamsRequest=function(){var a=this.getMacroParamsFromDialog(),c=AJS.Editor.JiraChart.Helper.getCommonChartParamsRequest(a,this.chartType);c.macro.params.xstattype=a.xstattype;c.macro.params.ystattype=a.ystattype;c.macro.params.sortBy=a.sortBy;c.macro.params.sortDirection=a.sortDirection;c.macro.params.showTotals=a.showTotals;
c.macro.params.numberToShow=a.numberToShow;return c};this.getMacroParamsFromDialog=function(){var a=AJS.Editor.JiraChart.Helper.getCommonMacroParamsFromDialog(this.chartElements,this.container);a.chartType="twodimensional";a.xstattype=this.chartElements.xstattype.val();a.ystattype=d.trim(this.chartElements.ystattype.val());a.sortBy=d.trim(this.chartElements.sortBy.val());a.sortDirection=d.trim(this.chartElements.sortDirection.val());a.showTotals=this.chartElements.showTotals.prop("checked");a.numberToShow=
this.chartElements.numberToShow.val();return a};this.bindingDataFromMacroToForm=function(a){a&&(AJS.Editor.JiraChart.Helper.bindingCommonDataFromMacroToForm(b.chartElements,a),b.chartElements.xstattype.val(a.xstattype),b.chartElements.ystattype.val(a.ystattype),b.chartElements.sortBy.val(a.sortBy),b.chartElements.sortDirection.val(a.sortDirection),b.chartElements.showTotals.attr("checked","true"===a.showTotals),b.chartElements.numberToShow.val(a.numberToShow))};this.resetDialogValue=function(){AJS.Editor.JiraChart.Panel.prototype.resetDialogValue.call(this);
e()};this.isImageChartExisted=function(){return 0<this.container.find("#chart-preview-iframe").contents().find(".two-dimensional-chart-table").length};this.preBinding=function(){AJS.Editor.JiraChart.Helper.populateStatType(this.container,this.container.find("#twodimensional-xaxis"));AJS.Editor.JiraChart.Helper.populateStatType(this.container,this.container.find("#twodimensional-yaxis"));b.chartElements.xstattype.val("statuses");b.chartElements.ystattype.val("assignees")};this.bindingServerChange=
function(){b.chartElements.server.change(function(){AJS.Editor.JiraChart.Helper.populateStatType(b.container,b.chartElements.xstattype);AJS.Editor.JiraChart.Helper.populateStatType(b.container,b.chartElements.ystattype);b.chartElements.xstattype.val("statuses");b.chartElements.ystattype.val("assignees");b.isFormValid()?AJS.Editor.JiraChart.search(b.container):AJS.Editor.JiraChart.disableInsert()})}};AJS.Editor.JiraChart.Panel.TwoDimensionalChart.prototype=AJS.Editor.JiraChart.Panel.prototype;
AJS.Editor.JiraChart.Panel.TwoDimensionalChart.prototype.constructor=AJS.Editor.JiraChart.Panel.TwoDimensionalChart;AJS.Editor.JiraChart.Panels.push(new AJS.Editor.JiraChart.Panel.TwoDimensionalChart(AJS.$));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-support-util', location = 'support/atlassian-editor-support.js' */
define("confluence-editor/support/atlassian-editor-support",["ajs","confluence/meta"],function(c,b){return{inlineTasks:function(){var a=b.get("use-inline-tasks");return"true"===a||!0===a},isCollaborativeContentType:function(){var a=b.get("content-type");return b.get("collaborative-content")&&("page"===a||"blogpost"===a)}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/support/atlassian-editor-support","AJS.Rte.Support");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:page-editor-quit-dialog', location = 'editor/page-editor-quit-dialog.js' */
define("confluence-editor/editor/page-editor-quit-dialog","jquery confluence/templates ajs confluence/meta confluence/legacy window document confluence-editor/editor/page-editor-message confluence/api/constants underscore".split(" "),function(e,n,c,d,f,B,M,o,C,D){function E(b){b.stopPropagation();b.preventDefault();c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog.show-diff-clicked"});a.showDiffButton.hide();s();a.hideDiffButton.show()}function t(b){b.stopPropagation();b.preventDefault();
c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog.hide-diff-clicked"});a.hideDiffButton.hide();a.showDiffButton.show();a.dialogEl.removeClass("aui-dialog2-xlarge").addClass("aui-dialog2-medium");k(h)}function F(b){if(l!==true){h=i?g.REVERT:g.DELETE;p();c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog.discard"});b.stopPropagation();b.preventDefault();f.Editor.UI.setButtonsState(false,a.buttonsAll);u(d.get("content-id"))}}function v(){f.Editor.Drafts.unBindUnloadMessage();
a.editorForm.append(n.Editor.Page.hiddenInputCancel()).submit()}function w(a){if(a&&a.stopPropagation){a.stopPropagation();a.preventDefault()}c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog.keep-draft-clicked",data:{contributorCount:m.length+1}});v()}function G(b){f.Editor.UI.setButtonsState(false,a.buttonsAll);j.save(b);p()}function x(b){b.stopPropagation();b.preventDefault();h=null;c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.draft-status-indicator.click"});
y(function(){a.closeButton.show();s()})}function H(b){b.stopPropagation();b.preventDefault();if(l!==true){a.closeButton.show();d.get("new-page")?k(g.DELETE):k(g.REVERT)}}function I(b){b.stopPropagation();b.preventDefault();a.dialog.hide()}function s(){a.dialogEl.removeClass("aui-dialog2-medium").addClass("aui-dialog2-xlarge");k(g.SHOW_DIFF);e.ajax({url:C.CONTEXT_PATH+"/rest/tinymce/1/content/"+d.get("page-id")+"/draft/diff",type:"GET"}).success(function(b){a.dialogContent.find(".wiki-content").html(b).children().first().hasClass("diff-context-placeholder")&&
a.dialogContent.find("hr").hide()})}function k(b){function c(){return b===g.SHOW_DIFF&&(h===g.REVERT||h===g.DELETE)}if(b===g.UPDATE||b===g.PUBLISH)q=(new Date).getTime()/1E3;var f=b;c()&&(f=h);a.dialogHeader.html(n.Editor.Page.quitDialogHeader({dialogType:f,contentType:d.get("content-type"),newPage:d.get("new-page")}));a.dialogContent.html(n.Editor.Page.quitDialogContent({dialogType:b,contributors:m,contentType:d.get("content-type"),newDialog:h==null}));a.hideDiffButton=e("#qed-hide-diff-button").click(t);
if(!d.get("new-page")){b!==g.SHOW_DIFF&&(h=b);a.showDiffButton=e("#qed-show-diff-button").click(E);a.showDiffButton.show();a.buttonsAll.push(a.showDiffButton)}if(b===g.DELETE||b===g.REVERT||c()){a.discardButton.show();a.dialogEl.addClass("aui-dialog2-warning")}else a.dialogEl.removeClass("aui-dialog2-warning");a.closeButton.show();a.dialogFooter.find("."+b).show();a.dialog.show()}function J(){p();c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog.dialog-closed"});a.dialogEl.removeClass("aui-dialog2-xlarge").addClass("aui-dialog2-medium");
f.Editor.UI.toggleSavebarBusy(false);a.dialogFooter.find(".aui-button").hide();a.dialogContent.empty()}function p(){var a=(new Date).getTime()/1E3-q;c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog."+h+".displayed",data:{displayTimeInSeconds:a,contentId:d.get("content-id")}});q=0}function u(b,g){var d=c.contextPath(),d=i?d+"/rest/synchrony/1.0/content/"+b+"/changes/unpublished":d+"/rest/api/content/"+b+"?status=draft";i&&o.suppressMessage("editor.synchrony.revert-page");g=
g||0;e.ajax({url:d,type:"DELETE",data:{draftId:b},contentType:"application/json",dataType:"json"}).done(function(){i&&o.handleMessage("collaborative-editor-discard-error",{type:"success",close:"auto",message:"Successfully reverted to the last published version"});c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog.discard-success",data:{contentId:b}});v()}).fail(function(d){if(d.status===409&&g<K){c.trigger("disable-draft-save");u(b,g+1)}else{var e=JSON.parse(d.responseText),
h="There were errors discarding your draft.",d=d.errors||"An unknown error has occurred. Please check your logs.";if(e.data&&e.data.errors&&e.data.errors[0]&&e.data.errors[0].message.key==="content.delete.published"){h="This page has already been published";d="You can no longer discard this draft because it\u0027s not a draft anymore!"}c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog.discard-error",data:{contentId:b}});c.trigger("enable-draft-save");o.handleMessage("collaborative-editor-discard-error",
{type:"error",title:i?"Can\u0027t revert to last published version":h,message:i?"We can\u0027t get the last published version of the page at the moment. Give it a few moments then try discarding the draft again.":d});a.dialog.hide();f.Editor.UI.setButtonsState(true,a.buttonsAll)}})}function L(a,c){c&&c.contributors&&(m=D.reject(c.contributors,function(a){return a.name===d.get("remote-user")}))}function y(a){f.Editor.Drafts.save({forceSave:i,skipErrorHandler:true,onSuccessHandler:a||e.noop})}var a={},i,z,g={DELETE:"delete",REVERT:"revert",PUBLISH:"publish",
UPDATE:"update",SHOW_DIFF:"diff"},m=[],r=false,j={},h,q=0,K=5,l=false,A=false;return{init:function(b){if(z=d.getBoolean("shared-drafts")&&(d.get("content-type")==="page"||d.get("content-type")==="blogpost"))if(r){j.save=b&&b.saveHandler;j.cancelErrorHandler=b&&b.cancelErrorHandler;a.publishButton.click(G)}else{i=!d.get("new-page");a.discardButton=e("#qed-discard-button").tooltip({gravity:"s",className:"quit-editor-dialog"});if(f.Editor.isLimitedModeEnabled()&&i){f.Editor.UI.setButtonState(false,a.discardButton);
a.discardButton.removeAttr("disabled")}else a.discardButton.click(F);a.saveExitButton=e("#qed-save-exit-button").click(w);a.hideDiffButton=e("#qed-hide-diff-button").click(t);a.publishButton=e("#qed-publish-button");a.closeButton=e("#qed-close-button").click(I);a.buttonsAll=[a.discardButton,a.saveExitButton,a.showDiffButton,a.hideDiffButton,a.publishButton];a.dialog=c.dialog2("#quit-editor-dialog");a.dialogEl=a.dialog.$el;a.dialogHeader=a.dialogEl.find(".aui-dialog2-header");a.dialogContent=a.dialogEl.find(".aui-dialog2-content");
a.dialogFooter=a.dialogEl.find(".aui-dialog2-footer");a.editorForm=e("#wysiwyg").closest("form");e("#rte-show-changes").on("click",x);e("#rte-show-revert").on("click",H);if(!d.get("new-page"))e("#pluggable-status").on("click","a",x);a.dialog.on("hide",J);c.bind("editor-heartbeat",L);c.bind("synchrony.history.evicted",function(){l=true;e("#qed-discard-button").attr("disabled","disabled")});c.bind("synchrony.connected",function(){A=true});r=true}},process:function(a){if(z){a.stopPropagation();a.preventDefault();
e(B).one("editor-heartbeat rte.heartbeat-error",function(c){e(this).off("editor-heartbeat rte.heartbeat-error");switch(a.target.id){case f.Editor.UI.saveButton.attr("id"):case f.Editor.UI.versionCommentInput.attr("id"):f.Editor.UI.toggleSavebarBusy(true);if(m.length===0)j.save();else{y();k(i?g.UPDATE:g.PUBLISH)}break;case f.Editor.UI.cancelButton.attr("id"):f.Editor.Drafts.save({forceSave:true,skipErrorHandler:false,onSuccessHandler:w,ignoreRelations:!(f.Editor.hasContentChanged()&&A)});var d=f.Editor.Drafts.getDraftSavingPromise();
d&&d.fail(function(a){j.cancelErrorHandler&&j.cancelErrorHandler(a)});(!c.namespace||c.namespace!=="heartbeat-error")&&f.Editor.UI.toggleSavebarBusy(true)}});f.Editor.heartbeat()}},_destroy:function(){l=r=false}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/util/is-valid-uri.js' */
define("confluence-collaborative-editor-plugin/util/is-valid-uri",[],function(){function d(a,c){var b=a.lastIndexOf(c);return-1!==b&&b===a.length-c.length}var e=/^(((?![':"<>])[\s-\$\+<->\^`\|~-------------------------------------------------------------------------!-#%-\*,-/:;\?@\[-\]_\{\}-------------------------------------------------A-Za-z-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------0-9-------------------------------------------------------------])+|\#(\w)+)$/,
f=/^(?:\s*(?:([a-zA-Z]*):\/\/|mailto:|skype:|callto:|facetime:|git:|irc:|irc6:|news:|nntp:|feed:|cvs:|svn:|mvn:|ssh:|itms:|notes:|smb:|sourcetree:|urn:|tel:|xmpp:|telnet:|vnc:|rdp:|whatsapp:|slack:|sip:|sips:|magnet:)[A-Za-z-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------0-9-------------------------------------------------------------\/]+(?:(?!['"<>])[\s-\$\+<->\^`\|~-------------------------------------------------------------------------!-#%-\*,-/:;\?@\[-\]_\{\}-------------------------------------------------A-Za-z-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------0-9-------------------------------------------------------------])*(?:\s)*)$/;
return function(a){if(null===a)return!1;var c=e.test(a),b=(a=a.match(f))&&a.length&&a[1];a=a&&a.length&&(!b||!d(b,"script")&&!d(b,"data"));return c||a}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/template/synchrony-presence.soy' */
// This file was automatically generated from synchrony-presence.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.SynchronyPresence.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.SynchronyPresence == 'undefined') { Confluence.Templates.SynchronyPresence = {}; }


Confluence.Templates.SynchronyPresence.container = function(opt_data, opt_ignored) {
  return '<ul id="avatar-list" class="synchrony-doc-' + soy.$$escapeHtml(opt_data.docId) + ' collaborative-avatars-list"></ul><aui-inline-dialog id="more-avatars" alignment="bottom right" responds-to="toggle" aria-hidden="true"><h3>' + soy.$$escapeHtml('Also edited') + '</h3><ul id="more-avatars-list" class="collaborative-avatars-list"></ul></aui-inline-dialog>';
};
if (goog.DEBUG) {
  Confluence.Templates.SynchronyPresence.container.soyTemplateName = 'Confluence.Templates.SynchronyPresence.container';
}


Confluence.Templates.SynchronyPresence.avatar = function(opt_data, opt_ignored) {
  return '<li class="avatar-item' + ((opt_data.active) ? ' p' + soy.$$escapeHtml(opt_data.telepointer) + ' active' : '') + ((opt_data.currentUser) ? ' no-animate-entry' : '') + '"><span title="' + soy.$$escapeHtml(opt_data.title) + '" avatar="' + soy.$$escapeHtml(opt_data.initial) + '"' + ((opt_data.active) ? ' data-origin="' + soy.$$escapeHtml(opt_data.origin) + '"' : '') + ' class="avatar' + ((opt_data.active) ? ' active' : '') + '"' + ((opt_data.username) ? ' data-username="' + soy.$$escapeHtml(opt_data.username) + '"' : '') + '><img src="' + soy.$$escapeHtml(opt_data.avatarUrl) + '" alt="' + soy.$$escapeHtml(AJS.format('Profile picture for {0}',opt_data.username)) + '"/></span></li>';
};
if (goog.DEBUG) {
  Confluence.Templates.SynchronyPresence.avatar.soyTemplateName = 'Confluence.Templates.SynchronyPresence.avatar';
}


Confluence.Templates.SynchronyPresence.overlay = function(opt_data, opt_ignored) {
  return '<span id="synchrony-presence-overlay" class="overlay avatar"><a href="#" aria-controls="more-avatars" class="aui-button" data-aui-trigger></a></span>';
};
if (goog.DEBUG) {
  Confluence.Templates.SynchronyPresence.overlay.soyTemplateName = 'Confluence.Templates.SynchronyPresence.overlay';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/synchrony-presence.js' */
define("confluence-collaborative-editor-plugin/synchrony-presence","backbone confluence-collaborative-editor-plugin/avatar-list-view confluence-collaborative-editor-plugin/overlay-view ajs confluence/legacy confluence/meta confluence/templates jquery underscore".split(" "),function(A,B,u,e,C,f,D,l,h){function v(){q=l(D.SynchronyPresence.container({docId:C.getContentId()}));l("#rte-toolbar").append(q);new B({el:"#avatar-list",collection:c});m=new u({collection:c});l("#rte-toolbar").append(m.render())}
function w(b){var a=l.extend({},b);a.id=b.origin;a.fullname=b.fullname||"Anonymous";a.name=b.name||"anonymous";a.username=b.name;a.avatarURL=e.contextPath()+b.avatarURL;a.active=b.active||!0;a.currentUser=b.currentUser||r===b.origin;return a}function E(){return c.filter(function(b){return b.get("active")}).length}function t(){var b=[];c.each(function(a){a.get("active")||h.some(n,function(g){return a.get("id")===g.name})||b.push(a)});h.each(b,function(a){c.remove(a)});h.each(n,
function(a){a.name===f.get("remote-user")||c.any(function(g){return g.get("id")===a.name||g.get("name")===a.name})||(a.active=!1,a.id=a.name,c.add(a))})}var c=new A.Collection;c.add(w({origin:"current-user",fullname:f.get("current-user-fullname"),name:f.get("remote-user"),avatarURL:f.get("current-user-avatar-url"),active:!0,currentUser:!0}));var x=!1,r="",p,n=[],q=null,m,y=!1;e.Rte.getEditor()&&e.Rte.getEditor().initialized?v():e.bind("rte-collab-ready",v);return{appendTo:function(b,a,g){r=b;x||(p=
p||require("tinymce"),x=!0,n=g,a.on("presence",function(z){m.hideInlineDialog();z.joined.filter(function(d){return d.origin!==r}).forEach(function(d){d=w(d);var k=c.findWhere({active:!1,id:d.name});k&&c.remove(k);c.add(d,{at:E()})});z.left.forEach(function(d){d.id=d.origin;c.remove(d);t()});t();y||(e.bind("editor-heartbeat",function(d,k){h.isArray(k.contributors)&&(n=k.contributors,t())}),y=!0);e.trigger("analyticsEvent",{name:"confluence.synchrony.user.in.session",data:{numOtherUsers:c.length,draftId:f.get("draft-id"),
contentId:f.get("content-id")}})}),p.EditorManager.activeEditor.on("click",h.bind(u.prototype.hideInlineDialog,m)));return q},setTinyMce:function(b){p=b}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/avatar-list-view.js' */
define("confluence-collaborative-editor-plugin/avatar-list-view",["backbone","confluence-collaborative-editor-plugin/avatar-view","ajs","jquery","underscore"],function(e,f,d,h,g){return e.View.extend({initialize:function(){this.collection.on("add",this.addAvatar,this);this.collection.on("remove",this.removeAvatar,this);this.collection.each(this.addAvatar,this)},addAvatar:function(a){var b=new f({model:a});a.get("active")?(d.log(a.get("fullname")+" joined. ("+a.get("origin")+")"),a=this.$el.find("li.active").last(),
b=a.length?b.render().insertAfter(a):b.render().prependTo(this.$el)):b=b.render().appendTo(this.$el);a=function(c){c.addClass("show");c.children(".avatar").tooltip({fade:!0,gravity:"ne"})};6===this.collection.length?a(b):g.defer(a,b);this._manageOverlayClass()},removeAvatar:function(a){a.get("active")&&d.log(a.get("fullname")+" left. ("+a.get("origin")+")");this._manageOverlayClass()},_manageOverlayClass:function(){var a=this.collection.length;this.collection.each(function(b,c){b.set("hidden",5<a&&
4<=c)});5<a?this.$el.addClass("has-overlay"):this.$el.removeClass("has-overlay")}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/avatar-view.js' */
define("confluence-collaborative-editor-plugin/avatar-view",["backbone","ajs","confluence/templates","jquery"],function(f,d,g,e){return f.View.extend({initialize:function(){this.model.on("remove",this.remove,this)},render:function(){return this.$el=e(g.SynchronyPresence.avatar({title:this._determineTitle(),initial:this.model.get("fullname").charAt(0).toUpperCase(),fullname:this.model.get("fullname"),username:this.model.get("username"),avatarUrl:this.model.get("avatarURL"),origin:this.model.get("origin"),
active:this.model.get("active"),currentUser:this.model.get("currentUser"),telepointer:this._synchronyTelepointerId()}))},remove:function(){this.$el.removeClass().addClass("avatar-item animate");this.model.get("hidden")||this.$el.addClass("removing");this.$el.one(this._getSupportedTransition(),function(){e(this).removeClass("animate removing");e(this).remove()})},_determineTitle:function(){if(this.model.get("currentUser")){var a=["It\u0027s you, but smaller!","Look at you, getting stuff done!"];
return a[Math.floor(Math.random()*a.length)]}return this.model.get("fullname")+" "+(this.model.get("active")?"is editing this page.":"has made changes that haven\u0027t been published.")},_getSupportedTransition:function(){var a={transition:"transitionend",MozTransition:"transitionend",OTransition:"oTransitionEnd",MsTransition:"msTransitionEnd",WebkitTransition:"webkitTransitionEnd"},b=document.createElement("_"),c;for(c in a)if(void 0!==b.style[c])return a[c]},_synchronyTelepointerId:function(){for(var a=
""+(this.model.get("sub")||this.model.get("origin")||""),b=0,c=0;c<a.length;c++)b=(b<<5)-b+a.charCodeAt(c),b&=b;return Math.abs(b)%10}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/overlay-view.js' */
define("confluence-collaborative-editor-plugin/overlay-view","backbone aui/inline-dialog2 confluence-collaborative-editor-plugin/avatar-view confluence/templates ajs jquery underscore".split(" "),function(d,h,e,f,g,a,k){return d.View.extend({initialize:function(){this.collection.on("add remove",this.reconcile,this);this.inlineDialog2=document.querySelector("#more-avatars")},render:function(){this.$el=a(f.SynchronyPresence.overlay());this.$el.children("a").tooltip({fade:!0,gravity:"ne"});this.$el.on("click",
function(){a(".tipsy").remove()});return this.$el},reconcile:function(){var b=this.collection.where({hidden:!0});0<b.length?(this.$el.addClass("show"),this.$el.children(".aui-button").html("+"+b.length).attr("title",b.length+" "+"other users are editing."),a("#more-avatars-list").children().remove(),b.forEach(function(c){c=new e({model:c});a("#more-avatars-list").append(c.render())})):(this.$el.removeClass("show"),this.hideInlineDialog())},hideInlineDialog:function(){this.inlineDialog2&&
this.inlineDialog2.isVisible&&this.inlineDialog2.isVisible()&&(this.inlineDialog2.open=!1)}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/template/status-indicator.soy' */
// This file was automatically generated from status-indicator.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.CollaborativeEditor.StatusIndicator.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.CollaborativeEditor == 'undefined') { Confluence.Templates.CollaborativeEditor = {}; }
if (typeof Confluence.Templates.CollaborativeEditor.StatusIndicator == 'undefined') { Confluence.Templates.CollaborativeEditor.StatusIndicator = {}; }


Confluence.Templates.CollaborativeEditor.StatusIndicator.container = function(opt_data, opt_ignored) {
  return '<div class="synchrony-status-indicator"><div class="status-indicator-icon aui-icon aui-icon-small' + ((opt_data.error) ? ' aui-iconfont-warning' : (opt_data.saving) ? ' aui-iconfont-devtools-task-in-progress' : ' aui-iconfont-approve') + '" data-tooltip="' + soy.$$escapeHtml(opt_data.tooltipMessage) + '"></div><div class="status-indicator-message" data-tooltip="' + soy.$$escapeHtml(opt_data.tooltipMessage) + '">' + soy.$$escapeHtml(opt_data.statusMessage) + '</div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.CollaborativeEditor.StatusIndicator.container.soyTemplateName = 'Confluence.Templates.CollaborativeEditor.StatusIndicator.container';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/status-indicator-view.js' */
define("confluence-collaborative-editor-plugin/status-indicator-view",["confluence/templates","backbone","ajs","jquery","underscore"],function(f,g,c,h,d){return g.View.extend({initialize:function(){this.$el.addClass("synchrony");this.listenTo(this.model,"change:saving change:error",this.render);this.model.set("confluenceUnreachable",!1);this.model.set("synchronyUnreachable",!1);this.model.set("tokenExpired",!1);c.bind("rte.heartbeat",d.bind(this.onConfluenceConnectedState,this));c.bind("rte.safe-save.error",
d.bind(this._errorPublishing,this));c.bind("rte.preview.error",d.bind(this._errorPublishing,this));this.model.set("connecting",!0);this._setProgressState()},render:function(){h(".tipsy").remove();this.$el.html(f.CollaborativeEditor.StatusIndicator.container(this.model.attributes))},onConnectedState:function(a){this.model.set("synchronyUnreachable",!1);if(!this.model.has("synchronyEntity")){this.model.set("synchronyEntity",a);var b=this;this.model.get("synchronyEntity").on("update",function(e){b._handleSynchronyUpdateEvent(e,
b)});this.model.get("synchronyEntity").on("ack",function(e){b._handleSynchronyAckEvent(e,b)})}this._setSavedState()},onDisconnectedState:function(){this.model.set("synchronyUnreachable",!0);this.model.set("connecting",!0);this._setErrorState()},onConfluenceConnectedState:function(){this.model.get("confluenceUnreachable")&&(this.model.set("confluenceUnreachable",!1),this._setSavedState())},onConfluenceDisconnectedState:function(){this.model.set("confluenceUnreachable",!0);this.model.set("connecting",
!0);this._setErrorState()},onTokenRenewedState:function(){this.model.get("tokenExpired")&&(this.model.set("tokenExpired",!1),this._setSavedState())},onTokenExpiredState:function(){this.model.set("tokenExpired",!0);this.model.set("connecting",!0);this._setErrorState()},_handleSynchronyUpdateEvent:function(a,b){"local"===a.updateType&&(b.model.set("pendingChanges",!0),b._saving())},_handleSynchronyAckEvent:function(a,b){a=0<a.pending.length;b.model.set("pendingChanges",a);a||b.model.set("lastSavedTime",
(new Date).getTime())},_saving:function(){var a=this,b=function(){setTimeout(function(){a.model.get("pendingChanges")||(new Date).getTime()-a.model.get("lastSavedTime")<a.model.get("minActiveTime")?b():a._setSavedState()},a.model.get("minActiveTime"))};this.model.get("saving")||(this.model.set("connecting",!1),this._setProgressState(),b())},_reachable:function(){return!this.model.get("confluenceUnreachable")&&!this.model.get("synchronyUnreachable")&&!this.model.get("tokenExpired")},_errorPublishing:function(a,
b){switch(b.status){case 0:this.onConfluenceDisconnectedState();break;case 500:case 503:this.onConfluenceDisconnectedState()}},_setSavedState:function(){this._reachable()&&"READ_ONLY"!==c.Meta.get("access-mode")?(this.model.set("statusMessage",this.model.get("connecting")?"Ready to go":"Changes saved"),this.model.set("isReadyToGo",!!this.model.get("connecting")),this.model.set("tooltipMessage","We\u0027re automatically saving all of your changes in a draft."),this.model.set("connecting",
!1),this.model.set("saving",!1),this.model.set("error",!1)):this._setErrorState()},_setErrorState:function(){var a="READ_ONLY"!==c.Meta.get("access-mode");this.model.set("statusMessage","Can\u0027t save changes");this.model.set("tooltipMessage",a?"Can\u0027t reach the server. Check your internet connection, and we\u0027ll keep trying to reconnect you.":"This site is read-only. You can\u0027t make changes right now.");this.model.set("saving",!1);this.model.set("error",!0)},_setProgressState:function(){this._reachable()?(this.model.set("statusMessage",
this.model.get("connecting")?"Connecting...":"Saving changes"),this.model.set("tooltipMessage","We\u0027re automatically saving all of your changes in a draft."),this.model.set("saving",!0),this.model.set("error",!1)):this._setErrorState()}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/initialise-metrics.js' */
define("collaborative-editing-initialise-metrics-collection",["confluence/legacy"],function(a){return function(){var b={"confluence.editor":!0,"confluence.editor.preload":!0,"confluence.editor.quick.fetchContent":!0,"confluence.editor.tinymce":!0,"confluence.editor.synchrony":!0,"confluence.editor.synchrony.CR":!0,"confluence.editor.synchrony.connect":!0,"confluence.editor.synchrony.deps":!0,"confluence.editor.synchrony.init":!0,"confluence.editor.synchrony.jsLoad":!0,"confluence.editor.synchrony.snapshot":!0,
"confluence.editor.synchrony.unmarshal":!0},c={"confluence.editor.synchrony.connect":!0};a.registerPerformanceSession&&a.registerPerformanceSession("confluence.editor.quickedit.loading.times",b,c)}});require("confluence/module-exporter").safeRequire("collaborative-editing-initialise-metrics-collection",function(a){a()});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/lib/SyncManager.js' */
define("confluence-collaborative-editor-plugin/lib/SyncManager",["ajs","jquery"],function(e,f){var h=["id"],k={START_SYNCHRONIZING_EVENT_NAME:"start",STOP_SYNCHRONIZING_EVENT_NAME:"stop",MAX_CONSECUTIVE_AUTO_RECOVERY_TRIGGERED:10,MAX_WAIT_TIME_TO_RESTART:3E4,DEBUG_MODE:!1},l=function(a){return h.every(function(b){return"undefined"!==typeof a[b]})},c=function(a,b){this.entity=a;this.settings=f.extend({},k,b||{});this.controlSyncState={};this.recoveryTimeoutTasks={};a=function(d,m,g){l(g)?d(g):this.displayLogMessage("Invalid payload, missing required params",
m,g)};e.bind("synchrony."+this.settings.START_SYNCHRONIZING_EVENT_NAME,a.bind(this,this.enableSynchronization.bind(this)));e.bind("synchrony."+this.settings.STOP_SYNCHRONIZING_EVENT_NAME,a.bind(this,this.disableSynchronization.bind(this)))};c.prototype.getOrCreateControlSyncState=function(a){return this.controlSyncState[a]=this.controlSyncState[a]||{DISABLED_SYNC_STATUS:!1,RECOVERY_TIMER_RUNNING:!1,CONSECUTIVE_AUTO_RECOVERY_TRIGGERED:0}};c.prototype.enableDebug=function(a){this.settings.DEBUG_MODE=
"undefined"!==typeof a?a:!0};c.prototype.displayLogMessage=function(){if(this.settings.DEBUG_MODE){var a=Array.prototype.slice.call(arguments);a.splice(0,0,"DEBUG: "+(new Date).toLocaleTimeString());console.log.apply(console,a)}};c.prototype.disableSynchronization=function(a){var b=a.id;this.getOrCreateControlSyncState(b).DISABLED_SYNC_STATUS=!0;this.clearAutoRecoveryTimer(b);this.setAutoRecoveryTimer(a);this.entity.stop(b);this.displayLogMessage("Stoping entity synchronization",b,f.extend(!0,{},
this.controlSyncState))};c.prototype.enableSynchronization=function(a){a=a.id;this.getOrCreateControlSyncState(a).DISABLED_SYNC_STATUS=!1;this.clearAutoRecoveryTimer(a);this.entity.start(a);this.displayLogMessage("Starting entity synchronization",a,f.extend(!0,{},this.controlSyncState))};c.prototype.clearAutoRecoveryTimer=function(a){var b=this.getOrCreateControlSyncState(a);clearTimeout(this.recoveryTimeoutTasks[a]);delete this.recoveryTimeoutTasks[a];b.RECOVERY_TIMER_RUNNING=!1};c.prototype.setAutoRecoveryTimer=
function(a){var b=a.id,d=this.getOrCreateControlSyncState(b);d.RECOVERY_TIMER_RUNNING=!0;this.recoveryTimeoutTasks[b]=setTimeout(function(){this.displayLogMessage("Auto recovery has been triggered",b);this.clearAutoRecoveryTimer(b);d.DISABLED_SYNC_STATUS=!1;d.RECOVERY_TIMER_RUNNING=!1;d.CONSECUTIVE_AUTO_RECOVERY_TRIGGERED++;e.trigger("analyticsEvent",{name:"confluence.synchrony.syncmanager.failed-to-restart",data:{id:b}});d.CONSECUTIVE_AUTO_RECOVERY_TRIGGERED>=this.settings.MAX_CONSECUTIVE_AUTO_RECOVERY_TRIGGERED&&
(this.displayLogMessage("Auto recovery has been triggered too many times for the same action",b,this.controlSyncState[b].CONSECUTIVE_AUTO_RECOVERY_TRIGGERED),e.trigger("analyticsEvent",{name:"confluence.synchrony.syncmanager.consecutive-failed-to-restart",data:{id:b}}));this.entity.start(b)}.bind(this),a.maxWaitTimeToRestart||this.settings.MAX_WAIT_TIME_TO_RESTART)};return c});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/telepointer-cleaner.js' */
define("confluence-collaborative-editor-plugin/telepointer-cleaner",["confluence-editor-reliable-save/reliable-save","jquery"],function(b,c){b.registerCleanupFunction(function(d){var a=c("\x3cdiv\x3e");a.append(d);a.find(".synchrony-container, .synchrony-tp").remove();return a.html()})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/editor-blanket.js' */
define("confluence-collaborative-editor-plugin/editor-blanket",["ajs","jquery","confluence/meta","confluence-editor/support/atlassian-editor-support"],function(l,a,m,h){var c,d;function f(b){switch(b){case "block":c="editor-block";d="aria-disabled";e="";break;default:c="editor-loading editor-loading-spinner",d="aria-busy",e="editor-loading"}b=a("#editpageform, #createpageform");b.addClass(c);b.attr(d,!0);a("#content-title").attr("tabindex",-1);a("#wysiwygTextarea_ifr").attr("tabindex",-1);a(".aui-toolbar2-primary").addClass(e)}
function k(){var b=a("#editpageform, #createpageform");b.removeClass(c);b.attr(d,!1);a("#rte").css("opacity",1).addClass("editor-blanket-ease-in");a("#content-title").attr("tabindex",1);a("#wysiwygTextarea_ifr").attr("tabindex",100);a("#content-title-div").css("opacity",1).addClass("editor-blanket-ease-in");a(".aui-toolbar2-primary").removeClass(e);e=d=c=void 0}function g(){a("#rte").css("opacity",1);a("#content-title-div").css("opacity",1)}var e=d=c=void 0;return{applyBlanket:function(b){h.isCollaborativeContentType()&&
"pending"===b.state()?(f(),b.done(k)):g()},showEditor:g,showBlanket:f}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/synchrony-auth.js' */
define("confluence-collaborative-editor-plugin/synchrony-auth",["jquery","ajs","confluence/meta","confluence/legacy","confluence-collaborative-editor-plugin/synchrony-util"],function(l,d,m,n,f){function p(c,a){f.time("confluence.editor.synchrony.token");var b=a&&a.errorType?"?errorType\x3d"+a.errorType:"";l.ajax({dataType:"json",method:"GET",url:encodeURI(d.contextPath()+"/rest/synchrony/1.0/token/"+n.getContentId()+"/generate"+b)}).done(function(g){m.set("synchrony-token",g.synchronyToken);m.set("synchrony-expiry",
g.synchronyExpiry);h=0;c.resolve(g.synchronyToken);e&&(e.onConfluenceConnectedState(),e.onTokenRenewedState());d.trigger("dismiss.editor.error.message",{messageKey:"synchrony-token-expired",enablePublish:!0});d.debug("Synchrony JWT token updated.");f.timeEnd("confluence.editor.synchrony.token")}).fail(function(){h++;10<=h&&d.trigger("editor.error.message",{messageKey:"synchrony-token-expired",message:"We couldn\u0027t process your request, as it was missing a required security token. Copy your work, then re-submit the form or reload the page.",disablePublish:!0});e&&(e.onConfluenceDisconnectedState(),
e.onTokenExpiredState());d.log(a?a.message:"Confluence failed to renew JWT token.");c.reject("token")})}function k(c){var a=l.Deferred(),b;if(b=!c)b=parseInt(f.retrieveMetadata("synchrony-expiry")),b=isNaN(b)?!1:b>Date.now()/1E3;b?a.resolve(f.retrieveMetadata("synchrony-token")):(d.log("["+new Date+"] Synchrony JWT expired or invalid, retrieving new token."),p(a,c));return a.promise()}var e,h=0;return{init:function(c){e=c},performRequest:function(c){return k().pipe(c).pipe(function(a){var b="error"===
a[1]&&a[0].responseText?JSON.parse(a[0].responseText):a[0];return"error"===a[1]&&b.type&&b.type.match(/^jwt\//)?k({errorType:b.type,message:b.message}).pipe(c):a})},getTokenPromise:k}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/unsupported-extension.js' */
define("confluence-collaborative-editor-plugin/unsupported-extension","ajs jquery confluence/legacy confluence-editor/editor/page-editor-message window confluence-collaborative-editor-plugin/editor-blanket".split(" "),function(a,c,d,e,f,g){function h(){var b=a.Rte.getEditor().getBody();b.hasAttribute("data-gramm")&&b.hasAttribute("data-gramm_id")&&(a.trigger("synchrony.stop",{id:"confluence.editor.block.by.grammarly",maxWaitTimeToRestart:31536E6}),a.trigger("analyticsEvent",{name:"confluence.synchrony.editor.grammarly.block"}),
b.setAttribute("contentEditable",!1),c(b).find(".contentLayout2 .innerCell").each(function(){this.setAttribute("contentEditable",!1)}),g.showBlanket("block"),d.Editor.UI.setButtonsState(!1,d.Editor.UI.buttons),e.handleMessage("collaborative-editor-unsupported-extension",{type:"error",title:"Grammarly isn\u0027t supported",message:a.format("The Grammarly extension doesn\u0027\u0027t play well with collaborative editing. Disable it and \u003ca {0}\u003ereload the page\u003c/a\u003e to keep working.",'href\x3d"#" id\x3d"collabGrammarlyReload"')}),c("#collabGrammarlyReload").click(function(){a.trigger("analyticsEvent",
{name:"confluence.synchrony.editor.grammarly.reload.click"});f.location.reload();return!1}),a.trigger("synchrony-unsupported-extension"))}return{check:function(){h()}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/synchrony-entity.js' */
define("confluence-collaborative-editor-plugin/synchrony-entity","jquery ajs confluence-collaborative-editor-plugin/synchrony-auth confluence-collaborative-editor-plugin/synchrony-util confluence-collaborative-editor-plugin/unsupported-extension confluence-collaborative-editor-plugin/util/is-valid-uri".split(" "),function(g,h,n,k,p,q){function l(b){return function(d){return null===d||b.test(d)}}function m(b){var d=l(/^[\w\.\-\+%]+$/i),e=l(/^[\w-]+$/),f=l(/^data:image\/png;base64,([\w+\/%\-]+)=*$/),
c=b.whitelists.tinymce.attributes.src;return g.extend({},b.whitelists.tinymce,{styles:g.extend({},b.whitelists.tinymce.styles,{"padding-top":!1,"padding-right":!1,"padding-bottom":!1,"padding-left":!1,padding:!1,display:d,"list-style-type":d}),attributes:g.extend({},b.whitelists.tinymce.attributes,{"confluence-query-params":!0,"data-element-title":!0,"data-ref":!0,accesskey:!0,datetime:!0,"data-anchor":!0,"data-encoded-xml":!0,"data-highlight-class":!0,"data-highlight-colour":!0,"data-space-key":!0,
"data-username":!0,"data-emoticon-name":e,"data-hipchat-emoticon":e,"data-entity-id":!0,"data-entity-type":!0,"data-favourites-bound":!0,"data-macro-id":!0,"data-macro-name":!0,"data-macro-schema-version":!0,"data-macro-body-type":!0,"data-macro-parameters":!0,"data-macro-default-parameter":!0,"data-atlassian-layout":!0,"data-placeholder-type":!0,"data-layout":!0,"data-title":!0,"data-type":!0,"data-inline-task-id":!0,"data-inline-tasks-content-id":!0,"data-base-url":!0,"data-linked-resource-id":!0,
"data-linked-resource-type":!0,"data-linked-resource-version":!0,"data-linked-resource-default-alias":!0,"data-linked-resource-container-version":!0,"data-linked-resource-content-type":!0,"data-unresolved-comment-count":!0,"data-location":!0,"data-image-height":!0,"data-image-width":!0,"data-attachment-copy":!0,"data-content-title":!0,"data-snooker-locked-cols":!0,"data-snooker-col-series":!0,"data-mce-resize":!0,"data-filename":!0,username:!0,src:function(a){return f(a)||c(a)},href:q}),classes:function(a){switch(a){case "mceSelected":case "active-resizable":return!1;
default:return!0}},elements:g.extend({},b.whitelists.tinymce.elements,{time:!0,mark:!0,label:!0,form:!0})})}function r(b,d,e){var f=m(b);return{profile:"tinymce",selectionCorrections:!1,telepointer:{refreshOnResize:!0,label:{hover:!0,movement:1E3,text:function(c){try{return(c.fullname||"Anonymous").charAt(0).toUpperCase()}catch(a){h.log(a)}return"\x26#9786;"}}},tinymce:{monkeyPatchUndoManager:!0,instance:d},whitelist:function(c){var a=c.domNode,t="node"===c.type,u="attribute"===
c.type&&"data-title"===c.name;if(a===e)return t||u;a=a&&a.classList.contains("numberingColumn")&&("TD"===a.nodeName||"TH"===a.nodeName);return"attribute"===c.type&&"contenteditable"===c.name&&a?!0:b.isWhitelisted(f,c)},domReadHook:function(){h.trigger("cursor-target-refresh");p.check()}}}return{bind:function(b,d,e,f,c){return b.entity({url:k.getServiceUrl(),entityId:k.getEntityId(),jwt:n.getTokenPromise,initRev:c.confRev,history:f,presence:!0,useFallback:k.getXhrFallbackFlag()}).bind(e,r(b,d,e))},
makeWhitelist:m}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/util/url-parser.js' */
define("confluence-collaborative-editor-plugin/util/url-parser",["window"],function(b){return{parseUrl:function(c){var a=b.document.createElement("a");a.href=c;return{protocol:a.protocol.replace(":",""),hostname:a.hostname,port:a.port,pathname:"/"===a.pathname?"":a.pathname,search:a.search,hash:a.hash.substr(a.hash.indexOf("#")+1,a.hash.length),host:a.host}}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/util/location-provider.js' */
define("confluence-collaborative-editor-plugin/util/location-provider",["window"],function(a){return{getLocation:function(){return a.location}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/util/editor-format-fixer.js' */
define("confluence-collaborative-editor-plugin/util/editor-format-fixer",["underscore","confluence/meta","confluence-collaborative-editor-plugin/util/url-parser"],function(q,p,k){var r=function(a){a=a.querySelectorAll("a[data-linked-resource-id][data-linked-resource-type\x3d'userinfo'][userkey]");Array.prototype.forEach.call(a,function(n){n.removeAttribute("data-linked-resource-id")});return a.length};return{fixStaleBaseUrl:function(a){var n=0;for(var l=p.get("base-url"),f=k.parseUrl(l),g=a.querySelectorAll("img[data-base-url]"),
h=0;h<g.length;h++){var b=g[h],c=k.parseUrl(b.attributes["data-base-url"].value);if(!q.isEqual(c,f)){var d=b.attributes.src.value,e=b.attributes["data-image-src"].value.replace(c.pathname,f.pathname);c=d.replace(c.pathname,f.pathname);b.setAttribute("data-base-url",l);b.setAttribute("data-image-src",e);b.setAttribute("src",c);n++}}l=0;f=k.parseUrl(p.get("base-url"));g=a.querySelectorAll("img[data-macro-name\x3d'view-file']");for(h=0;h<g.length;h++)for(b=g[h],e=b.attributes.src.value,c=["/rest/documentConversion/latest/",
"/plugins/servlet/confluence/placeholder/unknown-attachment?"],d=0;d<c.length;d++){var m=e.indexOf(c[d]);-1!=m&&e.substr(0,m)!==f.pathname&&(m=f.pathname+e.substr(m),b.setAttribute("src",m),l++)}f=0;g=p.get("base-url");h=k.parseUrl(g);a=a.querySelectorAll("a[data-base-url][href][data-linked-resource-type\x3d'page'],a[data-base-url][href][data-linked-resource-type\x3d'blogpost'],a[data-base-url][href][data-linked-resource-type\x3d'comment'],a[data-base-url][href][data-linked-resource-type\x3d'space'],a[data-base-url][href][data-linked-resource-type\x3d'attachment'],a[data-base-url][href][data-linked-resource-type\x3d'custom']");
for(b=0;b<a.length;b++)e=a[b],c=k.parseUrl(e.attributes["data-base-url"].value),q.isEqual(c,h)||(d=k.parseUrl(e.attributes.href.value),c=g+d.pathname.replace(c.pathname,"")+d.search+(d.hash?"#"+d.hash:""),e.setAttribute("data-base-url",g),e.setAttribute("href",c),f++);return n+l+f},fixMentions:function(a){return r(a)}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/synchrony-handlers.js' */
define("confluence-collaborative-editor-plugin/synchrony-handlers","underscore jquery ajs confluence/meta confluence/analytics-support confluence/legacy confluence-editor/editor/page-editor-message confluence-collaborative-editor-plugin/lib/SyncManager confluence-collaborative-editor-plugin/synchrony-util confluence-collaborative-editor-plugin/synchrony-content confluence-collaborative-editor-plugin/synchrony-presence confluence-collaborative-editor-plugin/util/location-provider confluence-collaborative-editor-plugin/util/url-parser confluence-collaborative-editor-plugin/util/editor-format-fixer confluence-collaborative-editor-plugin/editor-blanket confluence/api/event window".split(" "),
function(I,k,f,g,J,p,z,K,l,m,L,M,y,A,N,c,q){function B(a,b){b.contributors&&(C=b.contributors,c.unbind(a,B))}function O(a){w=!0;u.val(a.rev.toString())}function P(a){u.val(a.rev.toString());c.trigger("synchrony.entity.ack",{pendingChanges:0<a.pending.length})}function Q(){v.onDisconnectedState();f.log("Synchrony disconnected!")}function R(a){if("null/no-such-sequence"===a.errorType||"null/entity-evicted"===a.errorType||"hub.error/locked"===a.errorType){c.trigger("analyticsEvent",{name:"confluence.editor.data.evicted.error",
data:{errorType:a.errorType,onLoad:!w,afterReload:null!==q.sessionStorage.getItem(x())}});e.destroy();c.trigger("synchrony.history.evicted");a=null===q.sessionStorage.getItem(x());var b=w?"\u003cb\u003eWe couldnt sync your changes\u003c/b\u003e\u003cbr/\u003eCopy the changes you want to keep, then refresh the page to continue editing.":a?"Reloading this page to get it back in sync.":"\u003cb\u003eIts taking a while to sync this page\u003c/b\u003e\u003cbr/\u003eGive it a minute, then refresh the page to start editing. Contact your Confluence admin if this keeps happening.";c.trigger("editor.error.message",{disablePublish:!0,close:"never",message:b});if(w)v.onDisconnectedState();
else N.showBlanket("block"),a&&(q.sessionStorage.setItem(x(),"false"),q.location.reload());S()}else"fatal"===a.level&&c.trigger("editor.error.message",{disablePublish:!0})}function S(){q.onerror=function(a,b,d,r,t){if(!(b||d||r||t)){if(D)return!0;D=!0}else if(t&&t.message&&"entity destroyed"===t.message)return!0;return!1}}function x(){return"_reload_for_"+g.get("draft-id")}function T(a){l.timeEnd("confluence.editor.synchrony.connect");f.log("Synchrony connected.");L.appendTo(a.sid,e,C);v.onConnectedState(e);
c.trigger("synchrony.connected");m.fixTinymceCaretContainer(n,h);q.sessionStorage.removeItem(x())}function E(a,b,d){return{origin:"synchrony",cause:a,messageKey:b,disablePublish:d}}function U(a){function b(r){r.pending.length||(e.off("ack",b),u.val(r.rev.toString()),d.resolve(a))}var d=k.Deferred();e.ackState().pending.length?(e.on("ack",b),setTimeout(function(){e.off("ack",b);d.reject(E("timeout"))},5E3)):d.resolve(a);return k.when(d,F).promise()}function G(a){return(a=l.getLatestRevisionWithAttr(a.revisions,
"user"))?a.meta.user:"Anonymous"}function V(a){z.handleMessage("editor.synchrony.page-published",{type:"info",message:f.format("{0} published this page.",f.escapeHtml(a)),close:"auto"});c.trigger("analyticsEvent",{name:"confluence.synchrony.external-changes.publish"});c.trigger("editor-shared-drafts-published")}function W(a){if("remote"===a.updateType){u.val(a.revisions[a.revisions.length-1].rev.toString());l.hasRevisionTrigger(a.revisions,"reset")&&(z.handleMessage("editor.synchrony.revert-page",
{type:"info",message:f.format("{0} reverted to a previous version of this page.",f.escapeHtml(G(a)))}),g.set("has-collaborated",!1),H(),c.trigger("analyticsEvent",{name:"confluence.synchrony.external-changes.revert"}),c.trigger("editor-shared-drafts-discarded"),p.Editor.heartbeat());l.hasRevisionTrigger(a.revisions,"publish")&&(m.isUnpublished()&&(g.set("new-page",!1),g.set("page-id",p.getContentId()),g.set("draft-id","0"),p.Editor.isLimitedModeEnabled()||p.Editor.UI.setButtonState(!0,k("#rte-button-discard"))),
g.set("has-collaborated",!1),H(),V(G(a)),p.Editor.heartbeat());l.hasRevisionType(a.revisions,"external")&&c.trigger("editor.external.change");var b=l.getLatestRevisionWithAttr(a.revisions,"confVersion");b&&b.meta.confVersion&&(k('meta[name\x3d"page-version"]').attr("content",b.meta.confVersion),k('meta[name\x3d"ajs-page-version"]').attr("content",b.meta.confVersion),g.set("page-version",b.meta.confVersion))}setTimeout(function(){if("init"===a.updateType||"remote"===a.updateType)c.trigger("editor.remote.change"),
m.readTitleFromRootElement(n);"init"==a.updateType&&(X(M.getLocation())?h.undoManager.ignore(function(){var d=A.fixStaleBaseUrl(n);0<d&&J.publish("collab.edit.format.stale.fix.count",{staleformatfixed:d})}):f.log("Request url does not match the configured base url. Not performing fixStaleBaseUrl()."),h.undoManager.ignore(function(){A.fixMentions(n)}));m.fixTinymceCaretContainer(n,h);"local"===a.updateType&&(h.undoManager.hasUndo()||h.setDirty(!1),c.trigger("editor.local.change"))},0)}function H(){0===
e.ackState().pending.length&&h.setDirty(!1)}function X(a){var b=g.get("context-path"),d=y.parseUrl(g.get("base-url"));a=y.parseUrl(a);b=y.parseUrl(a.protocol+"://"+a.host+b);return I.isEqual(d,b)}var u,v,h,n,e,F,C=[],w=!1,D=!1;c.bind("editor-heartbeat",B);return{handle:function(a,b,d,r){l.time("confluence.editor.synchrony.connect");e=a;h=b;v=d;F=r.pipe(null,function(t){e.destroy();v.onDisconnectedState();return E(t,"collaborative-editor-load-failure",!0)});u=k("#syncRev");n=h.getBody();e.on("init",
O).on("update",W).on("ack",P).on("connected",T).on("disconnected",Q).on("error",R);new K(e,{DEBUG_MODE:!0});m.bindPostPasteFix();m.readTitleFromRootElement(n);p.Editor.overrideBeforeSave(U);k("#content-title").keyup(m.writeTitleToRootElement)}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/synchrony-editor.js' */
define("confluence-collaborative-editor-plugin/synchrony-editor","window jquery ajs confluence/legacy confluence-collaborative-editor-plugin/editor-blanket confluence-collaborative-editor-plugin/synchrony-util confluence-collaborative-editor-plugin/synchrony-content confluence-collaborative-editor-plugin/synchrony-auth confluence-collaborative-editor-plugin/synchrony-entity confluence-collaborative-editor-plugin/synchrony-handlers confluence-editor/support/atlassian-editor-support confluence-editor/loader/collaborative-helper".split(" "),
function(t,g,d,p,I,f,y,H,J,T,U,V){function z(a){g('meta[name\x3d"ajs-collaborative-editor-status"]').attr("content",a)}function W(){return!d.Rte.isQuickEdit}function X(){var a=g.Deferred();d.$(function(){d.$("body").addClass("synchrony-active");A=new (require("confluence-collaborative-editor-plugin/status-indicator-view"))({el:"#pluggable-status",model:new Backbone.Model({minActiveTime:500})});H.init(A);a.resolve()});return a}function B(a){if(!0!==K){switch(a){case "timeout":a="The editor didn\u0027t load this time";
var b="The connection timed out. If it happens again, speak to your Confluence admin. You may be using a proxy server that prevents WebSocket connections.\u003c/br\u003e\u003ca href=\u0022#\u0022 id=\u0022websocketRetry\u0022\u003eTry again\u003c/a\u003e&nbsp;.&nbsp;\u003ca href=\u0022https://confluence.atlassian.com/display/CONFKB/Confluence+throws+The+editor+didn%27t+load+this+time+error+when+trying+to+edit+a+page\u0022 target=\u0022_blank\u0022 id=\u0022websocketFindmore\u0022\u003eFind out more\u003c/a\u003e";break;case "synchrony-requests":C=!0;a="";b="Something went wrong after loading the editor. Copy your unsaved changes and refresh the page to keep editing.";break;case "limited-mode":C=!0;a="";b="Something went wrong while loading the editor, please try again.";break;default:C=!0,a="",b="This page is taking longer to load than usual. Give it a few moments, then try refreshing. Still having issues? Contact your Confluence admin."}d.trigger("editor.error.message",{title:a,messageKey:"collaborative-editor-load-failure",message:b,disablePublish:!0,close:"manual"})}}
function L(){d.trigger("dismiss.editor.error.message",{messageKey:"collaborative-editor-load-failure",enablePublish:!0})}function M(a,b){var c=g.Deferred();a.done(function(){f.timeEnd(b)},c.resolve);a.fail(c.resolve);return c.promise()}function N(a,b){var c="error"===b[1]&&b[0].responseText?JSON.parse(b[0].responseText):"",e=!1;"invalid-ancestor"===c.type?e="synchrony":"out-of-order-revision"===c.type&&(e="confluence");return e?(d.log("Performing synchrony recovery"),g.ajax({url:d.contextPath()+"/rest/synchrony/1.0/content/"+
p.getContentId()+"/recovery?behind\x3d"+e+"\x26conflictingRev\x3d"+c["conflicting-rev"],type:"PUT"}),"synchrony-requests"):"success"!==b[1]&&"success"!==a[1]||"success"!==b[1]&&"duplicate-mismatch"!==c.type?(d.trigger("analyticsEvent",{name:"confluence.synchrony.client.content.reconciliation.failure",data:{type:c.type,contentId:p.getContentId()}}),"synchrony-requests"):!1}function O(a){return H.performRequest(function(b){f.time("confluence.editor.synchrony.snapshot");return M(g.ajax({type:"POST",
url:encodeURI(f.getServiceUrl()+"/data"+f.getEntityId()+"?state-at\x3d@head\x26state-format\x3dtype-tagged\x26rewrite-request\x3dtrue\x26cached\x3d"+a),contentType:"text/plain",dataType:"json",data:JSON.stringify({headers:{"content-type":"application/json","x-token":b},method:"GET"})}).pipe(f.asArray,f.asArray),"confluence.editor.synchrony.snapshot")})}function Y(a){return a.syncRev||!y.isUnpublished()||0!==a.raw.length&&!/^\s+$/.test(a.raw)?y.isContentEmpty(a.raw)?(d.trigger("analyticsEvent",{name:"confluence.synchrony.client.content.reconciliation.blank-content",
data:{contentId:p.getContentId()}}),g.Deferred().resolve([{},"success"])):H.performRequest(function(b){f.time("confluence.editor.synchrony.CR");return M(g.ajax({type:"POST",url:encodeURI(f.getServiceUrl()+"/data"+f.getEntityId()+"?optimistic\x3dtrue\x26rewrite-request\x3dtrue"),dataType:"json",contentType:"text/plain",data:JSON.stringify({body:{ancestor:a.syncRev,rev:a.confRev,state:{format:"html",value:a.html},merges:{master:{meta:{type:"client-reconciliation"}}}},headers:{"content-type":"application/json",
"x-token":b},method:"PUT"})}).pipe(f.asArray,f.asArray),"confluence.editor.synchrony.CR")}):g.Deferred().resolve([{},"success"])}function Z(a){f.time("confluence.editor.synchrony");g.when(Date.now(),a).pipe(function(b){z("on");var c=Date.now();d.trigger("analyticsEvent",{name:"confluence.synchrony.editor.loaded",data:{durationMillis:c-b,contentId:p.getContentId()}});d.trigger("rte-collab-ready");f.timeEnd("confluence.editor.synchrony");f.timeEnd("confluence.editor")})}function aa(){var a=D("synchrony.connected synchrony.connected.fake");
D("synchrony.connected synchrony.connected.fake synchrony-unsupported-extension",3E4).fail(function(b){B(b);d.trigger("analyticsEvent",{name:"confluence.synchrony.editor.load.timeout",data:{contentId:p.getContentId()}});ba();P=!0;a.done(function(){C||(Q=!0,L())})})}function ca(a,b,c){var e=m._initialiseSynchrony(),l=D("synchrony.connected.fake"),h=D(null);b.pipe(function(){setTimeout(h.reject,3E4,"synchrony-requests")});var q=m._initialiseCollabEditingComponents(h),r=Date.now(),u=null,E=null;d.DarkFeatures.isEnabled("synchrony-pessimistic-snapshot")||
(u=e.pipe(function(){return O(!0)}),u.done(function(k){E=k[1]}));var v=g.when(a,e).pipe(function(){return!u||"rejected"===u.state()||"error"===E||6E5<Date.now()-r?O(!1):u});c.pipe(function(){aa();Z(l);I.applyBlanket(l)});b.pipe(function(k){var F=e.pipe(function(){return Y(k)});v=g.when(v,e).pipe(function(n,w){f.time("confluence.editor.synchrony.unmarshal");var R=n;"success"===n[1]&&(R=[{stateAt:n[0].stateAt,state:w.unmarshal(n[0].state.value)},n[1]]);f.timeEnd("confluence.editor.synchrony.unmarshal");
return R});g.when(v,F).pipe(function(n,w){(n=N(n,w))?h.reject(n):h.resolve()});return d.DarkFeatures.isEnabled("synchrony-pessimistic-CR")||"synchrony-ack"!==k.syncRevSource&&!y.isUnpublished()?g.when(k,c,v,F,q):(d.debug("confluence.editor.synchrony: content up to date, not waiting for CR"),h.fail(B),g.when(k,c,v,[{},"success"],q))}).pipe(function(k,F,n,w){if(!m._bindEditor(k,F,n,w,h))return d.trigger("analyticsEvent",{name:"confluence.synchrony.bind.failure",data:{contentId:p.getContentId()}}),g.Deferred().reject("editor-binding-failed");
l.resolve()}).fail(function(k){c.always(function(){"synchrony-not-enabled"!==k&&(d.log("Failed to load the collaborative editor",k),B(k),d.$(function(){A.onDisconnectedState()}),z("failed"),d.trigger("analyticsEvent",{name:"confluence.synchrony.error",data:{error:k,contentId:p.getContentId()}}))})})}function D(a,b,c){var e=g.Deferred();a&&d.bind(a,function r(h,q){d.debug("confluence.editor.synchrony.event: "+h.type+"."+h.namespace);d.unbind(a,r);e.resolve(q)});b&&setTimeout(e.reject,b,c||"timeout");
return e}function x(a,b,c,e,l){var h=l||g.Deferred();if(f.isEditorInitialised()||b&&f.synchronyReady())return S(h,c);d.bind(a,function E(r,u){d.debug("confluence.editor.event "+r.type+"."+r.namespace);h.always(function(){d.unbind(a,E)});S(h,c,u,e)});return h}function S(a,b,c,e){return f.synchronyReady()?!e||e()?(b=b?b(c):c)&&b.error?a.reject(b.error):a.resolve(b):a:a.reject("synchrony-not-enabled")}function ba(){g("#websocketRetry").on("click",function(){d.trigger("analyticsEvent",{name:"confluence.synchrony.editor.websocket.retry.click"});
t.location.reload();return!1});g("#websocketFindmore").on("click",function(){d.trigger("analyticsEvent",{name:"confluence.synchrony.editor.websocket.findmore.click"})})}var m={};f.time("confluence.editor.synchrony.jsLoad");var A,C=!1,K=!1,Q=!1,P=!1,G;g(t).bind("beforeunload",function(){Q||d.trigger("analyticsEvent",{name:"confluence.synchrony.exit.before.connecting",data:{afterTimeout:P,contentId:p.getContentId()}})});d.bind("synchrony.history.evicted",function(a){K=!0});m._bindEditor=function(a,
b,c,e,l){f.time("confluence.editor.synchrony.init");if(N(c,e))return null;e=g("#syncRev");var h=null;"success"===c[1]&&(c=c[0],h={base:{rev:Synchrony.rev(c.stateAt),state:c.state}},e.val(h.base.rev.toString()));d.log("Synchrony will load with contentId: ",p.getContentId());try{var q=b.getBody();q.setAttribute("data-title",a.title);G=J.bind(Synchrony,b,q,h,a);T.handle(G,b,A,l);d.trigger("editor.remote.change");b.setDirty(!1);f.timeEnd("confluence.editor.synchrony.init");return G}catch(r){return d.logError(r),
null}};m._initialiseCollabEditingComponents=function(a){var b=X();g(t).one("synchrony.connected.fake",function(c){"connected.fake"===c.namespace&&(b.resolve(),a.resolve(),L(),z("fake"))});return b};m._initialiseSynchrony=function(){f.time("confluence.editor.synchrony.deps");(function(b){var c=b.Synchrony=b.Synchrony||{};if(!c.ready){var e=c._cbs=c._cbs||[];c.ready=function(q){e.push(q)}}var l=function(){1===c.state&&(c.SockJS=b.SockJS,c.init())};if(b.SockJS)c.init&&l();else{var h=b._sockjs_onload;
b._sockjs_onload=function(){l();h&&h.apply(this,arguments)}}})(t);var a=g.Deferred();Synchrony.ready(a.resolve);return g.when(a.promise(),f.loadScript(["/js/vendor/sockjs.min.js","/js/synchrony.min.js"])).pipe(function(b){f.timeEnd("confluence.editor.synchrony.deps");d.log("Synchrony successfully initialised.");return b})};m.init=function(){if(U.isCollaborativeContentType()){var a=x("rte-quick-edit-init rte-collaborative-content-ready rte-initial-raw-content-ready",!0),b=x("rte-quick-edit-init rte-collaborative-content-ready rte-initial-raw-content-ready rte-collab-editor-loaded",
!1),c=x("rte-collaborative-content-ready rte-initial-raw-content-ready",!1,y.getContent),e=x("rte-collab-editor-loaded",!1,d.Rte.getEditor);e=x("rte-ready rte-begin-collab-editing",!1,d.Rte.getEditor,W,e);a.pipe(function(){ca(b.promise(),c.promise(),e.promise())});c.fail(B);d.trigger("synchrony-events-bound");e.fail(function(l){"synchrony-not-enabled"===l&&(I.showEditor(),z("off"),d.log("Synchrony is not available in this context."))})}};m.register=function(){V.registerPlugin(m)};m.getSynchronisedEditorContent=
function(){var a=G.ackState();if(a.rev){var b=Synchrony.makeDom(a.state,{document,whitelist:J.makeWhitelist(Synchrony)});return{content:require("tinymce").activeEditor.serializer.serialize(b),syncRev:a.rev.toString()}}d.logError("Synchrony hasn't acked any data, can't fetch draft data");return null};f.timeEnd("confluence.editor.synchrony.jsLoad");return m});require("confluence/module-exporter").safeRequire("confluence-collaborative-editor-plugin/synchrony-editor",function(t){t.register();t.init()});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:trigger', location = '/includes/js/trigger.js' */
define("confluence/trigger",["jquery","window"],function(b,c){return function(a,d){a=new b.Event(a);b(d||c.top.document).trigger(a);return!a.isDefaultPrevented()}});require("confluence/module-exporter").exportModuleAsGlobal("confluence/trigger","AJS.jiraTrigger");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:keyboard', location = '/includes/js/api/keyboard.js' */
define("confluence/api/keyboard",["jquery"],function(f){function b(a,b,c){h[b]=a;i[a]=b;c&&(j[b]=!0);return a}function g(a){a=a.originalEvent||a;return null==a.which?a.keyCode:0!==a.which&&0!==a.charCode?a.which:null}function k(a){var a=a.originalEvent||a,b=e.specialKeyEntered(a);if(b)return b;if(f.browser.mozilla){if("keypress"===a.type&&(a=g(a),null!==a))return String.fromCharCode(a).toLowerCase()}else if("keypress"!==a.type)return String.fromCharCode(a.keyCode).toLowerCase()}var e={},h={},i={},
j={},c=e.SpecialKey={BACKSPACE:b("backspace",8,!0),TAB:b("tab",9,!0),RETURN:b("return",13,!0),SHIFT:b("shift",16),CTRL:b("ctrl",17),ALT:b("alt",18),PAUSE:b("pause",19),CAPS_LOCK:b("capslock",20),ESC:b("esc",27,!0),SPACE:b("space",32,!0),PAGE_UP:b("pageup",33),PAGE_DOWN:b("pagedown",34),END:b("end",35),HOME:b("home",36),LEFT:b("left",37),UP:b("up",38),RIGHT:b("right",39),DOWN:b("down",40),INSERT:b("insert",45),DELETE:b("del",46),F1:b("f1",112),F2:b("f2",113),F3:b("f3",114),F4:b("f4",115),F5:b("f5",
116),F6:b("f6",117),F7:b("f7",118),F8:b("f8",119),F9:b("f9",120),F10:b("f10",121),F11:b("f11",122),F12:b("f12",123),NUMLOCK:b("numlock",144),SCROLL:b("scroll",145),META:b("meta",224)};c.eventType=function(){return f.browser.mozilla?"keypress":"keydown"};c.fromKeyCode=function(a){return h[a]};c.toKeyCode=function(a){return i[a]};c.isAscii=function(a){return!!j[a]};c.isSpecialKey=function(a){return!!c.toKeyCode(a)};e.characterEntered=function(a){a=a.originalEvent||a;if("keypress"===a.type&&(a=g(a),
null!==a&&(!c.isAscii(a)||c.fromKeyCode(a)===c.SPACE)))return String.fromCharCode(a)};e.specialKeyEntered=function(a){a=a.originalEvent||a;if(f.browser.mozilla){if("keypress"===a.type){var b=g(a);if(null===b)return c.fromKeyCode(a.keyCode);if(c.isAscii(b))return c.fromKeyCode(b)}}else if("keypress"!==a.type)return c.fromKeyCode(a.keyCode)};e.shortcutEntered=function(a){a=a.originalEvent||a;if(a.type===e.SpecialKey.eventType()){var b=e.specialKeyEntered(a),d="";a.altKey&&b!==c.ALT&&(d+=c.ALT+"+");
a.ctrlKey&&b!==c.CTRL&&(d+=c.CTRL+"+");a.metaKey&&(!a.ctrlKey&&b!==c.META)&&(d+=c.META+"+");a.shiftKey&&b!==c.SHIFT&&(d+=c.SHIFT+"+");if(b)return d+b;if(0<d.length&&"shift+"!==d&&(a=k(a)))return d+a}};return e});require("confluence/module-exporter").exportModuleAsGlobal("confluence/api/keyboard","AJS.Keyboard");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:jira-controls', location = '/includes/js/class.js' */
define("confluence/class",["jquery"],function(f){var j=function(d){var a=function(){};a.prototype=d;return new a},i=!1,l=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/,k=function(){};k.extend=function(){function d(){!i&&this.init&&this.init.apply(this,arguments)}var a,g=this.prototype;if(1<arguments.length){var c=f.makeArray(arguments);a=c.pop();var h;f.each(c,function(b,a){h=h?h.extend(a):a});return h.extend(this.prototype).extend(a)}a=arguments[0];i=!0;c=new this;i=!1;for(var b in a)if(c[b]="function"===
typeof a[b]&&"function"===typeof g[b]&&l.test(a[b]))c[b]=function(a,b){return function(){var c=this._super;this._super=g[a];var d=b.apply(this,arguments);this._super=c;return d}}(b,a[b]);else if("object"===typeof g[b]){var e=j(a[b]);f.each(g[b],function(a,b){if(e[a]){if("object"===typeof e[a]){var c=j(e[a]);f.each(b,function(a,b){c[a]||(c[a]=b)});e[a]=c}}else e[a]=b});c[b]=e}else c[b]=a[b];d.prototype=c;d.constructor=d;d.extend=arguments.callee;return d};return k});
require("confluence/module-exporter").exportModuleAsGlobal("confluence/class","Class");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:jira-controls', location = '/includes/js/control.js' */
define("confluence/control","confluence/class confluence/trigger confluence/api/logger confluence/api/keyboard jquery document".split(" "),function(k,l,i,g,d,e){return k.extend({INVALID:"INVALID",_throwReadOnlyError:function(a){Error(this.CLASS_SIGNATURE+": Sorry ["+a+"] is a read-only property")},_assignEvents:function(a,b){this._unassignEvents(a,b);if(typeof b==="string")for(var c in this._events[a])d(e).delegate(b,c,this._getDispatcher(a,c));else{b=d(b);for(c in this._events[a]){b.bind(c,this._getDispatcher(a,
c));i.debug("Control bound eventType '"+c+"' for group '"+a+"' on target '"+(b[0].type||b[0])+"'")}}},_unassignEvents:function(a,b){if(typeof b==="string")for(var c in this._events[a])d(e).undelegate(b,c,this._getDispatcher(a,c));else{b=d(b);try{for(c in this._events[a])b.unbind(c,this._getDispatcher(a,c))}catch(g){var f=d._data(b[0],"events");if(f)for(c in f)if(c in this._events[a]){for(var m=this._getDispatcher(a,c),j=f[c],h=0;h<j.length;h++)if(j[h]===m){j.splice(h,1);break}i.debug("Control unbound eventType '"+
c+"' for group '"+a+"' on target '"+(b[0].type||b[0])+"'")}}}},_getDispatcher:function(a,b){var c=a+"/"+b;if(!this._dispatchers)this._dispatchers={};if(!this._dispatchers[c]){var e=this._events[a][b],f=this;this._dispatchers[c]=function(c){i.debug("Control dispatching eventType '"+b+"' for group '"+a+"' on instance '"+f.type+"'");return e.call(f,c,d(this))}}return this._dispatchers[c]},_isValidInput:function(){return true},_handleKeyEvent:function(a){if(this._isValidInput(a)){var b=g.SpecialKey,c=
g.shortcutEntered(a);if(c){if(this.keys[c]){this.keys[c].call(this,a);return}if((c===b.BACKSPACE||c===b.DELETE)&&this.keys.onEdit){this.keys.onEdit.call(this,a);return}}(b=g.characterEntered(a))&&this.keys.onEdit&&this.keys.onEdit.call(this,a,b)}},getCustomEventName:function(a){return(this.CLASS_SIGNATURE||"")+"_"+a},_getCustomEventArgs:function(){return[this]},trigger:function(a){return l(a,this)},_supportsBoxShadow:function(){var a=e.body.style;return a.WebkitBoxShadow!==void 0||a.MozBoxShadow!==
void 0||a.boxShadow!==void 0},_setOptions:function(a){var b,c,a=a||{};if(a instanceof d||typeof a==="string"||typeof a==="object"&&a.nodeName)a={element:a};b=d(a.element);c=b.getOptionsFromAttributes();this.options=d.extend(true,this._getDefaultOptions(a),c,a);if(b.length===0)return this.INVALID},getCaret:function(a){var b=a.selectionStart;if(b>=0)return a.selectionEnd>b?-1:b;if(e.selection){b=e.selection.createRange();if(b.text.length===0){var c=b.duplicate();c.moveToElementText(a);c.setEndPoint("EndToStart",
b);return c.text.length}}return-1},_render:function(){var a,b=arguments[0],c=[];for(a=1;a<arguments.length;a++)c.push(arguments[a]);return this._renders[b].apply(this,c)}})});require("confluence/module-exporter").exportModuleAsGlobal("confluence/control","AJS.Control");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:jira-controls', location = '/includes/js/api/mouse.js' */
define("confluence/api/mouse",["jquery","window"],function(d,e){var b={MotionDetector:function(){this.reset()}};b.MotionDetector.prototype.reset=function(){this._y=this._x=this._handler=null;this.moved=!1};b.MotionDetector.prototype.wait=function(b){var a=this;a._handler||(this.reset(),d(e.top.document).bind("mousemove",a._handler=function(c){!a._x&&!a._y?(a._x=c.pageX,a._y=c.pageY):c.pageX===a._x&&c.pageY===a._y||(a.unbind(),a.moved=!0,b&&b.call(this,c))}))};b.MotionDetector.prototype.unbind=function(){this._handler&&
(d(e.top.document).unbind("mousemove",this._handler),this.reset())};return b});require("confluence/module-exporter").exportModuleAsGlobal("confluence/api/mouse","AJS.Mouse");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:jira-controls', location = '/includes/js/group.js' */
define("confluence/group",["confluence/control","confluence/api/logger","jquery"],function(d,e,c){return d.extend({init:function(){this.type=this.type||"Group";this.items=[];this.index=-1;this._assignEvents("instance",this)},addItem:function(a){this.items.push(a);this._assignEvents("item",a)},removeItem:function(a){var b=c.inArray(a,this.items);if(0>b)throw Error("Group: item ["+a+"] is not a member of this group");a.trigger("blur");b<this.index&&this.index--;this.items.splice(b,1);this._unassignEvents("item",
a)},removeAllItems:function(){for(var a=0;a<this.items.length;a++)this._unassignEvents("item",this.items[a]),this.items[a].trigger("blur");this.index=-1;this.items.length=0;this._unassignEvents("keys",document)},shiftFocus:function(a){e.debug("Group.shiftFocus called with offset: "+a);-1===this.index&&1===a&&(a=0);0<this.items.length&&(a=(Math.max(0,this.index)+this.items.length+a)%this.items.length,this.items[a].trigger("focus"))},prepareForInput:function(){this._assignEvents("keys",document)},_events:{instance:{focus:function(){0!==
this.items.length&&(0>this.index?this.items[0].trigger("focus"):this._assignEvents("keys",document))},blur:function(){0<=this.index?this.items[this.index].trigger("blur"):this._unassignEvents("keys",document)}},keys:{"keydown keypress":function(a){this._handleKeyEvent(a)}},item:{focus:function(a){var b=this.index;this.index=c.inArray(a.target,this.items);0>b?this.trigger("focus"):b!==this.index&&this.items[b].trigger("blur")},blur:function(a){this.index===c.inArray(a.target,this.items)&&(this.index=
-1,this.trigger("blur"))},remove:function(a){this.removeItem(a.target)}}},keys:{}})});require("confluence/module-exporter").exportModuleAsGlobal("confluence/group","AJS.Group");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:jira-controls', location = '/includes/js/select-grid.js' */
define("confluence/select-grid",["ajs","jquery","confluence/templates","confluence/group","confluence/control"],function(g,d,j,e,m){var e=e.extend({init:function(a){this.type=this.type||"SelectGrid";this._super();var b=d(j.SelectGrid.gridOutline()),c=b.find("thead tr");d(a.columns).each(function(a,b){var f=d("<th></th>").addClass(b.getClassName()).text(b.heading);c.append(f)});this.gridContainer=d(a.gridContainer).append(b);this.getRowId=a.getRowId;this.table=b;this.columns=a.columns;this.selectionCallback=
a.selectionCallback;this.body=b.find("tbody");this.body.delegate("a","click",function(a){a.preventDefault()});this.dontShiftFocus=a.dontShiftFocus||function(){}},keys:{up:function(a){this.table.is(":visible")&&!this.dontShiftFocus()&&(this.shiftFocus(-1),a.preventDefault())},down:function(a){this.table.is(":visible")&&!this.dontShiftFocus()&&(this.shiftFocus(1),a.preventDefault())}},_addRow:function(a,b,c,h){d.isFunction(c)&&(h=c,c=!1);c?this.body.prepend(a):this.body.append(a);a=new n({row:a,data:b,
callback:h,getRowId:this.getRowId,selectionCallback:h});this.addItem(a);return a},clear:function(){this.removeAllItems();this.body.children().remove()},_addRows:function(a,b){var c=this,h=[];d(a).each(function(a,f){var g=c.columns,e,i,k,l;e=d("<tr></tr>");d(g).each(function(a,b){i={outerClass:b.getClassName(f)||"",href:b.getHref&&b.getHref(f)||"",innerClass:b.getInnerClass&&b.getInnerClass(f)||"",title:b.getTitle&&b.getTitle(f)||"",text:b.getText(f)||""};k=i.href?"cellWithLink":"cellWithoutLink";
l=j.SelectGrid[k](i);e.append(l)});e.attr("data-id",c.getRowId(f));h.push(c._addRow(e,f,b,c.selectionCallback))});return h},update:function(a){this.clear();!a||!a.length?g.debug("SelectGrid.update called with no data, returning."):(this._addRows(a),this.prepareForInput())},prependAndSelect:function(a,b){!a||!a.length?g.debug("SelectGrid.prependAndSelect called with no data, returning."):this._addRows(a,!0)[b||0].selectRow()},findItem:function(a){for(var b=0;b<this.items.length;b++)if(this.items[b].getRowId()==
a)return this.items[b];g.debug("SelectGrid.findItem didn't find item, returning null.");return null},select:function(a){(a=this.findItem(a))&&a.selectRow()},selectIndex:function(a){a=a||0;this.items[a]?this.items[a].selectRow():g.debug("SelectGrid.selectIndex couldn't select row with index "+a+", not found")},show:function(){this.gridContainer.removeClass("hidden")},hide:function(){this.gridContainer.addClass("hidden")},isVisible:function(){return!this.gridContainer.hasClass("hidden")}}),n=m.extend({init:function(a){this.type=
"SelectableRow";this.$row=d(a.row);this.$row.data("properties",a.data);this.getRowId=function(){return a.getRowId(a.data)};this.selectionCallback=a.selectionCallback;this._assignEvents("element",this.$row);this._assignEvents("instance",this);g.debug("SelectableRow initialized")},_events:{instance:{focus:function(){var a=this.$row;a.addClass("selected");this.selectionCallback(a,a.data("properties"))},blur:function(){this.$row.removeClass("selected")}},element:{click:function(){this.trigger("focus")}}},
selectRow:function(){this.trigger("focus")}});e.Column=function(a){var b=function(b){return b[a.key]};return{key:a.key,heading:a.heading,getClassName:a.getClassName||function(){return a.className||a.key+"-field"},getHref:a.getHref,getInnerClass:a.getInnerClass,getTitle:a.getTitle,getText:a.getText||b}};return e});require("confluence/module-exporter").exportModuleAsGlobal("confluence/select-grid","AJS.SelectGrid");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:jira-controls', location = '/includes/js/select-grid.soy' */
// This file was automatically generated from select-grid.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.SelectGrid.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.SelectGrid == 'undefined') { Confluence.Templates.SelectGrid = {}; }


Confluence.Templates.SelectGrid.gridOutline = function(opt_data, opt_ignored) {
  return '<table class="select-grid aui"><thead><tr class="data-table-header"></tr></thead><tbody></tbody></table>';
};
if (goog.DEBUG) {
  Confluence.Templates.SelectGrid.gridOutline.soyTemplateName = 'Confluence.Templates.SelectGrid.gridOutline';
}


Confluence.Templates.SelectGrid.cellWithLink = function(opt_data, opt_ignored) {
  return '<td class="' + soy.$$escapeHtml(opt_data.outerClass) + '"><a class="' + soy.$$escapeHtml(opt_data.innerClass) + '" href="' + soy.$$escapeHtml(opt_data.href) + '" title="' + soy.$$escapeHtml(opt_data.title) + '"><span>' + soy.$$escapeHtml(opt_data.text) + '</span></a></td>';
};
if (goog.DEBUG) {
  Confluence.Templates.SelectGrid.cellWithLink.soyTemplateName = 'Confluence.Templates.SelectGrid.cellWithLink';
}


Confluence.Templates.SelectGrid.cellWithoutLink = function(opt_data, opt_ignored) {
  return '<td class="' + soy.$$escapeHtml(opt_data.outerClass) + '"><span class="' + soy.$$escapeHtml(opt_data.innerClass) + '" title="' + soy.$$escapeHtml(opt_data.title) + '">' + soy.$$escapeHtml(opt_data.text) + '</span></td>';
};
if (goog.DEBUG) {
  Confluence.Templates.SelectGrid.cellWithoutLink.soyTemplateName = 'Confluence.Templates.SelectGrid.cellWithoutLink';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:jira-controls', location = '/includes/js/result-grid.js' */
define("confluence/result-grid",["ajs","jquery","confluence/control"],function(d,g,l){return l.extend({init:function(a){this.type=this.type||"ResultGrid";var c,f,k,h,j,e,i;f=a.gridContainer||g(a.baseElement).find(".data-table");f.length||d.debug("gridContainer for AJS.ResultGrid not found!");k=function(b){return b.id};c=new d.SelectGrid({gridContainer:f,columns:a.columns,selectionCallback:a.selectionCallback,getRowId:a.getRowId||k,dontShiftFocus:a.dontShiftFocus});e=a.messageHandler||d.MessageHandler({baseElement:g(a.baseElement).find(".message-panel")});
i=a.noResultMessage||"There are no results.";g.extend(this,{update:function(b,a){e.clearMessages();h&&(h(),j.remove(),h=null);c.clear();if(!b||!b.length){c.hide();var m=g.isFunction(i)?i(a):i;e.displayMessages(m);return!1}c.update(b);c.show();return!0},updateAndSelect:function(b,c,a){this.update(b,c)&&this.selectIndex(a)},prependAndSelect:function(b,a){!b||!b.length?d.debug("ResultGrid.prependAndSelect called with no data, returning."):(e.clearMessages(),c.prependAndSelect(b,
a),c.show())},select:function(b){c.select(b)},selectIndex:function(b){c.selectIndex(b)},clear:function(){e.clearMessages();c.hide()},loading:function(){c.show();var b=f.width(),a=f.height();this.clear();if(!h){var d,e;d=b/2-73;e=a/2-73;j=g("<div></div>").addClass("spinner-container").width(b-d).height(a-e).css({"padding-left":d,"padding-top":e}).insertAfter(f);h=Raphael.spinner(j[0],60,"#666")}},isVisible:function(){return c.isVisible()}})}})});
require("confluence/module-exporter").exportModuleAsGlobal("confluence/result-grid","AJS.ResultGrid");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:breadcrumbs-jquery', location = '/includes/js/breadcrumbs-jquery.js' */
define("confluence/breadcrumbs-jquery",["jquery","confluence/templates"],function(e,h){return function(a){var i=this,f=[],b=0,c=a.length-1,d=a[b],j=i.closest(".breadcrumbs-container").width(),g=function(){return i.width()<j};for(f.push(h.Dialog.breadcrumbItem({text:d.title,title:d.title,className:b===c?"last":""}));b++<c;)d=a[b],f.push(h.Dialog.breadcrumbItem({text:d.title,title:d.title,className:b===c?"last":""}));this.html(f.join(""));a=e("li a span",this);a.each(function(a){0!==a&&a!==c&&e(this).shortenUntil(g)});
e(a.get(0)).shortenUntil(g);e(a.get(c)).shortenUntil(g);return this}});require("confluence/module-exporter").exportModuleAsGlobal("confluence/breadcrumbs-jquery","jQuery.fn.renderBreadcrumbs");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:dialog-breadcrumbs', location = '/includes/js/dialog-breadcrumbs.js' */
define("confluence/dialog-breadcrumbs",["ajs","jquery","confluence/meta","confluence/templates"],function(b,d,e,k){var h={},l=function(a,e,f){var g=a.userName?a.userName:a.pageId?a.pageId+":"+a.fileName:a.spaceKey+":"+a.title+":"+a.postingDay+":"+a.fileName;g in h?e(h[g],"success"):d.ajax({type:"GET",dataType:"json",data:a,url:b.contextPath()+"/pages/breadcrumb.action",error:f||function(){},success:function(a,b){if(!a||!a.breadcrumbs)f(a,b);else{for(var c=d.makeArray(a.breadcrumbs);c[0]&&"userinfo"!==
a.type&&/peopledirectory\.action$/.test(c[0].url);)c.shift();"page"===a.type&&(c[1]&&/pages\.action/.test(c[1].url))&&c.splice(1,1);c.type=a.type;h[g]=c;e(c,b)}}})};return{getBreadcrumbsDefault:l,Breadcrumbs:function(a,h){var f=0;return{update:function(g,j){a.html(k.Dialog.breadcrumbLoading());var m=f+=1,c=function(){return m!==f?(b.debug("Breadcrumb response for ",g," is stale, ignoring."),!0):!1};(h||l)(g,function(f,h){if(!c())if("success"!==h||!f)a.html(k.Dialog.breadcrumbError());else{var i=g.spaceKey;
a.renderBreadcrumbs(f);if(!(i=i!==e.get("space-key")))a:{for(i=1;i<f.length;i++)if(f[i].title===e.get("page-title")){i=!1;break a}i=!0}i?(j.clearErrors(),d(j.moveButton).prop("disabled",!1)):(j.error("You cannot move a page to be underneath itself or its children."),d("li:last-child",a).addClass("warning"))}},function(d){c()||(a.html(k.Dialog.breadcrumbError()),404===d.status&&j.error("The specified page was not found."))})}}},getBreadcrumbsLegacy:function(a,e,f){if(!a.id)throw Error("id is a required parameter in 'options'");
if(!a.type)throw Error("type is a required parameter in 'options'");var g=a.id+":"+a.type;g in h?e(h[g],"success"):d.ajax({type:"GET",dataType:"json",data:a,url:b.contextPath()+b.REST.getBaseUrl()+"breadcrumb",error:f||function(){},success:function(a,b){if(!a||!a.breadcrumbs)f(a,b);else{for(var c=d.makeArray(a.breadcrumbs);c[0]&&"userinfo"!==a.type&&/peopledirectory.action$/.test(c[0].url);)c.shift();c.type=a.type;h[g]=c;e(c,b)}}})}}});
require("confluence/module-exporter").safeRequire("confluence/dialog-breadcrumbs",function(b){var d=require("ajs"),e=require("confluence/legacy");d.toInit(function(){d.MoveDialog||(d.MoveDialog={});d.MoveDialog.Breadcrumbs=b.Breadcrumbs;d.MoveDialog.getBreadcrumbs=b.getBreadcrumbsDefault;d.Breadcrumbs={};d.Breadcrumbs.getBreadcrumbs=b.getBreadcrumbsLegacy;e.Dialogs||(e.Dialogs={});e.Dialogs.Breadcrumbs=d.Breadcrumbs;e.Dialogs.Breadcrumbs.getBreadcrumbs=b.getBreadcrumbsLegacy;e.Dialogs.Breadcrumbs.Controller=
b.Breadcrumbs;e.Dialogs.Breadcrumbs.defaultGetBreadcrumbs=b.getBreadcrumbsDefault})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:dialog-breadcrumbs', location = '/includes/soy/dialog-breadcrumbs.soy' */
// This file was automatically generated from dialog-breadcrumbs.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Dialog.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Dialog == 'undefined') { Confluence.Templates.Dialog = {}; }


Confluence.Templates.Dialog.breadcrumbItem = function(opt_data, opt_ignored) {
  return '<li><a class="' + soy.$$escapeHtml(opt_data.className) + '" title="' + soy.$$escapeHtml(opt_data.title) + '" tabindex="-1"><span>' + soy.$$escapeHtml(opt_data.text) + '</span></a></li>';
};
if (goog.DEBUG) {
  Confluence.Templates.Dialog.breadcrumbItem.soyTemplateName = 'Confluence.Templates.Dialog.breadcrumbItem';
}


Confluence.Templates.Dialog.breadcrumbLoading = function(opt_data, opt_ignored) {
  return '<li class="loading"><span>' + soy.$$filterNoAutoescape('Loading breadcrumbs...') + '</span></li>';
};
if (goog.DEBUG) {
  Confluence.Templates.Dialog.breadcrumbLoading.soyTemplateName = 'Confluence.Templates.Dialog.breadcrumbLoading';
}


Confluence.Templates.Dialog.breadcrumbError = function(opt_data, opt_ignored) {
  return '<li class="warning last"><span>' + soy.$$escapeHtml('Error retrieving breadcrumbs.') + '</span></li>';
};
if (goog.DEBUG) {
  Confluence.Templates.Dialog.breadcrumbError.soyTemplateName = 'Confluence.Templates.Dialog.breadcrumbError';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:page-location', location = '/includes/js/page-location.js' */
define("confluence/page-location",["ajs","confluence/meta"],function(c,a){var b=null;return{get:function(){return b?b:{spaceName:a.get("space-name"),spaceKey:a.get("space-key"),parentPageTitle:a.get("parent-page-title")}},set:function(a){b=a}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence/page-location","Confluence.PageLocation");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:split_aui.splitchunk.vendors--8cfcf1af69', location = 'aui.chunk.a74d9dded03a92620c41--1fa67204f5c8e3af90cc.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["aui.splitchunk.vendors--8cfcf1af69"],{iwe4:function(t,e,i){"use strict";i.r(e)},rNKm:function(t,e,i){var s,a,l;
/*! jQuery Fancy File Input plugin - v2.0.4 - 2018-11-23
* Copyright (c) 2018 Atlassian Pty Ltd; Licensed Apache-2.0 */void 0===(l=this)&&void 0!==window&&(l=window),s=[i("oDIA")],void 0===(a=function(t){return l.FancyFileInput=function(t){"use strict";var e=/^.*[\\\/]/,i=/\{0\}/gi,s=function(){var t=3,e=document.createElement("div"),i=e.getElementsByTagName("i");do{e.innerHTML="\x3c!--[if gt IE "+ ++t+"]><i></i><![endif]--\x3e"}while(i[0]);return t>4?t:document.documentMode}();function a(e,i){var s=t(e).data("FancyFileInput");if(s)return s;i=t.extend({},a.defaults,i),this.el=e,this.$el=t(e),this.$label=this.createLabel(i.buttonText),this._addLabelText(),this.$clearButton=t("<button>",{text:this.$label.attr("data-ffi-clearButtonText")||i.clearButtonText,class:"ffi-clear",type:"button",tabindex:"-1"}),this.multipleFileTextPattern=this.$label.attr("data-ffi-multipleFileTextPattern")||i.multipleFileTextPattern,this._eventNamespace=".ffi",this.CLASSES={disabled:"is-disabled",focused:"is-focused",active:"is-active",valid:"is-valid",invalid:"is-invalid"},this[this.isDisabled()?"disable":"enable"](),this.isFocused=!1}return a.defaults={buttonText:"Browse",clearButtonText:"Clear",multipleFileTextPattern:"{0} files"},a.prototype._addLabelText=function(){var e=t('label[for="'+this.el.id+'"]');e.length&&this.$el.attr("aria-label",e.text())},a.prototype.createLabel=function(e){var i=this.$el.parent(".ffi[data-ffi-button-text]");return i.length||(i=this.$el.wrap(t("<label>",{class:"ffi","data-ffi-button-text":e})).parent()),i},a.prototype.isDisabled=function(){return this.$el.is(":disabled")},a.prototype.formatMultipleFileText=function(t){return this.multipleFileTextPattern.replace(i,t)},a.prototype.bindEvents=function(){this.$el.on("invalid"+this._eventNamespace,t.proxy(this.checkValidity,this)).on("change"+this._eventNamespace,t.proxy(this.change,this)).on("keydown"+this._eventNamespace,t.proxy(this.keydown,this)).on("mousedown"+this._eventNamespace,t.proxy(this.mousedown,this)).on("mouseup"+this._eventNamespace,t.proxy(this.mouseup,this)).on("focus"+this._eventNamespace,t.proxy(this.focus,this)).on("blur"+this._eventNamespace,t.proxy(this.blur,this)),this.$clearButton.on("click"+this._eventNamespace,t.proxy(this.clear,this))},a.prototype.unbindEvents=function(){this.$el.off(this._eventNamespace),this.$clearButton.off(this._eventNamespace)},a.prototype.fireEvent=function(t){this.$el.trigger(t+this._eventNamespace)},a.prototype.enable=function(){this.bindEvents(),this.$el.prop("disabled",!1),this.$label.removeClass(this.CLASSES.disabled)},a.prototype.disable=function(){this.unbindEvents(),this.$el.prop("disabled",!0),this.$label.addClass(this.CLASSES.disabled)},a.prototype.clear=function(){return this.$el.wrap("<form>").closest("form").get(0).reset(),this.$el.unwrap(),this.el.value="",this.change(),!1},a.prototype.focus=function(){var t=this;this.$label.addClass(this.CLASSES.focused),s&&!this.isFocused&&(this.isFocused=!0,setTimeout((function(){t.$el.blur(),t.$el.focus()}),0))},a.prototype.blur=function(){s&&this.isFocused||(this.$label.removeClass(this.CLASSES.focused),this.isFocused=!1)},a.prototype.mousedown=function(){this.$label.addClass(this.CLASSES.active)},a.prototype.mouseup=function(){this.$label.removeClass(this.CLASSES.active)},a.prototype.keydown=function(t){var e=t.which,i=9;if(8!==e&&46!==e||(this.clear(),t.preventDefault()),s&&e===i){var a=this;this.isFocused=!1,this.$el.prop("disabled",!0),setTimeout((function(){a.$el.prop("disabled",!1).blur()}),0)}},a.prototype.checkValidity=function(){if(this.el.required){var t=this.$el.is(":invalid");this.$label.toggleClass(this.CLASSES.invalid,t).toggleClass(this.CLASSES.valid,!t)}},a.prototype.change=function(){var t,i="";this.checkValidity(),(t=this.el.multiple&&this.el.files.length>1?this.formatMultipleFileText(this.el.files.length):this.el.value).length?(i=t.replace(e,""),this.$clearButton.appendTo(this.$label)):this.$clearButton.detach(),this.$el.focus(),this.setFieldText(i),this.fireEvent("value-changed")},a.prototype.setFieldText=function(t){var e="data-ffi-value";t.length?(this.$label.attr(e,t),this.fireEvent("value-added")):(this.$label.removeAttr(e),this.fireEvent("value-cleared"))},t.fn.fancyFileInput=function(e){return this.each((function(){var i=new a(this,e);t(this).data("FancyFileInput",i)}))},a}(t)}.apply(e,s))||(t.exports=a)}}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:split_aui.component.form.file-select', location = 'aui.chunk.647b6db9cb2996fa83a0--246ac123afad62eb1860.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["aui.component.form.file-select"],{"7hWp":function(i,u,c){"use strict";c.r(u),c.d(u,"FancyFileInput",(function(){return a}));c("6fSn"),c("iwe4");var n=c("rNKm"),a=c.n(n).a}},[["7hWp","runtime","aui.splitchunk.vendors--894c8113d9","aui.splitchunk.vendors--8cfcf1af69","aui.splitchunk.0d131bcbf1","aui.splitchunk.fbbef27525","aui.splitchunk.444efc83be","aui.splitchunk.739b9ec8cc","aui.splitchunk.056561461c","aui.splitchunk.949297951c","aui.splitchunk.d7c46c2734","aui.splitchunk.fb15cffa72","aui.splitchunk.56dfb54d0c","aui.splitchunk.908fe798b4","aui.splitchunk.462ee5f9ef","aui.splitchunk.26116b3cbd","aui.splitchunk.50dca3e042"]]]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-link-browser:link-browser-resources', location = 'js/link-object.js' */
define("confluence-link-browser/link-object",["jquery","ajs","confluence/legacy"],function(c,g,m){function j(a){return c.nodeName(a,"img")?a:a.hasChildNodes()&&1===a.childNodes.length&&c.nodeName(a,"a")&&c.nodeName(a.firstChild,"img")?a.firstChild:null}function k(a){return!a?"":c(a).attr("data-linked-resource-default-alias")||c(a).attr("src")}function l(a){var b={};"A"===a.nodeName&&c(a.attributes).each(function(){b[this.name]=this.value});return b}function i(a,b){for(var c=a;c&&c!=b;){if(3!=c.nodeType)return!1;
c=c.nextSibling}return 3===b.nodeType}var e={isLink:function(a){return a&&!!a.fillNode}},f=function(a){if(e.isLink(a))return a;var b={insert:function(){return m.Editor.LinkAdapter.setLink(b)},fillNode:function(a){var b=this.attrs;b.href=b.href||"#";a.attr(b);this.classes&&this.classes.length&&a.addClass(this.classes.join(" "));a.html(this.body.html);return a},getData:function(){var a={},b;for(b in this)this.hasOwnProperty(b)&&!c.isFunction(this[b])&&(a[b]=this[b]);return a},getLinkedImage:function(){return this.body&&
this.body.jquery?1===this.body.length&&this.body.is("img")&&this.body:null},getResourceId:function(){return this.attrs["data-linked-resource-id"]||""},getResourceVersion:function(){return this.attrs["data-linked-resource-version"]||""},isToConfluenceEntity:function(){return this.attrs["data-linked-resource-id"]},isToAttachmentOnSamePage:function(a){return"attachment"==this.attrs["data-linked-resource-type"]&&this.attrs["data-linked-resource-container-id"]==a},isCustomAtlassianContentLink:function(){return this.classes&&
this.classes.length?-1!=c.inArray("confluence-link",this.classes):!1},hasAnchor:function(){return this.attrs["data-anchor"]},getResourceType:function(){return this.attrs["data-linked-resource-type"]},getDefaultAlias:function(){return this.attrs["data-linked-resource-default-alias"]},getHref:function(){return this.attrs.href},getAnchor:function(){return this.attrs["data-anchor"]},getHtml:function(){return this.body.html},getShortcut:function(){return this.attrs["data-linked-resource-shortcut"]},isHrefValid:function(){return this.attrs.href&&
"http://"!=this.attrs.href},isImage:function(){return this.body.isImage},isNewLink:function(){return c.isEmptyObject(this.attrs)},isShortcutLink:function(){return"shortcut"===this.getResourceType()},isExternalLink:function(){return!this.isCustomAtlassianContentLink()},showsBreadcrumbs:function(){return!0},getTarget:function(){return this.attrs.target},setTarget:function(a){a?this.attrs.target=a:this.removeTarget()},removeTarget:function(){this.attrs&&this.attrs.target&&delete this.attrs.target}};
if(a&&a.attrs){var f={},h=null;c.each(a.attrs,function(a,b){"class"==a?h=b:f[a]=b});a.attrs=f;if(h){var d=h.split(" ");a.classes=a.classes&&a.classes.length?a.classes.concat(d):d}}c.extend(b,a);return b};e.fromData=function(a){return f(a)};e.fromNode=function(a,b){f({attrs:{},body:{html:b,text:b}});return f({attrs:l(a),body:{html:b,text:b}})};e.fromSelectedAnchor=function(a,b){var e=c(a),h=j(a),d=!h&&i(a.firstChild,a.lastChild);return f({attrs:l(a),body:{isEditable:d,isImage:!!h,html:e.html(),imgName:k(h),
text:b}})};e.fromSelection=function(a,b,c,e){var b=j(b),d;if(d=!b)if(a.collapsed)d=!0;else if(d=a.startContainer,d==a.endContainer)d=3===d.nodeType?!0:i(d.childNodes[a.startOffset],d.childNodes[a.endOffset-1]);else{var g=require("tinymce").activeEditor.dom;d=g.isBlock(a.startContainer)?a.startContainer.childNodes[a.startOffset]:a.startContainer;a=g.isBlock(a.endContainer)?a.endContainer.childNodes[a.endOffset-1]:a.endContainer;a=d&&a&&d.parentNode==a.parentNode?{start:d,end:a}:null;d=!!a&&i(a.start,
a.end)}return f({attrs:{},body:{isEditable:d,isImage:!!b,html:c,imgName:k(b),text:e}})};e.fromREST=function(a){var b=f({attrs:{"data-base-url":g.Confluence.getBaseUrl(),"data-linked-resource-id":a.id,"data-linked-resource-type":a.type,"data-linked-resource-content-type":a.contentType,href:g.REST.findLink(a.link),"data-linked-resource-default-alias":a.title},body:{html:g.escapeHtml(a.title),text:g.escapeHtml(a.title)},classes:["confluence-link"]});"user"===a.type&&(b.attrs["data-linked-resource-type"]=
"userinfo");return b};e.createLinkToNewPage=function(a,b){return f({attrs:{"data-space-key":b,"data-content-title":a,href:g.contextPath()+"/pages/createpage.action?spaceKey="+b+"&title="+a},body:{html:g.escapeEntities(a),text:a},classes:["createlink","confluence-link"]})};e.makeExternalLink=function(a){return f({attrs:{href:a},body:{html:a,text:a}})};e.isExternalLink=function(a){return a&&(a.match(/^(\/\/|mailto:|file:|http:|https:)/)||0===a.indexOf("\\"))};return e});
require("confluence/module-exporter").exportModuleAsGlobal("confluence-link-browser/link-object","Confluence.Link");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-link-browser:link-browser-resources', location = 'js/link-adapter.js' */
define("confluence-link-browser/link-adapter",["ajs","jquery","confluence/legacy","tinymce"],function(d,e,f,h){return{setLink:function(a){var b=d.Rte.getEditor(),b=e(b.dom.create("a"),b.getDoc());a.fillNode(b);a=h.confluence.NodeUtils.replaceSelection(b);e("#comments-section").length&&d.Rte.fixEditorFocus();return a},getLink:function(){var a,b,c;a=d.Rte.getEditor().selection;var g=a.getNode();if(c=e(g).parents().andSelf().filter("a[href]")[0])return a.select(c),b=a.getContent({format:"text"}),f.Link.fromSelectedAnchor(c,
b);c=a.getRng(!0);b=a.getContent({format:"text"});a=a.getContent();return f.Link.fromSelection(c,g,a,b)}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-link-browser/link-adapter","Confluence.Editor.LinkAdapter");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-link-browser:link-browser-resources', location = 'js/link-browser.js' */
define("confluence-link-browser/link-browser",["ajs","confluence/legacy","jquery"],function(b,o,h){function r(){if(!f.prop("disabled")){f.prop("disabled",!0);b.debug("link-browser.js: submit");i.preSubmit&&i.preSubmit();var a=c.getLink();b.DarkFeatures.isEnabled(s)||a.removeTarget();n();a.insert();b.trigger("closed.link-browser")}}function n(){k.hide().remove();b.Rte.BookmarkManager.restoreBookmark()}function p(){n();b.trigger("closed.link-browser")}function t(a,f,l){var d=f.key,f=f.label,e=d+"-panel",
g=o.Templates.LinkBrowser[d+"Panel"]({atlToken:b.Meta.get("atl-token")});k.addPanel(f,g,e,e+"-id");var a=k.get("panel:"+a),j=l.tabs[d];j.panelObj=a;j.key=d;j.createPanel({baseElement:h(a[0].body)});a[0].onblur=j.onDeselect;a[0].onselect=function(){var a=!!j.hasBreadcrumbs;b.debug("Link Browser: on tab select, breadcrumbs enabled: "+a);j.onSelect();c.refresh(a);i=j};return j}var s="link.openInNewWindow",k,c,f,i;return{SEARCH_PANEL:"search",ATTACHMENTS_PANEL:"attachments",WEBLINK_PANEL:"weblink",ADVANCED_PANEL:"advanced",
open:function(a){h(function(){h('.ffi input[type="file"]#file_0').fancyFileInput()});if(h(".aui-dialog:visible").length)return null;a=a||{};b.Rte.BookmarkManager.storeBookmark();a.linkInfo=a.linkInfo||o.Editor.LinkAdapter.getLink();if(a.opener)return a.opener(a.linkInfo.alias,a.linkInfo);var q=a,a={OPEN_IN_NEW_WINDOW_DARK_FEATURE:s,tabs:{},setLink:function(u,a){c.setLink(u,a)},getLink:function(){return c.getLink()},getSelectedDataTableItem:function(){return h(".data-table:visible tr.selected")},linkValid:function(a){f.prop("disabled",
!a)},focusLinkText:function(){c.focusLinkText()||(b.debug("LinkBrowser: focusing submit button"),f.focus())},getLinkText:function(){return c.getLinkText()},isLinkTextVisible:function(){return c.isLinkTextVisible()},isNewWindowCheckboxVisible:function(){return c.isNewWindowCheckboxVisible()},hasBreadcrumbs:function(a){return c.hasBreadcrumbs(a)},getLocationPresenter:function(){return c},doSearch:function(a){this.tabs.search.doSearch(a)},getSearchTextField:function(){return this.tabs.search.getSearchTextField()},
moveLocationPanel:function(a){c.moveLocationPanel(a)},restoreLocationPanel:function(){c.restoreLocationPanel()},gotoPanel:function(a){this.popup.gotoPanel(a)},getCurrentPanel:function(){return this.popup.getCurrentPanel()},setWebLinkURL:function(a){var c=this.tabs.weblink;i!=c?b.debug("Cannot set URL "+a+" on hidden Web Link panel"):c.setURL(a)},getWebLinkUrl:function(){var a=this.tabs.weblink;return i!=a?(b.debug("Cannot get URL on hidden Web Link panel"),null):a.getURL()},getTitle:function(){return this.popup.getTitle()},
getSubmitButtonText:function(){return f.text()},isSubmitButtonEnabled:function(){return f.is(":enabled")},isVisible:function(){return this.popup.isVisible()},showOpenInNewWindowCheckbox:function(a){return c.showOpenInNewWindowCheckbox(a)},getAdvancedTextField:function(){var a=this.tabs.advanced;return i!=a?(b.debug("Cannot get link text on hidden advanced panel"),null):a.getLink()},setAdvancedTextField:function(a){var c=this.tabs.advanced;i!=c?b.debug("Cannot set link text on hidden advanced panel"):
c.setLink(a)},submit:r,cancel:p},l=q.linkInfo,d=l.isNewLink(),e,g;e=new b.ConfluenceDialog({width:840,height:590,id:"insert-link-dialog",onCancel:p,onSubmit:r});g=d?"Insert link":"Edit link";d=d?"Insert":"Save";e.addHeader(g);e.addButton(d,r);e.addCancel("Cancel",p);e.addHelpText("Hint: type \u0022[\u0022 in the editor to see a list of suggested pages and insert a link.");g=h("#insert-link-dialog .dialog-tip");
g.attr("title",g.text());h("#insert-link-dialog .dialog-components .dialog-title").prepend(o.Templates.LinkBrowser.helpLink());f=e.get("button:0")[0].item;f.attr("id","link-browser-insert");f.prop("disabled",!0);k=e;a.popup=k;b.trigger("dialog-created.link-browser",[a]);c=o.Editor.LinkBrowser.LinkInfoPresenter(a);c.setLinkBody(l.body);q=q.panelKey;e=h("#link-browser-tab-items").find("div").map(function(){var a=h(this);return{key:a.text(),weight:a.attr("data-weight"),label:this.title}}).sort(function(a,
b){return a.weight-b.weight});var j="template"!==b.Meta.get("content-type");e=h.grep(e,function(a){return j||"attachments"!==a.key});var n;g=null;for(var d=0,v=e.length;d<v;d++){var m=t(d,e[d],a);0===d&&(n=m);!l.isNewLink()&&h.isFunction(m.handlesLink)&&m.handlesLink(l)?(g=m,m.openedLink=l):q==m.key&&(g=m)}g?a.popup.overrideLastTab():g=n;i=g;k.popup.element.find(".dialog-page-body:first").append(c.getContainer());i.panelObj.select();i.openedLink=null;k.show();b.trigger("dialog-shown.link-browser",
k);return a},cancel:p}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-link-browser/link-browser","Confluence.Editor.LinkBrowser");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-link-browser:link-browser-resources', location = 'js/link-browser-location.js' */
define("confluence-link-browser/link-browser-location",["jquery","confluence/legacy","ajs","confluence/dialog-breadcrumbs"],function(k,B,i,s){return function(t){function m(){return i.escapeHtml(u())}function u(){return b.val()}function v(a){j.closest(".row").toggleClass("hidden",!a);e.toggleClass("has-breadcrumbs",!!a)}function w(a){var c=a.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/),a=c[2],d=c[3],f=c[5],e=c[7],c=c[9],b="";a&&(b=a.toLowerCase()+":");d&&(b+=d);b+=n(f);e&&(b+=
"?"+n(e));c&&(b+="#"+n(c));return b}function n(a){var c={"'":"%27","\\[":"%5B","\\]":"%5D","`":"%60","\\\\":"%5C"},d;for(d in c)c.hasOwnProperty(d)&&(a=a.replace(RegExp(d,"g"),c[d]));return a}function x(){return b.is(":visible")}function y(a,c){i.trigger("analyticsEvent",{name:a,data:{resourceType:c.getResourceType(),isExternal:c.isExternalLink()}})}var e,j,o,f,g,b,p,z,A,q,l,r,h;e=k(B.Templates.LinkBrowser.locationPanel());j=e.find("#breadcrumbs-container");o=s.Breadcrumbs(j,s.getBreadcrumbsLegacy);
g=e.find("#link-open-in-new-window");z=e.find(".link-image");A=e.find(".link-mixed");l=e.find("#link-image-filename");q=e.find("#link-mixed-content");p=e.find(".link-text");b=p.find("input");b.change(function(a){a.keyCode=a.keyCode||a.which;a.keyCode&&13!==a.keyCode&&b.removeClass("default-alias")});g.change(function(){g.prop("checked")?("attachment"!==f.getResourceType()&&f.setTarget("_blank"),y("editor.linkBrowser.location.openInNewWindow.checked",f)):(f.removeTarget(),y("editor.linkBrowser.location.openInNewWindow.unchecked",
f))});return{setLink:function(a,c){i.debug("Link Browser: setting link : "+a);var d=a.attrs["data-linked-resource-default-alias"]||a.getHtml();if(""===m()||b.hasClass("default-alias"))b.addClass("default-alias"),b.val(d);if(c&&a.getResourceId()&&a.getResourceType()){var e={clearErrors:function(){},error:function(){},select:function(a){o.update(a,e)}},d={id:a.getResourceId(),type:a.getResourceType()};o.update(d,e)}v(c);i.DarkFeatures.isEnabled(t.OPEN_IN_NEW_WINDOW_DARK_FEATURE)?(g.prop("checked")&&
a.setTarget("_blank"),g.prop("checked","_blank"===a.getTarget())):a.removeTarget();f=a;t.linkValid(f&&f.isHrefValid())},getLink:function(){if(!f)return null;var a=r;a||((a=m())||(a=f.getDefaultAlias()||f.getHref()),a={html:a});f.body=a;f.attrs.href=w(f.attrs.href);return f},refresh:function(a){f&&v(a)},setLinkBody:function(a){r||(a.isEditable?b.val(a.text):a.isImage?l.text(a.imgName):q.text(a.text),r=a.isEditable?null:a,p.toggleClass("hidden",!a.isEditable),z.toggleClass("hidden",!a.isImage),A.toggleClass("hidden",
a.isEditable||a.isImage))},getContainer:function(){return e},isLinkTextVisible:x,isLinkImageVisible:function(){return l.is(":visible")},isNewWindowCheckboxVisible:function(){return g.is(":visible")},isNewWindowCheckboxChecked:function(){return g.prop("checked")},isLinkMixedContentVisible:function(){return q.is(":visible")},focusLinkText:function(){return x()?(i.debug("LinkInfoPresenter.focusLinkText focusing alias"),b.select(),!0):!1},getLinkText:m,getRawLinkText:u,getLinkImageName:function(){return l.text()},
moveLocationPanel:function(a){h||(h=e.find(".row:not(.hidden) .field-group"),h.each(function(a,d){k(d).data("original-parent",k(d).parent())}));h.appendTo(a);e.hide()},restoreLocationPanel:function(){h&&h.each(function(a,c){var d=k(c);d.data("original-parent")&&(d.appendTo(d.data("original-parent")),d.removeData("original-parent"))});e.show();h=null},hasBreadcrumbs:function(a){if(!j.is(":visible"))return!1;var c=a.length,d=j.find("li");if(d.length!==c)return!1;for(var b=0;b<c;b++)if(d.eq(b).text()!==
a[b])return!1;return!0},showOpenInNewWindowCheckbox:function(a){g.closest(".row").toggleClass("hidden",!a)},encodeURLSafely:w}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-link-browser/link-browser-location","Confluence.Editor.LinkBrowser.LinkInfoPresenter");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-link-browser:link-browser-resources', location = 'js/link-browser-tab-search.js' */
define("confluence-link-browser/link-browser-tab-search",["jquery","ajs","document","confluence/legacy","confluence/page-location"],function(d,b,n,i,o){return{dialogCreatedLinkBrowserSearch:function(n,j){var c,e,f,m,p=b.REST.getBaseUrl()+"search.json",k=function(a,b){i.Link.isLink(a)||(a=i.Link.fromREST(a));b&&c.val(a.attrs["data-linked-resource-default-alias"]);j.setLink(a,!0);j.focusLinkText()},l=function(a){b.debug("link-browser-tab-search.js: doing search");c.trigger("hide.autocomplete");var g=
d.trim(c.val());g?(f.loading(),b.getJSONWrap({url:p,data:{search:"site",query:g,spaceKey:e.val()},successCallback:function(b){d.isFunction(a)?(f.update(b.result),a()):f.updateAndSelect(b.result);c.trigger("hide.autocomplete")},messageHandler:m})):d.isFunction(a)&&a()};j.tabs.search={hasBreadcrumbs:!0,createPanel:function(a){var g=a.baseElement;c=g.find("#link-search-text");e=g.find("#search-panel-space");var h=o.get();e.find("option:eq(1)").text(h.spaceName).val(h.spaceKey);e.change(function(){c.attr("data-spacekey",
e.val());c.trigger("clearCache.autocomplete")});i.Binder.autocompleteSearch(c.parent());c.bind("selected.autocomplete-content",function(a,b){b.searchFor?l():(f.clear(),k(b.content,!1))});h=[b.SelectGrid.Column({key:"title",heading:"Title",getHref:function(a){return b.REST.findLink(a.link)},getInnerClass:function(a){return a.iconClass||"content-type-"+a.type}}),b.SelectGrid.Column({key:"space",heading:"Space",getText:function(a){return a.space&&
a.space.title||""}}),b.SelectGrid.Column({key:"last-modified",heading:"Last Modified",getText:function(a){return a.lastModifiedDate&&a.lastModifiedDate.friendly||""},getTitle:function(a){return a.lastModifiedDate&&a.lastModifiedDate.date||""}})];m=b.MessageHandler({baseElement:a.baseElement.find(".message-panel")});f=new b.ResultGrid({baseElement:a.baseElement,columns:h,selectionCallback:function(a,b){k(b)},noResultMessage:"No search results found.",
dontShiftFocus:function(){return d(c).add(e).is(":focus")}});g.find(".search-form").submit(function(){l();return!1}).keydown(function(a){13===a.keyCode&&!d(".aui-dropdown:visible .active",this).length&&(d("#search-panel-button").focus(),a.stopPropagation())})},onSelect:function(){b.debug("Link Browser Search panel selected");var a=this.openedLink;a?(b.debug("Link Browser Search panel setting link info"),k(a,!0)):c.focus()},handlesLink:function(a){return a.isCustomAtlassianContentLink()&&!a.hasAnchor()&&
!a.isShortcutLink()&&!a.isToAttachmentOnSamePage(b.Meta.get("content-id"))},doSearch:function(a,b){c.val(a);l(b)},isResultGridVisible:function(){return f.isVisible()},getSearchTextField:function(){return c}}}}});require("confluence/module-exporter").safeRequire("confluence-link-browser/link-browser-tab-search",function(d){require("ajs").bind("dialog-created.link-browser",d.dialogCreatedLinkBrowserSearch)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-link-browser:link-browser-resources', location = 'js/link-browser-tab-history.js' */
define("confluence-link-browser/link-browser-tab-history",["ajs","confluence/legacy"],function(a,h){return{dialogCreatedLinkBrowserHistory:function(i,d){var e=a.REST.makeUrl("session/history.json?max-results=20"),f,g;d.tabs.recentlyviewed={createPanel:function(c){var e=[a.SelectGrid.Column({key:"title",heading:"Title",getHref:function(b){return a.REST.findLink(b.link)},getInnerClass:function(b){return b.iconClass||"content-type-"+b.type}}),a.SelectGrid.Column({key:"space",
heading:"Space",getText:function(b){return b.space&&b.space.title||""}}),a.SelectGrid.Column({key:"last-modified",heading:"Last Modified",getText:function(b){return b.lastModifiedDate&&b.lastModifiedDate.friendly||""},getTitle:function(b){return b.lastModifiedDate&&b.lastModifiedDate.date||""}})];g=a.MessageHandler({baseElement:c.baseElement.find(".message-panel")});f=new a.ResultGrid({baseElement:c.baseElement,
columns:e,getRowId:function(b){return b.attachmentId},selectionCallback:function(b,a){var c=h.Link.fromREST(a);d.setLink(c);d.focusLinkText()},messageHandler:g,noResultMessage:"You have no recently viewed content."})},onSelect:function(){f.loading();a.getJSONWrap({url:e,messageHandler:g,successCallback:function(c){f.update(c.content);a.trigger("updated.link-browser-recently-viewed")}})}}}}});
require("confluence/module-exporter").safeRequire("confluence-link-browser/link-browser-tab-history",function(a){require("ajs").bind("dialog-created.link-browser",a.dialogCreatedLinkBrowserHistory)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-link-browser:link-browser-resources', location = 'js/link-browser-tab-attachment.js' */
define("confluence-link-browser/link-browser-tab-attachment",["jquery","ajs","confluence/legacy"],function(h,a,j){return{dialogCreatedLinkBrowserAttachment:function(m,i){var f=a.REST.makeUrl("content/"+a.Meta.get("attachment-source-content-id")+"/attachments.json"),g,k,l,d;i.tabs.attachments={hasBreadcrumbs:!1,createPanel:function(b,c){var e=b.baseElement.find(".attach-file-form");g=h.extend({getUploaderController:function(){return j.AttachmentUploader({baseElement:e},function(){return{onUploadSuccess:function(a){for(var b=
0,c=a.length;b<c;b++)a[b].type="attachment";d.prependAndSelect(a)}}})}},c&&c(b));k=g.getUploaderController(b);l=k.getMessageHandler();var f=[a.SelectGrid.Column({key:"title",heading:"Name",getHref:function(b){return b.link?a.REST.findLink(b.link):b.url},getInnerClass:function(a){return a.iconClass}}),a.SelectGrid.Column({key:"size",heading:"Size",getText:function(a){return a.niceFileSize}}),a.SelectGrid.Column({key:"comment",
heading:"Comment"})];d=new a.ResultGrid({baseElement:b.baseElement,columns:f,selectionCallback:function(b,c){var d=j.Link.fromREST(c);d.attrs["data-linked-resource-container-id"]=a.Meta.get("content-id");if(h.isArray(c.link))for(var e=0,f=c.link.length;e<f;e++){var g=c.link[e];"download"===g.rel&&(d.attrs.href=g.href)}i.setLink(d);i.focusLinkText()},noResultMessage:"There are no files on this page."})},onSelect:function(){var b=this.openedLink,c=i.getLink();
d.loading();a.getJSONWrap({url:f,messageHandler:l,successCallback:function(e){d.update(e.attachment);c?"attachment"==c.getResourceType()&&d.select(c.getResourceId()):b?d.select(b.getResourceId()):e.attachment.length&&d.select(e.attachment[0].id);a.debug("Loaded attachments")}})},handlesLink:function(b){return b.isToAttachmentOnSamePage(a.Meta.get("content-id"))}}}}});
require("confluence/module-exporter").safeRequire("confluence-link-browser/link-browser-tab-attachment",function(h){var a=require("ajs");"template"!==a.Meta.get("content-type")&&a.bind("dialog-created.link-browser",h.dialogCreatedLinkBrowserAttachment)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-link-browser:link-browser-resources', location = 'js/link-browser-tab-weblink.js' */
define("confluence-link-browser/link-browser-tab-weblink",["ajs","jquery","confluence/legacy"],function(d,k,h){return{dialogCreatedLinkBrowserWeblink:function(n,c){function e(){return k.trim(b.val())}function f(){var a=e();if(!(d.Validate.url(a)||0===a.indexOf("mailto:"))){if(d.Validate.email(a))a="mailto:"+a;else{if(l.test(a))return;a="http://"+a}d.debug("Updating Link Browser Web Link URL to: "+a);b.val(a);a=h.Link.makeExternalLink(a);c.setLink(a)}}function i(){var a=e();(a=a?h.Link.makeExternalLink(a):
null)&&c.setLink(a)}function m(){f();i()}var b,g,j,l=/[:/]/;j=c.tabs.weblink={createPanel:function(a){g=a.baseElement;b=g.find("input[name='destination']");b.keyup(function(){i()});b.change(f);b.bind("paste",function(){d.debug("Link Browser web link url pasted");setTimeout(m,0)})},onSelect:function(){d.DarkFeatures.isEnabled(c.OPEN_IN_NEW_WINDOW_DARK_FEATURE)&&c.showOpenInNewWindowCheckbox(!0);c.moveLocationPanel(g.find("form:first"));this.openedLink&&(j.setURL(this.openedLink.attrs.href),c.setLink(this.openedLink));
setTimeout(function(){b.focus()})},onDeselect:function(){c.restoreLocationPanel();c.showOpenInNewWindowCheckbox(!1)},preSubmit:f,handlesLink:function(a){return!a.isCustomAtlassianContentLink()},setURL:function(a){b.val(a);b.keyup();b.change()},getURL:e}}}});require("confluence/module-exporter").safeRequire("confluence-link-browser/link-browser-tab-weblink",function(d){require("ajs").bind("dialog-created.link-browser",d.dialogCreatedLinkBrowserWeblink)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-link-browser:link-browser-resources', location = 'js/link-browser-tab-advanced.js' */
define("confluence-link-browser/link-browser-tab-advanced",["jquery","ajs","confluence/legacy","confluence/api/constants","confluence/meta"],function(g,e,l,m,i){return{dialogCreatedLinkBrowserAdvanced:function(p,d){var c,f,h,k,n=function(b){b=g(b);if(b.length){var a=b.find("a:first");a.length?a.hasClass("unresolved")?(b=a.attr("shortcut-key"),a=a.attr("data-space-key"),b?f.text(e.format("{0} is not a recognized shortcut",b)):a&&f.text(e.format("{0} is not a recognized space",
a))):(b=l.Link.fromNode(a[0],c.val()),d.setLink(b)):f.text("The markup provided is not valid link markup")}},o=function(b,a,c){e.debug("Error during conversion: textStatus = "+a+", errorThrown = "+c);f.text("An internal server error occurred")},j=d.tabs.advanced={createPanel:function(b){h=b.baseElement;c=h.find("input[name='advanced-link']");f=h.find("div[name='advanced-error']");h.find("form").keydown(function(a){13===a.keyCode&&!d.isSubmitButtonEnabled()&&a.preventDefault()});
c.keyup(function(){clearTimeout(k);f.text("");c.val()&&(k=setTimeout(function(){var a=c.val(),a=a.replace(/\[/g,"\\[").replace(/]/g,"\\]"),a={wiki:"["+a+"]",entityId:i.get("content-id"),spaceKey:i.get("space-key"),contextType:i.get("content-type")};g.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:m.CONTEXT_PATH+"/rest/tinymce/1/wikixhtmlconverter",data:g.toJSON(a),dataType:"text",success:n,error:o,timeout:1E4})},200))})},setLink:function(b){c.val(b);c.keyup();c.change()},getLink:function(){return c.val()},
onSelect:function(){e.DarkFeatures.isEnabled(d.OPEN_IN_NEW_WINDOW_DARK_FEATURE)&&d.showOpenInNewWindowCheckbox(!0);d.moveLocationPanel(h.find("form:first"));this.openedLink&&(this.openedLink.isShortcutLink()?j.setLink(this.openedLink.getShortcut()):this.openedLink.getResourceId()?j.setLink(this.openedLink.getDefaultAlias()):j.setLink("#"+this.openedLink.getAnchor()),d.setLink(this.openedLink));setTimeout(function(){c.focus()})},onDeselect:function(){d.restoreLocationPanel();d.showOpenInNewWindowCheckbox(!1)},
handlesLink:function(b){return b.isShortcutLink()||b.hasAnchor()}}}}});require("confluence/module-exporter").safeRequire("confluence-link-browser/link-browser-tab-advanced",function(g){require("ajs").bind("dialog-created.link-browser",g.dialogCreatedLinkBrowserAdvanced)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-link-browser:link-browser-resources', location = 'templates/link-browser.soy' */
// This file was automatically generated from link-browser.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.LinkBrowser.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.LinkBrowser == 'undefined') { Confluence.Templates.LinkBrowser = {}; }


Confluence.Templates.LinkBrowser.searchPanel = function(opt_data, opt_ignored) {
  return '<form class="aui search-form" onsubmit="return false;"><fieldset class="inline"><div class="search-input"><label for="link-search-text" id="linkSearch-label" class="assistive">' + soy.$$escapeHtml('Search') + '</label><input id="link-search-text" type="text" tabindex="0" class="text autocomplete-search" name="linkSearch" autocomplete="off" data-search-link-message="' + soy.$$escapeHtml('Search for \x26lsquo;{0}\x26rsquo;') + '"></div><select tabindex="0" class="search-space select" id="search-panel-space"><option value="">' + soy.$$escapeHtml('All content') + '</option><option value=""> </option></select><button type="submit" tabindex="0" class="aui-button" id="search-panel-button">' + soy.$$escapeHtml('Search') + '</button></fieldset></form><div class="message-panel hidden"></div><div id="search-results-table" class="data-table hidden"></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.LinkBrowser.searchPanel.soyTemplateName = 'Confluence.Templates.LinkBrowser.searchPanel';
}


Confluence.Templates.LinkBrowser.recentlyviewedPanel = function(opt_data, opt_ignored) {
  return '<div class="recently-viewed-panel"><div class="message-panel hidden"></div><div class="data-table"></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.LinkBrowser.recentlyviewedPanel.soyTemplateName = 'Confluence.Templates.LinkBrowser.recentlyviewedPanel';
}


Confluence.Templates.LinkBrowser.attachmentsPanel = function(opt_data, opt_ignored) {
  return '<div class="attach-file-form"><form method="post" enctype="multipart/form-data" id="attachments-attachfile-form" action="' + soy.$$escapeHtml("") + '/pages/attachfile.action" class="aui"><p>' + soy.$$escapeHtml('Link to a file that is attached to this page or attach a new one.') + '</p><div class="upload-field field-group"><label for="file_0">' + soy.$$escapeHtml('Upload file') + '</label><label id="fancy-file-upload" class="ffi" data-ffi-button-text="Browse"><input type="file" name="file_0" id="file_0"></label><input type="hidden" name="minorEdit_0" value="true"></div><input type="hidden" name="atl_token" value="' + soy.$$escapeHtml(opt_data.atlToken) + '" /></form><div class="upload-in-progress upload-field hidden">' + soy.$$escapeHtml('Upload in progress...') + '</div><div class="warning"><ul class="hidden message-panel"></ul></div></div><div class="message-panel hidden"></div><div id="attachments-table" class="attachment-list data-table"></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.LinkBrowser.attachmentsPanel.soyTemplateName = 'Confluence.Templates.LinkBrowser.attachmentsPanel';
}


Confluence.Templates.LinkBrowser.weblinkPanel = function(opt_data, opt_ignored) {
  return '<form class="aui" onsubmit="return false;"><div class="field-group"><label id="destination-label" for="weblink-destination">' + soy.$$escapeHtml('Address') + '</label><input type="text" tabindex="0" class="text" id="weblink-destination" name="destination"><div class="web-link-desc description">' + soy.$$escapeHtml('Web, email or any other internet address') + '</div></div></form>';
};
if (goog.DEBUG) {
  Confluence.Templates.LinkBrowser.weblinkPanel.soyTemplateName = 'Confluence.Templates.LinkBrowser.weblinkPanel';
}


Confluence.Templates.LinkBrowser.advancedPanel = function(opt_data, opt_ignored) {
  return '<form class="aui" onsubmit="return false;"><div class="advanced-desc title">' + soy.$$filterNoAutoescape(AJS.format('Here you can insert a link into the page using \x3ca href\x3d\x22{0}\x22 target\x3d\x22_blank\x22\x3ewiki markup\x3c/a\x3e.',"https://docs.atlassian.com/confluence/docs-717/Links")) + '</div><div class="field-group"><label id="advanced-label" for="advanced-link">' + soy.$$escapeHtml('Link') + '</label><input type="text" tabindex="0" class="text" id="advanced-link" name="advanced-link"><div class="advanced-desc description">' + soy.$$escapeHtml('To insert a link to a new page, type in the desired page title.') + '<br/>' + soy.$$escapeHtml('To insert an anchor link, type #anchorname.') + '</div><div name="advanced-error" class="advanced-error error"></div></div></form>';
};
if (goog.DEBUG) {
  Confluence.Templates.LinkBrowser.advancedPanel.soyTemplateName = 'Confluence.Templates.LinkBrowser.advancedPanel';
}


Confluence.Templates.LinkBrowser.locationPanel = function(opt_data, opt_ignored) {
  return '<div id="link-browser-location" class="location-info"><form class="aui"><div class="row hidden field-group"><label class="link-location-label" for="breadcrumbs-link">' + soy.$$escapeHtml('Link location') + '</label><div class="breadcrumbs-container" id="breadcrumbs-link"><div class="breadcrumbs-line"><ol id="breadcrumbs-container" class="breadcrumbs"></ol></div></div></div></form><div class="row link-text"><form class="aui" onsubmit="return false;"><div class="field-group"><label for="alias" id="alias-label">' + soy.$$escapeHtml('Link text') + '</label><input type="text" tabindex="0" class="text" name="alias" id="alias"></div></form></div><div class="row link-open-in-new-window hidden"><div class="field-group"><div class="checkbox"><input type="checkbox" class="checkbox" name="open-in-new-window" tabindex="0" id="link-open-in-new-window"><label for="link-open-in-new-window" id="open-window-label">' + soy.$$escapeHtml('Open in new tab/window') + '</label></div></div></div><div class="row link-image hidden"><div class="readonly"><label for="link-image-filename">' + soy.$$escapeHtml('Link image') + '</label><span id="link-image-filename" class="content-type-attachment-image"></span></div></div><div class="row link-mixed hidden"><div class="readonly"><label for="link-mixed-content">' + soy.$$escapeHtml('Link text') + '</label><span id="link-mixed-content"></span></div></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.LinkBrowser.locationPanel.soyTemplateName = 'Confluence.Templates.LinkBrowser.locationPanel';
}


Confluence.Templates.LinkBrowser.helpLink = function(opt_data, opt_ignored) {
  return '<div class="dialog-help-link"><a href="' + soy.$$escapeHtml("https://docs.atlassian.com/confluence/docs-717/Links") + '" target="_blank">' + soy.$$escapeHtml('Help') + '</a></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.LinkBrowser.helpLink.soyTemplateName = 'Confluence.Templates.LinkBrowser.helpLink';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-create-content-plugin:editor-resources', location = 'com/atlassian/confluence/plugins/createcontent/js/move-hidden-fields-hack.js' */
AJS.toInit(function(a){a("fieldset.create-content-template-fields \x3e input").appendTo("form.editor")});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-create-content-plugin:create-from-template-macro-browser-resources', location = 'com/atlassian/confluence/plugins/createcontent/js/create-from-template-macro-fields.js' */
AJS.toInit(function(g){function k(a,b){a=a||AJS.Meta.get("space-key");Confluence.Blueprint.Dialog.requestWebItems(a,!1,function(e){var f=Confluence.Blueprint.Dialog.loadedWebitems[a];_.isEmpty(f)?AJS.log("create-from-template-macro-fields: No Create dialog web items found for spaceKey \x3e"+a+"\x3c"):b(e,f)},function(){AJS.error("create-from-template-macro-fields: requestWebItems call for spaceKey \x3e"+a+"\x3c failed")})}function h(a,b){k(b,function(e,f){e=a.val();a.empty();_.each(f,function(c){var d=
c.itemModuleCompleteKey;"com.atlassian.confluence.plugins.confluence-create-content-plugin:create-blank-page"!==d&&"com.atlassian.confluence.plugins.confluence-create-content-plugin:create-blog-post"!==d&&(c.templateId||c.contentBlueprintId)&&(d=g("\x3coption\x3e\x3c/option\x3e").text(c.name),d.attr("data-template-id",c.templateId),d.attr("data-blueprint-module-complete-key",c.blueprintModuleCompleteKey),d.attr("data-content-blueprint-id",c.contentBlueprintId),d.attr("data-create-result",c.createResult),
d.val(c.templateId||c.contentBlueprintId),a.append(d))});a.val(e)})}AJS.MacroBrowser.setMacroJsOverride("create-from-template",{fields:{spacekey:{spaceKey:function(a){var b=AJS.MacroBrowser.ParameterFields.spacekey(a),e=b.input.val();a=function(){var f=b.input.val();f!=e&&h(AJS.MacroBrowser.fields.templateName.input,f);e=f};b.input.bind("selected.autocomplete-content",a);b.input.blur(a);return b}}},beforeParamsSet:function(a,b){a.buttonLabel=a.buttonLabel||a.createButtonLabel||"Create from template";
h(g("#macro-param-templateName"),a.spaceKey);return a},beforeParamsRetrieved:function(a,b,e){b=AJS.MacroBrowser.fields.templateName.input.find("option:selected");a.blueprintModuleCompleteKey=b.data("blueprint-module-complete-key");a.contentBlueprintId=b.data("content-blueprint-id");a.templateId=b.data("template-id");a.createResult=b.data("create-result");return a}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-image-attributes:soy-resources', location = 'soy/image-attributes-panel.soy' */
// This file was automatically generated from image-attributes-panel.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Editor.ImageAttributes.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Editor == 'undefined') { Confluence.Templates.Editor = {}; }
if (typeof Confluence.Templates.Editor.ImageAttributes == 'undefined') { Confluence.Templates.Editor.ImageAttributes = {}; }


Confluence.Templates.Editor.ImageAttributes.content = function(opt_data, opt_ignored) {
  return '<form class="aui" onsubmit="return false;"><div class="field-group"><label for="image-title-attribute">' + soy.$$escapeHtml('Title text') + '</label><input class="text" type="text" id="image-title-attribute" name="image-title-attribute" value="' + ((opt_data.imgTitle) ? soy.$$escapeHtml(opt_data.imgTitle) : '') + '"><div class="description">' + soy.$$escapeHtml('Appears when the cursor hovers over the image') + '</div></div><div class="field-group"><label for="image-alt-attribute">' + soy.$$escapeHtml('Alt text') + '</label><input class="text" type="text" id="image-alt-attribute" name="image-alt-attribute" value="' + ((opt_data.imgAlt) ? soy.$$escapeHtml(opt_data.imgAlt) : '') + '"><div class="description">' + soy.$$escapeHtml('Used by screen readers and when the image cannot be shown') + '</div></div></form>';
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.ImageAttributes.content.soyTemplateName = 'Confluence.Templates.Editor.ImageAttributes.content';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-image-attributes:image-attributes', location = 'js/image-attributes-panel.js' */
define("confluence-image-attributes/image-attributes-panel",["jquery","ajs","confluence/legacy"],function(f,h,g){return function(){function k(){var a=c.val();d.attr({"data-element-title":a,title:l(d.attr("data-location"),a),alt:e.val()})}function m(){c.val()===e.val()&&(c.bind("input.chained",function(a){e.val(c.val())}),e.on("change",function(){c.unbind("input.chained")}))}function l(a,b){return a&&0<a.length&&b&&0<b.length?a+" ("+b+")":a&&0<a.length?a:b&&0<b.length?"("+b+")":""}h.bind("dialog-created.image-properties",
function(a,b){d=f(b.img);a=f(g.Templates.Editor.ImageAttributes.content({imgTitle:d.attr("data-element-title"),imgAlt:d.attr("alt")}));c=a.find("#image-title-attribute");e=a.find("#image-alt-attribute");m();g.Editor.ImageProps.registerPanel(n,a,p,k)});var n="image-attributes",p="image-attributes-panel",d,c,e}});require("confluence/module-exporter").safeRequire("confluence-image-attributes/image-attributes-panel",function(f){require("ajs").toInit(f)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:property-panel-image-link-macro-conf-frontend', location = 'tinymce3/plugins/imagedialog/editor_plugin_src.js' */
define("confluence-editor/tinymce3/plugins/imagedialog/editor_plugin_src",["tinymce","confluence/legacy"],function(a,b){return{init:function(a){a.on("init",function(){a.addCommand("mceConfimage",b.Editor.defaultInsertImageDialog)})},getInfo:function(){return{longname:"Confluence Image Dialog",author:"Atlassian",authorurl:"http://www.atlassian.com",version:a.majorVersion+"."+a.minorVersion}}}});
require("confluence/module-exporter").safeRequire("confluence-editor/tinymce3/plugins/imagedialog/editor_plugin_src",function(a){var b=require("tinymce");b.create("tinymce.plugins.ConfluenceImageDialog",a);b.PluginManager.add("confluenceimagedialog",b.plugins.ConfluenceImageDialog)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:property-panel-image-link-macro-conf-frontend', location = 'utils/tinymce-image-utils.js' */
define("confluence-editor/utils/tinymce-image-utils","jquery confluence/api/logger confluence/meta ajs tinymce confluence/api/constants".split(" "),function(d,m,n,j,o,r){var p=["imagetext","src","align","border","width","height"],s=/\/download\/(thumbnails|attachments)\/([0-9]+)\//,q=function(a,b,f,c,e){if(c){a.width=b>=e?e:b;a.style.maxWidth=""}else{a.height=f>=e?e:f;a.style.maxHeight=""}},k;k={isScaledByWidth:function(){return false},updateImageElement:function(a,b){var f=d(a),c;c=b.destination;
c=k.isRemoteImg(c)?c:b.thumbnail?c.replace("/attachments/","/thumbnails/"):c.replace("/thumbnails/","/attachments/");b.src=c;f.toggleClass("confluence-content-image-border",!!b.border);f.toggleClass("confluence-thumbnail",!!b.thumbnail);c=0;for(var e=p.length;c<e;c++){var h=p[c],g=b[h];g!==false&&g!=null?f.attr(h,g):f.removeAttr(h)}o.activeEditor.undoManager.add()},insertFromProperties:function(a,b){d.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:r.CONTEXT_PATH+"/rest/tinymce/1/embed/placeholder/image",
data:d.toJSON(a),dataType:"text",success:function(a){k.insertImagePlaceholder(a,b)}})},insertImagePlaceholder:function(a,b){var f,c=k.isScaledByWidth(),e=d(a);f=c?j.Confluence.PropertyPanel.Image.getPresetImageSize("large"):n.get("content-type")==="comment"?j.Confluence.PropertyPanel.Image.getPresetImageSize("small"):j.Confluence.PropertyPanel.Image.getPresetImageSize("medium");e.css(c?"max-width":"max-height",f+"px");var h=o.activeEditor,g="_"+ +new Date,i=d("<div></div>").append(e.attr("id",g));
h.selection.setContent(i.html());var l=h.dom.get(g);h.dom.setAttrib(l,"id","");if(!e.hasClass("confluence-external-resource")){g=e.attr("data-image-width");i=e.attr("data-image-height");if(g===void 0&&i===void 0){g=e.attr("width");i=e.attr("height")}q(l,g,i,c,f);this.updateThumbnailAttribute(l)}d(l).one("load",function(){e.hasClass("confluence-external-resource")&&q(this,this.width,this.height,c,f);j.Rte.showSelection(function(){b||j.trigger("trigger.property-panel",{elem:l});h.undoManager.add()});
h.fire("Change")})},updateThumbnailAttribute:function(a){var b=a.width,f=a.height;if(b||f){var c=d(a),e=c.attr("data-image-width"),h=c.attr("data-image-height"),g=n.get("max-thumb-width"),i=n.get("max-thumb-height"),a=!this.isRemoteImg(a.src)&&this.isThumbnailUsable(b,f,e,h,g,i);c.attr("thumbnail",a);c.toggleClass("confluence-thumbnail",a)}},isRemoteImg:function(a){var b=j.Rte.getCurrentBaseUrl();return a.match("(https?://)")&&a.indexOf(b)===-1},isThumbnailUsable:function(a,b,f,c,e,d){if(a){if(a>
e)return false;if(f===void 0&&c===void 0)return true;e=f/c;return e>=1?true:e*d>=a}a=b;if(a>d)return false;if(f===void 0&&c===void 0)return true;d=c/f;return d>=1?true:d*e>=a}};return{ImageProperties:function(a){if(a&&d.nodeName(a,"img")&&d(a).hasClass("confluence-embedded-image")){var b=d(a),a={destination:b.attr("src"),url:b.attr("src"),border:b.attr("class")&&b.attr("class").indexOf("confluence-content-image-border")!==-1?1:0,width:b.prop("width"),height:b.prop("height"),originalSelected:!b.attr("width")&&
!b.attr("height")};if(!k.isRemoteImg(a.destination)&&!d(b).hasClass("confluence-external-resource")){var f=a;var b=d(b).attr("src"),c=b.match(s);if(c&&c.length===3)b=c[2];else{m.log("ERROR: could not parse page id from image url "+b);b="0"}f.pageId=b}return d.extend({},a)}if(a.destination){a.imageFileName=a.imageFileName||a.destination;return d.extend({},a)}return null},ImageUtils:k}});
require("confluence/module-exporter").safeRequire("confluence-editor/utils/tinymce-image-utils",function(d){var m=require("tinymce");m.confluence.ImageProperties=d.ImageProperties;m.confluence.ImageUtils=d.ImageUtils});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:property-panel-image-link-macro-conf-frontend', location = 'tinymce3/plugins/propertypanel/js/property-panel-links.js' */
define("confluence-editor/tinymce3/plugins/propertypanel/js/property-panel-links",["ajs","jquery","confluence/legacy","tinymce","window"],function(a,e,i,j,k){var h=0;return{name:"link",canHandleElement:function(a){return a.is("a")&&"#"!=a.attr("href")&&!a.hasClass("unresolved")},handle:function(f){var c=f.containerEl,g=f.ed,b=function(c){return a.Rte.getEditor().translate(c)},f={anchorIframe:a.Rte.getEditorFrame()},d=0===(c.getAttribute("href")||"").indexOf("#"),b=[{className:"link-property-panel-goto-button",
text:b("propertypanel.links_goto"),tooltip:d?b("propertypanel.links_goto_disabled_tooltip"):c.href,href:c.href,disabled:d,click:function(){a.Confluence.PropertyPanel.destroy();var b=k.open(c.href,j.isIE?"_blank":"confluence-goto-link-"+a.params.pageId+"-"+h);b.focus();b.opener=null}},{className:"link-property-panel-edit-button",text:b("propertypanel.links_edit"),tooltip:b("propertypanel.links_edit_tooltip"),disabled:e(c).hasClass("createlink")||!c.href,click:function(){a.Confluence.PropertyPanel.destroy();
g.selection.select(c);i.Editor.LinkBrowser.open()}},{className:"link-property-panel-unlink-button",text:b("propertypanel.links_unlink"),tooltip:b("propertypanel.links_unlink_tooltip"),click:function(){a.Confluence.PropertyPanel.destroy();g.execCommand("mceConfUnlink",!1,c);g.focus()}}],d=[];a.trigger("link-property-panel-buttons.created",{buttons:d,link:c});b=b.concat(d);a.Confluence.PropertyPanel.createFromButtonModel(this.name,c,b,f);h++}}});
require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/tinymce3/plugins/propertypanel/js/property-panel-links","AJS.Confluence.PropertyPanel.Link",function(a){var e=require("ajs");e.bind("init.rte",function(){e.trigger("add-handler.property-panel",a)})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:property-panel-image-link-macro-conf-frontend', location = 'tinymce3/plugins/propertypanel/js/property-panel-macros.js' */
define("confluence-editor/tinymce3/plugins/propertypanel/js/property-panel-macros","ajs tinymce jquery confluence/legacy document confluence/macro-js-overrides underscore".split(" "),function(b,m,d,s,n,t,u){var o=[],p=[],l={},k="__PROPERTY_PANEL_SPACER",v=[{key:k}];return{name:"macro",registeredEvents:o,canHandleElement:function(a){return a.hasClass("editor-inline-macro")||a.hasClass("wysiwyg-macro")},handle:function(a){function i(){var c="macro-placeholder-property-panel-remove-button";e.length>
0&&e[e.length-1].key==k&&(c=c+" first");h.push({className:c,text:"Remove",click:function(){b.Confluence.PropertyPanel.destroy();b.Rte.getEditor().execCommand("mceConfRemoveMacro",j)}});if(g.attr("data-macro-parameters")){var a=s.MacroParameterSerializer.deserialize(g.attr("data-macro-parameters"));if("atlassian-macro-output-type"in a){c=function(c){return function(b){a["atlassian-macro-output-type"]=c;g.attr("data-macro-parameters",s.MacroParameterSerializer.serialize(a));
c=="INLINE"?d(".macro-placeholder-property-panel-display-newline-button").removeClass("active"):d(".macro-placeholder-property-panel-display-inline-button").removeClass("active");d(b).addClass("active")}};h.push(null);h.push({className:"macro-placeholder-property-panel-display-newline-button",tooltip:"Display on new line",selected:a["atlassian-macro-output-type"]=="BLOCK",click:c("BLOCK")});h.push({className:"macro-placeholder-property-panel-display-inline-button",
tooltip:"Display inline",selected:a["atlassian-macro-output-type"]=="INLINE",click:c("INLINE")})}}d.each(o,function(){(!this.macroName||this.macroName==f)&&d(n).bind(q(this.id,this.macroName),this.handler)});c=p;f&&l[f]&&(c=c.concat(l[f]));d.each(c,function(){try{this(j,h,w)}catch(c){b.debug("Property panel init handler failed for : "+f+".  Is global handler : "+(d.inArray(this,p)>-1),c)}});if(h.length>0){var c=b.Confluence.PropertyPanel.createFromButtonModel("macro",
j,h,w),x=t.getFunction(f,"propertyPanelIFrameInjector");x&&x(c)}}if(!(a.e.type!=="click"&&a.e.type!=="mouseup")){var j=a.containerEl,g=d(j),f,e=[],a=!g.hasClass("editor-inline-macro"),y=!g.hasClass("wysiwyg-unknown-macro"),h=[],w={originalHeight:a&&g.height(),anchorIframe:b.Rte.getEditorFrame()},q=function(c,a){return c+"-button-click"+(a?a+".macro":"")+".property-panel"};if(y){var r=d.Deferred();f=g.attr("data-macro-name");if(b.MacroBrowser.getMacroMetadata(f))e=b.MacroBrowser.getMacroMetadata(f).buttons;
(a=t.getFunction(f,"getControls"))?a(function(a){var b=e,a=u.filter(a,function(a){return a.type==="button"}),a=u.map(a,function(a){return{key:a.key,label:a.name.value}});e=b.concat(v).concat(a).concat(v);r.resolve()}):r.resolve();r.done(function(){var a="macro-placeholder-property-panel-edit-button";e.length>0&&e[0].key==k&&(a=a+" last");h.push({className:a,text:"Edit",click:function(){b.Confluence.PropertyPanel.destroy();m.confluence.macrobrowser.editMacro(g)}});
d.each(e,function(a,c){if(c.key!=k){var i="macro-property-panel-"+c.key;a>0&&e[a-1].key==k&&(i=i+" first");a<e.length-1&&e[a+1].key==k&&(i=i+" last");h.push({className:i,text:c.label,parameterName:c.key,click:function(){d(n).trigger(q(c.key),g);d(n).trigger(q(c.key,f),g);b.Confluence.PropertyPanel.destroy()}})}})}).then(i())}else i()}},registerButtonHandler:function(a,b,d){Array.isArray(a)||(a=[a]);a.forEach(function(a){o.push({id:a,handler:b,macroName:d})})},registerInitHandler:function(a,b){if(b){l[b]=
l[b]||[];l[b].push(a)}else p.push(a)},yieldButtonFor:function(a,b){var j;d.each(a,function(){this.parameterName&&this.parameterName==b&&(j=this)});return j}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/tinymce3/plugins/propertypanel/js/property-panel-macros","AJS.Confluence.PropertyPanel.Macro",function(b){var m=require("ajs");m.bind("init.rte",function(){m.trigger("add-handler.property-panel",b)})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:property-panel-image-link-macro-conf-frontend', location = 'tinymce3/plugins/propertypanel/js/property-panel-images.js' */
define("confluence-editor/tinymce3/plugins/propertypanel/js/property-panel-images","jquery ajs tinymce confluence-editor/utils/tinymce-image-utils confluence/meta confluence/legacy confluence/api/browser confluence/property-panel".split(" "),function(f,g,s,F,v,w,G,h){function x(){var a=[];f.each(t,function(b,c){a.push(c)});h.current.panel.find(a.join(", ")).removeClass("active")}function p(a,b,c){var e=y(a,b),c=y(a,c),j=e||c;if(j){var d=h.getAnchor(),i=d.width(),d=d.height(),f=v.get("max-thumb-width"),
g=v.get("max-thumb-height");a.thumbnail=k.isRemoteImg(a.destination)?false:k.isThumbnailUsable(e,c,i,d,f,g);a.originalSelected=false;if(b){delete a.height;a.width=j}else{delete a.width;a.height=j}m(a);x();return true}return false}function z(a,b){if(u?p(a,n[b]):p(a,null,n[b])){A(b);m(a);return true}return false}function B(a){delete a.width;delete a.height;a.thumbnail=false;a.originalSelected=true;x();A("original");var b=h,c=b.getAnchor();b.current.updating=true;c.one("load",function(){l(b);q(a);a.width=
Math.floor(c.width());a.height=Math.floor(c.height())});k.updateImageElement(c,a);s.isGecko&&g.Rte.getEditor().execCommand("mceRepaint",false);c.each(function(){this.complete&&f(this).trigger("load")});return true}function A(a){h.current.panel.find(t[a]).addClass("active")}function C(a){f(".image-border-toggle").toggleClass("active",!a.border);a.border=+!a.border||false;m(a)}function m(a){var b=h,c=b.getAnchor(),e=c.attr("src"),f=c.height();b.current.updating=true;k.updateImageElement(c,a);s.isGecko&&
g.Rte.getEditor().execCommand("mceRepaint",false);if(a.src!=e){var d=setInterval(function(){var a=c.height();if(a!=f){g.debug("updateImageElement : height changed after image src change - "+f+" to "+a);clearTimeout(d);d=null;l(b)}},10);setTimeout(function(){if(d){clearTimeout(d);d=null;l(b)}},1E3)}else l(b);q(a)}function q(a){a=a.width?a.width:h.getAnchor().width();a=Math.floor(a);f("#image-size-input").val(a+"px")}function y(a,b){b=parseInt(b);if(!isNaN(b)){b<D?b=D:b>E&&(b=E);return b}return null}
var k=F.ImageUtils,u=k.isScaledByWidth(),n;n=u?{small:100,medium:300,large:500}:{small:150,medium:250,large:400};var t={small:".image-size-small",medium:".image-size-medium",large:".image-size-large",original:".image-size-original"},D=16,E=9E4,l=function(a){a.current.updating=false;a.current.snapToElement({animate:true,animateDuration:100})};return{_resizeImage:p,pluginButtons:[],name:"image",getPresetImageSize:function(a){return n[a]},canHandleElement:function(a){return a.is("img")&&!a.hasClass("editor-inline-macro")&&
!a.hasClass("template-variable")},handle:function(a){function b(){p(e,f("#image-size-input").val())?true:q(e);g.trigger("analyticsEvent",{name:"confluence.editor.image.resize.custom"})}var c;c=a.nodeName==="IMG"?a:a.containerEl;var a=f(c),e=s.confluence.ImageProperties(c);if(e&&!a.attr("data-resource-id")){var j=g.Rte.getEditor(),d=function(a){return j.translate(a)},i=function(a){return{className:["image-size-"+a,"editor-resize","resize-"+a].join(" "),text:d("propertypanel.images_"+a),tooltip:d("propertypanel.images_"+
a+"_tooltip"),iconClass:"aui-icon aui-icon-small aui-iconfont-image-resize",click:function(){z(e,a);g.trigger("analyticsEvent",{name:"confluence.editor.image.resize."+a})},selected:u?e.width==n[a]:e.height==n[a]}},i=[{className:"editable",tooltip:d("propertypanel.images_sizing_tooltip"),html:'<input id="image-size-input"/>'},null,i("small"),i("medium"),i("large"),{className:"image-size-original",text:d("propertypanel.images_original"),tooltip:d("propertypanel.images_original_tooltip"),click:function(){B(e);
g.trigger("analyticsEvent",{name:"confluence.editor.image.resize.original"})},selected:e.originalSelected},null,{className:"image-border-toggle",text:d("propertypanel.images_border"),tooltip:d("propertypanel.images_border_tooltip"),click:function(){C(e)},selected:e.border||e.border==1}];i.push(null);var k=a.parent();if(k.is("a[href]")){i.push({className:"image-link-edit",text:d("propertypanel.images_link_edit"),tooltip:d("propertypanel.images_link_edit_tooltip"),click:function(){h.destroy();j.selection.select(k[0]);
w.Editor.LinkBrowser.open()}});i.push({className:"image-link-remove",text:d("propertypanel.images_link_remove"),tooltip:d("propertypanel.images_link_remove_tooltip"),click:function(){h.destroy();j.execCommand("mceConfUnlink",false,c);j.focus()}})}else i.push({className:"image-make-link",text:d("propertypanel.images_link_create"),tooltip:d("propertypanel.images_link_create_tooltip"),iconClass:"aui-icon aui-icon-small aui-iconfont-link",click:function(){h.destroy();j.selection.select(c);w.Editor.LinkBrowser.open()}});
for(var l=h.Image.pluginButtons,r=0;r<l.length;r++)if(l[r]===null)i.push(null);else{var m=l[r].create(a);m&&i.push(m)}h.createFromButtonModel(this.name,c,i,{anchorIframe:g.Rte.getEditorFrame()});a=f("#image-size-input");a.bind("focus",function(){f(this).select()});a.bind("change",function(){b()});(new G(window.navigator.userAgent)).isIE()&&a.bind("keyup",function(a){a.keyCode===13&&b()});h.current.imageProps=e;q(e);var o=e;return{setPresetSize:function(a){z(o,a)},setPixelSize:function(a){p(o,a)},
setToOriginalSize:function(){B(o)},toggleBorder:function(){C(o)},getWidth:function(){return o.width},getHeight:function(){return o.height},getDisplayWidth:function(){return f("#image-size-input").val()},isButtonSelected:function(a){return h.current.panel.find(t[a]).hasClass("active")}}}}}});
require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/tinymce3/plugins/propertypanel/js/property-panel-images","AJS.Confluence.PropertyPanel.Image",function(f){var g=require("ajs");g.bind("init.rte",function(){g.trigger("add-handler.property-panel",f)})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:property-panel-image-link-macro-conf-frontend', location = 'tinymce3/plugins/imageproperties/js/image-properties-dialog.js' */
define("confluence-editor/tinymce3/plugins/imageproperties/js/image-properties-dialog",["jquery","ajs"],function(d,a){function l(){h||(h=d("#image-properties-tab-items > div").map(function(){var a=d(this);return{key:a.text(),weight:a.attr("data-weight"),label:this.title}}).sort(function(a,b){return a.weight-b.weight}));return h}function m(){var a=c.popup.element,b=650/60,e=d('<div class="image-properties-loading-blanket"><div class="loading-data"></div></div>').appendTo(a.find(".dialog-page-body")),
f=e.find(".loading-data");e.css({width:e.parent().width(),height:a.height()});f.css({marginTop:-60,marginLeft:-60});f.spin({color:"#666",width:b,radius:25,length:25,top:0,left:0,zIndex:0,speed:1.042});var a=[],g;for(g in i)b=i[g],(b=b.saveFn&&b.saveFn())&&b.done&&a.push(b);d.when.apply(d,a).done(function(){var a=c.popup.element.find(".image-properties-loading-blanket .loading-data");a.css({marginTop:"",marginLeft:""});a.spinStop();a.closest(".image-properties-loading-blanket").remove();c.hide().remove()})}
function o(){c.hide().remove()}var c,h,i={},n;return{init:function(){n||(h=null,0<l().length&&(n=!0,a.Confluence.PropertyPanel.Image.pluginButtons.push(null,{create:function(){return{className:"image-properties",text:"Properties",tooltip:"Set additional image properties",click:function(h,b){a.trigger("analyticsEvent",{name:"confluence.editor.image-properties-trigger"});a.Confluence.PropertyPanel.destroy();d("#image-properties-dialog").remove();c=new a.ConfluenceDialog({id:"image-properties-dialog",
onSubmit:m});a.trigger("dialog-created.image-properties",{img:b});c.popup.element.attr("data-tab-default","0");c.addHeader("Image Properties");c.addSubmit("Save",m);c.addCancel("Cancel",o);for(var e=c,f=l(),g=0;g<f.length;g++){var j=f[g],k=i[j.key];k&&e.addPanel(j.label,k.content,k.panelClass,j.key)}1===f.length&&e.popup.element.find(".dialog-page-menu").show();a.trigger("dialog-before-show.image-properties");
c.show()}}}})))},registerPanel:function(a,b,c,d){i[a]={content:b,panelClass:c,saveFn:d}}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/tinymce3/plugins/imageproperties/js/image-properties-dialog","Confluence.Editor.ImageProps",function(d){var a=require("ajs");a.toInit(d.init);a.bind("quickedit.success",d.init)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-templates:template-editor-variables-resources', location = 'js/variable-manager.js' */
define("confluence-templates/variable-manager",["confluence/api/event","jquery"],function(f,g){function i(c,a){var b=c.toLocaleLowerCase(),d=a.toLocaleLowerCase(),b=b.localeCompare(d);0==b&&(b=c.localCompare(a));return b}function h(c){return g.extend(!0,{},e.defaults[c]||e.defaults.string)}var e=function(){var c={};return{find:function(a){var a=a.toLocaleLowerCase(),b={},d;for(d in c)if(c.hasOwnProperty(d)&&(!a.length||0===d.toLocaleLowerCase().indexOf(a)))b[d]=c[d];return b},contains:function(a){return!!c[a]},
get:function(a){return c[a]},getAll:function(){return g.extend(!0,{},c)},getSortedNames:function(){var a=[],b;for(b in c)a.push(b);return a.sort(i)},add:function(a,b){c[a]=b||h();f.trigger("add.confluence-variable",{name:a,details:g.extend(!0,{},b)})},del:function(a){var b=c[a];delete c[a];f.trigger("delete.confluence-variable",{name:a,details:g.extend(!0,{},b)})},rename:function(a,b){var d=c[a];delete c[a];d&&(c[b]=d,f.trigger("rename.confluence-variable",{oldName:a,newName:b,details:g.extend(!0,
{},details)}))},createDefault:h}};e.defaultVariableManager=e();e.defaults={textarea:{type:"textarea",rows:5,columns:100},list:{type:"list",options:[]},string:{type:"string"}};return e});"template"===AJS.Meta.get("content-type")&&require("confluence/module-exporter").safeRequire("confluence-templates/variable-manager",function(f){require("confluence/legacy").VariableManager=f});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-templates:template-editor-variables-resources', location = 'js/variable-placeholder.js' */
define("confluence-templates/variable-placeholder",["ajs","jquery"],function(a,d){return{component:{insertPlaceholder:function(c,e){var b;b="$"+c;var f=a.Rte.getEditor();a.Rte.BookmarkManager.storeBookmark();b={title:b,src:a.Meta.get("context-path")+"/plugins/servlet/confluence/placeholder/template-variable?name="+encodeURIComponent(c),"data-variable-name":c,"class":"template-variable",alt:"$"+c};e&&d.extend(b,e);b=d("<img/>").attr(b);f.selection.setNode(b[0])}},init:function(){d(a.Rte.getEditor().getBody()).delegate("img.template-variable",
"dragstart",function(a){a.preventDefault()})}}});"template"===AJS.Meta.get("content-type")&&require("confluence/module-exporter").safeRequire("confluence-templates/variable-placeholder",function(a){require("confluence/legacy").VariablePlaceHolder=a.component;require("ajs").bind("init.rte",a.init)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-templates:template-editor-variables-resources', location = 'js/variable-toolbar.js' */
define("confluence-templates/variable-toolbar",["ajs","document","confluence/api/event","jquery","confluence/legacy"],function(e,k,h,f,c){return{init:function(){h.bind("init.rte",function(){var g=c.VariableManager.defaultVariableManager,a=f("#template-menu"),i=a.find(".variables-list");h.bind("add.confluence-variable,delete.confluence-variable,rename.confluence-variable",function(){var b=g.getSortedNames(),j=b.length,d="";i.toggleClass("hidden",!j);for(var a=0;a<j;a++)d+=c.Templates.Variables.renderVariableItem({variableName:"$"+
b[a],tooltip:e.format("Insert the \u0027\u0027{0}\u0027\u0027 field into the page for the template user to fill out.",b[a])});i.html(d)});a.delegate(".variables-list a","click",function(){var b=f(this).attr("data-variable-name");!g.contains(b)&&g.add(b);c.VariablePlaceHolder.insertPlaceholder(b)});a.delegate(".variables-add","click",function(b){var a=c.Editor.Autocompleter.Manager.getInputDrivenDropdown();e.Rte.getEditor().focus();(!a||a.inactive)&&c.Editor.Autocompleter.Manager.shortcutFired("$",!0);b.stopPropagation()});f(k).bind("showLayer",
function(b,c,d){"dropdown"===c&&d.$.closest(a).length&&d.reset()})})}}});"template"===AJS.Meta.get("content-type")&&require("confluence/module-exporter").safeRequire("confluence-templates/variable-toolbar",function(e){e.init()});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-templates:template-editor-variables-resources', location = 'js/autocomplete-settings-variables.js' */
define("confluence-templates/autocomplete-settings-variables",["confluence/legacy","ajs"],function(d,c){return function(){function e(a,b){return{callback:function(c){c.replaceWithSelectedSearchText();!f.contains(a)&&f.add(a);d.VariablePlaceHolder.insertPlaceholder(a,b)},name:c.escapeHtml(a),href:"#"}}function i(a,b){return!a&&!b?0:!a?-1:!b?1:a.toLocaleLowerCase().localeCompare(b.toLocaleLowerCase())}var f=d.VariableManager.defaultVariableManager;return{ch:"$",cache:!1,endChars:[],dropDownDelay:0,
preventStartNodes:"",dropDownClassName:"autocomplete-variables",selectFirstItem:!0,getHeaderText:function(a,b){return b?"Variable suggestions":"Variable suggestions"},getAdditionalLinks:function(a,b){var e=d.unescapeEntities(b);return f.get(e)||0===b.length?[]:[{className:"dropdown-create-variable",href:"#",callback:function(a){var b=a.plainText();a.replaceWithSelectedSearchText();!f.contains(b)&&f.add(b);d.VariablePlaceHolder.insertPlaceholder(b,
void 0)},name:c.format("Create variable \u0027\u0027{0}\u0027\u0027",b)}]},getDataAndRunCallback:function(a,b,c){var g,k,a=d.unescapeEntities(b),j=f.find(a),h=[],l=[];for(g in j)j.hasOwnProperty(g)&&h.push(g);h.sort(i);a=0;for(k=h.length;a<k;a++)g=h[a],l.push(e(g,j[g]));c([l],b)},update:function(){}}}});
require("confluence/module-exporter").safeRequire("confluence-templates/autocomplete-settings-variables",function(d){var c=require("ajs"),e=require("confluence/legacy"),i=require("confluence/meta");c.bind("init.rte",function(){var c=require("tinymce");"template"===i.get("content-type")&&(e.Editor.Autocompleter||(e.Editor.Autocompleter=c.confluence.Autocompleter),e.Editor.Autocompleter.Settings.$=d())})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-templates:template-editor-variables-resources', location = 'js/property-panel-variables.js' */
define("confluence-templates/property-panel-variables",["ajs","jquery","confluence/legacy"],function(b,a,h){return{name:"variable",canHandleElement:function(a){return a.hasClass("template-variable")},handle:function(f){function l(d){b.debug("clicked type: "+d);var c=a("#property-panel");c.find(".panel-buttons").toggleClass("no-inputs","string"===d);c.find(".textarea-section,.list-section,.string-section").addClass("hidden");c.find("."+d+"-section").removeClass("hidden");"textarea"===d?(a("#variable-property-panel-textarea-rows").val(e.rows),
a("#variable-property-panel-textarea-columns").val(e.columns)):"list"===d&&a("#variable-property-panel-list-values").val(e.options.join(","))}function i(d,b,c){return{className:"variable-property-panel-type-item variable-property-panel-type-"+d,text:b,tooltip:c,selected:m===d,click:function(){e.type=d;e=j.createDefault(d);j.add(k,e);a(".variable-property-panel-type-item").removeClass("selected");a(".variable-property-panel-type-"+d).addClass("selected");l(d)}}}function g(a){return m===a?"":" hidden"}
if(!("click"!==f.e.type&&"mouseup"!==f.e.type)){var f=f.containerEl,n=a(f),k,c=[],o={originalHeight:n.height(),anchorIframe:b.Rte.getEditorFrame()};k=n.attr("data-variable-name");var j=h.VariableManager.defaultVariableManager,e=j.get(k),m=e&&e.type||"string";c.push(i("string","Text","Single line text input field."));c.push(i("textarea","Multi-line Text","Multi-line text input field."));
c.push(i("list","List","Drop down list."));c.push(null);c.push({className:"editable textarea-section"+g("textarea"),tooltip:"Number of rows to display for the field.",html:'<input id="variable-property-panel-textarea-rows"/>'});c.push({className:"variable-property-panel-textarea-split textarea-section"+g("textarea"),tooltip:"",html:"<span>x</span>"});c.push({className:"editable textarea-section"+
g("textarea"),tooltip:"Number of columns to display for the field.",html:'<input id="variable-property-panel-textarea-columns"/>'});c.push(null);c.push({className:"editable list-section"+g("list"),tooltip:"Enter each item for the list, separating each with a comma.",html:"<input id=\"variable-property-panel-list-values\" size='50'/>"});b.Confluence.PropertyPanel.createFromButtonModel("variable",f,c,o);l(e.type);a("#variable-property-panel-textarea-rows").change(function(){e.rows=
+a(this).val()||h.VariableManager.defaults.textarea.rows});a("#variable-property-panel-textarea-columns").change(function(){e.columns=+a(this).val()||h.VariableManager.defaults.textarea.columns});a("#variable-property-panel-list-values").change(function(){var d,b,c,f=a(this).val().split(",");e.options=[];d=0;for(b=f.length;d<b;d++)(c=a.trim(f[d]))&&e.options.push(c)});a("#variable-property-panel-textarea-rows,#variable-property-panel-textarea-columns,#variable-property-panel-list-values").keypress(function(b){13===
b.which&&a(this).blur()})}}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-templates/property-panel-variables","AJS.Confluence.PropertyPanel.Variable",function(b){var a=require("ajs");a.bind("init.rte",function(){a.trigger("add-handler.property-panel",b)})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-templates:template-editor-variables-resources', location = 'js/variable-marshaller.js' */
define("confluence-templates/variable-marshaller",["ajs","jquery","confluence/legacy"],function(d,b,p){function q(c){var a=c.attr("data-variable-type");return"textarea"===a?{type:a,rows:+c.attr("data-variable-rows")||i,columns:+c.attr("data-variable-columns")||r}:"list"===a?{type:a,options:c.find("li").map(function(){return b(this).attr("data-variable-option")}).toArray()}:{type:"string"}}function m(){var c=b(d.Rte.getEditor().getBody()).find("img[data-variable-name]"),a={};b.map(c,function(c){var f=
{};b(c).attr("data-variable-raw-xhtml")&&(f={"data-variable-raw-xhtml":!0});a[b(c).attr("data-variable-name")]=f});return a}var i=5,r=100;return function(){function c(a){for(var b in a)a.hasOwnProperty(b)&&!f.contains(b)&&(d.debug("adding: ",b),f.add(b,a[b]))}var a=d.Rte.getEditor(),i=b(a.getBody()),f=p.VariableManager.defaultVariableManager;a.on("GetContent",function(a){var d=b("<div></div>"),i=b("<ul></ul>").attr("data-variable-declarations","true"),e;d.append(i);var n=m();c(n);var o=f.getAll(),
l;for(l in o)if(n.hasOwnProperty(l)){var j=l;e=o[l];var g=void 0,k=void 0,g=e.type,h=b("<li></li>");h.attr("data-variable-name",j);h.attr("data-variable-type",g);h.text(j);if("textarea"===g)h.attr("data-variable-rows",e.rows),h.attr("data-variable-columns",e.columns);else if("list"===g){g=b("<ul></ul>");j=void 0;for(j in e.options)k=e.options[j],k=b("<li></li>").text(k).attr("data-variable-option",k),g.append(k);h.append(g)}e=h;i.append(e)}a.content=d.html()+a.content});a=i.find("ul[data-variable-declarations]");
a.remove();a.find("li[data-variable-name]").each(function(){var a=b(this);f.add(a.attr("data-variable-name"),q(a))});c(m())}});"template"===AJS.Meta.get("content-type")&&require("confluence/module-exporter").safeRequire("confluence-templates/variable-marshaller",function(d){require("ajs").bind("init.rte",d)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-templates:template-editor-variables-template-resources', location = 'js/variable-templates.soy' */
// This file was automatically generated from variable-templates.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Variables.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Variables == 'undefined') { Confluence.Templates.Variables = {}; }


Confluence.Templates.Variables.renderVariableItem = function(opt_data, opt_ignored) {
  return '<li class="dropdown-item" data-tooltip="' + soy.$$escapeHtml(opt_data.tooltip) + '"><a href="#" class="item-link variable-item" title="' + soy.$$escapeHtml(opt_data.variableName) + '" data-variable-name="' + soy.$$escapeHtml(opt_data.variableName) + '">' + soy.$$escapeHtml(opt_data.variableName) + '</a></li>';
};
if (goog.DEBUG) {
  Confluence.Templates.Variables.renderVariableItem.soyTemplateName = 'Confluence.Templates.Variables.renderVariableItem';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-fixed-headers:confluence-fixed-headers-editor-resources', location = '/js/slow-edit-handler.js' */
require(["confluence/fh/utils/dom","ajs"],function(c,a){a.toInit(function(){var b=a.Meta.get("browse-page-tree-mode");if("create"===b||"edit"===b)c.addClassToPage(),$("#content").css({paddingRight:0})})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.share-page:edit-resources', location = 'js/edit-init.js' */
require(["ajs","confluence/meta","confluence/share-page/service/share-page","confluence/share-page/service/share-dialog-loader","confluence/dark-features"],function(a,b,k,l,m){function g(){if("page"===b.get("content-type")||"blogpost"===b.get("content-type")){var c=a.$;if(m.isEnabled("react.share.dialog")){var h=c("\x3cdiv\x3e").addClass("invite-to-edit-container").tooltip({title:function(){return "Invite people to edit with you"},gravity:"ne"});h.append(c("\x3cspan\x3e").attr("id",
"share-react-link"));c("#rte-toolbar").prepend(h);l.init("share-react-link","edit")}else{c("#rte-toolbar").prepend(c(document.createElement("div")).prop("id","#inviteToEditLink".replace("#","")).addClass("aui-button").addClass("invite-to-edit-button").html('\x3cspan class\x3d"invite-plus-icon"\x3e\x3c/span\x3e').tooltip({title:function(){return "Invite people to edit with you"},gravity:"ne"}));var e=c("#inviteToEditLink");c="page"===b.get("content-type")?"Let\u0027s work together on this page":
"Let\u0027s work together on this blog post";k.initDialog("#inviteToEditLink","inviteToEditPopup",{},{heading:"Invite people to edit",notePlaceholder:c,link:function(){return require("confluence/share-page/fetch/content-info")(b.get("content-id"),"draft").pipe(function(d){return b.get("base-url")+d._links.edit})},entityId:function(){return b.get("draft-id")},restriction:function(){return require("confluence/share-page/fetch/content-restrictions")(b.get("content-id")).pipe(function(d){var f=
{};if(d.read.restrictions.user.size||d.read.restrictions.group.size||d.update.restrictions.user.size||d.update.restrictions.group.size)f.type="restrict",f.message="Restrictions on this page may prevent people viewing or editing.";return f})},copyOption:"invite",shareType:"edit",contentType:b.get("content-type"),errorText:"An unexpected error occurred. Please try again.",beforeLoad:function(){e.find(".invite-plus-icon").css("visibility","hidden");e.spin()},afterLoad:function(){e.find(".invite-plus-icon").css("visibility","visible");
e.spinStop()}})}}}"collaborative"===b.get("edit-mode")&&b.get("remote-user")&&(a.Rte.getEditor()&&a.Rte.getEditor().initialized?g():a.bind("rte-collab-ready",g))});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:split_aui.deprecated.pattern.toolbar1', location = 'aui.chunk.2e5a57e4e871239c85ed--04322bc020cb0bd3caaf.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["aui.deprecated.pattern.toolbar1"],{DHJP:function(i,n,t){"use strict";t.r(n)}},[["DHJP","runtime"]]]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.keyboardshortcuts:confluence-tinymce-keyboard-shortcuts', location = 'js/tinymce-plugin.js' */
define("confluence-keyboard-shortcuts/tinymce-plugin",["ajs","confluence-keyboard-shortcuts/confluence-keyboard-shortcuts"],function(e,b){return{init:function(a){e.debug("Init Editor Keyboard shortcuts plugin");for(var c=function(b){return function(){a.execCommand("FormatBlock",!1,b)}},d=1;7>d;d++)a.addCommand("FormatBlock-h"+d,c("h"+d));a.addCommand("FormatBlock-p",c("p"));a.addCommand("FormatBlock-pre",c("pre"));a.addCommand("FormatBlock-blockquote",c("blockquote"));a.addCommand("mceConfShortcutDialog",
b.keyboardShortcuts.openDialog);a.ui.registry.addButton("help",{text:"confluence.conf_shortcuts_help_desc",onAction:function(){a.execCommand("mceConfShortcutDialog")}})},getInfo:function(){var a=require("tinymce");return{longname:"Atlassian Editor Keyboard Shortcuts Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:a.majorVersion+"."+a.minorVersion}}}});
require("confluence/module-exporter").safeRequire("confluence-keyboard-shortcuts/tinymce-plugin",function(e){var b=require("tinymce");b.create("tinymce.plugins.KeyboardShortcutsPlugin",e);b.PluginManager.add("keyboardshortcuts",b.plugins.KeyboardShortcutsPlugin)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.image.effects.ImageEffectsPlugin:propertiespanel', location = 'com/atlassian/confluence/image/effects/property-panel.js' */
AJS.toInit(function(e){function r(){AJS.bind("dialog-created.image-properties",function(a,d){b=d.img;l()?b.naturalHeight&&b.naturalWidth&&16E6<b.naturalHeight*b.naturalWidth?Confluence.Editor.ImageProps.registerPanel("image-effects",g("This image is too large to rotate or apply image effects. You\u0027ll need to upload a smaller version of the file."),"image-effects-panel",null):Confluence.Editor.ImageProps.registerPanel("image-effects",g(),"image-effects-panel",t):Confluence.Editor.ImageProps.registerPanel("image-effects",g("Image effects can\u0027t be applied to web images"),
"image-effects-panel",null)});AJS.bind("dialog-before-show.image-properties",function(){m();n(h(e(b)))})}function u(){var a=new AJS.Dialog({width:600,height:500,id:"image-effects-dialog"});a.addHeader("Add Image Effect");a.addPanel("",g(),"");m();a.addSubmit("Save",function(){p(v,w).done(function(){a.hide()})});a.addCancel("Close",function(){a.hide()});AJS.Confluence.PropertyPanel.Image.pluginButtons.push(null,
{create:function(d){b=d[0];d=h(d);var c=!l();return{className:"image-effects",text:"Effects...",tooltip:c?"Image effects can\u0027t be applied to web images":"Add an image effect like drop shadow or picture frame",click:function(){if(b.naturalHeight&&b.naturalWidth&&16E6<b.naturalHeight*b.naturalWidth)return alert("This image is too large to rotate or apply image effects. You\u0027ll need to upload a smaller version of the file."),!1;n(h(e(b)));AJS.Confluence.PropertyPanel.destroy();a.show()},disabled:c,selected:!!d}}})}function x(a,
d){var c=a.attr("src"),b=y.exec(c),e=d?"effects\x3d"+d:"";b?c=c.replace(b[2],e):d&&(c=c+(-1!=c.indexOf("?")?"\x26":"?")+e);a.attr("src",c);a.attr("data-mce-src",c);d=(d=a.attr("confluence-query-params"))?(b=q.exec(d))?d.replace(b[2],e):d+"\x26"+e:e;a.attr("confluence-query-params",d)}function h(a){a=a.attr("confluence-query-params");if(a=q.exec(a))return a[3]}function n(a){e(".image-effect-preview.selected").removeClass("selected");a?e(f).each(function(d,c){if(c.effects==a)return e(e(".image-effect-preview")[d]).addClass("selected"),
!1}):e(".image-effect-preview.image-effect-none").addClass("selected");k=a}function g(a){return a?'\x3cdiv class\x3d"aui-message aui-message-warning warning"\x3e\x3cspan class\x3d"aui-icon icon-warning"\x3e\x3c/span\x3e'+a+"\x3c/div\x3e":'\x3cdiv class\x3d"image-effects"\x3e\x3cul class\x3d"image-list"\x3e\x3c/ul\x3e\x3c/div\x3e'}function m(){for(var a=e("div.image-effects ul.image-list"),d=Math.floor(22*Math.random())+1,c=0;c<f.length;c++){var b=e('\x3cli class\x3d"attached-image image-effect-preview'+
(f[c].effects?"":" image-effect-none")+'"\x3e\x3cdiv class\x3d"image-container"\x3e\x3cimg class\x3d"thumbnail" src\x3d"'+AJS.contextPath()+"/plugins/servlet/imgFilter.png?preview\x3dtrue\x26id\x3d"+d+"\x26effects\x3d"+f[c].effects+'" title\x3d"'+f[c].name+'" style\x3d"margin-top: 5px"\x3e\x3c/div\x3e\x3cspan class\x3d"caption filename" title\x3d"'+f[c].name+'"\x3e'+f[c].name+"\x3c/span\x3e\x3c/li\x3e");b.hover(function(){e(this).addClass("hover")},function(){e(this).removeClass("hover")});a.append(b);
b.click(f[c],function(a){e(".image-effect-preview.selected").removeClass("selected");e(this).addClass("selected");k=a.data.effects})}}function l(){return!e(b).hasClass("confluence-external-resource")}function t(){return p()}function p(a,d){function c(){d&&d();f.resolve();b.onload=null;tinyMCE.activeEditor.undoManager.add()}var f=e.Deferred();a&&a();b.onload=c;a=b.src;x(e(b),k);b.src==a&&c();return f}function v(){var a=dialog.popup.element,b=650/60,c=e('\x3cdiv class\x3d"image-properties-loading-blanket"\x3e\x3cdiv class\x3d"loading-data"\x3e\x3c/div\x3e\x3c/div\x3e').appendTo(a.find(".dialog-page-body")),
f=c.find(".loading-data");c.css({width:c.parent().width(),height:a.height()});f.css({marginTop:-60,marginLeft:-60});f.spin({color:"#666",width:b,radius:25,length:25,top:0,left:0,zIndex:0,speed:1.042})}function w(){var a=dialog.popup.element.find(".image-properties-loading-blanket .loading-data");a.css({marginTop:"",marginLeft:""});a.spinStop();a.closest(".image-properties-loading-blanket").remove()}var b,y=/(\?|&)(effects=[^&]+)($|&)/,q=/(^|&)(effects=([^&]+))($|&)/,k=null,f=[];f.push({name:"None",
effects:null});f.push({name:"Taped",effects:"border-simple,blur-border,tape"});f.push({name:"Instant Camera",effects:"border-polaroid,blur-border"});f.push({name:"Curl Shadow",effects:"border-simple,shadow-kn"});f.push({name:"Snapshot",effects:"border-simple,blur-border"});f.push({name:"Drop Shadow",effects:"drop-shadow"});Confluence.Editor.ImageProps?
r():u()});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-browser-metrics:editor', location = '/js/editor.js' */
require(["internal/browser-metrics","jquery"],function(b,c){function a(){var h=AJS.Meta.get("content-type");var g=AJS.Meta.getBoolean("new-page")?"create":"edit";var f=c("body");var d=f.hasClass("edit")||f.hasClass("create");if(d&&h&&g){if(AJS.Meta.getBoolean("collaborative-content")){var e="confluence."+h+"."+g+".collaborative.view";b.start({key:e,isInitial:true});AJS.bind("rte-collab-ready",function(){b.end({key:e});b.start({key:e+".connected"})});AJS.bind("synchrony.connected",function(){b.end({key:e+".connected"})})}else{if(!AJS.Meta.getBoolean("collaborative-content")){b.start({key:"confluence."+h+"."+g+".view",ready:".active-richtext",isInitial:true})}}}}c(a)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-utilities-resources', location = 'utils/roadmap-helper.js' */
(function(f,e){var c=Confluence.Roadmap=Confluence.Roadmap||{};c.Helper={getPosXOnMonthTimeline:function(b,a){b=moment(b.startDate).startOf("month");var d=moment(a).startOf("month");b=c.DateUtilities.getNumberOfMonths(b,d)*Roadmap.MONTH_WIDTH;a=c.DateUtilities.getMilisecondsFromStartMonth(a)*Roadmap.MONTH_WIDTH/c.DateUtilities.getMilisecondsInMonth(a);return Math.round(b+a)},getPosXOnWeekTimeline:function(b,a){b=moment(b.startDate).startOf("isoWeek");a=moment(a).diff(b,"weeks",!0)*Roadmap.WEEK_WIDTH;
return Math.round(a)},getWidthTimeline:function(b,a){a=a.duration;a=b.displayOption===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH?a*Roadmap.MONTH_WIDTH:a*Roadmap.WEEK_WIDTH;return a<Roadmap.EXTRA_SPACE_AROUND?0:Math.round(a-Roadmap.EXTRA_SPACE_AROUND)},getMonthStartDateByPosition:function(b,a){var d=Math.floor(a/Roadmap.MONTH_WIDTH);b=moment(b.startDate).startOf("month").add(d,"months").toDate();a=Math.abs(a)%Roadmap.MONTH_WIDTH;0!==a&&0>d&&(a=Roadmap.MONTH_WIDTH-a);d=c.DateUtilities.getMilisecondsInMonth(b)*
a/Roadmap.MONTH_WIDTH;return new Date(b.getTime()+d)},getWeekStartDateByPosition:function(b,a){b=moment(b.startDate).startOf("isoWeek");return new Date(b.valueOf()+a/Roadmap.WEEK_WIDTH*c.DateUtilities.MILLISECONDS_A_WEEK)},guid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(b){var a=16*Math.random()|0;return("x"==b?a:a&3|8).toString(16)})}};c.ColorHelper={resetColorCounts:function(){e.each(Roadmap.COLORS,function(b){b.count=0})},findColor:function(b){return e.find(Roadmap.COLORS,
function(a){return a.lane===b.lane})},adjustColorCount:function(b,a){if(b=c.ColorHelper.findColor(b))b.count+=a},getColor:function(){return e.min(Roadmap.COLORS,function(b){return b.count})}}})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-utilities-resources', location = 'utils/roadmap-utilities.js' */
(function(g,n){var e=Confluence.Roadmap=Confluence.Roadmap||{};e.DateUtilities={MILLISECONDS_A_DAY:864E5,MILLISECONDS_A_WEEK:6048E5,parseDate:function(a){var b=moment(a,Roadmap.SHORT_DATE_FORMAT,!0);if(b.isValid())return b;b=moment(a,Roadmap.TWO_YY_SHORT_DATE_FORMAT,!0);return b.isValid()?b:null},getDateStringFromDate:function(a,b){return b?moment(a).format(b):moment(a).format(Roadmap.DATE_FORMAT)},getDateFromDateString:function(a,b){return moment(a,b||Roadmap.DATE_FORMAT).toDate()},getNumberOfMonths:function(a,
b){a=moment(a);return moment(b).diff(a,"months")},getMilisecondsInMonth:function(a){return moment(a).daysInMonth()*e.DateUtilities.MILLISECONDS_A_DAY},getMilisecondsFromStartMonth:function(a){return a.getTime()-moment(a).startOf("month").valueOf()},calculateDurationInformation:function(a){var b=e.DateUtilities.getMilisecondsInMonth(a.toDate());a=e.DateUtilities.getMilisecondsFromStartMonth(a.toDate());var c=b-a;return{totalMillisOfMonth:b,millisFromStartMonth:a,millisRemainingOfMonth:c,durationOfMonth:a/
b,remainingDurationOfMonth:c/b}},convertToWeekDuration:function(a,b){a=moment(a);var c=a.clone(),d=e.DateUtilities.calculateDurationInformation(a);b<=d.remainingDurationOfMonth?c=c.add(b*d.totalMillisOfMonth,"ms"):(c=c.add(d.millisRemainingOfMonth,"ms"),b-=d.remainingDurationOfMonth,d=Math.floor(b),0<d&&(c=c.add(d,"months")),b%=1,d=e.DateUtilities.getMilisecondsInMonth(c.toDate()),c.add(b*d,"ms"));return c.diff(a,"weeks",!0)},convertToMonthDuration:function(a,b){var c=moment(a),d=b*e.DateUtilities.MILLISECONDS_A_WEEK;
a=c.clone().add(d,"ms");b=12*a.get("year")+a.get("month");b-=12*c.get("year")+c.get("month");c=e.DateUtilities.calculateDurationInformation(c);if(0===b)return d/c.totalMillisOfMonth;c=c.remainingDurationOfMonth;a=e.DateUtilities.calculateDurationInformation(a);c+=a.durationOfMonth;return c+(b-1)}};e.FieldUtilities={fixDatePickerFields:function(a){a.find("input[data-aui-dp-uuid]").each(function(b,c){var d=g(c),h=d.attr("data-aui-dp-uuid");d.on("click focus",function(){var f=g("[data-aui-dp-popup-uuid\x3d"+
h+"]");if("5.4.5">=AJS.version){var k=f.datepicker("option","onSelect");f.datepicker("option","onSelect",function(l,m){k(l,m);d.change()})}f.parents(".aui-inline-dialog").addClass("datepicker-roadmap-patch")})})}}})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-models', location = '/models/model.js' */
(function(){window.Roadmap=window.Roadmap||{};Roadmap.Bar=Backbone.Model.extend({defaults:function(){return{id:Confluence.Roadmap.Helper.guid(),title:"New Bar",description:"",startDate:new Date,duration:1,rowIndex:0,pageLink:{}}}});Roadmap.Lane=Backbone.Model.extend({defaults:function(){return{title:"New Lane",color:Confluence.Roadmap.ColorHelper.getColor(),bars:[]}},initialize:function(){var a=new Roadmap.Bars(this.get("bars"));
this.set("bars",a)},getNumberOfRows:function(){var a=this.get("bars");if(0===a.length)return 0;var b=0;a.each(function(c){b=Math.max(c.get("rowIndex"),b)});return b+1}});Roadmap.Marker=Backbone.Model.extend({defaults:function(){return{title:"Marker"}}});Roadmap.Timeline=Backbone.Model.extend({defaults:function(){return{displayOption:Roadmap.TIMELINE_DISPLAY_OPTION.MONTH}},validate:function(a){var b=[],c=Confluence.Roadmap.DateUtilities.parseDate(a.startDateString);
a=Confluence.Roadmap.DateUtilities.parseDate(a.endDateString);c&&a?0<=c.diff(a)?b.push({name:"endDate",message:"Start date needs to be before the end date"}):a.diff(c,"years",!0)>Roadmap.TIMELINE_YEARS_LIMIT&&b.push({name:"endDate",message:AJS.format("You cannot plan more than {0} years ahead.",Roadmap.TIMELINE_YEARS_LIMIT)}):b.push({name:"date",message:"Enter dates in yy-mm-dd"});return 0<b.length?b:!1},calculateTimelineColumns:function(){var a=this.get("startDate"),
b=this.get("endDate"),c=[];if(this.get("displayOption")===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH){a=moment(a).clone().startOf("month");b=moment(b).clone().endOf("month");do c.push({month:Confluence.Roadmap.DateUtilities.getDateStringFromDate(a,Roadmap.MONTH_FORMAT),year:a.get("year")}),a.add(1,"months");while(0>a.diff(b))}else{a=moment(a).clone().startOf("isoWeek");b=moment(b).clone().endOf("isoWeek");do c.push({month:Confluence.Roadmap.DateUtilities.getDateStringFromDate(a,Roadmap.WEEK_FORMAT),year:a.get("year")}),
a.add(1,"weeks");while(0>a.diff(b))}this.attributes.displayTimelineColumns=c}});Roadmap.Roadmap=Backbone.Model.extend({defaults:function(){return{title:"Roadmap Planner",lanes:[],markers:[]}},initialize:function(){var a=new Roadmap.Lanes(this.get("lanes"));this.set("lanes",a);a=new Roadmap.Markers(this.get("markers"));this.set("markers",a);a=new Roadmap.Timeline(this.get("timeline"));this.set("timeline",a)},parse:function(a){return a.timeline?this.fromMacroData(a):Roadmap.getDefaultRoadmapData()},
fromMacroData:function(a){var b=a.timeline;b.startDate=Confluence.Roadmap.DateUtilities.getDateFromDateString(b.startDate);b.endDate=Confluence.Roadmap.DateUtilities.getDateFromDateString(b.endDate);b=a.lanes;_.each(b,function(c){var d=c.bars;_.each(d,function(e){e.startDate=Confluence.Roadmap.DateUtilities.getDateFromDateString(e.startDate);e.id||(e.id=Confluence.Roadmap.Helper.guid())});c.bars=d});a.lanes=b;b=a.markers;_.each(b,function(c){c.markerDate=Confluence.Roadmap.DateUtilities.getDateFromDateString(c.markerDate)});
a.markers=b;return a},toMacroData:function(){var a=this.toJSON(),b=a.timeline.toJSON();b.startDate=Confluence.Roadmap.DateUtilities.getDateStringFromDate(b.startDate);b.endDate=Confluence.Roadmap.DateUtilities.getDateStringFromDate(b.endDate);delete b.displayTimelineColumns;a.timeline=b;b=a.lanes.toJSON();_.each(b,function(c){var d=c.bars.toJSON();_.each(d,function(e){e.startDate=Confluence.Roadmap.DateUtilities.getDateStringFromDate(e.startDate)});c.bars=d});a.lanes=b;b=a.markers.toJSON();_.each(b,
function(c){c.markerDate=Confluence.Roadmap.DateUtilities.getDateStringFromDate(c.markerDate)});a.markers=b;return a},updateDurationUnit:function(a){this.get("lanes").each(function(b){b.get("bars").each(function(c){var d=a===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH?Confluence.Roadmap.DateUtilities.convertToMonthDuration(c.get("startDate"),c.get("duration")):Confluence.Roadmap.DateUtilities.convertToWeekDuration(c.get("startDate"),c.get("duration"));c.attributes.duration=d})})}})})();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-models', location = '/models/collection.js' */
(function(){window.Roadmap=window.Roadmap||{};Roadmap.Bars=Backbone.Collection.extend({model:Roadmap.Bar});Roadmap.Lanes=Backbone.Collection.extend({model:Roadmap.Lane});Roadmap.Markers=Backbone.Collection.extend({model:Roadmap.Marker})})();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-toolbar-view-resources', location = 'view/roadmap-editor/toolbar/toolbar-templates.soy' */
// This file was automatically generated from toolbar-templates.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Roadmap.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Roadmap == 'undefined') { Confluence.Templates.Roadmap = {}; }


Confluence.Templates.Roadmap.toolbar = function(opt_data, opt_ignored) {
  return '<div id="roadmap-editor-toolbar" class="aui-toolbar2"><div class="aui-toolbar2-inner"><div class="aui-toolbar2-group"><div class="aui-toolbar2-primary">' + aui.buttons.buttons({content: '' + aui.buttons.button({id: 'toolbar-button-add-lane', text: ' ' + soy.$$escapeHtml('Add lane'), iconType: 'aui', iconClass: 'aui-icon-small aui-iconfont-add', iconText: 'Add'}) + aui.buttons.button({id: 'toolbar-button-add-bar', text: ' ' + soy.$$escapeHtml('Add bar'), iconType: 'aui', iconClass: 'aui-icon-small aui-iconfont-add', iconText: 'Add'}) + aui.buttons.button({id: 'toolbar-button-add-marker', text: ' ' + soy.$$escapeHtml('Add marker'), iconType: 'aui', iconClass: 'aui-icon-small aui-iconfont-add', iconText: 'Add'})}) + '</div><div class="aui-toolbar2-secondary">' + Confluence.Templates.Roadmap.timelineOptionsForm(null) + '</div></div></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.toolbar.soyTemplateName = 'Confluence.Templates.Roadmap.toolbar';
}


Confluence.Templates.Roadmap.timelineOptionsForm = function(opt_data, opt_ignored) {
  return '' + aui.form.form({id: 'timeline-options-form', action: '#', content: '<fieldset>' + aui.form.selectField({id: 'timeline-display-options-select', labelContent: '' + soy.$$escapeHtml('View by'), options: [{text: 'Months', value: 'MONTH'}, {text: 'Weeks', value: 'WEEK'}], extraClasses: 'view-by'}) + aui.form.textField({id: 'timeline-startdate-input', name: 'startDate', isRequired: true, extraClasses: 'roadmap-toolbar-date start-date aui-date-picker'}) + ' - ' + aui.form.textField({id: 'timeline-enddate-input', name: 'endDate', isRequired: true, extraClasses: 'roadmap-toolbar-date end-date aui-date-picker'}) + '<div class="field-group timeline-field-group-error"><div id="roadmap-timeline-error" class="error"></div></div></fieldset>'});
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.timelineOptionsForm.soyTemplateName = 'Confluence.Templates.Roadmap.timelineOptionsForm';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-toolbar-view-resources', location = 'view/roadmap-editor/toolbar/toolbar.js' */
(function(f,e){window.Roadmap=window.Roadmap||{};Roadmap.ToolbarView=Backbone.View.extend({className:"roadmap-toolbar",events:{"click #toolbar-button-add-bar":"onAddBarClick","click #toolbar-button-add-lane":"onAddLaneClick","click #toolbar-button-add-marker":"onAddMarkerClick","change #timeline-display-options-select":"onTimelineOptionChange"},initialize:function(){e.bindAll(this,"render")},render:function(){f(this.$el).html(Confluence.Templates.Roadmap.toolbar());this._initVariables();this._setupTimelineOptionsForm();
return this},onAddBarClick:function(a){a.preventDefault();a=this.model.get("lanes").at(0);var b=a.get("bars"),c=this.model.get("timeline"),d=this.model.get("timeline").get("startDate");c=c.get("displayOption")===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH?moment(d).startOf("month"):moment(d).startOf("isoWeek");b.add(new Roadmap.Bar({rowIndex:a.getNumberOfRows(),startDate:c.toDate()}))},onAddLaneClick:function(a){a.preventDefault();this.model.get("lanes").add(new Roadmap.Lane)},onAddMarkerClick:function(a){a=
this.model.get("markers");var b=this.model.get("timeline"),c=moment(b.get("startDate"));b=b.get("displayOption")===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH?c.date(15):c.isoWeekday(4);a.add(new Roadmap.Marker({markerDate:b.toDate()}))},onTimelineOptionChange:function(a){this.model.get("timeline").set({displayOption:this.$timelineSelect.val()})},_initVariables:function(){this.$timelineForm=this.$el.find("#timeline-options-form");this.$startDateInput=this.$timelineForm.find("#timeline-startdate-input");
this.$endDateInput=this.$timelineForm.find("#timeline-enddate-input");this.$timelineSelect=this.$timelineForm.find("#timeline-display-options-select");this.$timelineError=this.$timelineForm.find("#roadmap-timeline-error");this.newTimeline=new Roadmap.Timeline},_clearTimelineErrors:function(){this.$timelineError.empty()},_showTimelineErrors:function(){var a=this;e.each(a.newTimeline.validationError,function(b){a.$timelineError.append(b.message)})},_applyNewTimeline:function(){var a=this.model.get("timeline"),
b=Confluence.Roadmap.DateUtilities.parseDate(this.$startDateInput.val()),c=Confluence.Roadmap.DateUtilities.parseDate(this.$endDateInput.val());a.set({startDate:b.toDate(),endDate:c.toDate()});this._showTimeLineFormat()},_showTimeLineFormat:function(){var a=this.model.get("timeline");this.$startDateInput.val(Confluence.Roadmap.DateUtilities.getDateStringFromDate(a.get("startDate"),Roadmap.SHORT_DATE_FORMAT));this.$endDateInput.val(Confluence.Roadmap.DateUtilities.getDateStringFromDate(a.get("endDate"),
Roadmap.SHORT_DATE_FORMAT))},_validate:function(){this._clearTimelineErrors();this.newTimeline.isValid()?this._applyNewTimeline():this._showTimelineErrors()},_setupTimelineOptionsForm:function(){var a=this.model.get("timeline"),b=Confluence.Roadmap.DateUtilities.getDateStringFromDate(a.get("startDate"),Roadmap.SHORT_DATE_FORMAT),c=Confluence.Roadmap.DateUtilities.getDateStringFromDate(a.get("endDate"),Roadmap.SHORT_DATE_FORMAT);this.$startDateInput.val(b);this.$endDateInput.val(c);this.newTimeline.set({startDateString:b,
endDateString:c});this.$timelineSelect.val(a.get("displayOption"));a={overrideBrowserDefault:!0,firstDay:1};this.$startDateInput.datePicker(a);this.$endDateInput.datePicker(a);Confluence.Roadmap.FieldUtilities.fixDatePickerFields(this.$timelineForm);var d=this;this.$startDateInput.on("change",function(){d.newTimeline.set({startDateString:d.$startDateInput.val()});d._validate()});this.$endDateInput.on("change",function(){d.newTimeline.set({endDateString:d.$endDateInput.val()});d._validate()})}})})(AJS.$,
window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-timeline-view-resources', location = 'view/roadmap-editor/timeline/timeline-templates.soy' */
// This file was automatically generated from timeline-templates.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Roadmap.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Roadmap == 'undefined') { Confluence.Templates.Roadmap = {}; }


Confluence.Templates.Roadmap.timeline = function(opt_data, opt_ignored) {
  var output = '';
  var displayTimelineList3 = opt_data.displayTimelines;
  var displayTimelineListLen3 = displayTimelineList3.length;
  for (var displayTimelineIndex3 = 0; displayTimelineIndex3 < displayTimelineListLen3; displayTimelineIndex3++) {
    var displayTimelineData3 = displayTimelineList3[displayTimelineIndex3];
    output += '<div class="roadmap-column-title">' + ((displayTimelineIndex3 == 0 || displayTimelineData3.year != opt_data.displayTimelines[displayTimelineIndex3 - 1].year) ? '<span class="roadmap-column-year">' + soy.$$escapeHtml(displayTimelineData3.year) + '</span><br/>' : '') + soy.$$escapeHtml(displayTimelineData3.month) + '</div>';
  }
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.timeline.soyTemplateName = 'Confluence.Templates.Roadmap.timeline';
}


Confluence.Templates.Roadmap.timelineColumn = function(opt_data, opt_ignored) {
  var output = '';
  var iLimit14 = opt_data.numberOfColumns;
  for (var i14 = 0; i14 < iLimit14; i14++) {
    output += '<div class="roadmap-column-item">&nbsp;</div>';
  }
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.timelineColumn.soyTemplateName = 'Confluence.Templates.Roadmap.timelineColumn';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-timeline-view-resources', location = 'view/roadmap-editor/timeline/timeline.js' */
(function(d,c){window.Roadmap=window.Roadmap||{};var b=Confluence.Roadmap.Helper;Roadmap.TimelineView=Backbone.View.extend({className:"roadmap-frame-title",initialize:function(){c.bindAll(this,"render")},render:function(){this.model.calculateTimelineColumns();this.$el.html(Confluence.Templates.Roadmap.timeline({displayTimelines:this.model.get("displayTimelineColumns")}));return this},update:function(){this.render()},getBarPosition:function(a){return this.model.get("displayOption")===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH?
{left:b.getPosXOnMonthTimeline(this.model.attributes,a.startDate),width:b.getWidthTimeline(this.model.attributes,a)}:{left:b.getPosXOnWeekTimeline(this.model.attributes,a.startDate),width:b.getWidthTimeline(this.model.attributes,a)}},getBarDuration:function(a){return this.model.get("displayOption")===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH?a/Roadmap.MONTH_WIDTH:a/Roadmap.WEEK_WIDTH},getBarStartDate:function(a){return this.model.get("displayOption")===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH?b.getMonthStartDateByPosition(this.model.attributes,
a):b.getWeekStartDateByPosition(this.model.attributes,a)}})})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-timeline-view-resources', location = 'view/roadmap-editor/timeline/timeline-column.js' */
(function(c,b){window.Roadmap=window.Roadmap||{};Roadmap.TimelineColumnView=Backbone.View.extend({className:"roadmap-frame-content",initialize:function(){b.bindAll(this,"render")},render:function(){var a=this.model.get("displayTimelineColumns").length;this.$el.html(Confluence.Templates.Roadmap.timelineColumn({numberOfColumns:a}));return this},updateHeight:function(a){this.$el.height(a)},update:function(){this.render()},getSizeAndPosition:function(){return{width:this.$el.width(),height:this.$el.height(),
left:this.$el.position().left,top:this.$el.position().top}}})})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-dialog-resources', location = 'view/dialog-view.js' */
(function(l,n){window.Roadmap=window.Roadmap||{};Roadmap.InlineDialogView=Backbone.View.extend({initialize:function(a){n.bindAll(this,"_onDocumentClick","_onKeyDown","_shouldHide","_onHide");this._trigger=a.trigger;this._dialogOptions=a.dialogOptions;this._reset();var b=this;l(".roadmap-editor-popup, .roadmap-macro-view").scroll(function(){b.hide()})},_shouldHideWhenClick:function(a){return!l.contains(this._inlineDialog[0],a.target)},_createInlineDialog:function(a,b){var e=this,c={hideCallback:this._onHide,
initCallback:function(){e._onBeforeShow();n.delay(function(){AJS.InlineDialog.current=null;e._onShow();l(document).on({click:e._onDocumentClick,keydown:e._onKeyDown})},e._inlineDialog.getOptions().fadeTime)},noBind:!0,persistent:!0,preHideCallback:this._shouldHide};b&&b.isSideInlineDialog&&(n.extend(c,{calculatePositions:n.compose(this._calculateSidePositions,this._getSideDimensions),offsetX:8,offsetY:0}),Raphael.version&&n.extend(c,{getArrowPath:this._getSideArrowPath}));return new AJS.InlineDialog(a,
"roadmap-dialog",function(d,g,m){e._getContent(d);m()},n.extend({},c,b))},_onHide:function(){l(document).off({click:this._onDocumentClick,keydown:this._onKeyDown})},hide:function(){this._inlineDialog.remove()},_onDocumentClick:function(a){this._shouldHideWhenClick(a)&&this.hide()},_onBeforeShow:l.noop,_onKeyDown:function(a){var b=a.which===l.ui.keyCode.ESCAPE;a=l(a.target).is(":input");b&&!a&&this.hide()},_onShow:l.noop,_reset:function(){this._inlineDialog=this._createInlineDialog(this._trigger,this._dialogOptions);
this.setElement(this._inlineDialog)},_shouldHide:function(){return!0},show:function(){this._inlineDialog.show()},disable:function(){this.$el.find(":input").attr("disabled","disabled")},enable:function(){this.$el.find(":input").removeAttr("disabled")},_onSubmit:function(){throw Error("DialogView subclasses must implement _onSubmit().");},_getSideDimensions:function(a,b,e,c){var d="body"!==c.container.toLowerCase();e=AJS.$(c.container);var g=d?AJS.$(c.container).parent():AJS.$(window),m=d?e.offset():
{left:0,top:0};d=d?g.offset():{left:0,top:0};b=b.target;var h=b.offset(),k=b[0].getBoundingClientRect&&b[0].getBoundingClientRect(),f=k?k.width:b.outerWidth();if(c.timelineWidth){var p=b.position();p.left+f>c.timelineWidth&&(f=c.timelineWidth-p.left-1)}return{screenPadding:10,arrowMargin:5,window:{top:d.top,left:d.left,scrollTop:g.scrollTop(),scrollLeft:g.scrollLeft(),width:g.width(),height:g.height()},scrollContainer:{width:e.width(),height:e.height()},trigger:{top:h.top-m.top,left:h.left-m.left,
width:f,height:k?k.height:b.outerHeight()},dialog:{width:a.width(),height:a.height(),offset:{top:c.offsetY,left:c.offsetX}},arrow:{height:a.find(".arrow").outerHeight()}}},_calculateSidePositions:function(a){var b=a.screenPadding,e=a.window,c=a.trigger,d=a.dialog,g=a.arrow,m=c.top-e.scrollTop,h=c.left-e.scrollLeft,k=Math.floor(c.height/2),f=Math.floor(d.height/2),p=Math.floor(g.height/2),q=h-d.offset.left-b>=d.width;h=a.scrollContainer.width-h-c.width-d.offset.left-b>=d.width||!q?"right":"left";q=
m+k-p;g=e.height-q-g.height;b=Math.min(b,q-a.arrowMargin);b=Math.min(b,g-a.arrowMargin);a=Math.max(f-k+d.offset.top-Math.max(e.height-m-c.height-b,0),0);b=Math.max(f-k-d.offset.top-Math.max(m-b,0),0)||-a||0;c={top:c.top+k-f+d.offset.top+b,left:"right"===h?c.left+c.width+d.offset.left:c.left-d.width-d.offset.left};d="w";f={position:"absolute",top:f-p-b};"right"===h?(f.right="auto",f.left=Raphael.version?"-7px":"0px"):(f.right="-7px",f.left="auto",d="e");return{dialogLocation:h,popupCss:c,arrowCss:f,
gravity:d}},_getSideArrowPath:function(a){return"right"===a.dialogLocation?"M8,0L0,8,8,16":"M8,0L16,8,8,16"},refresh:function(){this._inlineDialog&&this._inlineDialog.refresh()}})})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-bar-dialog-resources', location = 'view/roadmap-editor/bar-dialog/bar-dialog-templates.soy' */
// This file was automatically generated from bar-dialog-templates.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Roadmap.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Roadmap == 'undefined') { Confluence.Templates.Roadmap = {}; }


Confluence.Templates.Roadmap.barDialog = function(opt_data, opt_ignored) {
  var output = '';
  var hasPageLink__soy3 = opt_data.bar.pageLink != null && opt_data.bar.pageLink.id != null;
  output += '<h3 id="bar-title" class="editable-field">' + soy.$$escapeHtml(opt_data.bar.title) + '</h3><div class="information"><div class="bar-page-link-wrapper">' + ((opt_data.linkPageEditable) ? '<div class="link-update-page ' + ((hasPageLink__soy3) ? 'hidden-field' : '') + '"><a href="#">' + soy.$$escapeHtml('Link page') + '</a></div>' : '') + '<div class="bar-page-link editable-field ' + ((! hasPageLink__soy3) ? 'hidden-field' : '') + '">' + ((hasPageLink__soy3) ? Confluence.Templates.Roadmap.buildPageLink({pageLink: opt_data.bar.pageLink, isEditMode: opt_data.renderOption.isEditMode}) : '') + '</div>' + ((opt_data.linkPageEditable) ? '<div class="link-new-page' + ((hasPageLink__soy3) ? ' hidden-field' : '') + '"><span class=\'page-link-separator\'>\u2022</span><a href="#">' + soy.$$escapeHtml('Create page') + '</a></div>' : '') + '</div><div class="clear"></div><div class="bar-description editable-field">' + soy.$$filterNoAutoescape(opt_data.bar.description) + '</div></div>' + ((opt_data.renderOption.isEditMode) ? '<div class="inner">' + aui.buttons.button({id: 'delete-button', text: 'Delete bar', type: 'link'}) + '</div>' : '');
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.barDialog.soyTemplateName = 'Confluence.Templates.Roadmap.barDialog';
}


Confluence.Templates.Roadmap.buildPageLink = function(opt_data, opt_ignored) {
  return '<a href=' + soy.$$escapeHtml("") + '/pages/viewpage.action?pageId=' + soy.$$escapeHtml(opt_data.pageLink.id) + ' ' + ((opt_data.isEditMode) ? 'target=\'_blank\'' : '') + ' class=\'confluence-link content-type-' + soy.$$escapeHtml(opt_data.pageLink.type) + '\'><span class="link-page-title">' + soy.$$escapeHtml(opt_data.pageLink.title) + '</span></a>';
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.buildPageLink.soyTemplateName = 'Confluence.Templates.Roadmap.buildPageLink';
}


Confluence.Templates.Roadmap.inlineEditSaveButton = function(opt_data, opt_ignored) {
  return '' + aui.buttons.button({id: 'inline-edit-save', iconType: 'aui', extraClasses: 'aui-button-compact', text: '', extraAttributes: {title: 'Save'}, iconClass: 'aui-icon-small aui-iconfont-success'});
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.inlineEditSaveButton.soyTemplateName = 'Confluence.Templates.Roadmap.inlineEditSaveButton';
}


Confluence.Templates.Roadmap.inlineEditCancelButton = function(opt_data, opt_ignored) {
  return '' + aui.buttons.button({id: 'inline-edit-cancel', iconType: 'aui', extraClasses: 'aui-button-compact', text: '', extraAttributes: {title: 'Cancel'}, iconClass: 'aui-icon-small aui-iconfont-close-dialog'});
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.inlineEditCancelButton.soyTemplateName = 'Confluence.Templates.Roadmap.inlineEditCancelButton';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-bar-dialog-resources', location = 'view/roadmap-editor/bar-dialog/roadmap-editinplace.js' */
(function(d){function h(a,b){this.settings=a;this.dom=b;this.originalValue=null;this.shouldDelayReinit=this.didInsertDefaultText=!1}function l(a){""!==a&&((new Image).src=a)}function g(a){return a.replace(/^\s+/,"").replace(/\s+$/,"")}function k(a){return void 0===a||null===a||0===a.length?!1:!0}d.fn.editInPlace=function(a){var b=d.extend({},d.fn.editInPlace.defaults,a);if(!b.url&&!b.callback)throw Error("Need to set either url: or callback: option for the inline editor to work.");l(b.saving_image);
return this.each(function(){var c=d(this);c.data("editInPlace")||(c.data("editInPlace",!0),(new h(b,c)).init())})};d.fn.editInPlace.defaults={url:"",bg_over:"#ffc",bg_out:"transparent",hover_class:"",form_extra_classes:[],show_buttons:!1,save_button:'\x3cbutton class\x3d"inplace_save"\x3eSave\x3c/button\x3e',cancel_button:'\x3cbutton class\x3d"inplace_cancel"\x3eCancel\x3c/button\x3e',params:"",field_type:"text",field_extra_classes:[],default_text:"(Click here to add text)",use_html:!1,textarea_rows:10,
textarea_cols:25,select_text:"Choose new value",select_options:"",text_size:null,saving_text:void 0,saving_image:"",saving_animation_color:"transparent",value_required:!1,disable_submit_when_empty:!1,element_id:"element_id",update_value:"update_value",original_value:"original_value",original_html:"original_html",save_if_nothing_changed:!1,on_blur:"save",cancel:"",callback:null,callback_skip_dom_reset:!1,success:null,error:null,error_sink:function(a,b){alert(b)},preinit:null,postclose:null,delegate:null,
isAutoCompleteField:!1};d.extend(h.prototype,{init:function(){this.setDefaultTextIfNeccessary();this.connectOpeningEvents()},reinit:function(){this.shouldDelayReinit||(this.triggerCallback(this.settings.postclose,this.dom),this.triggerDelegateCall("didCloseEditInPlace"),this.markEditorAsInactive(),this.connectOpeningEvents())},setDefaultTextIfNeccessary:function(){""===this.dom.html()&&(this.dom.html(this.settings.default_text),this.didInsertDefaultText=!0)},connectOpeningEvents:function(){var a=
this;this.dom.bind("mouseenter.editInPlace",function(){a.addHoverEffect()}).bind("mouseleave.editInPlace",function(){a.removeHoverEffect()}).bind("click.editInPlace",function(b){a.openEditor(b)})},disconnectOpeningEvents:function(){this.dom.unbind(".editInPlace")},addHoverEffect:function(){this.settings.hover_class?this.dom.addClass(this.settings.hover_class):this.dom.css("background-color",this.settings.bg_over)},removeHoverEffect:function(){this.settings.hover_class?this.dom.removeClass(this.settings.hover_class):
this.dom.css("background-color",this.settings.bg_out)},openEditor:function(a){this.shouldOpenEditor(a)&&(this.disconnectOpeningEvents(),this.removeHoverEffect(),this.removeInsertedDefaultTextIfNeccessary(),this.saveOriginalValue(),this.markEditorAsActive(),this.replaceContentWithEditor(),this.setInitialValue(),this.workAroundMissingBlurBug(),this.connectClosingEventsToEditor(),this.triggerDelegateCall("didOpenEditInPlace"))},shouldOpenEditor:function(a){return this.isClickedObjectCancelled(a.target)||
!1===this.triggerCallback(this.settings.preinit,this.dom)||!1===this.triggerDelegateCall("shouldOpenEditInPlace",!0,a)||this.settings.isAutoCompleteField&&d(a.target).hasClass("link-page-title")?!1:!0},removeInsertedDefaultTextIfNeccessary:function(){this.didInsertDefaultText&&this.dom.html()===this.settings.default_text&&(this.dom.html(""),this.didInsertDefaultText=!1)},isClickedObjectCancelled:function(a){return this.settings.cancel?0!==d(a).parents().andSelf().filter(this.settings.cancel).length:
!1},saveOriginalValue:function(){this.originalValue=this.settings.use_html?this.dom.html():g(this.dom.text())},restoreOriginalValue:function(){this.setClosedEditorContent(this.originalValue)},setClosedEditorContent:function(a){a=a||this.settings.default_text;this.settings.use_html?this.dom.html(a):this.dom.text(a)},workAroundMissingBlurBug:function(){var a=this.dom.find(":input");this.dom.parents(":last").find(".editInPlace-active :input").not(a).blur()},replaceContentWithEditor:function(){var a=
this.createEditorElement(),b="inplace_form";this.settings.form_extra_classes instanceof Array&&(b=b+" "+this.settings.form_extra_classes.join(" "));this.dom.html('\x3cform class\x3d"'+b+'" style\x3d"display: inline; margin: 0; padding: 0;"\x3e\x3c/form\x3e');b=this.dom.find("form");b.append(a);if(this.settings.show_buttons){a=d('\x3cdiv class\x3d"inline-edit-buttons"\x3e\x3c/div\x3e');var c=d(this.settings.save_button);c.addClass("inplace_save");a.append(c);c=d(this.settings.cancel_button);c.addClass("inplace_cancel");
a.append(c);b.append(a)}},createEditorElement:function(){if(-1===d.inArray(this.settings.field_type,["text","textarea","select"]))throw"Unknown field_type \x3cfnord\x3e, supported are 'text', 'textarea' and 'select'";var a=null;"select"===this.settings.field_type?a=this.createSelectEditor():"text"===this.settings.field_type?a=d('\x3cinput type\x3d"text" '+this.inputNameAndClass()+' size\x3d"'+this.settings.text_size+'" /\x3e'):"textarea"===this.settings.field_type&&(a=d("\x3ctextarea "+this.inputNameAndClass()+
' rows\x3d"'+this.settings.textarea_rows+'"  cols\x3d"'+this.settings.textarea_cols+'" /\x3e'));return a},setInitialValue:function(){var a=this.triggerDelegateCall("willOpenEditInPlace",this.originalValue),b=this.dom.find(":input");b.val(a);b.val()!==a&&b.val("")},inputNameAndClass:function(){var a="inplace_field";this.settings.field_extra_classes instanceof Array&&(a=a+" "+this.settings.field_extra_classes.join(" "));return' name\x3d"inplace_value" class\x3d"'+a+'"'},createSelectEditor:function(){var a=
d("\x3cselect"+this.inputNameAndClass()+'\x3e\x3coption disabled\x3d"true" value\x3d""\x3e'+this.settings.select_text+"\x3c/option\x3e\x3c/select\x3e"),b=this.settings.select_options;d.isArray(b)||(b=b.split(","));for(var c=0;c<b.length;c++){var e=b[c];d.isArray(e)||(e=e.split(":"));var f=g(e[1]||e[0]);e=g(e[0]);f=d("\x3coption\x3e").val(f).text(e);a.append(f)}return a},connectClosingEventsToEditor:function(){function a(f){c.settings.isAutoCompleteField||c.handleCancelEditor(f);return!1}function b(f){c.handleSaveEditor(f);
return!1}var c=this,e=this.dom.find("form");e.find(".inplace_field").focus().select();e.find(".inplace_cancel").click(a);e.find(".inplace_save").click(b);this.settings.show_buttons||("save"===this.settings.on_blur?e.find(".inplace_field").blur(b):e.find(".inplace_field").blur(a));e.keyup(function(f){if(27===f.which)return a()});this.bindInputKeyup();e.submit(b)},bindSubmitOnEnterInInput:function(){if("textarea"!==this.settings.field_type){var a=this;this.dom.find(":input").keyup(function(b){if(13===
b.which)return a.dom.find("form").submit()})}},bindInputKeyup:function(){if("textarea"!==this.settings.field_type){var a=this,b=this.dom.find(":input"),c=this.dom.find(".inplace_save");b.keyup(function(e){if(13===e.which)return a.dom.find("form").submit();a.settings.disable_submit_when_empty&&(d.trim(b.val()).length?c.removeAttr("disabled"):c.attr("disabled","disabled"))})}},handleCancelEditor:function(a){!1!==this.triggerDelegateCall("shouldCloseEditInPlace",!0,a)&&(a=this.dom.find(":input").val(),
this.triggerDelegateCall("willCloseEditInPlace",a),this.restoreOriginalValue(),this.reinit())},handleSaveEditor:function(a){if(!1!==this.triggerDelegateCall("shouldCloseEditInPlace",!0,a)){var b=d.trim(this.dom.find(":input").val());b=this.triggerDelegateCall("willCloseEditInPlace",b);this.isDisabledDefaultSelectChoice()||this.isUnchangedInput(b)?this.handleCancelEditor(a):this.didForgetRequiredText(b)?this.settings.disable_submit_when_empty||(this.handleCancelEditor(a),this.reportError("Error: You must enter a value to save this field")):
(this.showSaving(b),this.settings.callback?this.handleSubmitToCallback(b):this.handleSubmitToServer(b))}},didForgetRequiredText:function(a){return this.settings.value_required&&(""===a||void 0===a||null===a)},isDisabledDefaultSelectChoice:function(){return this.dom.find("option").eq(0).is(":selected:disabled")},isUnchangedInput:function(a){return!this.settings.save_if_nothing_changed&&this.originalValue===a},showSaving:function(a){this.settings.callback&&this.settings.callback_skip_dom_reset||(k(this.settings.saving_text)&&
(a=this.settings.saving_text),k(this.settings.saving_image)&&(a=d("\x3cimg /\x3e").attr("src",this.settings.saving_image).attr("alt",a)),this.dom.html(encodeURIComponent(a)))},handleSubmitToCallback:function(a){this.enableOrDisableAnimationCallbacks(!0,!1);var b=this.triggerCallback(this.settings.callback,this.id(),a,this.originalValue,this.settings.params,this.savingAnimationCallbacks());this.settings.callback_skip_dom_reset||(void 0===b?(this.reportError("Error: Failed to save value: "+a),this.restoreOriginalValue()):
this.dom.html(b));this.didCallNoCallbacks()&&(this.enableOrDisableAnimationCallbacks(!1,!1),this.reinit())},handleSubmitToServer:function(a){a=this.settings.update_value+"\x3d"+encodeURIComponent(a)+"\x26"+this.settings.element_id+"\x3d"+this.dom.attr("id")+(this.settings.params?"\x26"+this.settings.params:"")+"\x26"+this.settings.original_html+"\x3d"+encodeURIComponent(this.originalValue)+"\x26"+this.settings.original_value+"\x3d"+encodeURIComponent(this.originalValue);this.enableOrDisableAnimationCallbacks(!0,
!1);this.didStartSaving();var b=this;d.ajax({url:b.settings.url,type:"POST",data:a,dataType:"html",complete:function(c){b.didEndSaving()},success:function(c){b.dom.html(c||b.settings.default_text);b.triggerCallback(b.settings.success,c)},error:function(c){b.dom.html(b.originalHTML);b.settings.error?b.triggerCallback(b.settings.error,c):b.reportError("Failed to save value: "+c.responseText||"Unspecified Error")}})},triggerCallback:function(a){if(a){var b=Array.prototype.slice.call(arguments,1);return a.apply(this.dom[0],
b)}},triggerDelegateCall:function(a,b,c){if(!this.settings.delegate||!d.isFunction(this.settings.delegate[a]))return b;a=this.settings.delegate[a](this.dom,this.settings,c);return void 0===a?b:a},reportError:function(a){this.triggerCallback(this.settings.error_sink,this.id(),a)},id:function(){return this.dom.attr("id")},markEditorAsActive:function(){this.dom.addClass("editInPlace-active")},markEditorAsInactive:function(){this.dom.removeClass("editInPlace-active")},savingAnimationCallbacks:function(){var a=
this;return{didStartSaving:function(){a.didStartSaving()},didEndSaving:function(){a.didEndSaving()}}},enableOrDisableAnimationCallbacks:function(a,b){this.didStartSaving.enabled=a;this.didEndSaving.enabled=b},didCallNoCallbacks:function(){return this.didStartSaving.enabled&&!this.didEndSaving.enabled},assertCanCall:function(a){if(!this[a].enabled)throw Error("Cannot call "+a+" now. See documentation for details.");},didStartSaving:function(){this.assertCanCall("didStartSaving");this.shouldDelayReinit=
!0;this.enableOrDisableAnimationCallbacks(!1,!0);this.startSavingAnimation()},didEndSaving:function(){this.assertCanCall("didEndSaving");this.shouldDelayReinit=!1;this.enableOrDisableAnimationCallbacks(!1,!1);this.reinit();this.stopSavingAnimation()},startSavingAnimation:function(){var a=this;this.dom.animate({backgroundColor:this.settings.saving_animation_color},400).animate({backgroundColor:"transparent"},400,"swing",function(){setTimeout(function(){a.startSavingAnimation()},10)})},stopSavingAnimation:function(){this.dom.stop(!0).css({backgroundColor:""})},
missingCommaErrorPreventer:""})})(jQuery);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-bar-dialog-resources', location = 'view/roadmap-editor/bar-dialog/bar-dialog.js' */
(function(e,f){var h=Roadmap.InlineDialogView;Roadmap.BarDialogView=h.extend({events:{"click #delete-button":"_onDeleteClick","click .link-new-page":"_goToCreateLinkPage","click .link-update-page":"_goToUpdateLinkPage"},initialize:function(){f.bindAll(this,"_onPageLinkOpen","_onPageLinkSelectCompleted","_onPageLinkCallback","_onPageLinkBlur","_goToCreateLinkPage");this.options.dialogOptions={width:260,timelineWidth:this.options.timelineWidth,isSideInlineDialog:!0,renderOption:this.options.renderOption,
linkPageEditable:this.options.linkPageEditable,createLinkPageCallback:this.options.createLinkPageCallback};h.prototype.initialize.call(this,this.options)},_getContent:function(a){a.html(Confluence.Templates.Roadmap.barDialog({bar:f.extend({},this.model.attributes,{description:AJS.escapeHtml(this.model.attributes.description).replace(/\r?\n/g,"\x3cbr /\x3e")}),renderOption:this.options.dialogOptions.renderOption,linkPageEditable:this.options.dialogOptions.linkPageEditable}))},_onBeforeShow:function(){this.fields=
this._getFields();this._setupInlineEdit()},_getFields:function(){return{$title:this.$el.find("#bar-title"),$description:this.$el.find(".bar-description"),$pageLink:this.$el.find(".bar-page-link"),$pageLinkNew:this.$el.find(".link-new-page"),$pageLinkUpdate:this.$el.find(".link-update-page")}},_setupInlineEdit:function(){var a=this,b=this.fields,c=this.options.dialogOptions.renderOption.editInplace,g={form_extra_classes:["aui"],hover_class:"editable-field-hover aui-icon-small aui-iconfont-edit",field_extra_classes:["text"],
show_buttons:!0,save_button:Confluence.Templates.Roadmap.inlineEditSaveButton(),cancel_button:Confluence.Templates.Roadmap.inlineEditCancelButton(),error_sink:null,use_html:!0,default_text:"Click to add description.",delegate:{shouldOpenEditInPlace:function(){a.$el.find(".inplace_cancel").trigger("click")},didCloseEditInPlace:function(){setTimeout(function(){a.refresh()},0)}}};c.title&&b.$title.editInPlace(e.extend(!0,{},g,{callback:function(k,d){a.options.updateTitle(d);
return AJS.escapeHtml(d)},value_required:!0,disable_submit_when_empty:!0,delegate:{willOpenEditInPlace:function(){a.refresh();b.$title.find(".text").attr("maxlength",Roadmap.BarDialog.MAX_LENGTH_TITLE)}}}));""===e.trim(b.$description.text())?b.$description.addClass("empty-field"):b.$description.removeClass("empty-field");var l=e.extend(!0,{},g,{field_type:"textarea",field_extra_classes:["textarea"],value_required:!1,save_if_nothing_changed:!0,callback:function(k,d){d=e.trim(d);a.options.updateDescription(d);
""===d?(d="Click to add description.",e(this).addClass("empty-field")):(e(this).removeClass("empty-field"),Confluence.Roadmap.Analytics.addDescription());return AJS.escapeHtml(d).replace(/\r?\n/g,"\x3cbr /\x3e")},delegate:{willOpenEditInPlace:function(){a.refresh();b.$description.find(".textarea").attr("maxlength",Roadmap.BarDialog.MAX_LENGTH_DESCRIPTION);return a.model.attributes.description.replace(/<br\s*[\/]?>/gi,"\n")}}});c.description&&b.$description.editInPlace(l);
g=e.extend(!0,{},g,{isAutoCompleteField:!0,show_buttons:!1,default_text:"",field_extra_classes:["text","autocomplete-confluence-content"],delegate:{willOpenEditInPlace:a._onPageLinkOpen,didCloseEditInPlace:function(){f.isEmpty(b.$pageLink.data("linkData"))&&(b.$pageLink.hide(),b.$pageLinkNew.show(),b.$pageLinkUpdate.show())}},on_blur:null,callback:a._onPageLinkCallback});c.pageLink&&this.options.dialogOptions.linkPageEditable&&this.fields.$pageLink.editInPlace(g)},_onPageLinkOpen:function(a){var b=
this;a.append('\x3cdiv class\x3d"link-page-dropdown" /\x3e');var c=a.find(".autocomplete-confluence-content");c.attr({placeholder:"Search page","data-dropdown-target":"#inline-dialog-roadmap-dialog .link-page-dropdown","data-none-message":"No matches found"});Confluence.Binder.autocompleteConfluenceContent(a);c.bind("selected.autocomplete-content",this._onPageLinkSelectCompleted);c.on("blur",function(){setTimeout(b._onPageLinkBlur,
150)});a=this.model.attributes.pageLink;this.fields.$pageLink.data("linkData",a);return f.isEmpty(a)?!0:a.title},_onPageLinkSelectCompleted:function(a,b){a.stopPropagation();this.fields.$pageLink.find(".autocomplete-confluence-content").val(b.content.title);this.fields.$pageLink.data("linkData",b.content);f.defer(this._onPageLinkBlur)},_onPageLinkBlur:function(){var a=this.fields.$pageLink.find(".autocomplete-confluence-content"),b=e.Event("keyup");b.which=AJS.keyCode.ENTER;a.trigger(b)},_onPageLinkCallback:function(a,
b){a=""===b?{}:this.fields.$pageLink.data("linkData");return this._updatePageLink(a)},_updatePageLink:function(a){if(a.id!==this.model.attributes.pageLink.id){var b=this.fields;if(f.isEmpty(a))return this.options.updatePageLink({}),b.$pageLink.hide(),b.$pageLinkNew.show(),b.$pageLinkUpdate.show(),"No linked page";var c=f.pick(a,"id","title","type","spaceKey","wikiLink");a.spaceKey||(c.spaceKey=a.space.key);this.options.updatePageLink(c);b.$pageLink.show();b.$pageLinkNew.hide();
b.$pageLinkUpdate.hide();this.options.renderOption.isEditMode?Confluence.Roadmap.Analytics.addPageLinkEditMode({linkedPageId:a.id,pageId:0<AJS.Meta.get("page-id")?AJS.Meta.get("page-id"):AJS.Meta.get("draft-id"),isDraft:0>=AJS.Meta.get("page-id")}):Confluence.Roadmap.Analytics.addPageLinkViewMode({linkedPageId:a.id,pageId:AJS.Meta.get("page-id")});return Confluence.Templates.Roadmap.buildPageLink({pageLink:a,isEditMode:this.options.renderOption.isEditMode})}},_onDeleteClick:function(){this.options.deleteBar();
this.remove()},_goToCreateLinkPage:function(a){var b=this.options.dialogOptions;b.createLinkPageCallback&&f.bind(b.createLinkPageCallback,{me:this},a)()},_goToUpdateLinkPage:function(a){a.preventDefault();this.fields.$pageLink.show();this.fields.$pageLinkNew.hide();this.fields.$pageLinkUpdate.hide();this.fields.$pageLink.click()}})})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-bar-dialog-resources', location = 'view/roadmap-editor/bar-dialog/bar-link-new-page.js' */
Confluence.RoadmapLink=function(b,f){function g(a){return b.ajax({contentType:"application/json",type:"PUT",url:AJS.contextPath()+"/rest/roadmap/1.0/bar/"+a+"/PENDING"})}function h(a){return b.ajax({contentType:"application/json",type:"GET",url:AJS.contextPath()+"/rest/roadmap/1.0/bar/"+a+"/status"})}Roadmap.trackingBars=[];return{addCreateLinkPageListener:function(a,k){0>=parseInt(a.pageId)&&(a.parentPageId=AJS.Meta.get("parent-page-id"));var l=b.param(a);window.open(AJS.contextPath()+"/plugins/roadmap/create-page.action?"+
l,"_blank").opener=null;g(a.roadmapBarId).done(function(c){Roadmap.trackingBars.push(a.roadmapBarId)});b(window).off("focus");b(window).on("focus",function(){Roadmap.trackingBars.length||b(window).off("focus");f.each(Roadmap.trackingBars,function(c){h(c).done(function(d){var e=d.status;"REDEEM"==e?(Roadmap.trackingBars.splice(Roadmap.trackingBars.indexOf(c),1),k({barId:c,pageLink:b.parseJSON(d.pageLink)})):"UNKNOWN"==e&&Roadmap.trackingBars.splice(Roadmap.trackingBars.indexOf(c),1)})})})}}}(AJS.$,
window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:split_aui.splitchunk.vendors--825acd7236', location = 'aui.chunk.fc732d2f4ae07aa911a9--c1d71ea3b4c6752064f2.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["aui.splitchunk.vendors--825acd7236"],{PTCr:function(e,t,i){var s,o,n;
/*!
 * jQuery UI Droppable 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */o=[i("oDIA"),i("z+ct"),i("XPYc"),i("O+lX"),i("yIBB")],void 0===(n="function"==typeof(s=function(e){e.widget("ui.droppable",{version:"1.12.1",widgetEventPrefix:"drop",options:{accept:"*",addClasses:!0,greedy:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var t,i=this.options,s=i.accept;this.isover=!1,this.isout=!0,this.accept=e.isFunction(s)?s:function(e){return e.is(s)},this.proportions=function(){if(!arguments.length)return t||(t={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight});t=arguments[0]},this._addToManager(i.scope),i.addClasses&&this._addClass("ui-droppable")},_addToManager:function(t){e.ui.ddmanager.droppables[t]=e.ui.ddmanager.droppables[t]||[],e.ui.ddmanager.droppables[t].push(this)},_splice:function(e){for(var t=0;t<e.length;t++)e[t]===this&&e.splice(t,1)},_destroy:function(){var t=e.ui.ddmanager.droppables[this.options.scope];this._splice(t)},_setOption:function(t,i){if("accept"===t)this.accept=e.isFunction(i)?i:function(e){return e.is(i)};else if("scope"===t){var s=e.ui.ddmanager.droppables[this.options.scope];this._splice(s),this._addToManager(i)}this._super(t,i)},_activate:function(t){var i=e.ui.ddmanager.current;this._addActiveClass(),i&&this._trigger("activate",t,this.ui(i))},_deactivate:function(t){var i=e.ui.ddmanager.current;this._removeActiveClass(),i&&this._trigger("deactivate",t,this.ui(i))},_over:function(t){var i=e.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this._addHoverClass(),this._trigger("over",t,this.ui(i)))},_out:function(t){var i=e.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this._removeHoverClass(),this._trigger("out",t,this.ui(i)))},_drop:function(i,s){var o=s||e.ui.ddmanager.current,n=!1;return!(!o||(o.currentItem||o.element)[0]===this.element[0])&&(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each((function(){var s=e(this).droppable("instance");if(s.options.greedy&&!s.options.disabled&&s.options.scope===o.options.scope&&s.accept.call(s.element[0],o.currentItem||o.element)&&t(o,e.extend(s,{offset:s.element.offset()}),s.options.tolerance,i))return n=!0,!1})),!n&&!!this.accept.call(this.element[0],o.currentItem||o.element)&&(this._removeActiveClass(),this._removeHoverClass(),this._trigger("drop",i,this.ui(o)),this.element))},ui:function(e){return{draggable:e.currentItem||e.element,helper:e.helper,position:e.position,offset:e.positionAbs}},_addHoverClass:function(){this._addClass("ui-droppable-hover")},_removeHoverClass:function(){this._removeClass("ui-droppable-hover")},_addActiveClass:function(){this._addClass("ui-droppable-active")},_removeActiveClass:function(){this._removeClass("ui-droppable-active")}});var t=e.ui.intersect=function(){function e(e,t,i){return e>=t&&e<t+i}return function(t,i,s,o){if(!i.offset)return!1;var n=(t.positionAbs||t.position.absolute).left+t.margins.left,r=(t.positionAbs||t.position.absolute).top+t.margins.top,a=n+t.helperProportions.width,l=r+t.helperProportions.height,p=i.offset.left,c=i.offset.top,d=p+i.proportions().width,h=c+i.proportions().height;switch(s){case"fit":return p<=n&&a<=d&&c<=r&&l<=h;case"intersect":return p<n+t.helperProportions.width/2&&a-t.helperProportions.width/2<d&&c<r+t.helperProportions.height/2&&l-t.helperProportions.height/2<h;case"pointer":return e(o.pageY,c,i.proportions().height)&&e(o.pageX,p,i.proportions().width);case"touch":return(r>=c&&r<=h||l>=c&&l<=h||r<c&&l>h)&&(n>=p&&n<=d||a>=p&&a<=d||n<p&&a>d);default:return!1}}}();return e.ui.ddmanager={current:null,droppables:{default:[]},prepareOffsets:function(t,i){var s,o,n=e.ui.ddmanager.droppables[t.options.scope]||[],r=i?i.type:null,a=(t.currentItem||t.element).find(":data(ui-droppable)").addBack();e:for(s=0;s<n.length;s++)if(!(n[s].options.disabled||t&&!n[s].accept.call(n[s].element[0],t.currentItem||t.element))){for(o=0;o<a.length;o++)if(a[o]===n[s].element[0]){n[s].proportions().height=0;continue e}n[s].visible="none"!==n[s].element.css("display"),n[s].visible&&("mousedown"===r&&n[s]._activate.call(n[s],i),n[s].offset=n[s].element.offset(),n[s].proportions({width:n[s].element[0].offsetWidth,height:n[s].element[0].offsetHeight}))}},drop:function(i,s){var o=!1;return e.each((e.ui.ddmanager.droppables[i.options.scope]||[]).slice(),(function(){this.options&&(!this.options.disabled&&this.visible&&t(i,this,this.options.tolerance,s)&&(o=this._drop.call(this,s)||o),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,s)))})),o},dragStart:function(t,i){t.element.parentsUntil("body").on("scroll.droppable",(function(){t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,i)}))},drag:function(i,s){i.options.refreshPositions&&e.ui.ddmanager.prepareOffsets(i,s),e.each(e.ui.ddmanager.droppables[i.options.scope]||[],(function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var o,n,r,a=t(i,this,this.options.tolerance,s),l=!a&&this.isover?"isout":a&&!this.isover?"isover":null;l&&(this.options.greedy&&(n=this.options.scope,(r=this.element.parents(":data(ui-droppable)").filter((function(){return e(this).droppable("instance").options.scope===n}))).length&&((o=e(r[0]).droppable("instance")).greedyChild="isover"===l)),o&&"isover"===l&&(o.isover=!1,o.isout=!0,o._out.call(o,s)),this[l]=!0,this["isout"===l?"isover":"isout"]=!1,this["isover"===l?"_over":"_out"].call(this,s),o&&"isout"===l&&(o.isout=!1,o.isover=!0,o._over.call(o,s)))}}))},dragStop:function(t,i){t.element.parentsUntil("body").off("scroll.droppable"),t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,i)}},!1!==e.uiBackCompat&&e.widget("ui.droppable",e.ui.droppable,{options:{hoverClass:!1,activeClass:!1},_addActiveClass:function(){this._super(),this.options.activeClass&&this.element.addClass(this.options.activeClass)},_removeActiveClass:function(){this._super(),this.options.activeClass&&this.element.removeClass(this.options.activeClass)},_addHoverClass:function(){this._super(),this.options.hoverClass&&this.element.addClass(this.options.hoverClass)},_removeHoverClass:function(){this._super(),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass)}}),e.ui.droppable})?s.apply(t,o):s)||(e.exports=n)}}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:split_jquery.ui.droppable', location = 'aui.chunk.8214c015c6c7c75dde17--dadf7172b600f50e16fc.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["jquery.ui.droppable"],{qe8r:function(u,i,n){"use strict";n.r(i);n("PTCr");i.default="jquery"}},[["qe8r","runtime","aui.splitchunk.vendors--20a97d6a33","aui.splitchunk.vendors--d18e3cafa7","aui.splitchunk.vendors--db57146687","aui.splitchunk.vendors--51504ebf10","aui.splitchunk.vendors--9c8c8c1546","aui.splitchunk.vendors--351ae504d7","aui.splitchunk.vendors--06bc6ae5d7","aui.splitchunk.vendors--825acd7236","aui.splitchunk.0d131bcbf1"]]]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:split_aui.splitchunk.vendors--85718a7eef', location = 'aui.chunk.02a22885178b14aefbb5--1b3f68af03cccd00218f.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["aui.splitchunk.vendors--85718a7eef"],{"2V+C":function(t,i,e){"use strict";e.r(i)},XnJT:function(t,i,e){var s,h,n;
/*!
 * jQuery UI Resizable 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */h=[e("oDIA"),e("XPYc"),e("zq/Y"),e("lSwU"),e("O+lX"),e("yIBB")],void 0===(n="function"==typeof(s=function(t){return t.widget("ui.resizable",t.ui.mouse,{version:"1.12.1",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,classes:{"ui-resizable-se":"ui-icon ui-icon-gripsmall-diagonal-se"},containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_num:function(t){return parseFloat(t)||0},_isNumber:function(t){return!isNaN(parseFloat(t))},_hasScroll:function(i,e){if("hidden"===t(i).css("overflow"))return!1;var s=e&&"left"===e?"scrollLeft":"scrollTop",h=!1;return i[s]>0||(i[s]=1,h=i[s]>0,i[s]=0,h)},_create:function(){var i,e=this.options,s=this;this._addClass("ui-resizable"),t.extend(this,{_aspectRatio:!!e.aspectRatio,aspectRatio:e.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:e.helper||e.ghost||e.animate?e.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/^(canvas|textarea|input|select|button|img)$/i)&&(this.element.wrap(t("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.resizable("instance")),this.elementIsWrapper=!0,i={marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom"),marginLeft:this.originalElement.css("marginLeft")},this.element.css(i),this.originalElement.css("margin",0),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css(i),this._proportionallyResize()),this._setupHandles(),e.autoHide&&t(this.element).on("mouseenter",(function(){e.disabled||(s._removeClass("ui-resizable-autohide"),s._handles.show())})).on("mouseleave",(function(){e.disabled||s.resizing||(s._addClass("ui-resizable-autohide"),s._handles.hide())})),this._mouseInit()},_destroy:function(){this._mouseDestroy();var i,e=function(i){t(i).removeData("resizable").removeData("ui-resizable").off(".resizable").find(".ui-resizable-handle").remove()};return this.elementIsWrapper&&(e(this.element),i=this.element,this.originalElement.css({position:i.css("position"),width:i.outerWidth(),height:i.outerHeight(),top:i.css("top"),left:i.css("left")}).insertAfter(i),i.remove()),this.originalElement.css("resize",this.originalResizeStyle),e(this.originalElement),this},_setOption:function(t,i){switch(this._super(t,i),t){case"handles":this._removeHandles(),this._setupHandles()}},_setupHandles:function(){var i,e,s,h,n,o=this.options,a=this;if(this.handles=o.handles||(t(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this._handles=t(),this.handles.constructor===String)for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),s=this.handles.split(","),this.handles={},e=0;e<s.length;e++)h="ui-resizable-"+(i=t.trim(s[e])),n=t("<div>"),this._addClass(n,"ui-resizable-handle "+h),n.css({zIndex:o.zIndex}),this.handles[i]=".ui-resizable-"+i,this.element.append(n);this._renderAxis=function(i){var e,s,h,n;for(e in i=i||this.element,this.handles)this.handles[e].constructor===String?this.handles[e]=this.element.children(this.handles[e]).first().show():(this.handles[e].jquery||this.handles[e].nodeType)&&(this.handles[e]=t(this.handles[e]),this._on(this.handles[e],{mousedown:a._mouseDown})),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/^(textarea|input|select|button)$/i)&&(s=t(this.handles[e],this.element),n=/sw|ne|nw|se|n|s/.test(e)?s.outerHeight():s.outerWidth(),h=["padding",/ne|nw|n/.test(e)?"Top":/se|sw|s/.test(e)?"Bottom":/^e$/.test(e)?"Right":"Left"].join(""),i.css(h,n),this._proportionallyResize()),this._handles=this._handles.add(this.handles[e])},this._renderAxis(this.element),this._handles=this._handles.add(this.element.find(".ui-resizable-handle")),this._handles.disableSelection(),this._handles.on("mouseover",(function(){a.resizing||(this.className&&(n=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),a.axis=n&&n[1]?n[1]:"se")})),o.autoHide&&(this._handles.hide(),this._addClass("ui-resizable-autohide"))},_removeHandles:function(){this._handles.remove()},_mouseCapture:function(i){var e,s,h=!1;for(e in this.handles)((s=t(this.handles[e])[0])===i.target||t.contains(s,i.target))&&(h=!0);return!this.options.disabled&&h},_mouseStart:function(i){var e,s,h,n=this.options,o=this.element;return this.resizing=!0,this._renderProxy(),e=this._num(this.helper.css("left")),s=this._num(this.helper.css("top")),n.containment&&(e+=t(n.containment).scrollLeft()||0,s+=t(n.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:e,top:s},this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:o.width(),height:o.height()},this.originalSize=this._helper?{width:o.outerWidth(),height:o.outerHeight()}:{width:o.width(),height:o.height()},this.sizeDiff={width:o.outerWidth()-o.width(),height:o.outerHeight()-o.height()},this.originalPosition={left:e,top:s},this.originalMousePosition={left:i.pageX,top:i.pageY},this.aspectRatio="number"==typeof n.aspectRatio?n.aspectRatio:this.originalSize.width/this.originalSize.height||1,h=t(".ui-resizable-"+this.axis).css("cursor"),t("body").css("cursor","auto"===h?this.axis+"-resize":h),this._addClass("ui-resizable-resizing"),this._propagate("start",i),!0},_mouseDrag:function(i){var e,s,h=this.originalMousePosition,n=this.axis,o=i.pageX-h.left||0,a=i.pageY-h.top||0,l=this._change[n];return this._updatePrevProperties(),!!l&&(e=l.apply(this,[i,o,a]),this._updateVirtualBoundaries(i.shiftKey),(this._aspectRatio||i.shiftKey)&&(e=this._updateRatio(e,i)),e=this._respectSize(e,i),this._updateCache(e),this._propagate("resize",i),s=this._applyChanges(),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),t.isEmptyObject(s)||(this._updatePrevProperties(),this._trigger("resize",i,this.ui()),this._applyChanges()),!1)},_mouseStop:function(i){this.resizing=!1;var e,s,h,n,o,a,l,r=this.options,p=this;return this._helper&&(h=(s=(e=this._proportionallyResizeElements).length&&/textarea/i.test(e[0].nodeName))&&this._hasScroll(e[0],"left")?0:p.sizeDiff.height,n=s?0:p.sizeDiff.width,o={width:p.helper.width()-n,height:p.helper.height()-h},a=parseFloat(p.element.css("left"))+(p.position.left-p.originalPosition.left)||null,l=parseFloat(p.element.css("top"))+(p.position.top-p.originalPosition.top)||null,r.animate||this.element.css(t.extend(o,{top:l,left:a})),p.helper.height(p.size.height),p.helper.width(p.size.width),this._helper&&!r.animate&&this._proportionallyResize()),t("body").css("cursor","auto"),this._removeClass("ui-resizable-resizing"),this._propagate("stop",i),this._helper&&this.helper.remove(),!1},_updatePrevProperties:function(){this.prevPosition={top:this.position.top,left:this.position.left},this.prevSize={width:this.size.width,height:this.size.height}},_applyChanges:function(){var t={};return this.position.top!==this.prevPosition.top&&(t.top=this.position.top+"px"),this.position.left!==this.prevPosition.left&&(t.left=this.position.left+"px"),this.size.width!==this.prevSize.width&&(t.width=this.size.width+"px"),this.size.height!==this.prevSize.height&&(t.height=this.size.height+"px"),this.helper.css(t),t},_updateVirtualBoundaries:function(t){var i,e,s,h,n,o=this.options;n={minWidth:this._isNumber(o.minWidth)?o.minWidth:0,maxWidth:this._isNumber(o.maxWidth)?o.maxWidth:1/0,minHeight:this._isNumber(o.minHeight)?o.minHeight:0,maxHeight:this._isNumber(o.maxHeight)?o.maxHeight:1/0},(this._aspectRatio||t)&&(i=n.minHeight*this.aspectRatio,s=n.minWidth/this.aspectRatio,e=n.maxHeight*this.aspectRatio,h=n.maxWidth/this.aspectRatio,i>n.minWidth&&(n.minWidth=i),s>n.minHeight&&(n.minHeight=s),e<n.maxWidth&&(n.maxWidth=e),h<n.maxHeight&&(n.maxHeight=h)),this._vBoundaries=n},_updateCache:function(t){this.offset=this.helper.offset(),this._isNumber(t.left)&&(this.position.left=t.left),this._isNumber(t.top)&&(this.position.top=t.top),this._isNumber(t.height)&&(this.size.height=t.height),this._isNumber(t.width)&&(this.size.width=t.width)},_updateRatio:function(t){var i=this.position,e=this.size,s=this.axis;return this._isNumber(t.height)?t.width=t.height*this.aspectRatio:this._isNumber(t.width)&&(t.height=t.width/this.aspectRatio),"sw"===s&&(t.left=i.left+(e.width-t.width),t.top=null),"nw"===s&&(t.top=i.top+(e.height-t.height),t.left=i.left+(e.width-t.width)),t},_respectSize:function(t){var i=this._vBoundaries,e=this.axis,s=this._isNumber(t.width)&&i.maxWidth&&i.maxWidth<t.width,h=this._isNumber(t.height)&&i.maxHeight&&i.maxHeight<t.height,n=this._isNumber(t.width)&&i.minWidth&&i.minWidth>t.width,o=this._isNumber(t.height)&&i.minHeight&&i.minHeight>t.height,a=this.originalPosition.left+this.originalSize.width,l=this.originalPosition.top+this.originalSize.height,r=/sw|nw|w/.test(e),p=/nw|ne|n/.test(e);return n&&(t.width=i.minWidth),o&&(t.height=i.minHeight),s&&(t.width=i.maxWidth),h&&(t.height=i.maxHeight),n&&r&&(t.left=a-i.minWidth),s&&r&&(t.left=a-i.maxWidth),o&&p&&(t.top=l-i.minHeight),h&&p&&(t.top=l-i.maxHeight),t.width||t.height||t.left||!t.top?t.width||t.height||t.top||!t.left||(t.left=null):t.top=null,t},_getPaddingPlusBorderDimensions:function(t){for(var i=0,e=[],s=[t.css("borderTopWidth"),t.css("borderRightWidth"),t.css("borderBottomWidth"),t.css("borderLeftWidth")],h=[t.css("paddingTop"),t.css("paddingRight"),t.css("paddingBottom"),t.css("paddingLeft")];i<4;i++)e[i]=parseFloat(s[i])||0,e[i]+=parseFloat(h[i])||0;return{height:e[0]+e[2],width:e[1]+e[3]}},_proportionallyResize:function(){if(this._proportionallyResizeElements.length)for(var t,i=0,e=this.helper||this.element;i<this._proportionallyResizeElements.length;i++)t=this._proportionallyResizeElements[i],this.outerDimensions||(this.outerDimensions=this._getPaddingPlusBorderDimensions(t)),t.css({height:e.height()-this.outerDimensions.height||0,width:e.width()-this.outerDimensions.width||0})},_renderProxy:function(){var i=this.element,e=this.options;this.elementOffset=i.offset(),this._helper?(this.helper=this.helper||t("<div style='overflow:hidden;'></div>"),this._addClass(this.helper,this._helper),this.helper.css({width:this.element.outerWidth(),height:this.element.outerHeight(),position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++e.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(t,i){return{width:this.originalSize.width+i}},w:function(t,i){var e=this.originalSize;return{left:this.originalPosition.left+i,width:e.width-i}},n:function(t,i,e){var s=this.originalSize;return{top:this.originalPosition.top+e,height:s.height-e}},s:function(t,i,e){return{height:this.originalSize.height+e}},se:function(i,e,s){return t.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[i,e,s]))},sw:function(i,e,s){return t.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[i,e,s]))},ne:function(i,e,s){return t.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[i,e,s]))},nw:function(i,e,s){return t.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[i,e,s]))}},_propagate:function(i,e){t.ui.plugin.call(this,i,[e,this.ui()]),"resize"!==i&&this._trigger(i,e,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),t.ui.plugin.add("resizable","animate",{stop:function(i){var e=t(this).resizable("instance"),s=e.options,h=e._proportionallyResizeElements,n=h.length&&/textarea/i.test(h[0].nodeName),o=n&&e._hasScroll(h[0],"left")?0:e.sizeDiff.height,a=n?0:e.sizeDiff.width,l={width:e.size.width-a,height:e.size.height-o},r=parseFloat(e.element.css("left"))+(e.position.left-e.originalPosition.left)||null,p=parseFloat(e.element.css("top"))+(e.position.top-e.originalPosition.top)||null;e.element.animate(t.extend(l,p&&r?{top:p,left:r}:{}),{duration:s.animateDuration,easing:s.animateEasing,step:function(){var s={width:parseFloat(e.element.css("width")),height:parseFloat(e.element.css("height")),top:parseFloat(e.element.css("top")),left:parseFloat(e.element.css("left"))};h&&h.length&&t(h[0]).css({width:s.width,height:s.height}),e._updateCache(s),e._propagate("resize",i)}})}}),t.ui.plugin.add("resizable","containment",{start:function(){var i,e,s,h,n,o,a,l=t(this).resizable("instance"),r=l.options,p=l.element,d=r.containment,g=d instanceof t?d.get(0):/parent/.test(d)?p.parent().get(0):d;g&&(l.containerElement=t(g),/document/.test(d)||d===document?(l.containerOffset={left:0,top:0},l.containerPosition={left:0,top:0},l.parentData={element:t(document),left:0,top:0,width:t(document).width(),height:t(document).height()||document.body.parentNode.scrollHeight}):(i=t(g),e=[],t(["Top","Right","Left","Bottom"]).each((function(t,s){e[t]=l._num(i.css("padding"+s))})),l.containerOffset=i.offset(),l.containerPosition=i.position(),l.containerSize={height:i.innerHeight()-e[3],width:i.innerWidth()-e[1]},s=l.containerOffset,h=l.containerSize.height,n=l.containerSize.width,o=l._hasScroll(g,"left")?g.scrollWidth:n,a=l._hasScroll(g)?g.scrollHeight:h,l.parentData={element:g,left:s.left,top:s.top,width:o,height:a}))},resize:function(i){var e,s,h,n,o=t(this).resizable("instance"),a=o.options,l=o.containerOffset,r=o.position,p=o._aspectRatio||i.shiftKey,d={top:0,left:0},g=o.containerElement,u=!0;g[0]!==document&&/static/.test(g.css("position"))&&(d=l),r.left<(o._helper?l.left:0)&&(o.size.width=o.size.width+(o._helper?o.position.left-l.left:o.position.left-d.left),p&&(o.size.height=o.size.width/o.aspectRatio,u=!1),o.position.left=a.helper?l.left:0),r.top<(o._helper?l.top:0)&&(o.size.height=o.size.height+(o._helper?o.position.top-l.top:o.position.top),p&&(o.size.width=o.size.height*o.aspectRatio,u=!1),o.position.top=o._helper?l.top:0),h=o.containerElement.get(0)===o.element.parent().get(0),n=/relative|absolute/.test(o.containerElement.css("position")),h&&n?(o.offset.left=o.parentData.left+o.position.left,o.offset.top=o.parentData.top+o.position.top):(o.offset.left=o.element.offset().left,o.offset.top=o.element.offset().top),e=Math.abs(o.sizeDiff.width+(o._helper?o.offset.left-d.left:o.offset.left-l.left)),s=Math.abs(o.sizeDiff.height+(o._helper?o.offset.top-d.top:o.offset.top-l.top)),e+o.size.width>=o.parentData.width&&(o.size.width=o.parentData.width-e,p&&(o.size.height=o.size.width/o.aspectRatio,u=!1)),s+o.size.height>=o.parentData.height&&(o.size.height=o.parentData.height-s,p&&(o.size.width=o.size.height*o.aspectRatio,u=!1)),u||(o.position.left=o.prevPosition.left,o.position.top=o.prevPosition.top,o.size.width=o.prevSize.width,o.size.height=o.prevSize.height)},stop:function(){var i=t(this).resizable("instance"),e=i.options,s=i.containerOffset,h=i.containerPosition,n=i.containerElement,o=t(i.helper),a=o.offset(),l=o.outerWidth()-i.sizeDiff.width,r=o.outerHeight()-i.sizeDiff.height;i._helper&&!e.animate&&/relative/.test(n.css("position"))&&t(this).css({left:a.left-h.left-s.left,width:l,height:r}),i._helper&&!e.animate&&/static/.test(n.css("position"))&&t(this).css({left:a.left-h.left-s.left,width:l,height:r})}}),t.ui.plugin.add("resizable","alsoResize",{start:function(){var i=t(this).resizable("instance").options;t(i.alsoResize).each((function(){var i=t(this);i.data("ui-resizable-alsoresize",{width:parseFloat(i.width()),height:parseFloat(i.height()),left:parseFloat(i.css("left")),top:parseFloat(i.css("top"))})}))},resize:function(i,e){var s=t(this).resizable("instance"),h=s.options,n=s.originalSize,o=s.originalPosition,a={height:s.size.height-n.height||0,width:s.size.width-n.width||0,top:s.position.top-o.top||0,left:s.position.left-o.left||0};t(h.alsoResize).each((function(){var i=t(this),s=t(this).data("ui-resizable-alsoresize"),h={},n=i.parents(e.originalElement[0]).length?["width","height"]:["width","height","top","left"];t.each(n,(function(t,i){var e=(s[i]||0)+(a[i]||0);e&&e>=0&&(h[i]=e||null)})),i.css(h)}))},stop:function(){t(this).removeData("ui-resizable-alsoresize")}}),t.ui.plugin.add("resizable","ghost",{start:function(){var i=t(this).resizable("instance"),e=i.size;i.ghost=i.originalElement.clone(),i.ghost.css({opacity:.25,display:"block",position:"relative",height:e.height,width:e.width,margin:0,left:0,top:0}),i._addClass(i.ghost,"ui-resizable-ghost"),!1!==t.uiBackCompat&&"string"==typeof i.options.ghost&&i.ghost.addClass(this.options.ghost),i.ghost.appendTo(i.helper)},resize:function(){var i=t(this).resizable("instance");i.ghost&&i.ghost.css({position:"relative",height:i.size.height,width:i.size.width})},stop:function(){var i=t(this).resizable("instance");i.ghost&&i.helper&&i.helper.get(0).removeChild(i.ghost.get(0))}}),t.ui.plugin.add("resizable","grid",{resize:function(){var i,e=t(this).resizable("instance"),s=e.options,h=e.size,n=e.originalSize,o=e.originalPosition,a=e.axis,l="number"==typeof s.grid?[s.grid,s.grid]:s.grid,r=l[0]||1,p=l[1]||1,d=Math.round((h.width-n.width)/r)*r,g=Math.round((h.height-n.height)/p)*p,u=n.width+d,c=n.height+g,f=s.maxWidth&&s.maxWidth<u,m=s.maxHeight&&s.maxHeight<c,z=s.minWidth&&s.minWidth>u,w=s.minHeight&&s.minHeight>c;s.grid=l,z&&(u+=r),w&&(c+=p),f&&(u-=r),m&&(c-=p),/^(se|s|e)$/.test(a)?(e.size.width=u,e.size.height=c):/^(ne)$/.test(a)?(e.size.width=u,e.size.height=c,e.position.top=o.top-g):/^(sw)$/.test(a)?(e.size.width=u,e.size.height=c,e.position.left=o.left-d):((c-p<=0||u-r<=0)&&(i=e._getPaddingPlusBorderDimensions(this)),c-p>0?(e.size.height=c,e.position.top=o.top-g):(c=p-i.height,e.size.height=c,e.position.top=o.top+n.height-c),u-r>0?(e.size.width=u,e.position.left=o.left-d):(u=r-i.width,e.size.width=u,e.position.left=o.left+n.width-u))}}),t.ui.resizable})?s.apply(i,h):s)||(t.exports=n)},"zq/Y":function(t,i,e){var s,h,n;
/*!
 * jQuery UI Disable Selection 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */h=[e("oDIA"),e("O+lX")],void 0===(n="function"==typeof(s=function(t){return t.fn.extend({disableSelection:(i="onselectstart"in document.createElement("div")?"selectstart":"mousedown",function(){return this.on(i+".ui-disableSelection",(function(t){t.preventDefault()}))}),enableSelection:function(){return this.off(".ui-disableSelection")}});var i})?s.apply(i,h):s)||(t.exports=n)}}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:split_jquery.ui.resizable', location = 'aui.chunk.1d90a28dade82944164d--39af490fb549187563a7.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["jquery.ui.resizable"],{kW2n:function(u,i,n){"use strict";n.r(i);n("2V+C"),n("XnJT");i.default="jquery"}},[["kW2n","runtime","aui.splitchunk.vendors--20a97d6a33","aui.splitchunk.vendors--d18e3cafa7","aui.splitchunk.vendors--db57146687","aui.splitchunk.vendors--9c8c8c1546","aui.splitchunk.vendors--85718a7eef","aui.splitchunk.0d131bcbf1"]]]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:split_aui.splitchunk.vendors--7c76061134', location = 'aui.chunk.c2836e51a0ee32304449--2c05e867cf130e8d8ebe.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["aui.splitchunk.vendors--7c76061134"],{TRfs:function(e,t,s){"use strict";s.r(t)},iCCw:function(e,t,s){var l,i,n;
/*!
 * jQuery UI Selectable 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */i=[s("oDIA"),s("XPYc"),s("O+lX"),s("yIBB")],void 0===(n="function"==typeof(l=function(e){return e.widget("ui.selectable",e.ui.mouse,{version:"1.12.1",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var t=this;this._addClass("ui-selectable"),this.dragged=!1,this.refresh=function(){t.elementPos=e(t.element[0]).offset(),t.selectees=e(t.options.filter,t.element[0]),t._addClass(t.selectees,"ui-selectee"),t.selectees.each((function(){var s=e(this),l=s.offset(),i={left:l.left-t.elementPos.left,top:l.top-t.elementPos.top};e.data(this,"selectable-item",{element:this,$element:s,left:i.left,top:i.top,right:i.left+s.outerWidth(),bottom:i.top+s.outerHeight(),startselected:!1,selected:s.hasClass("ui-selected"),selecting:s.hasClass("ui-selecting"),unselecting:s.hasClass("ui-unselecting")})}))},this.refresh(),this._mouseInit(),this.helper=e("<div>"),this._addClass(this.helper,"ui-selectable-helper")},_destroy:function(){this.selectees.removeData("selectable-item"),this._mouseDestroy()},_mouseStart:function(t){var s=this,l=this.options;this.opos=[t.pageX,t.pageY],this.elementPos=e(this.element[0]).offset(),this.options.disabled||(this.selectees=e(l.filter,this.element[0]),this._trigger("start",t),e(l.appendTo).append(this.helper),this.helper.css({left:t.pageX,top:t.pageY,width:0,height:0}),l.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each((function(){var l=e.data(this,"selectable-item");l.startselected=!0,t.metaKey||t.ctrlKey||(s._removeClass(l.$element,"ui-selected"),l.selected=!1,s._addClass(l.$element,"ui-unselecting"),l.unselecting=!0,s._trigger("unselecting",t,{unselecting:l.element}))})),e(t.target).parents().addBack().each((function(){var l,i=e.data(this,"selectable-item");if(i)return l=!t.metaKey&&!t.ctrlKey||!i.$element.hasClass("ui-selected"),s._removeClass(i.$element,l?"ui-unselecting":"ui-selected")._addClass(i.$element,l?"ui-selecting":"ui-unselecting"),i.unselecting=!l,i.selecting=l,i.selected=l,l?s._trigger("selecting",t,{selecting:i.element}):s._trigger("unselecting",t,{unselecting:i.element}),!1})))},_mouseDrag:function(t){if(this.dragged=!0,!this.options.disabled){var s,l=this,i=this.options,n=this.opos[0],c=this.opos[1],a=t.pageX,o=t.pageY;return n>a&&(s=a,a=n,n=s),c>o&&(s=o,o=c,c=s),this.helper.css({left:n,top:c,width:a-n,height:o-c}),this.selectees.each((function(){var s=e.data(this,"selectable-item"),r=!1,u={};s&&s.element!==l.element[0]&&(u.left=s.left+l.elementPos.left,u.right=s.right+l.elementPos.left,u.top=s.top+l.elementPos.top,u.bottom=s.bottom+l.elementPos.top,"touch"===i.tolerance?r=!(u.left>a||u.right<n||u.top>o||u.bottom<c):"fit"===i.tolerance&&(r=u.left>n&&u.right<a&&u.top>c&&u.bottom<o),r?(s.selected&&(l._removeClass(s.$element,"ui-selected"),s.selected=!1),s.unselecting&&(l._removeClass(s.$element,"ui-unselecting"),s.unselecting=!1),s.selecting||(l._addClass(s.$element,"ui-selecting"),s.selecting=!0,l._trigger("selecting",t,{selecting:s.element}))):(s.selecting&&((t.metaKey||t.ctrlKey)&&s.startselected?(l._removeClass(s.$element,"ui-selecting"),s.selecting=!1,l._addClass(s.$element,"ui-selected"),s.selected=!0):(l._removeClass(s.$element,"ui-selecting"),s.selecting=!1,s.startselected&&(l._addClass(s.$element,"ui-unselecting"),s.unselecting=!0),l._trigger("unselecting",t,{unselecting:s.element}))),s.selected&&(t.metaKey||t.ctrlKey||s.startselected||(l._removeClass(s.$element,"ui-selected"),s.selected=!1,l._addClass(s.$element,"ui-unselecting"),s.unselecting=!0,l._trigger("unselecting",t,{unselecting:s.element})))))})),!1}},_mouseStop:function(t){var s=this;return this.dragged=!1,e(".ui-unselecting",this.element[0]).each((function(){var l=e.data(this,"selectable-item");s._removeClass(l.$element,"ui-unselecting"),l.unselecting=!1,l.startselected=!1,s._trigger("unselected",t,{unselected:l.element})})),e(".ui-selecting",this.element[0]).each((function(){var l=e.data(this,"selectable-item");s._removeClass(l.$element,"ui-selecting")._addClass(l.$element,"ui-selected"),l.selecting=!1,l.selected=!0,l.startselected=!0,s._trigger("selected",t,{selected:l.element})})),this._trigger("stop",t),this.helper.remove(),!1}})})?l.apply(t,i):l)||(e.exports=n)}}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:split_jquery.ui.selectable', location = 'aui.chunk.e44f4e4256ae4032b5f4--d41b8c0fd130c843a8f9.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["jquery.ui.selectable"],{FvNQ:function(u,i,n){"use strict";n.r(i);n("TRfs"),n("iCCw");i.default="jquery"}},[["FvNQ","runtime","aui.splitchunk.vendors--20a97d6a33","aui.splitchunk.vendors--d18e3cafa7","aui.splitchunk.vendors--db57146687","aui.splitchunk.vendors--7c76061134","aui.splitchunk.0d131bcbf1"]]]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/templates.soy' */
// This file was automatically generated from templates.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Roadmap.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Roadmap == 'undefined') { Confluence.Templates.Roadmap = {}; }


Confluence.Templates.Roadmap.roadmapPopupPanel = function(opt_data, opt_ignored) {
  return '<div class="roadmap-editor-popup"><div id=\'' + soy.$$escapeHtml(opt_data.roadmapPopupPanelId) + '\'></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.roadmapPopupPanel.soyTemplateName = 'Confluence.Templates.Roadmap.roadmapPopupPanel';
}


Confluence.Templates.Roadmap.roadmapEditor = function(opt_data, opt_ignored) {
  return '<div id="roadmap-editor-edit-area"><div id="roadmap-editor-edit-content"><!-- START GENERATE ROADMAP --><div id="roadmap-container"><div class="roadmap-drag-area"></div><div class="roadmap-frame"><div class="roadmap-marker"></div></div><div class="roadmap-content"></div></div><!-- END GENERATE ROADMAP --></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.roadmapEditor.soyTemplateName = 'Confluence.Templates.Roadmap.roadmapEditor';
}


Confluence.Templates.Roadmap.lane = function(opt_data, opt_ignored) {
  return '<div class="roadmap-lane-title" style="background-color: ' + soy.$$escapeHtml(opt_data.color.lane) + '; color: ' + soy.$$escapeHtml(opt_data.color.text) + '" title="' + soy.$$escapeHtml(opt_data.title) + '"><div class="title-outer"><div class="title-inner">' + soy.$$escapeHtml(opt_data.title) + '</div></div></div><div class="roadmap-separate-content">&nbsp;</div><div class="roadmap-lane-content"></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.lane.soyTemplateName = 'Confluence.Templates.Roadmap.lane';
}


Confluence.Templates.Roadmap.marker = function(opt_data, opt_ignored) {
  return '<div class="marker-drag-placeholder"></div><div class="marker-title-wrapper"><span class="marker-title" title="' + soy.$$escapeHtml(opt_data.title) + '">' + soy.$$escapeHtml(opt_data.title) + '</span></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.marker.soyTemplateName = 'Confluence.Templates.Roadmap.marker';
}


Confluence.Templates.Roadmap.bar = function(opt_data, opt_ignored) {
  return '<p class="roadmap-bar-title">' + soy.$$escapeHtml(opt_data.title) + '</p>';
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.bar.soyTemplateName = 'Confluence.Templates.Roadmap.bar';
}


Confluence.Templates.Roadmap.newRowLine = function(opt_data, opt_ignored) {
  return '<hr class="new-row-line" />';
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.newRowLine.soyTemplateName = 'Confluence.Templates.Roadmap.newRowLine';
}


Confluence.Templates.Roadmap.deprecationDialog = function(opt_data, opt_ignored) {
  return '<section role="dialog" id="' + soy.$$escapeHtml(opt_data.id) + '" class="aui-layer aui-dialog2 aui-dialog2-medium" aria-hidden="true"><header class="aui-dialog2-header"><h1 class="aui-dialog2-header-main">' + soy.$$escapeHtml('Macro unavailable') + '</h1></header><div class="aui-dialog2-content">' + soy.$$filterNoAutoescape('\x3cp\x3eThe roadmap macro has been deprecated as of version 12. You can still view your existing roadmap macros but you will no longer be able to edit them or create new ones.\x3c/p\x3e\x3cp\x3ePlease use our new Roadmap Planner macro to plan your roadmap.\x3c/p\x3e') + '<div class="new-roadmap-thumb"></div></div><footer class="aui-dialog2-footer"><div class="aui-dialog2-footer-actions"><button id="dialog-close-button" class="aui-button aui-button-link">' + soy.$$escapeHtml('Close') + '</button></div></footer></section>';
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.deprecationDialog.soyTemplateName = 'Confluence.Templates.Roadmap.deprecationDialog';
}


Confluence.Templates.Roadmap.newRowPlaceholder = function(opt_data, opt_ignored) {
  return '<hr class= "new-row-placeholder" />';
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.newRowPlaceholder.soyTemplateName = 'Confluence.Templates.Roadmap.newRowPlaceholder';
}


Confluence.Templates.Roadmap.laneDialog = function(opt_data, opt_ignored) {
  return '' + aui.buttons.button({id: 'add-bar-button', type: 'subtle', iconType: 'aui', extraClasses: 'aui-button-compact', text: '', extraAttributes: {title: 'Add bar'}, iconClass: 'aui-icon-small aui-iconfont-add'}) + aui.buttons.button({id: 'rename-button', type: 'subtle', iconType: 'aui', extraClasses: 'aui-button-compact', text: '', extraAttributes: {title: 'Rename lane'}, iconClass: 'aui-icon-small aui-iconfont-edit'}) + Confluence.Templates.Roadmap.laneColorSelect(opt_data) + ((opt_data.canDelete) ? aui.buttons.button({id: 'delete-button', type: 'subtle', iconType: 'aui', extraClasses: 'aui-button-compact', text: '', extraAttributes: {title: 'Delete lane'}, iconClass: 'aui-icon-small delete-icon'}) : '');
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.laneDialog.soyTemplateName = 'Confluence.Templates.Roadmap.laneDialog';
}


Confluence.Templates.Roadmap.markerDialog = function(opt_data, opt_ignored) {
  return '' + aui.buttons.button({id: 'rename-button', type: 'subtle', iconType: 'aui', extraClasses: 'aui-button-compact', text: '', extraAttributes: {title: 'Rename marker'}, iconClass: 'aui-icon-small aui-iconfont-edit'}) + aui.buttons.button({id: 'delete-button', type: 'subtle', iconType: 'aui', extraClasses: 'aui-button-compact', text: '', extraAttributes: {title: 'Delete marker'}, iconClass: 'aui-icon-small delete-icon'});
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.markerDialog.soyTemplateName = 'Confluence.Templates.Roadmap.markerDialog';
}


Confluence.Templates.Roadmap.markerRenameDialog = function(opt_data, opt_ignored) {
  return '' + aui.form.form({action: '', content: '' + aui.form.input({extraClasses: 'marker-title', name: 'marker-title', type: 'text', value: opt_data.markerTitle}) + aui.buttons.button({extraClasses: 'rename-button', text: 'Save'})});
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.markerRenameDialog.soyTemplateName = 'Confluence.Templates.Roadmap.markerRenameDialog';
}


Confluence.Templates.Roadmap.laneRenameDialog = function(opt_data, opt_ignored) {
  return '' + aui.form.form({action: '', content: '' + aui.form.input({extraClasses: 'lane-title', name: 'lane-title', type: 'text', value: opt_data.laneTitle}) + aui.buttons.button({extraClasses: 'rename-button', text: 'Save'})});
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.laneRenameDialog.soyTemplateName = 'Confluence.Templates.Roadmap.laneRenameDialog';
}


Confluence.Templates.Roadmap.laneColorSelect = function(opt_data, opt_ignored) {
  var output = '<a id="lane-color-select" href="#" aria-owns="lane-color-picker" aria-haspopup="true" class="aui-button aui-button-subtle aui-button-compact aui-dropdown2-trigger aui-style-default" title="' + soy.$$escapeHtml('Lane color') + '"><span class="color-item" style="background-color: ' + soy.$$escapeHtml(opt_data.laneColor) + ';">&nbsp;</span></a></a><div id="lane-color-picker" class="aui-dropdown2"><ul class="aui-list-truncate">';
  var colorList120 = opt_data.colors;
  var colorListLen120 = colorList120.length;
  for (var colorIndex120 = 0; colorIndex120 < colorListLen120; colorIndex120++) {
    var colorData120 = colorList120[colorIndex120];
    output += '<li class="color-display-item"><a href="#" ><span class="color-item ' + ((colorData120.lane == opt_data.laneColor) ? 'aui-icon aui-icon-small aui-iconfont-success' : '') + '" style="background-color: ' + soy.$$escapeHtml(colorData120.lane) + ';"></span></a></li>';
  }
  output += '</ul></div>';
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.laneColorSelect.soyTemplateName = 'Confluence.Templates.Roadmap.laneColorSelect';
}


Confluence.Templates.Roadmap.linkPageTitle = function(opt_data, opt_ignored) {
  return '<span class="link-page-title"></span>';
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.linkPageTitle.soyTemplateName = 'Confluence.Templates.Roadmap.linkPageTitle';
}


Confluence.Templates.Roadmap.footerActionContent = function(opt_data, opt_ignored) {
  return '' + aui.buttons.button({text: 'Insert', id: 'roadmapInsertBtn'}) + aui.buttons.button({text: 'Cancel', type: 'link', id: 'roadmapCancelBtn'});
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.footerActionContent.soyTemplateName = 'Confluence.Templates.Roadmap.footerActionContent';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/bar/bar.js' */
(function(d,e){Roadmap.BarView=Backbone.View.extend({className:"roadmap-bar",events:{click:"_showDialog",dragstart:"_onDragstart",dragstop:"_onDragStop",dropover:"_onDropOver",dropout:"_onDropOut"},attributes:function(){return{cid:this.cid}},initialize:function(){e.bindAll(this,"render","_updateBar","_beforeResize","updateMaxWidth","_deleteBar","_updateTitle");this._addEvents()},_addEvents:function(){var a=this;this.$el.draggable({opacity:.3,cursor:"move",appendTo:".roadmap-drag-area",snap:".roadmap-bar-row, .new-bar-row",
snapMode:"inner",snapTolerance:17,scroll:!0,zIndex:4020,helper:function(){return a.$el.clone().addClass("roadmap-bar-clone").data("View",a)}});this.$el.droppable({accept:".roadmap-bar",tolerance:"touch",hoverClass:"bar-hover-bar"});this.$el.data("View",this)},render:function(){this.updateColor(this.options.color);var a=this.options.timelineView.getBarPosition(this.model.attributes);this.$el.css({left:a.left+"px",width:a.width+"px"});this.$el.attr("title",this.model.get("title"));this.$el.append(Confluence.Templates.Roadmap.bar({title:this.model.get("title")}));
this.$el.resizable({handles:"e, w",minWidth:Roadmap.barMinWidth,start:this._beforeResize,stop:this._updateBar});return this},updateMaxWidth:function(a){this.$el.resizable("option","maxWidth",a);var b=this.$el.resizable("option","minWidth");a<b&&this.$el.resizable("option","minWidth",a)},_beforeResize:function(a,b){this._barDialog&&this._barDialog.remove();this.trigger("beforeResize",this,this._checkHandleDirection(a))},_checkHandleDirection:function(a){a=d(a.toElement?a.toElement:a.originalEvent.target);
if(a.hasClass("ui-resizable-w"))return"left";if(a.hasClass("ui-resizable-e"))return"right";throw"Unsupport resize direction handling \x3d "+a;},_updateBar:function(a,b){b.originalPosition.left!=b.position.left?this.model.set({startDate:this.options.timelineView.getBarStartDate(b.position.left),duration:this.options.timelineView.getBarDuration(b.element.outerWidth())}):b.originalSize.width!=b.size.width&&this.model.set("duration",this.options.timelineView.getBarDuration(b.element.outerWidth()))},appendTo:function(a){this.$el.appendTo(a)},
updateColor:function(a){this.$el.css({"background-color":a.bar,"border-color":a.lane,color:a.text})},updatePositionLeft:function(a){this.$el.css("left",a)},_onDragStop:function(a,b){this.options.lane.cleanLaneAfterDrop();this.$el.trigger("BarView.dragstop")},updateDeleteBar:function(a){this.options.deleteBar=a},_showDialog:function(a){d(a.target).is(".ui-resizable-handle")||(this._barDialog&&this._barDialog.remove(),this._barDialog=this._createDialog(),this._barDialog.show(),Confluence.Roadmap.Analytics.openBarDialogInEdit())},
_createDialog:function(){return new Roadmap.BarDialogView({trigger:this.$el,model:this.model,timelineWidth:this.options.timelineView.$el.width(),renderOption:{isEditMode:!0,editInplace:{title:!0,pageLink:!0,description:!0}},linkPageEditable:!0,deleteBar:this._deleteBar,updateTitle:this._updateTitle,updateDescription:this._updateDescription,updatePageLink:this._updatePageLink,createLinkPageCallback:this._goToCreateLinkPage})},_deleteBar:function(){this.options.deleteBar(this)},_updateTitle:function(a){this.model.set("title",
a);this.$el.attr("title",a);this.$el.find(".roadmap-bar-title").html(AJS.escapeHtml(a))},_updateDescription:function(a){this.model.set("description",a)},_updatePageLink:function(a){this.model.set("pageLink",a)},_onDragstart:function(a,b){Roadmap.DragDrop.barDraggingOver={};this.$el.trigger("BarView.dragstart",[b])},_onDropOver:function(a,b){Roadmap.DragDrop.barDraggingOver[this.cid]=this.cid;Roadmap.DragDrop.barDraggingOver&&!0!==b.helper.data("isAddingNewRow")&&b.helper.addClass("roadmap-bar-overlapped")},
_onDropOut:function(a,b){delete Roadmap.DragDrop.barDraggingOver[this.cid];b.helper.removeClass("roadmap-bar-overlapped");e.each(Roadmap.DragDrop.barDraggingOver,function(c){!0!==b.helper.data("isAddingNewRow")&&("string"===typeof c?b.helper.addClass("roadmap-bar-overlapped"):"roadmap-bar-row"===c.className&&c.$el.addClass("roadmap-bar-drag-hover"))})},_goToCreateLinkPage:function(a){a.preventDefault();var b=this.me;a=parseInt(AJS.Meta.get("page-id"));a=0<a?a:AJS.Meta.get("parent-page-id");Confluence.RoadmapLink.addCreateLinkPageListener({roadmapBarId:b.model.id,
roadmapContentId:a,updateRoadmap:!1},function(c){c=b._updatePageLink(c.pageLink);b.fields.$pageLink.html(c)})}})})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/bar/bar-row.js' */
(function(c,e){Roadmap.BarRowView=Backbone.View.extend({className:"roadmap-bar-row",initialize:function(){e.bindAll(this,"_addEvents");this._addEvents();return this},attributes:function(){return{cid:this.cid}},_addEvents:function(){var d=this;this.$el.droppable({greedy:!0,tolerance:"pointer",hoverClass:"roadmap-bar-drag-hover",activeClass:"roadmap-bar-drag-active",accept:".roadmap-bar",over:function(b,a){Roadmap.DragDrop.barDraggingOver[d.cid]=d;!0!==a.helper.data("isAddingNewRow")?c(this).closest(".roadmap-content").find(".new-row-placeholder").remove():
d.$el.removeClass("roadmap-bar-drag-hover")},out:function(){var b=c(this);delete Roadmap.DragDrop.barDraggingOver[d.cid];b.closest(".roadmap-content").find(".new-row-placeholder").remove()},drop:function(b,a){b=0<e.reject(Roadmap.DragDrop.barDraggingOver,function(f){return"object"===typeof f}).length;a.helper.hasClass("roadmap-bar-overlapped")||b||c(this).trigger("BarView.drop",[{$barViewHelper:a.helper,$barViewOriginal:a.draggable,$barRow:c(this)},a])}})},isEmptyRow:function(){return this.$el.is(":empty")}})})(AJS.$,
window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/bar/bar-row-new.js' */
(function(e,c){Roadmap.BarRowNewView=Backbone.View.extend({className:"new-bar-row",overlayTop:3,margin:5,events:{drop:"_onDrop",dropover:"_onDropOver",dropout:"_onDropOut"},initialize:function(){c.bindAll(this,"render","_addEvent");return this},render:function(){this.$el.append(Confluence.Templates.Roadmap.newRowLine());this._addEvent();this._setSizePosition();return this},_addEvent:function(){this.$el.droppable({accept:".roadmap-bar",tolerance:"pointer",hoverClass:"new-bar-row-hover"})},_setSizePosition:function(){var a=
this.options.$barRow,b=!1===this.options.renderBottom?-1*this.margin:a.height(),d=0===a.index()?this.overlayTop+this.margin:this.overlayTop;this.$el.css({top:a.position().top+b-d,width:a.width()})},_onDrop:function(a,b){this.$el.trigger("BarView.drop",[{barRowNewView:this},b])},_onDropOver:function(a,b){this.$el.trigger("BarRowNew.dropover",[this,b])},_onDropOut:function(a,b){this.$el.trigger("BarRowNew.dropout",[this,b])}})})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/lane-dialog/lane-dialog.js' */
(function(a,g){var d=Roadmap.InlineDialogView;Roadmap.LaneDialogView=d.extend({events:{"click #delete-button":"_onDeleteClick","click #rename-button":"_onRenameClick","click #add-bar-button":"_onAddBarClick"},initialize:function(){g.bindAll(this,"_onHide");this.options.dialogOptions={width:this._getDialogWidth(),hideCallback:this._onHide};a(".roadmap-editor-popup, .roadmap-macro-view").scroll(function(){a("#lane-color-picker").hide()});d.prototype.initialize.call(this,this.options)},_getContent:function(b){var e=
this.options.lane.model.get("color").lane;b.html(Confluence.Templates.Roadmap.laneDialog({canDelete:this.options.canDelete,colors:Roadmap.COLORS,laneColor:e}));this.$el.find(".aui-button").tooltip({gravity:"s"});var h=this,f=this.$el.find("#lane-color-picker .color-item");f.click(function(c){c.preventDefault();c=Roadmap.COLORS[f.index(this)];c.lane!=e&&h.options.changeColor(c);a("#lane-color-picker").hide()})},_getDialogWidth:function(){var b=2;this.options.canDelete&&b++;return 29*b+51},_onDeleteClick:function(){this.options.deleteLane();
this.remove()},_onRenameClick:function(){this._laneRenameDialog||(this._laneRenameDialog=new Roadmap.LaneRenameDialogView({trigger:this.options.trigger,lane:this.options.lane}));this._laneRenameDialog.show();this.hide()},_onAddBarClick:function(){this.options.addBar();this.remove()},_onHide:function(){a("#lane-color-picker").hide();d.prototype._onHide.call(this)}})})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/lane-dialog/lane-rename-dialog.js' */
(function(d,e){var b=require("confluence/form-state-control"),c=Roadmap.InlineDialogView;Roadmap.LaneRenameDialogView=c.extend({events:{"click .rename-button":"_onRenameButtonClick","keyup .lane-title":"_onChangeLaneTitle"},initialize:function(){this.options.dialogOptions={width:this._getDialogWidth()};c.prototype.initialize.call(this,this.options)},_getContent:function(a){a.html(Confluence.Templates.Roadmap.laneRenameDialog({laneTitle:this.options.trigger.text()}));this.controls={$renameButton:this.$el.find(".rename-button"),
$laneTitle:this.$el.find(".lane-title")}},_getDialogWidth:function(){return 315},_onChangeLaneTitle:function(a){d.trim(this.controls.$laneTitle.val())?(b.enableElement(this.controls.$renameButton),a.which==AJS.$.ui.keyCode.ENTER&&this.controls.$renameButton.click()):b.disableElement(this.controls.$renameButton)},_onShow:function(a){this.controls.$laneTitle.select()},_onRenameButtonClick:function(a){a.preventDefault();this.hide();a=this.controls.$laneTitle.val();this.options.lane.renameTitle(a)}})})(AJS.$,
window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/marker-dialog/marker-dialog.js' */
(function(c,d){var a=Roadmap.InlineDialogView;Roadmap.MarkerDialogView=a.extend({events:{"click #rename-button":"_onRenameButtonClick","click #delete-button":"_onDeleteButtonClick"},initialize:function(){this.options.dialogOptions={width:60};a.prototype.initialize.call(this,this.options)},_getContent:function(b){b.html(Confluence.Templates.Roadmap.markerDialog());this.$el.find(".aui-button.aui-button-compact").tooltip({gravity:"s"})},_onRenameButtonClick:function(){this._markerRenameDialog||(this._markerRenameDialog=
new Roadmap.MarkerRenameDialogView({trigger:this.options.trigger,marker:this.options.marker}));this._markerRenameDialog.show();this.hide()},_onDeleteButtonClick:function(){this.options.marker.removeMarker();this.hide()}})})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/marker-dialog/marker-rename-dialog.js' */
(function(d,e){var b=require("confluence/form-state-control"),c=Roadmap.InlineDialogView;Roadmap.MarkerRenameDialogView=c.extend({events:{"click .rename-button":"_onSaveButtonClick","keyup .marker-title":"_onChangeMarkerTitle"},initialize:function(){this.options.dialogOptions={width:315};c.prototype.initialize.call(this,this.options)},_getContent:function(a){a.html(Confluence.Templates.Roadmap.markerRenameDialog({markerTitle:this.options.marker.model.get("title")}));this.controls={$renameButton:this.$el.find(".rename-button"),
$title:this.$el.find(".marker-title")}},_onChangeMarkerTitle:function(a){d.trim(this.controls.$title.val())?(b.enableElement(this.controls.$renameButton),a.which==AJS.$.ui.keyCode.ENTER&&this.controls.$renameButton.click()):b.disableElement(this.controls.$renameButton)},_onShow:function(a){this.controls.$title.select()},_onSaveButtonClick:function(a){a.preventDefault();this.hide();this.options.marker.renameTitle(this.controls.$title.val())}})})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/lane.js' */
(function(k,f){window.Roadmap=window.Roadmap||{};Roadmap.LaneView=Backbone.View.extend({tagName:"div",className:"roadmap-lane",events:{"click .roadmap-lane-title":"_showDialog","BarView.drop":"_onBarDropped","BarRowNew.dropover":"_onBarRowNewDropover","BarRowNew.dropout":"_onBarRowNewDropout"},attributes:function(){return{cid:this.cid}},initialize:function(){f.bindAll(this,"render","renameTitle","updateRowIndex","removeEmptyRow","cleanLaneAfterDrop","_deleteLane","_updateLaneHeight","_renderComplete",
"_deleteBar","_addBar","_changeColor","addDefaultBarRow");this._barViews=[];this._barRowViews=[];this.listenTo(this.model.get("bars"),"add",function(a){var b=this._newBarRowView();a=this._newBarView(a);b.$el.append(a.render().$el);this._$laneContent.append(b.$el);this._barViews.push(a);this.$el.trigger("BarView.add",a);f.defer(this._updateLaneHeight)})},render:function(){var a=this;this.$el.append(Confluence.Templates.Roadmap.lane({title:this.model.get("title"),color:this.model.get("color")}));Confluence.Roadmap.ColorHelper.adjustColorCount(this.model.get("color"),
1);var b=this.model.get("bars").models;b=f.sortBy(b,function(c){return c.attributes.rowIndex});f.each(b,function(c){c=a._newBarView(c);a._barViews.push(c)});this._renderBars();f.defer(this._renderComplete);return this},_renderComplete:function(){this._updateLaneHeight()},renameTitle:function(a){this.model.set("title",a);this.$el.find(".roadmap-lane-title").attr("title",a);this.$el.find(".title-inner").html(AJS.escapeHtml(a));this._updateLaneHeight()},_updateLaneHeight:function(){var a=this.$el.find(".title-inner");
a.hide();var b=this._$laneContent.outerHeight();a.width(b-2*Roadmap.LANE_PADDING);a.show()},_barBeforeResize:function(a,b){var c=a.$el,d=Math.ceil(c.outerWidth()-c.width());"left"==b?(b=this._getNearestBarView(a,b),d=null==b?0:b.position().left+b.width()+d,d=c.position().left-d,c=c.width()+d):(b=this._getNearestBarView(a,b),c=(null==b?this._getLaneContentWidth()-d:b.position().left-d)-c.position().left);a.updateMaxWidth(c-Roadmap.BAR_MARGIN)},_renderBars:function(){var a=this;this._$laneContent=this.$el.find(".roadmap-lane-content");
var b={};f.each(this._barViews,function(c){var d="row-"+c.model.get("rowIndex"),e=b[d];e||(e=a._newBarRowView(c.model.get("rowIndex")),b[d]=e);e.$el.append(c.render().$el);a._$laneContent.append(e.$el)})},_newBarRowView:function(){var a=new Roadmap.BarRowView;this._barRowViews.push(a);return a},_newBarView:function(a){a=new Roadmap.BarView({model:a,lane:this,color:this.model.get("color"),timelineView:this.options.timelineView,deleteBar:this._deleteBar});a.on("beforeResize",f.bind(this._barBeforeResize,
this));return a},_getNearestBarView:function(a,b){var c=f.filter(a.options.lane._barViews,function(e){return e.model.get("rowIndex")===a.model.get("rowIndex")}),d=null;"left"==b?f.each(c,function(e){e.$el.position().left<a.$el.position().left&&(null==d||e.$el.position().left>d.$el.position().left)&&(d=e)}):f.each(c,function(e){e.$el.position().left>a.$el.position().left&&(null==d||e.$el.position().left<d.$el.position().left)&&(d=e)});return null!=d?d.$el:null},_getLaneContentWidth:function(){return this.$el.find(".roadmap-lane-content").width()},
_showDialog:function(){this._laneDialog&&this._laneDialog.remove();this._laneDialog=this._createLaneDialog();this._laneDialog.show()},_createLaneDialog:function(){return new Roadmap.LaneDialogView({trigger:this.$el.find(".title-outer"),canDelete:this.options.canDelete,deleteLane:this._deleteLane,addBar:this._addBar,changeColor:this._changeColor,lane:this})},_onBarDropped:function(a,b,c){var d=!!b.barRowNewView;a=c.draggable.data("View");var e=a.model,g=a.options.lane,h=g.cid===this.cid,l=this.model.get("bars"),
m=c.position.left,n=this.options.timelineView.getBarStartDate(m);h&&1===l.models.length&&d||(a.updatePositionLeft(m),a.updateColor(this.model.get("color")),e.attributes.startDate=n,d?(d=this._newBarRowView(),b.barRowNewView.$el.replaceWith(d.$el),a.appendTo(d.$el)):a.appendTo(b.$barRow),c.helper.remove(),h||(a.options.lane.removeEmptyRow(),l._byId[e.id]=e,this._barViews.push(a),a.updateDeleteBar(this._deleteBar),g.model.get("bars").remove(e),l.models.push(e),g._barViews.splice(f.indexOf(g._barViews,
a),1),this.updateRowIndex(g.$el),a.options=f.extend(a.options,{color:this.model.get("color"),lane:this}),g._updateLaneHeight()),this.removeEmptyRow(),this.updateRowIndex(this.$el),this._updateLaneHeight())},updateRowIndex:function(a){a.find(".roadmap-bar-row").each(function(b,c){k(c).find('.roadmap-bar:not(".roadmap-bar-clone")').each(function(d,e){if(d=k(e).data("View"))d.model.attributes.rowIndex=b})})},removeEmptyRow:function(){var a=0;f.each(this._barRowViews,function(b){b.isEmptyRow()&&(b.remove(),
a++)});return!!a},cleanLaneAfterDrop:function(){this._$laneContent.find(".roadmap-bar-drag-active").removeClass("roadmap-bar-drag-active");this._$laneContent.find(".new-row-placeholder").remove()},_deleteLane:function(){Confluence.Roadmap.ColorHelper.adjustColorCount(this.model.get("color"),-1);this.$el.trigger("Lane.delete",this)},updateDeleteStatus:function(a){this._laneDialog&&(this._laneDialog.remove(),delete this._laneDialog);this.options.canDelete=a},_deleteBar:function(a){this.model.get("bars").remove(a.model);
this._barViews.splice(f.indexOf(this._barViews,a),1);a.remove();this.removeEmptyRow()&&(this.updateRowIndex(this.$el),this._updateLaneHeight(),this.$el.trigger("BarRowView.remove"))},_addBar:function(){var a=this.model.get("bars"),b=this.options.timelineView.model,c=moment(b.get("startDate"));b=b.get("displayOption")===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH?c.startOf("month"):c.startOf("isoWeek");a.add(new Roadmap.Bar({rowIndex:this.model.getNumberOfRows(),startDate:b.toDate()}))},_changeColor:function(a){Confluence.Roadmap.ColorHelper.adjustColorCount(this.model.get("color"),
-1);this.model.set("color",a);Confluence.Roadmap.ColorHelper.adjustColorCount(a,1);this.$el.find(".roadmap-lane-title").css({"background-color":a.lane,color:a.text});f.each(this._barViews,function(b){b.updateColor(a)})},addNewBarRow:function(a){var b=this._$laneContent.find(".roadmap-bar-row"),c=[],d=function(){b.each(function(){var g=k(this);if(0===g.index()){var h=new Roadmap.BarRowNewView({$barRow:g,renderBottom:!1});g.before(h.render().$el);c.push(h)}h=new Roadmap.BarRowNewView({$barRow:g});g.after(h.render().$el);
c.push(h)})};if(0==b.length)this.addDefaultBarRow();else{var e=b.find(".roadmap-bar");0<e.length&&(0<e.length&&1==e.length&&e.attr("cid")===a.attr("cid")||d())}return c},addDefaultBarRow:function(){var a=this._newBarRowView();this._$laneContent.append(a.$el)},_onBarRowNewDropover:function(a,b,c){f.isEmpty(Roadmap.DragDrop.barDraggingOver)||f.each(Roadmap.DragDrop.barDraggingOver,function(d){d.$el&&d.$el.removeClass("new-bar-row-hover roadmap-bar-drag-hover")});Roadmap.DragDrop.barDraggingOver[b.cid]=
b;c.helper.removeClass("roadmap-bar-overlapped");c.helper.data("isAddingNewRow",!0)},_onBarRowNewDropout:function(a,b,c){c.helper.data("isAddingNewRow",!1);delete Roadmap.DragDrop.barDraggingOver[b.cid];f.each(Roadmap.DragDrop.barDraggingOver,function(d){"string"===typeof d?c.helper.addClass("roadmap-bar-overlapped"):"roadmap-bar-row"===d.className&&!0!==c.helper.data("isAddingNewRow")&&d.$el.addClass("roadmap-bar-drag-hover")})}})})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/marker.js' */
(function(d,c){window.Roadmap=window.Roadmap||{};Roadmap.MarkerView=Backbone.View.extend({className:"vertical-line",events:{dragstop:"_onDragStop",dragstart:"_onDragStart"},initialize:function(){c.bindAll(this,"render","updateHeight","renameTitle","_renderComplete","_onMarkerClick")},render:function(){var a=this.options.roadmap._timelineView.model;a=a.get("displayOption")===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH?Confluence.Roadmap.Helper.getPosXOnMonthTimeline(a.attributes,this.model.get("markerDate")):
Confluence.Roadmap.Helper.getPosXOnWeekTimeline(a.attributes,this.model.get("markerDate"));if(0>a||a>this.options.roadmap._timelineView.$el.width())return!1;this.$el.css({left:a+Roadmap.LANE_TITLE_WIDTH+"px"});this.$el.append(Confluence.Templates.Roadmap.marker({title:this.model.get("title")}));this.updateHeight(this.options.roadmap._getLaneHeight());c.defer(this._renderComplete);return this},_renderComplete:function(){this._setupMarkerDragging();this.$el.click(this._onMarkerClick);this.$el.find(".marker-title").ellipsis({row:Roadmap.MARKER_TITLE_LINE})},
_setupMarkerDragging:function(){this.$el.draggable({axis:"x",zIndex:4013,containment:".roadmap-frame-content",cursor:"move"})},_onDragStop:function(a,b){a=b.position.left-Roadmap.LANE_TITLE_WIDTH;b=this.options.roadmap._timelineView.model.attributes;a=b.displayOption===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH?Confluence.Roadmap.Helper.getMonthStartDateByPosition(b,a):Confluence.Roadmap.Helper.getWeekStartDateByPosition(b,a);this.model.set("markerDate",a)},_onDragStart:function(a,b){this.options.roadmap.hideDialog()},
_onMarkerClick:function(a){d(a.target).hasClass("marker-title")&&(this._markerDialog&&this._markerDialog.remove(),this._markerDialog=this._createMarkerDialog(),this._markerDialog.show())},_createMarkerDialog:function(){return new Roadmap.MarkerDialogView({trigger:this.$el.find(".marker-title"),marker:this})},updateHeight:function(a){this.$el.height(a+Roadmap.MARKER_HEIGHT_PADDING)},renameTitle:function(a){this.model.set("title",a);var b=this.$el.find(".marker-title");b.attr("title",a);b.html(AJS.escapeHtml(a)).ellipsis({row:Roadmap.MARKER_TITLE_LINE})},
removeMarker:function(){this.model.collection.remove(this.model);this.remove()}})})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/roadmap.js' */
(function(g,e){window.Roadmap=window.Roadmap||{};Roadmap.RoadmapEditorView=Backbone.View.extend({className:"roadmap-editor-container",events:{"BarView.add":"_onAddBar","BarView.dragstart":"_onBarDragstart","BarView.dragstop":"_onBarDragstop","BarView.drop":"_onBarDropped","LaneView.drop":"_onBarDropped","Lane.delete":"_onDeleteLane","BarRowView.remove":"_onBarRowViewRemove","sortstart .roadmap-content":"_onSortStart","sortstop .roadmap-content":"_onSortStop",remove:"_onRemove"},initialize:function(){e.bindAll(this,
"render");this.listenTo(this.model.get("lanes"),"add",function(a){a=new Roadmap.LaneView({model:a,timelineView:this._timelineView,canDelete:!0});1===this._laneViews.length&&this._laneViews[0].updateDeleteStatus(!0);this._laneViews.push(a);this.$roadmapContent.append(a.render().$el);this._updateTimelineColumnHeight();this._scrollToBottom()});this.listenTo(this.model.get("markers"),"add",function(a){a=new Roadmap.MarkerView({model:a,roadmap:this});this.$roadmapMarker.append(a.render().$el);this._markerViews.push(a)});
this.listenTo(this.model.get("timeline"),"change",function(){this._isTimelineChanged()&&(this._calculateMinWidthOfABar(),this._timelineView.update(),this._timelineColumnView.update(),this.$roadmapContent.empty(),e.each(this._laneViews,function(a){a.remove()}),this._laneViews=[],this._renderLanes(),this.$roadmapMarker.empty(),this._markerViews=[],this._renderMarkers(),this._updateDragArea())})},render:function(){this.$el.html(Confluence.Templates.Roadmap.roadmapEditor());this._calculateMinWidthOfABar();
this._initVariables();this._renderToolbar();this._renderTimeline();this._renderLanes();this._renderMarkers();this._renderTimelineColumn();this._updateDragArea();return this},_calculateMinWidthOfABar:function(){Roadmap.barMinWidth=this.model.get("timeline").get("displayOption")===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH?Roadmap.MONTH_BAR_MIN_WIDTH:Roadmap.WEEK_BAR_MIN_WIDTH},_initVariables:function(){this.$roadmapContainer=this.$el.find("#roadmap-container");this.$roadmapTimeline=this.$roadmapContainer.find(".roadmap-frame");
this.$roadmapContent=this.$roadmapContainer.find(".roadmap-content");this.$roadmapMarker=this.$roadmapContainer.find(".roadmap-marker");this._timelineView=new Roadmap.TimelineView({model:this.model.get("timeline")});this._timelineColumnView=new Roadmap.TimelineColumnView({model:this.model.get("timeline")});this._laneViews=[];this._markerViews=[]},_renderTimeline:function(){this.$roadmapTimeline.prepend(this._timelineView.render().$el)},_renderTimelineColumn:function(){this._updateTimelineColumnHeight();
this.$roadmapTimeline.append(this._timelineColumnView.render().$el)},_renderMarkers:function(){var a=this;this.model.get("markers").each(function(b){b=new Roadmap.MarkerView({model:b,roadmap:a});a.$roadmapMarker.append(b.render().$el);a._markerViews.push(b)})},_renderLanes:function(){Confluence.Roadmap.ColorHelper.resetColorCounts();var a=this;this._updateLaneWidth();var b=1<this.model.get("lanes").models.length;this.model.get("lanes").each(function(c){c=new Roadmap.LaneView({model:c,timelineView:a._timelineView,
canDelete:b});a._laneViews.push(c);a.$roadmapContent.append(c.render().$el)});this._setupLaneReordering()},_onAddBar:function(a,b){this._updateTimelineColumnHeight();a=b.$el;this._isInViewScreen(a)||this._scrollToBar(a)},_renderToolbar:function(){var a=g("#"+this.options.dialogId+" .aui-dialog2-content");a.find(".roadmap-toolbar").remove();var b=new Roadmap.ToolbarView({model:this.model,timelineView:this._timelineView});a.prepend(b.render().$el)},_getTimelineWidth:function(){return this.$roadmapTimeline.find(".roadmap-frame-title").width()},
_getLaneHeight:function(){return this.$roadmapContent.height()},_updateLaneWidth:function(){this.$roadmapContent.width(this._getTimelineWidth()+Roadmap.LANE_TITLE_WIDTH)},_scrollToBottom:function(){this.options.roadmapEditorPopup.scrollTop(this._getLaneHeight())},_isInViewScreen:function(a){return g.inviewport(a,{threshold:-200})},_scrollToBar:function(a){this.options.roadmapEditorPopup.scrollTop(a.parent().position().top);this.options.roadmapEditorPopup.scrollLeft(0)},_onBarDropped:function(){this._updateTimelineColumnHeight()},
_onDeleteLane:function(a,b){this.model.get("lanes").remove(b.model);this._laneViews.splice(e.indexOf(this._laneViews,b),1);b.remove();this._updateTimelineColumnHeight();1===this._laneViews.length&&this._laneViews[0].updateDeleteStatus(!1)},_onBarRowViewRemove:function(){this._updateTimelineColumnHeight()},_updateTimelineColumnHeight:function(){var a=this._getLaneHeight();this._timelineColumnView.updateHeight(a);e.each(this._markerViews,function(b){b.updateHeight(a)})},hideDialog:function(){g("#inline-dialog-roadmap-dialog, #inline-dialog-timeline-options").hide()},
removeDialog:function(){g("#inline-dialog-roadmap-dialog, #inline-dialog-timeline-options").remove()},_onBarDragstart:function(a,b){var c=this;this.hideDialog();this._updateDragArea();this._barRowNewViewList=[];e.each(this._laneViews,function(d){c._barRowNewViewList.push(d.addNewBarRow(b.helper))})},_updateDragArea:function(){this.$roadmapContainer.find(".roadmap-drag-area").css(this._timelineColumnView.getSizeAndPosition())},_onBarDragstop:function(){e.each(e.flatten(this._barRowNewViewList),function(a){a.remove()});
delete this._barRowNewViewList;e.each(this._laneViews,function(a){a.removeEmptyRow()})},_setupLaneReordering:function(){this.$roadmapContent.sortable({axis:"y",cursor:"move",handle:".roadmap-lane-title",opacity:.3,placeholder:"roadmap-lane lane-sorting-placeholder",helper:function(a,b){return g(b).clone().addClass("lane-sorting-hepler")}})},_onSortStart:function(a,b){this.hideDialog();this._timelineColumnView.$el.hide();b.placeholder.css({height:Math.min(b.helper.height(),100),width:b.helper.width()}).html(Confluence.Templates.Roadmap.lane(Roadmap.TRANSPARENT_LANE));
b.helper.find(".roadmap-lane-content").css({width:b.helper.width()-(b.helper.find(".roadmap-lane-title").outerWidth()+b.helper.find(".roadmap-separate-content").outerWidth())})},_onSortStop:function(a,b){this._timelineColumnView.$el.show();var c=b.item.attr("cid");a=e.find(this._laneViews,function(f){return f.cid===c}).model;var d=this.model.get("lanes");d.remove(a);d.models.splice(b.item.index(),0,a);d._byId[a.cid]=a},_onRemove:function(){this.$roadmapTimeline.remove()},_isMonthYearChanged:function(){var a=
function(c,d){return c.getMonth()!==d.getMonth()||c.getYear()!==d.getYear()?!0:!1},b=this.model.get("timeline");return a(b._previousAttributes.startDate,b.attributes.startDate)||a(b._previousAttributes.endDate,b.attributes.endDate)},_isWeekChanged:function(){var a=function(f,h){f=moment(f);h=moment(h);return f.get("year")===h.get("year")&&f.isoWeek()===h.isoWeek()},b=this.model.get("timeline"),c=b._previousAttributes.endDate,d=b.attributes.endDate;return!(a(b._previousAttributes.startDate,b.attributes.startDate)&&
a(c,d))},_isTimelineChanged:function(){var a=this.model.get("timeline"),b=a.changed.displayOption;b?this.model.updateDurationUnit(a.get("displayOption")):b=a.get("displayOption")===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH?this._isMonthYearChanged():this._isWeekChanged();return b},resize:function(){this._updateLaneWidth();this._updateTimelineColumnHeight();this.$roadmapContent.css({top:this.$roadmapTimeline.find(".roadmap-column-title:first").innerHeight()})}})})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-analytics-resources', location = 'analytics/roadmap-analytics.js' */
Confluence.Roadmap=Confluence.Roadmap||{};
Confluence.Roadmap.Analytics=function(g,e){function b(a,c){AJS.trigger("analytics",{name:a,data:c})}function d(a){var c=0;e.each(a.lanes,function(f){c+=f.bars.length});return{lanes:a.lanes.length,bars:c,markers:a.markers.length,months:Confluence.Roadmap.DateUtilities.getNumberOfMonths(a.timeline.startDate,a.timeline.endDate)+1}}return{insertRoadmap:function(){b("confluence.roadmap.insert")},createRoadmap:function(a){a=d(a);b("confluence.roadmap.create",a)},editRoadmap:function(a){a=d(a);b("confluence.roadmap.edit",
a)},openBarDialogInEdit:function(){b("confluence.roadmap.editmode.open_bar_dialog")},addDescription:function(){b("confluence.roadmap.editmode.add_description")},addPageLinkEditMode:function(a){b("confluence.roadmap.editmode.add_page_link",a)},addPageLinkViewMode:function(a){b("confluence.roadmap.viewmode.add_page_link",a)},openBarDialogInView:function(){b("confluence.roadmap.viewmode.open_bar_dialog")},clickPageLink:function(){b("confluence.roadmap.viewmode.click_page_link")}}}(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-resources', location = 'lib/jquery.viewport.js' */
(function(a){a.belowthefold=function(b,c){return a(window).height()+a(window).scrollTop()<=a(b).offset().top-c.threshold};a.abovethetop=function(b,c){return a(window).scrollTop()>=a(b).offset().top+a(b).height()-c.threshold};a.rightofscreen=function(b,c){return a(window).width()+a(window).scrollLeft()<=a(b).offset().left-c.threshold||0>a(b).offset().left};a.leftofscreen=function(b,c){return a(window).scrollLeft()>=a(b).offset().left+a(b).width()-c.threshold};a.inviewport=function(b,c){return!a.rightofscreen(b,
c)&&!a.leftofscreen(b,c)&&!a.belowthefold(b,c)&&!a.abovethetop(b,c)};a.extend(a.expr[":"],{"below-the-fold":function(b,c,d){return a.belowthefold(b,{threshold:0})},"above-the-top":function(b,c,d){return a.abovethetop(b,{threshold:0})},"left-of-screen":function(b,c,d){return a.leftofscreen(b,{threshold:0})},"right-of-screen":function(b,c,d){return a.rightofscreen(b,{threshold:0})},"in-viewport":function(b,c,d){return a.inviewport(b,{threshold:0})}})})(jQuery);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-resources', location = 'lib/jquery.ellipsis.min.js' */
/*! jQuery ellipsis - v1.1.1 - 2014-02-23
* https://github.com/STAR-ZERO/jquery-ellipsis
* Copyright (c) 2014 Kenji Abe; Licensed MIT */
!function(a){a.fn.ellipsis=function(b){var c={row:1,onlyFullWords:!1,"char":"...",callback:function(){},position:"tail"};return b=a.extend(c,b),this.each(function(){var c=a(this),d=c.text(),e=d,f=e.length,g=c.height();c.text("a");var h=parseFloat(c.css("lineHeight"),10),i=c.height(),j=h>i?h-i:0,k=j*(b.row-1)+i*b.row;if(k>=g)return c.text(d),void b.callback.call(this);var l=1,m=0,n=d.length;if("tail"===b.position){for(;n>l;)m=Math.ceil((l+n)/2),c.text(d.slice(0,m)+b["char"]),c.height()<=k?l=m:n=m-1;d=d.slice(0,l),b.onlyFullWords&&(d=d.replace(/[\u00AD\w\uac00-\ud7af]+$/,"")),d+=b["char"]}else if("middle"===b.position){for(var o=0;n>l;)m=Math.ceil((l+n)/2),o=Math.max(f-m,0),c.text(e.slice(0,Math.floor((f-o)/2))+b["char"]+e.slice(Math.floor((f+o)/2),f)),c.height()<=k?l=m:n=m-1;o=Math.max(f-l,0);var p=e.slice(0,Math.floor((f-o)/2)),q=e.slice(Math.floor((f+o)/2),f);b.onlyFullWords&&(p=p.replace(/[\u00AD\w\uac00-\ud7af]+$/,"")),d=p+b["char"]+q}c.text(d),b.callback.call(this)}),this}}(jQuery);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-resources', location = 'editor/md5.js' */
var hexcase=0,b64pad="";function hex_md5(d){return rstr2hex(rstr_md5(str2rstr_utf8(d)))}function b64_md5(d){return rstr2b64(rstr_md5(str2rstr_utf8(d)))}function any_md5(d,a){return rstr2any(rstr_md5(str2rstr_utf8(d)),a)}function hex_hmac_md5(d,a){return rstr2hex(rstr_hmac_md5(str2rstr_utf8(d),str2rstr_utf8(a)))}function b64_hmac_md5(d,a){return rstr2b64(rstr_hmac_md5(str2rstr_utf8(d),str2rstr_utf8(a)))}
function any_hmac_md5(d,a,b){return rstr2any(rstr_hmac_md5(str2rstr_utf8(d),str2rstr_utf8(a)),b)}function md5_vm_test(){return"900150983cd24fb0d6963f7d28e17f72"==hex_md5("abc").toLowerCase()}function rstr_md5(d){return binl2rstr(binl_md5(rstr2binl(d),8*d.length))}
function rstr_hmac_md5(d,a){var b=rstr2binl(d);16<b.length&&(b=binl_md5(b,8*d.length));var c=Array(16);d=Array(16);for(var e=0;16>e;e++)c[e]=b[e]^909522486,d[e]=b[e]^1549556828;a=binl_md5(c.concat(rstr2binl(a)),512+8*a.length);return binl2rstr(binl_md5(d.concat(a),640))}function rstr2hex(d){try{hexcase}catch(f){hexcase=0}for(var a=hexcase?"0123456789ABCDEF":"0123456789abcdef",b="",c,e=0;e<d.length;e++)c=d.charCodeAt(e),b+=a.charAt(c>>>4&15)+a.charAt(c&15);return b}
function rstr2b64(d){try{b64pad}catch(g){b64pad=""}for(var a="",b=d.length,c=0;c<b;c+=3)for(var e=d.charCodeAt(c)<<16|(c+1<b?d.charCodeAt(c+1)<<8:0)|(c+2<b?d.charCodeAt(c+2):0),f=0;4>f;f++)a=8*c+6*f>8*d.length?a+b64pad:a+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e>>>6*(3-f)&63);return a}
function rstr2any(d,a){var b=a.length,c,e,f,g=Array(Math.ceil(d.length/2));for(c=0;c<g.length;c++)g[c]=d.charCodeAt(2*c)<<8|d.charCodeAt(2*c+1);var l=Math.ceil(8*d.length/(Math.log(a.length)/Math.log(2)));d=Array(l);for(e=0;e<l;e++){var h=[];for(c=f=0;c<g.length;c++){f=(f<<16)+g[c];var k=Math.floor(f/b);f-=k*b;if(0<h.length||0<k)h[h.length]=k}d[e]=f;g=h}b="";for(c=d.length-1;0<=c;c--)b+=a.charAt(d[c]);return b}
function str2rstr_utf8(d){for(var a="",b=-1,c,e;++b<d.length;)c=d.charCodeAt(b),e=b+1<d.length?d.charCodeAt(b+1):0,55296<=c&&56319>=c&&56320<=e&&57343>=e&&(c=65536+((c&1023)<<10)+(e&1023),b++),127>=c?a+=String.fromCharCode(c):2047>=c?a+=String.fromCharCode(192|c>>>6&31,128|c&63):65535>=c?a+=String.fromCharCode(224|c>>>12&15,128|c>>>6&63,128|c&63):2097151>=c&&(a+=String.fromCharCode(240|c>>>18&7,128|c>>>12&63,128|c>>>6&63,128|c&63));return a}
function str2rstr_utf16le(d){for(var a="",b=0;b<d.length;b++)a+=String.fromCharCode(d.charCodeAt(b)&255,d.charCodeAt(b)>>>8&255);return a}function str2rstr_utf16be(d){for(var a="",b=0;b<d.length;b++)a+=String.fromCharCode(d.charCodeAt(b)>>>8&255,d.charCodeAt(b)&255);return a}function rstr2binl(d){for(var a=Array(d.length>>2),b=0;b<a.length;b++)a[b]=0;for(b=0;b<8*d.length;b+=8)a[b>>5]|=(d.charCodeAt(b/8)&255)<<b%32;return a}
function binl2rstr(d){for(var a="",b=0;b<32*d.length;b+=8)a+=String.fromCharCode(d[b>>5]>>>b%32&255);return a}
function binl_md5(d,a){d[a>>5]|=128<<a%32;d[(a+64>>>9<<4)+14]=a;a=1732584193;for(var b=-271733879,c=-1732584194,e=271733878,f=0;f<d.length;f+=16){var g=a,l=b,h=c,k=e;a=md5_ff(a,b,c,e,d[f+0],7,-680876936);e=md5_ff(e,a,b,c,d[f+1],12,-389564586);c=md5_ff(c,e,a,b,d[f+2],17,606105819);b=md5_ff(b,c,e,a,d[f+3],22,-1044525330);a=md5_ff(a,b,c,e,d[f+4],7,-176418897);e=md5_ff(e,a,b,c,d[f+5],12,1200080426);c=md5_ff(c,e,a,b,d[f+6],17,-1473231341);b=md5_ff(b,c,e,a,d[f+7],22,-45705983);a=md5_ff(a,b,c,e,d[f+8],7,
1770035416);e=md5_ff(e,a,b,c,d[f+9],12,-1958414417);c=md5_ff(c,e,a,b,d[f+10],17,-42063);b=md5_ff(b,c,e,a,d[f+11],22,-1990404162);a=md5_ff(a,b,c,e,d[f+12],7,1804603682);e=md5_ff(e,a,b,c,d[f+13],12,-40341101);c=md5_ff(c,e,a,b,d[f+14],17,-1502002290);b=md5_ff(b,c,e,a,d[f+15],22,1236535329);a=md5_gg(a,b,c,e,d[f+1],5,-165796510);e=md5_gg(e,a,b,c,d[f+6],9,-1069501632);c=md5_gg(c,e,a,b,d[f+11],14,643717713);b=md5_gg(b,c,e,a,d[f+0],20,-373897302);a=md5_gg(a,b,c,e,d[f+5],5,-701558691);e=md5_gg(e,a,b,c,d[f+
10],9,38016083);c=md5_gg(c,e,a,b,d[f+15],14,-660478335);b=md5_gg(b,c,e,a,d[f+4],20,-405537848);a=md5_gg(a,b,c,e,d[f+9],5,568446438);e=md5_gg(e,a,b,c,d[f+14],9,-1019803690);c=md5_gg(c,e,a,b,d[f+3],14,-187363961);b=md5_gg(b,c,e,a,d[f+8],20,1163531501);a=md5_gg(a,b,c,e,d[f+13],5,-1444681467);e=md5_gg(e,a,b,c,d[f+2],9,-51403784);c=md5_gg(c,e,a,b,d[f+7],14,1735328473);b=md5_gg(b,c,e,a,d[f+12],20,-1926607734);a=md5_hh(a,b,c,e,d[f+5],4,-378558);e=md5_hh(e,a,b,c,d[f+8],11,-2022574463);c=md5_hh(c,e,a,b,d[f+
11],16,1839030562);b=md5_hh(b,c,e,a,d[f+14],23,-35309556);a=md5_hh(a,b,c,e,d[f+1],4,-1530992060);e=md5_hh(e,a,b,c,d[f+4],11,1272893353);c=md5_hh(c,e,a,b,d[f+7],16,-155497632);b=md5_hh(b,c,e,a,d[f+10],23,-1094730640);a=md5_hh(a,b,c,e,d[f+13],4,681279174);e=md5_hh(e,a,b,c,d[f+0],11,-358537222);c=md5_hh(c,e,a,b,d[f+3],16,-722521979);b=md5_hh(b,c,e,a,d[f+6],23,76029189);a=md5_hh(a,b,c,e,d[f+9],4,-640364487);e=md5_hh(e,a,b,c,d[f+12],11,-421815835);c=md5_hh(c,e,a,b,d[f+15],16,530742520);b=md5_hh(b,c,e,
a,d[f+2],23,-995338651);a=md5_ii(a,b,c,e,d[f+0],6,-198630844);e=md5_ii(e,a,b,c,d[f+7],10,1126891415);c=md5_ii(c,e,a,b,d[f+14],15,-1416354905);b=md5_ii(b,c,e,a,d[f+5],21,-57434055);a=md5_ii(a,b,c,e,d[f+12],6,1700485571);e=md5_ii(e,a,b,c,d[f+3],10,-1894986606);c=md5_ii(c,e,a,b,d[f+10],15,-1051523);b=md5_ii(b,c,e,a,d[f+1],21,-2054922799);a=md5_ii(a,b,c,e,d[f+8],6,1873313359);e=md5_ii(e,a,b,c,d[f+15],10,-30611744);c=md5_ii(c,e,a,b,d[f+6],15,-1560198380);b=md5_ii(b,c,e,a,d[f+13],21,1309151649);a=md5_ii(a,
b,c,e,d[f+4],6,-145523070);e=md5_ii(e,a,b,c,d[f+11],10,-1120210379);c=md5_ii(c,e,a,b,d[f+2],15,718787259);b=md5_ii(b,c,e,a,d[f+9],21,-343485551);a=safe_add(a,g);b=safe_add(b,l);c=safe_add(c,h);e=safe_add(e,k)}return[a,b,c,e]}function md5_cmn(d,a,b,c,e,f){return safe_add(bit_rol(safe_add(safe_add(a,d),safe_add(c,f)),e),b)}function md5_ff(d,a,b,c,e,f,g){return md5_cmn(a&b|~a&c,d,a,e,f,g)}function md5_gg(d,a,b,c,e,f,g){return md5_cmn(a&c|b&~c,d,a,e,f,g)}
function md5_hh(d,a,b,c,e,f,g){return md5_cmn(a^b^c,d,a,e,f,g)}function md5_ii(d,a,b,c,e,f,g){return md5_cmn(b^(a|~c),d,a,e,f,g)}function safe_add(d,a){var b=(d&65535)+(a&65535);return(d>>16)+(a>>16)+(b>>16)<<16|b&65535}function bit_rol(d,a){return d<<a|d>>>32-a};
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-resources', location = 'editor/roadmap-editor.js' */
AJS.toInit(function(){function u(){setTimeout(function(){if(d&&d.is(":visible")){var f=d.height(),p=d.find(".aui-dialog2-header").outerHeight(),q=d.find(".aui-dialog2-footer").outerHeight(),m=d.find("#roadmap-editor-toolbar").outerHeight();d.find(".roadmap-editor-popup").css("height",f-p-q-m)}},0)}var r,d,v,g,t;AJS.MacroBrowser.setMacroJsOverride("roadmap",{opener:function(f){var p=function(h,b,e,a){var c=e?e.split("~~~~~"):[];b=b?b.split("~~~~~"):[];_.isEmpty(c)?a&&a():$.ajax({type:"POST",contentType:"application/json",
url:AJS.contextPath()+"/rest/roadmap/1.0/extractPageLinks",data:JSON.stringify({wikiLinks:_.object(c,b),roadmapSpace:AJS.Meta.get("space-key")}),success:function(k){_.each(h.lanes,function(n){_.chain(n.bars).filter(function(l){return _.contains(c,l.id)}).each(function(l){k[l.id]&&(l.pageLink=k[l.id])})});a&&a()},error:function(k){AJS.log(k);a&&a()}})},q=function(h){var b=[],e=[];h.lanes.forEach(function(a){a.bars.forEach(function(c){if(!_.isEmpty(c.pageLink)){var k=c.pageLink.wikiLink.replace(/[\][]/g,
"");b.push(_.escape(k));e.push(c.id)}})});return{pageLinks:b.join("~~~~~"),mapLinks:e.join("~~~~~")}};if(f.params&&"true"!==f.params.timeline){var m=$(Confluence.Templates.Roadmap.deprecationDialog({id:"roadmap-deprecation-dialog"}));AJS.dialog2(m).on("hide",function(){$("#roadmap-deprecation-dialog").remove()}).on("show",function(){$("#dialog-close-button",m).click(function(h){h.preventDefault();AJS.dialog2("#roadmap-deprecation-dialog").hide()})}).show();return!1}var x=function(){"undefined"==typeof r&&
(r=aui.dialog.dialog2({id:"confluence-roadmap-dialog",size:"xlarge",titleText:"Insert Roadmap Planner",content:Confluence.Templates.Roadmap.roadmapPopupPanel({roadmapPopupPanelId:"roadmap-popup-panel"}),footerActionContent:Confluence.Templates.Roadmap.footerActionContent(),modal:!0}),d=$(r).appendTo($("body")),d.find("#roadmapInsertBtn").on("click",function(a){g.removeDialog();a=g.model.toMacroData();var c=encodeURIComponent(JSON.stringify(a)),k=hex_md5(c),n=q(a);c={timeline:"true",
source:c,hash:k,title:encodeURIComponent(a.title),pagelinks:n.pageLinks,maplinks:n.mapLinks};tinymce.confluence.macrobrowser.macroBrowserComplete({name:"roadmap",params:c});g.remove();h.hide();t?Confluence.Roadmap.Analytics.createRoadmap(a):Confluence.Roadmap.Analytics.editRoadmap(a)}),d.find("#roadmapCancelBtn").on("click",function(a){g.removeDialog();g.remove();h.hide()}),v=d.find(".roadmap-editor-popup"));var h=AJS.dialog2("#confluence-roadmap-dialog").show();var b=$("#roadmap-popup-panel"),e=
b.find(".roadmap-view");e.length||(e=$('\x3cdiv class\x3d"roadmap-view"/\x3e'),b.append(e));b=new Roadmap.Roadmap(w,{parse:!0});g=new Roadmap.RoadmapEditorView({model:b,dialogId:"confluence-roadmap-dialog",el:e,roadmapEditorPopup:v});g.render();u()};if(f.params&&f.params.source){t=!1;var w=JSON.parse(decodeURIComponent(f.params.source));p(w,f.params.pagelinks,f.params.maplinks,x)}else t=!0,Confluence.Roadmap.Analytics.insertRoadmap(),x()}});$(window).resize(function(){u();g&&g.resize()})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-resources', location = 'editor/roadmap-editor-config.js' */
(function(){window.Roadmap=window.Roadmap||{};Roadmap.COLORS=[{lane:"#f6c342",bar:"#fadb8e",text:"#594300"},{lane:"#3b7fc4",bar:"#6c9fd3",text:"#ffffff"},{lane:"#d04437",bar:"#dc7369",text:"#ffffff"},{lane:"#8eb021",bar:"#aac459",text:"#ffffff"},{lane:"#ea632b",bar:"#ef8a60",text:"#ffffff"},{lane:"#654982",bar:"#8c77a1",text:"#ffffff"},{lane:"#f15c75",bar:"#f58598",text:"#ffffff"},{lane:"#815b3a",bar:"#a1846b",text:"#ffffff"}];Roadmap.TIMELINE_DISPLAY_OPTION={MONTH:"MONTH",WEEK:"WEEK"};Roadmap.SHORT_DATE_FORMAT=
"YYYY-MM-DD";Roadmap.TWO_YY_SHORT_DATE_FORMAT="YY-MM-DD";Roadmap.DATE_FORMAT="YYYY-MM-DD HH:mm:ss";Roadmap.WEEK_FORMAT="DD-MMM";Roadmap.MONTH_FORMAT="MMM";Roadmap.TIMELINE_YEARS_LIMIT=5;Roadmap.LANE_TITLE_WIDTH=45;Roadmap.MARKER_HEIGHT_PADDING=10;Roadmap.MARKER_TITLE_LINE=2;Roadmap.LANE_PADDING=11;Roadmap.BAR_PADDING=8;Roadmap.BAR_MARGIN=1;Roadmap.BAR_BORDER=1;Roadmap.MONTH_WIDTH=101;Roadmap.WEEK_WIDTH=101;Roadmap.EXTRA_SPACE_AROUND=2*Roadmap.BAR_PADDING+2*Roadmap.BAR_BORDER;Roadmap.MONTH_BAR_MIN_WIDTH=
Roadmap.MONTH_WIDTH/4-Roadmap.EXTRA_SPACE_AROUND;Roadmap.WEEK_BAR_MIN_WIDTH=Roadmap.WEEK_WIDTH-Roadmap.EXTRA_SPACE_AROUND;Roadmap.barMinWidth=Roadmap.MONTH_BAR_MIN_WIDTH;Roadmap.TRANSPARENT_LANE={title:"",color:{lane:"#ffffff",bar:"#ffffff",text:"#ffffff"}};Roadmap.DragDrop={};Roadmap.BarDialog={MAX_LENGTH_TITLE:100,MAX_LENGTH_DESCRIPTION:150};Roadmap.getDefaultRoadmapData=function(){var a=moment(new Date).hours(0).minutes(0).seconds(0).milliseconds(0).toDate(),b=moment(a).add(11,"months").toDate();
return{title:"Roadmap Planner",timeline:{startDate:new Date(a),endDate:b,displayOption:Roadmap.TIMELINE_DISPLAY_OPTION.MONTH},lanes:[{title:"Lane 1",color:Roadmap.COLORS[0],bars:[{title:"Bar 1",description:"This is the first bar.",startDate:new Date(a.setDate(1)),duration:2,rowIndex:0},{title:"Bar 2",description:"This is the second bar.",
startDate:new Date(a),duration:1,rowIndex:1}]},{title:"Lane 2",color:Roadmap.COLORS[1],bars:[{title:"Bar 3",description:"This is the third bar.",startDate:a,duration:2.5,rowIndex:0}]}],markers:[{title:"Marker 1",markerDate:moment(a).date(15).toDate()}]}}})();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.macros.advanced:include_macro', location = 'com/atlassian/confluence/plugins/macros/advanced/js/include-macro.js' */
AJS.bind("init.rte",function(){var c=AJS.Meta.get("context-path"),d=AJS.Meta.get("content-id");AJS.Confluence.PropertyPanel.Macro.registerButtonHandler("goto-page",function(a,b){a=AJS.$(b).attr("data-macro-default-parameter");a=c+"/plugins/servlet/confluence/include-page-macro/goto?location\x3d"+encodeURIComponent(a)+"\x26contentId\x3d"+d;(b=window.open(a,AJS.$.browser&&AJS.$.browser.msie?"_blank":"confluence-goto-link-include-macro-"+b.id))&&b.focus()})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.macros.multimedia:macro-browser-smart-fields', location = 'javascript/macro-fields.js' */
(function(a){AJS.MacroBrowser.activateSmartFieldsAttachmentsOnPage("multimedia","swf avi mov mp4 mpeg mpg wmv wma mp3 ram rm".split(" "))})(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-page-layout:pagelayout-frontend', location = 'js/pagelayout/page-layout.soy' */
// This file was automatically generated from page-layout.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.PageLayout.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.PageLayout == 'undefined') { Confluence.Templates.PageLayout = {}; }


Confluence.Templates.PageLayout.contentLayout = function(opt_data, opt_ignored) {
  return '<div class="contentLayout"></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.PageLayout.contentLayout.soyTemplateName = 'Confluence.Templates.PageLayout.contentLayout';
}


Confluence.Templates.PageLayout.cellLayout = function(opt_data, opt_ignored) {
  return '<div class="cell"><div class="innerCell"></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.PageLayout.cellLayout.soyTemplateName = 'Confluence.Templates.PageLayout.cellLayout';
}


Confluence.Templates.PageLayout.smallCellLayout = function(opt_data, opt_ignored) {
  return '<div class="cell aside"><div class="innerCell"></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.PageLayout.smallCellLayout.soyTemplateName = 'Confluence.Templates.PageLayout.smallCellLayout';
}


Confluence.Templates.PageLayout.headerLayout = function(opt_data, opt_ignored) {
  return '<div class="header"><div class="innerCell"></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.PageLayout.headerLayout.soyTemplateName = 'Confluence.Templates.PageLayout.headerLayout';
}


Confluence.Templates.PageLayout.footerLayout = function(opt_data, opt_ignored) {
  return '<div class="footer"><div class="innerCell"></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.PageLayout.footerLayout.soyTemplateName = 'Confluence.Templates.PageLayout.footerLayout';
}


Confluence.Templates.PageLayout.columnLayout = function(opt_data, opt_ignored) {
  return '<div class="columnLayout"></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.PageLayout.columnLayout.soyTemplateName = 'Confluence.Templates.PageLayout.columnLayout';
}


Confluence.Templates.PageLayout.emptyLayout2 = function(opt_data, opt_ignored) {
  return '<div class="contentLayout2">' + Confluence.Templates.PageLayout.emptySection2(null) + '</div>';
};
if (goog.DEBUG) {
  Confluence.Templates.PageLayout.emptyLayout2.soyTemplateName = 'Confluence.Templates.PageLayout.emptyLayout2';
}


Confluence.Templates.PageLayout.emptySection2 = function(opt_data, opt_ignored) {
  return '<div class="columnLayout single" data-layout="single">' + Confluence.Templates.PageLayout.cell2({type: 'normal'}) + '</div>';
};
if (goog.DEBUG) {
  Confluence.Templates.PageLayout.emptySection2.soyTemplateName = 'Confluence.Templates.PageLayout.emptySection2';
}


Confluence.Templates.PageLayout.newSection2 = function(opt_data, opt_ignored) {
  return '<div class="columnLayout single" data-layout="single">' + Confluence.Templates.PageLayout.cell2({type: 'normal'}) + '</div>';
};
if (goog.DEBUG) {
  Confluence.Templates.PageLayout.newSection2.soyTemplateName = 'Confluence.Templates.PageLayout.newSection2';
}


Confluence.Templates.PageLayout.cell2 = function(opt_data, opt_ignored) {
  return '<div class="cell ' + soy.$$escapeHtml(opt_data.type) + '" data-type="' + soy.$$escapeHtml(opt_data.type) + '"><div class="innerCell">' + ((opt_data.content) ? soy.$$filterNoAutoescape(opt_data.content) : '') + '</div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.PageLayout.cell2.soyTemplateName = 'Confluence.Templates.PageLayout.cell2';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-page-layout:pagelayout-frontend', location = 'js/pagelayout/tinymce-page-layout.js' */
define("confluence-page-layout/pagelayout/tinymce-page-layout",["jquery","ajs","tinymce"],function(d,e,f){function j(a){a=d(a.getBody());if(a.children(".contentLayout").length)return!1;a.children(".contentLayout2");return!0}var i=function(a){var e=d("#pagelayout-menu"),h=d(".icon-check",e);i=function(a){var c=h.not(".hidden"),a=h.siblings("."+a.name).siblings();c.addClass("hidden");a.removeClass("hidden")};i(a)};return{init:function(a){function l(){j(a)||f.plugins.PageLayoutPlugin.PageLayout.needsContentEditableBody(c.getLayout())||
f.webkit||e.Rte.editorFocus(a)}function h(){f.isGecko&&setTimeout(function(){a.focus();a.dom.getRoot().focus()},1)}function k(g){var b=d("#pagelayout-menu").parent(),e=d("#page-layout-2-group");if(!g||!g.selection)j(a)?(b.addClass("hidden"),e.removeClass("hidden"),c=new f.plugins.PageLayoutPlugin.PageLayout2(a),f.plugins.PageLayoutPlugin.PageLayout2.needsContentEditableBody()&&d(a.getBody()).attr("contenteditable","true")):(b.removeClass("hidden"),e.addClass("hidden"),c=new f.plugins.PageLayoutPlugin.PageLayout(a),
f.plugins.PageLayoutPlugin.PageLayout.needsContentEditableBody(c.getLayout())?c.body.attr("contenteditable","true"):h(),i(c.getLayout()))}var c;this.ed=a;"comment"!==e.Meta.get("content-type")&&(a.on("init",function(){a.undoManager.clear();a.undoManager.add();k();e.bind("editor.remote.change editor.local.change",function(){a.undoManager.ignore(function(){c.setup()})});e.bind("rte-ready",function(){var c=d('[contenteditable="true"]',a.getBody()),b=!1!==e.Meta.get("editor-auto-focus");c.attr("contenteditable",
"false");c.attr("contenteditable","true");b&&e.Rte.editorFocus(a)});a.on("SetContent",l);if(j(a))a.on("Undo",function(){f.plugins.PageLayoutPlugin.PageLayout2.needsContentEditableBody()&&c.body.attr("contenteditable","true");h()})}),d("#pagelayout-menu").delegate("li.dropdown-item a","click",function(){a.execCommand("mcePageLayout",!1,f.plugins.PageLayoutPlugin.PageLayout.getLayoutOptions(this))}),a.addCommand("mcePageLayoutInitialize",function(){a.undoManager.add();c.createInitialLayoutIfNone()}),
a.addCommand("mcePageLayout",function(g,b){a.undoManager.add();c.setLayout(b);i(c.getLayout())}),a.addCommand("mcePageLayoutAddSection",function(g,b){a.undoManager.add();c.addSection&&c.addSection(b&&b.section)}),a.addCommand("mcePageLayoutChangeSection",function(g,b){a.undoManager.add();c.changeSection&&c.changeSection(b&&b.layout,b&&b.section)}),a.addCommand("mcePageLayoutRemoveSection",function(g,b){a.undoManager.add();c.removeSection&&c.removeSection(b&&b.section)}),a.addCommand("mcePageLayoutMoveSectionUp",
function(g,b){a.undoManager.add();c.moveSectionUp&&c.moveSectionUp(b&&b.section)}),a.addCommand("mcePageLayoutMoveSectionDown",function(g,b){a.undoManager.add();c.moveSectionDown&&c.moveSectionDown(b&&b.section)}),a.on("SetContent",k),a.on("click",function(c){var b=d(c.target);b.is("div.cell")&&b.children(".innerCell").focus();if(f.isWebKit&&(c.target===a.getBody()||c.target===a.getBody().parentNode))b=b.find(".innerCell"),b.length&&(a.execCommand("selectAll"),c=c.target!==a.getBody(),a.selection.collapse(c))}),
a.on("keyup",function(c){var b=c.keyCode;if(8!==b&&46!==b)return!0;b=a.selection.getRng(!0).startContainer;if(d(b).closest(".contentLayout,.contentLayout2",a.getBody()).length&&(b=d(b).closest(".innerCell"))&&b.length&&a.dom.isEmpty(b.clone()[0]))b.html('<p><br data-mce-bogus="1"></p>'),c.preventDefault(),a.selection.select(b[0].firstElementChild.firstChild,!0),a.selection.collapse(!0)}))},execCommand:function(a){if("selectAll"===a){var a=this.ed,e=a.getBody(),d,f;if("true"==a.dom.getAttrib(e,"contenteditable"))return!1;
d=a.dom.select(".innerCell",e);e=d[0];d=d[d.length-1];f=a.dom.createRng();f.setStart(e,0);f.setEnd(d,d.childNodes.length);a.selection.setRng(f);return!0}return!1},disableContent:function(){this.ed.dom.setAttribs(this.ed.dom.select("div.innerCell"),{contenteditable:!1});this.ed.dom.setStyle(this.ed.dom.select(".wiki-content .contentLayout2"),"user-select","auto")},getInfo:function(){return{longname:"Page Layout Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com",
version:"1.0"}}}});require("confluence/module-exporter").safeRequire("confluence-page-layout/pagelayout/tinymce-page-layout",function(d){var e=require("tinymce");e.create("tinymce.plugins.PageLayoutPlugin",d);e.PluginManager.add("pagelayoutplugin",e.plugins.PageLayoutPlugin)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-page-layout:pagelayout-frontend', location = 'js/pagelayout/page-layout.js' */
define("confluence-page-layout/pagelayout/page-layout",["jquery","confluence/templates","ajs"],function(c,k,r){var h=function(a){this.editor=a;this.body=c(a.getBody());this.setup()};h.DEFAULT_LAYOUT={name:"pagelayout-none",columns:0};h.prototype.setup=function(){var a=c(".contentLayout",this.body);a.length?(n(a),o(a,this.body,this.editor),this.editor.undoManager.add()):this.body.attr("contenteditable","true")};h.prototype.setLayout=function(a){var g=require("tinymce"),b;b=c(".contentLayout",this.body);
if(h.getLayoutOptions(b).name!==a.name){r.trigger("analyticsEvent",{name:"PageLayoutEvent.pageLayoutChanged",data:{name:a.name}});if(1===b.length)b=b.clone();else{var d=this.editor;b=this.body;var e=k.PageLayout.contentLayout(),d=d.dom.create("div");d.innerHTML=e;b=c(d).children().html(b.html())}n(b);var e=b,d=c(".columnLayout > .cell",e).length,i=a.name,j=a.columns,f;if(0===d){f=e.html();for(e.html(k.PageLayout.columnLayout());d!==j.length;)p(e),d++}i=i.substring(i.indexOf("-")+1);i=i.substring(0,
Math.max(0,i.indexOf("-"))||void 0);c(".columnLayout",e).attr("class","columnLayout "+i+"Columns");if(j)for(c(".columnLayout > .cell",e).each(function(a,b){void 0!==j[a]&&c(b).attr("class","cell "+j[a])});d!==j.length;)if(d<j.length)p(e),d++;else{var i=c(".columnLayout .cell:nth-child("+d+") .innerCell",e),s=c(".columnLayout > .cell:nth-child("+(d-1)+") .innerCell",e),t=l(i);s.append(t);i.parent().remove();d--}else{var m="";c(".columnLayout > .cell",e).each(function(){m+=l(c(".innerCell",this))});
c(".columnLayout",e).replaceWith(m)}f&&q(e).html(f);a.header?(f=b,c(".header",f).length||f.prepend(k.PageLayout.headerLayout())):(e=b,f=c(".header",e),e=q(e),d=l(c(".innerCell",f)),e.length?(e.prepend(d),f.remove()):f.replaceWith(d));a.footer?(f=b,c(".footer",f).length||f.append(k.PageLayout.footerLayout())):(e=b,f=c(".footer",e),e=c(".columnLayout > .cell:last-child .innerCell",e),d=l(c(".innerCell",f)),e.length?(e.append(d),f.remove()):f.replaceWith(d));h.needsContentEditableBody(a)?(b=b.contents().unwrap(),
this.body.attr("contenteditable","true")):(o(b,this.body,this.editor),b.attr("data-atlassian-layout",JSON.stringify(a)));this.body.empty().append(b);g.isIE&&this.editor.dom.setRoot();b=this.editor;a=b.selection;g=a.getRng(!0);f=c('[contenteditable="true"]',b.getBody());f.length?(b.focus(),f[0].focus(),b=f.children()[0],g.setStart(b,0),g.setEnd(b,0),a.setRng(g)):b.focus()}};h.prototype.getLayout=function(){var a=c(".contentLayout",this.body);return a.length&&a.attr("data-atlassian-layout")?JSON.parse(a.attr("data-atlassian-layout")):
h.DEFAULT_LAYOUT};h.getLayoutOptions=function(a){return(a=(a.jquery?a:c(a)).attr("data-atlassian-layout"))?JSON.parse(a):h.DEFAULT_LAYOUT};h.needsContentEditableBody=function(a){return!(a.header||a.footer||a.columns)};var l=function(a){a=a.jquery?a:c(a);if(a.length)for(var g=a[0].childNodes,b=0;b<g.length;b++){var d=g[b];if(!("P"===d.nodeName&&1===d.childNodes.length&&"BR"===d.firstChild.nodeName))return a.html()}return""},n=function(a){for(var g,b,a=c(".cell, .header, .footer",a),d=0,e=a.length;d<
e;d++)g=c(a[d]),b=g.html(),c(".innerCell",g).length||(g.removeAttr("contenteditable"),g.html('<div class="innerCell">'+b+"</div>"))},o=function(a,g,b){var d=require("tinymce");g.attr("contenteditable","false");c(".innerCell",a).each(function(){var a=c(this);a.attr("contenteditable","true");a.children().length||a.append("<p><br /></p>")});d.isIE&&g.delegate(".innerCell","focus.pageLayout",function(){b.dom.settings.root_element=this})},q=function(a){return c(".columnLayout > .cell:first-child .innerCell",
a)},p=function(a){return c(".columnLayout",a).append(k.PageLayout.cellLayout())};return h});require("confluence/module-exporter").exportModuleAsGlobal("confluence-page-layout/pagelayout/page-layout","tinymce.plugins.PageLayoutPlugin.PageLayout");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-page-layout:pagelayout-frontend', location = 'js/pagelayout/page-layout-2.js' */
define("confluence-page-layout/pagelayout/page-layout-2",["jquery","confluence/templates","ajs"],function(g,n,f){function p(a,b,d){var c=a.find(".cell"),e=c.length,f=g(),k=b.cells.length,i=[],l=[],h,j;a.attr("class","columnLayout");a.addClass(b.id);a.attr("data-layout",b.id);h=0;for(j=e;h<j;h++)l=c.eq(h).detach(),i.push(s(l.children(".innerCell")));h=0;for(j=k;h<j;h++)f=f.add(n.PageLayout.cell2({type:b.cells[h].type||""}));if(e<=k)l=i;else{l=i.slice(0,k);h=k;for(j=e;h<j;h++)l[k-1]+=i[h]}a.prepend(f);
h=0;for(j=k;h<j;h++)f.eq(h).find(".innerCell").html(l[h]);o(a,d)}var e=function(a){this.editor=a;this.body=g(a.getBody());this.setup()};e.prototype.setup=function(){var a=this.body.find(".contentLayout2");a.length?(o(a,this.body),this.body.find("> p").each(function(){""===this.id.trim()&&0===this.classList.length&&g(this).remove()}),this.body.find(".contentLayout2 .cell").filter(function(){return 1<g(this).find(".innerCell").length}).each(function(a,d){for(var c=g(d).find(".innerCell"),e=c[0],f=1;f<
c.length;f++){var i=g(c[f]);g(e).append(i.children());i.remove()}}),this.editor.undoManager.add()):this.body.attr("contenteditable","true")};e.prototype.addSection=function(a){var b=this,d=g(n.PageLayout.newSection2()),c=a||i(this.body,this.editor,!0);if(c.length){var r=e.Layouts.get(c.attr("data-layout"));this.editor.undoManager.ignore(function(){p(d,r,b.body,b.editor);c.after(d)});m(this.editor,d);f.trigger("editor.page-layout.add-section",{section:d})}else this.createInitialLayoutIfNone()};e.prototype.changeSection=
function(a,b){var d=this;e.isPageLayout()||this.createInitialLayoutIfNone();var c=b||i(this.body,this.editor,!1);if(c.length){var g=e.Layouts.get(c.attr("data-layout"));this.editor.undoManager.ignore(function(){p(c,a,d.body,d.editor)});m(this.editor,c);f.trigger("editor.page-layout.change-layout",{section:c,originalLayout:g,currentLayout:a})}};e.prototype.removeSection=function(a){if(e.isPageLayout()){var a=a||i(this.body,this.editor,!0),b=a.next(),d=a.prev(),c;b.length?(c=b,a.remove()):d.length?
(c=d,a.remove()):(a.closest(".contentLayout2").remove(),a=this.body.find(".contentLayout2").find(".columnLayout").first(),a.length?c=a:(a=this.editor,a.getBody().setAttribute("contenteditable",!0),a.setContent("<p></p>"),q(a),a=g("#rte-button-pagelayout-2"),a.hasClass("active")&&a.click()));c&&c.length&&m(this.editor,c);f.trigger("editor.page-layout.remove-section",{})}};e.prototype.moveSectionUp=function(a){if(e.isPageLayout()){var a=a||i(this.body,this.editor,!0),b=a.prev();b.length&&(a.detach(),
b.before(a),m(this.editor,a));f.trigger("editor.page-layout.move-section-up",{section:a})}};e.prototype.moveSectionDown=function(a){if(e.isPageLayout()){var a=a||i(this.body,this.editor,!0),b=a.next();b.length&&(a.detach(),b.after(a),m(this.editor,a));f.trigger("editor.page-layout.move-section-down",{section:a})}};e.prototype.createInitialLayoutIfNone=function(){if(!e.isPageLayout()){var a=g(n.PageLayout.emptyLayout2()),b=a.find(".innerCell"),d=this.body.children().detach();b.append(d);this.body.append(a);
o(a,this.body);q(this.editor)}};e.isPageLayout=function(){return!!g(f.Rte.getEditor().getBody()).find("div.contentLayout2").length};e.needsContentEditableBody=function(){return!e.isPageLayout()};e.Layouts=[{id:"single",icon:"1col",name:"Single column section",cells:[{type:"normal"}]},{id:"two-equal",icon:"2col",name:"Two column section",cells:[{type:"normal"},{type:"normal"}]},{id:"two-left-sidebar",icon:"2col-right",name:"Two column section with left side-bar",
cells:[{type:"aside"},{type:"normal"}]},{id:"two-right-sidebar",icon:"2col-left",name:"Two column section with right side-bar",cells:[{type:"normal"},{type:"aside"}]},{id:"three-equal",icon:"3col",name:"Three column section",cells:[{type:"normal"},{type:"normal"},{type:"normal"}]},{id:"three-with-sidebars",icon:"3col-center",name:"Three column section with side-bars",cells:[{type:"sidebars"},{type:"normal"},{type:"sidebars"}]}];e.Layouts.get=
function(a){for(var b=e.Layouts,d=0,c=b.length;d<c;d++)if(b[d].id===a)return b[d];return null};e.Layouts.findNearestSection=function(a){var b=f.Rte.getEditor(),d=g(b.getBody());return i(d,b,a)};var s=function(a){a=g(a);if(a.length)for(var b=a[0].childNodes,d=0;d<b.length;d++){var c=b[d];if(!("P"===c.nodeName&&1===c.childNodes.length&&"BR"===c.firstChild.nodeName))return a.html()}return""},i=function(a,b,d){b=g(b.selection.getRng(!0).startContainer).closest(".columnLayout");!b.length&&d&&(b=a.find(".columnLayout").last());
return b},o=function(a,b){b.attr("contenteditable","false");g(".innerCell",a).each(function(){var a=g(this);a.attr("contenteditable","true");a.children().length||a.append("<p><br /></p>")})},q=function(a){var b=a.selection,d=b.getRng(!0),c=g('[contenteditable="true"]',a.getBody());c.length?(a.focus(),c[0].focus(),a=c.children()[0],d.setStart(a,0),d.setEnd(a,0),b.setRng(d)):a.focus()},m=function(a,b){var d=a.selection,c=d.getRng(!0),e=b.find('[contenteditable="true"]').first(),g=e.children();g.length?
(a.focus(),e[0].focus(),e=g[0],c.setStart(e,0),c.setEnd(e,0),d.setRng(c),f.Rte.showElement(e)):a.focus()};return e});require("confluence/module-exporter").exportModuleAsGlobal("confluence-page-layout/pagelayout/page-layout-2","tinymce.plugins.PageLayoutPlugin.PageLayout2");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-page-layout:pagelayout-frontend', location = 'js/pagelayout/tinymce-page-layout-toolbar.js' */
define("confluence-page-layout/pagelayout/tinymce-page-layout-toolbar",["jquery","ajs","tinymce","document","confluence/legacy"],function(d,b,e,f,a){var i=function(a){var a=a||e.plugins.PageLayoutPlugin.PageLayout2.Layouts.findNearestSection(),c=a.attr("data-layout"),a=d("#rte-toolbar-row-pl2-toolbar").find(".layouts button"),c=a.find(".pl2-layout-"+c).closest(".aui-button");c.hasClass("active")||(a.filter(".active").removeClass("active"),c.addClass("active"))};return{initContextToolbars:function(p,
c){var j=d(f),m=d("#page-layout-2"),g=d("#rte-button-pagelayout-2");c.addCommand("mcePageLayoutsToolbar",function(){g.hasClass("active")?j.trigger("removeContextToolbarRow.Toolbar",{id:"pl2-toolbar",animate:!0}):(j.trigger("createContextToolbarRow.Toolbar",{id:"pl2-toolbar",buttons:a.Editor.PageLayoutToolbar.Buttons,topToolbar:!0,animate:!0}),i(),c.execCommand("mcePageLayoutInitialize"));g.toggleClass("active")});g.click(function(a){a.preventDefault();m.hasClass("disabled")||c.execCommand("mcePageLayoutsToolbar",
!1,null)});c.on("NodeChange",function(a){a=d(a.element).closest(".columnLayout");i(a)});for(var k=e.plugins.PageLayoutPlugin.PageLayout2.Layouts,l=[],n=function(b){l.push(new a.Editor.Toolbar.Components.Button({text:b.name,iconClass:"aui-icon aui-icon-small aui-iconfont-layout-"+b.icon+"-large",click:function(){c.execCommand("mcePageLayoutChangeSection",!1,{layout:b})}}))},h=0,o=k.length;h<o;h++)n(k[h]);return{Buttons:[new a.Editor.Toolbar.Components.Group([new a.Editor.Toolbar.Components.Button({triggerText:"Add section",
id:"add-layout-section",tooltip:"Add a new section below",iconClass:"aui-icon aui-icon-small aui-iconfont-add",click:function(){c.execCommand("mcePageLayoutAddSection")}}),new a.Editor.Toolbar.Components.Button({triggerText:"Remove section",id:"remove-layout-section",tooltip:"Remove the current section",iconClass:"aui-icon aui-icon-small aui-iconfont-delete",click:function(){c.execCommand("mcePageLayoutRemoveSection")}})]),
new a.Editor.Toolbar.Components.Group([new a.Editor.Toolbar.Components.Button({triggerText:"Move up",id:"move-up-layout-section",tooltip:"Move section up",iconClass:"aui-icon aui-icon-small aui-iconfont-up",click:function(){c.execCommand("mcePageLayoutMoveSectionUp")}}),new a.Editor.Toolbar.Components.Button({triggerText:"Move down",id:"move-down-layout-section",tooltip:"Move section down",
iconClass:"aui-icon aui-icon-small aui-iconfont-down",click:function(){c.execCommand("mcePageLayoutMoveSectionDown")}})]),new a.Editor.Toolbar.Components.Group(l,{id:"pagelayout2-toolbar",text:"Apply layout",groupClass:"layouts"}),new a.Editor.Toolbar.Components.Group([new a.Editor.Toolbar.Components.Button({text:"Close toolbar",iconClass:"aui-icon aui-icon-small aui-iconfont-close-dialog",click:function(){c.execCommand("mcePageLayoutsToolbar",!1,
null)}})],{groupClass:"close"})],Events:[]}}}});require("confluence/module-exporter").safeRequire("confluence-page-layout/pagelayout/tinymce-page-layout-toolbar",function(d){var b=require("confluence/meta"),e=require("jquery"),f=require("document"),a=require("confluence/legacy");"comment"!==b.get("content-type")&&e(f).bind("initContextToolbars.Toolbar",function(b,e){a.Editor.PageLayoutToolbar=d.initContextToolbars(b,e)})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:space-page-picker-shim', location = 'js/space-page-picker-shim.js' */
define("confluence-inline-tasks/space-page-picker-shim",["confluence-ui-components/js/space-page-picker"],function(e){function f(a){var c={page:[],space:[]};if(!a)return c;a.split(",").forEach(function(b){b=b.split(":");c[b[0]].push(b[1])});return c}return{build:function(a){return e.build(a)},setValue:function(a,c){return e.setValue(a,c)},splitStringToMap:f,combineMapToString:function(a){var c=a.space;a=a.page;var b=[];c&&(b=b.concat(_.map(c.split(","),function(d){return"space:"+d})));a&&(b=b.concat(_.map(a.split(","),
function(d){return"page:"+d})));return b.join(",")},getValueAsMap:function(a){return f(a.val())}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:inline-tasks-macro-browser', location = 'js/macro-browser-overrides.js' */
define("confluence-inline-tasks/macro-browser-overrides",["jquery","ajs","confluence/templates","confluence-macro-browser/macro-browser","confluence-inline-tasks/space-page-picker-shim"],function(e,h,k,f,d){return{fields:{string:{spaceAndPage:function(a){var b=a.multiple?"autocomplete-multi-space-and-page":"autocomplete-space-and-page",g=e(k.MacroBrowser.macroParameter()),c=g.find("input[type\x3d'text']");c.addClass(b).attr("data-none-message","Not found");
a.required&&c.keyup(f.processRequiredParameters);c.auiSelect2(d.build({multiple:a.multiple,orgElement:c,inputSpaceId:"legacy-macro-param-spaces",inputSpaceCatId:"legacy-macro-param-space-cats",inputPageId:"legacy-macro-param-pages"}));return f.Field(g,c,{setValue:function(l){d.setValue(l,c)}})}}},beforeParamsSet:function(a){var b=d.combineMapToString({page:a.pages,space:a.spaces});b&&(a.spaceAndPage=b);delete a.pages;delete a.spaces;return a},beforeParamsRetrieved:function(a){var b=d.splitStringToMap(a.spaceAndPage);
b.page.length&&(a.pages=b.page.join(","));b.space.length&&(a.spaces=b.space.join(","));delete a.spaceAndPage;return a}}});require("confluence/module-exporter").safeRequire("confluence-inline-tasks/macro-browser-overrides",function(e){require("confluence-macro-browser/macro-browser").setMacroJsOverride("tasks-report-macro",e)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:confluence-inlineTasks-utils', location = '/js/util.js' */
define("confluence-inline-tasks/util",["jquery"],function(b){return{NODE_TYPE:{ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12},KEY:{BACKSPACE:8,SPACE:32,PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,INS:45,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESCAPE:27,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46,META:91},addContentEditableIfApplicable:function(a){a=
b(a);var c=require("tinymce");a.attr({contenteditable:!1,"class":"non-editable",onselectstart:"return false;"});c.isIE&&a.attr({contenteditable:!0,unselectable:"on",oncontrolselect:"return false;"})}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-inline-tasks/util","Confluence.InlineTasks.Util");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:datepicker1', location = '/js/date-picker1.js' */
define("confluence-inline-tasks/date-picker1",["jquery","ajs","confluence-editor/utils/tinymce-node-utils"],function(d,k){function h(v,c){var n;var b={};var x=C++;var a=d(v);a.attr("data-aui-dp-uuid",x);c=d.extend(void 0,h.prototype.defaultOptions,c);b.getField=function(){return a};b.getOptions=function(){return c};var F=function(){var f,r,p;b.hide=function(){l.hide()};b.show=function(){l.show()};b.setDate=function(g){"undefined"!==typeof f&&f.datepicker("setDate",g)};b.getDate=function(){if("undefined"!==
typeof f)return f.datepicker("getDate")};var D=function(g){p.off();if(c.hint){var e=d("\x3cdiv/\x3e").addClass("aui-datepicker-hint");e.append("\x3cspan/\x3e").text(c.hint);p.append(e)}f=d("\x3cdiv/\x3e");f.attr("data-aui-dp-popup-uuid",x);p.append(f);e={dateFormat:c.dateFormat,defaultDate:a.val(),maxDate:a.attr("max"),minDate:a.attr("min"),nextText:"\x3e",onSelect:function(m){a.val(m);a.change();b.hide();r=!0;a.focus();c.onSelect&&c.onSelect.call(this,m)},onChangeMonthYear:function(){setTimeout(l.refresh,
0)},prevText:"\x3c"};d.extend(e,g);-1<c.firstDay&&(e.firstDay=c.firstDay);"undefined"!==typeof a.attr("step")&&k.debug("WARNING: The date picker polyfill currently does not support the step attribute!");f.datepicker(e);d("body").on("keydown",t);a.on("focusout keydown",y);a.on("propertychange keyup input paste",z)};var t=function(g){var e=d(g.target),m=e.closest(p).length||e.is(a),E=e.closest(".ui-datepicker-header").length;!m&&!E||g.keyCode===k.keyCode.ESCAPE?b.hide():e[0]!==a[0]&&g.preventDefault()};
var y=function(){w||(d("body").on("focus blur click mousedown","*",t),w=!0)};var A=function(){r?r=!1:b.show()};var z=function(){d(this).val()&&(f.datepicker("setDate",a.val()),f.datepicker("option",{maxDate:a.attr("max"),minDate:a.attr("min")}))};b.destroyPolyfill=function(){b.hide();a.attr("placeholder",null);a.off("propertychange keyup input paste",z);a.off("focus click",A);a.off("focusout keydown",y);d("body").off("keydown",t);h.prototype.browserSupportsDateField&&(a[0].type="date");"undefined"!==
typeof f&&f.datepicker("destroy");delete b.destroyPolyfill;delete b.show;delete b.hide};var w=r=!1;c.languageCode in h.prototype.localisations||(c.languageCode="");var B=h.prototype.localisations,u="",q=9>k.versionDetails.major?240:255;"large"===B.size&&(q=325,u="aui-datepicker-dialog-large");q={hideCallback:function(){d("body").off("focus blur click mousedown","*",t);w=!1;n&&n._datePickerPopup&&delete n._datePickerPopup},hideDelay:null,noBind:!0,persistent:!0,closeOthers:!1,width:q};c.position&&
(q.calculatePositions=function(g,e){g=d(g[0]);return c.position.call(this,g,e)});var l=k.InlineDialog(a,void 0,function(g,e,m){"undefined"===typeof f&&(p=g,D(B));if(n=d(e).closest(".aui-inline-dialog").get(0))n._datePickerPopup=l;m()},q);l.addClass("aui-datepicker-dialog");l.addClass(u);a.on("focus click",A);a.attr("placeholder",c.dateFormat);c.overrideBrowserDefault&&h.prototype.browserSupportsDateField&&(a[0].type="text",u=a[0].getAttribute("value"))&&(a[0].value=u)};b.reset=function(){"function"===
typeof b.destroyPolyfill&&b.destroyPolyfill();h.prototype.browserSupportsDateField&&!c.overrideBrowserDefault||F()};b.reset();return b}var C=0;h.prototype.browserSupportsDateField=k.DatePicker.prototype.browserSupportsDateField;h.prototype.defaultOptions={overrideBrowserDefault:!1,firstDay:-1,languageCode:d("html").attr("lang")||"en-AU",dateFormat:d.datepicker.W3C};h.prototype.localisations=k.DatePicker.prototype.localisations;d.fn.inlineTasksDatePicker1=function(v){return new h(this,v)}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:dateutil', location = '/js/dateutil.js' */
define("confluence-inline-tasks/dateutil","jquery ajs moment confluence/position confluence-inline-tasks/util confluence-inline-tasks/date-picker1".split(" "),function(h,n,r,p,v){var k={PATTERN_INSERTING:"DD-MM-YYYY",PATTERN_LOZENGE:"DD MMM YYYY",PATTERN_INSIDE_TIME_ELE:"YYYY-MM-DD",convertDateIntoHtml:function(a,b,d,c){c||(c=k.PATTERN_INSERTING);d||(d="");b||(b="\x3ctime\x3e");var e=h("\x3cdiv\x3e");c=a.format(c);0<=b.indexOf("time")?(a=h(b,{datetime:a.format(k.PATTERN_INSIDE_TIME_ELE)}),v.addContentEditableIfApplicable(a)):
a=h(b);d&&a.attr("class",d);a.text(c);e.append(a);return e.html()},insertDateIntoCurrentCursor:function(a,b,d,c,e){var f=require("tinymce"),g=require("confluence-editor/utils/tinymce-node-utils");f=f.activeEditor;a=k.convertDateIntoHtml(a,b,d,c);a=h(a,f.getDoc())[0];g=g.replaceSelection(a);e&&f.execCommand("mceInsertContent",!1,e,{skip_undo:!0});e={context:h(f.selection.getRng(!0).startContainer).closest("li[data-inline-task-id]").length?"task":"page",trigger:"character"};n.trigger("analyticsEvent",
{name:"confluence-spaces.date.added",data:e});return g},parse:function(a,b){b||(b=k.PATTERN_INSIDE_TIME_ELE);a=r(h.trim(a),b,!0);return a.isValid()?a:null},format:function(a,b){b||(b=k.PATTERN_INSIDE_TIME_ELE);return a?a.format(b):null},guessPartialDate:function(a,b){if(null==a)return null;a=h.trim(a.replace(/[-\.\/]/g,"-"));a=a.split("-");for(var d=r().format(b).split("-"),c=0;3>c;c++)a[c]||(a[c]=d[c]),/^\d$/.test(a[c])&&(a[c]="0"+a[c]);return k.parse(a.join("-"),b)},datepicker:{POSITION_ABOVE:!0,
POSITION_BELOW:!1,POSITION_RIGHT:!0,POSITION_LEFT:!1,dropDownStillFitsVertically:function(a,b,d){return a===this.POSITION_ABOVE?b.above>=d:b.below>=d},dropDownStillFitsHorizontally:function(a,b,d){return a===this.POSITION_RIGHT?b.right>=d:b.left>=d},getPreferredHorizontalPosition:function(a,b){return a.right>=b?this.POSITION_RIGHT:a.left>=b?this.POSITION_LEFT:a.right>a.left?this.POSITION_RIGHT:this.POSITION_LEFT},getPreferredVerticalPosition:function(a,b){return a.below>=b?this.POSITION_BELOW:a.above>=
b?this.POSITION_ABOVE:a.below>a.above?this.POSITION_BELOW:this.POSITION_ABOVE},calculateDatepickerPosition:function(a){var b=this;return function(d,c){var e=require("confluence-editor/editor/atlassian-editor");c=require("confluence-editor/editor/atlassian-editor-content");e=e.Rte.getEditorFrame();void 0===p.spaceLeftRight&&(p.spaceLeftRight=function(w,t){t=t.position().left;return{left:t,right:h(w).width()-t}});var f=p.spaceAboveBelow(e,a);var g=p.spaceLeftRight(e,a);var q=c.offset(a);c=d.outerHeight(!0);
d=d.outerWidth(!0);var l=c+16;var u=d+0;e=b.POSITION_BELOW;var m=b.POSITION_RIGHT;e&&(b.dropDownStillFitsVertically(e,f,l)||(e=null));e||(e=b.getPreferredVerticalPosition(f,l));m&&(b.dropDownStillFitsHorizontally(m,g,l)||(m=null));m=b.getPreferredHorizontalPosition(g,u);f=e===b.POSITION_ABOVE?q.top-c-16:q.top+a.height()+16;g=m===b.POSITION_RIGHT?q.left-0:q.left+a.outerWidth()-d;f={top:f,left:g};m=m===b.POSITION_RIGHT?a.outerWidth()/2:d-a.outerWidth()/2;if(0>m||m>d)m=d/10;return{displayAbove:e,popupCss:f,
arrowCss:{left:m,top:e===b.POSITION_ABOVE?c:-8}}}},getHintTextOfDatePicker:function(a){return a?"Select a due date for this task.":"Select a date."},create:function(a){var b=a.$attachTo,d=a.$positionTo,c=a.startDate,e=a.onSelect;a=a.isSetDueDate;var f=h("\x3cinput\x3e").attr("type","date").addClass("aui-date-picker").css("display","none"),g=f.inlineTasksDatePicker1({overrideBrowserDefault:!0,dateFormat:"yy-mm-dd",languageCode:n.Meta.get("user-locale")&&
n.Meta.get("user-locale").split("_")[0],position:this.calculateDatepickerPosition(d),onSelect:function(l){e(k.parse(l));q()},hint:this.getHintTextOfDatePicker(a)}),q=function(){g&&g.destroyPolyfill&&g.destroyPolyfill();f&&f.remove();h(".aui-datepicker-dialog").remove();f=g=null};g.show();g.setDate(k.format(c));h(".aui-datepicker-dialog .aui-datepicker-hint").addClass(a?"set-duedate":"set-date");b.before(f);return{die:function(){q()},show:function(){g.show()},hide:function(){g.hide()},getContainer:function(){return f},
setDate:function(l){var u=k.guessPartialDate(l,k.PATTERN_INSERTING);n.debug("Set date: "+l);u&&g.setDate(k.format(u))},placeDatePicker:function(){var l=n.InlineDialog.current;(l=l&&l.popup)&&l.refresh()}}}}};return k});
require("confluence/module-exporter").exportModuleAsGlobal("confluence-inline-tasks/dateutil","Confluence.InlineTasks.DateUtil",function(h){var n=require("ajs"),r=require("underscore"),p=require("confluence/meta"),v=require("moment");n.toInit(function(){var k=function(d,c,e){return c&&"en_us"===c.toLowerCase()?"MM"+e+"DD"+e+"YYYY":r.uniq(d.replace(/[^MDY]/g,"").split("")).join(e).replace("D","DD").replace("M","MM").replace("Y","YYYY")},a=p.get("user-locale");a&&v.lang(a.split("_")[0].toLowerCase());
var b=p.get("user-date-pattern");b&&(h.PATTERN_LOZENGE=b.toUpperCase(),h.PATTERN_INSERTING=k(b.toUpperCase(),a,"-"),h.PATTERN_INSERTING_ALTERNATE=k(b.toUpperCase(),a,"/"))})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:date-helper-js-resources', location = '/js/lib/lang/de.js' */
(function(c){"function"===typeof define&&define.amd?define(["moment"],c):"object"===typeof exports?module.exports=c(require("../moment")):c(window.moment)})(function(c){function b(a,e,d,f){a={m:["eine Minute","einer Minute"],h:["eine Stunde","einer Stunde"],d:["ein Tag","einem Tag"],dd:[a+" Tage",a+" Tagen"],M:["ein Monat","einem Monat"],MM:[a+" Monate",a+" Monaten"],y:["ein Jahr","einem Jahr"],yy:[a+" Jahre",a+" Jahren"]};return e?a[d][0]:a[d][1]}return c.lang("de",{months:"Januar Februar Mrz April Mai Juni Juli August September Oktober November Dezember".split(" "),
monthsShort:"Jan. Febr. Mrz. Apr. Mai Jun. Jul. Aug. Sept. Okt. Nov. Dez.".split(" "),weekdays:"Sonntag Montag Dienstag Mittwoch Donnerstag Freitag Samstag".split(" "),weekdaysShort:"So. Mo. Di. Mi. Do. Fr. Sa.".split(" "),weekdaysMin:"So Mo Di Mi Do Fr Sa".split(" "),longDateFormat:{LT:"H:mm [Uhr]",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY LT",LLLL:"dddd, D. MMMM YYYY LT"},calendar:{sameDay:"[Heute um] LT",sameElse:"L",nextDay:"[Morgen um] LT",nextWeek:"dddd [um] LT",lastDay:"[Gestern um] LT",
lastWeek:"[letzten] dddd [um] LT"},relativeTime:{future:"in %s",past:"vor %s",s:"ein paar Sekunden",m:b,mm:"%d Minuten",h:b,hh:"%d Stunden",d:b,dd:b,M:b,MM:b,y:b,yy:b},ordinal:"%d.",week:{dow:1,doy:4}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:date-helper-js-resources', location = '/js/lib/lang/es.js' */
(function(a){"function"===typeof define&&define.amd?define(["moment"],a):"object"===typeof exports?module.exports=a(require("../moment")):a(window.moment)})(function(a){var c="ene. feb. mar. abr. may. jun. jul. ago. sep. oct. nov. dic.".split(" "),d="ene feb mar abr may jun jul ago sep oct nov dic".split(" ");return a.lang("es",{months:"enero febrero marzo abril mayo junio julio agosto septiembre octubre noviembre diciembre".split(" "),monthsShort:function(b,e){return/-MMM-/.test(e)?d[b.month()]:
c[b.month()]},weekdays:"domingo lunes martes mircoles jueves viernes sbado".split(" "),weekdaysShort:"dom. lun. mar. mi. jue. vie. sb.".split(" "),weekdaysMin:"Do Lu Ma Mi Ju Vi S".split(" "),longDateFormat:{LT:"H:mm",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY LT",LLLL:"dddd, D [de] MMMM [de] YYYY LT"},calendar:{sameDay:function(){return"[hoy a la"+(1!==this.hours()?"s":"")+"] LT"},nextDay:function(){return"[maana a la"+(1!==this.hours()?"s":"")+"] LT"},nextWeek:function(){return"dddd [a la"+
(1!==this.hours()?"s":"")+"] LT"},lastDay:function(){return"[ayer a la"+(1!==this.hours()?"s":"")+"] LT"},lastWeek:function(){return"[el] dddd [pasado a la"+(1!==this.hours()?"s":"")+"] LT"},sameElse:"L"},relativeTime:{future:"en %s",past:"hace %s",s:"unos segundos",m:"un minuto",mm:"%d minutos",h:"una hora",hh:"%d horas",d:"un da",dd:"%d das",M:"un mes",MM:"%d meses",y:"un ao",yy:"%d aos"},ordinal:"%d",week:{dow:1,doy:4}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:date-helper-js-resources', location = '/js/lib/lang/fr.js' */
(function(a){"function"===typeof define&&define.amd?define(["moment"],a):"object"===typeof exports?module.exports=a(require("../moment")):a(window.moment)})(function(a){return a.lang("fr",{months:"janvier fvrier mars avril mai juin juillet aot septembre octobre novembre dcembre".split(" "),monthsShort:"janv. fvr. mars avr. mai juin juil. aot sept. oct. nov. dc.".split(" "),weekdays:"dimanche lundi mardi mercredi jeudi vendredi samedi".split(" "),weekdaysShort:"dim. lun. mar. mer. jeu. ven. sam.".split(" "),
weekdaysMin:"Di Lu Ma Me Je Ve Sa".split(" "),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D MMMM YYYY LT"},calendar:{sameDay:"[Aujourd'hui ] LT",nextDay:"[Demain ] LT",nextWeek:"dddd [] LT",lastDay:"[Hier ] LT",lastWeek:"dddd [dernier ] LT",sameElse:"L"},relativeTime:{future:"dans %s",past:"il y a %s",s:"quelques secondes",m:"une minute",mm:"%d minutes",h:"une heure",hh:"%d heures",d:"un jour",dd:"%d jours",M:"un mois",MM:"%d mois",y:"un an",yy:"%d ans"},
ordinal:function(b){return b+(1===b?"er":"")},week:{dow:1,doy:4}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:date-helper-js-resources', location = '/js/lib/lang/ja.js' */
(function(a){"function"===typeof define&&define.amd?define(["moment"],a):"object"===typeof exports?module.exports=a(require("../moment")):a(window.moment)})(function(a){return a.lang("ja",{months:"1 2 3 4 5 6 7 8 9 10 11 12".split(" "),monthsShort:"1 2 3 4 5 6 7 8 9 10 11 12".split(" "),weekdays:"      ".split(" "),weekdaysShort:"".split(""),weekdaysMin:"".split(""),longDateFormat:{LT:"Ahm",L:"YYYY/MM/DD",LL:"YYYYMD",LLL:"YYYYMDLT",
LLLL:"YYYYMDLT dddd"},meridiem:function(b,c,d){return 12>b?"":""},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"[]dddd LT",lastDay:"[] LT",lastWeek:"[]dddd LT",sameElse:"L"},relativeTime:{future:"%s",past:"%s",s:"",m:"1",mm:"%d",h:"1",hh:"%d",d:"1",dd:"%d",M:"1",MM:"%d",y:"1",yy:"%d"}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:date-helper-js-resources', location = '/js/lib/lang/en-gb.js' */
(function(a){"function"===typeof define&&define.amd?define(["moment"],a):"object"===typeof exports?module.exports=a(require("../moment")):a(window.moment)})(function(a){return a.lang("en-gb",{months:"January February March April May June July August September October November December".split(" "),monthsShort:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),weekdays:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),weekdaysShort:"Sun Mon Tue Wed Thu Fri Sat".split(" "),
weekdaysMin:"Su Mo Tu We Th Fr Sa".split(" "),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd, D MMMM YYYY LT"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},
ordinal:function(b){var c=b%10;return b+(1===~~(b%100/10)?"th":1===c?"st":2===c?"nd":3===c?"rd":"th")},week:{dow:1,doy:4}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:editor-autocomplete-date-js', location = '/js/editor-plugin/date-autocomplete-help-dialog.js' */
AJS.toInit(function(){Confluence.KeyboardShortcuts&&Confluence.KeyboardShortcuts.Autoformat&&Confluence.KeyboardShortcuts.Autoformat.push({action:"//",context:"autoformat.autocomplete",description:"Date"})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:editor-autocomplete-date-js', location = '/js/editor-plugin/autocomplete-manager.js' */
(function(g){var e=window.Confluence||{};e.Editor=e.Editor||{};e.Editor.AutoComplete=e.Editor.AutoComplete||{};var c=e.InlineTasks.Util.KEY,l=e.InlineTasks.DateUtil,h=e.Editor.AutoComplete;h.SETTING_DEFAULT={leadingChar:"",isDataValid:function(a){return!1},backWords:0,onBeforeDie:function(){},onAfterStart:function(){},onScroll:function(){}};h.Manager=function(a){this.ed=AJS.Rte.getEditor();this.settings=g.extend({},h.SETTING_DEFAULT,a);this.log=AJS.debug;this.control=null};h.Manager.prototype={start:function(a){AJS.trigger("synchrony.stop",
{id:"confluence.date-autocomplete-manager.plugin"});this.log("startAutoComplete - Started");var f=g.extend({},this.settings,a);this.control=e.Editor.Autocompleter.Control(this.ed,f);if(!this.control)return!1;this.attachEventsToControl();f.onAfterStart&&f.onAfterStart({date:a.date,isTriggerFromOrphan:a.isTriggerFromOrphan?!0:!1});return!0},attachEventsToControl:function(){var a=this,f=a.control,k=a.log,q=a.settings;if("function"===typeof this.settings.onBeforeDie){var m=this.control.die,n=!1;this.control.die=
function(){n||(n=!0,a.settings.onBeforeDie.apply(a.control,arguments),a.dateInserted()?(m.apply(a.control,[!0]),AJS.trigger("analyticsEvent",{name:"confluence-spaces.tasks.daterecognition.killed"})):m.apply(a.control,arguments))}}var r=_.bind(_.throttle(a.settings.onScroll,40),this);g.extend(f,{onBeforeKey:function(b,d){b.keyCode!==c.ESCAPE&&b.keyCode!==c.ENTER&&a.control&&a.control.getContainer().addClass("isDirty");return b.keyCode===c.DOWN||b.keyCode===c.UP||b.keyCode===c.ENTER?(tinymce.dom.Event.cancel(b),
!1):b.keyCode===c.ESCAPE||b.keyCode===c.TAB||b.keyCode===c.BACKSPACE&&!d?(k("autoCompleteControl.onBeforeKey - killing autoCompleteControl"),this.die(b.keyCode===c.BACKSPACE),!1):!0},onKeyPress:function(b,d){d=AJS.$.browser.msie?b.keyCode:b.which;if(b.keyCode===c.ENTER)return tinymce.dom.Event.cancel(b),!1;b=String.fromCharCode(d);this.settings.endChars.includes(b)&&(k("autoCompleteControl.onKeyPress - caught autocomplete-closing char - character"),f.die());return!0},onAfterKey:function(b,d){var p=
g("#autocomplete-trigger",a.control.getContainer()),t=p.text();return 0<p.length&&t!==a.settings.leadingChar?(k("after","dying because of: trigger text is modified"),a.reset(),!1):b.keyCode===c.ENTER?(q.isDataValid(d)?f.update(d):(k("autoCompleteControl.onAfterKey - closing autocomplete due to invalid data - "+d),f.die(!1)),!1):a.dateInserted()&&10<d.length&&!l.parse(d,[l.PATTERN_INSERTING,l.PATTERN_INSERTING_ALTERNATE])||b.keyCode===c.SPACE?(a.reset(),!1):!0},onDeath:function(){a.reset()},onScroll:function(){a.isAlive()&&
r()}})},isAlive:function(){return this.control&&!this.control.dying},reset:function(){this.control&&(this.control.die(),this.control=null,AJS.trigger("synchrony.start",{id:"confluence.date-autocomplete-manager.plugin"}))},dateInserted:function(a){return!0===a?this.control.getContainer().addClass("hasDateInserted"):!1===a?this.control.getContainer().removeClass("hasDateInserted"):this.control.getContainer().hasClass("hasDateInserted")},dirty:function(a){return!0===a?this.control.getContainer().addClass("isDirty"):
this.control.getContainer().hasClass("isDirty")},reattach:function(){var a=e.Editor.Autocompleter.Control.removeOrphanedControl();return a&&a.leadingChar===this.settings.leadingChar?(this.reset(),this.start({backWords:1,isTriggerFromOrphan:!0})):!1}}})(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:editor-autocomplete-date-js', location = '/js/editor-plugin/date-autocomplete.js' */
(function(g,n){var u=Confluence.InlineTasks.Util,p=u.NODE_TYPE,l=u.KEY,h=Confluence.InlineTasks.DateUtil,m=null,d=null,v=!1,w=n.dom.TreeWalker,f={initDateAutoCompleteObject:function(b){Confluence.Editor.Autocompleter||(Confluence.Editor.Autocompleter=n.confluence.Autocompleter);Confluence.Editor.Autocompleter.Settings["//"]={ch:"//",endChars:[],update:function(a,c){d.picker.die();(a=c==h.PATTERN_INSERTING.toLowerCase()?moment():h.guessPartialDate(c,h.PATTERN_INSERTING))&&h.insertDateIntoCurrentCursor(a,
"\x3ctime\x3e","",h.PATTERN_LOZENGE,"\x26nbsp;");d.dateInserted()&&AJS.trigger("analyticsEvent",{name:"confluence-spaces.tasks.daterecognition.used"});d.reset();b.undoManager.add();AJS.trigger("synchrony.start",{id:"confluence.date-autocomplete.plugin"})}};d=new Confluence.Editor.AutoComplete.Manager({leadingChar:"//",isDataValid:function(a){return!d.dirty()||null!=h.guessPartialDate(a,h.PATTERN_INSERTING)},onBeforeDie:function(){d.picker&&d.picker.die();if(d.control){var a=g(d.control.getContainer());
d.dirty()||a.find("#autocomplete-search-text").remove()}},onAfterStart:function(a){a&&a.date?(f.fillPlaceholderDateAutoComplete(b,a.date,!0),d.dirty(!0),d.dateInserted(!0)):a&&!a.isTriggerFromOrphan&&(f.fillPlaceholderDateAutoComplete(b,h.PATTERN_INSERTING.toLowerCase(),!1),d.dateInserted(!1));a=d.control.text();a=h.guessPartialDate(a,h.PATTERN_INSERTING)||moment();f.bindDatePickerToAutoComplete(a)},onScroll:function(){d.picker&&d.picker.placeDatePicker()}})},activateDateAutocomplete:function(b,a,
c){b=Object.assign({},c,a);b.hasOwnProperty("insertedFromMenu")||(b.insertedFromMenu=!1);if(!d.isAlive()&&!d.start(b)&&!b.insertedFromMenu)return m.execCommand("mceInsertContent",!1,"//",{skip_undo:!0}),!1},bindDatePickerToAutoComplete:function(b){var a=d.control&&d.control.getContainer();if(a.length){a.addClass("date-autocomplete");a.find("#autocomplete-search-text span").addClass("inserting");var c=f.isInsideTaskAndFirstTimeNode(a);d.picker=h.datepicker.create({$attachTo:a,$positionTo:a,startDate:b,
onSelect:function(e){d.control.update(e.format(h.PATTERN_INSERTING))},isSetDueDate:c})}},fillPlaceholderDateAutoComplete:function(b,a,c){var e=d.control.getContainer().find("#autocomplete-search-text span");e.text(AJS.Rte.HIDDEN_CHAR+a);var k=b.dom.createRng();k.setStart(e[0].firstChild,1);k.setEnd(e[0].firstChild,a.length+1);c&&k.collapse(!1);b.selection.setRng(k)},autocompleteDoubleSlash:function(b,a){b=a.handlerManager;var c=a.ed;a=a.createHandler;a=a(/(?:\s|\xA0|^|\ufeff|\u200b)(\/)$/,function(){c.execCommand("mceConfInsertDateAutocomplete",
!1,{},{skip_undo:!0})},!0,"#autocomplete");b.registerHandler(47,a)},registerTriggerDoubleSlash:function(b){b.addCommand("mceConfInsertDateAutocomplete",f.activateDateAutocomplete);b.addCommand("confMenuInsertDate",function(){AJS.trigger("analytics",{name:"editor.insert-data-from-menu"});m.execCommand("mceConfInsertDateAutocomplete",!1,{insertedFromMenu:!0},{skip_undo:!0})}.bind(this));AJS.bind("confluence.editor.registerHandlers",this.autocompleteDoubleSlash)},isTimeNode:function(b){return b&&b.nodeType===
p.ELEMENT_NODE&&"time"===b.tagName.toLowerCase()},getTimeNodeAtCursor:function(b){b||(b=m);var a=b.selection.getNode();if(f.isTimeNode(a))return a;a=b.selection.getStart();if(f.isTimeNode(a))return a;a=b.selection.getEnd();if(f.isTimeNode(a))return a},makeTimeNodesUnEditable:function(b){b.each(function(){var a=g(this);""===g.trim(a.text())&&a.remove();n.isWebKit&&a.remove("br.Apple-interchange-newline");u.addContentEditableIfApplicable(this)})},wrapTimeNodesWithHiddenChar:function(b){b.each(function(){var a=
g(this);this.previousSibling&&this.previousSibling.nodeType===p.TEXT_NODE&&""!==this.previousSibling.nodeValue||a.before(AJS.Rte.HIDDEN_CHAR);this.nextSibling&&this.nextSibling.nodeType===p.TEXT_NODE&&""!==this.previousSibling.nodeValue||a.after(AJS.Rte.HIDDEN_CHAR)})},putCursorAtEdge:function(b,a,c){(c=!!c)?a.nextSibling&&a.nextSibling.nodeType===p.TEXT_NODE||g(a).after(b.dom.doc.createTextNode("")):a.previousSibling&&a.previousSibling.nodeType===p.TEXT_NODE||g(a).before(b.dom.doc.createTextNode(""));
var e=b.selection.dom.createRng();e.selectNode(c?a.nextSibling:a.previousSibling);e.collapse(c);b.selection.setRng(e)},findFirstTimeNodeInClosestBlock:function(b,a,c){var e=new w(a,b.getBody()),k=a,r=0;do{if(1==r&&f.isTimeNode(a))return a;var q=c?a.previousSibling:a.nextSibling;a!==k&&q&&(b.dom.isBlock(a)||b.dom.isBlock(q))&&r++}while((a=c?e.next():e.prev())&&2>r)},findFirstTimeNodeNearby:function(b,a,c){var e=a,k=new w(a,b.getBody());do{if(f.isTimeNode(a))return a;if(b.dom.isBlock(a)||a!==e&&a.nodeType===
p.TEXT_NODE&&""!==a.nodeValue)break}while(a=c?k.next():k.prev())},convertInvalidTimeNodeToPlainText:function(b){b.each(function(){var a=g(this),c=a.attr("datetime");h.parse(c)||(a.before(a.text()),a.remove())})},isInsideTaskAndFirstTimeNode:function(b){b=g(b);var a=b.closest("ul.inline-task-list \x3e li[data-inline-task-id]");return a.length?a.find("time, span.date-autocomplete")[0]===b[0]:!1}},C=function(b){b=b.keyCode;if(b===l.BACKSPACE||b===l.DELETE){b=b===l.DELETE;var a=m.selection.getRng(!0),
c=a.startContainer,e=c;if(c.nodeType!=p.TEXT_NODE||(b?a.startOffset==c.nodeValue.length:0==a.startOffset))c.nodeType===p.ELEMENT_NODE&&(e=b?c.childNodes.length===a.startOffset?c:c.childNodes.item(a.startOffset):0===a.startOffset?c:c.childNodes.item(a.startOffset-1)),(b=f.findFirstTimeNodeNearby(m,e,b))&&m.dom.remove(b)}},D=function(b){var a=g(b.target);if(a.is("time")){AJS.trigger("synchrony.stop",{id:"confluence.date-autocomplete.plugin"});var c=a.closest("li[data-inline-task-id]").length?"task":
"page";AJS.trigger("analyticsEvent",{name:"confluence-spaces.date.clicked",data:{mode:"editor",context:c}});var e=a.closest("body"),k=function(){AJS.Rte.unbindScroll("date-lozenge-date-picker");q.die();AJS.trigger("synchrony.start",{id:"confluence.date-autocomplete.plugin"})};e.one("keydown click",k);b=h.parse(a.attr("datetime"));var r=f.isInsideTaskAndFirstTimeNode(a),q=h.datepicker.create({$attachTo:a,$positionTo:a,startDate:b,onSelect:function(t){var x=t.format(h.PATTERN_INSIDE_TIME_ELE);t=t.format(h.PATTERN_LOZENGE);
x!==a.attr("datetime")&&AJS.trigger("analyticsEvent",{name:"confluence-spaces.date.changed",data:{context:c}});a.attr("datetime",x);a.text(t);e.unbind("keydown click",k);AJS.trigger("synchrony.start",{id:"confluence.date-autocomplete.plugin"})},isSetDueDate:r});b=_.bind(_.throttle(function(){q&&AJS.Rte.isAnyPartShown(a)?q.placeDatePicker():k()},40),this);AJS.Rte.bindScroll("date-lozenge-date-picker",b)}},E=function(b){var a=b.keyCode;a===l.UP||a===l.DOWN||a===l.LEFT||a===l.RIGHT||a===l.HOME||a===
l.END||a===l.PAGEDOWN||a===l.PAGEUP||b.metaKey||b.ctrlKey||b.altKey||!d.control||!d.picker||(b=d.control.text(),d.picker.setDate(b))},F=function(){var b=g(m.dom.doc).find("time");f.makeTimeNodesUnEditable(b);f.wrapTimeNodesWithHiddenChar(b)},y=function(b,a,c){f.convertInvalidTimeNodeToPlainText(g(c.node).find("time"))},z=function(b,a,c){b=g(c.node).find("time");f.makeTimeNodesUnEditable(b)},A=function(b,a,c){if(f.getTimeNodeAtCursor(m))return c.content="",!1},G=function(b){var a=b.keyCode;if(a===
l.UP||a===l.DOWN){b=m.selection.getRng(!0);var c=b.startContainer,e=c;a=a===l.DOWN;c.nodeType===p.ELEMENT_NODE&&(e=a?c.childNodes.length===b.startOffset?c:c.childNodes.item(b.startOffset):0===b.startOffset?c:c.childNodes.item(b.startOffset-1));(b=f.findFirstTimeNodeInClosestBlock(m,e,a))&&f.wrapTimeNodesWithHiddenChar(g(b))}},H=function(b){b=b.element.nodeType===p.TEXT_NODE?b.element.parentNode:b.element;f.isTimeNode(b)&&(v||1<m.selection.getRng().startOffset?f.putCursorAtEdge(m,b,!0):f.putCursorAtEdge(m,
b,!1))},B=function(){d&&d.reattach()},I={init:function(b){f.initDateAutoCompleteObject(b);f.registerTriggerDoubleSlash(b);m=b;b.on("contextmenu",function(){d.reset()});b.on("SetContent",F);b.on("click",D);b.on("keyup",E);n.isWebKit&&(b.on("keydown",G),b.on("init",function(){g(document).bind("postPaste",z)}),b.on("remove",function(){g(document).unbind("postPaste",z)}));b.on("keyup",function(a){v=a.keyCode===l.RIGHT;var c=b.selection.getRng(!0),e=c.commonAncestorContainer,k=!!e&&e.data;k&&!AJS.$(e).closest("pre,.text-placeholder").length&&
(String.prototype.slice.apply(k,[-11]),48<=a.keyCode&&57>=a.keyCode||96<=a.keyCode&&105>=a.keyCode)&&(a=String.prototype.slice.apply(k,[-10]),/(^| )\d{2}[\/\-]\d{2}[\/\-]\d{4}$/.test(k)&&h.parse(a,[h.PATTERN_INSERTING,h.PATTERN_INSERTING_ALTERNATE])&&(c.setStart(c.commonAncestorContainer,c.endOffset-a.length),b.undoManager.add(),b.undoManager.beforeChange(),b.selection.setRng(c),b.execCommand("mceConfInsertDateAutocomplete",!1,{date:a},{skip_undo:!0}),AJS.trigger("analyticsEvent",{name:"confluence-spaces.tasks.daterecognition.triggered"})))});
n.isGecko&&(b.on("keydown",C),b.on("init",function(){g(document).bind("prePaste",A)}),b.on("remove",function(){g(document).unbind("prePaste",A)}));if(n.isWebKit||n.isGecko)b.on("NodeChange",H);b.on("Undo",B);b.on("Redo",B);b.on("init",function(){g(document).bind("postPaste",y)});b.on("remove",function(){g(document).unbind("postPaste",y);AJS.unbind("confluence.editor.registerHandlers",f.autocompleteDoubleSlash)});AJS.bind("editor.remote.change",function(){f.makeTimeNodesUnEditable(g(b.dom.doc).find("time"))})},
getInfo:function(){return{longname:"Insert Date Autocomplete",author:"Atlassian",authorurl:"http://www.atlassian.com",version:n.majorVersion+"."+n.minorVersion}}};(function(){n.create("tinymce.plugins.DateAutocomplete",I);n.PluginManager.add("dateautocomplete",n.plugins.DateAutocomplete);AJS.Rte.BootstrapManager.addTinyMcePluginInit(function(b){b.plugins+=",dateautocomplete"})})()})(AJS.$,tinymce);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.reconcile-unknown-attachments:property-panel-unknown-image-placeholder', location = 'js/unknown-image-placeholder-property-panel.js' */
define("confluence-editor/unknown-attachment/property-panel",["wrm/context-path","ajs"],function(d,a){a&&a.Rte&&a.Rte.BootstrapManager?a.Rte.BootstrapManager.addOnInitCallback(function(){const c=a.Rte.getEditor();c?c.onClick.add(function(a,b){b=b.target;"IMG"===b.nodeName&&b.hasAttribute("src")&&0<=b.getAttribute("src").indexOf(d()+"/plugins/servlet/confluence/placeholder/unknown-attachment")&&a.execCommand("mceConfimage")}):a.log("Could not get Editor from adapter")}):a.log("Could not initialize property panel onclick handler on Confluence.Editor")});
require("confluence-editor/unknown-attachment/property-panel");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.drag-and-drop:drag-and-drop-for-editor-v4', location = 'js/editor-v4-init.js' */
require(["ajs","jquery","wrm/require"],function(b,d,c){b.Rte.BootstrapManager.addOnInitCallback(function(){c(["wrc!com.atlassian.confluence.plugins.drag-and-drop:editor-drop-handler"]).then(function(){require(["confluence-drag-and-drop/editor-drop-handler"],function(a){a.initialiseOverlay();a.initialise()})})})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-hipchat-emoticons-plugin:hipchat-emoticons-conf-frontend', location = 'lib/rivets.js' */
'use strict';(function(){var q=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1},h=function(a,b){return function(){return a.apply(b,arguments)}},y=[].slice,A={}.hasOwnProperty,z=function(a,b){function c(){this.constructor=a}for(var d in b)A.call(b,d)&&(a[d]=b[d]);c.prototype=b.prototype;a.prototype=new c;a.__super__=b.prototype;return a};var f={binders:{},components:{},formatters:{},adapters:{},config:{prefix:"rv",templateDelimiters:["{","}"],rootInterface:".",
preloadData:!0,handler:function(a,b,c){return this.call(a,b,c.view.models)}}};if("jQuery"in window){var t="on"in jQuery.prototype?["on","off"]:["bind","unbind"];var B=t[0];var C=t[1];f.Util={bindEvent:function(a,b,c){return jQuery(a)[B](b,c)},unbindEvent:function(a,b,c){return jQuery(a)[C](b,c)},getInputValue:function(a){a=jQuery(a);return"checkbox"===a.attr("type")?a.is(":checked"):a.val()}}}else f.Util={bindEvent:function(){return"addEventListener"in window?function(a,b,c){return a.addEventListener(b,
c,!1)}:function(a,b,c){return a.attachEvent("on"+b,c)}}(),unbindEvent:function(){return"removeEventListener"in window?function(a,b,c){return a.removeEventListener(b,c,!1)}:function(a,b,c){return a.detachEvent("on"+b,c)}}(),getInputValue:function(a){var b;if("checkbox"===a.type)return a.checked;if("select-multiple"===a.type){var c=[];var d=0;for(b=a.length;d<b;d++){var e=a[d];e.selected&&c.push(e.value)}return c}return a.value}};f.KeypathParser=function(){function a(){}a.parse=function(b,a,d){var c,
g;var m=[];d={"interface":d,path:""};var f=c=0;for(g=b.length;c<g;f=c+=1)f=b.charAt(f),0<=q.call(a,f)?(m.push(d),d={"interface":f,path:""}):d.path+=f;m.push(d);return m};return a}();f.TextTemplateParser=function(){function a(){}a.types={text:0,binding:1};a.parse=function(b,a){var c;var e=[];var g=b.length;for(c=0;c<g;){var m=b.indexOf(a[0],c);if(0>m){e.push({type:this.types.text,value:b.slice(c)});break}else{0<m&&c<m&&e.push({type:this.types.text,value:b.slice(c,m)});c=m+a[0].length;m=b.indexOf(a[1],
c);if(0>m){a=b.slice(c-a[1].length);b=e[e.length-1];(null!=b?b.type:void 0)===this.types.text?b.value+=a:e.push({type:this.types.text,value:a});break}c=b.slice(c,m).trim();e.push({type:this.types.binding,value:c});c=m+a[1].length}}return e};return a}();f.Observer=function(){function a(b,a,d,e){this.view=b;this.model=a;this.keypath=d;this.callback=e;this.unobserve=h(this.unobserve,this);this.realize=h(this.realize,this);this.value=h(this.value,this);this.publish=h(this.publish,this);this.read=h(this.read,
this);this.set=h(this.set,this);this.adapter=h(this.adapter,this);this.update=h(this.update,this);this.initialize=h(this.initialize,this);this.parse=h(this.parse,this);this.parse();this.initialize()}a.prototype.parse=function(){var b,a;var d=this.view.adapters;var e=[];for(g in d)(b=d[g])&&e.push(g);if(a=this.keypath[0],0<=q.call(e,a)){b=this.keypath[0];var g=this.keypath.substr(1)}else b=this.view.config.rootInterface,g=this.keypath;this.tokens=f.KeypathParser.parse(g,e,b);return this.key=this.tokens.pop()};
a.prototype.initialize=function(){this.objectPath=[];this.target=this.realize();if(null!=this.target)return this.set(!0,this.key,this.target,this.callback)};a.prototype.update=function(){var b;if((b=this.realize())!==this.target){null!=this.target&&this.set(!1,this.key,this.target,this.callback);null!=b&&this.set(!0,this.key,b,this.callback);var a=this.value();this.target=b;if(this.value()!==a)return this.callback()}};a.prototype.adapter=function(b){return this.view.adapters[b["interface"]]};a.prototype.set=
function(b,a,d,e){b=b?"subscribe":"unsubscribe";return this.adapter(a)[b](d,a.path,e)};a.prototype.read=function(b,a){return this.adapter(b).read(a,b.path)};a.prototype.publish=function(b){if(null!=this.target)return this.adapter(this.key).publish(this.target,this.key.path,b)};a.prototype.value=function(){if(null!=this.target)return this.read(this.key,this.target)};a.prototype.realize=function(){var b,a,d;var e=this.model;var g=null;var m=this.tokens;var f=a=0;for(d=m.length;a<d;f=++a){var k=m[f];
null!=e?(null!=this.objectPath[f]?e!==(b=this.objectPath[f])&&(this.set(!1,k,b,this.update),this.set(!0,k,e,this.update),this.objectPath[f]=e):(this.set(!0,k,e,this.update),this.objectPath[f]=e),e=this.read(k,e)):(null==g&&(g=f),(b=this.objectPath[f])&&this.set(!1,k,b,this.update))}null!=g&&this.objectPath.splice(g);return e};a.prototype.unobserve=function(){var b,a,d;var e=this.tokens;var g=a=0;for(d=e.length;a<d;g=++a){var m=e[g];(b=this.objectPath[g])&&this.set(!1,m,b,this.update)}if(null!=this.target)return this.set(!1,
this.key,this.target,this.callback)};return a}();f.View=function(){function a(b,a,d){var c,g,m;this.els=b;this.models=a;this.options=null!=d?d:{};this.update=h(this.update,this);this.publish=h(this.publish,this);this.sync=h(this.sync,this);this.unbind=h(this.unbind,this);this.bind=h(this.bind,this);this.select=h(this.select,this);this.build=h(this.build,this);this.componentRegExp=h(this.componentRegExp,this);this.bindingRegExp=h(this.bindingRegExp,this);this.els.jquery||this.els instanceof Array||
(this.els=[this.els]);var l=["config","binders","formatters","adapters"];d=0;for(m=l.length;d<m;d++){b=l[d];this[b]={};if(this.options[b]){var k=this.options[b];for(c in k)a=k[c],this[b][c]=a}k=f[b];for(c in k)a=k[c],null==(g=this[b])[c]&&(g[c]=a)}this.build()}a.prototype.bindingRegExp=function(){return new RegExp("^"+this.config.prefix+"-")};a.prototype.componentRegExp=function(){return new RegExp("^"+this.config.prefix.toUpperCase()+"-")};a.prototype.build=function(){var b;this.bindings=[];var a=
[];var d=this.bindingRegExp();var e=this.componentRegExp();var g=function(b){return function(a,c,d,e){var g,m;var l={};var k=function(){var b;var a=e.split("|");var c=[];var d=0;for(b=a.length;d<b;d++)m=a[d],c.push(m.trim());return c}();var h=function(){var b;var a=k.shift().split("\x3c");var c=[];var d=0;for(b=a.length;d<b;d++)g=a[d],c.push(g.trim());return c}();var p=h.shift();l.formatters=k;if(h=h.shift())l.dependencies=h.split(/\s+/);return b.bindings.push(new f[a](b,c,d,p,l))}}(this);var m=function(b){return function(c){var l,
h,k,p;if(0>q.call(a,c)){if(3===c.nodeType){var n=f.TextTemplateParser;if((k=b.config.templateDelimiters)&&(l=n.parse(c.data,k)).length&&(1!==l.length||l[0].type!==n.types.text)){var r=0;for(p=l.length;r<p;r++)k=l[r],n=document.createTextNode(k.value),c.parentNode.insertBefore(n,c),1===k.type&&g("TextBinding",n,null,k.value);c.parentNode.removeChild(c)}}else if(e.test(c.tagName)){var u=c.tagName.replace(e,"").toLowerCase();b.bindings.push(new f.ComponentBinding(b,c,u))}else if(null!=c.attributes){p=
c.attributes;k=0;for(r=p.length;k<r;k++)if(l=p[k],d.test(l.name)){u=l.name.replace(d,"");if(!(h=b.binders[u])){var v=b.binders;for(n in v){var t=v[n];if("*"!==n&&-1!==n.indexOf("*")){var x=new RegExp("^"+n.replace("*",".+")+"$");x.test(u)&&(h=t)}}}h||(h=b.binders["*"]);if(h.block){x=c.childNodes;var w=0;for(h=x.length;w<h;w++)u=x[w],a.push(u);w=[l]}}r=w||c.attributes;n=0;for(k=r.length;n<k;n++)l=r[n],d.test(l.name)&&(u=l.name.replace(d,""),g("Binding",c,u,l.value))}k=c.childNodes;c=[];n=0;for(l=k.length;n<
l;n++)u=k[n],c.push(u);r=[];k=0;for(n=c.length;k<n;k++)l=c[k],r.push(m(l));return r}}}(this);var l=this.els;var k=0;for(b=l.length;k<b;k++){var h=l[k];m(h)}};a.prototype.select=function(b){var a;var d=this.bindings;var e=[];var g=0;for(a=d.length;g<a;g++){var m=d[g];b(m)&&e.push(m)}return e};a.prototype.bind=function(){var b;var a=this.bindings;var d=[];var e=0;for(b=a.length;e<b;e++){var g=a[e];d.push(g.bind())}return d};a.prototype.unbind=function(){var b;var a=this.bindings;var d=[];var e=0;for(b=
a.length;e<b;e++){var g=a[e];d.push(g.unbind())}return d};a.prototype.sync=function(){var b;var a=this.bindings;var d=[];var e=0;for(b=a.length;e<b;e++){var g=a[e];d.push(g.sync())}return d};a.prototype.publish=function(){var b;var a=this.select(function(b){return b.binder.publishes});var d=[];var e=0;for(b=a.length;e<b;e++){var g=a[e];d.push(g.publish())}return d};a.prototype.update=function(b){var a;null==b&&(b={});for(m in b){var d=b[m];this.models[m]=d}var e=this.bindings;var g=[];d=0;for(a=e.length;d<
a;d++){var m=e[d];g.push(m.update(b))}return g};return a}();f.Binding=function(){function a(b,a,d,e,g){this.view=b;this.el=a;this.type=d;this.keypath=e;this.options=null!=g?g:{};this.update=h(this.update,this);this.unbind=h(this.unbind,this);this.bind=h(this.bind,this);this.publish=h(this.publish,this);this.sync=h(this.sync,this);this.set=h(this.set,this);this.eventHandler=h(this.eventHandler,this);this.formattedValue=h(this.formattedValue,this);this.setBinder=h(this.setBinder,this);this.formatters=
this.options.formatters||[];this.dependencies=[];this.model=void 0;this.setBinder()}a.prototype.setBinder=function(){var b;if(!(this.binder=this.view.binders[this.type])){var a=this.view.binders;for(b in a){var d=a[b];if("*"!==b&&-1!==b.indexOf("*")){var e=new RegExp("^"+b.replace("*",".+")+"$");e.test(this.type)&&(this.binder=d,this.args=(new RegExp("^"+b.replace("*","(.+)")+"$")).exec(this.type),this.args.shift())}}}this.binder||(this.binder=this.view.binders["*"]);if(this.binder instanceof Function)return this.binder=
{routine:this.binder}};a.prototype.formattedValue=function(b){var a;var d=this.formatters;var e=0;for(a=d.length;e<a;e++){var g=d[e];var m=g.split(/\s+/);g=m.shift();g=this.view.formatters[g];(null!=g?g.read:void 0)instanceof Function?b=g.read.apply(g,[b].concat(y.call(m))):g instanceof Function&&(b=g.apply(null,[b].concat(y.call(m))))}return b};a.prototype.eventHandler=function(b){var a;var d=(a=this).view.config.handler;return function(c){return d.call(b,this,c,a)}};a.prototype.set=function(b){var a;
b=b instanceof Function&&!this.binder["function"]?this.formattedValue(b.call(this.model)):this.formattedValue(b);return null!=(a=this.binder.routine)?a.call(this,this.el,b):void 0};a.prototype.sync=function(){var a,c;if(this.model!==this.observer.target){var d=this.dependencies;var e=0;for(a=d.length;e<a;e++){var g=d[e];g.unobserve()}this.dependencies=[];if(null!=(this.model=this.observer.target)&&null!=(c=this.options.dependencies)&&c.length)for(d=this.options.dependencies,e=0,a=d.length;e<a;e++)g=
d[e],g=new f.Observer(this.view,this.model,g,this.sync),this.dependencies.push(g)}return this.set(this.observer.value())};a.prototype.publish=function(){var a,c,d;var e=f.Util.getInputValue(this.el);var g=this.formatters.slice(0).reverse();var m=0;for(a=g.length;m<a;m++){var l=g[m];l=l.split(/\s+/);var k=l.shift();null!=(c=this.view.formatters[k])&&c.publish&&(e=(d=this.view.formatters[k]).publish.apply(d,[e].concat(y.call(l))))}return this.observer.publish(e)};a.prototype.bind=function(){var a,c;
null!=(a=this.binder.bind)&&a.call(this,this.el);this.observer=new f.Observer(this.view,this.view.models,this.keypath,this.sync);this.model=this.observer.target;if(null!=this.model&&null!=(c=this.options.dependencies)&&c.length){var d=this.options.dependencies;a=0;for(c=d.length;a<c;a++){var e=d[a];e=new f.Observer(this.view,this.model,e,this.sync);this.dependencies.push(e)}}if(this.view.config.preloadData)return this.sync()};a.prototype.unbind=function(){var a,c;null!=(a=this.binder.unbind)&&a.call(this,
this.el);this.observer.unobserve();var d=this.dependencies;var e=0;for(c=d.length;e<c;e++)a=d[e],a.unobserve();return this.dependencies=[]};a.prototype.update=function(a){var b;null==a&&(a={});this.model=this.observer.target;this.unbind();null!=(b=this.binder.update)&&b.call(this,a);return this.bind()};return a}();f.ComponentBinding=function(a){function b(a,b,e){var c;this.view=a;this.el=b;this.type=e;this.unbind=h(this.unbind,this);this.bind=h(this.bind,this);this.update=h(this.update,this);this.locals=
h(this.locals,this);this.component=f.components[this.type];this.attributes={};this.inflections={};var d=this.el.attributes||[];b=0;for(e=d.length;b<e;b++)a=d[b],(c=a.name,0<=q.call(this.component.attributes,c))?this.attributes[a.name]=a.value:this.inflections[a.name]=a.value}z(b,a);b.prototype.sync=function(){};b.prototype.locals=function(a){var b,c;null==a&&(a=this.view.models);var g={};var f=this.inflections;for(b in f){var l=f[b];var k=l.split(".");var h=0;for(c=k.length;h<c;h++)l=k[h],g[b]=(g[b]||
a)[l]}for(b in a)f=a[b],null==g[b]&&(g[b]=f);return g};b.prototype.update=function(a){var b;return null!=(b=this.componentView)?b.update(this.locals(a)):void 0};b.prototype.bind=function(){var a;if(null!=this.componentView)return null!=(a=this.componentView)?a.bind():void 0;a=this.component.build.call(this.attributes);(this.componentView=new f.View(a,this.locals(),this.view.options)).bind();return this.el.parentNode.replaceChild(a,this.el)};b.prototype.unbind=function(){var a;return null!=(a=this.componentView)?
a.unbind():void 0};return b}(f.Binding);f.TextBinding=function(a){function b(a,b,e,g,f){this.view=a;this.el=b;this.type=e;this.keypath=g;this.options=null!=f?f:{};this.sync=h(this.sync,this);this.formatters=this.options.formatters||[];this.dependencies=[]}z(b,a);b.prototype.binder={routine:function(a,b){return a.data=null!=b?b:""}};b.prototype.sync=function(){return b.__super__.sync.apply(this,arguments)};return b}(f.Binding);f.adapters["."]={id:"_rv",counter:0,weakmap:{},weakReference:function(a){if(!a.hasOwnProperty(this.id)){var b=
this.counter++;this.weakmap[b]={callbacks:{}};Object.defineProperty(a,this.id,{value:b})}return this.weakmap[a[this.id]]},stubFunction:function(a,b){var c=a[b];var d=this.weakReference(a);var e=this.weakmap;return a[b]=function(){var b,f,l,k;var h=c.apply(a,arguments);var v=d.pointers;for(b in v){var p=v[b];var q=null!=(l=null!=(k=e[b])?k.callbacks[p]:void 0)?l:[];var t=0;for(f=q.length;t<f;t++)p=q[t],p()}return h}},observeMutations:function(a,b,c){var d,e;if(Array.isArray(a)){var g=this.weakReference(a);
if(null==g.pointers){g.pointers={};var f="push pop shift unshift sort reverse splice".split(" ");var l=0;for(e=f.length;l<e;l++){var k=f[l];this.stubFunction(a,k)}}null==(d=g.pointers)[b]&&(d[b]=[]);if(0>q.call(g.pointers[b],c))return g.pointers[b].push(c)}},unobserveMutations:function(a,b,c){var d,e;if(Array.isArray(a&&null!=a[this.id])&&(d=null!=(e=this.weakReference(a).pointers)?e[b]:void 0)&&(a=d.indexOf(c),0<=a))return d.splice(a,1)},subscribe:function(a,b,c){var d=this.weakReference(a).callbacks;
if(null==d[b]){d[b]=[];var e=a[b];Object.defineProperty(a,b,{enumerable:!0,get:function(){return e},set:function(g){return function(f){var m;if(f!==e){e=f;var k=d[b].slice();var h=0;for(m=k.length;h<m;h++)c=k[h],0<=q.call(d[b],c)&&c();return g.observeMutations(f,a[g.id],b)}}}(this)})}0>q.call(d[b],c)&&d[b].push(c);return this.observeMutations(a[b],a[this.id],b)},unsubscribe:function(a,b,c){var d=this.weakmap[a[this.id]].callbacks[b];c=d.indexOf(c);0<=c&&d.splice(c,1);return this.unobserveMutations(a[b],
a[this.id],b)},read:function(a,b){return a[b]},publish:function(a,b,c){return a[b]=c}};f.binders.text=function(a,b){return null!=a.textContent?a.textContent=null!=b?b:"":a.innerText=null!=b?b:""};f.binders.html=function(a,b){return a.innerHTML=null!=b?b:""};f.binders.show=function(a,b){return a.style.display=b?"":"none"};f.binders.hide=function(a,b){return a.style.display=b?"none":""};f.binders.enabled=function(a,b){return a.disabled=!b};f.binders.disabled=function(a,b){return a.disabled=!!b};f.binders.checked=
{publishes:!0,bind:function(a){return f.Util.bindEvent(a,"change",this.publish)},unbind:function(a){return f.Util.unbindEvent(a,"change",this.publish)},routine:function(a,b){var c;return"radio"===a.type?a.checked=(null!=(c=a.value)?c.toString():void 0)===(null!=b?b.toString():void 0):a.checked=!!b}};f.binders.unchecked={publishes:!0,bind:function(a){return f.Util.bindEvent(a,"change",this.publish)},unbind:function(a){return f.Util.unbindEvent(a,"change",this.publish)},routine:function(a,b){var c;
return"radio"===a.type?a.checked=(null!=(c=a.value)?c.toString():void 0)!==(null!=b?b.toString():void 0):a.checked=!b}};f.binders.value={publishes:!0,bind:function(a){return f.Util.bindEvent(a,"change",this.publish)},unbind:function(a){return f.Util.unbindEvent(a,"change",this.publish)},routine:function(a,b){var c,d,e;if(null!=window.jQuery){if(a=jQuery(a),(null!=b?b.toString():void 0)!==(null!=(c=a.val())?c.toString():void 0))return a.val(null!=b?b:"")}else if("select-multiple"===a.type){if(null!=
b){var g=[];var f=0;for(d=a.length;f<d;f++)c=a[f],g.push(c.selected=(e=c.value,0<=q.call(b,e)));return g}}else if((null!=b?b.toString():void 0)!==(null!=(f=a.value)?f.toString():void 0))return a.value=null!=b?b:""}};f.binders["if"]={block:!0,bind:function(a){if(null==this.marker){var b=[this.view.config.prefix,this.type].join("-").replace("--","-");var c=a.getAttribute(b);this.marker=document.createComment(" rivets: "+this.type+" "+c+" ");a.removeAttribute(b);a.parentNode.insertBefore(this.marker,
a);return a.parentNode.removeChild(a)}},unbind:function(){var a;return null!=(a=this.nested)?a.unbind():void 0},routine:function(a,b){if(!!b===(null==this.nested)){if(b){b={};var c=this.view.models;for(e in c){var d=c[e];b[e]=d}var e={binders:this.view.options.binders,formatters:this.view.options.formatters,adapters:this.view.options.adapters,config:this.view.options.config};(this.nested=new f.View(a,b,e)).bind();return this.marker.parentNode.insertBefore(a,this.marker.nextSibling)}a.parentNode.removeChild(a);
this.nested.unbind();return delete this.nested}},update:function(a){var b;return null!=(b=this.nested)?b.update(a):void 0}};f.binders.unless={block:!0,bind:function(a){return f.binders["if"].bind.call(this,a)},unbind:function(){return f.binders["if"].unbind.call(this)},routine:function(a,b){return f.binders["if"].routine.call(this,a,!b)},update:function(a){return f.binders["if"].update.call(this,a)}};f.binders["on-*"]={"function":!0,unbind:function(a){if(this.handler)return f.Util.unbindEvent(a,this.args[0],
this.handler)},routine:function(a,b){this.handler&&f.Util.unbindEvent(a,this.args[0],this.handler);return f.Util.bindEvent(a,this.args[0],this.handler=this.eventHandler(b))}};f.binders["each-*"]={block:!0,bind:function(a){var b;if(null==this.marker){var c=[this.view.config.prefix,this.type].join("-").replace("--","-");this.marker=document.createComment(" rivets: "+this.type+" ");this.iterated=[];a.removeAttribute(c);a.parentNode.insertBefore(this.marker,a);a.parentNode.removeChild(a)}else{var d=this.iterated;
c=0;for(b=d.length;c<b;c++)a=d[c],a.bind()}},unbind:function(a){var b;if(null!=this.iterated){var c=this.iterated;var d=[];var e=0;for(b=c.length;e<b;e++)a=c[e],d.push(a.unbind());return d}},routine:function(a,b){var c;var d=this.args[0];b=b||[];if(this.iterated.length>b.length){var e=Array(this.iterated.length-b.length);var g=0;for(e=e.length;g<e;g++){var h=this.iterated.pop();h.unbind();this.marker.parentNode.removeChild(h.els[0])}}var l=g=0;for(e=b.length;g<e;l=++g){var k=b[l];h={index:l};h[d]=
k;if(null==this.iterated[l]){l=this.view.models;for(p in l)k=l[p],null==h[p]&&(h[p]=k);k=this.iterated.length?this.iterated[this.iterated.length-1].els[0]:this.marker;l={binders:this.view.options.binders,formatters:this.view.options.formatters,adapters:this.view.options.adapters,config:{}};var r=this.view.options.config;for(c in r){var q=r[c];l.config[c]=q}l.config.preloadData=!0;q=a.cloneNode(!0);h=new f.View(q,h,l);h.bind();this.iterated.push(h);this.marker.parentNode.insertBefore(q,k.nextSibling)}else this.iterated[l].models[d]!==
k&&this.iterated[l].update(h)}if("OPTION"===a.nodeName){var p=this.view.bindings;d=[];b=0;for(c=p.length;b<c;b++)a=p[b],a.el===this.marker.parentNode&&"value"===a.type?d.push(a.sync()):d.push(void 0);return d}},update:function(a){var b={};for(f in a){var c=a[f];f!==this.args[0]&&(b[f]=c)}var d=this.iterated;var e=[];var f=0;for(c=d.length;f<c;f++)a=d[f],e.push(a.update(b));return e}};f.binders["class-*"]=function(a,b){var c=" "+a.className+" ";if(!b===(-1!==c.indexOf(" "+this.args[0]+" ")))return a.className=
b?""+a.className+" "+this.args[0]:c.replace(" "+this.args[0]+" "," ").trim()};f.binders["*"]=function(a,b){return null!=b?a.setAttribute(this.type,b):a.removeAttribute(this.type)};f.factory=function(a){a._=f;a.binders=f.binders;a.components=f.components;a.formatters=f.formatters;a.adapters=f.adapters;a.config=f.config;a.configure=function(a){var b;null==a&&(a={});for(b in a){var d=a[b];f.config[b]=d}};return a.bind=function(a,c,d){null==c&&(c={});null==d&&(d={});a=new f.View(a,c,d);a.bind();return a}};
t={};f.factory(t);define("rivets",t)}).call(this);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-hipchat-emoticons-plugin:hipchat-emoticons-conf-frontend', location = 'data/DataManager.js' */
'use strict';define("confluence-hipchat-emoticons/data/DataManager",["ajs","jquery"],function(h,d){var e,b=[],c={},f=function(a){a&&(c={},a.forEach(function(a){c[a.shortcut]=a}))},g=function(){return d.ajax({url:h.contextPath()+"/rest/emoticons/1.0/",type:"get",dataType:"json",cache:!1}).then(function(a){localStorage.setItem("hipchat.emoticons.data",JSON.stringify(a));b=a.hipchat;f(b);return d.Deferred().resolve(a)})};return{initializeData:function(){var a=JSON.parse(localStorage.getItem("hipchat.emoticons.data"));
a&&(b=a.hipchat,f(b));e=g()},loadRemoteData:g,getAuthoritativeEmoticons:function(){return e},getHipChatEmoticon:function(a){return c[a]}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-hipchat-emoticons-plugin:hipchat-emoticons-conf-frontend', location = 'insertion/EmoticonInserter.js' */
'use strict';define("confluence-hipchat-emoticons/insertion/EmoticonInserter",["ajs"],function(e){return{insertEmoticon:function(a,f){var b=e.Rte.getEditor();if(f){var c=$(b.getContainer()),d=null;if(c.parents("#comments-section").length)d="comment";else if(c.parents(".ic-comment-container").length)d="inlinecomment";else if(c.parents("#editpageform").length||c.parents("#createpageform").length)d=c.parents(".blogpost").length?"blog":"page";d&&e.trigger("analyticsEvent",{name:"confluence.hipchat.emoticons.insert."+
f,data:{shortcut:a.shortcut,source:d}})}a=b.dom.createHTML("img",a.name?{src:a.url,alt:a.name+" "+a.shortcut,title:a.name+" "+a.shortcut,border:0,"class":"emoticon emoticon-"+a.name,"data-emoticon-name":a.name}:{src:a.url,alt:"("+a.shortcut+")",title:"("+a.shortcut+")",border:0,"class":"emoticon emoticon-"+a.shortcut,"data-hipchat-emoticon":a.shortcut});b.execCommand("mceInsertContent",!1,a,{skip_undo:!0});b.undoManager.beforeChange();b.undoManager.add()}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-hipchat-emoticons-plugin:hipchat-emoticons-conf-frontend', location = 'completion/CompletionManager.js' */
'use strict';define("confluence-hipchat-emoticons/completion/CompletionManager","ajs jquery underscore confluence-hipchat-emoticons/completion/Utilities confluence-hipchat-emoticons/data/DataManager confluence-hipchat-emoticons/insertion/EmoticonInserter".split(" "),function(f,h,q,g,k,l){function m(c,a,b){if(!a)throw Error("text node is null");3!=a.nodeType&&(a=a.childNodes[b-1],b=a.length);for(;a&&3==a.nodeType;a=a.previousSibling){-1==b&&(b=a.nodeValue.length);if(b>c)return{container:a,offset:b-
c};if(b==c){b=0;for(c=a.parentNode;a.previousSibling;)a=a.previousSibling,b++;return{container:c,offset:b}}c-=b;b=-1}return null}var n=/\(([A-Za-z0-9]+)$/,p=function(c){if(41===g.getCharCode(c)){var a=f.Rte.getEditor(),b=g.getTextFromPreviousSiblingTextNodes(a.selection.getRng(!0));if(b=n.exec(b))if(b=b[1],b=k.getHipChatEmoticon(b)){a.execCommand("mceInsertContent",!1,")");a.undoManager.beforeChange();a.undoManager.add();var d=a.selection.getRng(!0);g.getTextFromPreviousSiblingTextNodes(d);var e=
m(b.shortcut.length+1+1,d.commonAncestorContainer,d.startOffset);d.setStart(e.container,e.offset);e=h(d.commonAncestorContainer);a.selection.setRng(d);e.closest(".wysiwyg-macro-body").length&&d.toString()==e.text()?(e[0].innerHTML="\x3cbr\x3e",a.selection.select(e[0].childNodes[0]),a.selection.collapse(!0)):a.execCommand("delete",!1,{},{skip_undo:!0});l.insertEmoticon(b,"autoformat");tinymce.dom.Event.cancel(c);c=!1}else c=!0;else c=!0;return c}};return{start:function(){f.Rte.BootstrapManager.addOnInitCallback(function(){f.Rte.getEditor().on("keypress",
p,!0)})}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-hipchat-emoticons-plugin:hipchat-emoticons-conf-frontend', location = 'completion/Utilities.js' */
'use strict';define("confluence-hipchat-emoticons/completion/Utilities",["jquery"],function(d){return{getTextFromPreviousSiblingTextNodes:function(b){if(!b||!b.collapsed)throw Error("range is null or not collapsed");var a=b.startContainer;var c=b.startOffset;if(1==a.nodeType&&0<c)if(a=a.childNodes[b.startOffset-1],3==a.nodeType)c=a.nodeValue.length;else return"";else if(3!=a.nodeType)return"";b=a.nodeValue.substring(0,c);for(a=a.previousSibling;a&&3==a.nodeType;a=a.previousSibling)b=a.nodeValue+b;
return b},getCharCode:function(b){return d.browser.msie?b.keyCode:b.which}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-hipchat-emoticons-plugin:hipchat-emoticons-conf-frontend', location = 'dialog/DialogEmoticon.js' */
'use strict';define("confluence-hipchat-emoticons/dialog/DialogEmoticon",["underscore"],function(b){var c=function(a){this.name=a.name;this.shortcut=a.shortcut;this.fullShortcut=a.fullShortcut;this.url=a.url;this.onClick=a.onClick&&b.bind(a.onClick,this,this);this.visible=!0;this._initializeCaption(a)};b.extend(c.prototype,{onKeypress:function(a){13==a.keyCode&&this.click()},_initializeCaption:function(a){a.selectedText?(this.selectedCaptionPortion=a.selectedText,a=this.fullShortcut.indexOf(this.selectedCaptionPortion),
this.leftCaptionPortion=this.fullShortcut.substring(0,a),this.rightCaptionPortion=this.fullShortcut.substring(a+this.selectedCaptionPortion.length)):(this.leftCaptionPortion=this.fullShortcut,this.rightCaptionPortion=this.selectedCaptionPortion="")}});return c});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-hipchat-emoticons-plugin:hipchat-emoticons-conf-frontend', location = 'dialog/EmoticonDialog.js' */
'use strict';define("confluence-hipchat-emoticons/dialog/EmoticonDialog","ajs jquery rivets underscore confluence-hipchat-emoticons/dialog/DialogEmoticon confluence-hipchat-emoticons/dialog/EmoticonDialogModel confluence-hipchat-emoticons/dialog/Templates".split(" "),function(c,d,e,f,a,g,h){a=function(){var a=new g({dialog:this}),b=d(h.emoticonDialog({auiVersion:parseInt(c.version)}))[0];document.body.appendChild(b);this._dialog=c.dialog2(b);e.bind(b,a);d(b.querySelector(".loading-spinner")).spin("large");
this._dialog.on("show",function(){a.update(a.filterText="")})};f.extend(a.prototype,{show:function(){this._dialog.show()},close:function(){this._dialog.hide()}});return a});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-hipchat-emoticons-plugin:hipchat-emoticons-conf-frontend', location = 'dialog/EmoticonDialogModel.js' */
'use strict';define("confluence-hipchat-emoticons/dialog/EmoticonDialogModel",["ajs","underscore","confluence-hipchat-emoticons/data/DataManager","confluence-hipchat-emoticons/insertion/EmoticonInserter","confluence-hipchat-emoticons/dialog/DialogEmoticon"],function(d,h,e,f,g){var c=function(b){var a=this;this.close=function(){b.dialog.close()};this.onFilterSubmit=function(a){return a.preventDefault()};this.onFilterUpdate=function(){a.update(this.value)};var c=function(b){f.insertEmoticon(b);a.close()},
k=function(b){f.insertEmoticon(b,"gallery");a.close()};this.isAdmin=d.Meta.getBoolean("is-admin");this.isHipChatIntegrated=!1;this.loadEmoticons=function(){var b=a.isError?e.loadRemoteData():e.getAuthoritativeEmoticons();a.isLoading=!0;a.isError=!1;a.showEmoticons=!1;a.showHipChatEmoticons=!1;b.then(function(b){a.isLoading=!1;a.hipchatEmoticons=b.hipchat.map(function(a){return new g({shortcut:a.shortcut,fullShortcut:"("+a.shortcut+")",url:a.url,onClick:k})});a.confluenceEmoticons=b.confluence.map(function(a){return new g({name:a.name,
shortcut:a.shortcut,fullShortcut:a.shortcut,url:a.url,onClick:c})});a.showEmoticons=!0;a.showHipChatEmoticons=!!d.Meta.get("remote-user");a.allEmoticons=h.union(a.confluenceEmoticons,a.hipchatEmoticons);a.isHipChatIntegrated=b.hipchatIntegrated;setTimeout(function(){document.querySelector("#hipchat-emoticons-filter").focus();document.querySelector("#hipchat-emoticons-filter").select()},100)}).fail(function(){a.isError=!0;a.isLoading=!1})}.bind(this);this.loadEmoticons()};c.prototype.update=function(b){this._previousFilterText!==
b&&(this._previousFilterText=b,(this.allEmoticons||[]).forEach(function(a){a.visible=0<=a.fullShortcut.indexOf(b)}))};return c});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-hipchat-emoticons-plugin:hipchat-emoticons-conf-frontend', location = 'dialog/templates.soy' */
// This file was automatically generated from templates.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.HipChatEmoticons.Dialog.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.HipChatEmoticons == 'undefined') { Confluence.Templates.HipChatEmoticons = {}; }
if (typeof Confluence.Templates.HipChatEmoticons.Dialog == 'undefined') { Confluence.Templates.HipChatEmoticons.Dialog = {}; }


Confluence.Templates.HipChatEmoticons.Dialog.emoticonDialog = function(opt_data, opt_ignored) {
  return '<section role="dialog" id="insert-hipchat-emoticon-dialog" class="aui-layer aui-dialog2 aui-dialog2-medium" aria-hidden="true"><header class="aui-dialog2-header"><h2 class="aui-dialog2-header-main">' + soy.$$escapeHtml('Insert emoticon') + '</h2><div class="aui-dialog2-header-secondary"><form class="aui" action="#"><input id="hipchat-emoticons-filter" class="text medium-field" type="search" rv-show="showEmoticons" rv-value="filterText" rv-on-keyup="onFilterUpdate" rv-on-submit="onFilterSubmit" placeholder="' + soy.$$escapeHtml('Search') + '"></form></div>' + ((opt_data.auiVersion < 9) ? '<a class="aui-dialog2-header-close"><span class="aui-icon aui-icon-small aui-iconfont-close-dialog">' + soy.$$escapeHtml('Cancel') + '</span></a>' : '<button class="aui-close-button" type="button" aria-label="' + soy.$$escapeHtml('Cancel') + '"></button>') + '</header><div class="aui-dialog2-content"><div class="emoticon-gallery"><div rv-show="isLoading" class="loading-spinner"></div><div rv-show="isError" class="error"><p><span class="aui-icon aui-icon-large aui-iconfont-error"></span></p><p>Oh dear, it seems we had some trouble loading your emoticons. Please click the button below to try loading them again.</p><p><button class="aui-button aui-button-primary" id="hipchat-emoticons-error-rety" rv-on-click="loadEmoticons">Retry</button></p></div><div rv-show="showEmoticons" class="emoticons-panel confluence-emoticons-panel"><h4 class="emoticons-panel-header">' + soy.$$escapeHtml('Confluence') + '</h4><hr>' + Confluence.Templates.HipChatEmoticons.Dialog.confluenceEmoticons(null) + '</div><div rv-show="showHipChatEmoticons" class="emoticons-panel hipchat-emoticons-panel"><h4 class="emoticons-panel-header">' + soy.$$escapeHtml('Hipchat') + '</h4><hr>' + Confluence.Templates.HipChatEmoticons.Dialog.hipchatEmoticons(null) + '<div rv-hide="isHipChatIntegrated" class="aui-message info"><span rv-show="isAdmin">' + soy.$$filterNoAutoescape(AJS.format('Hipchat emoticons are not available as Confluence is not integrated with Hipchat. {0}Click here{1} to integrate.','<a target="_blank" href="' + "" + '/plugins/servlet/hipchat/configure">','</a>')) + '</span><span rv-hide="isAdmin">' + soy.$$filterNoAutoescape('Hipchat emoticons are not available as Confluence is not integrated with Hipchat. Please contact your administrator for integration.') + '</span></div></div></div></div><footer class="aui-dialog2-footer"><div class="aui-dialog2-footer-actions"><button class="aui-button aui-button-link close-button" rv-on-click="close">' + soy.$$escapeHtml('Cancel') + '</button></div></footer></section>';
};
if (goog.DEBUG) {
  Confluence.Templates.HipChatEmoticons.Dialog.emoticonDialog.soyTemplateName = 'Confluence.Templates.HipChatEmoticons.Dialog.emoticonDialog';
}


Confluence.Templates.HipChatEmoticons.Dialog.confluenceEmoticons = function(opt_data, opt_ignored) {
  return '<div class="confluence-emoticons">' + Confluence.Templates.HipChatEmoticons.Dialog.genericEmoticonRepeater({modelDataAttribute: 'confluenceEmoticons'}) + '</div>';
};
if (goog.DEBUG) {
  Confluence.Templates.HipChatEmoticons.Dialog.confluenceEmoticons.soyTemplateName = 'Confluence.Templates.HipChatEmoticons.Dialog.confluenceEmoticons';
}


Confluence.Templates.HipChatEmoticons.Dialog.hipchatEmoticons = function(opt_data, opt_ignored) {
  return '<div class="hipchat-emoticons">' + Confluence.Templates.HipChatEmoticons.Dialog.genericEmoticonRepeater({modelDataAttribute: 'hipchatEmoticons'}) + '</div>';
};
if (goog.DEBUG) {
  Confluence.Templates.HipChatEmoticons.Dialog.hipchatEmoticons.soyTemplateName = 'Confluence.Templates.HipChatEmoticons.Dialog.hipchatEmoticons';
}


Confluence.Templates.HipChatEmoticons.Dialog.genericEmoticonRepeater = function(opt_data, opt_ignored) {
  return '<div rv-show="emoticon.visible" rv-each-emoticon="' + soy.$$escapeHtml(opt_data.modelDataAttribute) + '" class="gallery-item" rv-data-shortcut="emoticon.shortcut" rv-data-full-shortcut="emoticon.fullShortcut" rv-on-click="emoticon.onClick" rv-on-keydown="emoticon.onKeypress" tabindex="0"><img rv-src="emoticon.url"><br/><span class="caption"><span rv-text="emoticon.leftCaptionPortion"></span><strong rv-text="emoticon.selectedCaptionPortion"></strong><span rv-text="emoticon.rightCaptionPortion"></span></span></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.HipChatEmoticons.Dialog.genericEmoticonRepeater.soyTemplateName = 'Confluence.Templates.HipChatEmoticons.Dialog.genericEmoticonRepeater';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-hipchat-emoticons-plugin:hipchat-emoticons-conf-frontend', location = 'dialog/Templates.js' */
'use strict';define("confluence-hipchat-emoticons/dialog/Templates",function(){return window.Confluence.Templates.HipChatEmoticons.Dialog});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-hipchat-emoticons-plugin:hipchat-emoticons-conf-frontend', location = 'menu/MenuItemOverrider.js' */
'use strict';define("confluence-hipchat-emoticons/menu/MenuItemOverrider",["ajs","jquery","confluence-hipchat-emoticons/dialog/EmoticonDialog"],function(d,a,c){return{start:function(){var b=null;a(".content-emoticon").off("click").on("click",function(a){b||(b=new c);b.show();a.preventDefault()})}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-hipchat-emoticons-plugin:hipchat-emoticons-conf-frontend', location = 'hipchat-emoticons.js' */
'use strict';define("confluence-hipchat-emoticons",["jquery","confluence-hipchat-emoticons/completion/CompletionManager","confluence-hipchat-emoticons/data/DataManager","confluence-hipchat-emoticons/menu/MenuItemOverrider"],function(c,d,a,e){c(document).on("postPaste",function(b,d,a){b=c("img",a.node);b.data("hipchatEmoticon")&&b.removeClass("confluence-embedded-image confluence-external-resource")});return{start:function(){a.initializeData();d.start();e.start()}}});AJS.bind("init.rte",function(){require("confluence-hipchat-emoticons").start()});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.gadgets.embedded:gadget-core-resources', location = 'js/rpc.js' */
var gadgets=gadgets||{};gadgets.rpc=function(){var CALLBACK_NAME="__cb";var DEFAULT_NAME="";var FE_G2C_CHANNEL="__g2c_rpc";var FE_C2G_CHANNEL="__c2g_rpc";var services={};var iframePool=[];var relayUrl={};var useLegacyProtocol={};var authToken={};var callId=0;var callbacks={};var setup={};var sameDomain={};var params={};if(gadgets.util){params=gadgets.util.getUrlParameters()}authToken[".."]=params.rpctoken||params.ifpctok||0;function getRelayChannel(){return typeof window.postMessage==="function"?"wpm":typeof document.postMessage==="function"?"dpm":navigator.product==="Gecko"?"fe":"ifpc"}function setupChannel(){if(relayChannel==="dpm"||relayChannel==="wpm"){window.addEventListener("message",function(packet){try{if(packet&&packet.origin&&packet.origin!=="null"&&typeof packet.data==="string"){if(packet.origin===location.origin){process(gadgets.json.parse(packet.data))}else{AJS.$.get(AJS.contextPath()+"/rest/whitelist/1/check",{url:packet.origin}).done(function(result){if(result&&result.inbound&&result.inbound===true){process(gadgets.json.parse(packet.data))}else{if(AJS.debug){AJS.log("RPC: request rejected (bad origin): "+(packet&&packet.origin?packet.origin:"undefined origin"))}}}).fail(function(jqXHR,textStatus,errorThrown){AJS.log("RPC: REST "+textStatus,errorThrown)})}}else{if(AJS.debug){AJS.log("RPC: request rejected (bad origin): "+(packet&&packet.origin?packet.origin:"undefined origin"))}}}catch(e){if(AJS.debug){var origin=packet&&packet.origin?packet.origin:"undefined origin";AJS.log("Error processing gadget rpc message from '"+origin+"': "+e)}}},false)}}var relayChannel=getRelayChannel();setupChannel();services[DEFAULT_NAME]=function(){throw new Error("Unknown RPC service: "+this.s)};services[CALLBACK_NAME]=function(callbackId,result){var callback=callbacks[callbackId];if(callback){delete callbacks[callbackId];callback(result)}};function setupFrame(frameId){if(setup[frameId]){return }if(relayChannel==="fe"){try{var frame=document.getElementById(frameId);frame[FE_G2C_CHANNEL]=function(args){process(gadgets.json.parse(args))}}catch(e){}}setup[frameId]=true}function encodeLegacyData(args){var stringify=gadgets.json.stringify;var argsEscaped=[];for(var i=0,j=args.length;i<j;++i){argsEscaped.push(encodeURIComponent(stringify(args[i])))}return argsEscaped.join("&")}function process(rpc){if(rpc&&typeof rpc.s==="string"&&typeof rpc.f==="string"&&rpc.a instanceof Array){if(authToken[rpc.f]){if(authToken[rpc.f]!=rpc.t){if(AJS.debug){console.log("Invalid auth token received for operation: "+rpc.s)}return }}if(rpc.c){rpc.callback=function(result){gadgets.rpc.call(rpc.f,CALLBACK_NAME,null,rpc.c,result)}}var result=(services[rpc.s]||services[DEFAULT_NAME]).apply(rpc,rpc.a);if(rpc.c&&typeof result!="undefined"){gadgets.rpc.call(rpc.f,CALLBACK_NAME,null,rpc.c,result)}}}function callFrameElement(targetId,serviceName,from,rpcData,callArgs){try{if(from!=".."){var fe=window.frameElement;if(typeof fe[FE_G2C_CHANNEL]==="function"){if(typeof fe[FE_G2C_CHANNEL][FE_C2G_CHANNEL]!=="function"){fe[FE_G2C_CHANNEL][FE_C2G_CHANNEL]=function(args){process(gadgets.json.parse(args))}}fe[FE_G2C_CHANNEL](rpcData);return }}else{var frame=document.getElementById(targetId);if(typeof frame[FE_G2C_CHANNEL]==="function"&&typeof frame[FE_G2C_CHANNEL][FE_C2G_CHANNEL]==="function"){frame[FE_G2C_CHANNEL][FE_C2G_CHANNEL](rpcData);return }}}catch(e){}callIfpc(targetId,serviceName,from,rpcData,callArgs)}function callIfpc(targetId,serviceName,from,rpcData,callArgs){var relay=gadgets.rpc.getRelayUrl(targetId);if(!relay){throw new Error("No relay file assigned for IFPC")}var src=null;if(useLegacyProtocol[targetId]){src=[relay,"#",encodeLegacyData([from,callId,1,0,encodeLegacyData([from,serviceName,"","",from].concat(callArgs))])].join("")}else{src=[relay,"#",targetId,"&",from,"@",callId,"&1&0&",encodeURIComponent(rpcData)].join("")}emitInvisibleIframe(src)}function emitInvisibleIframe(src){var iframe;for(var i=iframePool.length-1;i>=0;--i){var ifr=iframePool[i];try{if(ifr&&(ifr.recyclable||ifr.readyState==="complete")){ifr.parentNode.removeChild(ifr);if(window.ActiveXObject){iframePool[i]=ifr=null;iframePool.splice(i,1)}else{ifr.recyclable=false;iframe=ifr;break}}}catch(e){}}if(!iframe){iframe=document.createElement("iframe");iframe.style.border=iframe.style.width=iframe.style.height="0px";iframe.style.visibility="hidden";iframe.style.position="absolute";iframe.onload=function(){this.recyclable=true};iframePool.push(iframe)}iframe.src=src;setTimeout(function(){document.body.appendChild(iframe)},0)}function callSameDomain(target,rpc){if(typeof sameDomain[target]==="undefined"){sameDomain[target]=false;var targetEl=null;if(target===".."){targetEl=parent}else{targetEl=frames[target]}try{sameDomain[target]=targetEl.gadgets.rpc.receiveSameDomain}catch(e){}}if(typeof sameDomain[target]==="function"){sameDomain[target](rpc);return true}return false}if(gadgets.config){function init(config){if(config.rpc.parentRelayUrl.substring(0,7)==="http://"){relayUrl[".."]=config.rpc.parentRelayUrl}else{var params=document.location.search.substring(0).split("&");var parentParam="";for(var i=0,param;param=params[i];++i){if(param.indexOf("parent=")===0){parentParam=decodeURIComponent(param.substring(7));break}}relayUrl[".."]=parentParam+config.rpc.parentRelayUrl}useLegacyProtocol[".."]=!!config.rpc.useLegacyProtocol}var requiredConfig={parentRelayUrl:gadgets.config.NonEmptyStringValidator};gadgets.config.register("rpc",requiredConfig,init)}return{register:function(serviceName,handler){if(serviceName==CALLBACK_NAME){throw new Error("Cannot overwrite callback service")}if(serviceName==DEFAULT_NAME){throw new Error("Cannot overwrite default service:"+" use registerDefault")}services[serviceName]=handler},unregister:function(serviceName){if(serviceName==CALLBACK_NAME){throw new Error("Cannot delete callback service")}if(serviceName==DEFAULT_NAME){throw new Error("Cannot delete default service:"+" use unregisterDefault")}delete services[serviceName]},registerDefault:function(handler){services[""]=handler},unregisterDefault:function(){delete services[""]},call:function(targetId,serviceName,callback,var_args){++callId;targetId=targetId||"..";if(callback){callbacks[callId]=callback}var from="..";if(targetId===".."){from=window.name}var rpc={s:serviceName,f:from,c:callback?callId:0,a:Array.prototype.slice.call(arguments,3),t:authToken[targetId]};if(callSameDomain(targetId,rpc)){return }var rpcData=gadgets.json.stringify(rpc);var channelType=relayChannel;if(useLegacyProtocol[targetId]){channelType="ifpc"}switch(channelType){case"dpm":var targetDoc=targetId===".."?parent.document:frames[targetId].document;targetDoc.postMessage(rpcData);break;case"wpm":var targetWin=targetId===".."?parent:frames[targetId];targetWin.postMessage(rpcData,relayUrl[targetId]);break;case"fe":callFrameElement(targetId,serviceName,from,rpcData,rpc.a);break;default:callIfpc(targetId,serviceName,from,rpcData,rpc.a);break}},getRelayUrl:function(targetId){return relayUrl[targetId]},setRelayUrl:function(targetId,url,opt_useLegacy){relayUrl[targetId]=url;useLegacyProtocol[targetId]=!!opt_useLegacy},setAuthToken:function(targetId,token){authToken[targetId]=token;setupFrame(targetId)},getRelayChannel:function(){return relayChannel},receive:function(fragment){if(fragment.length>4){process(gadgets.json.parse(decodeURIComponent(fragment[fragment.length-1])))}},receiveSameDomain:function(rpc){rpc.a=Array.prototype.slice.call(rpc.a);window.setTimeout(function(){process(rpc)},0)}}}();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.gadgets.embedded:gadget-core-resources', location = 'js/util.js' */
Function.prototype.inherits=function(parentCtor){function tempCtor(){}tempCtor.prototype=parentCtor.prototype;this.superClass_=parentCtor.prototype;this.prototype=new tempCtor();this.prototype.constructor=this};
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.gadgets.embedded:gadget-core-resources', location = 'js/json.js' */
var gadgets=gadgets||{};gadgets.json=function(){function f(n){return n<10?"0"+n:n}Date.prototype.toJSON=function(){return[this.getUTCFullYear(),"-",f(this.getUTCMonth()+1),"-",f(this.getUTCDate()),"T",f(this.getUTCHours()),":",f(this.getUTCMinutes()),":",f(this.getUTCSeconds()),"Z"].join("")};var m={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};function stringify(value){var a,i,k,l,r=/["\\\x00-\x1f\x7f-\x9f]/g,v;switch(typeof value){case"string":return r.test(value)?'"'+value.replace(r,function(a){var c=m[a];if(c){return c}c=a.charCodeAt();return"\\u00"+Math.floor(c/16).toString(16)+(c%16).toString(16)})+'"':'"'+value+'"';case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}a=[];if(typeof value.length==="number"&&!(value.propertyIsEnumerable("length"))){l=value.length;for(i=0;i<l;i+=1){a.push(stringify(value[i])||"null")}return"["+a.join(",")+"]"}for(k in value){if(value.hasOwnProperty(k)){if(typeof k==="string"){v=stringify(value[k]);if(v){a.push(stringify(k)+":"+v)}}}}return"{"+a.join(",")+"}"}}return{stringify:stringify,parse:function(text){if(/^[\],:{}\s]*$/.test(text.replace(/\\["\\\/b-u]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){return eval("("+text+")")}return false}}}();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.gadgets.embedded:gadget-core-resources', location = 'js/gadgets-core.js' */
var gadgets=gadgets||{};gadgets.error={};gadgets.error.SUBCLASS_RESPONSIBILITY="subclass responsibility";gadgets.error.TO_BE_DONE="to be done";gadgets.log=function(message){if(window.console&&console.log){console.log(message)}else{var logEntry=document.createElement("div");logEntry.className="gadgets-log-entry";logEntry.innerHTML=message;document.body.appendChild(logEntry)}};gadgets.Extensible=function(){};gadgets.Extensible.prototype.setDependencies=function(dependencies){for(var p in dependencies){this[p]=dependencies[p]}};gadgets.Extensible.prototype.getDependencies=function(name){return this[name]};gadgets.UserPrefStore=function(){};gadgets.UserPrefStore.prototype.getPrefs=function(gadget){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.UserPrefStore.prototype.savePrefs=function(gadget){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.DefaultUserPrefStore=function(){gadgets.UserPrefStore.call(this)};gadgets.DefaultUserPrefStore.inherits(gadgets.UserPrefStore);gadgets.DefaultUserPrefStore.prototype.getPrefs=function(gadget){};gadgets.DefaultUserPrefStore.prototype.savePrefs=function(gadget){};gadgets.GadgetService=function(){};gadgets.GadgetService.prototype.setHeight=function(elementId,height){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.GadgetService.prototype.setTitle=function(gadget,title){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.GadgetService.prototype.setUserPref=function(id){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.IfrGadgetService=function(){gadgets.GadgetService.call(this);var service=this;gadgets.rpc.register("resize_iframe",function(){service.setHeight.apply(this,arguments)});gadgets.rpc.register("set_pref",function(){service.setUserPref.apply(this,arguments)});gadgets.rpc.register("set_title",function(){service.setTitle.apply(this,arguments)});gadgets.rpc.register("requestNavigateTo",function(){service.requestNavigateTo.apply(this,arguments)})};gadgets.IfrGadgetService.inherits(gadgets.GadgetService);gadgets.IfrGadgetService.prototype.setHeight=function(height){if(height>gadgets.container.maxheight_){height=gadgets.container.maxheight_}var element=document.getElementById(this.f);if(element){element.style.height=height+"px"}};gadgets.IfrGadgetService.prototype.requestNavigateTo=function(view,opt_params){var id=this.getGadgetIdFromModuleId(this.f);var url=this.getUrlForView(view);if(opt_params){var paramStr=JSON.stringify(opt_params);if(paramStr.length>0){url+="&appParams="+encodeURIComponent(paramStr)}}if(url&&document.location.href.indexOf(url)==-1){document.location.href=url}};gadgets.IfrGadgetService.prototype.getUrlForView=function(view){if(view==="canvas"){return"/canvas"}else{if(view==="profile"){return"/profile"}else{return null}}};gadgets.IfrGadgetService.prototype.getGadgetIdFromModuleId=function(moduleId){return parseInt(moduleId.match(/_([0-9]+)$/)[1],10)};gadgets.LayoutManager=function(){};gadgets.LayoutManager.prototype.getGadgetChrome=function(gadget){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.StaticLayoutManager=function(){gadgets.LayoutManager.call(this)};gadgets.StaticLayoutManager.inherits(gadgets.LayoutManager);gadgets.StaticLayoutManager.prototype.setGadgetChromeIds=function(gadgetChromeIds){this.gadgetChromeIds_=gadgetChromeIds};gadgets.StaticLayoutManager.prototype.getGadgetChrome=function(gadget){var chromeId=this.gadgetChromeIds_[gadget.id];return chromeId?document.getElementById(chromeId):null};gadgets.FloatLeftLayoutManager=function(layoutRootId){gadgets.LayoutManager.call(this);this.layoutRootId_=layoutRootId};gadgets.FloatLeftLayoutManager.inherits(gadgets.LayoutManager);gadgets.FloatLeftLayoutManager.prototype.getGadgetChrome=function(gadget){var layoutRoot=document.getElementById(this.layoutRootId_);if(layoutRoot){var chrome=document.createElement("div");chrome.className="gadgets-gadget-chrome";chrome.style.cssFloat="left";layoutRoot.appendChild(chrome);return chrome}else{return null}};
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.gadgets:macro-browser-for-gadgetsplugin', location = 'script/gadget-macro-browser.js' */
AJS.toInit(function(l){AJS.MacroBrowser.setMacroJsOverride("gadget",{postPreview:function(b,c){b=b.contentWindow.AJS;for(var a={},d=l("#macro-param-div-preferences input").val().split("\x26"),e=0,f=d.length;e<f;e++){var g=d[e].split("\x3d");try{a[decodeURI(g[0])]=decodeURI(g[1])}catch(m){}}c.needsConfig&&b&&!a.isConfigured&&(c=l("#macro-browser-dialog .dialog-button-panel .ok"),l("#save-warning-span").addClass("gadget-not-configured-warning").text("Please complete the configuration in the preview area first").removeClass("hidden"),
c.prop("disabled",!0))},beforeParamsSet:function(b,c){var a=b.preferences;if(!c&&a){c=a.split("\x26");a=0;for(var d=c.length;a<d;a++){var e=c[a].split("\x3d");b[decodeURI(e[0])]=decodeURI(e[1])}}return b},updateMacroParametersForPreview:function(b){b.forceWrite=!0;return b},manipulateMarkup:function(b){if(AJS.MacroBrowser.gadgetPrefsChanged){b=top.document.getElementById("macro-insert-container");b=l("#macro-param-div-preferences input",b);var c="",a;for(a in AJS.MacroBrowser.gadgetPrefs)0!=c.length&&
(c+="\x26"),c=c+encodeURI(a)+"\x3d"+encodeURI(AJS.MacroBrowser.gadgetPrefs[a]);b.val(c)}},getMacroDetailsFromSelectedMacro:function(b,c){for(var a=c.params.url,d=0,e=b.length;d<e;d++){var f=b[d];if(f.macroName===c.name&&f.gadgetUrl===a)return f}},beforeParamsRetrieved:function(b,c,a){var d="";if(c.nonHiddenUserPrefs){var e=!0,f={},g=b.preferences;if(g){g=g.split("\x26");for(var m=0,p=g.length;m<p;m++){var n=g[m].split("\x3d"),q=decodeURI(n[0]);n=decodeURI(n[1]);f[q]=n}}for(var h in a)f[h]=a[h];for(var k in f){a:{a=
c.formDetails.parameters;for(h=0;h<a.length;h++)if(a[h].name==k){a=f[k]==a[h].defaultValue;break a}AJS.log("Unable to find matching param for "+k);a=!1}a||(e||(d+="\x26"),e=!1,d=d+encodeURI(k)+"\x3d"+encodeURI(f[k]))}b.preferences=d}return b}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-view-file-macro:view-file-macro-editor-resources', location = 'templates/view-file-macro-editor.soy' */
// This file was automatically generated from view-file-macro-editor.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.ViewFileMacro.Templates.Editor.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.ViewFileMacro == 'undefined') { Confluence.ViewFileMacro = {}; }
if (typeof Confluence.ViewFileMacro.Templates == 'undefined') { Confluence.ViewFileMacro.Templates = {}; }
if (typeof Confluence.ViewFileMacro.Templates.Editor == 'undefined') { Confluence.ViewFileMacro.Templates.Editor = {}; }


Confluence.ViewFileMacro.Templates.Editor.viewFilePropertyPanelHeader = function(opt_data, opt_ignored) {
  return '<div class="view-file-property-panel-header"><span class="file-name"><span class="aui-icon aui-icon-small ' + soy.$$escapeHtml(opt_data.fileIcon) + '"></span>' + soy.$$escapeHtml(opt_data.fileName) + '</span></div>';
};
if (goog.DEBUG) {
  Confluence.ViewFileMacro.Templates.Editor.viewFilePropertyPanelHeader.soyTemplateName = 'Confluence.ViewFileMacro.Templates.Editor.viewFilePropertyPanelHeader';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-view-file-macro:view-file-macro-editor-resources', location = '/js/components/view-file-macro-properties-panel.js' */
define("vfm/components/view-file-macro-properties-panel","jquery underscore ajs confluence/legacy confluence/jsUri tinymce vfm/view-file-macro-utils".split(" "),function(h,m,e,r,x,l,n){function y(a,d){var b=m.find(Object.keys(p),function(z){return p[z]===d});if(b)for(var c=0,f=a.length;c<f;c++){var g=a[c],k=g.className.replace(" active","");-1!==k.indexOf("macro-property-panel-"+b)&&(k+=" active");g.className=k}}function A(a){var d=m.reject(a,function(c){return-1<c.className.indexOf("macro-placeholder-property-panel-edit-button")||
-1<c.className.indexOf("macro-placeholder-property-panel-remove-button")});a.splice(0,a.length);for(var b=0;b<d.length;b++)a.push(d[b])}function t(a,d){a=new x(a);""!==a.getQueryParamValue("height")&&a.replaceQueryParam("height",d);return a.toString()}function u(a){a=a.attr("data-macro-parameters");for(var d=[],b="",c=0;c<a.length;c++){var f=a[c];"\\"===f?(b+=f,c+1!==a.length&&(b+=a[++c])):"|"===f?(d.push(b),b=""):b+=f}d.push(b);return d}function v(a,d){a=u(a);return(a=m.find(a,function(b){return 0<=
b.indexOf(d+"\x3d")}))?a.split("\x3d")[1]:null}function q(a,d){if(-1===h(a).attr("class").indexOf("active")){e.Confluence.PropertyPanel.destroy();var b=Object.keys(p),c=h(a).attr("class");for(a=0;a<b.length;a++)if(-1!==c.indexOf(b[a])){var f=p[b[a]];c=h(d);c.attr("height",f);var g=c.attr("src");null!=g&&0<=g.indexOf("/servlet/view-file-macro/placeholder")&&(c.attr("src",t(c.attr("src"),f)),c.attr("data-mce-src",t(c.attr("data-mce-src"),f)),l.isGecko&&e.Rte.getEditor().execCommand("mceRepaint",!1));
f="height\x3d"+f;g=u(c);var k=v(c,"height");k?(k=m.indexOf(g,"height\x3d"+k),g[k]=f):g.push(f);c.attr("data-macro-parameters",g.join("|"));l.activeEditor.undoManager.add();h(d).click();c=l.activeEditor.getDoc().createRange();c.setStartBefore(d);c.setEndAfter(d);l.activeEditor.getDoc().getSelection().addRange(c);e.trigger("analyticsEvent",{name:"confluence.view-file.resize."+b[a].substring(b[a].lastIndexOf("-")+1,b[a].length)});break}}}function B(){e.bind("created.property-panel",function(a,d){var b=
h(d.anchor);if("view-file"===b.attr("data-macro-name")){a=r.ViewFileMacro.Templates.Editor.viewFilePropertyPanelHeader;var c=v(b,"name");b=n.getParameterByName(b.attr("src"),"mimeType");b=e.Confluence.FileTypesUtils.getAUIIconFromMime(b);a=h(a({fileName:c,fileIcon:b}));d.panel.find(".aui-property-panel").prepend(a);d.shouldFlip&&d.tip.css({top:d.panel.outerHeight()})}})}var p={"view-file-size-small":"150","view-file-size-medium":"250","view-file-size-large":"400"},w=[{className:"macro-property-panel-view-file-size-small editor-resize resize-small",
text:"",tooltip:"Small thumbnail",iconClass:"aui-icon aui-icon-small aui-iconfont-image-resize",click:q},{className:"macro-property-panel-view-file-size-medium editor-resize resize-medium",text:"",tooltip:"Medium thumbnail",iconClass:"aui-icon aui-icon-small aui-iconfont-image-resize",click:q},{className:"macro-property-panel-view-file-size-large editor-resize resize-large",text:"",tooltip:"Large thumbnail",
iconClass:"aui-icon aui-icon-small aui-iconfont-image-resize",click:q},null,{className:"macro-property-panel-view-file-convert-to-link",text:"Show as link",tooltip:"Show as link",click:function(a,d){e.trigger("analyticsEvent",{name:"confluence.view-file.convert.to-link-trigger"});e.Confluence.PropertyPanel.destroy();(function(b){b=n.getParameterByName(h(b).attr("src"),"attachmentId");
b=e.REST.makeUrl("attachment/"+b+".json");h.ajax({type:"GET",url:b,contentType:"application/json; charset\x3dutf-8",dataType:"json"}).success(function(c){c=r.Link.fromREST(c).insert();l.activeEditor.undoManager.add();l.activeEditor.focus();c.click()})})(d)}}];return{init:function(){e.Confluence.PropertyPanel.Macro.registerInitHandler(function(a,d,b){A(d);a=h(a);b=a.attr("data-mce-src");if(!(b&&-1<b.indexOf("placeholder/unknown-attachment"))){b=0;for(var c=w.length;b<c;b++)d.push(w[b]);(a=a.attr("height"))||
(a="comment"===e.Meta.get("content-type")?n.DEFAULT_HEIGHT_IN_COMMENT:n.DEFAULT_HEIGHT);y(d,a)}},"view-file");B()}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-view-file-macro:view-file-macro-editor-resources', location = '/js/components/view-file-macro-link-properties-panel.js' */
define("vfm/components/view-file-macro-link-properties-panel",["jquery","ajs","tinymce","vfm/view-file-macro-utils"],function(f,b,g,l){function m(c){if(c){var d=f(c);c=d.attr("data-linked-resource-type");d=d.attr("data-linked-resource-content-type");return b.MacroBrowser.getMacroMetadata("view-file")&&"attachment"===c&&!(d&&0===d.indexOf("image"))}return!1}function n(c){var d=b.REST.makeUrl("attachment/"+f(c).attr("data-linked-resource-id")+".json");f.ajax({type:"GET",url:d,contentType:"application/json; charset\x3dutf-8",
dataType:"json"}).success(function(a){var e={name:a.fileName};b.Data.get("content-id")!==a.ownerId&&(e.page=a.parentTitle,e.space=a.space.key,"blogpost"===a.parentContentType&&(a=a.createdDate.date.split("-"),e.date=a[0]+"/"+a[1]+"/"+a[2].substring(0,2)+"/"));e.height="comment"===b.Meta.get("content-type")?l.DEFAULT_HEIGHT_IN_COMMENT:l.DEFAULT_HEIGHT;e={contentId:b.Meta.get("content-id")||"0",macro:{name:"view-file",params:e}};g.confluence.MacroUtils.insertMacro(e,c).done(function(h){f(h).click();
const k=g.activeEditor.getDoc().createRange();k.setStartBefore(h);k.setEndAfter(h);g.activeEditor.getDoc().getSelection().addRange(k)})})}return{init:function(){b.bind("link-property-panel-buttons.created",function(c,d){c=d.buttons;var a=d.link;m(a)&&c.push({className:"link-property-panel-convert-to-thumbnail-button",text:"Show as thumbnail",tooltip:"Show as thumbnail",click:function(){b.Confluence.PropertyPanel.destroy();
n(a);b.trigger("analyticsEvent",{name:"confluence.view-file.convert.to-thumbnail-trigger"})}})})}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-view-file-macro:view-file-macro-editor-resources', location = '/js/components/vfm-editor-poller.js' */
define("vfm/components/vfm-editor-poller","ajs jquery underscore tinymce vfm/view-file-macro-utils vfm/services/conversion-service".split(" "),function(x,m,r,k,a,t){function v(){if(k.activeEditor&&l){var n=m("img[data-macro-name\x3d'view-file'][src*\x3d'thumbnailStatus\x3d"+a.THUMBNAIL_STATUS_IN_PROGRESS+"'][data-thumbnail-status!\x3d'"+a.THUMBNAIL_STATUS_ERROR+"']",k.activeEditor.dom.doc);if(0<n.length){var u=!1;n.each(function(){var d=m(this).attr("src"),c=a.getParameterByName(d,"attachmentId");
d=a.getParameterByName(d,"version");b[c]&&b[c].version===d||(b[c]={version:d},u=!0)});u&&(f=a.THUMBNAIL_POLLING_PERIOD);t.postThumbnailConversionResults(b).then(function(d){k.activeEditor&&l&&(r.each(d,function(c,e){if(b[e]){var p=m("img[data-macro-name\x3d'view-file'][src*\x3d'attachmentId\x3d"+e+"']",k.activeEditor.dom.doc),h=b[e].version;p.attr("data-thumbnail-status",c);c===a.THUMBNAIL_STATUS_CONVERTED?(c=p.attr("src"),h=t.getThumbnailUrl(e,h),h=a.addParamsToUrl(h,{attachmentId:e,mimeType:a.getParameterByName(c,
"mimeType")}),p.attr("src",h),delete b[e]):c===a.THUMBNAIL_STATUS_ERROR&&delete b[e]}}),f=r.isEmpty(b)?a.THUMBNAIL_POLLING_PERIOD:f*w,q())})}else 0===n.length&&(f=a.THUMBNAIL_POLLING_PERIOD,q())}}function q(){l=!0;g&&clearTimeout(g);g=setTimeout(v,f)}var g,l=!1,b={},f=a.THUMBNAIL_POLLING_PERIOD,w=a.THUMBNAIL_POLLING_BACKOFF_RATIO;return{startPolling:q,stopPolling:function(){g&&(clearTimeout(g),g=void 0);l=!1;b={};f=a.THUMBNAIL_POLLING_PERIOD}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-view-file-macro:view-file-macro-editor-resources', location = '/js/vfm-editor.js' */
require(["ajs","tinymce","vfm/components/view-file-macro-properties-panel","vfm/components/view-file-macro-link-properties-panel","vfm/components/vfm-editor-poller"],function(a,c,e,f,d){a.toInit(function(){a.MacroBrowser.setMacroJsOverride("view-file",{opener:function(b){}});e.init();f.init()});c.create("tinymce.plugins.ViewFilePoller",{init:function(b){a.bind("rte-ready",function(){d.startPolling()});a.bind("rte-destroyed",function(){d.stopPolling()})}});c.PluginManager.add("viewFilePoller",c.plugins.ViewFilePoller);
a.Rte.BootstrapManager.addTinyMcePluginInit(function(b){b.plugins+=",viewFilePoller"})},void 0,!0);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.extra.widgetconnector:widget-connector-autoconvert-web-resources-v4', location = 'com/atlassian/confluence/extra/widgetconnector/js/autoconvert-widget-links.js' */
define("confluence-widget-connector/autoconvert",["tinymce"],function(c){var d=[/open.spotify.com/,/facebook.com/,/linkedin.com\/embed/,/twitter.com/,/figma.com/,/prezi.com/,/microsoftstream.com/,/google([.a-z]+)\/(maps|calendar|presentation|document)/,/google([.a-z]+)\/spreadsheets(.*)(pubchart|pubhtml)/];return{WidgetAutoConvertFn:function(e,f,a){var b=decodeURI(e.source);d.find(function(a){return b.match(a)})?c.plugins.Autoconvert.convertMacroToDom({name:"widget",params:{url:b}},a,a):a()}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.extra.widgetconnector:widget-connector-autoconvert-web-resources-v4', location = 'com/atlassian/confluence/extra/widgetconnector/js/autoconvert-widget-links-editor-v4.js' */
define("confluence-widget-connector/autoconvert-plugin-v4",["tinymce","confluence-editor/loader/tinymce-bootstrap","confluence-widget-connector/autoconvert"],function(b,c,d){b.PluginManager.add("widgetconnector",function(a){a.on("init",function(){a.execCommand("addAutoconverter",!1,d.WidgetAutoConvertFn)})});c.addTinyMcePluginInit(function(a){a.plugins+=",widgetconnector"})});
try{require("confluence-widget-connector/autoconvert-plugin-v4")}catch(b){console.warn("Unable to load widget autoconvert",b)};
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:split_aui.component.tabs', location = 'aui.chunk.ca7ef50bea2a00ea2907--bd618782c64d5464a775.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["aui.component.tabs"],{zCVu:function(t,e,a){"use strict";a.r(e),a.d(e,"TabContainerEl",(function(){return W})),a.d(e,"TabPaneEl",(function(){return S})),a.d(e,"TabItemEl",(function(){return D}));a("FStl"),a("Q0fs"),a("XHZH"),a("gjsO");var i=a("JFi+"),n=a("QFBp"),s=a("+x/D"),r=a("KloK"),u=a("OEua");function o(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";var a=Object(s.default)(t),i=e||!1;a.each((function(){var t=Object(s.default)(this);t.attr("id")||t.attr("id",Object(u.default)(i))}))}Object(r.default)("_addID",o);var c=o;function d(t){return(t=Object(s.default)(t)).prop("scrollWidth")>t.prop("clientWidth")}Object(r.default)("isClipped",d);var l=d,b=a("4dFR"),f=window.skateTemplateHtml;function p(t){let e=Object(s.default)(t),a=String(e.attr("href")||"").trim();return 0===a.indexOf("#")?a.substr(1):null}function h(t){let e=p(t);return e?document.getElementById(e):null}var v={totalTabsWidth:function(t,e){var a=this.totalVisibleTabWidth(t),i=0;return e.find("li").each((function(t,e){i+=parseInt(e.getAttribute("data-aui-tab-width"))})),a+i},totalVisibleTabWidth:function(t){var e=0;return t.each((function(t,a){e+=Object(s.default)(a).outerWidth()})),e},removeResponsiveDropdown:function(t,e){t.remove(),e.remove()},createResponsiveDropdownTrigger:function(t,e){var a='<li class="menu-item aui-tabs-responsive-trigger-item">\n            <a\n                class="aui-dropdown2-trigger aui-tabs-responsive-trigger aui-dropdown2-trigger-arrowless"\n                id="aui-tabs-responsive-trigger-'.concat(e,'"\n                aria-haspopup="true"\n                aria-controls="aui-tabs-responsive-dropdown-').concat(e,'"\n                href="#aui-tabs-responsive-dropdown-').concat(e,'">...</a>\n            </li>');return t.append(a),t.find(".aui-tabs-responsive-trigger-item")},createResponsiveDropdown:function(t,e){var a='<div class="aui-dropdown2 aui-tabs-responsive-dropdown" id="aui-tabs-responsive-dropdown-'+e+'"><ul></ul></div>';return t.append(a),t.find("#aui-tabs-responsive-dropdown-"+e)},findNewVisibleTabs:function(t,e,a){function i(t,e,a){return t+e<=a}for(var n=0,r=0;i(n,a,e)&&r<t.length;r++){n+=Object(s.default)(t[r]).outerWidth(!0)}return t.slice(0,r-1)},moveVisibleTabs:function(t,e,a){for(var i=a.find("a").attr("aria-controls"),n=Object(s.default)("#"+i),r=this.findNewVisibleTabs(t,e.outerWidth(),a.parent().outerWidth(!0)),u=r.length-1,o=t.length-1;o>=u;o--){var c=Object(s.default)(t[o]);this.moveTabToResponsiveDropdown(c,n,a)}return Object(s.default)(r)},moveTabToResponsiveDropdown:function(t,e,a){var i=t.find("a");t.attr("data-aui-tab-width",t.outerWidth(!0)),i.addClass("aui-dropdown2-radio aui-tabs-responsive-item"),t.hasClass("active-tab")&&(i.addClass("aui-dropdown2-checked"),a.addClass("active-tab")),e.find("ul").prepend(t)},moveInvisibleTabs:function(t,e,a){function i(t){return t>0}for(var n=0;i(e)&&n<t.length;n++){var r=Object(s.default)(t[n]),u=parseInt(r.attr("data-aui-tab-width"),10);u<e&&this.moveTabOutOfDropdown(r,a),e-=u}},moveTabOutOfDropdown:function(t,e){t.find("a").hasClass("aui-dropdown2-checked")&&(t.addClass("active-tab"),e.removeClass("active-tab")),t.children("a").removeClass("aui-dropdown2-radio aui-tabs-responsive-item aui-dropdown2-checked"),e.before(t)}};function m(t){var e=Object(s.default)(t);if(!e.hasClass("aui-tabs-responsive-trigger")){var a=h(e);if(a){var n=Object(s.default)(a);n.addClass("active-pane").siblings(".tabs-pane").removeClass("active-pane");var r=e.parents(".aui-tabs").find(".aui-tabs-responsive-trigger-item a").attr("aria-controls"),u=Object(s.default)(document.getElementById(r));if(u.find("li a").attr("aria-checked",!1).removeClass("checked aui-dropdown2-checked"),u.find("li").removeClass("active-tab"),e.parent("li.menu-item").addClass("active-tab").siblings(".menu-item").removeClass("active-tab"),e.hasClass("aui-tabs-responsive-item")){var o=n.parent(".aui-tabs").find("li.menu-item:not(.aui-tabs-responsive-trigger-item)");o.removeClass("active-tab"),o.find("a").removeClass("checked").removeAttr("aria-checked")}e.hasClass("aui-tabs-responsive-item")&&n.parent(".aui-tabs").find("li.menu-item.aui-tabs-responsive-trigger-item").addClass("active-tab"),e.closest(".tabs-menu").find("a").attr("aria-selected","false"),e.attr("aria-selected","true"),e.trigger("tabSelect",{tab:e,pane:n})}else i.error("Cannot switch to tab panel because it does not exist. Check whether the tab link href is correct.",t)}}function g(t){return void 0!==t.attr("data-aui-persist")&&"false"!==t.attr("data-aui-persist")}function w(t){var e=t.attr("id"),a=t.attr("data-aui-persist");return"_internal-aui-tabs-"+(e||"")+(a&&"true"!==a?"-"+a:"")}function k(t){A.change(Object(s.default)(t.target).closest("a")),t&&t.preventDefault()}function O(t){t.forEach((function(t,e){!function(t,e){var a=Object(s.default)(t),i=a.find(".tabs-menu").first(),n=i.find("li:not(.aui-tabs-responsive-trigger-item)"),r=i.find(".aui-tabs-responsive-trigger").parent(),u=r.find("a"),o=u.attr("aria-controls"),c=Object(s.default)(document.getElementById(o)).attr("aria-checked",!1),d=c.length>0,l=v.totalTabsWidth(n,c)>a.outerWidth();if(!d&&l&&(r=v.createResponsiveDropdownTrigger(i,e),c=v.createResponsiveDropdown(a,e)),u.attr("aria-controls","aui-tabs-responsive-dropdown-"+e),u.attr("id","aui-tabs-responsive-trigger-"+e),u.attr("href","#aui-tabs-responsive-trigger-"+e),c.attr("id","aui-tabs-responsive-dropdown-"+e),l){var b=v.moveVisibleTabs(n.toArray(),a,r),f=v.totalVisibleTabWidth(b),p=a.outerWidth()-f-r.outerWidth(!0);if(p>0){var h=c.find("li");v.moveInvisibleTabs(h.toArray(),p,r)}a.hasClass("aui-tabs-disabled")||c.on("click.aui-tabs","a",k),i.is(":visible")&&i.hide().show()}d&&!l&&(c.find("li").each((function(){v.moveTabOutOfDropdown(Object(s.default)(this),r)})),v.removeResponsiveDropdown(c,r))}(t,e)}))}function j(){return Object(s.default)('.aui-tabs.horizontal-tabs[data-aui-responsive]:not([data-aui-responsive="false"]), aui-tabs[responsive]:not([responsive="false"])').toArray()}function C(t){var e=Object(s.default)(t);if(t.setAttribute("role","application"),!e.data("aui-tab-events-bound")){var a=e.children("ul.tabs-menu");a.attr("role","tablist"),a.children("li").attr("role","presentation"),a.find("> .menu-item a").each((function(){var t,e,a;t=this,e=Object(s.default)(t),a=h(e),p(t)||i.error('A tab link must use an anchor link (e.g., <a href="#a-valid-id"></a>) to work correctly.',t),a?(c(e),e.attr("role","tab"),Object(s.default)(a).attr("aria-labelledby",e.attr("id")),e.parent().hasClass("active-tab")?e.attr("aria-selected","true"):e.attr("aria-selected","false")):i.warn("A tab panel could not be found with the tab link's configured href. Check whether the tab link href is correct.",t)})),a.on("click.aui-tabs","a",k),e.data("aui-tab-events-bound",!0),function(t){[].slice.call(t.querySelectorAll(".tabs-pane")).forEach(y)}(t)}}function T(){var t=Object(s.default)(".aui-tabs:not(.aui-tabs-disabled)");t.each((function(){C(this)})),function(t){for(var e=0,a=t.length;e<a;e++){var n=t.eq(e),s=t.get(e);if(g(n)&&window.localStorage)if(n.attr("id")){var r=window.localStorage.getItem(w(n));if(r){var u=s.querySelector('a[href$="'.concat(r,'"]'));u&&m(u)}}else i.warn("A tab group must specify an id attribute if it specifies data-aui-persist.")}}(t)}function y(t){t.setAttribute("role","tabpanel")}var A={setup:function(){!function(){const t=Object(n.debounce)(O,200);t(j()),Object(s.default)(window).on("resize.aui-tabs",(()=>t(j())))}(),T(),Object(s.default)(".aui-tabs.vertical-tabs").find("a").each((function(){var t=Object(s.default)(this);t.attr("title")||l(t)&&t.attr("title",t.text())}))},change:function(t){var e=t instanceof HTMLElement||t instanceof s.default?t:document.querySelector(t),a=Object(s.default)(e).first(),n=a.closest(".aui-tabs");m(a),g(n)&&window.localStorage&&function(t){var e=t.closest(".aui-tabs");if(e.attr("id")){var a=p(t);a&&window.localStorage.setItem(w(e),"#"+a)}else i.warn("A tab group must specify an id attribute if it specifies data-aui-persist.")}(a)}};Object(s.default)(A.setup);const W=Object(b.default)("aui-tabs",{created:function(t){Object(s.default)(t).addClass("aui-tabs horizontal-tabs"),b.default.init(t),C(t)},template:f('<ul class="tabs-menu">','<content select="li[is=aui-tabs-tab]"></content>',"</ul>",'<content select="aui-tabs-pane"></content>'),prototype:{select:function(t){var e,a=Object(s.default)((e=this,e.querySelectorAll("aui-tabs-pane"))).index(t);return a>-1&&A.change(function(t){return t.querySelectorAll("li[is=aui-tabs-tab]")}(this)[a].children[0]),this}}}),D=Object(b.default)("aui-tabs-tab",{extends:"li",created:function(t){Object(s.default)(t).addClass("menu-item")},template:f('<a href="#">',"<strong>","<content></content>","</strong>","</a>")}),S=Object(b.default)("aui-tabs-pane",{attached:function(t){var e=Object(s.default)(function(t){return Object(s.default)(t).closest("aui-tabs").get(0)}(t)),a=Object(s.default)(t),i=e.find("aui-tabs-pane").index(a),n=new D,r=Object(s.default)(n);a.addClass("tabs-pane"),n.firstChild.setAttribute("href","#"+t.id),f.wrap(n).textContent=a.attr("title"),0===i&&a.addClass("active-pane"),a.hasClass("active-pane")&&r.addClass("active-tab"),a.siblings("ul").append(n)},template:f("<content></content>")});Object(r.default)("tabs",A)}},[["zCVu","runtime","aui.splitchunk.vendors--894c8113d9","aui.splitchunk.vendors--95c789edf5","aui.splitchunk.vendors--9c48cc20a9","aui.splitchunk.vendors--084821f40b","aui.splitchunk.vendors--d2297af84a","aui.splitchunk.0d131bcbf1","aui.splitchunk.fbbef27525","aui.splitchunk.444efc83be","aui.splitchunk.739b9ec8cc","aui.splitchunk.056561461c","aui.splitchunk.dd803a46b4","aui.splitchunk.994e478d48","aui.splitchunk.e54c7c7304","aui.splitchunk.fb15cffa72","aui.splitchunk.56dfb54d0c","aui.splitchunk.f1e06f97a4","aui.splitchunk.479fe6ee76","aui.splitchunk.f673ef53ac","aui.splitchunk.8659b532c1","aui.splitchunk.9c48cc20a9","aui.splitchunk.5f851f97df","aui.splitchunk.d0110a864f","aui.splitchunk.afa5039e04","aui.splitchunk.bff3715233","aui.splitchunk.c750721820","aui.splitchunk.6d6f245ed3","aui.splitchunk.ed86a19e01","aui.splitchunk.084821f40b","aui.splitchunk.2e16019fb9","aui.splitchunk.5b8c290363","aui.splitchunk.baa83dbaf9","aui.splitchunk.e5af17b48e","aui.splitchunk.f154095da3","aui.splitchunk.36cd9d521c","aui.splitchunk.4248e12b20","aui.splitchunk.b548966f06"]]]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.stiltsoft.confluence.plugin.tablefilter.tablefilter:41690cc2b9727246c6f58a320f1b19fa', location = 'build/28.js' */
(self.webpackChunk=self.webpackChunk||[]).push([[28],{28:function(){window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=function(o,t){t=t||window;for(var e=0;e<this.length;e++)o.call(t,this[e],e,this)})}}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.stiltsoft.confluence.plugin.tablefilter.tablefilter:common-resources', location = 'build/common.js' */
!function(){"use strict";var t,e={1519:function(t,e,r){r.r(e);r(28);var o={stringPrototype:{},regExpPrototype:{},isNative:function(t){return-1!=t.toString().indexOf("native code")},isNeedLoadNativeFunctions:function(){return $("div[data-macro-name=code]").length&&!this.isNative(String.prototype.replace)},saveOriginalNativeFunctions:function(){var t=this;!t.stringPrototype.replaceOriginal&&t.isNative(String.prototype.replace)&&(t.stringPrototype.replaceOriginal=String.prototype.replace,t.stringPrototype.matchOriginal=String.prototype.match,t.stringPrototype.splitOriginal=String.prototype.split,t.regExpPrototype.execOriginal=RegExp.prototype.exec,t.regExpPrototype.testOriginal=RegExp.prototype.test,t.regExpPrototype.applyOriginal=RegExp.prototype.apply,t.regExpPrototype.callOriginal=RegExp.prototype.call)},loadOriginalNativeFunctions:function(){var t=this;t.stringPrototype.replaceOriginal&&(t.isNeedLoadNativeFunctions()?(t.stringPrototype.replaceSave=String.prototype.replace,t.stringPrototype.matchSave=String.prototype.match,t.stringPrototype.splitSave=String.prototype.split,t.regExpPrototype.execSave=RegExp.prototype.exec,t.regExpPrototype.testSave=RegExp.prototype.test,t.regExpPrototype.applySave=RegExp.prototype.apply,t.regExpPrototype.callSave=RegExp.prototype.call,String.prototype.replace=t.stringPrototype.replaceOriginal,String.prototype.match=t.stringPrototype.matchOriginal,String.prototype.split=t.stringPrototype.splitOriginal,RegExp.prototype.exec=t.regExpPrototype.execOriginal,RegExp.prototype.test=t.regExpPrototype.testOriginal,RegExp.prototype.apply=t.regExpPrototype.applyOriginal,RegExp.prototype.call=t.regExpPrototype.callOriginal):t.stringPrototype.replaceSave=null)},loadSavedCurrentNativeFunctions:function(){var t=this;t.stringPrototype.replaceOriginal&&t.stringPrototype.replaceSave&&(String.prototype.replace=t.stringPrototype.replaceSave,String.prototype.match=t.stringPrototype.matchSave,String.prototype.split=t.stringPrototype.splitSave,RegExp.prototype.exec=t.regExpPrototype.execSave,RegExp.prototype.test=t.regExpPrototype.testSave,RegExp.prototype.apply=t.regExpPrototype.applySave,RegExp.prototype.call=t.regExpPrototype.callSave)}};window.TFSolutionBug=o,o.saveOriginalNativeFunctions()}},r={};function o(t){var p=r[t];if(void 0!==p)return p.exports;var i=r[t]={exports:{}};return e[t](i,i.exports,o),i.exports}o.m=e,t=[],o.O=function(e,r,p,i){if(!r){var n=1/0;for(y=0;y<t.length;y++){r=t[y][0],p=t[y][1],i=t[y][2];for(var a=!0,g=0;g<r.length;g++)(!1&i||n>=i)&&Object.keys(o.O).every((function(t){return o.O[t](r[g])}))?r.splice(g--,1):(a=!1,i<n&&(n=i));if(a){t.splice(y--,1);var l=p();void 0!==l&&(e=l)}}return e}i=i||0;for(var y=t.length;y>0&&t[y-1][2]>i;y--)t[y]=t[y-1];t[y]=[r,p,i]},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},function(){var t={8592:0,6229:0};o.O.j=function(e){return 0===t[e]};var e=function(e,r){var p,i,n=r[0],a=r[1],g=r[2],l=0;if(n.some((function(e){return 0!==t[e]}))){for(p in a)o.o(a,p)&&(o.m[p]=a[p]);if(g)var y=g(o)}for(e&&e(r);l<n.length;l++)i=n[l],o.o(t,i)&&t[i]&&t[i][0](),t[i]=0;return o.O(y)},r=self.webpackChunk=self.webpackChunk||[];r.forEach(e.bind(null,0)),r.push=e.bind(null,r.push.bind(r))}();var p=o.O(void 0,[28,6229],(function(){return o(1519)}));p=o.O(p)}();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.stiltsoft.confluence.plugin.tablefilter.tablefilter:editor-extensions', location = 'build/editor-extensions.js' */
/*! For license information please see editor-extensions.js.LICENSE.txt */
(function(){var __webpack_modules__={2759:function(){function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function($){$.extend({tablesorterEditor:new function(){this.version="2.3.10";var parsers=[],widgets=[];function log(e){"undefined"!=typeof console&&void 0!==console.log||alert(e)}function benchmark(e,t){log(e+" ("+((new Date).getTime()-t.getTime())+"ms)")}function getElementText(e,t,r){if(!t)return"";var o=e.config,a=o.textExtraction,n="";return n="simple"===a?o.supportsTextContent?t.textContent:t.childNodes[0]&&t.childNodes[0].hasChildNodes()?t.childNodes[0].innerHTML:t.innerHTML:"function"==typeof a?a(t,e,r):"object"===_typeof(a)&&a.hasOwnProperty(r)?a[r](t,e,r):o.supportsTextContent?t.textContent:$(t).text(),$.trim(n)}function getParserById(e){var t,r=parsers.length;for(t=0;t<r;t++)if(parsers[t].id.toLowerCase()===e.toString().toLowerCase())return parsers[t];return!1}function detectParserForColumn(e,t,r,o){for(var a,n=parsers.length,i=!1,s="",c=!0;""===s&&c;)t[++r]?(s=getElementText(e,i=t[r].cells[o],o),e.config.debug&&log("Checking if value was empty on row "+r+", column: "+o+": "+s)):c=!1;for(a=1;a<n;a++)if(parsers[a].is(s,e,i))return parsers[a];return parsers[0]}function buildParserCache(e,t){var r,o,a,n,i,s,c,l=e.config,d=$(e.tBodies).filter(":not(."+l.cssInfoBlock+")"),u=$.tablesorterEditor,f="";if(0!==d.length){if((r=d[0].rows)[0])for(o=[],a=r[0].cells.length,n=0;n<a;n++)i=t.filter(':not([colspan])[data-column="'+n+'"]:last,[colspan="1"][data-column="'+n+'"]:last'),s=l.headers[n],c=getParserById(u.getData(i,s,"sorter")),l.empties[n]=u.getData(i,s,"empty")||l.emptyTo||(l.emptyToBottom?"bottom":"top"),l.strings[n]=u.getData(i,s,"string")||l.stringTo||"max",c||(c=detectParserForColumn(e,r,r.length>1?0:-1,n)),l.debug&&(f+="column:"+n+"; parser:"+c.id+"; string:"+l.strings[n]+"; empty: "+l.empties[n]+"\n"),o.push(c);return l.debug&&log(f),o}}function buildCache(e){var t,r,o,a,n,i,s,c,l,d=e.tBodies,u=e.config,f=u.parsers;for(u.cache={},u.debug&&(l=new Date),i=0;i<d.length;i++)if(u.cache[i]={row:[],normalized:[]},!$(d[i]).hasClass(u.cssInfoBlock)){for($(d[i]).addClass("tablesorter-hidden"),t=d[i]&&d[i].rows.length||0,r=d[i].rows[0]&&d[i].rows[0].cells.length||0,a=0;a<t;++a)if(!$(d[i].rows[a]).hasClass("tablesorter-header"))if(c=[],(s=$(d[i].rows[a])).hasClass(u.cssChildRow))u.cache[i].row[u.cache[i].row.length-1]=u.cache[i].row[u.cache[i].row.length-1].add(s);else{for(u.cache[i].row.push(s),n=0;n<r;++n)o=getElementText(e,s[0].cells[n],n),c.push(f[n].format(o,e,s[0].cells[n],n));c.push(u.cache[i].normalized.length),u.cache[i].normalized.push(c)}$(d[i]).removeClass("tablesorter-hidden")}u.debug&&benchmark("Building cache for "+t+" rows",l)}function getWidgetById(e){var t,r,o=widgets.length;for(t=0;t<o;t++)if((r=widgets[t])&&r.hasOwnProperty("id")&&r.id.toLowerCase()===e.toLowerCase())return r}function applyWidget(e,t){var r,o,a,n=e.config,i=n.widgets,s=i.length;for(n.debug&&(r=new Date),o=0;o<s;o++)(a=getWidgetById(i[o]))&&(!0===t&&a.hasOwnProperty("init")?a.init(e,widgets,a):!t&&a.hasOwnProperty("format")&&a.format(e));n.debug&&benchmark("Completed "+(!0===t?"initializing":"applying")+" widgets",r)}function appendToTable(e,t){var r,o,a,n,i,s,c,l,d,u,f,p=e.config,h=e.tBodies,g=[],m=p.cache;for(p.debug&&(f=new Date),l=0;l<h.length;l++)if(!$(h[l]).hasClass(p.cssInfoBlock)){for($(h[l]).addClass("tablesorter-hidden"),i=document.createDocumentFragment(),r=m[l].row,n=(a=(o=m[l].normalized).length)?o[0].length-1:0,s=0;s<a;s++)if(u=o[s][n],g.push(r[u]),!p.appender||!p.removeRows)for(d=r[u].length,c=0;c<d;c++)i.appendChild(r[u][c]);e.tBodies[l].appendChild(i),$(h[l]).removeClass("tablesorter-hidden")}p.appender&&p.appender(e,g),p.debug&&benchmark("Rebuilt table",f),t||applyWidget(e),$(e).trigger("sortEnd",e)}function computeThIndexes(e){var t,r,o,a,n,i,s,c,l,d,u,f,p=[],h={},g=$(e).find("tr:has(td,th):first");for(t=0;t<g.length;t++)for(i=g[t].cells,r=0;r<i.length;r++){for(c=(s=(n=i[r]).parentNode.rowIndex)+"-"+n.cellIndex,l=n.rowSpan||1,d=n.colSpan||1,void 0===p[s]&&(p[s]=[]),o=0;o<p[s].length+1;o++)if(void 0===p[s][o]){u=o;break}for(h[c]=u,$(n).attr({"data-column":u}),o=s;o<s+l;o++)for(void 0===p[o]&&(p[o]=[]),f=p[o],a=u;a<u+d;a++)f[a]="x"}return h}function formatSortingOrder(e){return/^d/i.test(e)||1===e}function buildHeaders(e){var t,r,o,a,n,i=computeThIndexes(e),s=e.config,c=$.tablesorterEditor;return s.headerList=[],s.debug&&(a=new Date),n=$(e).find(s.selectorHeaders).each((function(e){r=$(this),t=s.headers[e],s.onRenderHeader&&s.onRenderHeader.apply(r,[e]),this.column=i[this.parentNode.rowIndex+"-"+this.cellIndex],this.order=formatSortingOrder(c.getData(r,t,"sortInitialOrder")||s.sortInitialOrder)?[1,0,2]:[0,1,2],this.count=-1,"false"===c.getData(r,t,"sorter")&&(this.sortDisabled=!0),this.lockedOrder=!1,void 0!==(o=c.getData(r,t,"lockedOrder")||!1)&&!1!==o&&(this.order=this.lockedOrder=formatSortingOrder(o)?[1,1,1]:[0,0,0]),this.sortDisabled||r.addClass(s.cssHeader),s.headerList[e]=this,r.parent().addClass(s.cssHeader)})),e.config.debug&&(benchmark("Built headers:",a),log(n)),n}function isValueInArray(e,t){var r,o=t.length;for(r=0;r<o;r++)if(t[r][0]===e)return!0;return!1}function setHeadersCss(e,t,r){var o,a,n,i,s=[],c=[e.config.cssDesc,e.config.cssAsc];for(t.removeClass(c.join(" ")).each((function(){this.sortDisabled||(s[this.column]=$(this))})),i=r.length,a=0;a<i;a++)if(2!==r[a][1]&&(s[r[a][0]]&&s[r[a][0]].addClass(c[r[a][1]]),o=t.filter('[data-column="'+r[a][0]+'"]'),i>1&&o.length))for(n=0;n<o.length;n++)o[n].sortDisabled||$(o[n]).addClass(c[r[a][1]])}function fixColumnWidth(e){if(e.config.widthFixed){var t=$("<colgroup>");$("tr:first td",e.tBodies[0]).each((function(){t.append($("<col>").css("width",$(this).width()))})),$(e).prepend(t)}}function updateHeaderSortCount(e,t){var r,o,a,n=e.config,i=t.length;for(r=0;r<i;r++)o=t[r],(a=n.headerList[o[0]])&&(a.count=o[1]%(n.sortReset?3:2))}function getCachedSortType(e,t){return e&&e[t]&&e[t].type||""}function multisort(table,sortList){var dynamicExp,col,mx=0,dir=0,tc=table.config,l=sortList.length,bl=table.tBodies.length,sortTime,i,j,k,c,cache,lc,s,e,order,orgOrderCol;for(tc.debug&&(sortTime=new Date),k=0;k<bl;k++){for(dynamicExp="var sortWrapper = function(a,b) {",cache=tc.cache[k],lc=cache.normalized.length,i=0;i<l;i++){if(c=sortList[i][0],order=sortList[i][1],s=/n/i.test(getCachedSortType(tc.parsers,c))?"Numeric":"Text",s+=0===order?"":"Desc",e="e"+i,/Numeric/.test(s)&&tc.strings[c]){for(j=0;j<lc;j++)col=Math.abs(parseFloat(cache.normalized[j][c])),mx=Math.max(mx,isNaN(col)?0:col);dir="boolean"==typeof tc.string[tc.strings[c]]?(0===order?1:-1)*(tc.string[tc.strings[c]]?-1:1):tc.strings[c]&&tc.string[tc.strings[c]]||0}dynamicExp+="var "+e+" = sort"+s+"(table,a["+c+"],b["+c+"],"+c+","+mx+","+dir+"); ",dynamicExp+="if ("+e+") { return "+e+"; } ",dynamicExp+="else { "}for(orgOrderCol=cache.normalized&&cache.normalized[0]?cache.normalized[0].length-1:0,dynamicExp+="return a["+orgOrderCol+"]-b["+orgOrderCol+"];",i=0;i<l;i++)dynamicExp+="}; ";dynamicExp+="return 0; ",dynamicExp+="}; ",eval(dynamicExp),cache.normalized.sort(sortWrapper)}tc.debug&&benchmark("Sorting on "+sortList.toString()+" and dir "+order+" time",sortTime)}function sortText(e,t,r,o){if(t===r)return 0;var a,n,i,s,c,l,d,u,f=e.config,p=f.string[f.empties[o]||f.emptyTo],h=$.tablesorterEditor.regex;if(""===t&&0!==p)return"boolean"==typeof p?p?-1:1:-p||-1;if(""===r&&0!==p)return"boolean"==typeof p?p?1:-1:p||1;if("function"==typeof f.textSorter)return f.textSorter(t,r,e,o);if(a=t.replace(h[0],"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),i=r.replace(h[0],"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),n=parseInt(t.match(h[2]))||1!==a.length&&t.match(h[1])&&Date.parse(t),s=parseInt(r.match(h[2]))||n&&r.match(h[1])&&Date.parse(r)||null){if(n<s)return-1;if(n>s)return 1}for(u=Math.max(a.length,i.length),d=0;d<u;d++){if(c=!(a[d]||"").match(h[3])&&parseFloat(a[d])||a[d]||0,l=!(i[d]||"").match(h[3])&&parseFloat(i[d])||i[d]||0,isNaN(c)!==isNaN(l))return isNaN(c)?1:-1;if(_typeof(c)!==_typeof(l)&&(c+="",l+=""),c<l)return-1;if(c>l)return 1}return 0}function sortTextDesc(e,t,r,o){if(t===r)return 0;var a=e.config,n=a.string[a.empties[o]||a.emptyTo];return""===t&&0!==n?"boolean"==typeof n?n?-1:1:n||1:""===r&&0!==n?"boolean"==typeof n?n?1:-1:-n||-1:"function"==typeof a.textSorter?a.textSorter(r,t,e,o):sortText(e,r,t)}function getTextValue(e,t,r){if(t){var o,a=e.length,n=t+r;for(o=0;o<a;o++)n+=e.charCodeAt(o);return r*n}return 0}function sortNumeric(e,t,r,o,a,n){if(t===r)return 0;var i=e.config,s=i.string[i.empties[o]||i.emptyTo];return""===t&&0!==s?"boolean"==typeof s?s?-1:1:-s||-1:""===r&&0!==s?"boolean"==typeof s?s?1:-1:s||1:(isNaN(t)&&(t=getTextValue(t,a,n)),isNaN(r)&&(r=getTextValue(r,a,n)),t-r)}function sortNumericDesc(e,t,r,o,a,n){if(t===r)return 0;var i=e.config,s=i.string[i.empties[o]||i.emptyTo];return""===t&&0!==s?"boolean"==typeof s?s?-1:1:s||1:""===r&&0!==s?"boolean"==typeof s?s?1:-1:-s||-1:(isNaN(t)&&(t=getTextValue(t,a,n)),isNaN(r)&&(r=getTextValue(r,a,n)),r-t)}function checkResort(e,t,r){var o=e[0];!1!==t?e.trigger("sorton",[o.config.sortList,function(){e.trigger("updateComplete"),"function"==typeof r&&r(o)}]):(e.trigger("updateComplete"),"function"==typeof r&&r(o))}this.defaults={widthFixed:!1,cancelSelection:!0,dateFormat:"mmddyyyy",sortMultiSortKey:"shiftKey",usNumberFormat:!0,delayInit:!1,headers:{},ignoreCase:!1,sortForce:null,sortList:[],sortAppend:null,sortInitialOrder:"asc",sortLocaleCompare:!1,sortReset:!1,sortRestart:!1,emptyTo:"bottom",stringTo:"max",textExtraction:"simple",textSorter:function(e,t){return e.localeCompare(t)},widgets:[],widgetOptions:{zebra:["even","odd"]},initWidgets:!0,initialized:null,onRenderHeader:null,tableClass:"tablesorter",cssAsc:"tablesorter-headerSortUp",cssChildRow:"expand-child",cssDesc:"tablesorter-headerSortDown",cssHeader:"tablesorter-header",cssInfoBlock:"tablesorter-infoOnly",selectorHeaders:"tr:has(td,th):first td, tr:has(td,th):first th",selectorRemove:"tr.remove-me",debug:!1,headerList:[],empties:{},strings:{},parsers:[]},this.benchmark=benchmark,this.hasInitialized=!1,this.construct=function(e){return this.each((function(){if(0!==this.tBodies.length){var t,r,o,a,n,i,s,c,l,d,u=$.metadata;this.config={},(o=$.extend(!0,this.config,$.tablesorterEditor.defaults,e)).debug&&$.data(this,"startoveralltimer",new Date),r=$(this).addClass(o.tableClass),$.data(this,"tablesorter",o),o.supportsTextContent="x"===$("<span>x</span>")[0].textContent,o.string={max:1,min:-1,"max+":1,"max-":-1,zero:0,none:0,null:0,top:!0,bottom:!1},t=buildHeaders(this),o.parsers=buildParserCache(this,t),o.delayInit||buildCache(this),fixColumnWidth(this),t.bind("mousedown.tablesorter mouseup.tablesorter",(function(e,u){if(e.ctrlKey||e.metaKey){if("mousedown"===e.type)return d=(new Date).getTime(),!o.cancelSelection;if(!0!==u&&(new Date).getTime()-d>500)return!1;if(o.delayInit&&!o.cache&&buildCache(r[0]),!this.sortDisabled){if(r.trigger("sortStart",r[0]),$(this),i=!e[o.sortMultiSortKey],this.count=(this.count+1)%(o.sortReset?3:2),o.sortRestart&&(a=this,t.each((function(){this===a||!i&&$(this).is("."+o.cssDesc+",."+o.cssAsc)||(this.count=-1)}))),a=this.column,i){if(o.sortList=[],null!==o.sortForce)for(s=o.sortForce,n=0;n<s.length;n++)s[n][0]!==a&&o.sortList.push(s[n]);if((l=this.order[this.count])<2&&(o.sortList.push([a,l]),this.colSpan>1))for(n=1;n<this.colSpan;n++)o.sortList.push([a+n,l])}else if(isValueInArray(a,o.sortList))for(n=0;n<o.sortList.length;n++)c=o.sortList[n],l=o.headerList[c[0]],c[0]===a&&(c[1]=l.order[l.count],2===c[1]&&(o.sortList.splice(n,1),l.count=-1));else if((l=this.order[this.count])<2&&(o.sortList.push([a,l]),this.colSpan>1))for(n=1;n<this.colSpan;n++)o.sortList.push([a+n,l]);if(null!==o.sortAppend)for(s=o.sortAppend,n=0;n<s.length;n++)s[n][0]!==a&&o.sortList.push(s[n]);return r.trigger("sortBegin",r[0]),setHeadersCss(r[0],t,o.sortList),multisort(r[0],o.sortList),appendToTable(r[0]),!1}}})),o.cancelSelection&&t.each((function(){this.onselectstart=function(){return!1}})),r.bind("update",(function(e,a,n){$(o.selectorRemove,this).remove(),o.parsers=buildParserCache(this,t),buildCache(this),checkResort(r,a,n)})).bind("updateCell",(function(e,t,a,n){var i,s=this,c=$(this).find("tbody"),l=c.index($(t).closest("tbody"));i=[c.eq(l).find("tr").index($(t).closest("tr")),t.cellIndex],s.config.cache[l].normalized[i[0]][i[1]]=o.parsers[i[1]].format(getElementText(s,t,i[1]),s,t,i[1]),checkResort(r,a,n)})).bind("addRows",(function(e,t,a,i){var s,c=t.filter("tr").length,l=[],d=t[0].cells.length,u=$(this).find("tbody").index(t.closest("tbody"));for(s=0;s<c;s++){for(n=0;n<d;n++)l[n]=o.parsers[n].format(getElementText(this,t[s].cells[n],n),this,t[s].cells[n],n);l.push(o.cache[u].row.length),o.cache[u].row.push([t[s]]),o.cache[u].normalized.push(l),l=[]}checkResort(r,a,i)})).bind("sorton",(function(e,r,a,n){$(this).trigger("sortStart",this);var i=o.headerList.length;o.sortList=[],$.each(r,(function(e,t){t[0]<i&&o.sortList.push(r[e])})),updateHeaderSortCount(this,o.sortList),setHeadersCss(this,t,o.sortList),multisort(this,o.sortList),appendToTable(this,n),"function"==typeof a&&a(this)})).bind("appendCache",(function(e,t){appendToTable(this,t)})).bind("applyWidgetId",(function(e,t){getWidgetById(t).format(this)})).bind("applyWidgets",(function(e,t){applyWidget(this,t)})).bind("destroy",(function(e,t){$.tablesorterEditor.destroy(this,t)})),r.data()&&void 0!==r.data().sortlist?o.sortList=r.data().sortlist:u&&r.metadata()&&r.metadata().sortlist&&(o.sortList=r.metadata().sortlist),applyWidget(this,!0),o.sortList.length>0?r.trigger("sorton",[o.sortList,{},!o.initWidgets]):o.initWidgets&&applyWidget(this),this.hasInitialized=!0,o.debug&&$.tablesorterEditor.benchmark("Overall initialization time",$.data(this,"startoveralltimer")),r.trigger("tablesorter-initialized",this),"function"==typeof o.initialized&&o.initialized(this)}}))},this.destroy=function(e,t){var r=$(e),o=e.config;r.find("thead:first .tablesorter-resizer").remove(),r.unbind("update updateCell addRows sorton appendCache applyWidgetId applyWidgets destroy mouseup mouseleave").find(o.selectorHeaders).unbind("click mousedown mousemove mouseup").removeClass(o.cssHeader+" "+o.cssAsc+" "+o.cssDesc),!1!==t&&r.removeClass(o.tableClass)},this.addParser=function(e){var t,r=parsers.length,o=!0;for(t=0;t<r;t++)parsers[t].id.toLowerCase()===e.id.toLowerCase()&&(o=!1);o&&parsers.push(e)},this.addWidget=function(e){widgets.push(e)},this.formatFloat=function(e,t){if("string"!=typeof e||""===e)return e;e=!1!==t.config.usNumberFormat?e.replace(/,/g,""):e.replace(/[\s|\.]/g,"").replace(/,/g,"."),/^\s*\([.\d]+\)/.test(e)&&(e=e.replace(/^\s*\(/,"-").replace(/\)/,""));var r=parseFloat(e);return isNaN(r)?$.trim(e):r},this.isDigit=function(e){return/^[\-+(]?\d+[)]?$/.test(e.replace(/[,.'\s]/g,""))},this.regex=[/(^-?[0-9]+(\.?[0-9]*)[df]?e?[0-9]?$|^0x[0-9a-f]+$|[0-9]+)/gi,/(^([\w ]+,?[\w ]+)?[\w ]+,?[\w ]+\d+:\d+(:\d+)?[\w ]?|^\d{1,4}[\/\-]\d{1,4}[\/\-]\d{1,4}|^\w+, \w+ \d+, \d{4})/,/^0x[0-9a-f]+$/i,/^0/],this.characterEquivalents={a:"",A:"",c:"",C:"",e:"",E:"",i:"",I:"",o:"",O:"",S:"",u:"",U:""},this.replaceAccents=function(e){var t,r="[",o=this.characterEquivalents;if(!this.characterRegex){for(t in this.characterRegexArray={},o)"string"==typeof t&&(r+=o[t],this.characterRegexArray[t]=new RegExp("["+o[t]+"]","g"));this.characterRegex=new RegExp(r+"]")}if(this.characterRegex.test(e))for(t in o)"string"==typeof t&&(e=e.replace(this.characterRegexArray[t],t));return e},this.getData=function(e,t,r){var o,a,n="",i=$(e);return i.length?(o=!!$.metadata&&i.metadata(),a=" "+(i.attr("class")||""),!i.data()||void 0===i.data(r)&&void 0===i.data(r.toLowerCase())?o&&void 0!==o[r]?n+=o[r]:t&&void 0!==t[r]?n+=t[r]:a&&a.match(" "+r+"-")&&(n=a.match(new RegExp(" "+r+"-(\\w+)"))[1]||""):n+=i.data(r)||i.data(r.toLowerCase()),$.trim(n)):""},this.clearTableBody=function(e){$(e.tBodies).filter(":not(."+e.config.cssInfoBlock+")").empty()}}})();var ts=$.tablesorterEditor,dateFormat,locale,separator,worklog;$.fn.extend({tablesorterEditor:ts.construct}),ts.addParser({id:"text",is:function(e,t,r){return!0},format:function(e,t,r,o){var a=t.config;return e=$.trim(a.ignoreCase?e.toLocaleLowerCase():e),a.sortLocaleCompare?ts.replaceAccents(e):e},type:"text"}),ts.addParser({id:"currency",is:function(e){return/^\(?[\u00a3$\u20ac\u00a4\u00a5\u00a2?.]\d+/.test(e)},format:function(e,t){return ts.formatFloat(e.replace(/[^\w,. \-()]/g,""),t)},type:"numeric"}),ts.addParser({id:"ipAddress",is:function(e){return/^\d{2,3}[\.]\d{2,3}[\.]\d{1,3}[\.]\d{1,3}$/.test(e)},format:function(e,t){var r,o,a=e.split("."),n="",i=a.length;for(r=0;r<i;r++)2===(o=a[r]).length?n+="0"+o:n+=o;return ts.formatFloat(n,t)},type:"numeric"}),ts.addParser({id:"url",is:function(e){return/^(https?|ftp|file):\/\//.test(e)},format:function(e){return $.trim(e.replace(/(https?|ftp|file):\/\//,""))},type:"text"}),ts.addParser({id:"isoDate",is:function(e){return/^\d{4}[\/\-]\d{1,2}[\/\-]\d{1,2}$/.test(e)},format:function(e,t){return ts.formatFloat(""!==e&&new Date(e.replace(/-/g,"/")).getTime()||"",t)},type:"numeric"}),ts.addParser({id:"percent",is:function(e){return/\d%\)?$/.test(e)},format:function(e,t){return ts.formatFloat(e.replace(/%/g,""),t)},type:"numeric"}),ts.addParser({id:"usLongDate",is:function(e){return e.match(/^[A-Za-z]{3,10}\.? [0-9]{1,2}, ([0-9]{4}|'?[0-9]{2}) (([0-2]?[0-9]:[0-5][0-9])|([0-1]?[0-9]:[0-5][0-9]\s(AM|PM)))$/)},format:function(e,t){return ts.formatFloat(new Date(e).getTime()||"",t)},type:"numeric"}),ts.addParser({id:"time",is:function(e){return/^(([0-2]?[0-9]:[0-5][0-9])|([0-1]?[0-9]:[0-5][0-9]\s(am|pm)))$/.test(e)},format:function(e,t){return ts.formatFloat(new Date("2000/01/01 "+e).getTime()||"",t)},type:"numeric"}),ts.addParser({id:"digit",is:function(e){dateFormat=TableUtils.getLocaleDateFormat("yy-mm-dd"),locale=TableUtils.getLocale(),separator=TableUtils.mapSeparator(localStorage.getItem("tf-decimalSeparator"))||".",worklog=TableUtils.getWorklog();var t=TableUtils.getAnyValueType(e,separator,worklog,!0,dateFormat,locale);return null!==t&&t<3},format:function(e){var t=TableUtils.getAnyValueType(e,separator,worklog,!0,dateFormat,locale);return TableUtils.parseValueByType(t,e,separator,worklog)},type:"numeric"}),ts.addParser({id:"metadata",is:function(e){return!1},format:function(e,t,r){var o=t.config,a=o.parserMetadataName?o.parserMetadataName:"sortValue";return $(r).metadata()[a]},type:"numeric"}),ts.addWidget({id:"zebra",format:function(e){var t,r,o,a,n,i,s,c=e.config,l=new RegExp(c.cssChildRow,"i"),d=$(e).children("tbody:not(."+c.cssInfoBlock+")"),u=["even","odd"];for(u=c.widgetZebra&&c.hasOwnProperty("css")?c.widgetZebra.css:c.widgetOptions&&c.widgetOptions.hasOwnProperty("zebra")?c.widgetOptions.zebra:u,c.debug&&(i=new Date),s=0;s<d.length;s++)(t=$(d[s])).children("tr").length>1&&(a=0,r=t.find("tr:visible"),t.addClass("tablesorter-hidden"),r.each((function(){o=$(this),l.test(this.className)||a++,n=a%2==0,o.removeClass(u[n?1:0]).addClass(u[n?0:1])})),t.removeClass("tablesorter-hidden"));c.debug&&ts.benchmark("Applying Zebra widget",i)}})}(jQuery)},7196:function(e,t,r){"use strict";r.r(t);r(2759);var o=r(9497),a=r(3926);!function(e){try{AJS.bind("init.rte",(function(){function t(t,r){Confluence.Editor.tableToolbar?Confluence.Editor.tableToolbar.Buttons.splice(Confluence.Editor.tableToolbar.Buttons.length-r,0,t):e(document).bind("createContextToolbarRow.Toolbar.tf",(function(){var o=e(tinymce.activeEditor.plugins.customtoolbar.getToolbarRow());if(o.length){e(document).unbind("createContextToolbarRow.Toolbar.tf");var a=o.children();a.eq(a.length-r-1).after(t.render())}}))}var r=function(){var t=e(tinymce.activeEditor.selection.getNode());return t.is("table")||(t=t.parents("table").eq(0)),tinymce.activeEditor.selection.select(t[0]),t},n=function(t){if(!e("#rte-toolbar-row-default").is(".disabled")){var o,n=r(),i='<table class="wysiwyg-macro" data-macro-name="table-filter" data-macro-parameters="" data-macro-schema-version="1" data-macro-body-type="RICH_TEXT"><tbody><tr><td class="wysiwyg-macro-body">'+AJS.Rte.getEditor().serializer.serialize(n.clone()[0],{forced_root_block:!1})+"</td></tr></tbody></table>";(0,a.makeAjax)({type:"POST",contentType:"application/json; charset=utf-8",url:Confluence.getContextPath()+"/rest/tinymce/1/macro/definition",async:!1,data:e.toJSON({contentId:AJS.params.contentId||AJS.Meta.get("content-id")||AJS.params.pageId||AJS.Meta.get("page-id"),macroHtml:i}),dataType:"text",success:function(t){o=e.secureEvalJSON(t)}}),tinymce.confluence.macrobrowser.macroBrowserToolbarButtonClicked({presetMacroName:t,selectedMacro:o})}};t(new Confluence.Editor.Toolbar.Components.Group([new Confluence.Editor.Toolbar.Components.Button({text:"Filter table data",iconClass:"table-filter-insert",click:function(){n("table-filter")}}),new Confluence.Editor.Toolbar.Components.Button({text:"Create a pivot table",iconClass:"pivot-table-insert",click:function(){n("pivot-table")}}),new Confluence.Editor.Toolbar.Components.Button({text:"Create a chart from data series",iconClass:"table-chart-insert",click:function(){n("table-chart")}}),new Confluence.Editor.Toolbar.Components.Button({text:"Join, merge and query tables",iconClass:"table-joiner-insert",click:function(){n("table-joiner")}})]),2);var i=e("#wysiwygTextarea_ifr")[0].contentDocument;t(new Confluence.Editor.Toolbar.Components.Group([new Confluence.Editor.Toolbar.Components.Button({text:"Copy table",iconClass:"tf-copy-table",click:function(){if(!e("#rte-toolbar-row-default").is(".disabled")){tinymce.activeEditor.focus();var t=tinymce.activeEditor.selection.getRng(),o=r().addClass("tf-copy-table");i.execCommand("copy"),tinymce.activeEditor.selection.setRng(t),o.removeClass("tf-copy-table")}}})]),2),AJS.Confluence.PropertyPanel.Macro.registerButtonHandler("unwrap-tf",(function(t,r){o.default.gaUnwrapMacro(),AJS.Rte.BookmarkManager.storeBookmark();var a=e(r);AJS.trigger("tf-unwrap",a.attr("id")),AJS.Rte.getEditor().selection.select(r),AJS.Rte.getEditor().execCommand("mceInsertContent",!1,a.find(".wysiwyg-macro-body").html()),AJS.Rte.BookmarkManager.restoreBookmark()}))}))}catch(e){}}(jQuery);var n=r(3931);window.TableUtils=n.default,$.tablesorterEditor.addParser({id:"dateMacroSorter",is:function(e){var t=n.default.getLocaleDateFormat("yy-mm-dd"),r=n.default.getLocale();return n.default.getAnyValueType(e,".",n.default.getWorklog(),!0,t,r)===n.default.date},format:function(e){try{var t=n.default.getLocaleDateFormat("yy-mm-dd"),r=n.default.getLocale();return n.default.parseDate(e,t,r,!0).getTime()}catch(e){return 0}},type:"numeric"})}},__webpack_module_cache__={},deferred;function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var r=__webpack_module_cache__[e]={id:e,loaded:!1,exports:{}};return __webpack_modules__[e].call(r.exports,r,r.exports,__webpack_require__),r.loaded=!0,r.exports}__webpack_require__.m=__webpack_modules__,__webpack_require__.amdD=function(){throw new Error("define cannot be used indirect")},__webpack_require__.amdO={},deferred=[],__webpack_require__.O=function(e,t,r,o){if(!t){var a=1/0;for(c=0;c<deferred.length;c++){t=deferred[c][0],r=deferred[c][1],o=deferred[c][2];for(var n=!0,i=0;i<t.length;i++)(!1&o||a>=o)&&Object.keys(__webpack_require__.O).every((function(e){return __webpack_require__.O[e](t[i])}))?t.splice(i--,1):(n=!1,o<a&&(a=o));if(n){deferred.splice(c--,1);var s=r();void 0!==s&&(e=s)}}return e}o=o||0;for(var c=deferred.length;c>0&&deferred[c-1][2]>o;c--)deferred[c]=deferred[c-1];deferred[c]=[t,r,o]},__webpack_require__.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=function(e,t){for(var r in t)__webpack_require__.o(t,r)&&!__webpack_require__.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},__webpack_require__.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},function(){var e={5101:0};__webpack_require__.O.j=function(t){return 0===e[t]};var t=function(t,r){var o,a,n=r[0],i=r[1],s=r[2],c=0;if(n.some((function(t){return 0!==e[t]}))){for(o in i)__webpack_require__.o(i,o)&&(__webpack_require__.m[o]=i[o]);if(s)var l=s(__webpack_require__)}for(t&&t(r);c<n.length;c++)a=n[c],__webpack_require__.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return __webpack_require__.O(l)},r=self.webpackChunk=self.webpackChunk||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}();var __webpack_exports__=__webpack_require__.O(void 0,[7945,5546,8342,3926,4818,8353],(function(){return __webpack_require__(7196)}));__webpack_exports__=__webpack_require__.O(__webpack_exports__)})();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.stiltsoft.confluence.plugin.tablefilter.tablefilter:becee4dedd136c51c65705057a05438f', location = 'build/3120.js' */
(self.webpackChunk=self.webpackChunk||[]).push([[3120],{1230:function(e){if(void 0===(t=window.TableFilterTemplate=window.TableFilterTemplate||{}))var t={};t.totalRow=function(e,t){for(var a='<tr class="total-row synchrony-exclude">',l=e.length,i=0;i<l;i++)a+=1==e.numbering&&0==i?'<td class="confluenceTd" '+(e.isFireFox?"":'contenteditable="false"')+"></td>":'<th class="confluenceTh '+(e.totals[i]?"number":"")+" "+soy.$$escapeHtml(e.classes[i])+'" '+(e.isFireFox?"":'contenteditable="false"')+">"+(e.totals[i]?e.totals[i].total?soy.$$escapeHtml(e.totals[i].total):"0":i-e.numbering==0?e.title?soy.$$escapeHtml(e.title):soy.$$escapeHtml("Total\u200b"):"")+"</th>";return a+="</tr>"},goog.DEBUG&&(t.totalRow.soyTemplateName="TableFilterTemplate.totalRow"),t.totalCol=function(e,t){return'<th class="total-col synchrony-exclude confluenceTh '+(e.rowNumber>0?"number":"")+'" contenteditable="false"><p></p></th>'},goog.DEBUG&&(t.totalCol.soyTemplateName="TableFilterTemplate.totalCol"),t.labelChanger=function(e,t){return'<input class="tf-label-changer text" type="text" value="'+soy.$$escapeHtml(e.value)+'" style="width: '+soy.$$escapeHtml(e.width)+';" title="'+soy.$$escapeHtml("Press the Enter button to change the filter label")+'">'},goog.DEBUG&&(t.labelChanger.soyTemplateName="TableFilterTemplate.labelChanger"),t.editorCloseButton=function(e,t){return'<div class="aui-buttons close"><button type="button" class="aui-button" data-tooltip="'+soy.$$escapeHtml("Close")+'" original-title=""><span class="icon icon-close aui-icon aui-icon-small aui-iconfont-close-dialog">'+soy.$$escapeHtml("Close")+"</span></button></div>"},goog.DEBUG&&(t.editorCloseButton.soyTemplateName="TableFilterTemplate.editorCloseButton"),t.addFilterDialog=function(e,t){var a='<form class="aui top-label inline-dialog-form tf-add-filter-dialog" style="padding: 10px">';if(e.filters.length>0||e.globalfilter||e.columnhider){for(var l=e.filters,i=l.length,r=0;r<i;r++){var s=l[r];a+='<div class="'+soy.$$escapeHtml(s.type)+' tf-add-filter-column"><label for="'+soy.$$escapeHtml(s.type)+'">'+soy.$$escapeHtml("Filter Column")+'</label><select class="select '+soy.$$escapeHtml(s.type)+'" name="'+soy.$$escapeHtml(s.type)+'">';for(var o=s.columns,n=o.length,c=0;c<n;c++){var d=o[c];a+='<option value="'+soy.$$escapeHtml(d)+'">'+soy.$$escapeHtml(d)+"</option>"}a+="</select></div>"}a+='<div><label for="filter-type">'+soy.$$escapeHtml("Filter Type")+'</label><select class="select filter-type" name="filter-type">';for(var f=e.filters,p=f.length,u=0;u<p;u++){var m=f[u];a+='<option value="'+soy.$$escapeHtml(m.type)+'" title="'+soy.$$escapeHtml(m.desc)+'">'+soy.$$escapeHtml(m.name)+"</option>"}a+=(e.globalfilter?'<option value="globalfilter" title="'+soy.$$escapeHtml("Enter custom text query or regular expression to filter data in the whole table")+'">'+soy.$$escapeHtml("Filter whole table")+"</option>":"")+(e.columnhider?'<option value="columnhider" title="'+soy.$$escapeHtml("Select table columns to hide")+'">'+soy.$$escapeHtml("Hide Columns")+"</option>":"")+'</select></div><div class="date-format-param"><label for="date-format-input">'+soy.$$escapeHtml("Date format")+'</label><input class="date-format-input text" type="text" value="'+soy.$$escapeHtml(e.dateFormat)+'"></div><div class="buttons-container"><div class="buttons"><input class="aui-button" type="button" value="'+soy.$$escapeHtml("Add filter")+'" id="save"/><a class="cancel" id="cancel">'+soy.$$escapeHtml("Cancel")+"</a></div></div>"}else a+='<div class="aui-message info aui-message-info"><p>'+soy.$$escapeHtml("Filters are not available")+'</p></div><div class="buttons-container"><div class="buttons"><a class="cancel" id="cancel">'+soy.$$escapeHtml("Cancel")+"</a></div></div>";return a+="</form>"},goog.DEBUG&&(t.addFilterDialog.soyTemplateName="TableFilterTemplate.addFilterDialog"),t.changeSettingsDialog=function(e,t){return'<form class="aui top-label inline-dialog-form" style="padding: 10px" action="javascript: void(0)"><div class="change-settings-dialog-parameter"><label for="tf-cs-dialog-datepattern">'+soy.$$escapeHtml("Date format")+'</label><input type="text" class="text" id="tf-cs-dialog-datepattern" value="'+soy.$$escapeHtml(e.datepattern)+'"></div><div class="buttons-container"><div class="buttons"><input class="aui-button" type="button" value="'+soy.$$escapeHtml("Update")+'" id="tf-cs-save"/><a class="cancel" id="tf-cs-cancel">'+soy.$$escapeHtml("Cancel")+"</a></div></div></form>"},goog.DEBUG&&(t.changeSettingsDialog.soyTemplateName="TableFilterTemplate.changeSettingsDialog"),t.filter=function(e,a){return"selectfilter"==e.type?'<div class="filter-container selectfilter-element sortable"><label class="hideble"><span class="tf-label-name" title="'+soy.$$escapeHtml("Drag to reorder/remove the filter\nDouble-click to edit the filter label")+'">'+soy.$$escapeHtml(e.column)+'</span><span class="eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;=</span><span class="not-eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;&ne;</span></label><select class="select" name="'+soy.$$escapeHtml(e.column)+'" style="width: 150px;" multiple data-width="150px"></select>'+t.crossIcon(null)+"</div>":"userfilter"==e.type?'<div class="filter-container userfilter-element sortable input"><label class="hideble"><span class="tf-label-name" title="'+soy.$$escapeHtml("Drag to reorder/remove the filter\nDouble-click to edit the filter label")+'">'+soy.$$escapeHtml(e.column)+'</span><span class="eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;=</span><span class="not-eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;&ne;</span></label><div class="tf-resizeable" style="width: 150px;"><input class="user-filter text" type="text" name="'+soy.$$escapeHtml(e.column)+'" style="width: 100%; max-width: none;" placeholder="'+soy.$$escapeHtml("Start typing...\u200b")+'" data-width="150px"/></div>'+t.crossIcon(null)+"</div>":"numberfilter"==e.type?'<div class="filter-container numberfilter-element sortable"><label class="hideble"><span class="tf-label-name" title="'+soy.$$escapeHtml("Drag to reorder/remove the filter\nDouble-click to edit the filter label")+'">'+soy.$$escapeHtml(e.column)+'</span><span class="eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;=</span><span class="not-eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;&ne;</span></label><div class="range numbers" name="'+soy.$$escapeHtml(e.column)+'">'+soy.$$escapeHtml("from")+'<input class="number from text" type="text" name="'+soy.$$escapeHtml(e.column)+'" style="width: 90px;" placeholder="'+soy.$$escapeHtml("Type value")+'"/>'+soy.$$escapeHtml("to")+'<input class="number to text" type="text" name="'+soy.$$escapeHtml(e.column)+'" style="width: 90px;" placeholder="'+soy.$$escapeHtml("Type value")+'"/></div>'+t.crossIcon(null)+"</div>":"datefilter"==e.type?'<div class="filter-container datefilter-element sortable"><label class="hideble"><span class="tf-label-name" title="'+soy.$$escapeHtml("Drag to reorder/remove the filter\nDouble-click to edit the filter label")+'">'+soy.$$escapeHtml(e.column)+'</span><span class="eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;=</span><span class="not-eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;&ne;</span></label><div class="range dates" name="'+soy.$$escapeHtml(e.column)+'">'+soy.$$escapeHtml("from")+'<input class="date from text" type="text" name="'+soy.$$escapeHtml(e.column)+'" style="width: 93px;" autocomplete="off" placeholder="'+soy.$$escapeHtml("Pick date")+'"/>'+soy.$$escapeHtml("to")+'<input class="date to text" type="text" name="'+soy.$$escapeHtml(e.column)+'" style="width: 93px;" autocomplete="off" placeholder="'+soy.$$escapeHtml("Pick date")+'"/></div>'+t.crossIcon(null)+"</div>":"globalfilter"==e.type?'<div class="filter-container globalfilter-element sortable input"><label class="hideble"><span class="tf-label-name" title="'+soy.$$escapeHtml("Drag to reorder/remove the filter\nDouble-click to edit the filter label")+'">'+soy.$$escapeHtml("Filter whole table")+'</span><span class="eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;=</span><span class="not-eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;&ne;</span></label><div class="tf-resizeable" style="width: 150px;"><input class="global-filter text" type="text" style="width: 100%; max-width: none;" placeholder="'+soy.$$escapeHtml("Start typing...\u200b")+'" data-width="150px"/></div></div>':"columnhider"==e.type?'<div class="filter-container columnhider-element sortable"><label class="hideble"><span class="tf-label-name" title="'+soy.$$escapeHtml("Drag to reorder/remove the filter\nDouble-click to edit the filter label")+'">'+soy.$$escapeHtml("Hide columns")+'</span><span class="eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;=</span><span class="not-eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;&ne;</span></label><select class="column-select" style="width: 150px;" multiple data-width="150px"></select>'+t.crossIcon(null)+"</div>":"iconfilter"==e.type?'<div class="filter-container iconfilter-element sortable"><label class="hideble"><span class="tf-label-name" title="'+soy.$$escapeHtml("Drag to reorder/remove the filter\nDouble-click to edit the filter label")+'">'+soy.$$escapeHtml(e.column)+'</span><span class="eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;=</span><span class="not-eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;&ne;</span></label><select class="icon-select" name="'+soy.$$escapeHtml(e.column)+'" style="width: 150px;" multiple data-width="150px" data-html="true"></select>'+t.crossIcon(null)+"</div>":""},goog.DEBUG&&(t.filter.soyTemplateName="TableFilterTemplate.filter"),t.panel=function(e,a){return'<div class="tablefilter-outer-wrapper'+(e.isCloud?" tf-cloud-macro":"")+" "+(e.hideLabels?"hide-labels":"")+" "+("true"==e.hidePane?"hide-pane":"")+(e.hideControls?" hide-controls":"")+'" data-id="'+soy.$$escapeHtml(e.macroId)+'" data-pageid="'+soy.$$escapeHtml(e.pageId)+'" data-sessionid="'+soy.$$escapeHtml(e.sessionId)+'">'+(e.isEmail?"":(e.isCloud?'<div id="tf-preview-tutorial" class="preview-tutorial"><h2>'+soy.$$escapeHtml("Welcome to Table Filter!")+"</h2><h3>"+soy.$$escapeHtml("To start filtering:")+'</h3><ol type="1"><li>'+soy.$$filterNoAutoescape("Click \u003cdiv class=\u0022tutorial-img img-insert-btn\u0022\u003e\u003c/div\u003e to add the macro to the page")+"</li><li>"+soy.$$escapeHtml("Place one or multiple tables (including macros outputting tables) within the macro body")+"</li><li>"+soy.$$escapeHtml("Edit the macro in the page view or edit mode")+'</li></ol><div class="tf-tutorial-img tutorial-img"></div></div>':"")+("Table header"!=e.hidePane||e.isEditor?'<div id="comboBoxDiv-'+soy.$$escapeHtml(e.macroId)+"-"+soy.$$escapeHtml(e.sessionId)+'" class="tableFilterCbStyle"><div class="lockDisabled not-empty"><form class="aui tf-form aui-legacy-forms" name="inlinecommentform" action="javascript: void(0)"><div class="filter-container filter-icon filter-logo default '+(e.fd?"tf-fd":"")+'" title="'+soy.$$escapeHtml(AJS.format("Nothing filtered. Showing {0} rows",0))+'"></div><div class="filter-buttons-container"><div class="tf-menu-buttons aui-toolbar2" role="toolbar"><div class="aui-toolbar2-inner"><div class="aui-toolbar2-primary"><div class="tf-btn-container"><div id="tf-settings-row-'+soy.$$escapeHtml(e.macroId)+"-"+soy.$$escapeHtml(e.sessionId)+'" class="tf-btn-row"><div class="tf-settings-wrapper"><button id=\'filter-settings-'+soy.$$escapeHtml(e.macroId)+"-"+soy.$$escapeHtml(e.sessionId)+'\' class="filter-settings aui-button aui-button-subtle aui-dropdown2-trigger" aria-owns="filter-menu-view-'+soy.$$escapeHtml(e.macroId)+"-"+soy.$$escapeHtml(e.pageId)+"-"+soy.$$escapeHtml(e.sessionId)+'" aria-haspopup="true" data-container="" resolved="" aria-expanded="false"><span class="aui-icon aui-icon-small aui-iconfont-configure"></span><span class="tfac-unsaved">*</span></button>'+t.menu({macroId:e.macroId,pageId:e.pageId,sessionId:e.sessionId,editable:e.editable,disableSave:e.disableSave,isCloud:e.isCloud,inHeader:!1,isMacroViewContext:e.isMacroViewContext,courseBtn:e.courseBtn})+"</div></div></div></div></div></div></div>"+t.filters(e)+'<div class="filter-container show-n-rows-only-message"><label>'+soy.$$escapeHtml(AJS.format("Showing the first {0} rows",e.showNRowsifNotFiltered))+'</label></div><div class="filter-container empty-message"><label>'+soy.$$filterNoAutoescape("Start \u003ca class=\u0022tf-add-start\u0022\u003eadding filters\u003c/a\u003e in the filter tools menu.")+'</label></div></form></div><div class="lockEnabled"><div class="filter-container filter-icon filter-logo default" title="'+soy.$$escapeHtml(AJS.format("Nothing filtered. Showing {0} rows",0))+'"></div><div class="lockPosition"><div class="filter-container"><label class="hideble">'+soy.$$escapeHtml("The filter is disabled at the moment.")+'</label></div><div class="tf-menu-buttons aui-toolbar2" role="toolbar"><div class="aui-toolbar2-inner"><div class="aui-toolbar2-primary"><div class="tf-btn-container"><div class="tf-btn-row settings-row"><div class="tf-settings-wrapper"><button class="filter-settings aui-button aui-button-subtle aui-dropdown2-trigger" aria-owns="filter-menu-view-lock-'+soy.$$escapeHtml(e.macroId)+"-"+soy.$$escapeHtml(e.pageId)+"-"+soy.$$escapeHtml(e.sessionId)+'"><span class="aui-icon aui-icon-small aui-iconfont-configure"></span></button><div id="filter-menu-view-lock-'+soy.$$escapeHtml(e.macroId)+"-"+soy.$$escapeHtml(e.pageId)+"-"+soy.$$escapeHtml(e.sessionId)+'" class="aui-style-default aui-dropdown2 tfac-menu" style="display: none; z-index: 3001;"><div class="aui-dropdown2-section"><ul class="aui-list-truncate first"><li><a class="enableLock cursor-pointer"><span class="aui-icon aui-icon-small aui-iconfont-successful-build"></span>'+soy.$$escapeHtml("Enable all filters")+'</a></li></ul></div><div class="aui-dropdown2-section"><ul class="aui-list-truncate"><li><a class="export-file-pdf cursor-pointer"><span class="aui-icon aui-icon-small aui-iconfont-pdf"></span>'+soy.$$escapeHtml("Export to PDF")+'</a></li><li><a class="export-file-csv cursor-pointer"><span class="aui-icon aui-icon-small aui-iconfont-table"></span>'+soy.$$escapeHtml("Export to CSV")+'</a></li><li><a class="export-file-doc cursor-pointer"><span class="aui-icon aui-icon-small aui-iconfont-document"></span>'+soy.$$escapeHtml("Export to Word")+'</a></li><li><a class="export-file-print cursor-pointer"><span class="aui-icon aui-icon-small aui-iconfont-activity"></span>'+soy.$$escapeHtml("Print")+'</a></li></ul></div><div class="aui-dropdown2-section"><ul class="aui-list-truncate"><li><a target="_blank" href="https://docs.stiltsoft.com/display/TFAC/How+to+use+Table+filter+macro?from=tf-view"><span class="aui-icon aui-icon-small aui-iconfont-document-filled"></span>'+soy.$$escapeHtml("Documentation")+"</a></li><li>"+(e.isCloud?soy.$$filterNoAutoescape(e.courseBtn):'<a target="_blank" href="https://docs.stiltsoft.com/display/public/TFAC/Table+Filter+and+Charts+8.0.0?from=tf-view"><span class="aui-icon aui-icon-small aui-iconfont-new-help"></span>'+soy.$$escapeHtml("What\u0027s new")+"</a>")+'</li><li><a target="_blank" class="tf-menu-star" href="https://calendly.com/nparamonova/table-filter-and-charts-feedback"><span class="aui-icon aui-icon-small aui-iconfont-star"></span>'+soy.$$escapeHtml("Share feedback")+'</a></li></ul></div></div></div></div></div></div></div></div></div></div><div class="filter-container no-table-message"><div class="aui-message info aui-message-info"><p>'+soy.$$escapeHtml("Oops, it seems that you need to place a table or a macro generating a table within the Table Filter macro.")+'</p></div></div><div class="filter-container waiting-for-table"><div class="aui-message info aui-message-info"><p>'+soy.$$escapeHtml("The table is being loaded. Please wait for a bit ...")+'<span class="aui-icon aui-icon-wait" style="margin-left: 5px"></span></p></div></div><div class="tf-hider-wrapper" title="'+soy.$$escapeHtml("Hide filtration pane")+'"><div class="tf-hider"><span class="tf-hide-show-icon"></span></div></div></div><div id="tf-shower-'+soy.$$escapeHtml(e.macroId)+'" class="tf-shower-wrapper" title="'+soy.$$escapeHtml("Show filtration pane")+'"><div class="tf-shower"><span class="tf-hide-show-icon"></span></div></div>':'<div class="tf-floating-btn-container"><button id=\'filter-settings-'+soy.$$escapeHtml(e.macroId)+"-"+soy.$$escapeHtml(e.sessionId)+"' class=\"aui-button aui-button-compact aui-button-subtle filter-container filter-icon filter-logo default floating aui-dropdown2-trigger "+(e.fd?"tf-fd":"")+'" title="'+soy.$$escapeHtml(AJS.format("Nothing filtered. Showing {0} rows",0))+'" aria-owns="filter-menu-view-'+soy.$$escapeHtml(e.macroId)+"-"+soy.$$escapeHtml(e.pageId)+"-"+soy.$$escapeHtml(e.sessionId)+'" aria-haspopup="true" aria-expanded="false"><span class="aui-icon aui-icon-small"></span><span class="tfac-unsaved">*</span><span class="filter-count"></span></button></div>'+t.menu({macroId:e.macroId,pageId:e.pageId,sessionId:e.sessionId,editable:e.editable,disableSave:e.disableSave,isCloud:e.isCloud,inHeader:!0,isMacroViewContext:e.isMacroViewContext,courseBtn:e.courseBtn})+'<aui-inline-dialog id="comboBoxDiv-'+soy.$$escapeHtml(e.macroId)+"-"+soy.$$escapeHtml(e.sessionId)+'" alignment="bottom center" class="tf-inline-filters wiki-content"><div class="tableFilterCbStyle"><form class="aui tf-form aui-legacy-forms" name="inlinecommentform" action="javascript: void(0)">'+t.filters(e)+'</form></div></aui-inline-dialog><span data-aui-trigger aria-controls="comboBoxDiv-'+soy.$$escapeHtml(e.macroId)+"-"+soy.$$escapeHtml(e.sessionId)+'" class="tf-inline-filter trigger '+soy.$$escapeHtml(e.macroId)+"-"+soy.$$escapeHtml(e.sessionId)+'" title="'+soy.$$escapeHtml("Filter column")+'"></span><span class="tf-inline-filter btn '+soy.$$escapeHtml(e.macroId)+"-"+soy.$$escapeHtml(e.sessionId)+'" title="'+soy.$$escapeHtml("Filter column")+'"></span>'))+(e.isEditor?"":'<div id="tf-table-'+soy.$$escapeHtml(e.macroId)+'" class="tablefilter-table-wrapper '+(e.isCloud?"tf-cloud-table":"")+" "+("Table header"==e.hidePane?"table-header-filter":"")+'">'+soy.$$filterNoAutoescape(e.body)+"</div>")+"</div>"},goog.DEBUG&&(t.panel.soyTemplateName="TableFilterTemplate.panel"),t.filters=function(e,a){for(var l='<div class="sortable-container">',i=e.comboBoxes,r=i.length,s=0;s<r;s++){var o=i[s];l+='<div class="filter-container selectfilter-element sortable '+(o.inverse?"inverse":"")+'"><label class="hideble"><span class="tf-label-name" title="'+soy.$$escapeHtml("Drag to reorder/remove the filter\nDouble-click to edit the filter label")+'">'+soy.$$escapeHtml(o.label)+'</span><span class="eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;=</span><span class="not-eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;&ne;</span></label><select class="select '+(o.inverse?"inverse":"")+'" name="'+soy.$$escapeHtml(o.name)+'" style="width: '+soy.$$escapeHtml(o.columnWidth)+'px;" multiple data-width="'+soy.$$escapeHtml(o.columnWidth)+'px">';for(var n=o.options,c=n.length,d=0;d<c;d++){var f=n[d];l+='<option selected="selected"'+("-Empty-"==f?'class="tf-empty-option">'+soy.$$escapeHtml("-Empty-"):">"+soy.$$escapeHtml(f))+"</option>"}l+="</select>"+t.crossIcon(null)+"</div>"}for(var p=e.edits,u=p.length,m=0;m<u;m++){var h=p[m];l+='<div class="filter-container userfilter-element sortable input '+(h.inverse?"inverse":"")+'"><label class="hideble"><span class="tf-label-name" title="'+soy.$$escapeHtml("Drag to reorder/remove the filter\nDouble-click to edit the filter label")+'">'+soy.$$escapeHtml(h.label)+'</span><span class="eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;=</span><span class="not-eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;&ne;</span></label><div class="tf-resizeable" style="width: '+soy.$$escapeHtml(h.columnWidth)+'px;"><input class="user-filter text '+(h.inverse?"inverse":"")+'" type="text" name="'+soy.$$escapeHtml(h.name)+'" style="width: 100%; max-width: none;" value="'+soy.$$escapeHtml(h.defaultValue)+'" placeholder="'+soy.$$escapeHtml("Start typing...\u200b")+'" data-width="'+soy.$$escapeHtml(h.columnWidth)+'px"/></div>'+t.crossIcon(null)+"</div>"}for(var b=e.numberFilters,v=b.length,g=0;g<v;g++){var y=b[g];l+='<div class="filter-container numberfilter-element sortable '+(y.inverse?"inverse":"")+'"><label class="hideble"><span class="tf-label-name" title="'+soy.$$escapeHtml("Drag to reorder/remove the filter\nDouble-click to edit the filter label")+'">'+soy.$$escapeHtml(y.label)+'</span><span class="eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;=</span><span class="not-eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;&ne;</span></label><div class="range numbers" name="'+soy.$$escapeHtml(y.name)+'">'+soy.$$escapeHtml("from")+'<input class="number from text '+(y.inverse?"inverse":"")+'" type="text" name="'+soy.$$escapeHtml(y.name)+'" style="width: 90px;" value="'+soy.$$escapeHtml(y.defaultFromValue)+'" placeholder="'+soy.$$escapeHtml("Type value")+'"/>'+soy.$$escapeHtml("to")+'<input class="number to text '+(y.inverse?"inverse":"")+'" type="text" name="'+soy.$$escapeHtml(y.name)+'" style="width: 90px;" value="'+soy.$$escapeHtml(y.defaultToValue)+'" placeholder="'+soy.$$escapeHtml("Type value")+'"/></div>'+t.crossIcon(null)+"</div>"}for(var w=e.dateFilters,$=w.length,x=0;x<$;x++){var T=w[x];l+='<div class="filter-container datefilter-element sortable '+(T.inverse?"inverse":"")+'"><label class="hideble"><span class="tf-label-name" title="'+soy.$$escapeHtml("Drag to reorder/remove the filter\nDouble-click to edit the filter label")+'">'+soy.$$escapeHtml(T.label)+'</span><span class="eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;=</span><span class="not-eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;&ne;</span></label><div class="range dates" name="'+soy.$$escapeHtml(T.name)+'">'+soy.$$escapeHtml("from")+'<input class="date from text '+(T.inverse?"inverse":"")+'" type="text" autocomplete="off" name="'+soy.$$escapeHtml(T.name)+'" style="width: 93px;" value="'+soy.$$escapeHtml(T.defaultFromValue)+'" placeholder="'+soy.$$escapeHtml("Pick date")+'"/>'+soy.$$escapeHtml("to")+'<input class="date to text '+(T.inverse?"inverse":"")+'" type="text" autocomplete="off" name="'+soy.$$escapeHtml(T.name)+'" style="width: 93px;" value="'+soy.$$escapeHtml(T.defaultToValue)+'" placeholder="'+soy.$$escapeHtml("Pick date")+'"/></div>'+t.crossIcon(null)+"</div>"}for(var C=e.iconFilters,S=C.length,I=0;I<S;I++){var F=C[I];l+='<div class="filter-container iconfilter-element sortable '+(F.inverse?"inverse":"")+'"><label class="hideble"><span class="tf-label-name" title="'+soy.$$escapeHtml("Drag to reorder/remove the filter\nDouble-click to edit the filter label")+'">'+soy.$$escapeHtml(F.label)+'</span><span class="eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;=</span><span class="not-eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;&ne;</span></label><select class="icon-select '+(F.inverse?"inverse":"")+'" name="'+soy.$$escapeHtml(F.name)+'" style="width: '+soy.$$escapeHtml(F.columnWidth)+'px;" multiple data-width="'+soy.$$escapeHtml(F.columnWidth)+'px" data-html="true">';for(var k=F.options,H=k.length,A=0;A<H;A++){var D=k[A];l+='<option selected="selected"'+("-Empty-"==D?'class="tf-empty-option">'+soy.$$escapeHtml("-Empty-"):">"+soy.$$escapeHtml(D))+"</option>"}l+="</select>"+t.crossIcon(null)+"</div>"}if(l+=e.globalFilter?'<div class="filter-container globalfilter-element sortable input '+(e.globalFilter.inverse?"inverse":"")+'"><label class="hideble"><span class="tf-label-name" title="'+soy.$$escapeHtml("Drag to reorder/remove the filter\nDouble-click to edit the filter label")+'">'+soy.$$escapeHtml(e.globalFilter.label)+'</span><span class="eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;=</span><span class="not-eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;&ne;</span></label><div class="tf-resizeable" style="width: '+soy.$$escapeHtml(e.globalFilter.columnWidth)+'px;"><input class="global-filter text '+(e.globalFilter.inverse?"inverse":"")+'" type="text" style="width: 100%; max-width: none;" value="'+soy.$$escapeHtml(e.globalFilter.defaultValue)+'" placeholder="'+soy.$$escapeHtml("Start typing...\u200b")+'" data-width="'+soy.$$escapeHtml(e.globalFilter.columnWidth)+'px"/></div>'+t.crossIcon(null)+"</div>":"",e.hideColumns){l+='<div class="filter-container columnhider-element sortable '+(e.hideColumns.inverse?"inverse":"")+'"><label class="hideble"><span class="tf-label-name" title="'+soy.$$escapeHtml("Drag to reorder/remove the filter\nDouble-click to edit the filter label")+'">'+soy.$$escapeHtml(e.hideColumns.label)+'</span><span class="eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;=</span><span class="not-eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;&ne;</span></label><select class="column-select '+(e.hideColumns.inverse?"inverse":"")+'" style="width: '+soy.$$escapeHtml(e.hideColumns.columnWidth)+'px;" multiple data-width="'+soy.$$escapeHtml(e.hideColumns.columnWidth)+'px">';for(var B=e.hideColumns.options,J=B.length,R=0;R<J;R++){var M=B[R];l+='<option selected="selected"'+("-Empty-"==M?'class="tf-empty-option">'+soy.$$escapeHtml("-Empty-"):">"+soy.$$escapeHtml(M))+"</option>"}l+="</select>"+t.crossIcon(null)+"</div>"}return l+="</div>"},goog.DEBUG&&(t.filters.soyTemplateName="TableFilterTemplate.filters"),t.menu=function(e,t){return'<div id="filter-menu-view-'+soy.$$escapeHtml(e.macroId)+"-"+soy.$$escapeHtml(e.pageId)+"-"+soy.$$escapeHtml(e.sessionId)+'" class="aui-style-default aui-dropdown2 tfac-menu" style="display: none; z-index: 3001;"><div class="aui-dropdown2-section"><ul class="aui-list-truncate first">'+(e.editable&&!e.disableSave?'<li><a class="filter-save cursor-pointer tf-disabled-link"><span class="aui-icon aui-icon-small aui-iconfont-check"></span>'+soy.$$escapeHtml("Save changes")+'<span class="tfac-unsaved">*</span></a></li>':"")+(e.inHeader?'<li><a class="show-filter cursor-pointer" data-filter-type="globalfilter"><span class="aui-icon aui-icon-small aui-iconfont-search"></span>'+soy.$$escapeHtml("Filter whole table")+'</a></li><li><a class="show-filter cursor-pointer" data-filter-type="columnhider"><span class="aui-icon aui-icon-small aui-iconfont-remove-column"></span>'+soy.$$escapeHtml("Hide columns")+"</a></li>":'<li><a class="filter-add cursor-pointer"><span class="aui-icon aui-icon-small aui-iconfont-add"></span>'+soy.$$escapeHtml("Add filter")+"</a></li>")+'<li><a class="filter-reset cursor-pointer"><span class="aui-icon aui-icon-small aui-iconfont-cross"></span>'+soy.$$escapeHtml("Reset all filters")+"</a></li>"+(e.inHeader?"":'<li><a class="disableLock cursor-pointer"><span class="aui-icon aui-icon-small aui-iconfont-plan-disabled"></span>'+soy.$$escapeHtml("Disable all filters")+'</a></li><li><a class="filter-sort-reset cursor-pointer tf-disabled-link"><span class="aui-icon aui-icon-small aui-iconfont-refresh"></span>'+soy.$$escapeHtml("Reset column sorting")+'</a></li><li><a class="tf-change-settings cursor-pointer"><span class="aui-icon aui-icon-small aui-iconfont-more"></span>'+soy.$$escapeHtml("Modify Settings")+"</a></li>")+'<li><a class="get-tf-url cursor-pointer" '+(e.isCloud?'style="display: none;"':"")+'><span class="aui-icon aui-icon-small aui-iconfont-copy"></span>'+soy.$$escapeHtml("Copy the filter URL")+"</a></li>"+(e.editable?'<li><a class="tf-remove" '+(e.isMacroViewContext?"":'style="display: none;"')+'><span class="aui-icon aui-icon-small aui-iconfont-trash"></span>'+soy.$$escapeHtml("Remove the macro")+"</a></li>":"")+'</ul></div><div class="aui-dropdown2-section"><ul class="aui-list-truncate"><li><a class="export-file-pdf cursor-pointer"><span class="aui-icon aui-icon-small aui-iconfont-pdf"></span>'+soy.$$escapeHtml("Export to PDF")+'</a></li><li><a class="export-file-csv cursor-pointer"><span class="aui-icon aui-icon-small aui-iconfont-table"></span>'+soy.$$escapeHtml("Export to CSV")+'</a></li><li><a class="export-file-doc cursor-pointer"><span class="aui-icon aui-icon-small aui-iconfont-document"></span>'+soy.$$escapeHtml("Export to Word")+'</a></li><li><a class="export-file-print cursor-pointer"><span class="aui-icon aui-icon-small aui-iconfont-activity"></span>'+soy.$$escapeHtml("Print")+'</a></li></ul></div><div class="aui-dropdown2-section"><ul class="aui-list-truncate"><li><a target="_blank" href="https://docs.stiltsoft.com/display/TFAC/How+to+use+Table+filter+macro?from=tf-view"><span class="aui-icon aui-icon-small aui-iconfont-document-filled"></span>'+soy.$$escapeHtml("Documentation")+"</a></li><li>"+(e.isCloud?soy.$$filterNoAutoescape(e.courseBtn):'<a target="_blank" href="https://docs.stiltsoft.com/display/public/TFAC/Table+Filter+and+Charts+8.0.0?from=tf-view"><span class="aui-icon aui-icon-small aui-iconfont-new-help"></span>'+soy.$$escapeHtml("What\u0027s new")+"</a>")+'</li><li><a target="_blank" class="tf-menu-star" href="https://calendly.com/nparamonova/table-filter-and-charts-feedback"><span class="aui-icon aui-icon-small aui-iconfont-star"></span>'+soy.$$escapeHtml("Share feedback")+"</a></li></ul></div></div>"},goog.DEBUG&&(t.menu.soyTemplateName="TableFilterTemplate.menu"),t.fail=function(e,t){return'<div class="tablefilter-outer-wrapper error"><div class="tableFilterCbStyle"><div class="filter-container"><div class="aui-message warning aui-message-warning"><p>'+("no_table"==e.failureCause?soy.$$escapeHtml("Oops, it seems that you need to place a table or a macro generating a table within the Table Filter macro."):"license"==e.failureCause?soy.$$filterNoAutoescape(AJS.format("Table Filter Plugin license is not active, please \u003ca href=\u0022{0}/plugins/servlet/upm#manage/com.stiltsoft.confluence.plugin.tablefilter.tablefilter\u0022\u003egenerate a trial license or purchase\u003c/a\u003e the product.",e.contextPath)):"bad_request"==e.failureCause?soy.$$escapeHtml("Oops! We are sorry but the Table Filter macro cannot be previewed on Confluence page."):"no_params"==e.failureCause?soy.$$escapeHtml("Oops! It seems that the macro body is not reachable as the macro ID parameter is missing."):soy.$$escapeHtml("Oops! We are sorry but the current complex table cannot be filtered."))+'</p></div></div></div><div class="tablefilter-table-wrapper">'+soy.$$filterNoAutoescape(e.body)+"</div></div>"},goog.DEBUG&&(t.fail.soyTemplateName="TableFilterTemplate.fail"),t.crossIcon=function(e,t){return'<span class="aui-icon aui-icon-small aui-iconfont-cross" title="'+soy.$$escapeHtml("Clear filter")+'"></span>'},goog.DEBUG&&(t.crossIcon.soyTemplateName="TableFilterTemplate.crossIcon"),e.exports=t},3927:function(){$.fn.tableHeadFixer=function(e){return this.each((function(){t.call(this)}));function t(){var t=$.extend({},{head:!0,foot:!1,left:0,right:0,"z-index":1},e);function a(){if(t.head>0){var e=t.parent.scrollTop();t.table.dataset.scrollTop=e,t.headCells.forEach((function(t){t.style.top="".concat(e,"px")}))}if(t.left>0){var a=t.parent.scrollLeft();t.leftColumns.forEach((function(e){e.style.left="".concat(a,"px")}))}}function l(e,a){for(var l=t.left,r=0;r<l;r++){var s=e.children[r];if(s){var o=s.colSpan>1;o&&(r+=s.colSpan-1),s&&(!o||$(s).position().left+s.clientWidth<i())&&a(s)}}}function i(){return void 0===t.parentWidth&&(t.parentWidth=t.parent.width()),t.parentWidth}t.table=this,t.parent.bind("scroll.tf scroll-tf",a),t.head>0&&function(){for(var e=[],a=t.table.rows,l=0;l<t.head;l++){var i=a[l];if(i){var r=i.children;if(r.length)for(var s=0;s<r.length;s++){var o=r[s];o&&(o.classList.add("tf-floating"),o.classList.add("tf-float-head"),o.style.top=0,e.push(o))}else t.head++}}t.headCells=e}(),t.left>0&&function(){for(var e=t.table,a=[],i=e.rows,r=0;r<i.length;r++)l(i[r],(function(e){e.classList.add("tf-floating"),e.style.left=0,a.push(e)}));t.leftColumns=a}(),function(){if(t.head>0&&t.left>0)for(var e=t.table.rows,a=0;a<t.head;a++){var l=e[a];if(l)for(var i=l.children,r=0;r<t.left;r++)i[r]&&(i[r].style["z-index"]=3)}}(),t.table.dataset.scrollTop&&t.parent.scrollTop(t.table.dataset.scrollTop),$(window).resize(a)}}},3120:function(e,t,a){"use strict";a.r(t);a(3927);var l=a(5546),i=a(2166),r=a.n(i),s=a(3931),o=a(4238),n=a(6951),c=a.n(n),d=a(479),f=a(3924),p=a(9497),u=a(1230),m=a.n(u),h=a(2457),b=a(4138),v=a(4818);function g(e){return function(e){if(Array.isArray(e))return y(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return y(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return y(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,l=new Array(t);a<t;a++)l[a]=e[a];return l}var w=function(e){var t=this;if(d.default.adaptOldParamsTF(e),t.params=e,t.editorMacro=e.editorMacro,t.macroParams=e.macroParams,t.pageId=e.pageId,t.macroId=e.id,t.sessionId=e.sessionId||1,t.params.showNRows=e.showNRowsifNotFiltered,t.numbering=!!e.numbering&&e.numbering.toLocaleLowerCase(),t.dateFormat=(e.datepattern||"yy-mm-dd").replace("yyyy","yy"),t.localeDateFormat=s.default.getLocaleDateFormat(t.dateFormat),t.separator=e.separator,t.fixedRows="true"==e.limitHeight?1:e.limitHeight,t.fixedCols=e.fixedCols,t.heightValue=!!e.heightValue&&parseInt(e.heightValue),t.sorts=e.sorts,t.totalRow=e.totalrow?e.totalrow.split(","):[],t.totalCol=e.totalcol,t.cbState=null,t.allowRowList=null,t.tdNumbers=null,t.tables=null,t.rows=null,t.outerWrapper=$('.tablefilter-outer-wrapper[data-id="'+t.macroId+'"][data-pageid="'+t.pageId+'"][data-sessionid="'+t.sessionId+'"]'),t.tableWrapper=t.editorMacro?t.editorMacro.find(".tablefilter-table-wrapper"):t.outerWrapper.find("div#tf-table-"+t.macroId),t.tableWrapper=s.default.addExcerpt(t.tableWrapper,"tablefilter-table-wrapper").attr("id","tf-table-"+t.macroId).trigger("tf-added","tf-table-"+t.macroId),t.tableWrapper=s.default.addIframe(t.tableWrapper,"tablefilter-table-wrapper",(function(e){t.tableWrapper=e,t.getTable(),t.addNumbering(),t.setFiltrationPanel(),t.tableUpdated=!0,t.filterTable()})),t.previewTutorial=t.outerWrapper.find(".preview-tutorial"),t.comboBoxDiv=t.outerWrapper.find("#comboBoxDiv-".concat(t.macroId,"-").concat(t.sessionId)),t.filterIcon=t.outerWrapper.find(".filter-logo"),t.lockDisabled=t.comboBoxDiv.find("div.lockDisabled"),t.lockEnabled=t.comboBoxDiv.find("div.lockEnabled"),t.showBtn=t.outerWrapper.children(".tf-shower-wrapper").find(".tf-shower"),t.rawTables=null,t.columns=null,t.locale=s.default.getLocale(),t.hideParamName=t.pageId+"_"+t.macroId+"_hidden",t.menu=t.outerWrapper.find("#filter-menu-view-".concat(t.macroId,"-").concat(t.pageId,"-").concat(t.sessionId,", #filter-menu-view-lock-").concat(t.macroId,"-").concat(t.pageId,"-").concat(t.sessionId)),t.saveBtn=t.menu.find(".filter-save").not("body.content-preview .filter-save"),t.removeBtn=t.menu.find(".tf-remove"),t.resetSortBtn=t.menu.find(".filter-sort-reset"),t.isLockEnabled=e.isLockEnabled,t.tabs=e.tabs,t.worklog=s.default.getWorklog(e.worklog),t.sparkline=e.sparkline,t.sparkName="$sparkName"==e.sparkName?"":e.sparkName,t.isAND="OR"!=e.isOR,t.ddSeparator=e.ddSeparator.split(""),t.defaultDDSeparator=1!==t.ddSeparator.length||e.ddSeparators?"":t.ddSeparator[0],t.ddOperator=e.ddOperator.split(","),t.totalRows=[],t.tableUpdated=!0,t.outerWrapper.data("tf",t),t.shouldUpdateSelectOptions=e.updateSelectOptions,t.totalColName=e.totalColName,t.totalRowName=e.totalRowName,t.formatDecimal=r()({mark:t.separator,thousand:e.thousandSeparator!==t.separator?e.thousandSeparator:" "}),t.spakLinesFinished=!0,t.isCloud=t.outerWrapper.hasClass("tf-cloud-macro"),t.isEditor=e.isEditor,t.isPreview=o.default.isPreview(),0==t.tableWrapper.length)return null;t.fixURIHash(),t.orderFilters(e.order),t.getTable(),t.addNumbering(),t.sortTable(),t.appendTotalCol(),t.createSelects(t.comboBoxDiv),t.createDatePickers(t.comboBoxDiv),t.bindInputs(),t.bindReset(),t.bindDisable(),t.bindDOMChange(),t.bindInnerFiltration(),t.bindHideBtn(),t.bindAddFilter(),t.bindChangeSettings(),t.bindSave(),t.bindRemove(),t.bindExport(),t.bindSortReset(),t.bindCopyUrl(),t.bindGetUrlValues(),t.bindMakeInverse(),t.bindChangeLabel(),t.setSelects(),t.setFiltrationPanel(),t.makeSortable(),t.makeResizable(t.comboBoxDiv),t.filterTable(),t.makeTablesScrollable(),t.comboBoxDiv.find("form").bind("keydown",(function(e){return 13!=e.keyCode})),!t.editorMacro&&window.KarmaUser&&t.tables.find("a[data-username]").length&&setTimeout((function(){t.setFiltrationPanel(),t.filterTable()}),1e3)};function x(e){void 0!==this.total?this.total=s.default.multFloats(e,this.total):this.total=e}function T(e){this.total?this.total=s.default.addFloats(e,this.total):this.total=e}function C(e){null!=this.sum?(this.sum=s.default.addFloats(e,this.sum),this.count++):(this.sum=e,this.count=1),this.total=this.sum/this.count}function S(e){null!=this.total?this.total=Math.min(e,this.total):this.total=e}function I(e){null!=this.total?this.total=Math.max(e,this.total):this.total=e}function F(){null!=this.total?this.total++:this.total=1}function k(e){var t=2,a=Math.abs(e);a<1&&a>0&&(t=Math.ceil(Math.log(a)/Math.LN10*-1)+2);var l=Math.pow(10,t);return Math.round(e*l)/l}function H(e){return e.hasClass("selectfilter-element")?"Dropdown Filter":e.hasClass("userfilter-element")?"Free Text Filter":e.hasClass("numberfilter-element")?"Number Filter":e.hasClass("datefilter-element")?"Date Filter":e.hasClass("iconfilter-element")?"Icon Filter":e.hasClass("globalfilter-element")?"Global Filter":e.hasClass("columnhider-element")?"Hide Columns":void 0}function A(e,t){"undefined"!=typeof AP&&AP.resize(e,t)}w.prototype.orderFilters=function(e){if(e){var t=this.comboBoxDiv.find(".sortable-container");t.append(t.find(".iconfilter-element"));for(var a=t.find(".filter-container"),l=e.split(","),i=0;i<l.length;i++)t.append(a.eq($.inArray(i.toString(),l)))}},w.prototype.sortTable=function(){var e=this;function t(){e.sortOneTable($(this))}e.tables.bind("tablesorter-initialized.tf",(function(){var t=$(this),a=s.default.getTablesorterDateFormat(e.dateFormat);a&&t.find("thead th").addClass("dateFormat-"+a),t.append(t.children("div.resize-sensor"));var l=t.data("tablesorter");l&&(l.textSorter=function(e,t){return e.localeCompare(t)},l.ignoreCase=!1)})),e.sorts.length&&(e.tables.filter(".pivot-table-result").one("pivot-sorted",t),e.tables.not(".pivot-table-result").one("tablesorter-initialized.tf",t),e.tables.filter(".tablesorter").each(t))},w.prototype.sortTables=function(){var e=this;e.tables.each((function(){e.sortOneTable($(this))}))},w.prototype.sortOneTable=function(e){var t=this;if(t.sorts.length){var a=[];if($.each(t.sorts,(function(l,i){var r=-1===(i=i.replace(" (Asc)"," ").replace(" (Desc)"," ")).indexOf("")?1:0,o=i.replace("","").replace("","").trim();s.default.getCellPositions(t.rawTables[t.tables.index(e)],o).forEach((function(e){a.push([e,r])}))})),0===a.length)return void t.prepareExport(!0);t.sortWait=!0,t.resorting=!0,t.setMutationObserver(),e.hasClass("pivot-table-result")||t.updateSorter(e),t.restoreNumbering=!0,e.trigger("sorton",[a]),t.resorting=!1,t.resetSortBtn.addClass("tf-disabled-link"),t.setMutationObserver()}},w.prototype.normalizeTable=function(){var e=this;e.pauseUpdate=!0,e.setMutationObserver(!0),s.default.normalizeTable(e.tables,"data-tf-ready"),e.pauseUpdate=!1,e.setMutationObserver(!0),s.default.processMergedCells(e.tables.not(".pivot-table-result"))},w.prototype.addNumbering=function(){var e=this;s.default.hasLoadingContent(e.tableWrapper)||(e.numbering?(e.pauseUpdate=!0,e.setMutationObserver(),e.tables.each((function(t){var a=$(this),l=a.find("tr.pivot-header:eq(0)");if(0==l.find(".tf-numbering").length){var i=a.find("tr.pivot-header").length;l.prepend('<th class="confluenceTh tf-numbering" rowspan="'.concat(i,'"/>'))}var r,o=e.rows[t];0==a.find("colgroup col.tfn").length&&(r=a.hasClass("relative-table")?"0.1%":29+8*((""+o.length).length-1)+"px",a.find("colgroup").prepend('<col class="tfn synchrony-exclude" style="width: '+r+'"> '));o.each((function(a){for(var l=$(this),i=this.children,r=null,n=null,c=0;c<i.length;c++)if(!i[c].classList.contains("fake")){r=$(i[c]);break}i[0].classList.contains("tf-numbering")&&(n=$(i[0]));var d=r.attr("class");if(0===a)n?n.attr("contenteditable",!1):("th"===r.prop("tagName").toLowerCase()?l.prepend('<th class="'+d+' tf-numbering synchrony-exclude" contenteditable="false"/>'):l.prepend('<td class="'+d+' tf-numbering synchrony-exclude" contenteditable="false"/>'),e.rawTables[t][a].unshift(""),e.columns=s.default.getColumns(e.rawTables),e.rawIconTables&&e.rawIconTables[t][a].unshift(""));else{var f=-1!==e.numbering.indexOf("desc")?o.length-a:a;n?(n.attr("contenteditable",!1).html("<span>"+f+"</span>"),e.rawTables[t][a][0]=""+f):(l.prepend('<td class="'+d+' tf-numbering synchrony-exclude" contenteditable="false"><span>'+f+"</span></td>"),e.rawTables[t][a].unshift(""+f),e.rawIconTables&&e.rawIconTables[t][a].unshift(""))}})),e.updateSorter(a,!0),a.hasClass("metadata-summary-macro")&&e.tableWrapper.find("ol.aui-nav").eq(t).find("li a[href]").one("mouseup",(function(){e.pauseUpdate=!0,a.find(".tf-numbering").remove(),a[0].config&&a[0].config.headerContent&&a[0].config.headerContent.splice(0,1),a.trigger("updateAll",!1),e.pauseUpdate=!1}))})),e.pauseUpdate=!1,e.setMutationObserver()):(e.tables.each((function(t){var a=$(this).find(".tf-numbering");a.length&&(e.rawTables[t].forEach((function(e){return e.shift()})),a.remove())})),e.tables.find("colgroup col.tfn").remove()))},w.triggerTablesorterUpdateHelper=function(e,t){var a=$.tablesorter||$.tablesorterEditor,l=a.restoreHeaders;a.restoreHeaders=function(){};try{t()}catch(e){a.restoreHeaders=l,AJS.log("Error while updating sorting: ",e)}e.one("updateComplete",(function(){a.restoreHeaders=l})),setTimeout((function(){a.restoreHeaders=l}),2e3)},w.prototype.updateSorter=function(e,t){var a=this,l=$.tablesorter||$.tablesorterEditor;if(e.hasClass("pivot-cumulative")&&e.find("thead > tr > th:first-child").addClass("sorter-false"),e.hasClass("pivot-cumulative-recount")){e.trigger("update",!1);var i=e.data("sortBehavior");w.triggerTablesorterUpdateHelper(e,(function(){e.addClass("pivot-cumulative-refresh"),e.trigger("updateAll",[i,function(){e.removeClass("pivot-cumulative-refresh"),l.getWidgetById("staticRow").format(e)}])}))}else if(e.hasClass("appfire-table-plus-parms")){if(t&&!a.appFireUpdated&&org_swift_TableSorter&&getTableParms){a.appFireUpdated=!0;var r=new org_swift_TableSorter,s=getTableParms(e);r.customizeMacroTable(e,s.tableParms,s.columnAttributes)}}else if(e.trigger("update",!1),!a.resorting&&!e.hasClass("merged-header")){w.triggerTablesorterUpdateHelper(e,(function(){return e.trigger("updateAll",!1)}))}},w.prototype.createSelects=function(e){var t=this;e.find("select").change((function(e,a){var l=$(this);a.selected?l.find("option").filter((function(){return this.textContent===a.selected})).prop("selected",!0):a.deselected&&l.find("option").filter((function(){return this.textContent===a.deselected})).prop("selected",!1),t.comboBoxDiv.find(".search-choice").filter((function(){return s.default.clearString(this.textContent)==="-Empty-"})).addClass("tf-empty-option"),t.enableSaveBtn(),t.filterTable(l),t.gaFilterUpdated(this)})).each((function(){var e=$(this);e.data("html")&&e.find("option").each((function(){this.textContent=c().sanitize(this.textContent)})),e.chosenTF({no_results_text:e.data("html")?"No matches found":"No matches found. Press \u0027Enter\u0027 to add",placeholder_text_multiple:e.is(".icon-select")?"Select items...":"Click and start typing...",display_selected_options:!1,width:e.data("width"),addUserOption:!e.data("html"),search_contains:!e.data("html"),isHtml:e.data("html")})}))},w.prototype.createDatePickers=function(e){var t=this;AJS.DatePicker.prototype.localisations||(AJS.DatePicker.prototype.localisations=[]),t.datePickerOptions={overrideBrowserDefault:!0,languageCode:t.locale},e.find("input.date").each((function(){var e=$(this),a=t.getDateFormat(e),l=a.dateFormat,i=a.locale;s.default.initDatePickerLocalisations(i),t.initDatePicker(e,l,i);var r=e.val();e.val(s.default.convertToDate(r,l,i))}))},w.prototype.bindInputs=function(){var e=this,t=[],a=[];e.comboBoxDiv.delegate("input.user-filter, input.global-filter, input.date, input.number","input keyup",(function(){var l=$(this);clearTimeout(t[l]),clearTimeout(a[l]),t[l]=setTimeout((function(){e.enableSaveBtn(),e.filterTable(l)}),330),a[l]=setTimeout((function(){e.gaFilterUpdated(l)}),2e3)})),e.comboBoxDiv.delegate("input.date","change",(function(){e.enableSaveBtn(),e.filterTable($(this)),e.gaFilterUpdated(this)}))},w.prototype.gaFilterUpdated=function(e){var t=$(e).closest(".filter-container"),a=H(t),l=t.hasClass("inverse")?"inverse":"normal";a&&p.default.filterUpdated(a,l,"Table header"!==this.params.hidePane)},w.prototype.bindReset=function(){var e=this;e.menu.find(".filter-reset").click((function(t){$("body").trigger("filter-options-disable-and-reset",{type:"Reset Filters",pageMode:e.isPreview?"Macro Preview":"Page View"}),p.default.gaTFResetFilters(e.isPreview?"preview":"view"),e.clearFilters(e.comboBoxDiv),e.filterTable(),t.preventDefault()})),e.comboBoxDiv.on("click",".aui-iconfont-cross",(function(){var t=$(this).parent();e.hasFilterValues(t.find("select, input.text"))&&(e.clearFilters(t),e.filterTable())}))},w.prototype.clearFilters=function(e){e.find("input.user-filter, input.global-filter, input.date, input.number").val("");var t=e.find("select");t.find("option:selected").removeAttr("selected"),t.trigger("chosen:updated"),this.enableSaveBtn()},w.prototype.bindDisable=function(){var e=this,t=e.lockEnabled.show().width()+2;e.lockEnabled.hide(),e.comboBoxDiv.find("div.lockDisabled.not-empty").css("min-width",t>270?t:"270px"),e.menu.find(".disableLock").click((function(t){$("body").trigger("filter-options-disable-and-reset",{type:"Disable All Filters",pageMode:e.isPreview?"Macro Preview":"Page View"}),p.default.gaTFDisableFilters(e.isPreview?"preview":"view",!0),e.editorMacro||e.lockEnabled.width(e.lockDisabled.width()),e.lockEnabled.height(e.lockDisabled.height()),e.lockDisabled.hide(),e.lockEnabled.show(),e.isLockEnabled=!0,e.showTableWithoutFilters(),t.preventDefault()})),e.menu.find(".enableLock").click((function(t){p.default.gaTFDisableFilters(e.isPreview?"preview":"view",!1),e.editorMacro||e.lockEnabled.width(""),e.lockDisabled.show(),e.lockEnabled.hide(),e.isLockEnabled=!1,e.filterTable(),t.preventDefault()}))},w.prototype.bindDOMChange=function(){var e=this,t=null,a=null;if(e.editorMacro){var l,i=!1,r=e.tableWrapper.html(),o=!1,n=function(t){return t.is("table:not(.wysiwyg-macro)")&&-1===e.tables.index(t)},c=function(t,l){if(t.is("td")||t.is("th")||(t=t.parents("td, th").eq(0)),(parseInt(t.attr("rowspan"))>1||parseInt(t.attr("colspan"))>1)&&(e.normalizeTable(),e.showOrHideTables()),t.hasClass("tablesorter-header"))e.comboBoxDiv.find("[name]").filterByAttr("name",a).attr("name",l).each((function(){var e=$(this).parents(".filter-container:eq(0)").find("label .tf-label-name");e.text(e.text().replace(a,l))})),e.updateRawTables(!0);else{if(t.length){var i=t[0].parentNode,r=e.tables.index($(i).parents("table").eq(0));if(r>=0){var s=e.rawTables[r][i.rowIndex];s&&(s[t[0].cellIndex]=t.text())}e.setTextForFakeCells(t)}else e.updateRawTables();e.appendTotalRow(),e.appendTotalCol()||(e.tables.trigger("update",!1),e.updateRawTables()),e.appendSparklines(),e.sparkline&&e.fixedRows>0&&e.updateFixedCells()}a=null,e.setFiltrationPanel()},d=function(a,s){if(!(i||e.pauseUpdate||e.sorting||e.resorting||e.editorSave||a.hasClass("tablefilter-pagination")||a.parents(".tablefilter-pagination").length||a.is("br")||a.hasClass("tablesorter-savemyplace")))if(a.is(".tf-numbering")){var d=Confluence.MacroParameterSerializer.deserialize(e.editorMacro.attr("data-macro-parameters"));e.numbering=d.numbering?d.numbering.toLocaleLowerCase():""}else{if(a.hasClass("fake")){if(a.attr("colspan")||a.attr("rowspan"))return;a.removeClass("fake synchrony-exclude"),a.removeClass(a.getClassStartsWith(/tf-colspan-\d+/)),a.removeClass(a.getClassStartsWith(/tf-rowspan-\d+/)),a.css("display","")}clearTimeout(t);var f=l&&!l.is("td"),p=function(){if(l=null,"DOMNodeInserted"!==s||a.is("table")||0!==a.parents(".confluenceTable").length){var t=e.tableWrapper.html();if(t!=r)if(r=t,a.is("tr")||a.is("td")||a.is("th")||n(a)||o)o=!1,i=!0,e.getTable(),e.addNumbering(),e.setFiltrationPanel(),a.is("tr")?(e.addToAllowRowList(a),e.filterTable(),e.allowRowList=null):e.filterTable(),a.find("tr").show(),!f&&a.is("td")||a.parents("tr").show(),e.tables.not(".tablesorter").tablesorterEditor({cancelSelection:!1,dateFormat:e.dateFormat,locale:e.localeDateFormat}),a.is(".tablesorter-header")&&a.parents("table").eq(0).tablesorterEditor({cancelSelection:!1,dateFormat:e.dateFormat,locale:e.localeDateFormat}),e.appendTotalRow(),e.appendTotalCol()||e.tables.trigger("update",!1),e.appendSparklines(),n(a)?e.makeTablesScrollable():(e.sparkline&&e.fixedRows>0||a.is("th")||a.is("td")||a.is("tr"))&&e.updateFixedCells(),h.default.create(e,!0),i=!1;else c(a,a.text())}};n(a)?p():((a.is("tr")||a.hasClass("numberingColumn"))&&(o=!0),t=setTimeout(p,500)),l=a}};e.observerCallback=function(l){l.forEach((function(l){if(l.addedNodes.length)d($(l.addedNodes),"DOMNodeInserted");else if(l.removedNodes.length)d($(l.removedNodes),"DOMNodeRemoved");else if("characterData"==l.type){var i=$(l.target);!function(l,i,s){e.editorSave||e.sorting||e.resorting||(clearTimeout(t),null==a&&(a=i),t=setTimeout((function(){r=e.tableWrapper.html(),c(l,s)}),500))}(i,l.oldValue,i.text())}}))},e.observer=new MutationObserver(e.observerCallback),e.observerParams={childList:!0,subtree:!0,characterData:!0,characterDataOldValue:!0},e.observer.observe(e.tableWrapper[0],e.observerParams),e.observersTd=[],e.tableWrapper.find("td").each((function(){var t=new MutationObserver((function(e){e.forEach((function(e){var a=$(e.target),l=a.hasClass("tf-hidden-column");!l&&s.default.isRowVisible(a.parent()[0])||(t.disconnect(),a.attr(e.attributeName,e.oldValue),l?a.addClass("tf-hidden-column"):a.removeClass("tf-hidden-column"),t.observe(a[0],{attributes:!0,attributeOldValue:!0,attributeFilter:["class","data-highlight-colour"]}))}))}));t.observe(this,{attributes:!0,attributeOldValue:!0,attributeFilter:["class","data-highlight-colour"]}),e.observersTd.push(t)})),h.default.create(e,!1)}else{d=function(a,l){if(e.sorting||e.resorting||e.pauseUpdate)return!0;if(!a.hasClass("tablefilter-pagination")&&!a.parents(".tablefilter-pagination").length&&!s.default.isIgnoreUpdateNode(a)){if(l&&l.id=="tf-table-"+e.macroId||s.default.hasTableForUpdate(a)){var i=function(){e.getTable(),e.addNumbering()},r=function(){e.sortTables(),e.setFiltrationPanel(),e.tableUpdated=!0,e.filterTable(),(e.fixedRows||e.fixedCols)&&e.makeTablesScrollable()};if(clearTimeout(t),a.hasClass("tfac-tj")){if(a.closest('.tj-source:not(.table-excerpt)[data-tj-not-ready="false"]').length)return!0;i(),r()}else t=setTimeout((function(){i(),setTimeout(r,1e3)}),50);return!0}return s.default.hasRowForUpdate(a)?(clearTimeout(t),t=setTimeout((function(){e.getTable(),e.addNumbering(),e.setFiltrationPanel(),e.sortTables(),e.tableUpdated=!0,e.filterTable(),(e.fixedRows||e.fixedCols)&&e.updateFixedCells()}),10),!0):s.default.hasCharsForUpdate(a,l)||s.default.hasCellUpdate(a)?(clearTimeout(t),t=setTimeout((function(){e.updateRawTables(),e.setFiltrationPanel(),e.filterTable()}),10),!0):void 0}};e.observerCallback=function(e){s.default.mutationObserverFilter(e,d)},e.observer=new MutationObserver(e.observerCallback),e.observerParams={childList:!0,subtree:!0},e.tableWrapper.each((function(){e.observer.observe(this,e.observerParams)})),e.tableWrapper.bind("DOMCharacterDataModified changed.chk",(function(a){s.default.isIgnoreCharacterModified(a)||(clearTimeout(t),t=setTimeout((function(){e.updateRawTables(!0),e.setFiltrationPanel()}),50))})),s.default.bindTaskList(e.tableWrapper,(function(){e.updateRawTables(),e.setFiltrationPanel(),e.appendTotalRow()})),e.tabs&&s.default.onTabChange(e.tableWrapper,(function(){e.getTable(),e.addNumbering(),e.setFiltrationPanel(),e.sortTables(),e.tableUpdated=!0,e.filterTable(),(e.fixedRows||e.fixedCols)&&e.updateFixedCells()})),e.tableWrapper.bind("tf-save",(function(){return e.outerWrapper.trigger("tf-save"),!1}))}},w.prototype.setMutationObserver=function(e){var t=this;if(t.observer)if(t.sorting||t.resorting||t.pauseUpdate)e||(t.prevRowsLength=0,t.rows.forEach((function(e){t.prevRowsLength+=e.length}))),t.observerCallback(t.observer.takeRecords()),t.observer.disconnect();else{if(!e){if(t.observerRestoring)return;t.observerRestoring=!0,t.getTable(!0);var a=0;t.rows.forEach((function(e){a+=e.length})),null!=t.prevRowsLength&&a!=t.prevRowsLength&&(t.prevRowsLength=a,t.tableUpdated=!0,t.setFiltrationPanel(),t.filterTable()),t.observerRestoring=!1}t.tableWrapper.each((function(){t.observer.observe(this,t.observerParams)}))}},w.prototype.processInnerFiltration=function(e,t){var a=!1;return e&&e.tf&&(e.tf.blockEvent=!0,e.tf.filterTable(),e.tf.pauseUpdate=!0,e.tf.setMutationObserver(!0),e.tf.tables.each((function(t){var l=e.tf.tables.eq(t);if(e.tf.rows[t].each((function(l){var i=$(this);if(l>e.tf.headerSize[t]&&(e.tf.cbState[t][l-1]||(i.remove(),a=!0)),e.tf.tdNumbers[t].length){var r=$(i[0].children);$.each(e.tf.tdNumbers[t],(function(e,t){r.eq(t).remove(),a=!0}))}})),e.tf.tdNumbers[t].length){var i=l.hasClass("relative-table"),r=0,s=$(this).children("colgroup").find("col");$.each(e.tf.tdNumbers[t],(function(e,t){s.eq(t).remove(),i&&"none"!==s[t].style.display&&(r+=parseFloat(s[t].style.width))})),r>0&&(l.css("width",parseFloat(l[0].style.width)*(1-r/100)+"%"),s.each((function(a){-1===e.tf.tdNumbers[t].indexOf(a)&&(this.style.width=parseFloat(this.style.width)/(1-r/100)+"%")})))}}))),a&&(e.tf.tables.find(".fake").each((function(){var e=$(this);"none"!==e.css("display")&&e.removeClass("fake")})),s.default.processMergedCells(e.tf.tables,!0)),t&&e&&e.tf&&this.filterTable(),e&&e.tf&&(e.tf.pauseUpdate=!1,e.tf.setMutationObserver(!0),e.tf.blockEvent=!1),a},w.prototype.bindInnerFiltration=function(){var e=this,t=[];e.tableWrapper.find(".pivot-content, .tablefilter-table-wrapper").each((function(){var a=$(this);a.parents("table, .tablefilter-table-wrapper, .pivot-content, .table-joiner").eq(0).is(e.tableWrapper)&&t.push(a.attr("id"))})),t.length&&(e.tableWrapper.bind("tf-filtered pt-calculated",(function(a,l){if(-1!==t.indexOf(l.id)){"tf-filtered"!==a.type&&(e.tableUpdated=!0);var i=e.processInnerFiltration(l,!0);return e.getTable(!0),i&&e.setFiltrationPanel(),l.tf||(e.addNumbering(),(e.fixedRows||e.fixedCols)&&e.makeTablesScrollable(),e.setFiltrationPanel()),e.filterTable(),!1}})),e.tableWrapper.bind("pivot-collapse-change",(function(a,l){if(-1!==t.indexOf(l.id))return e.showOrHideTables(),!1})),e.tableWrapper.bind("pivot-collapse-change pivot-collapsed",(function(){e.addNumbering(),e.appendTotalRow(),e.appendTotalCol()}))),e.tableWrapper.bind("tf-export-ready",(function(t,a){return e.macroId===a.macroId})),e.processInnerFiltration(e.tableWrapper.data("inner-filter"),!1)&&e.getTable(!0)},w.prototype.bindHideBtn=function(){var e=this,t=parseInt(e.outerWrapper.css("margin-top"));e.comboBoxDiv.find(".tf-hider").click((function(){var a=e.tables.eq(0),l=e.comboBoxDiv.outerHeight(!0);e.comboBoxDiv.css({position:"absolute",top:e.comboBoxDiv.position().top-l});var i=a.outerWidth()-2,r={"margin-top":2*t+l+"px"};e.outerWrapper.css(r),e.comboBoxDiv.animate({top:a.position().top,opacity:0,width:i,height:14},{complete:function(){e.comboBoxDiv.hide().css({width:"",height:"",position:""}),r={"margin-top":t+"px"},e.outerWrapper.animate(r,{complete:function(){e.outerWrapper.css("width","")}}),e.showBtn.show().width(i)},duration:300}),o.default.setCookie(e.hideParamName,!0)})),e.showBtn.click((function(){var a=e.tables.eq(0);e.showBtn.hide(),e.comboBoxDiv.show();var l=e.comboBoxDiv.width(),i=e.comboBoxDiv.height(),r=e.comboBoxDiv.outerHeight(!0);e.comboBoxDiv.css({position:"absolute",opacity:0}),e.comboBoxDiv.css({width:a.width()-2,height:14});var s={"margin-top":2*t+r+"px"};e.outerWrapper.animate(s,{complete:function(){e.comboBoxDiv.css({top:0}).animate({top:-r,opacity:1,width:l,height:i},{complete:function(){e.comboBoxDiv.css({position:"",width:"",height:""}),e.outerWrapper.css({"margin-top":t+"px",width:""})},duration:300})}}),o.default.setCookie(e.hideParamName,!1)}))},w.prototype.bindTableEvents=function(){var e=this;if(!e.editorMacro)if("Table header"===e.params.hidePane)e.initInlineFilterButton();else{var t=e.tables.eq(0),a=t.data("iframe"),l=e.fixedRows>0?t.parent():t.eq(0);l.unbind("mouseover.tf"+e.macroId).bind("mouseover.tf"+e.macroId,(function(){var t=l.offset(),i=(null==a?void 0:a.offset())||{top:0,left:0};e.showBtn.parent().offset({top:t.top+i.top-14,left:t.left+i.left+l.parent().scrollLeft()}),e.showBtn.css("visibility","visible"),e.showBtn.width(l.outerWidth()-2),e.showBtn.css("max-width",e.outerWrapper.width()-2+"px")})).unbind("mouseout.tf"+e.macroId).bind("mouseout.tf"+e.macroId,(function(){e.showBtn.css("visibility","")}))}e.tables.unbind("sortStart.tfs"+e.macroId).bind("sortStart.tfs"+e.macroId,(function(){e.sorting=!0,e.setMutationObserver()})).unbind("sortEnd.tfs"+e.macroId).bind("sortEnd.tfs"+e.macroId,(function(){if(e.sorting=!1,e.getTable(!0),e.resetSortBtn.removeClass("tf-disabled-link"),e.restoreNumbering?(e.restoreNumbering=!1,e.addNumbering(),e.filterTable()):e.filtered?e.filterContainer(e.getFilterContainers()):e.params.showNRows>0&&!e.isLockEnabled&&e.showOrHideTables(),e.totalRows){var t=e.totalRows[e.tables.index(this)];t&&$(this).append(t)}e.fixedRows>1&&e.updateFixedCells(),e.setMutationObserver(),h.default.create(e)}))},w.prototype.bindAddFilter=function(){var e=this,t=AJS.InlineDialog(e.comboBoxDiv.find(".lockDisabled .filter-settings"),"tf-add-filter-"+e.macroId,(function(t,a,l){t.css({"min-height":"166px"});var i=[],r=e.getFilters(),s=[{type:"selectfilter",name:"Dropdown Filter",desc:"Select from the list of column unique values",columns:[],existing:r.selectfilters},{type:"userfilter",name:"Free Text Filter",desc:"Enter custom text query or regular expression to filter data in the selected column",columns:[],existing:r.userfilters},{type:"numberfilter",name:"Number Filter",desc:"Specify the number range to filter data in the selected column",columns:[],existing:r.numberfilters},{type:"datefilter",name:"Date Filter",desc:"Select the time period to filter dates in the selected column",columns:[],existing:r.datefilters},{type:"iconfilter",name:"Visual Filter",desc:"Select icons, emoticons, images or state of checkboxes from the list of unique column values",columns:[],existing:r.iconfilters}];$.each(s,(function(t,a){$.each(e.columns,(function(e,t){-1==$.inArray(t.replace(/\,/g,""),a.existing)&&a.columns.push(t)})),a.columns.length&&i.push(a)})),t.html(m().addFilterDialog({filters:i,globalfilter:!r.globalfilter,columnhider:!r.columnhider,dateFormat:e.dateFormat})),l()}),{offsetX:-20,width:270,noBind:!0,gravity:"n",initCallback:function(){var t=this,a=t.popup.find(".filter-type"),l=t.popup.find(".date-format-param"),i=l.find(".date-format-input"),r=t.popup.find(".tf-add-filter-column select");r.filter(":not(:first)").parent().hide(),a.change((function(){var e=a.val(),i=r.filter((function(){return"none"!==this.parentNode.style.display})).val();t.popup.find("div.tf-add-filter-column").hide(),t.popup.find("div."+e).show().find("option").filter((function(){return this.textContent==i})).attr("selected","selected"),"datefilter"===e?l.fadeIn():l.fadeOut(),a.attr("title",a.find("option:selected").attr("title"))})),a.trigger("change");var o=new Set;e.comboBoxDiv.find("span.tf-label-name").each((function(){o.add(this.innerText)})),r.change((function(){if(!o.has(this.value)){var t=e.dateFormat,l=e.detectFilterType(this.value);if(l){"datefilter"===l&&(i.val(e.dateFormat),e.dateFormat=t);var r=a.find("option[value=".concat(l,"]"));r.length&&(r.attr("selected","selected"),a.change())}}})),r.first().find("option").each((function(){if(!o.has(this.value))return $(this).attr("selected","selected").parent().trigger("change"),!1})),t.popup.find("#cancel").click((function(){return t.hide(),A(),!1})),t.popup.find("#save").click((function(){$(this).prop("disabled",!0);var l=a.val();return"datefilter"===l&&e.changeSettings(i.val().trim()),e.addFilter(l,t.popup.find("select."+l).val()),t.hide(),$("body").trigger("filter-added-deleted",{action:"Filter Added from Panel",type:l,pageMode:e.isPreview?"Macro Preview":e.editorMacro?"Editor":"Page View"}),p.default.panelFilterAdded(l,"normal"),A(),!1})),s.default.dateFormatAutocomplete(i,t.popup),e.editorMacro&&t.popup.click((function(){return!1}))},hideCallback:function(){A()}}),a=("Table header"!==e.params.hidePane?e.comboBoxDiv:e.outerWrapper).find("#filter-settings-".concat(e.macroId,"-").concat(e.sessionId));a.bind("click",(function(){return p.default.menuTFClicked()})),e.menu.find(".filter-add").bind("click",(function(l){return"undefined"!=typeof AP&&l.clientY+190>$("body").height()-10&&l.clientY-240<0&&AP.resize("100%",l.clientY+190),t.show(),"false"!=e.menu.attr("aria-hidden")&&void 0===e.menu.attr("open")||a.trigger("aui-button-invoke"),!1})),e.comboBoxDiv.find(".tf-add-start").click((function(t){return e.isCloud?(a.trigger("mousedown",[t]),a.trigger("click")):a.trigger("aui-button-invoke"),e.menu.find(".filter-add").blinkFromClass("active aui-dropdown2-active"),!1}))},w.prototype.addFilter=function(e,t){var a=this,l=$(m().filter({type:e,column:t}));return a.comboBoxDiv.find(".sortable-container").append(l),"selectfilter"===e||"columnhider"===e||"iconfilter"===e?("iconfilter"!==e||a.rawIconTables||a.updateRawIconTables(),a.createSelects(l)):"datefilter"===e&&a.createDatePickers(l),"selectfilter"===e&&l.find("select").data("ddSeparator",a.defaultDDSeparator),a.setFiltrationPanel(),a.makeResizable(l),a.enableSaveBtn(),l},w.prototype.bindChangeSettings=function(){var e=this,t=AJS.InlineDialog(e.outerWrapper.find(".lockDisabled .filter-settings, .filter-logo.floating"),"tf-change-settings-"+e.macroId,(function(t,a,l){t.css({"min-height":"120px"}),t.html(m().changeSettingsDialog({datepattern:e.dateFormat})),l()}),{offsetX:-20,width:270,noBind:!0,gravity:"n",arrowOffsetX:"Table header"!==e.params.hidePane?0:-12,initCallback:function(){var t=this,a=t.popup.find("#tf-cs-dialog-datepattern");s.default.dateFormatAutocomplete(a,t.popup),t.popup.find("#tf-cs-cancel").click((function(){return t.hide(),A(),!1})),t.popup.find("#tf-cs-save").click((function(){return e.changeSettings(a.val()),t.hide(),A(),!1})),e.editorMacro&&t.popup.click((function(){return!1}))},hideCallback:function(){A()}});e.menu.find(".tf-change-settings").bind("click",(function(a){return t.show(),"false"!=e.menu.attr("aria-hidden")&&void 0===e.menu.attr("open")||e.outerWrapper.find("#filter-settings-".concat(e.macroId,"-").concat(e.sessionId)).trigger("aui-button-invoke"),!1}))},w.prototype.changeSettings=function(e){var t=this;t.dateFormat!=e&&(t.enableSaveBtn(),t.dateFormat=e,t.updateDateFilters(),t.filterTable())},w.prototype.updateDateFilters=function(){var e=this;e.comboBoxDiv.find("input.date").each((function(){var t=$(this),a=e.getDateFormat(t),l=a.dateFormat,i=a.locale,r=t.attr("dateformat");if(l!=r){var o=t.val(),n=null;try{n=s.default.parseDate(o,r,i)}catch(e){}var c=$(t[0].outerHTML);t.replaceWith(c),c.attr("value",null!=n?s.default.formatDate(n,l,i):o),$(".aui-datepicker-dialog").remove(),e.initDatePicker(c,l,i)}}))},w.prototype.initDatePicker=function(e,t,a){var l=this;if(e.attr("dateformat",t),e.attr("locale",a),e.attr("placeholder",t),!t.match(/[iw]/)){l.datePickerOptions.dateFormat=s.default.getDateFormatWithoutTime(t),l.datePickerOptions.languageCode=a;var i=e.datePicker(l.datePickerOptions)}t.toLowerCase().indexOf("hh:mm")>=0?(e.width(120),e.bind("focus click keyup input paste",(function(){setTimeout((function(){i.setDate(s.default.getDateTimeObject(e.val(),t).dateString)}),1)}))):e.width(93)},w.prototype.getDateFormat=function(e){var t=this,a=e.attr("name"),l=t.dateFormat,i=t.locale;return t.getDateMacroFormatIfPresent(a)||{dateFormat:l,locale:i}},w.prototype.getDateMacroFormatIfPresent=function(e){for(var t=this,a=0;a<t.rows.length;a++){var l=s.default.getCellPosition(t.rawTables[a],e);if(null!=l){var i=t.rows[a];if(0===i.parents("#issuetable, .spreadsheets-sheet").length)for(var r=1;r<i.length;r++){var o=i[r].children;if(o.length>l){var n=o[l].getElementsByTagName("time");if(n.length){var c=$(n);if(c.is('[data-macro-name="page-info"]'))break;var d=[t.localeDateFormat,t.dateFormat];return t.isCloud&&"es_ES"===t.locale?function(){-1==d.indexOf("dd M yy")&&d.push("dd M yy");var e=[];d.forEach((function(t){return-1!==t.indexOf("M")&&e.push(t.replace("M","M."))})),d=d.concat(e)}():-1==d.indexOf("dd.mm.yy")&&d.unshift("dd.mm.yy"),s.default.getDateMacroDateFormat(c,t.locale,d)}}}}}},w.prototype.bindSave=function(){var e=this;e.saveBtn.click((function(t){var a=e.saveBtn;if(!a.hasClass("tf-disabled-link")){p.default.gaTFSaveChanges(),$("body").trigger("filter-options-save"),e.params.liveMode&&(p.default.gaTFInsert("TF Saved in Live Mode",e.tables.length),e.params.liveMode=!1);var l=e.getFilters(),i={pageId:e.pageId,id:e.macroId,defaults:l.defaults.join(","),width:l.width.join(","),inverse:l.inverse.join(","),order:l.order.join(","),labels:e.getFilterLabels(),ddSeparator:e.defaultDDSeparator?e.defaultDDSeparator:l.ddSeparator.join(""),ddOperator:l.ddOperator.join(","),datepattern:e.dateFormat,hidePane:e.params.hidePane};i.ddSeparator=i.ddSeparator.replace(/ /g,"\\u0020");var r=function(e){for(var t=[],a=0;a<e.length;a++)""==e[a]?t.push(""):t.push(e[a]);return t.join(",")};l.selectfilters.length&&(i.column=r(l.selectfilters)),l.userfilters.length&&(i.userfilter=r(l.userfilters)),l.numberfilters.length&&(i.numberfilter=r(l.numberfilters)),l.datefilters.length&&(i.datefilter=r(l.datefilters)),l.iconfilters.length&&(i.iconfilter=r(l.iconfilters)),l.globalfilter&&(i.globalfilter="true"),l.columnhider&&(i.columnhider="true");var s=function(){a.addClass("tf-disabled-link"),e.outerWrapper.add(a).find(".tfac-unsaved").hide(),e.filterIcon.removeClass("unsaved"),e.removeBtn.css("display","")};e.editorMacro?(i.column?e.macroParams.column=i.column:delete e.macroParams.column,i.userfilter?e.macroParams.userfilter=i.userfilter:delete e.macroParams.userfilter,i.numberfilter?e.macroParams.numberfilter=i.numberfilter:delete e.macroParams.numberfilter,i.datefilter?e.macroParams.datefilter=i.datefilter:delete e.macroParams.datefilter,i.globalfilter?e.macroParams.globalFilter=i.globalfilter:delete e.macroParams.globalFilter,i.columnhider?e.macroParams.hideColumns=i.columnhider:delete e.macroParams.hideColumns,i.iconfilter?e.macroParams.iconfilter=i.iconfilter:delete e.macroParams.iconfilter,i.width?e.macroParams["cell-width"]=i.width:delete e.macroParams["cell-width"],i.defaults?e.macroParams.default=i.defaults:delete e.macroParams.default,i.inverse?e.macroParams.inverse=i.inverse:delete e.macroParams.inverse,i.datepattern?e.macroParams.datepattern=i.datepattern:delete e.macroParams.datepattern,i.labels?e.macroParams.labels=i.labels:delete e.macroParams.labels,i.ddSeparator?e.macroParams.ddSeparator=i.ddSeparator:delete e.macroParams.ddSeparator,i.ddOperator?e.macroParams.ddOperator=i.ddOperator:delete e.macroParams.ddOperator,e.editorMacro.attr("data-macro-parameters",Confluence.MacroParameterSerializer.serialize(e.macroParams)),s()):(o.default.saveMacroParams(i,e.outerWrapper),s(),e.tableWrapper.trigger("tf-save")),t.preventDefault()}}))},w.prototype.bindRemove=function(){var e=this;e.removeBtn.click((function(t){t.preventDefault(),s.default.createDialogRemoveMacro(e,"Table Filter","Table Filter")}))},w.prototype.bindExport=function(){var e=this;void 0===l.saveAs?(e.menu.find(".export-file-pdf").hide(),e.menu.find(".export-file-doc").hide(),e.menu.find(".export-file-csv").hide(),e.menu.find(".export-file-print").hide()):(e.menu.find(".export-file-pdf").bind("click",(function(t){o.default.loadScriptsBeforeExport((function(){s.default.exportToPdf(e.tableWrapper)})),t.preventDefault()})),e.menu.find(".export-file-doc").bind("click",(function(t){s.default.exportToDoc(e.tableWrapper),t.preventDefault()})),e.menu.find(".export-file-print").bind("click",(function(t){s.default.browserPrint(e.tableWrapper),t.preventDefault()})),e.menu.find(".export-file-csv").click((function(t){s.default.createDialog(e.tables,e.rows[0],e.macroId),t.preventDefault()})))},w.prototype.bindSortReset=function(){var e=this;e.resetSortBtn.bind("click",(function(t){p.default.qaResetColumnSorting(),t.preventDefault(),e.resetSortBtn.hasClass("tf-disabled-link")||(e.sorts.length?e.sortTables():e.tables.trigger("sorton",[[]]),e.resetSortBtn.addClass("tf-disabled-link"))}))},w.prototype.bindCopyUrl=function(){var e=this;e.menu.find(".get-tf-url").bind("click",(function(t){var a=e.getFilters();a.sorts=[],e.tables.each((function(t){this.config&&this.config.sortList&&this.config.sortList.forEach((function(l){var i=0===l[1]?"":"";a.sorts.push(e.rawTables[t][0][l[0]]+" "+i)}))}));var l=window.location.hash,i=window.location.href.replace(l,""),r=$.getUrlHashVar("tf-filters");if(r){var s="tf-filters="+encodeURIComponent(r);l=(l=l.replace("&"+s,"")).replace("#"+s,"")}i=i+l+(l?"&":"#");var o=$("<span></span>");$("body").append(o),o.text(i+"tf-filters="+encodeURIComponent(JSON.stringify(a)));var n=document.createRange();n.selectNode(o[0]);var c=window.getSelection();c.removeAllRanges(),c.addRange(n),document.execCommand("copy"),o.remove(),t.preventDefault(),p.default.gaTFCopyFilterURL()}))},w.prototype.bindGetUrlValues=function(){var e=this,t=function(){var t=$.getUrlHashVar("tf-filters");if(t){var a=JSON.parse(t);e.setFilters(a),p.default.gaTFApplyFilterURL()}};$(window).bind("hashchange",t),$(".tablefilter-table-wrapper").one("tf-filtered",t)},w.prototype.setFilters=function(e){var t=this,a=function(e,t){e?(t.addClass("inverse"),t.parents(".filter-container:eq(0)").addClass("inverse")):(t.removeClass("inverse"),t.parents(".filter-container:eq(0)").removeClass("inverse"))},l=function(e,t){return e.filterByAttr("name",t)};s.default.i18nFilterValues(e.defaults);var i=0;(t.clearFilters(t.comboBoxDiv),e.selectfilters.forEach((function(r){r=r.replace(/\/g,",");var o=l(t.comboBoxDiv.find("select.select"),r);0==o.length&&(o=t.addFilter("selectfilter",r).find("select")),a(e.inverse[i],o);var n=e.defaults[i++].replace(/\/g,","),c=s.default.clearStringLowerCase(n).split("&&");n=n.split("&&");var d=[];o.find("option:selected").prop("selected",!1),o.find("option").each((function(){var e=$(this),t=$.inArray(s.default.clearStringLowerCase(e[0].textContent),c);-1!=t&&(e.prop("selected",!0),d.push(t))})),n.forEach((function(e,t){e&&-1==$.inArray(t,d)&&o.append($('<option selected="selected"></option>').text(e))})),o.trigger("chosen:updated")})),e.userfilters.forEach((function(r){r=r.replace(/\/g,",");var s=l(t.comboBoxDiv.find("input.user-filter"),r);0==s.length&&(s=t.addFilter("userfilter",r).find("input")),a(e.inverse[i],s),s.val(e.defaults[i++].replace(/\/g,","))})),e.numberfilters.forEach((function(r){r=r.replace(/\/g,",");var s=l(t.comboBoxDiv.find("input.number.from"),r);0==s.length&&(s=t.addFilter("numberfilter",r).find("input.from"));var o=l(t.comboBoxDiv.find("input.number.to"),r);a(e.inverse[i],s),a(e.inverse[i],o);var n=e.defaults[i++].replace(/\/g,",").split("->");s.val(n[0]),o.val(n[1])})),e.datefilters.forEach((function(r){r=r.replace(/\/g,",");var o=l(t.comboBoxDiv.find("input.date.from"),r);0==o.length&&(o=t.addFilter("datefilter",r).find("input.from"));var n=l(t.comboBoxDiv.find("input.date.to"),r);a(e.inverse[i],o),a(e.inverse[i],n);var c=e.defaults[i++].replace(/\/g,",").split("->");o.val(s.default.convertToDate(c[0],o.attr("dateformat"),o.attr("locale"))),n.val(s.default.convertToDate(c[1],n.attr("dateformat"),o.attr("locale")))})),e.globalfilter)&&(0==(r=t.comboBoxDiv.find("input.global-filter")).length&&(r=t.addFilter("globalfilter","").find("input")),a(e.inverse[i],r),r.val(e.defaults[i++].replace(/\/g,",")));if(e.columnhider){var r;0==(r=t.comboBoxDiv.find("select.column-select")).length&&(r=t.addFilter("columnhider","").find("select")),a(e.inverse[i],r);var o=e.defaults[i++].replace(/\/g,","),n=s.default.clearStringLowerCase(o).split("&&");o=o.split("&&");var c=[];r.find("option:selected").prop("selected",!1),r.find("option").each((function(){var e=$(this),t=$.inArray(s.default.clearStringLowerCase(e.text()),n);-1!=t&&(e.prop("selected",!0),c.push(t))})),o.forEach((function(e,t){e&&-1==$.inArray(t,c)&&r.append($('<option selected="selected"></option>').text(e))})),r.trigger("chosen:updated")}e.iconfilters.forEach((function(r){r=r.replace(/\/g,",");var o=l(t.comboBoxDiv.find("select.icon-select"),r);0==o.length&&(o=t.addFilter("iconfilter",r).find("select")),a(e.inverse[i],o);var n=s.default.clearStringLowerCase(e.defaults[i++].replace(/\/g,",")).split("&&");o.find("option:selected").prop("selected",!1),o.find("option").each((function(){var e=$(this);-1!=$.inArray(s.default.clearStringLowerCase(e[0].textContent),n)&&e.prop("selected",!0)})),o.trigger("chosen:updated")})),e.sorts&&(t.sorts=e.sorts,t.sortTables()),t.filterTable()},w.prototype.fixURIHash=function(){var e=$.getUrlHashVar("tf-filters");if(e){var t=location.hash,a=location.hash.replace("&tf-filters="+encodeURIComponent(e),"");t!=a&&(location.hash=a,location.hash=t)}},w.prototype.bindMakeInverse=function(){var e=this;e.comboBoxDiv.delegate(".eq","click",(function(){var t=$(this).parents(".filter-container:eq(0)");t.addClass("inverse");var a=t.find("input, select").addClass("inverse");e.gaFilterUpdated(a),$("body").trigger("filter-inverse-direct",{type:H(t),pageMode:e.isPreview?"Macro Preview":"Page View",filterMode:"Inverse"}),e.enableSaveBtn(),e.filterTable(a)})),e.comboBoxDiv.delegate(".not-eq","click",(function(){var t=$(this).parents(".filter-container:eq(0)");t.removeClass("inverse");var a=t.find("input, select").removeClass("inverse");e.gaFilterUpdated(a),$("body").trigger("filter-inverse-direct",{type:H(t),pageMode:$("body").find("div#macro-browser-preview").length?"Macro Preview":"Page View",filterMode:"Normal"}),e.enableSaveBtn(),e.filterTable(a)}))},w.prototype.setFiltrationPanel=function(){var e=this,t=e.columns.map((function(e){return e.toLocaleLowerCase()})),a=e.comboBoxDiv.find("select.select, input.user-filter, div.range, select.icon-select"),l=[];a.each((function(){var a=$(this),i=a.closest(".filter-container"),r=a.attr("name"),o=[r];s.default.updateI18nSettings([e.columns],[o],e.locale,e.tableWrapper);var n=a.attr("class")+o[0];if(-1===$.inArray(s.default.clearStringLowerCase(o[0]),t)||-1!==l.indexOf(n))i[0].style.display="none";else if(l.push(n),i[0].style.display="block",r!==o[0]){a.attr("name",o[0]),a.find("input").attr("name",o[0]);var c=a.parents(".filter-container").find(".tf-label-name");c.text().trim()===r&&c.text(o[0])}})),e.setSelectOptions();var i=e.comboBoxDiv.find("select.column-select");i.find("option:not(:selected)").remove();var r=[];i.find("option").each((function(){r.push($(this).hasClass("tf-empty-option")?"":s.default.clearString(this.textContent))})),$.each(e.columns,(function(e,t){if(-1==$.inArray(t,r)){var a="",l=t;""==t&&(a=' class="tf-empty-option"',l="-Empty-"),i.append($("<option"+a+"></option>").text(l))}})),i.trigger("chosen:updated"),e.comboBoxDiv.find(".search-choice").filter((function(){return s.default.clearString(this.textContent)=="-Empty-"})).addClass("tf-empty-option"),e.updateDateFilters();var n=a.filter((function(){return"none"!=$(this).parent().css("display")})).length>0||i.length>0||e.comboBoxDiv.find(".global-filter").length>0,c=e.params.showNRows>=0;if(0==e.rawTables.length)e.isEditor&&e.isCloud&&!e.tableWrapper.data("hasFrame")?(e.previewTutorial.show(),e.comboBoxDiv.hide()):(e.previewTutorial.hide(),e.comboBoxDiv.show(),e.tableWrapper.data("hasFrame")||s.default.hasLoadingContent(e.tableWrapper)?(e.comboBoxDiv.find(".waiting-for-table").show(),e.comboBoxDiv.find(".no-table-message").hide()):(e.comboBoxDiv.find(".no-table-message").show(),e.comboBoxDiv.find(".waiting-for-table").hide()),e.comboBoxDiv.find(".empty-message").hide(),e.lockDisabled.hide(),e.lockEnabled.hide(),e.outerWrapper.addClass("no-table"),e.comboBoxDiv.find(".tf-hider-wrapper").hide());else if(e.previewTutorial.hide(),e.comboBoxDiv.find(".tf-hider-wrapper").show(),e.outerWrapper.removeClass("no-table"),e.comboBoxDiv.find(".no-table-message").hide(),e.comboBoxDiv.find(".waiting-for-table").hide(),e.isLockEnabled=e.isLockEnabled&&(n||c),e.isLockEnabled?(e.lockDisabled.hide(),e.lockEnabled.show()):(e.lockDisabled.show(),e.lockEnabled.hide()),n||c||!(e.numbering||e.fixedRows||e.sorts.length||e.sparkline||e.fixedCols||e.totalRow.join("")||e.totalCol)?e.editorMacro||"true"!=o.default.getCookie(e.hideParamName)?(e.comboBoxDiv.show(),e.showBtn.hide()):(e.comboBoxDiv.hide(),e.showBtn.show()):e.editorMacro||(e.comboBoxDiv.hide(),e.showBtn.show()),!n&&c?(e.menu.find(".disableLock").show(),e.comboBoxDiv.find(".show-n-rows-only-message").show()):e.comboBoxDiv.find(".show-n-rows-only-message").hide(),n||c){e.comboBoxDiv.find(".filter-buttons-container").show(),e.comboBoxDiv.find(".empty-message").hide(),e.lockDisabled.addClass("not-empty").removeClass("empty");var d=e.outerWrapper.css("display");e.outerWrapper.show();var f=e.comboBoxDiv.css("display");if(e.comboBoxDiv.show(),!e.editorMacro){e.lockEnabled.css("width","").css("display","inline-flex");var p=Math.max(302,Math.ceil(e.lockEnabled.show().width())+1);e.lockDisabled.css("min-width",p+"px")}e.lockDisabled.show(),e.editorMacro||e.lockEnabled.width(Math.max(302,Math.ceil(e.lockDisabled.width()))),e.lockEnabled.height(Math.max(40,e.lockDisabled.height())),e.comboBoxDiv.css("display",f),e.outerWrapper.css("display",d),e.lockEnabled.css("display","block"),e.isLockEnabled?e.lockDisabled.hide():e.lockEnabled.hide()}else e.lockDisabled.addClass("empty").removeClass("not-empty").css("min-width",""),e.comboBoxDiv.find(".filter-buttons-container").show(),e.comboBoxDiv.find(".empty-message").show();e.outerWrapper.css("visibility","visible")},w.prototype.setSelects=function(){var e=this;e.comboBoxDiv.find("select.select, select.icon-select").each((function(t){var a=e.ddOperator.length>t?e.ddOperator[t]:"OR";$(this).data("ddOperator",a)})),e.comboBoxDiv.find("select.select").each((function(t){var a=e.ddSeparator.length>t?e.ddSeparator[t]:e.defaultDDSeparator;$(this).data("ddSeparator",a)}))},w.prototype.setSelectOptions=function(){var e=this,t=e.comboBoxDiv.find("select.select, select.icon-select").filter((function(){return"none"!=$(this).parent().css("display")}));if(t.find("option:not(:selected)").remove(),e.shouldUpdateSelectOptions)var a=e.getFilterContainers().not(".columnhider-element");t.each((function(){var t=$(this),l=t.attr("name").toLocaleLowerCase(),i=t.data("html"),r=!0,o=[],n=[];t.find("option").each((function(){if(i){var e=this.textContent;if(e!="-Empty-"){var t=$(e);t.is("img")&&(e=t[0].src,e=s.default.clearIconSrc(e))}else n.push("");n.push(e.toLocaleLowerCase())}else n.push($(this).hasClass("tf-empty-option")?"":s.default.clearStringLowerCase(this.textContent))}));var d=i?"":t.data("ddSeparator");$.each(e.rawTables,(function(f,p){var u=s.default.getCellPositions(p,l);if(e.shouldUpdateSelectOptions&&p.length){for(var m=new Array(p.length-1),h=0;h<m.length;h++)m[h]=!0;a.not(t.parent()).each((function(){var t=$(this).data("state");if(t&&t[f])for(var a=0;a<t[f].length;a++)e.isAND?m[a]=m[a]&&t[f][a]:m[a]=m[a]&&!t[f][a]}))}u.forEach((function(t){if($.each(i?e.rawIconTables[f]:p,(function(e,a){if(0!=e&&(!m||m[e-1])){var l=a[t];if(null==l)return;if(i&&l){var f=$(l);f.filter("img").each((function(){l=s.default.clearStringLowerCase(this.src),l=s.default.clearIconSrc(l),-1==$.inArray(l,n)&&(n.push(l),o.push(c().sanitize(this.outerHTML)))})),f.filter("ul").length&&r&&(r=!1,-1==$.inArray('<ul class="inline-task-list"><li></li></ul>',n)&&(o.push('<ul class="inline-task-list"><li></li></ul>'),n.push('<ul class="inline-task-list"><li></li></ul>')),-1==$.inArray('<ul class="inline-task-list"><li class="checked"></li></ul>',n)&&(o.push('<ul class="inline-task-list"><li class="checked"></li></ul>'),n.push('<ul class="inline-task-list"><li class="checked"></li></ul>')))}else d&&""!=l?l.split(d).forEach((function(e){(e=e.trim())&&(l=s.default.clearStringLowerCase(e),-1==$.inArray(l,n)&&(n.push(l),o.push(e)))})):(l=s.default.clearStringLowerCase(l),-1==$.inArray(l,n)&&(n.push(l),o.push(a[t])))}})),!i&&-1==$.inArray("@currentuser",n)){var a=e.tables.eq(f),l=!1;if(e.rows[f].length>1&&a.hasClass("tasks-report")&&s.default.getNthTdElem(e.rows[f][1],t).hasClass("tasks-report-assignee"))l=!0;else if(t++,a.find(".confluence-userlink").length){var u=a.find("tr td:nth-child("+t+"), tr th:nth-child("+t+")").find(".confluence-userlink").eq(0);u.length&&u.parents("td").eq(0).text().trim()==u.text().trim()&&(l=!0)}l&&(n.push("@currentuser"),o.push("@currentUser"))}}))})),o.sort((function(e,t){return e.localeCompare(t)}));var f="";$.each(o,(function(e,t){var a="",l=t;""==t&&(a=' class="tf-empty-option"',l="-Empty-"),f+=$("<option"+a+"></option>").text(l)[0].outerHTML})),t.append(f),t.trigger("chosen:updated")}))},w.prototype.makeSortable=function(){var e=this;-1===["Table header","true"].indexOf(e.params.hidePane)&&e.comboBoxDiv.find(".sortable-container").sortable({cancel:"input,textarea,button,select,option,.chosen-drop",scroll:!1,items:".sortable",start:function(e,t){t.item.width(Math.ceil(t.item.width())+1)},sort:function(t,a){e.highlightRemoveFilter(a.offset,a.helper)},beforeStop:function(t,a){e.enableSaveBtn(),e.removeFilter(a.offset,a.item)},update:function(t,a){$("body").trigger("filter-reordered",{type:H(a.item),pageMode:e.isPreview?"Macro Preview":"Page View"})}})},w.prototype.makeResizable=function(e){var t=this;if(0==$("body.content-preview").length){var a=e.find(".chosen-container, div.tf-resizeable");a.length>0&&a.resizable({handles:"e",resize:function(e,a){a.element.hasClass("chosen-container")?a.element.parent().find("select").attr("data-width",a.size.width):a.element.find("input").attr("data-width",a.size.width),t.enableSaveBtn()}})}},w.prototype.makeTablesScrollable=function(){var e=this;s.default.hasLoadingContent(e.tableWrapper)||(e.pauseUpdate=!0,e.setMutationObserver(!0),e.tables.find(".tf-fixed-column-border").remove(),e.tables.parents(".table-wrap, .table-wrap-aui").unbind("scroll.fh scroll-tf"),e.tables.find("td.tf-floating,th.tf-floating").removeClass("tf-floating").removeClass("tf-float-head").css({top:"",left:""}),e.tableWrapper.find(e.editorMacro?".table-wrap.tf-fixed-rows":".table-wrap.editor, .table-wrap-aui").each((function(){var e=$(this);e.before(e.children("table, .table-wrap")),e.remove()})),e.tableWrapper.removeClass("fixed"),e.editorMacro&&e.tableWrapper.find(".resize-sensor, .resize-sensor-shrink, .resize-sensor-expand").remove(),e.fixColumns(),e.pauseUpdate=!1,e.setMutationObserver(!0))},w.prototype.fixColumns=function(){var e=this;if(e.fixedCols>0&&!e.editorMacro||e.fixedRows>0){var t=window.navigator.userAgent.indexOf("MSIE ")>0||!!navigator.userAgent.match(/Trident.*rv\:11\./)||/Edge/.test(navigator.userAgent);e.tables.each((function(a){var l=$(this);e.editorMacro?l.wrap('<div class="table-wrap editor"></div>'):e.fixedRows>0&&l.hasClass("aui")?l.wrap('<div class="table-wrap-aui"></div>'):0==l.parents(".table-wrap").length&&l.wrap('<div class="table-wrap"></div>');var i=l.parents(".table-wrap, .table-wrap-aui").eq(0);if(i.addClass("tf-fixed"),t&&i.addClass("ie"),l.find(".tableFloatingHeader").remove(),e.fixedRows>0){var r=e.rows[a].length>e.fixedRows?2*(e.rows[a].eq(e.fixedRows).offset().top-l.offset().top):l.height(),s=e.heightValue?e.heightValue:Math.floor(.7*window.innerHeight)||600;i.css("max-height",Math.max(r,s)+"px"),i.addClass("tf-fixed-rows")}l.tableHeadFixer({left:e.editorMacro?0:e.fixedCols,head:parseInt(e.fixedRows)+l.find("tr.tf-header-hidden").length,parent:i})})),e.tableWrapper.addClass("fixed")}},w.prototype.updateFixedCells=function(){var e=this;(e.fixedCols>0&&!e.editorMacro||e.fixedRows>0)&&(e.pauseUpdate=!0,e.setMutationObserver(!0),e.tables.parents(".table-wrap, .table-wrap-aui").unbind("scroll.tf scroll-tf"),e.tables.find("td.tf-floating,th.tf-floating").removeClass("tf-floating").css({top:"",left:""}),e.tables.each((function(){var t=$(this),a=t.parents(".table-wrap, .table-wrap-aui").eq(0);t.tableHeadFixer({left:e.editorMacro?0:e.fixedCols,head:parseInt(e.fixedRows)+t.find("tr.tf-header-hidden").length,parent:a})})),e.pauseUpdate=!1,e.setMutationObserver(!0))},w.prototype.enableSaveBtn=function(){this.saveBtn.removeClass("tf-disabled-link"),this.outerWrapper.add(this.saveBtn).find(".tfac-unsaved").show(),this.filterIcon.addClass("unsaved")},w.prototype.shouldRemoveFilter=function(e){var t=this,a=t.comboBoxDiv.offset(),l=a.left+t.comboBoxDiv.width()+10,i=a.left-10,r=a.top+t.comboBoxDiv.height()-10,s=a.top-20;return e.top<s||e.top>r||e.left>l||e.left<i},w.prototype.removeFilter=function(e,t){var a=this;if(a.outerWrapper.click(),a.shouldRemoveFilter(e)){t.remove();var l=H(t);p.default.panelFilterDeleted(l),$("body").trigger("filter-added-deleted",{action:"Filter Deleted",type:l,pageMode:a.isPreview?"Macro Preview":"Page View"}),setTimeout((function(){a.filterTable(),a.setFiltrationPanel()}),500)}else t.removeClass("filter-removing")},w.prototype.highlightRemoveFilter=function(e,t){this.shouldRemoveFilter(e)?t.addClass("filter-removing"):t.removeClass("filter-removing")},w.prototype.getFilters=function(){var e=this,t={selectfilters:[],userfilters:[],numberfilters:[],datefilters:[],globalfilter:e.comboBoxDiv.find("input.global-filter"),columnhider:e.comboBoxDiv.find("select.column-select"),iconfilters:[],defaults:[],width:[],inverse:[],order:[],ddSeparator:[],ddOperator:[]},a=e.comboBoxDiv.find(".sortable-container .filter-container");if(e.comboBoxDiv.find("select.select").each((function(){var e=[],l=$(this);t.selectfilters.push(l.attr("name").replace(/\,/g,"")),t.width.push(l.attr("data-width").replace("px","")),l.find("option:selected").each((function(){e.push(this.textContent.replace(/\,/g,""))})),t.defaults.push(e.join("&&")),t.inverse.push(l.hasClass("inverse")),t.order.push(a.index(l.parents(".filter-container"))),t.ddSeparator.push(l.data("ddSeparator")),t.ddOperator.push(l.data("ddOperator"))})),e.comboBoxDiv.find("input.user-filter").each((function(){var e=$(this);t.userfilters.push(e.attr("name").replace(/\,/g,"")),t.width.push(e.attr("data-width").replace("px","")),t.defaults.push(e.val().replace(/\,/g,"")),t.inverse.push(e.hasClass("inverse")),t.order.push(a.index(e.parents(".filter-container")))})),e.comboBoxDiv.find(".range.numbers").each((function(){var e=[],l=$(this);t.numberfilters.push(l.attr("name").replace(/\,/g,"")),l.find("input.number").each((function(){e.push($(this).val().replace(/\,/g,""))})),t.defaults.push(e.join("->")),t.inverse.push(l.parent().hasClass("inverse")),t.order.push(a.index(l.parents(".filter-container")))})),e.comboBoxDiv.find(".range.dates").each((function(){var e=[],l=$(this);t.datefilters.push(l.attr("name").replace(/\,/g,"")),l.find("input.date").each((function(){var t=$(this),a=t.val();e.push(s.default.dateToUTCTimestamp(a,t.attr("dateformat"),t.attr("locale")))})),t.defaults.push(e.join("->")),t.inverse.push(l.parent().hasClass("inverse")),t.order.push(a.index(l.parents(".filter-container")))})),t.globalfilter.length?(t.defaults.push(t.globalfilter.val().replace(/\,/g,"")),t.width.push(t.globalfilter.attr("data-width").replace("px","")),t.inverse.push(t.globalfilter.hasClass("inverse")),t.order.push(a.index(t.globalfilter.parents(".filter-container"))),t.globalfilter=!0):t.globalfilter=!1,t.columnhider.length){var l=[];t.columnhider.find("option:selected").each((function(){l.push(this.textContent.replace(/\,/g,""))})),t.defaults.push(l.join("&&")),t.width.push(t.columnhider.attr("data-width").replace("px","")),t.inverse.push(t.columnhider.hasClass("inverse")),t.order.push(a.index(t.columnhider.parents(".filter-container"))),t.columnhider=!0}else t.columnhider=!1;return e.comboBoxDiv.find("select.icon-select").each((function(){var e=[],l=$(this);t.iconfilters.push(l.attr("name").replace(/\,/g,"")),t.width.push(l.attr("data-width").replace("px","")),l.find("option:selected").each((function(){e.push(this.textContent.replace(/\,/g,""))})),t.defaults.push(e.join("&&")),t.inverse.push(l.hasClass("inverse")),t.ddOperator.push(l.data("ddOperator")),t.order.push(a.index(l.parents(".filter-container")))})),s.default.unI18nFilterValues(t.defaults),t},w.prototype.getTable=function(e){var t=this,a=t.tabs&&s.default.hasTabs(t.tableWrapper);t.tables=s.default.getTableNodes(t.tableWrapper,t.editorMacro?"table.confluenceTable":"table").filter((function(){var e=$(this);if(a&&s.default.hasInactiveTab(e))return!1;var l=e.parents("table:not(.wysiwyg-macro), .tablefilter-table-wrapper");return l.eq(0).is(t.tableWrapper)||l.eq(0).is(".tablefilter-table-wrapper")&&l.eq(1).is(t.tableWrapper)})),e||t.normalizeTable(),t.rows=[],t.headerSize=[],t.tables.each((function(){var e=s.default.getRows(this);t.rows.push(e),t.headerSize.push(s.default.getMaxRowspan($(e[0])))})),t.updateRawTables(),s.default.setPaginationMsg(t.tableWrapper),e||t.bindTableEvents()},w.prototype.updateRawTables=function(e){var t=this;t.rawTables=s.default.getTablesRowsValues(t.rows,t.editorMacro?s.default.editorType:s.default.textType),e||(t.rawIconTables=null,(t.comboBoxDiv.find("select.icon-select").length||-1!==t.totalRow.indexOf("Count not empty"))&&t.updateRawIconTables()),t.columns=s.default.getColumns(t.rawTables)},w.prototype.updateRawIconTables=function(){this.rawIconTables=s.default.getTablesRowsValues(this.rows,s.default.visualType)},w.prototype.filterTable=function(e){var t=this;if(!s.default.hasLoadingContent(t.tableWrapper)){if(t.isLockEnabled)return t.appendTotalRow(),t.appendTotalCol(),t.appendSparklines(),t.setTablesReady(),void t.prepareExport();var a=t.getFilterContainers();e?t.filterContainer(e.parents(".filter-container.sortable")):t.filterContainer(a),t.showTable(t.isAND),t.filtered=!1,a.not(".columnhider-element").each((function(){var e=$(this);t.filtered=t.filtered||e.data("filtered");var a=e.data("state");if(a)for(var l=0;l<a.length;l++)for(var i=0;i<a[l].length;i++)t.isAND?t.cbState[l][i]=t.cbState[l][i]&&a[l][i]:t.cbState[l][i]=t.cbState[l][i]||a[l][i];t.correctionWithAllowRowList()})),t.filtered||t.isAND||t.showTable(!0);var l=a.filter(".columnhider-element").data("state");l&&l.length&&(t.tdNumbers=l),t.setTablesReady(),t.showOrHideTables(),t.appendTotalRow(),(t.updateSparkline||t.tableUpdated)&&(t.rows[0]&&!t.rows[0].eq(0).find(".total-col.tf-hidden-column").length&&t.appendTotalCol(),t.appendSparklines(),t.updateSparkline=!1,t.tableUpdated=!1,t.sparkline&&t.fixedRows>0&&t.updateFixedCells()),t.blockEvent||t.tableWrapper.trigger("tf-filtered-total",t.getEventData()),t.shouldUpdateSelectOptions&&t.setSelectOptions(),t.filtered||l&&l.length?(t.menu.find(".filter-reset").removeClass("tf-disabled-link"),t.menu.find(".disableLock").removeClass("tf-disabled-link")):(t.menu.find(".filter-reset").addClass("tf-disabled-link"),t.params.showNRows>=0||t.menu.find(".disableLock").addClass("tf-disabled-link")),t.prepareExport(),t.editorMacro&&(t.editorMacro.data("tf-self",!0),"true"!==t.params.enabledInEditor&&"none"!==t.outerWrapper.css("display")&&t.editorMacro.attr("type",JSON.stringify(t.getFilters())),t.params.enabledInEditor=""),h.default.create(t,t.editorMacro)}},w.prototype.prepareExport=function(e){var t=this;t.sortWait=t.sortWait||!t.sorts.length||e,t.blockEvent||s.default.hasLoadingContent(t.tableWrapper)||!t.sortWait||(clearTimeout(t.exportTimer),t.exportTimer=setTimeout((function(){t.tableWrapper.trigger("tf-export-ready",{macroId:t.macroId})}),300))},w.prototype.setTablesReady=function(){this.tables.attr("data-tf-ready","true")},w.prototype.getFilterContainers=function(){return this.comboBoxDiv.find(".filter-container.sortable").filter((function(){return"none"!==this.style.display}))},w.prototype.filterContainer=function(e){var t=this;e.find("select, input").each((function(){var e=$(this);if(e.is(".select"))t.treatSelectFilter(e);else if(e.is(".user-filter"))t.treatUserFilter(e);else if(e.is(".number"))t.treatNumberFilter(e);else if(e.is(".date"))t.treatDateFilter(e);else if(e.is(".global-filter"))t.treatGlobalFilter(e);else if(e.is(".column-select"))t.treatColumnFilter(e);else{if(!e.is(".icon-select"))return;t.treatIconFilter(e)}t.highlightFilteredColumn(e)}))},w.prototype.showTable=function(e){var t=this,a=t.tables.length;t.cbState=new Array(a),t.tdNumbers=new Array(a);for(var l=0;l<a;l++){t.tdNumbers[l]=[],t.cbState[l]=new Array(t.rows[l].length>0?t.rows[l].length-1:0);for(var i=0;i<t.cbState[l].length;i++)t.cbState[l][i]=e}},w.prototype.treatSelectFilter=function(e){var t=this,a=[];e.find("option:selected").each((function(){var e=$.trim(this.textContent);e==="-Empty-"?e="":"@currentUser"===e?(e=o.default.getCurrentUserFullName(),a.push(o.default.getCurrentUserName())):"@pageTitle"===e&&(e=o.default.getPageTitle()),a.push(s.default.clearStringLowerCase(e))}));var l=e.parent();if(0===a.length)return l.data("state",[]),void l.data("filtered",!1);var i,r=e.attr("name"),n=e.hasClass("inverse"),c=e.data("ddSeparator"),d="AND"===e.data("ddOperator");i=c?function(e,t){var a=!d,l=e.split(c).map((function(e){return e.trim()}));return l.length>1&&(l=l.filter((function(e){return e}))),d?t.some((function(e){return a=a||-1===l.indexOf(e)})):l.some((function(e){return!(a=-1===t.indexOf(e))})),a}:function(e,t){return-1===$.inArray(e,t)};var f=[];t.rawTables.forEach((function(e,l){var o=s.default.getCellPositions(e,r);f[l]=[],o.length&&e.forEach((function(e,r){if(r>0){var c=!0;o.forEach((function(t){var l=s.default.clearStringLowerCase(e[t]);c=c&&i(l,a)})),c=t.isAND?c:!c,f[l][r-1]=n!=c?!t.isAND:t.isAND}}))})),l.data("state",f),l.data("filtered",!0)},w.prototype.treatIconFilter=function(e){var t=this,a=[],l=[],i=!1;e.find("option:selected").each((function(){var e=$.trim(this.textContent);if(e=="-Empty-")i=!0;else{var t=$(e);t.length&&(t.is("ul")?l.push("ul.inline-task-list > li"+(t.children("li").hasClass("checked")?".checked":":not(.checked)")):((e=t[0].src)&&(e=s.default.clearStringLowerCase(e),e=s.default.clearIconSrc(e)),a.push(e)))}}));var r=e.parent();if(0==a.length&&0==l.length&&!i)return r.data("state",[]),void r.data("filtered",!1);var o=e.attr("name"),n=e.hasClass("inverse"),c="AND"===e.data("ddOperator");c||(l=l.join(","));var d=[];t.tables.each((function(e){var r=t.rows[e],f=s.default.getCellPositions(t.rawTables[e],o);d[e]=[],f.length&&r.each((function(r){if(r>0){var o=!0,p=this;f.forEach((function(e){var t,r,n,d=s.default.getNthTdElem(p,e);if(a.length){var f=s.default.getTdIconsSrc(d).map((function(e){return e?s.default.clearIconSrc(s.default.clearStringLowerCase(e)):e}));c?(t=!1,a.some((function(e){return t=t||-1===f.indexOf(e)}))):f.some((function(e){return!(t=-1===a.indexOf(e))}))}l.length&&(c?(r=!1,l.some((function(e){return r=r||0===d.find(e).length}))):r=0===d.find(l).length),i&&(n=d.find("ul.inline-task-list li, img[src]").length>0),o=o&&(!1!==t&&!1!==n&&!0===r||!0===t&&!1!==n&&!1!==r||!1!==t&&!0===n&&!1!==r)})),o=t.isAND?o:!o,d[e][r-1]=n!=o?!t.isAND:t.isAND}}))})),r.data("state",d),r.data("filtered",!0)},w.prototype.treatInputFilter=function(e,t){var a,l=this,i=e.val(),r=s.default.clearStringLowerCase(i);if("@currentUser"==i?i=o.default.getCurrentUserFullName()+"|"+o.default.getCurrentUserName():"@pageTitle"===i&&(r=s.default.clearStringLowerCase(o.default.getPageTitle())),r.indexOf("&")>0){var n="";$.each(i.split("&"),(function(e,t){n+="(?=.*"+t.trim()+")"})),i=n}try{var c=new RegExp(i,"i")}catch(e){}t&&(a=e.attr("name"));var d=e.parents(".filter-container.sortable");if(""==r)return d.data("state",[]),void d.data("filtered",!1);var f=e.hasClass("inverse"),p=[];l.rawTables.forEach((function(e,i){var o=s.default.getCellPositions(e,a);p[i]=[],t&&!o.length||e.forEach((function(e,a){if(a>0){var n="";t?(o.forEach((function(t){e[t]&&(n=n+" "+e[t])})),n=n.trim()):n=e.join(" ");var d=-1==s.default.clearStringLowerCase(n).indexOf(r)&&(!c||null==n.match(c));d=l.isAND?d:!d,p[i][a-1]=f!=d?!l.isAND:l.isAND}}))})),d.data("state",p),d.data("filtered",!0)},w.prototype.treatGlobalFilter=function(e){this.treatInputFilter(e,!1)},w.prototype.treatUserFilter=function(e){this.treatInputFilter(e,!0)},w.prototype.treatDateFilter=function(e){var t=this,a=$.trim(e.val()),l=e.attr("name"),i=e.attr("dateformat"),r=e.attr("locale"),o=e.hasClass("from"),n=e.hasClass("inverse");if(o)t.rangeFilterValues={from:f()};else{var c=e.parent().parent();if(t.rangeFilterValues.to=f(),t.rangeFilterValues.from||t.rangeFilterValues.to){var d=[];t.rawTables.forEach((function(e,a){var o=s.default.getCellPositions(e,l);d[a]=[],o.length&&e.forEach((function(e,l){if(l>0){var c=!0;o.forEach((function(a){var l=e[a]||"";try{var o=s.default.parseDate(l,i,r);o?n?t.rangeFilterValues.from?c=t.rangeFilterValues.to?c&&t.rangeFilterValues.from<=o&&t.rangeFilterValues.to>=o:c&&t.rangeFilterValues.from<=o:t.rangeFilterValues.to&&(c=c&&t.rangeFilterValues.to>=o):t.rangeFilterValues.from?c=t.rangeFilterValues.to?c&&(t.rangeFilterValues.from>o||t.rangeFilterValues.to<o):c&&t.rangeFilterValues.from>o:t.rangeFilterValues.to&&(c=c&&t.rangeFilterValues.to<o):c=c&&!n}catch(e){c=!1,AJS.log("Error while filtering date '"+l+"': "+e)}})),c=t.isAND?c:!c,d[a][l-1]=c?!t.isAND:t.isAND}}))})),c.data("state",d),c.data("filtered",!0)}else c.data("state",[]),c.data("filtered",!1)}function f(){try{var e;if("today"==a||"heute"==a)return(e=new Date).setHours(0,0,0,0);var t=["y","m","w","d"],l=!1;return t.some((function(e){if(new RegExp("^[+-]?\\d+"+e).test(a))return l=!0,!0})),l?((e=new Date).setHours(0,0,0,0),t.forEach((function(t,l){var i=a.split(t);if(2==i.length){var r=parseInt(i[0]);3==l?e.setDate(e.getDate()+r):2==l?e.setDate(e.getDate()+7*r):1==l?e.setMonth(e.getMonth()+r):e.setYear(e.getFullYear()+r),a=i[1]}})),e):s.default.parseDate(a,i,r)}catch(e){return AJS.log("Error while filtering by date '"+a+"': "+e),!1}}},w.prototype.treatNumberFilter=function(e){var t=this,a=$.trim(e.val()).toLocaleLowerCase(),l=e.attr("name"),i=e.hasClass("inverse"),r=e.hasClass("from"),o=s.default.getValueType(a,t.separator,t.worklog),n=s.default.parseValueByType(o,a,t.separator,t.worklog);if(n=!isNaN(n)&&n,r)t.rangeFilterValues={from:n,type:o};else{t.rangeFilterValues.type&&(o=t.rangeFilterValues.type),t.rangeFilterValues.to=n;var c=e.parent().parent();if(!1!==t.rangeFilterValues.from||!1!==t.rangeFilterValues.to){var d=[];t.rawTables.forEach((function(e,a){var r=s.default.getCellPositions(e,l);d[a]=[],r.length&&e.forEach((function(e,l){if(l>0){var n=!0;r.forEach((function(a){var l=e[a]||"";try{var r=s.default.parseValueByType(o,l,t.separator,t.worklog);isNaN(r)?n=n&&!i:i?!1!==t.rangeFilterValues.from?n=!1!==t.rangeFilterValues.to?n&&t.rangeFilterValues.from<=r&&t.rangeFilterValues.to>=r:n&&t.rangeFilterValues.from<=r:!1!==t.rangeFilterValues.to&&(n=n&&t.rangeFilterValues.to>=r):!1!==t.rangeFilterValues.from?n=!1!==t.rangeFilterValues.to?n&&(t.rangeFilterValues.from>r||t.rangeFilterValues.to<r):n&&t.rangeFilterValues.from>r:!1!==t.rangeFilterValues.to&&(n=n&&t.rangeFilterValues.to<r)}catch(e){n=!1,AJS.log("Error while filtering number '"+l+"': "+e)}})),n=t.isAND?n:!n,d[a][l-1]=n?!t.isAND:t.isAND}}))})),c.data("state",d),c.data("filtered",!0)}else c.data("state",[]),c.data("filtered",!1)}},w.prototype.treatColumnFilter=function(e){var t=this;t.updateSparkline=!0;var a=[];e.find("option:selected").each((function(){var e=$.trim(this.textContent);e=="-Empty-"&&(e=""),a.push(e.toLocaleLowerCase())}));var l=e.hasClass("inverse"),i=e.parent();if(0!=a.length){var r=[];t.rawTables.forEach((function(e,i){r[i]=[];var o=e[0]||[];o.forEach((function(e,n){l!=$.inArray(s.default.clearStringLowerCase(e),a)>=0&&(r[i].push(n),n==o.length-1&&(t.updateSparkline=!1))}))})),i.data("state",r)}else i.data("state",[])},w.prototype.showOrHide=function(e,t,a,l,i){var r=this,s=0;if(t>r.headerSize[e])if(!r.cbState[e][t-1]&&i<t)$(a.children).filter("[rowspan]").trigger("hideCell"),a.style.display="none";else if(r.numbering&&(-1!=r.numbering.indexOf("dynamic")||"true"==r.numbering)){var o=a.children[0];o.classList.contains("tf-numbering")&&(o.children[0].textContent=l,r.rawTables[e][t][0]=""+l),s=1}if(r.tdNumbers&&r.tdNumbers[e].length){var n=a.children;$.each(r.tdNumbers[e],(function(e,t){$(n[t]).trigger("hideCol").addClass("tf-hidden-column")}))}return s},w.prototype.showTableWithoutFilters=function(){var e=this;e.showTable(!0),e.showOrHideTables(),e.appendTotalRow(),e.appendTotalCol(),e.appendSparklines(),e.blockEvent||e.tableWrapper.trigger("tf-filtered-total",e.getEventData()),e.sparkline&&e.fixedRows>0&&e.updateFixedCells(),h.default.create(e)},w.prototype.showOrHideTables=function(){var e=this,t=0,a=0,l=e.params.showNRows;e.isLockEnabled&&(e.params.showNRows="all"),e.tables.each((function(l){var i=$(this),r=e.rows[l],o=i.hasClass("relative-table"),n=(0,v.getChildren)(r);n.filter(".tf-hidden-column").removeClass("tf-hidden-column"),n.each((function(){if(this.hasAttribute("colspan")){var e=$.data(this,"colspan");e&&(this.colSpan=e)}}));var c=i.children("colgroup").children("col");if(o){var d=0,f=[];c.each((function(){"none"===this.style.display?d+=parseFloat(this.style.width):f.push(this)})),d>0&&(i.css("width",parseFloat(i[0].style.width)/(1-d/100)+"%"),f.forEach((function(e){e.style.width=parseFloat(e.style.width)*(1-d/100)+"%"})))}c.show();var p=i.find("tr.pivot-header, thead.tableFloatingHeader tr");if(p.children(".tf-hidden-column").removeClass("tf-hidden-column"),e.tdNumbers&&e.tdNumbers[l].length){d=0;$.each(e.tdNumbers[l],(function(e,t){c.eq(t).hide(),o&&(d+=parseFloat(c[t].style.width)),p.each((function(){$(this).find("th, td").eq(t).trigger("hideCol").addClass("tf-hidden-column")}))})),d>0&&(i.css("width",parseFloat(i[0].style.width)*(1-d/100)+"%"),c.each((function(t){-1===e.tdNumbers[l].indexOf(t)&&(this.style.width=parseFloat(this.style.width)/(1-d/100)+"%")})))}i.is(".attachments")&&i.find(".attachment-summary").each((function(t){e.cbState[l][t]||($(this).addClass("hidden"),r.eq(t+1).find(".icon-section-opened").removeClass("icon-section-opened").addClass("icon-section-closed"))}));var u=n.filter(".fake").hide();n.each((function(){this.hasAttribute("rowspan")&&(this.rowSpan=$.data(this,"rowspan")||1)})),r.each((function(){this.style.display=""})),t+=r.length-1;var m=e.params.ignoreFirstNrows,h=$.grep(e.cbState[l],(function(e,t){return e||m>t})).length,b=1,g=1;if(e.numbering&&-1!=e.numbering.indexOf("desc")&&(b=h,g=-1),r.each((function(t){b+=e.showOrHide(l,t,this,b,m)*g})),"all"!=e.params.showNRows&&e.params.showNRows>=0&&!e.filtered){var y=e.params.showNRows;r.filter((function(){return s.default.isRowVisible(this)})).filter(":gt("+y+")").hide(),h=Math.min(h,y)}e.editorMacro&&(u.filter("[rowspan]:not(:visible)").attr("rowspan",-1),u.filter("[colspan]:not(:visible)").attr("colspan",-1)),a+=h})),t===a?e.filterIcon.removeClass("filtered").addClass("default").attr("title",AJS.format("Nothing filtered. Showing {0} rows",t)):e.filterIcon.removeClass("default").addClass("filtered").attr("title",AJS.format("Showing {0} of {1} rows",a,t)),e.filterIcon.children(".filter-count").text("".concat(a,"/").concat(t)),e.resize&&e.resize(),e.params.showNRows=l;var i=e.getEventData();e.blockEvent||e.tableWrapper.trigger("tf-filtered",i),e.tables.trigger("tf-filtered-charts").trigger("scroll-tf"),e.comboBoxDiv.parents(".tablefilter-table-wrapper, .pivot-content, table").eq(0).data("inner-filter",i)},w.prototype.getEventData=function(){return{id:"tf-table-"+this.macroId,tf:this,macroId:this.macroId}},w.prototype.appendSparklines=function(){var e=this;if(e.pauseUpdate=!0,e.setMutationObserver(!0),e.spakLinesFinished=!0,e.sparkline)e.rows.forEach((function(t,a){!function(t,a){var l=null,i=0;function r(e){return(e.find(":first-child").attr("class")||"").replace("tf-numbering","").replace("tf-hidden-column","")}function o(e,t){var a=100,l=25,i=$('<svg xmlns="http://www.w3.org/2000/svg"/>').attr("width",a).attr("height",l);function r(e){if(e.length>1){var t=a/(e.length-1),i=Math.min.apply(Math,g(e)),r=Math.max.apply(Math,g(e))-i,s=0===r?l/2:l/r,o=e.map((function(e,a){return[t*a,0===r?s:l-s*(e-i)]}));return"M".concat(o.join("L"))}return""}var s=$(document.createElementNS("http://www.w3.org/2000/svg","path")).attr("d",r(t)).attr("style","stroke: rgb(100, 100, 255); stroke-width: 1; fill: none;");i.append(s),e.append(i)}t.each((function(n,c){var d=$(c);d.find(".tf-sparkline-header, .tf-sparkline-container").remove();var f=r(d);if(0===n){if(d.append($('<th class="'.concat(f,' tf-sparkline-header synchrony-exclude" contenteditable="false" data-sorter="false"></th>')).text(e.sparkName)),c.classList.contains("tf-header-hidden")){var p=$(a).find("tr.pivot-header"),u=p.eq(0);u.find(".tf-sparkline-header").remove(),u.append($('<th class="'.concat(r(u),' tf-sparkline-header synchrony-exclude" contenteditable="false" data-sorter="false" rowspan="').concat(p.length,'">\n                              </th>')).text(e.sparkName))}}else{var m=[];$(c.children).not(".tf-numbering, .total-col, .numberingColumn").each((function(t){if($(this).hasClass("tf-hidden-column"))return!0;var a=s.default.clearString(this.textContent);null==l&&a&&(l=s.default.getValueType(a,e.separator,e.worklog,!0));var i=s.default.parseValueByType(l,a,e.separator,e.worklog,!0);isNaN(i)||m.push(i)}));var h=$('<td class="'.concat(f,' tf-sparkline-container synchrony-exclude" contenteditable="false"></td>'));if(o(h,m),d.append(h),!e.editorMacro){var b=d.find("svg").attr("version",1.1).prop("outerHTML");if("undefined"!=typeof btoa&&b){h.append("<canvas></canvas>");var v="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(b))),g=d.find("canvas").attr("width",100).attr("height",25)[0],y=g.getContext("2d"),w=new Image;w.src=v,w.onload=function(){y.drawImage(w,0,0);var e=g.toDataURL("image/png"),l='<img src="'.concat(e,'">');h.html(l),++i===t.length-1&&$(a).trigger("sparklines-converted")}}}}}))}((0,v.spliceSelectors)(t,e.totalRows[a]),e.tables[a])})),e.updateSorterAndRawTables(!0),e.pauseUpdate=!1,e.setMutationObserver(!0);else{var t=e.tableWrapper.find(".tf-sparkline-header, .tf-sparkline-container"),a=t.length;t.remove(),e.updateSorterAndRawTables(a>0),e.pauseUpdate=!1,e.setMutationObserver(!0)}},w.prototype.appendTotalRow=function(){var e=this;if(e.pauseUpdate=!0,e.setMutationObserver(!0),e.tables.find("tr.total-row").remove(),e.totalRows=[],e.totalRow.length){var t=0;e.tableUpdated=!0,e.rawTables.forEach((function(a,l){for(var i={},r=e.numbering?1:0,o=e.rows[l].eq(0).children().not(".tf-sparkline-header, .total-col").length-r,n={},c=t;c<o+t;c++){var d=c-t+r;if(e.totalRow[c]){var f=C,p=!1,u=!1,h=!1;"Sum"==e.totalRow[c]?f=T:"Min"==e.totalRow[c]?f=S:"Max"==e.totalRow[c]?f=I:"Multiplication"==e.totalRow[c]?f=x:"Count"==e.totalRow[c]?(f=F,u=!0):"Count not empty"==e.totalRow[c]?(f=F,h=!0):p=!0,i[d]={calc:f,isAvg:p,isCount:u,isCountA:h}}n[d]=e.getTotalCellClasses(l,d)}t+=o;var b=null;if(Object.keys(i).length){var v={},g={};a.forEach((function(t,a){a>0&&s.default.isRowVisible(e.rows[l][a])&&$.each(i,(function(i,r){if(r.isCount)r.calc();else if(r.isCountA)if(t[i])r.calc();else{var o=e.rawIconTables[l][a][i];if(o){var n=!0;-1!==o.indexOf('<ul class="inline-task-list"')&&(n=/<li .*?class="[^"]*?checked[^"]*?".*?>/.test(o)),n&&r.calc()}}else{null==v[i]&&t[i]&&(v[i]=s.default.getValueType(t[i],e.separator,e.worklog));var c=s.default.parseValueByType(v[i],t[i],e.separator,e.worklog);s.default.isNumber(c)&&(r.calc(c),v[i]!==s.default.number||g[i]||(g[i]=s.default.getNumberFormatter(t[i],e.separator)))}}))}));var y=!1,w=!0;if($.each(i,(function(t,a){a.total=s.default.formatValueByType(a.total,v[t],(function(l){if(void 0!==l){y=!0,a.isAvg&&(l=k(l));var i=e.formatDecimal.to(l);return g[t]?g[t](i):i}return""}),e.worklog,e.separator),""!==a.total&&(y=!0)})),y){if(b=$(m().totalRow({title:e.totalRowName,length:o+r,totals:i,numbering:r,isFireFox:s.default.isFireFox(),classes:n})),e.tdNumbers&&e.tdNumbers[l].length){w=!1;var H=b.children("td,th");$.each(e.tdNumbers[l],(function(e,t){H.eq(t).addClass("tf-hidden-column")})),$.each(H,(function(e,t){if(t.textContent&&!$(t).hasClass("tf-hidden-column"))return w=!0,!1}))}w&&e.tables.eq(l).append(b)}}e.totalRows.push(b),e.updateSorterAndRawTables(!1,!0)}))}e.pauseUpdate=!1,e.setMutationObserver(!0)},w.prototype.getTotalCellClasses=function(e,t){var a="";return a+=this.rows[e][0].cells[t].classList.contains("pivot-hidden-column")?"pivot-hidden-column":""},w.prototype.appendTotalCol=function(){var e=this;if(!s.default.hasLoadingContent(e.tableWrapper)){e.pauseUpdate=!0,e.setMutationObserver(!0);var t=!1;if(e.totalCol){var a=C,l=!1,i=e.totalCol;"Sum"==e.totalCol?a=T:"Min"==e.totalCol?a=S:"Max"==e.totalCol?a=I:"Multiplication"==e.totalCol?(a=x,i="Product"):l=!0,i=e.totalColName?e.totalColName:i,e.tables.each((function(t){var r=$(this),o=null,n=null;if(e.rows[t].length&&e.rows[t][0].classList.contains("tf-header-hidden")){var c=r.find("tr.pivot-header"),d=c.eq(0);if(0===d.children("th.total-col").length){var f=$('<th class="total-col confluenceTh" rowspan="'.concat(c.length,'"></th>')).text(i);d.append(f)}}(0,v.spliceSelectors)(e.rows[t],e.totalRows[t]).each((function(t){for(var r={calc:a},c=this.children,d=null,f=c.length-1;f>=0;f--)if(c[f].classList.contains("total-col")){d=$(c[f]);break}if(d||(d=$(m().totalCol({rowNumber:t})),$(this).append(d)),0===t)d.find("p").text(i);else{for(f=0;f<c.length;f++){var p=c[f];if(!(p.classList.contains("tf-numbering")||p.classList.contains("total-col")||p.classList.contains("numberingColumn")||p.classList.contains("pivot-hidden-column"))){if(!p.classList.contains("tf-hidden-column")){var u=s.default.clearString(p.textContent);null==o&&u&&(o=s.default.getValueType(u,e.separator,e.worklog,!0));var h=s.default.parseValueByType(o,u,e.separator,e.worklog,!0);s.default.isNumber(h)&&(r.calc(h),o!==s.default.number||n||(n=s.default.getNumberFormatter(u,e.separator)))}0}}var b=s.default.formatValueByType(r.total,o,(function(t){if(void 0===t)return"";l&&(t=k(t));var a=e.formatDecimal.to(t);return n?n(a):a}),e.worklog,e.separator),v=d.children("p");v.length||(v=$("<p></p>"),d.prepend(v)),v.text(b)}})),e.isCloud&&r.attr("data-layout")&&0===r.find("colgroup col.tftc").length&&r.find("colgroup").append('<col class="tftc" style="width: fit-content"> ')})),t=!0}else{var r=e.tables.find("th.total-col");r.length&&(t=!0,r.remove(),e.tables.find("colgroup col.tftc").remove())}return t&&e.updateSorterAndRawTables(!0,!0),e.pauseUpdate=!1,e.setMutationObserver(!0),t}},w.prototype.updateSorterAndRawTables=function(e,t){var a=this;a.shouldUpdateSorter=a.shouldUpdateSorter||t,a.shouldUpdateRawTables=a.shouldUpdateRawTables||e,a.spakLinesFinished&&(a.shouldUpdateSorter&&(a.tables.not(".pivot-table-result,.merged-header").trigger("updateAll",!1),a.tables.not(".pivot-table-result").trigger("update",!1)),a.shouldUpdateRawTables&&a.updateRawTables(),a.shouldUpdateSorter=!1,a.shouldUpdateRawTables=!1,a.spakLinesFinished=!1)},w.prototype.bindChangeLabel=function(){var e=this;e.comboBoxDiv.delegate(".filter-container label.hideble","dblclick",(function(){var t=$(this).find(".tf-label-name"),a=!0,l=$(this).parent(),i=t.css("width");t.hide(),l.prepend(m().labelChanger({value:t.text(),width:parseInt(i,10)+6+"px"}));var r=!1,s=l.find(".tf-label-changer");s.focus(),s[0].select(),s.bind("keydown",(function(l){13==l.keyCode&&(t.text(s.val()),s.remove(),t.show(),a=!1,e.enableSaveBtn()),32==l.keyCode&&(r=!0)})),s.bind("input",(function(){var e=s.textWidth(s.html())+6;r&&(e+=4,r=!1),s.css("width",(e<10?10:e)+"px")})),$(document).one("click",(function(e){!$(e.target).closest(".tf-label-changer").length&&a&&(s.remove(),t.show(),a=!1)}))})),$.fn.textWidth=function(e,t){return $.fn.textWidth.fakeEl||($.fn.textWidth.fakeEl=$("<span>").hide().appendTo(document.body)),$.fn.textWidth.fakeEl.text(e||this.val()||this.text()).css("font",t||this.css("font")),$.fn.textWidth.fakeEl.width()}},w.prototype.getFilterLabels=function(){var e=this,t=[];return a(".selectfilter-element"),a(".userfilter-element"),a(".numberfilter-element"),a(".datefilter-element"),a(".globalfilter-element"),a(".columnhider-element"),a(".iconfilter-element"),t.join("");function a(a){e.comboBoxDiv.find(a+" .tf-label-name").each((function(){t.push($(this).text())}))}},w.prototype.initInlineFilterButton=function(){var e=this,t=this,a=t.tables.eq(0),l=t.filterIcon.parent();t.inlineFilterBtns=t.outerWrapper.find(".tf-inline-filter.".concat(t.macroId,"-").concat(t.sessionId)),t.inlineFilterBtn=t.inlineFilterBtns.filter(".btn"),t.inlineFilterTrigger=t.inlineFilterBtns.filter(".trigger");var i,r,o,n,c,d,f,u=!1;t.inlineFilterBtn.unbind("click").click((function(a){o=i,w(n=r,t.inlineFilterTrigger),e.comboBoxDiv.removeAttr("open"),e.comboBoxDiv.attr("open",!0),a.stopPropagation()}));var m,h,b,v="Filter Added from "+(t.params.liveMode?"Live":"Header");function g(){b&&(b.unwrap(),b.css(b.orig_sizes),b.elclone.before(b),b.elclone.remove(),b=null)}function y(){r&&w(r,t.inlineFilterBtn),n&&(w(n,t.inlineFilterTrigger),u&&(t.comboBoxDiv.find("select").trigger("chosen:close"),t.comboBoxDiv.removeAttr("open"),u=!0,t.comboBoxDiv.attr("open",!0)))}function w(e,a){var l=e.offset();a.offset({top:h?void 0:l.top-3,left:Math.min(l.left+e.outerWidth(),t.tableWrapper.offset().left+t.tableWrapper.width())-16}).addClass("visible")}function x(){var e=t.tables.eq(0).offset(),i=t.tableWrapper.eq(0).offset();l.offset({top:Math.max(e.top,i.top)+5,left:Math.max(e.left,i.left)+Math.min(a.width(),t.tableWrapper.width())-(t.isCloud?4:2)})}this.comboBoxDiv.unbind("aui-hide aui-show").bind("aui-hide",(function(){u=!1,t.inlineFilterTrigger.removeClass("active mimic"),t.filterIcon.removeClass("open"),g(),A()})).bind("aui-show",(function(){var a;u||(o=i,n=r),t.inlineFilterTrigger.addClass("active"),t.inlineFilterTrigger.removeClass("visible");var l="";o?(l=s.default.getCellText(o[0]),a='[name="'.concat(l,'"]')):a="."+("globalfilter"===c?"global-filter":"column-select");var m=e.comboBoxDiv.find(".filter-container").addClass("hidden").find("input,select").filter(a).parents(".filter-container").removeClass("hidden");if(!m.length){var h=o?e.detectFilterType(l):c;m=e.addFilter(h,l),$("body").trigger("filter-added-deleted",{action:v,type:h,pageMode:t.isPreview?"Macro Preview":"Page View"}),p.default.headerFilterAdded(h,"normal")}if(!u||f){clearTimeout(d);var b=u?f:m.find("input").eq(0);d=setTimeout((function(){return b.focus()}),10)}u=!0})),this.menu.find(".show-filter").unbind("click").click((function(){i=null,r=null,o=null,n=null;var e=t.tables.eq(0).offset();t.inlineFilterTrigger.addClass("mimic").offset({top:e.top+5,left:Math.max(e.left,t.tableWrapper.offset().left)+Math.min(a.width(),t.tableWrapper.width())+11}),t.filterIcon.addClass("open"),c=$(this).attr("data-filter-type"),t.comboBoxDiv[0].open=!0})),this.visibleHeaderCells=[],this.rows.forEach((function(a,l){var s=$(a[0]),c=s.children();s.hasClass("tf-header-hidden")&&(s=t.tables.eq(l).find(".pivot-header").last());var d=s.children();e.visibleHeaderCells.push(d);var f=t.numbering&&!c[0].classList.contains("tf-numbering")?1:0;t.tables.eq(l).off("mouseleave.tf mouseenter.tf","td,th").on("mouseleave.tf","td,th",(function(){!u&&t.inlineFilterTrigger.removeClass("visible"),t.inlineFilterBtn.removeClass("visible")})).on("mouseenter.tf","td,th",(function(){if(i=c.eq(this.cellIndex-f),r=t.getVisibleHeaderCell(l,this.cellIndex-f),i.length&&r.length){var e=t.isFilteredByCell(i);t.inlineFilterBtn.toggleClass("filtered",e),w(r,t.inlineFilterBtn),u||(o=i,n=r,t.inlineFilterTrigger.toggleClass("filtered",e),w(r,t.inlineFilterTrigger))}else i=null,r=null}))})),this.tables.parents(".table-wrap, .table-wrap-aui").unbind("scroll.live").bind("scroll.live",(function(){h=!0,y(),clearTimeout(m),m=setTimeout((function(){return h=!1}),50)})),this.tableWrapper.unbind("tf-filtered.live").bind("tf-filtered.live",(function(){i&&t.inlineFilterBtn.toggleClass("filtered",t.isFilteredByCell(i)),u&&(f=t.comboBoxDiv.find("input:focus")),setTimeout((function(){y(),x()}),20)})),a.unbind("mouseleave.tft mouseover.tf").bind("mouseover.tf",(function(){x(),t.filterIcon.addClass("visible")})).bind("mouseleave.tft",(function(){return t.filterIcon.removeClass("visible")})),this.comboBoxDiv.undelegate("chosen:showing_dropdown.live").delegate("select","chosen:showing_dropdown.live",(function(e,a){if(g(),"true"!==t.comboBoxDiv.attr("aria-hidden")){var l=(b=a.chosen.container)[0],i=l.style,r=l.getBoundingClientRect();b.orig_sizes={width:b.width(),height:b.height(),position:i.position,top:i.top,left:i.left,zIndex:i.zIndex};var s=$.extend({},b.orig_sizes);s.position="absolute",s.top=r.top+window.pageYOffset,s.left=r.left+window.pageXOffset,s.zIndex=999999;var o=b.elclone=b.clone();o.find(".chosen-drop").remove(),b.before(o),b.css(s),$("body").append($('<div class="wiki-content"></div>').append(b)),b.click((function(e){return e.stopPropagation()}))}})).undelegate("chosen:hiding_dropdown.live tf-close.live").delegate("select","chosen:hiding_dropdown.live tf-close.live",g)},w.prototype.highlightFilteredColumn=function(e){var t=this;if("Table header"===this.params.hidePane&&!this.editorMacro){var a=this.hasFilterValues(e),l=e.attr("name");this.rawTables.forEach((function(e,i){s.default.getCellPositions(e,l).forEach((function(e){t.getVisibleHeaderCell(i,e).toggleClass("filtered-header",a),t.inlineFilterTrigger.toggleClass("filtered",a)}))}))}},w.prototype.getVisibleHeaderCell=function(e,t){for(var a=this.visibleHeaderCells[e].eq(t);a.length&&("none"===a[0].style.display||a.hasClass("tf-hidden-column"));){var l=a.data("parentCell");a=l||a.prev()}return a},w.prototype.hasFilterValues=function(e){var t=Boolean(e.val());return(e.hasClass("date")||e.hasClass("number"))&&(t=t||Boolean(e.parents(".range").find("input").not(e).val())),t},w.prototype.getFilterByCell=function(e){var t=s.default.getCellText(e[0]);return this.comboBoxDiv.find("input,select").filter('[name="'.concat(t,'"]'))},w.prototype.isFilteredByCell=function(e){var t=this,a=!1;return t.getFilterByCell(e).each((function(){t.hasFilterValues($(this))&&(a=!0)})),a},w.prototype.detectFilterType=function(e){var t=this;if(this.getDateMacroFormatIfPresent(e))return"datefilter";var a="userfilter";return this.rawTables.some((function(l,i){var r=s.default.getCellPosition(l,e);if(null!=r){var o=(new f.default).getColumnData(l,r,t.dateFormat,t.locale,t.separator,t.worklog);if(o)return o.type===b.DATA_TYPES.date?(t.dateFormat=o.dateFormat,a="datefilter"):o.type===b.DATA_TYPES.number?a="numberfilter":o.type===b.DATA_TYPES.label&&(a="selectfilter"),!0;if(t.rawIconTables||t.updateRawIconTables(),(new f.default).getColumnValues(t.rawIconTables[i],r).length)return a="iconfilter",!0}})),a},w.prototype.addToAllowRowList=function(e){var t=this,a=e.closest("table");if(a.length){var l=t.tables.index(a),i=t.rows[l].index(e);t.allowRowList||(t.allowRowList=new Array(t.tables.length)),t.allowRowList[l]||(t.allowRowList[l]=[]),t.allowRowList[l].push(i)}},w.prototype.correctionWithAllowRowList=function(){var e=this;e.allowRowList&&e.allowRowList.forEach((function(t,a){t&&t.forEach((function(t){e.cbState[a][t-1]=!0}))}))},w.prototype.setTextForFakeCells=function(e){for(var t=e.html(),a=e;a.data("childCell");)(a=a.data("childCell")).html(t);for(var l=e;l.data("parentCell");)(l=l.data("parentCell")).html(t)},t.default=w}}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.stiltsoft.confluence.plugin.tablefilter.tablefilter:5cf9146279e737adca16a6efc17b412e', location = 'build/3924.js' */
"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3924],{4138:function(e,t,a){a.r(t),a.d(t,{DATA_TYPES:function(){return r}});var r={date:"date",number:"number",label:"label",text:"text"}},3924:function(e,t,a){a.r(t);var r=a(3931),l=a(4138),n=a(4238);function u(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,a,o;return t=e,(a=[{key:"init",value:function(e){e.hasClass("pivot-table-result")||(r.default.normalizeTable(e,"data-tf-ready"),r.default.processMergedCells(e));var t=r.default.getTablesAndRowsFromTables(e,r.default.mixedType);this.rowsArray=t.rows,this.tablesArray=t.tables,this.tableColumns=r.default.getRawColumns(this.tablesArray),this.dateFormat=n.default.getStoredValue("tf-dateformat")||r.default.getLocaleDateFormat("yy-mm-dd"),this.locale=r.default.getLocale(),this.worklog=r.default.getWorklog(n.default.getStoredValue("tf-worklog")),this.separator=r.default.mapSeparator(n.default.getStoredValue("tf-decimalSeparator"))||"."}},{key:"rows",get:function(){return this.rowsArray}},{key:"tables",get:function(){return this.tablesArray}},{key:"columns",get:function(){return this.tableColumns}},{key:"userLocale",get:function(){return this.locale}},{key:"columnsData",get:function(){var e=this,t={};return this.tableColumns.forEach((function(a,l){e.tablesArray.some((function(l){var n=r.default.getCellPosition(l,a),u=e.getColumnData(l,n,e.dateFormat,e.locale,e.separator,e.worklog);if(u)return t[u.type]||(t[u.type]=[]),t[u.type].push({column:a,columnData:u}),!0}))})),t}},{key:"getColumnValues",value:function(e,t){return e.map((function(e){return e[t]})).filter((function(e,t){return t&&e}))}},{key:"getColumnData",value:function(e,t,a,n,u,o){var s=this.getColumnValues(e,t),i=new Set(s);if(s.length){var f=r.default.getDateFormat(s,n,f);if(f)return{type:l.DATA_TYPES.date,values:i,rawValues:e.map((function(e){return e[t]})),dateFormat:f};var c=r.default.getValueType(s[0],u,o,!0);if(null!==c)return{type:l.DATA_TYPES.number,values:i,valueType:c};if(i.size<s.length)return{type:l.DATA_TYPES.label,values:i,hasRepeats:!0};if(s.length<51){var d=s.reduce((function(e,t){return e+t})).length/s.length;if(d<30)return{type:l.DATA_TYPES.label,values:i,avgLength:d}}return{type:l.DATA_TYPES.text,values:s}}return null}}])&&u(t.prototype,a),o&&u(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.default=o}}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.stiltsoft.confluence.plugin.tablefilter.tablefilter:6e27d881b5ac1c72f3cc31d1359f4372', location = 'build/479.js' */
"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[479],{2457:function(e,a,t){t.r(a);var i=t(6951),n=t.n(i),r=t(3931),s=t(4818);function o(e,a){for(var t=0;t<a.length;t++){var i=a[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function l(e,a,t){return a&&o(e.prototype,a),t&&o(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function g(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}var p=l((function e(a,t,i,o,l,p){var d=this;!function(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}(this,e),g(this,"removePaginationAttribute",(function(){d.removeRowsPaginationAttribute((0,s.spliceSelectors)($(d.rows,d.rowHeader))),$(d.table).removeAttr("pagination")})),g(this,"removeRowsPaginationAttribute",(function(e){var a=e.filter("[visibleForPagination]");a.removeAttr("visibleForPagination visibleForPaginationAnim"),a.children("td[visibleForPagination]").each((function(e,a){var t=$(a);t.removeAttr("visibleForPagination");var i=t.data("savedRowSpan");i&&t.attr("rowspan",i);var n=t.data("savedColSpan");n&&t.attr("colspan",n)}))})),g(this,"getParrentTableElement",(function(e){var a=$(e).closest(".tablefilter-table-wrapper .table-wrap");return a.length?a[0]:d.tablefilter.isCloud?e.parentNode:d.findParrentTableElement(e)})),g(this,"findParrentTableElement",(function(e){var a=$(e).parent();return a.length?a.hasClass("tablefilter-table-wrapper")?e:d.findParrentTableElement(a[0]):null})),g(this,"getPaginationPages",(function(e){d.removeRowsPaginationAttribute($(d.rows));var a=[],t=0,i=0;a[t]=[];var n=d.rows.length,s=!1;d.tablefilter.filtered||(s=!0,d.tablefilter.params.showNRows>0&&(n=Math.min(n,parseInt(d.tablefilter.params.showNRows))));for(var o=0;o<n;o++){var l=d.rows[o];(s||r.default.isRowVisible(l))&&(i>=e&&(i=0,a[++t]=[]),a[t][i]=l,i++)}return a})),g(this,"addPaginationPanel",(function(e){var a=$(d.render());$(e).after(a),d.panel=a,d.paginationItems=a.find("li:not(.aui-nav-pages)"),d.itemPrev=$(d.paginationItems[0]),d.itemFirst=$(d.paginationItems[1]),d.itemTruncationLeft=$(d.paginationItems[2]),d.itemTruncationRight=$(d.paginationItems[d.paginationItems.length-3]),d.itemLast=$(d.paginationItems[d.paginationItems.length-2]),d.itemNext=$(d.paginationItems[d.paginationItems.length-1]),d.items=d.paginationItems.slice(3,d.paginationItems.length-3);var t=d;return d.paginationItems.off("click").click((function(){return t.showPaginationsPage($(this).data("index-page"),t.pages),!1})),a})),g(this,"showPaginationsPage",(function(e,a){e=e||0,e=Math.min(Math.max(e,0),d.pages.length-1);var t=$(a[d.indexCurrentPage]);d.removeRowsPaginationAttribute(t),d.indexCurrentPage=e;var i=$(a[e]);i.attr("visibleForPagination","true"),setTimeout((function(){i.attr("visibleForPaginationAnim","true")}),0),d.showMergeCells(i),d.selectedPagination()})),g(this,"showMergeCells",(function(e){e.children("td.fake").each((function(e,a){for(var t=$(a),i=t;i.data("parentCell");){var n=i.data("parentCell"),s=n.parent();if(s.attr("visibleForPagination"))break;if("none"!==n[0].style.display&&r.default.isRowVisible(s[0])){t.attr("visibleForPagination","true");var o=t.attr("rowspan");if("-1"==o){var l=d.findRowSpan(t);t.data("savedRowSpan",o),t.attr("rowspan",l)}var g=t.attr("colspan"),p=n.attr("colspan");"-1"==g&&p>0&&(t.data("savedColSpan",g),t.attr("colspan",p));break}i=n}}))})),g(this,"findRowSpan",(function(e){for(var a=1,t=e;t.data("childCell");){var i=(t=t.data("childCell")).parent();i.length&&i.attr("visibleForPagination")&&a++}return a})),g(this,"selectedPagination",(function(){var e=0,a=d.pages.length-1;d.pages.length>9&&(e=d.indexCurrentPage-3,a=d.indexCurrentPage+3,e<0?(a+=-e,e=0):a>=d.pages.length&&(e-=a-(d.pages.length-1),a=d.pages.length-1)),0==e?d.itemTruncationLeft.addClass("hidePaginationBtn"):d.itemTruncationLeft.removeClass("hidePaginationBtn"),a==d.pages.length-1?d.itemTruncationRight.addClass("hidePaginationBtn"):d.itemTruncationRight.removeClass("hidePaginationBtn"),0==d.indexCurrentPage?(d.itemPrev.addClass("passivePaginationBtn"),d.itemFirst.addClass("aui-nav-selected")):(d.itemPrev.removeClass("passivePaginationBtn"),d.itemFirst.removeClass("aui-nav-selected")),d.indexCurrentPage==d.pages.length-1?(d.itemNext.addClass("passivePaginationBtn"),d.itemLast.addClass("aui-nav-selected")):(d.itemNext.removeClass("passivePaginationBtn"),d.itemLast.removeClass("aui-nav-selected")),d.items.addClass("hidePaginationBtn"),d.items.filter("li.aui-nav-selected").removeClass("aui-nav-selected"),$(d.items[d.indexCurrentPage-1]).addClass("aui-nav-selected"),d.items.slice(e,a-1).removeClass("hidePaginationBtn"),d.itemTruncationLeft.data("index-page",e),d.itemTruncationRight.data("index-page",a),d.itemPrev.data("index-page",d.indexCurrentPage-1),d.itemNext.data("index-page",d.indexCurrentPage+1)})),g(this,"render",(function(){for(var e="",a=1;a<d.pages.length-1;a++){e+='<li data-index-page="'.concat(a,'"><a>').concat(a+1,"</a></li>")}return n().sanitize('\n     <div contenteditable = "false" class="tablefilter-pagination synchrony-exclude">\n       <ol class="aui-nav aui-nav-pagination" style = "display: inline-block; padding: 0;">\n            <li class="aui-nav-previous"><a>'.concat("Prev",'</a></li>\x3c!--\n         --\x3e<li class="aui-nav-first" data-index-page="0"><a>1</a></li>\x3c!--\n         --\x3e<li class="aui-nav-truncation"><a>&hellip;</a></li>\x3c!--\n         --\x3e<li class="aui-nav-pages">\n           <ol class="aui-nav aui-nav-pagination" style="padding: 0;">').concat(e,'</ol>\n         </li>\x3c!--\n         --\x3e<li class="aui-nav-truncation"><a>&hellip;</a></li>\x3c!--\n         --\x3e<li class="aui-nav-last" data-index-page="').concat(d.pages.length-1,'"><a>').concat(d.pages.length,'</a></li>\x3c!--\n         --\x3e<li class="aui-nav-next"><a>').concat("Next","</a></li>\n       </ol>\n     </div>"),{ADD_ATTR:["contenteditable"]})})),this.tablefilter=a,this.table=t,this.wrapper=o,this.rows=i.slice(1);var c=$(i[0]);c.hasClass("tf-header-hidden")?this.rowHeader=$(t).find("tr.pivot-header"):this.rowHeader=c,this.indexCurrentPage=p,this.parentTableElement=this.getParrentTableElement(t),this.parentTableElement&&(this.pages=this.getPaginationPages(l),this.pages.length>1?(this.addPaginationPanel(this.parentTableElement),this.showPaginationsPage(this.indexCurrentPage,this.pages),$(this.table).attr("pagination","true"),this.rowHeader.attr("visibleForPagination","true").attr("visibleForPaginationAnim","true")):this.removePaginationAttribute())}));g(p,"create",(function(e,a){if(e.params.rowsPerPage>0&&e.tables.length){var t=[];e.tableWrapper.find(".tablefilter-pagination").remove();var i=a?p.getIndexesCurrentPage(e):null;e.tables.each((function(a,n){var r=0;i&&(r=i[a]),t.push(new p(e,n,(0,s.spliceSelectors)(e.rows[a],e.totalRows[a]),e.tableWrapper,e.params.rowsPerPage,r))})),e.paginations=t}else p.remove(e.tableWrapper),e.paginations=null})),g(p,"remove",(function(e){e.find(".tablefilter-pagination").remove(),e.find("table[pagination]").removeAttr("pagination").find("tr[visibleForPagination]").removeAttr("visibleForPagination visibleForPaginationAnim").children("[visibleForPagination]").removeAttr("visibleForPagination")})),g(p,"getIndexesCurrentPage",(function(e){var a=null;if(e.paginations){a=[];for(var t=0;t<e.paginations.length;t++)a.push(e.paginations[t].indexCurrentPage)}return a})),a.default=p},479:function(e,a,t){t.r(a);t(2381),t(2457);function i(e,a){for(var t=0;t<a.length;t++){var i=a[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function n(e,a,t){return a&&i(e.prototype,a),t&&i(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}var r,s,o,l=n((function e(){!function(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}(this,e)}));o=function(e){var a=parseInt(e.showNRowsifNotFiltered),t=parseInt(e.ignoreFirstNrows),i=parseInt(e.rowsPerPage);a>=0||(e.showNRowsifNotFiltered="all"),t>0||(e.ignoreFirstNrows=""),i>0||(e.rowsPerPage=""),0==parseInt(e.showNRows)&&(e.showNRows="0+"),e.showNRows&&(-1!=e.showNRows.indexOf("*")?e.ignoreFirstNrows=e.showNRows.replace("*",""):-1!=e.showNRows.indexOf("+")?e.showNRowsifNotFiltered=e.showNRows.replace("+",""):e.showNRows>0&&(e.rowsPerPage=e.showNRows.replace("+","")),e.showNRows="")},(s="adaptOldParamsTF")in(r=l)?Object.defineProperty(r,s,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[s]=o,a.default=l}}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.stiltsoft.confluence.plugin.tablefilter.tablefilter:57c1621f41a2f3a40054765338c42b57', location = 'build/1706.js' */
"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[1706],{1706:function(t,n,e){e.r(n),e.d(n,{FONT_FAMILY:function(){return c},findLongestText:function(){return u},getTextWidth:function(){return r},getTextWidthCanvas:function(){return o},hashCode:function(){return i}});var r=function(t){return o(t)},u=function(t){return t.length?1===t.length?{text:t[0],width:r(t[0])}:{text:t.reduce((function(t,e,u){1===u&&(n=r(t));var o=r(e);return o>n?(n=o,e):t})),width:n}:{text:"",width:0};var n},o=function t(n){return t.context||((t.context=document.createElement("canvas").getContext("2d")).font="14px ".concat(c)),t.context.measureText(n).width},c='-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, "Fira Sans", "Droid Sans", "Helvetica Neue", sans-serif',i=function(t){var n=0;if(!t)return n;for(var e=0;e<t.length;e++)n=(n<<5)-n+t.charCodeAt(e),n&=n;return n}}}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.stiltsoft.confluence.plugin.tablefilter.tablefilter:7fc1c982064bd7429dd7b338249f931c', location = 'build/2166.js' */
(self.webpackChunk=self.webpackChunk||[]).push([[2166],{2166:function(e,n){var t,r,i;r=[],void 0===(i="function"==typeof(t=function(){"use strict";var e=["decimals","thousand","mark","prefix","suffix","encoder","decoder","negativeBefore","negative","edit","undo"];function n(e){return e.split("").reverse().join("")}function t(e,n){return e.substring(0,n.length)===n}function r(e,n){return e.slice(-1*n.length)===n}function i(e,n,t){if((e[n]||e[t])&&e[n]===e[t])throw new Error(n)}function o(e){return"number"==typeof e&&isFinite(e)}function f(e,n){return e=e.toString().split("e"),(+((e=(e=Math.round(+(e[0]+"e"+(e[1]?+e[1]+n:n)))).toString().split("e"))[0]+"e"+(e[1]?+e[1]-n:-n))).toFixed(n)}function u(e,t,r,i,u,s,a,c,p,l,h,d){var g,v,w,x=d,m="",y="";return s&&(d=s(d)),!!o(d)&&(!1!==e&&0===parseFloat(d.toFixed(e))&&(d=0),d<0&&(g=!0,d=Math.abs(d)),!1!==e&&(d=f(d,e)),-1!==(d=d.toString()).indexOf(".")?(w=(v=d.split("."))[0],r&&(m=r+v[1])):w=d,t&&(w=n(w).match(/.{1,3}/g),w=n(w.join(n(t)))),g&&c&&(y+=c),i&&(y+=i),g&&p&&(y+=p),y+=w,y+=m,u&&(y+=u),l&&(y=l(y,x)),y)}function s(e,n,i,f,u,s,a,c,p,l,h,d){var g,v="";return h&&(d=h(d)),!(!d||"string"!=typeof d)&&(c&&t(d,c)&&(d=d.replace(c,""),g=!0),f&&t(d,f)&&(d=d.replace(f,"")),p&&t(d,p)&&(d=d.replace(p,""),g=!0),u&&r(d,u)&&(d=d.slice(0,-1*u.length)),n&&(d=d.split(n).join("")),i&&(d=d.replace(i,".")),g&&(v+="-"),""!==(v=(v+=d).replace(/[^0-9\.\-.]/g,""))&&(v=Number(v),a&&(v=a(v)),!!o(v)&&v))}function a(n){var t,r,o,f={};for(void 0===n.suffix&&(n.suffix=n.postfix),t=0;t<e.length;t+=1)if(void 0===(o=n[r=e[t]]))"negative"!==r||f.negativeBefore?"mark"===r&&"."!==f.thousand?f[r]=".":f[r]=!1:f[r]="-";else if("decimals"===r){if(!(o>=0&&o<8))throw new Error(r);f[r]=o}else if("encoder"===r||"decoder"===r||"edit"===r||"undo"===r){if("function"!=typeof o)throw new Error(r);f[r]=o}else{if("string"!=typeof o)throw new Error(r);f[r]=o}return i(f,"mark","thousand"),i(f,"prefix","negative"),i(f,"prefix","negativeBefore"),f}function c(n,t,r){var i,o=[];for(i=0;i<e.length;i+=1)o.push(n[e[i]]);return o.push(r),t.apply("",o)}function p(e){if(!(this instanceof p))return new p(e);"object"==typeof e&&(e=a(e),this.to=function(n){return c(e,u,n)},this.from=function(n){return c(e,s,n)})}return p})?t.apply(n,r):t)||(e.exports=i)}}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.stiltsoft.confluence.plugin.tablefilter.tablefilter:tf-editor-resources', location = 'build/tf-editor.js' */
!function(){"use strict";var e,t={4071:function(e,t,a){a.r(t);var r=a(3120),i=a(3931),n=a(1230),l=a.n(n),o=a(2457),s=a(1706),d=a(3926),c={contents:null,tfs:{},panels:[],init:function(){var e=this;(0,d.makeAjax)({contentType:"application/x-www-form-urlencoded; charset=utf-8",type:"GET",cache:!1,url:Confluence.getContextPath()+"/rest/table-filter/1.0/service/license",dataType:"json",success:function(t){t&&(e.initFilters(),e.bindEvents(),AJS.Rte.Content.editorResetContentChanged())}})},initFilters:function(){var e=this;e.contents=$("#wysiwygTextarea_ifr").contents(),e.toolbar=$("#rte-toolbar"),e.contents.find('[data-macro-name="table-filter"]').each((function(){e.createFilter($(this))}))},bindEvents:function(){var e=this;new MutationObserver((function(t){t.forEach((function(t){Array.prototype.forEach.call(t.addedNodes,(function(t){var a;(a=t).attributes&&a.attributes["data-macro-name"]&&"table-filter"===a.attributes["data-macro-name"].value?e.createFilter($(a)):a.querySelectorAll&&$(a.querySelectorAll('[data-macro-name="table-filter"]')).each((function(){e.createFilter($(this))}))}))}))})).observe(e.contents[0],{childList:!0,subtree:!0}),AJS.bind("created.property-panel",(function(t,a){if("macro"==a.type){var r=$(a.anchor);if("table-filter"==r.attr("data-macro-name")){var i=r.attr("id"),n=e.tfs[i];if(n&&n.tables.length)e.toolbar.find(".tablefilter-outer-wrapper").data("id")==i?a.panel.find(".macro-property-panel-show-tf").addClass("hide-tf").addClass("visible").find(".panel-button-text").text("Hide filter"):a.panel.find(".macro-property-panel-show-tf").removeClass("hide-tf").addClass("visible").find(".panel-button-text").text("Show filter");else a.panel.find(".macro-property-panel-show-tf").hide()}}})),$(document).bind("enableContextToolbarRow.Toolbar",(function(){$(c.toolbar.find(".tablefilter-outer-wrapper")).appendTo(c.toolbar)})),e.bindSave(),tinymce.activeEditor.onUndo.listeners?(tinymce.activeEditor.onUndo.listeners.push({cb:function(){e.updateFilters()}}),tinymce.activeEditor.onRedo.listeners.push({cb:function(){e.updateFilters()}})):(tinymce.activeEditor.onUndo.add((function(){e.updateFilters()})),tinymce.activeEditor.onRedo.add((function(){e.updateFilters()})));var t,a=function(e,t){var a=$("<div/>").append(t.content),n=a.find('table[data-macro-name="table-filter"], table[data-macro-name="pivot-table"], table[data-macro-name="table-chart"], table[data-macro-name="table-joiner"]').each((function(e){var t=$(this),a=Confluence.MacroParameterSerializer.deserialize(t.attr("data-macro-parameters"));a.id=(new Date).getTime()+e+"_"+(0,s.hashCode)(this.outerHTML),t.attr("id",a.id),t.attr("data-macro-parameters",Confluence.MacroParameterSerializer.serialize(a))}));if(r.default.prototype.tableWrapper=a.find(".tablefilter-table-wrapper"),r.default.prototype.tables=r.default.prototype.tableWrapper.find("table"),r.default.prototype.editorMacro=!0,r.default.prototype.makeTablesScrollable(),0===n.length){var l=a.find("table.tf-copy-table");l.length&&(l.removeClass("tf-copy-table"),l.find("tr").filter((function(){return!i.default.isRowVisible(this)})).remove(),l.find(".fake").removeClass("fake").filter((function(){return"none"===this.style.display})).remove(),l.find(".tf-hidden-column, .tf-header-hidden").remove(),l.find('[class*="tf-rowspan-"]').each((function(){var e=$(this);e.removeClass(e.getClassStartsWith(/tf-rowspan-\d+/))})),l.find('[class*="tf-colspan-"]').each((function(){var e=$(this);e.removeClass(e.getClassStartsWith(/tf-colspan-\d+/))})))}t.content=a.html()},n=function(){clearTimeout(t),t=setTimeout((function(){$.each(e.tfs,(function(t,a){if(0==a.tableWrapper.closest("body").length){var r=e.contents.find('[id="'+t+'"]');r.length&&(r.attr("id",""),e.panels[t]&&(e.panels[t].remove(),e.panels[t]=null),e.createFilter(r))}}))}),100)},l=tinymce.activeEditor.plugins.confluencepaste||tinymce.activeEditor.plugins.aePaste;l.onPreProcess?(l.onPreProcess.listeners.push({cb:a}),l.onPostProcess.listeners.push({cb:n})):(tinymce.activeEditor.on("PastePreProcess",(function(e){a(tinymce.activeEditor,e)})),tinymce.activeEditor.on("PastePostProcess",n));var o={},d=function(e,t){if("mceTableInsertRowAfter"===e||"mceTableInsertRowBefore"===e||"mceTableDeleteRow"===e){var a=$(tinymce.activeEditor.selection.getNode()),r=a.closest("td.tablefilter-table-wrapper table");if(r.length){if(r.find("td[rowspan]:not(.fake)").each((function(e,a){var r=$(a);t?r.attr("rowspan",r.data("rowspan")):r.data("rowspan",r.attr("rowspan"))})),t){var i=a.closest("td.fake");if(i.length){var n=i.siblings("td:not(.fake)");n.length&&tinymce.activeEditor.selection.setCursorLocation(n[0])}r.find(".fake[rowspan]").remove()}if("mceTableInsertRowAfter"===e||"mceTableInsertRowBefore"===e)if(t){var l=a.closest("tr").children(),s=l.filter(".synchrony-exclude");o.count=s.length,o.total=l.length,o.data=s.map((function(e,t){return{index:t.cellIndex,classes:t.getAttribute("class")}})).toArray()}else if(o.count){var d=a.closest("tr").children();d.length>o.total-o.count&&o.data.forEach((function(e){return d.eq(e.index).attr("class",e.classes)}))}}}};tinymce.activeEditor.onBeforeExecCommand.add((function(e,t){d(t,!0)})),tinymce.activeEditor.onExecCommand.add((function(e,t){d(t,!1)})),$("#content-title").bind("focus click",(function(){e.toolbar.find(".tablefilter-outer-wrapper .disabled").removeClass("disabled").removeAttr("disabled"),e.toolbar.find(".tablefilter-outer-wrapper .lockEnabled").find(".filter-reset, .filter-settings").attr("disabled","disabled")})),e.contents.click((function(){e.toolbar.find(".tablefilter-outer-wrapper .lockEnabled").find(".filter-reset, .filter-settings").attr("disabled","disabled")})),e.toolbar.delegate(".tablefilter-outer-wrapper .aui-buttons.close","click",(function(){var e=c.toolbar.find(".tablefilter-outer-wrapper"),t=e.data("id");e.hide(),$("body").append(e),$("#inline-dialog-tf-add-filter-"+t).hide(),"false"==$("#filter-menu-view-"+t+"-"+AJS.params.pageId).attr("aria-hidden")&&$("#filter-settings-"+t).trigger("aui-button-invoke")})),tinymce.activeEditor.onBeforeExecCommand.add((function(e,t){if("mceTableDeleteRow"===t){var a=$(tinymce.activeEditor.selection.getNode());a.is("td,th")&&(a=a.parent()),a.children(".fake").remove(),a.children('[rowspan="-1"]').attr("rowspan","1")}})),AJS.bind("tf-unwrap",(function(t,a){var r=e.tfs[a];r&&(e.destroyFilterWithObservers(a,r),delete e.tfs[a])}))},bindSave:function(){var e=this;setTimeout((function(){!Confluence.Editor.UI.isButtonEnabled||Confluence.Editor.UI.isButtonEnabled(Confluence.Editor.UI.saveButton)?(AJS.Editor.addSaveHandler((function(){e.destroyFilters()})),AJS.bind("rte-changeMode",(function(t,a){a==Confluence.Editor.MODE_PREVIEW?e.destroyFilters():a==Confluence.Editor.MODE_RICHTEXT&&($(".tablefilter-outer-wrapper").remove(),e.initFilters())}))):e.bindSave()}),200)},createFilter:function(e){var t=c,a=Confluence.MacroParameterSerializer.deserialize(e.attr("data-macro-parameters"));if(a.id)if(e.data("tf-init")||0!==e.find('[data-macro-name="pivot-table"],[data-macro-name="table-joiner"],[data-macro-name="table-filter"]').length)t.tfs[a.id]&&(t.tfs[a.id].tables.trigger("destroy"),t.makeTablesSortable(t.tfs[a.id]));else{if(t.contents.find('[id="'+a.id+'"]').length>1)return;if(e.data("tf-init",!0),e.attr("id",a.id),e.find(".wysiwyg-macro-body:eq(0)").addClass("tablefilter-table-wrapper"),t.panels[a.id])return t.tfs[a.id].tableWrapper=e.find(".tablefilter-table-wrapper"),t.tfs[a.id].getTable(),t.tfs[a.id].normalizeTable(),t.tfs[a.id].addNumbering(),t.tfs[a.id].appendSparklines(),t.tfs[a.id].bindDOMChange(),t.tfs[a.id].makeTablesScrollable(),t.tfs[a.id].filterTable(),t.tfs[a.id].tables.trigger("destroy"),t.tfs[a.id].editorMacro=e,t.makeTablesSortable(t.tfs[a.id]),void t.bindSynchronyFiltration(e,t.tfs[a.id]);var i=a["cell-width"]?a["cell-width"].split(","):[],n=a.default?a.default.split(","):[],o=a.inverse?a.inverse.split(","):[],s=a.labels?a.labels.split(""):[],d=0,f=0,u=0,b=null!=a.column?a.column.split(","):[],p=t.getFilterObjects(b,s,n,i,o,d,f,u);d+=b.length,f+=b.length,u+=b.length,b=null!=a.userfilter?a.userfilter.split(","):[];var h=t.getFilterObjects(b,s,n,i,o,d,f,u);d+=b.length,f+=b.length,u+=b.length,b=null!=a.numberfilter?a.numberfilter.split(","):[];var m=t.getFilterObjects(b,s,n,i,o,d,-1,u);d+=b.length,u+=b.length,b=null!=a.datefilter?a.datefilter.split(","):[];var v=t.getFilterObjects(b,s,n,i,o,d,-1,u);d+=b.length,u+=b.length;var g=(b="true"==a.globalFilter?["Filter whole table"]:[]).length?t.getFilterObjects(b,s,n,i,o,d,f,u)[0]:null;d+=b.length,f+=b.length,u+=b.length;var y=(b="true"==a.hideColumns?["Hide columns"]:[]).length?t.getFilterObjects(b,s,n,i,o,d,f,u)[0]:null;d+=b.length,f+=b.length,u+=b.length,b=null!=a.iconfilter?a.iconfilter.split(","):[];var w=t.getFilterObjects(b,s,n,i,o,d,f,u),S=$(l().panel({macroId:a.id,pageId:AJS.params.pageId,comboBoxes:p,edits:h,numberFilters:m,dateFilters:v,globalFilter:g,hideColumns:y,iconFilters:w,showNRowsifNotFiltered:a.showNRowsifNotFiltered,hideLabels:a.hidelabels,disableSave:a.disableSave,hideControls:a.hideControls,hidePane:!1,fd:!1,editable:!0,isEditor:!0,sessionId:1,isMacroViewContext:!1}));S.addClass("toolbar-contextual"),S.append(l().editorCloseButton()),t.panels[a.id]=S,$("body").append(S);var E=$.extend(!0,{},a);E.macroParams=a,E.ddSeparator=(E.ddSeparator||"").replace(/\\u0020/g," "),E.ddOperator=E.ddOperator||"",E.showNRows=E.showNRows||"all",E.heightValue=E.heightValue||"",E.numbering=E.numbering||"",E.sorts=a.sort?$.map(a.sort.split(","),(function(e){return e.replace(//g,",")})):[],E.separator=E.separator?E.separator.replace("Point (.)",".").replace("Comma (,)",","):".",E.pageId=AJS.params.pageId,E.sparkline="true"===E.sparkline,E.sparkName=E.sparkName||"",E.isLockEnabled="true"!==E.enabledInEditor||e.attr("type"),E.thousandSeparator=(a.thousandSeparator||"").replace("\\u0020"," "),E.tabs=!1,E.editorMacro=e,t.tfs[a.id]=new r.default(E),E.isLockEnabled&&t.tfs[a.id].showTable(!0),t.makeTablesSortable(t.tfs[a.id]),S.hide();var F=c.toolbar.find(".tablefilter-outer-wrapper");F.length>0&&0===t.tfs[F.data("id")].tableWrapper.parents("body").length&&(F.remove(),S.show(),S.find(".enableLock:visible").click(),c.toolbar.append(S)),t.bindSynchronyFiltration(e,t.tfs[a.id])}},bindSynchronyFiltration:function(e,t){var a=this;e.attr("type")?(t.isLockEnabled=!1,t.setFilters(JSON.parse(e.attr("type")))):t.cbState.length&&t.showOrHideTables(),t.observerMacro||(t.observerMacro=new MutationObserver((function(r){r.forEach((function(r){"type"===r.attributeName?e.data("tf-self")?e.data("tf-self",!1):(t.isLockEnabled=!1,t.setFilters(JSON.parse(e.attr("type")))):("id"===r.attributeName&&e.data("tf-init")&&r.oldValue&&e.attr("id")&&r.oldValue!==e.attr("id")||"class"===r.attributeName&&r.oldValue&&-1!==r.oldValue.indexOf("tablefilter-table-wrapper")&&r.target.className&&-1===r.target.className.indexOf("tablefilter-table-wrapper")||"data-macro-parameters"===r.attributeName&&!e.attr("type"))&&(a.destroyFilterWithObservers(t.macroId,t),delete a.panels[t.macroId],delete a.tfs[t.macroId],e.data("tf-init",""),a.createFilter(e))}))})),t.observerMacro.observe(e[0],{attributes:!0,attributeOldValue:!0,attributeFilter:["type","id","class","data-macro-parameters"]}),t.observerMacro.observe(t.tableWrapper[0],{attributes:!0,attributeOldValue:!0,attributeFilter:["class"]}))},makeTablesSortable:function(e){e.sorting=!0,e.setMutationObserver(!0),e.tables.tablesorterEditor({cancelSelection:!1,dateFormat:e.dateFormat,locale:e.localeDateFormat,textExtraction:function(e){return i.default.getEditorCellText(e)}}),e.sorting=!1,e.setMutationObserver(!0)},destroyFilters:function(){var e=this;$.each(e.tfs,(function(t,a){e.destroyFilterWithObservers(t,a)})),e.tfs={}},destroyFilterWithObservers:function(e,t){var a=this;t.observer&&t.observer.disconnect(),t.observerMacro&&t.observerMacro.disconnect(),t.observersTd&&t.observersTd.length&&t.observersTd.forEach((function(e){e.disconnect()})),a.destroyFilter(t),a.cleanMacro(e),a.removePanel(e)},cleanMacro:function(e){return this.contents.find('[id="'+e+'"]').data("tf-init",!1).attr("id","")},removePanel:function(e){var t=this;t.panels[e]&&(t.panels[e].remove(),t.panels[e]=null)},destroyFilter:function(e){e.numbering="",e.fixedRows=0,e.editorSave=!0,e.showTableWithoutFilters(),e.addNumbering(),e.makeTablesScrollable(),e.tables.data("tf-merged-done",!1),e.tables.find(".fake").remove(),e.tables.trigger("destroy"),e.tables.find(".tablesorter-header").removeClass("tablesorter-header"),e.tables.find(".pivot-header").removeClass("pivot-header"),e.tables.find('[data-mce-style="display: none;"]').removeAttr("data-mce-style"),e.tables.find(".tf-sparkline-header, .tf-sparkline-container, .total-row, .total-col, .tf-header-hidden").remove(),e.tables.each((function(){$(this).data("fixed-header",!1)})),o.default.remove(e.tableWrapper)},updateFilters:function(){var e=this;$.each(e.tfs,(function(t,a){if(a.editorMacro.parent().length)a.tables.trigger("destroy"),e.makeTablesSortable(a),a.bindDOMChange();else{var r=e.cleanMacro(t);e.removePanel(t),e.createFilter(r)}}))},getFilterObjects:function(e,t,a,r,i,n,l,o){var s=[];return $.each(e,(function(e,d){var c=n+e,f=a.length>c?a[c].replace(//g,",").trim():"",u=f?f.replace(new RegExp("-Empty-","g"),"").split("&&"):[],b=f.split("->");s.push({label:t.length>o+e&&t[o+e]||d,name:d,defaultValue:f,columnWidth:l>-1&&r.length>l+e&&r[l+e]||"150",options:u,defaultFromValue:b[0],defaultToValue:b.length>1?b[1]:"",inverse:i.length>c&&"true"==i[c]})})),s}},f=c,u=a(9497);try{AJS.bind("init.rte",(function(){f.init(),AJS.Confluence.PropertyPanel.Macro.registerButtonHandler("show-tf",(function(e,t){var a=$(t),r=f.toolbar.find(".tablefilter-outer-wrapper"),i=r.data("id");r.hide(),$("body").append(r),$("#inline-dialog-tf-add-filter-"+i).hide(),"false"==$("#filter-menu-view-"+i+"-"+AJS.params.pageId).attr("aria-hidden")&&$("#filter-settings-"+i).trigger("aui-button-invoke");var n=$(".macro-property-panel-show-tf").hasClass("hide-tf");if(u.default.gaShowFilter(n),!n){var l=f.panels[a.attr("id")];l.show(),l.find(".enableLock").click(),f.toolbar.append(l)}})),$("body").delegate("button:has(.aui-iconfont-table-split, .aui-iconfont-table-col-left, .aui-iconfont-table-col-right, .aui-iconfont-table-row-remove, .aui-iconfont-table-col-remove, .table-split-cells, .table-insert-column-before,.table-insert-column-after, .table-delete-row, .table-delete-column)","mouseup",(function(){if(!$(this).is(".disabled")){var e=$(tinymce.activeEditor.selection.getNode());e.is("table")||(e=e.parents("table").eq(0)),e.find(".fake").remove()}}))}))}catch(e){}}},a={};function r(e){var i=a[e];if(void 0!==i)return i.exports;var n=a[e]={id:e,loaded:!1,exports:{}};return t[e].call(n.exports,n,n.exports,r),n.loaded=!0,n.exports}r.m=t,r.amdD=function(){throw new Error("define cannot be used indirect")},r.amdO={},e=[],r.O=function(t,a,i,n){if(!a){var l=1/0;for(c=0;c<e.length;c++){a=e[c][0],i=e[c][1],n=e[c][2];for(var o=!0,s=0;s<a.length;s++)(!1&n||l>=n)&&Object.keys(r.O).every((function(e){return r.O[e](a[s])}))?a.splice(s--,1):(o=!1,n<l&&(l=n));if(o){e.splice(c--,1);var d=i();void 0!==d&&(t=d)}}return t}n=n||0;for(var c=e.length;c>0&&e[c-1][2]>n;c--)e[c]=e[c-1];e[c]=[a,i,n]},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,{a:t}),t},r.d=function(e,t){for(var a in t)r.o(t,a)&&!r.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},function(){var e={6709:0};r.O.j=function(t){return 0===e[t]};var t=function(t,a){var i,n,l=a[0],o=a[1],s=a[2],d=0;if(l.some((function(t){return 0!==e[t]}))){for(i in o)r.o(o,i)&&(r.m[i]=o[i]);if(s)var c=s(r)}for(t&&t(a);d<l.length;d++)n=l[d],r.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return r.O(c)},a=self.webpackChunk=self.webpackChunk||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var i=r.O(void 0,[7945,5546,8342,2166,3926,4818,8353,1706,479,3924,3120],(function(){return r(4071)}));i=r.O(i)}();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.tngtech.confluence.plugins.tableenhancer:fixedheaders-general-resources', location = '/js/fixedheaders-general.js' */
AJS.toInit(function(){var J=function(m,f){function x(){"function"===typeof a().stickyTableHeaders&&a(".fixed-headers-container table").stickyTableHeaders("destroy");for(c=0;c<K;c++){g=a("div."+c,d).find("table:not(.clone):not(.confluenceTable .confluenceTable)");n=g.find(".tableenhancer-fixed-row");if(0<n.length)if(v("UpDown"),L>r&&p<B&&p>r)if(0===a(".vert_clone."+c,d).length){M("UpDown");var b=a("div.vert_clone."+c,d).css({height:t+1+"px",width:g.outerWidth()-1+"px"});y(b);b=a("div.hori_clone."+
c,d);0<b.length&&(u=b.parent(),v("LeftRight"),b=b.clone().addClass("clone corner_clone synchrony-exclude "+c).css({height:t+1+"px",width:z+1+"px"}).appendTo(u),y(b),b.children("table").removeClass("vert_clone hori_clone").addClass("clone corner_clone synchrony-exclude "+c).css({width:g.outerWidth()+"px",top:C+"px"}))}else N("UpDown");else D("UpDown");"editor"===f&&E()}}function E(){u="editor"===f?a(".fixed-headers-container."+c,d):a(this);g=u.find("table:not(.clone):not(.confluenceTable .confluenceTable)");
q=g.find(".tableenhancer-fixed-column");if(0<q.length){c=a.trim(u.attr("class").match(/(\s[0-9]+$|^[0-9]+\s|\s[0-9]+\s|^[0-9]+$)/g));v("LeftRight");var b="editor"===f?k<h:0>k;b?(0===a(".hori_clone."+c,d).length?(M("LeftRight"),a("div.hori_clone."+c,d).css({height:g.outerHeight()+O()+"px",width:z+2+"px",top:P()+"px",left:("editor"===f?h-k:h)+w+"px"}),b=a("div.vert_clone."+c,d),0<b.length&&(v("UpDown"),b.clone().addClass("clone corner_clone synchrony-exclude "+c).css({height:t+1+"px",width:z+1+"px",
left:("editor"===f?h-k:h)+w+"px"}).appendTo(b.parent()).children("table").removeClass("vert_clone hori_clone").addClass("clone corner_clone synchrony-exclude "+c).css({height:g.outerHeight()+"px",left:F+"px"}))):N("LeftRight"),"Chrome"===Q&&a(R).hide().show(1)):D("LeftRight")}}function G(){S();D("All");x();"editor"!==f&&a(".fixed-headers-container",d).each(E)}function J(b){var e=a(b.target).closest(".fixed-headers-container th, .fixed-headers-container td");e.hasClass("sortableHeader")&&(b=a(e).index(),
e=a(e).parents(".fixed-headers-container"),b=a(e).children("table").find("thead \x3e tr \x3e *").eq(b),a(b[0]).trigger("sort"))}function M(b){var e=g.clone().addClass("clone synchrony-exclude ").appendTo(a(".fixed-headers-container."+c,d));if("UpDown"===b)a(e).addClass("vert_clone "+c).css({width:g.outerWidth()+"px",top:C+"px"}).wrap('\x3cdiv class\x3d"clone vert_clone synchrony-exclude '+c+'"\x3e\x3c/div\x3e');else if("LeftRight"===b)a(e).addClass("hori_clone "+c).css({height:g.outerHeight()+"px",
left:F+"px"}).wrap('\x3cdiv class\x3d"clone hori_clone synchrony-exclude '+c+'"\x3e\x3c/div\x3e');else throw Error("Unknown scroll direction!");}function y(b){var e=O()+P();p>B-t-A[c]?a(b).css({top:"",bottom:A[c]+"px"}):a(b).css({bottom:"",top:T+(0<p+e-r?p+e-r:0)+"px"})}function O(){if("editor"===f){var b=a("#wysiwygTextarea_ifr").contents().find(".fixed-headers-container").children("p.auto-cursor-target");if(0<b.length)return b[0].offsetHeight}return 0}function P(){return"editor"===f?parseInt(a(g).css("margin-top")):
0}function N(b){if("UpDown"===b)y(a("div.vert_clone."+c,d)),y(a("div.corner_clone."+c,d));else if("LeftRight"===b)a("div.hori_clone."+c,d).css({left:("editor"===f?h-k:h)+w+"px"}),a("div.corner_clone."+c,d).css({left:("editor"===f?h-k:h)+w+"px"});else throw Error("Unknown scroll direction!");}function D(b){if("UpDown"===b)a(".vert_clone."+c,d).remove();else if("LeftRight"===b)a(".hori_clone."+c,d).remove();else if("All"===b)a(".clone",d).remove();else throw Error("unknown scroll direction!");a(".corner_clone."+
c,d).remove()}function v(b){if("UpDown"===b){b=0;if("display"===f){b=AJS.$("#main-header.overlay-header");var e=b.css("top");b=void 0===e||"auto"===e?AJS.$("header#header.fixed-header").outerHeight():b.outerHeight()+parseInt(e)}p=a(l).scrollTop()+b;r=g.offset().top;n=g.find(".tableenhancer-fixed-row");U=n.offset().top+n.outerHeight();t=Math.ceil(U-r);L=p+a(l).height();B=a("."+c+".fixed-headers-bottom-anchor",d).offset().top}else if("LeftRight"===b)q=g.find(".tableenhancer-fixed-column"),"editor"===
f?(h=a(l).scrollLeft(),k=g.offset().left,H=q.offset().left+q.outerWidth()):(h=u.scrollLeft(),k=g.position().left,H=q.position().left+q.outerWidth()),z=Math.ceil(H-k);else throw Error("unknown scroll direction!");}function I(b){var e=a(b).attr("data-fixed-rows"),c=a(b).attr("data-fixed-columns");0<e&&a(b).find("table \x3e :not(tfoot) \x3e tr:eq("+(e-1)+")").addClass("tableenhancer-fixed-row");0<c&&a(b).find("table tr").eq(-2).children(":nth-child("+c+")").addClass("tableenhancer-fixed-column");1<e&&
"editor"!==f&&V(b);S()}function S(){for(c=0;c<K;c++)if(g=a("div."+c,d).find("table:not(.clone):not(.confluenceTable .confluenceTable)"),n=g.find(".tableenhancer-fixed-row"),0<n.length){v("UpDown");for(var b=.6*a(l).height(),e=0,f,h=1;21>h&&!(f=g.find("tr").eq(-h).height(),e+=f,e>b-t);h++);A[c]=e-f}else A[c]=0}function V(b){a(b).find("table").trigger("destroy");setTimeout(function(){a(b).find(".tablesorter").removeClass("tablesorter");a(b).find(".sortableHeader").removeClass("sortableHeader");a(b).find(".tablesorter-header-inner").removeClass("tablesorter-header-inner")},
500)}var A=[],p,L,r,U,t,B,g,n,q,u,c,h,k,H,z,R,a=AJS.$;if("editor"===f){m=a("#wysiwygTextarea_ifr");var d=m.contents();var l=m[0].contentWindow?m[0].contentWindow:m[0].contentDocument.defaultView}else d=document,l=window;var K=a(".fixed-headers-container",d).length;a(".fixed-headers-container table:not(.clone):not(.confluenceTable .confluenceTable):not(.wysiwyg-macro)",d).after('\x3cdiv class\x3d"fixed-headers-bottom-anchor synchrony-exclude"\x3e\x3c/div\x3e');a(".fixed-headers-container",d).addClass(function(b){return b.toString()});
a(".fixed-headers-bottom-anchor",d).addClass(function(b){return b.toString()});0<a(".fixed-headers-bottom-anchor",d).length&&(R=a("div.fixed-headers-bottom-anchor",d));a(".fixed-headers-container",d).each(function(b,c){b=a(c).find("table:not(.clone):not(.confluenceTable .confluenceTable)");1<b.length&&Confluence.Editor.addErrorMessage("com_tngtech_confluence_plugins_tableenhancer_error_nested-table","Fixing rows/columns is only supported for top level tables, nested tables may not display correctly!",
!1);var e=!1;a(b.find("[colspan]")).each(function(b,c){1<a(c).attr("colspan")&&(e=!0)});a(b.find("[rowspan]")).each(function(b,c){1<a(c).attr("rowspan")&&(e=!0)});if(e||"editor"===f)I(c);else a(b).on("tableenhancer-rownums-completed",function(){I(c)});a(b).on("tableenhancer-rownums-completed",function(){a(c).find(".tableenhancer-fixed-row").removeClass("tableenhancer-fixed-row");a(c).find(".tableenhancer-fixed-column").removeClass("tableenhancer-fixed-column");I(c)})});var Q=function(){var b=navigator.userAgent;
var a=b.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];if(/trident/i.test(a[1]))return/\brv[ :]+(\d+)/g.exec(b),"IE";if("Chrome"===a[1]){var c=b.match(/\bOPR\/(\d+)/);if(null!==c)return"Opera"}a=a[2]?[a[1],a[2]]:[navigator.appName,navigator.appVersion,"-?"];null!==(c=b.match(/version\/(\d+)/i))&&a.splice(1,1,c[1]);return a[0]}();if("Firefox"===Q){var T=-1;var C=1;var w=-1;var F=1}else F=w=C=T=0;a(l).scroll(x);a(".fixed-headers-container",d).scroll(E);a(l).on("load resize",
G);a(l).on("refreshClones.tableenhancer",G);"editor"!==f&&(a(".fixed-headers-container",d).on("mousedown","div.clone",J),a(".fixed-headers-container \x3e table",d).on("sortEnd click",".sortableHeader",G))};AJS.$(window).on("activateFixedHeaders.tableenhancer",function(m,f){try{J(m,f)}catch(x){AJS.logError("table enhancer: error activating fixed headers",x)}});AJS.$(window).trigger("activateFixedHeaders.tableenhancer",["display"])});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.tngtech.confluence.plugins.tableenhancer:fixedheaders-editor-resources', location = '/js/fixedheaders-in-editor.js' */
(function(){var q=function(){function f(){try{a("#wysiwygTextarea_ifr").contents().find("body").off("keyup paste",g),a("#wysiwygTextarea_ifr").contents().find("body").off("paste",function(){setTimeout(k,100)}),a("#wysiwygTextarea_ifr").contents().find("body").off("keyup paste",l),a("#rte-toolbar").off("click",g),a("#wysiwygTextarea_ifr").contents().find(".fixed-headers-container").off("click",".clone",r),m(),q(),a(window).trigger("activateFixedHeaders.tableenhancer",["editor"]),h.trigger("refreshClones.tableenhancer"),
l(),a("#wysiwygTextarea_ifr").contents().find("body").on("keyup paste",l),a("#wysiwygTextarea_ifr").contents().find("body").on("keyup paste",g),a("#wysiwygTextarea_ifr").contents().find("body").on("paste",function(){setTimeout(k,100)}),a("#rte-toolbar").on("click",g),a("#wysiwygTextarea_ifr").contents().find(".fixed-headers-container").on("click","div.clone",r)}catch(b){AJS.logError("table enhancer: error in setup",b)}}function n(){setTimeout(f,500)}function l(){window.clearTimeout(t);t=window.setTimeout(k,
5E3)}function r(b){var d=a(b.target).closest("td, th"),c=a(b.target).closest("tr"),u=a(b.target).closest(".clone");b=a(b.target).closest(".fixed-headers-container");var e=0,f=0,g="TBODY";0<d.length?(e=d.index(),f=c.index(),g=c.parent("tbody, thead").prop("tagName")):0<c.length&&(f=c.index(),g=c.parent("tbody, thead").prop("tagName"));AJS.Rte.getEditor().selection.getRng();d=a(b).find(g+"\x3e tr:eq("+f+")\x3e :eq("+e+")");AJS.Rte.getEditor().selection.select(d.contents()[d.contents().length-1]);AJS.Rte.getEditor().selection.collapse(!1);
u.hasClass("vert_clone")?a("#wysiwygTextarea_ifr")[0].contentWindow.scrollTo(h.scrollLeft(),b.offset().top-10):u.hasClass("hori_clone")?a("#wysiwygTextarea_ifr")[0].contentWindow.scrollTo(b.offset().left-10,h.scrollTop()):a("#wysiwygTextarea_ifr")[0].contentWindow.scrollTo(b.offset().left-10,b.offset().top-10)}function g(){var b=AJS.Rte.getEditor().selection.getRng();a("#wysiwygTextarea_ifr").contents().find(".fixed-headers-container").children("p:not(.auto-cursor-target)").remove();(0<a(b.startContainer).closest(".fixed-headers-container").length||
0<a(b.endContainer).closest(".fixed-headers-container").length)&&h.trigger("refreshClones.tableenhancer")}function m(){var b=a("#wysiwygTextarea_ifr").contents();a(".clone",b).remove();a(".tableenhancer-fixed-row",b).removeClass("tableenhancer-fixed-row");a(".tableenhancer-fixed-column",b).removeClass("tableenhancer-fixed-column");a(".fixed-headers-bottom-anchor",b).remove();a(".fixed-headers-container",b).each(function(d,c){a(c,b).children("p:first-child, p:last-child").children("br:only-child").parent().remove();
0<a(c,b).prev().length?a(c,b).contents().insertAfter(a(c,b).prev()):a(c,b).contents().appendTo(a(c,b).parent());a(c,b).remove()})}function k(){var b=a("#wysiwygTextarea_ifr").contents();a("table[data-macro-name\x3dtableenhancer]",b).each(function(d,c){0<a(c,b).find("table:not(.clone):not(.confluenceTable .confluencTable):not(.fixed-headers-container table)").length&&f()})}function q(){a("#wysiwygTextarea_ifr").contents().find("table[data-macro-name\x3dtableenhancer]").each(function(b,d){var c=a(d).data("macro-parameters");
var f=b=0;var e=!1;void 0!==c&&(e=c.split(/[\|=]/g),b=0<=e.indexOf("numberOfFixedRows")?e[e.indexOf("numberOfFixedRows")+1]:0,f=0<=e.indexOf("numberOfFixedColumns")?e[e.indexOf("numberOfFixedColumns")+1]:0,e=0<=e.indexOf("rowNumbers"));w(d,b,e?f-1:f)})}function w(b,d,c){a(b).find("tbody \x3e tr \x3e td.wysiwyg-macro-body table.confluenceTable:not(.confluenceTable .confluenceTable)").each(function(b,e){a(e).wrap('\x3cdiv class\x3d"fixed-headers-container" data-fixed-rows\x3d'+d+" data-fixed-columns\x3d"+
c+"\x3e\x3c/div\x3e")})}function p(a,d){if("function"===typeof a)return function(){var b=a.apply(this,arguments);d();return b};AJS.log("tableenhancer warning: appendToFunction expected a function, but got",a)}var t=0,a=AJS.$,h=a("#wysiwygTextarea_ifr"),v=function(){try{a("#wysiwygTextarea_ifr").contents().find("body").off("keyup paste"),m()}catch(b){AJS.logError("table enhancer: error in save handler",b)}};Confluence.Editor.addSaveHandler(v);AJS.bind("rte-quick-edit-ready",function(){Confluence.Editor.addSaveHandler(v)});
a("#rte-button-preview").mousedown(function(b){if(1===b.which)try{m(),a("#rte-button-preview").click()}catch(d){AJS.logError("table enhancer: error in preview handler",d)}});a("#rte-button-edit").click(f);AJS.Rte.getEditor().setContent=p(AJS.Rte.getEditor().setContent,function(){n()});tinymce.confluence.MacroUtils.insertMacro=p(tinymce.confluence.MacroUtils.insertMacro,n);AJS.Rte.getEditor().plugins.table.insertTable=p(AJS.Rte.getEditor().plugins.table.insertTable,n)};AJS.bind("init.rte",function(){try{q()}catch(f){AJS.logError("table enhancer: error in initialization",
f)}})})();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-mentions-plugin:smart-mentions-editor-resources', location = 'templates/mentions.soy' */
// This file was automatically generated from mentions.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Mentions.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Mentions == 'undefined') { Confluence.Templates.Mentions = {}; }


Confluence.Templates.Mentions.userNotFoundResult = function(opt_data, opt_ignored) {
  return '<div class="mention-error no-result">' + soy.$$escapeHtml('Sorry, we can\x27t find that person') + '</div>';
};
if (goog.DEBUG) {
  Confluence.Templates.Mentions.userNotFoundResult.soyTemplateName = 'Confluence.Templates.Mentions.userNotFoundResult';
}


Confluence.Templates.Mentions.searchFailureResult = function(opt_data, opt_ignored) {
  return '<div class="mention-error search-failure"><div class="search-failure-title">' + soy.$$escapeHtml('Something went wrong') + '</div><div class="search-failure-body">' + soy.$$escapeHtml('We can\x27t fetch people right now. Try again in a few minutes.') + '</div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.Mentions.searchFailureResult.soyTemplateName = 'Confluence.Templates.Mentions.searchFailureResult';
}


Confluence.Templates.Mentions.loadingPlaceholder = function(opt_data, opt_ignored) {
  return '<div class="mention-loading"><div class="avatar-placeholder"></div><div class="text-container"><div class="text-placeholder lg"></div><div class="text-placeholder sm"></div></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.Mentions.loadingPlaceholder.soyTemplateName = 'Confluence.Templates.Mentions.loadingPlaceholder';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-mentions-plugin:smart-mentions-editor-resources', location = '/js-target/bundle.js' */
define("confluence-mentions", ["ajs","confluence/meta","jquery","confluence/legacy","confluence/templates","confluence-editor/tinymce3/plugins/autocomplete/autocomplete-manager","tinymce","confluence/storage-manager","confluence/dark-features","confluence/analytics-support","confluence-link-browser/link-object","confluence-editor/tinymce3/plugins/autocomplete/autocomplete-settings"], function(__WEBPACK_EXTERNAL_MODULE_0__, __WEBPACK_EXTERNAL_MODULE_2__, __WEBPACK_EXTERNAL_MODULE_3__, __WEBPACK_EXTERNAL_MODULE_11__, __WEBPACK_EXTERNAL_MODULE_16__, __WEBPACK_EXTERNAL_MODULE_18__, __WEBPACK_EXTERNAL_MODULE_19__, __WEBPACK_EXTERNAL_MODULE_37__, __WEBPACK_EXTERNAL_MODULE_45__, __WEBPACK_EXTERNAL_MODULE_51__, __WEBPACK_EXTERNAL_MODULE_52__, __WEBPACK_EXTERNAL_MODULE_53__) { return /******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, {
/******/ 				configurable: false,
/******/ 				enumerable: true,
/******/ 				get: getter
/******/ 			});
/******/ 		}
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = 20);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_0__;

/***/ }),
/* 1 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports) {
    'use strict';

    exports.default = {
        CURRENT: 'current',
        RELATED: 'related',
        RECENT: 'recent',
        SERVER: 'server'
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 2 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_2__;

/***/ }),
/* 3 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_3__;

/***/ }),
/* 4 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(0), __webpack_require__(29), __webpack_require__(37), __webpack_require__(1)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _ajs, _lruCache, _storageManager, _userSupplierKeys) {
    'use strict';

    var AJS = _interopRequireDefault(_ajs).default;

    var LRU = _interopRequireDefault(_lruCache).default;

    var StorageManager = _interopRequireDefault(_storageManager).default;

    var UserSupplier = _interopRequireDefault(_userSupplierKeys).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    /**
     * Returns users from a localstorage-backed LRU (least-recently-used) cache, and adds entries to that cache.
     */
    var inMemoryCache = void 0;
    var persistentCache = void 0;

    var CACHE_PREFIX = 'mentions';
    var CACHE_ID = 'recently-mentioned-users';
    var CACHE_ITEMS_KEY = 'items';

    /**
     * The maximum number of recently-mentioned users to keep in the cache.
     * @type {number}
     */
    var RECENT_USER_LIMIT = 20;
    /**
     * WaterTightValidation means that any users at or past this expiry _must_ be refreshed before being displayed in the UI.
     * @type {{expireTimeMillis: number}}
     */
    var WATERTIGHT_VALIDATION = { expireTimeMillis: 29 * 24 * 60 * 60 * 1000 }; //29 days in millis
    /**
     * EarlyValidation means that any users at or past this expiry _should_ be refreshed after the UI is completed (so as to not block users)
     * @type {{expireTimeMillis: number}}
     */
    var EARLY_VALIDATION = { expireTimeMillis: 7 * 24 * 60 * 60 * 1000 }; //7 days in millis
    /**
     * stores the enums used for calls to {getStaleUsers()}.
     * @type {{WATERTIGHT_VALIDATION: {expireTimeMillis: number}, EARLY_VALIDATION: {expireTimeMillis: number}}}
     */
    var ValidationType = { WATERTIGHT_VALIDATION: WATERTIGHT_VALIDATION, EARLY_VALIDATION: EARLY_VALIDATION };

    // Lazy-initialise to avoid interacting with localStorage when it isn't required.
    function loadCache() {
        inMemoryCache = LRU(RECENT_USER_LIMIT);
        persistentCache = new StorageManager(CACHE_PREFIX, CACHE_ID);

        var recentUsersDump = persistentCache.getItem(CACHE_ITEMS_KEY);
        if (recentUsersDump) {
            var recentUsersJson = JSON.parse(recentUsersDump);
            inMemoryCache.load(recentUsersJson);
        }
    }

    function getUsers() {
        return new Promise(function (resolve) {
            inMemoryCache || loadCache();

            // Add users with order of most-recently-mentioned first
            var users = [];
            var index = 0;
            inMemoryCache.forEach(function (user) {
                user.supplier = UserSupplier.RECENT;
                user.role = null;
                user.sortIndex = index++;
                users.push(user);
            });
            AJS.debug('Found ' + users.length + ' recently-mentioned users');
            resolve(users);
        });
    }

    /**
     * Store a recently-mentioned User in the cache.
     * @param user
     * @param refreshed {Boolean} true if the user is from the server. This will update the timestamp of the last refresh to now().
     *                            Defaults to false if not passed in.
     */
    function store(user, refreshed) {
        inMemoryCache || loadCache();
        var oldUser = inMemoryCache.peek(user.username);
        var oldRefreshDate = oldUser ? oldUser.refreshedAt || 0 : 0;
        var refreshedAt = refreshed || !oldUser ? new Date().getTime() : oldRefreshDate;
        inMemoryCache.set(user.username, Object.assign({}, user.model ? user.model : user, { timestamp: user.timestamp, refreshedAt: refreshedAt }));
        persistentCache.setItemQuietly(CACHE_ITEMS_KEY, JSON.stringify(inMemoryCache.dump()));
    }

    function remove(username) {
        inMemoryCache || loadCache();
        inMemoryCache.del(username);
        persistentCache.setItemQuietly(CACHE_ITEMS_KEY, JSON.stringify(inMemoryCache.dump()));
    }

    /**
     * A stale user is one which has not been refreshed from the server for X days or more, X being calculated from the validation type.
     * @param validationType {{expireTimeMillis: number}} an enum to flag what kind of stale users to return. Use a value from ValidationType
     * @return {Array} a list of stale usersnames (NOTE: not the user objects - just the usernames)
     */
    function getStaleUsers(validationType) {
        inMemoryCache || loadCache();
        var stale = [];
        var now = new Date().getTime();
        //use a hack to iterate the keys to prevent the LRU from changing the ordering
        var existingKeys = inMemoryCache.keys();
        existingKeys.map(function (k) {
            return [inMemoryCache.peek(k), k];
        }).forEach(function (entry) {
            var val = entry[0];
            var key = entry[1];
            if (!val.refreshedAt || now - val.refreshedAt > validationType.expireTimeMillis) {
                stale.push(key);
            }
        });
        return stale;
    }

    function refresh(users) {
        inMemoryCache || loadCache();
        users.forEach(function (user) {
            if (inMemoryCache.has(user.username)) {
                var entry = inMemoryCache.peek(user.username);
                var timestamp = entry.timestamp || 0;
                //treat no timestamp as though it is stale, and refresh it
                if (!user.timestamp || !timestamp || user.timestamp > timestamp) {
                    store(user, true);
                }
            }
        });
    }

    // Used in tests
    function _clear() {
        loadCache();
    }

    exports.default = {
        getUsers: getUsers,
        store: store,
        remove: remove,
        getStaleUsers: getStaleUsers,
        refresh: refresh,
        _clear: _clear,
        RECENT_USER_LIMIT: RECENT_USER_LIMIT,
        ValidationType: ValidationType
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 5 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(6), __webpack_require__(4), __webpack_require__(10), __webpack_require__(41), __webpack_require__(13)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _relatedUsersSupplier, _recentUsersSupplier, _serverUsersSupplier, _currentUserSupplier, _userCache) {
    'use strict';

    var RelatedUsersSupplier = _interopRequireDefault(_relatedUsersSupplier).default;

    var RecentUsersSupplier = _interopRequireDefault(_recentUsersSupplier).default;

    var ServerUsersSupplier = _interopRequireDefault(_serverUsersSupplier).default;

    var CurrentUserSupplier = _interopRequireDefault(_currentUserSupplier).default;

    var UserCache = _interopRequireDefault(_userCache).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    var _slicedToArray = function () {
        function sliceIterator(arr, i) {
            var _arr = [];
            var _n = true;
            var _d = false;
            var _e = undefined;

            try {
                for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {
                    _arr.push(_s.value);

                    if (i && _arr.length === i) break;
                }
            } catch (err) {
                _d = true;
                _e = err;
            } finally {
                try {
                    if (!_n && _i["return"]) _i["return"]();
                } finally {
                    if (_d) throw _e;
                }
            }

            return _arr;
        }

        return function (arr, i) {
            if (Array.isArray(arr)) {
                return arr;
            } else if (Symbol.iterator in Object(arr)) {
                return sliceIterator(arr, i);
            } else {
                throw new TypeError("Invalid attempt to destructure non-iterable instance");
            }
        };
    }();

    "use strict";

    /**
     *
     * @param {string}   query              User's query
     * @param {object}   editor             the currently-active editor
     */
    function search(query, editor) {

        var serverUsersPromise = ServerUsersSupplier.getUsers(query);
        var relatedUsersPromise = RelatedUsersSupplier.getUsers(editor);
        var recentUsersPromise = RecentUsersSupplier.getUsers();
        var currentUserPromise = CurrentUserSupplier.getCurrentUser();

        var fastPromises = [relatedUsersPromise, recentUsersPromise, currentUserPromise];

        return {
            client: Promise.all(fastPromises).then(function (_ref) {
                var _ref2 = _slicedToArray(_ref, 3),
                    relatedUsers = _ref2[0],
                    recentUsers = _ref2[1],
                    currentUser = _ref2[2];

                UserCache.addAll(relatedUsers);
                UserCache.addAll(recentUsers, true);
                if (currentUser) {
                    // May be undefined if anonymous.
                    UserCache.add(currentUser, true);
                }
            }),
            server: serverUsersPromise.then(function (serverUsers) {
                UserCache.addAll(serverUsers);
                RecentUsersSupplier.refresh(serverUsers);
            })
        };
    }

    function prefetchSuppliers(editor) {
        var waterTightValidationCheck = RecentUsersSupplier.getStaleUsers(RecentUsersSupplier.ValidationType.WATERTIGHT_VALIDATION);
        if (waterTightValidationCheck.length > 0) {
            //found some users whose stale for longer than 30 days. Must revalidate and delete if needed, before showing in UI.
            deleteStaleUsers(waterTightValidationCheck, RecentUsersSupplier.ValidationType.WATERTIGHT_VALIDATION);
        }
        // This will load related users into the cache in 'service/content-users/users-related-to-content'.
        RelatedUsersSupplier.getUsers(editor);
    }

    function deleteStaleUsers(usersToCheck, validationType) {
        ServerUsersSupplier._searchWithUsernames(usersToCheck).then(function (resultUsers) {
            RecentUsersSupplier.refresh(resultUsers);
            //if users are still stale after a refresh, it means they've not been returned by the server
            //time to delete 'em
            var usersToDelete = RecentUsersSupplier.getStaleUsers(validationType);
            usersToDelete.forEach(function (u) {
                return RecentUsersSupplier.remove(u);
            });
        });
    }

    // Reset any of the suppliers that hold state. Used in testing.
    function reset() {
        RelatedUsersSupplier.reset();
        ServerUsersSupplier.reset();
        RecentUsersSupplier._clear();
    }

    exports.default = {
        search: search,
        prefetchSuppliers: prefetchSuppliers,
        deleteStaleUsers: deleteStaleUsers,
        reset: reset
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 6 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(24), __webpack_require__(25)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _draftContentSupplier, _usersRelatedToContent) {
    'use strict';

    var getDraft = _interopRequireDefault(_draftContentSupplier).default;

    var UsersRelatedToContent = _interopRequireDefault(_usersRelatedToContent).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    /**
     Returns users related to the Content currently in the Editor, optionally filtered by a search string.
    
     You can test this logic in your browser console against a running instance by running something like :
    
     `require('confluence-mentions').userSuppliers.contentRelated.getUsers().then((result) => { window.relatedUsers = result; });`
    
     and then viewing the `window.relatedUsers` value.
     */
    function getUsers(editor) {
        var content = getDraft(editor);
        return UsersRelatedToContent.getUsers(content);
    }

    /*
     We assume that all useful information is returned in the getUsersRelatedTo call.
     */
    function isExhausted() {
        return true;
    }

    // Clears the related user cache, used in testing.
    function reset() {
        UsersRelatedToContent.reset();
    }

    exports.default = {
        getUsers: getUsers,
        isExhausted: isExhausted,
        reset: reset
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 7 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(8)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _i18n) {
    'use strict';

    var I18n = _interopRequireDefault(_i18n).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    var newRole = function newRole(role) {
        return {
            role: role,
            i18n: I18n('user.role.' + role)
        };
    }; /**
        A simple User Role bean that can provide its i18n'd display name.
        */
    exports.default = {
        CREATOR: newRole('creator'),
        CONTRIBUTOR: newRole('contributor'),
        COMMENTER: newRole('commenter'),
        ANCESTOR_COMMENTER: newRole('ancestorCommenter') // never shown, but available
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 8 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(0)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _ajs) {
    'use strict';

    var AJS = _interopRequireDefault(_ajs).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    var i18nMap = {
        'user.role.creator': "Creator",
        'user.role.contributor': "Contributor",
        'user.role.commenter': "Commenter",
        'user.supplier.recent': "Recent"
    }; /**
        A way to get the i18nTransformer away from all-the-JS, this module allows clients to get I18n text using
        dynamic keys. Normally the i18nTransformer would fail to handle this and the developer would be forced to add
       
        AJS.format("foo100")
       
        entries for each case. By extracting those invocations of AJS.I18n.getText to a single place, we can plan for a future
        where the transformer is not necessary and we can serve one set of JS resources for all locales.
       
        A future improvement might be to generate an i18n.js file directly from a plugin's
        i18n.properties file at build time.
        */

    exports.default = function (key) {
        // TODO - could interpolate args, etc. dT
        return i18nMap[key];
    };

    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 9 */
/***/ (function(module, exports) {

// shim for using process in browser
var process = module.exports = {};

// cached from whatever global is present so that test runners that stub it
// don't break things.  But we need to wrap it in a try catch in case it is
// wrapped in strict mode code which doesn't define any globals.  It's inside a
// function because try/catches deoptimize in certain engines.

var cachedSetTimeout;
var cachedClearTimeout;

function defaultSetTimout() {
    throw new Error('setTimeout has not been defined');
}
function defaultClearTimeout () {
    throw new Error('clearTimeout has not been defined');
}
(function () {
    try {
        if (typeof setTimeout === 'function') {
            cachedSetTimeout = setTimeout;
        } else {
            cachedSetTimeout = defaultSetTimout;
        }
    } catch (e) {
        cachedSetTimeout = defaultSetTimout;
    }
    try {
        if (typeof clearTimeout === 'function') {
            cachedClearTimeout = clearTimeout;
        } else {
            cachedClearTimeout = defaultClearTimeout;
        }
    } catch (e) {
        cachedClearTimeout = defaultClearTimeout;
    }
} ())
function runTimeout(fun) {
    if (cachedSetTimeout === setTimeout) {
        //normal enviroments in sane situations
        return setTimeout(fun, 0);
    }
    // if setTimeout wasn't available but was latter defined
    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {
        cachedSetTimeout = setTimeout;
        return setTimeout(fun, 0);
    }
    try {
        // when when somebody has screwed with setTimeout but no I.E. maddness
        return cachedSetTimeout(fun, 0);
    } catch(e){
        try {
            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally
            return cachedSetTimeout.call(null, fun, 0);
        } catch(e){
            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error
            return cachedSetTimeout.call(this, fun, 0);
        }
    }


}
function runClearTimeout(marker) {
    if (cachedClearTimeout === clearTimeout) {
        //normal enviroments in sane situations
        return clearTimeout(marker);
    }
    // if clearTimeout wasn't available but was latter defined
    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {
        cachedClearTimeout = clearTimeout;
        return clearTimeout(marker);
    }
    try {
        // when when somebody has screwed with setTimeout but no I.E. maddness
        return cachedClearTimeout(marker);
    } catch (e){
        try {
            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally
            return cachedClearTimeout.call(null, marker);
        } catch (e){
            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.
            // Some versions of I.E. have different rules for clearTimeout vs setTimeout
            return cachedClearTimeout.call(this, marker);
        }
    }



}
var queue = [];
var draining = false;
var currentQueue;
var queueIndex = -1;

function cleanUpNextTick() {
    if (!draining || !currentQueue) {
        return;
    }
    draining = false;
    if (currentQueue.length) {
        queue = currentQueue.concat(queue);
    } else {
        queueIndex = -1;
    }
    if (queue.length) {
        drainQueue();
    }
}

function drainQueue() {
    if (draining) {
        return;
    }
    var timeout = runTimeout(cleanUpNextTick);
    draining = true;

    var len = queue.length;
    while(len) {
        currentQueue = queue;
        queue = [];
        while (++queueIndex < len) {
            if (currentQueue) {
                currentQueue[queueIndex].run();
            }
        }
        queueIndex = -1;
        len = queue.length;
    }
    currentQueue = null;
    draining = false;
    runClearTimeout(timeout);
}

process.nextTick = function (fun) {
    var args = new Array(arguments.length - 1);
    if (arguments.length > 1) {
        for (var i = 1; i < arguments.length; i++) {
            args[i - 1] = arguments[i];
        }
    }
    queue.push(new Item(fun, args));
    if (queue.length === 1 && !draining) {
        runTimeout(drainQueue);
    }
};

// v8 likes predictible objects
function Item(fun, array) {
    this.fun = fun;
    this.array = array;
}
Item.prototype.run = function () {
    this.fun.apply(null, this.array);
};
process.title = 'browser';
process.browser = true;
process.env = {};
process.argv = [];
process.version = ''; // empty string to avoid regexp issues
process.versions = {};

function noop() {}

process.on = noop;
process.addListener = noop;
process.once = noop;
process.off = noop;
process.removeListener = noop;
process.removeAllListeners = noop;
process.emit = noop;
process.prependListener = noop;
process.prependOnceListener = noop;

process.listeners = function (name) { return [] }

process.binding = function (name) {
    throw new Error('process.binding is not supported');
};

process.cwd = function () { return '/' };
process.chdir = function (dir) {
    throw new Error('process.chdir is not supported');
};
process.umask = function() { return 0; };


/***/ }),
/* 10 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(0), __webpack_require__(11), __webpack_require__(2), __webpack_require__(3), __webpack_require__(12), __webpack_require__(39), __webpack_require__(1), __webpack_require__(40)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _ajs, _legacy, _meta, _jquery, _userRanker, _serverUserCache, _userSupplierKeys, _luceneQuery) {
    'use strict';

    var AJS = _interopRequireDefault(_ajs).default;

    var Confluence = _interopRequireDefault(_legacy).default;

    var Meta = _interopRequireDefault(_meta).default;

    var $ = _interopRequireDefault(_jquery).default;

    var UserRanker = _interopRequireDefault(_userRanker).default;

    var Cache = _interopRequireDefault(_serverUserCache).default;

    var UserSupplier = _interopRequireDefault(_userSupplierKeys).default;

    var LuceneQuery = _interopRequireDefault(_luceneQuery).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    /**
     * Wait this long after REST call triggers before actually doing a search - results in fewer HTTP requests.
     */
    var DEBOUNCE_WAIT_MS = 250;

    // 1 char query is now supported by CQL.
    var MIN_CHARS_TO_SEARCH = 1;

    var limit = 100;
    var cache = Cache(limit);

    /**
     * The id of the last timeout to be created for a REST call. We cancel this timeout if
     * a scheduled call becomes stale.
     */
    var lastTimeout = void 0;

    /**
     Returns users from the backend via a CQL search.
     */
    function getUsers(query) {
        return new Promise(function (resolve, reject) {

            if (!query || query.length < MIN_CHARS_TO_SEARCH) {
                // No query - no server results.
                return resolve([]);
            }

            AJS.debug('server-users-supplier: Looking in cache for ' + query);
            var cacheEntry = cache.getClosest(query);
            if (cacheEntry) {
                AJS.debug('server-users-supplier: Found cache entry with query ' + cacheEntry.query);
                if (cacheEntry.query === query) {
                    // Exact match - just serve these results.
                    return resolve(cacheEntry.users);
                }

                // Not an exact match. Might need a REST call, but we can show results based on what we have cached.
                var rankedUsers = UserRanker(cacheEntry.users, query);
                cache.add(query, rankedUsers);

                // TODO Always resolve with what we have from the cache - this is information that can be put in front of
                // the user immediately. We then decide whether to follow up the local results with remote ones.
                // However, we need the ability to 'resolve' multiple times - to call the render once with the cached
                // results and again (if not debounced, stale, etc, etc) with the server results.
                if (cacheEntry.isExhausted) {
                    return resolve(rankedUsers);
                }

                // Else we might be searching for "John" but "Joh" already has >={limit} users.
                // We need to hit the server!
                // TODO - can we resolve multiple times?
            }

            var contextPath = Meta.get('context-path');
            var escapedQuery = LuceneQuery.escape(query);
            var queryParameters = {
                cql: 'user ~ "' + Confluence.unescapeEntities(escapedQuery) + '"',
                start: 0,
                limit: limit
            };
            var url = contextPath + '/rest/api/search';
            var success = function success(response) {
                var results = response.results;
                var users = results.map(function (result) {
                    var user = result.user;
                    user.supplier = UserSupplier.SERVER;
                    user.timestamp = result.timestamp;
                    AJS.debug('server-users-supplier: Adding user to cache: ' + user.username);
                    return user;
                });
                cache.add(query, users);
                resolve(users);
            };

            // Debounce
            clearTimeout(lastTimeout);
            lastTimeout = setTimeout(function () {
                $.getJSON(url, queryParameters, success).fail(reject);
            }, DEBOUNCE_WAIT_MS);
        });
    }

    /**
     * Forces a search for exact usernames. Use this to ensure the cached entries in
     * other suppliers are not stale.
     * @param usernames {Array} Array of username strings
     * @returns {Promise} a promise which will resolve with an array of user objects from the search that matched any of the input usernames.
     * @private
     */
    function _searchWithUsernames(usernames) {
        return new Promise(function (resolve, reject) {
            if (!usernames || usernames.length === 0) {
                return resolve([]);
            }
            var contextPath = Meta.get('context-path');
            var queryParameters = {
                cql: 'user in (' + usernames.map(function (u) {
                    return '"' + u + '"';
                }).join(",") + ')',
                start: 0,
                limit: usernames.length
            };
            AJS.debug('querying with \'' + queryParameters.cql + '\'');
            var url = contextPath + '/rest/api/search';
            var success = function success(response) {
                var results = response.results;
                var users = results.map(function (result) {
                    var user = result.user;
                    user.supplier = UserSupplier.SERVER;
                    user.timestamp = result.timestamp;
                    return user;
                });
                resolve(users);
            };

            // Debounce
            clearTimeout(lastTimeout);
            lastTimeout = setTimeout(function () {
                $.getJSON(url, queryParameters, success).fail(reject);
            }, DEBOUNCE_WAIT_MS);
        });
    }

    /**
     If a given search returns less that the specified limit, we say that that query is exhausted - adding more
     characters to the query will return a subset of users from the shorter query.
     */
    function isExhausted(query) {
        return true;
    }

    // Flushes the cache between tests.
    function reset() {
        cache.reset();
        AJS.debug('server-users-supplier: Cache reset');
    }

    exports.default = {
        getUsers: getUsers,
        _searchWithUsernames: _searchWithUsernames,
        isExhausted: isExhausted,
        reset: reset,
        DEBOUNCE_WAIT_MS: DEBOUNCE_WAIT_MS
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 11 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_11__;

/***/ }),
/* 12 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(11), __webpack_require__(38)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _legacy, _fuse) {
    'use strict';

    var Confluence = _interopRequireDefault(_legacy).default;

    var Fuse = _interopRequireDefault(_fuse).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    /**
     * Details for these options are available at http://fusejs.io/, but the basic gist is:
     *
     * - tokenize is required so that first and last names are searched from their first character
     * - matchAllTokens so that tokenize will match all words in the query
     * - threshold close to 0 to avoid unhelpful results, but this can be tweaked because...
     * - shouldSort will put the best matches at the top of the result array.
     * - location means that matching should start at the beginning of words, which is usually
     *     what name searches will want
     */
    /**
     * Ranks users, given a query.
     */
    var options = {
        includeMatches: true,
        includeScore: true,
        tokenize: true,
        matchAllTokens: true,
        threshold: 0.1,
        location: 0,
        distance: 0,
        maxPatternLength: 16,
        minMatchCharLength: 1,
        keys: [{
            name: 'displayName',
            weight: 0.7
        }, {
            name: 'username',
            weight: 0.3
        }]
    };

    exports.default = function (users, query) {
        if (!query) {
            return users;
        }

        // TODO Depending on what kind of setup is done in the Fuse constructor, we might want to
        // optimise by keeping an instance around that has all of the users currently-known to the
        // frontend: including cached Server search results.
        var fuse = new Fuse(users, options);
        var results = fuse.search(Confluence.unescapeEntities(query));
        return results.map(function (result) {
            var item = result.item;
            item.fuseMatches = result.matches;
            item.fuseScore = result.score;
            return item;
        });
    };

    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 13 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports) {
    /**
     * Where all the aggregation and caching happens
     */
    "use strict";

    function _toConsumableArray(arr) {
        if (Array.isArray(arr)) {
            for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) {
                arr2[i] = arr[i];
            }

            return arr2;
        } else {
            return Array.from(arr);
        }
    }

    var userCache = new Map();

    /**
     * Updates the incoming User object to split "displayName" into "firstName" and "lastNames" to aid Fuse matching.
     * @param user
     * @private
     */
    function _splitNames(user) {
        if (!user || !user.displayName) {
            return;
        }

        // We store first and last names separately to enable search weightings in Fuse.
        // JS String.split doesn't quite do what we need so we just use a substring.
        var firstSpace = user.displayName.indexOf(' ');
        if (firstSpace > 0) {
            user.firstName = user.displayName.substring(0, firstSpace);
            user.lastNames = user.displayName.substring(firstSpace + 1);
        } else {
            // A user display name in a language without spaces. Setting the firstName should work in most cases.
            user.firstName = user.displayName;
            user.lastNames = '';
        }
    }

    function _isStaleEntry(user) {
        if (!userCache.has(user.username)) {
            return true;
        }
        var entry = userCache.get(user.username);
        var timestamp = entry.timestamp || 0;
        return user.timestamp > timestamp;
    }

    exports.default = {
        /**
         * Will add the user to the user cache, if it's not already present.
         * @param {user}    user     A single user in API format
         * @param {boolean} force    if true, any cached user with the same username will be replaced with this user
         */
        add: function add(user) {
            var force = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;

            // Existing cache entries may have a different Supplier for a given user - don't overwrite.
            if (user && user.hasOwnProperty("username") && (force === true || _isStaleEntry(user))) {
                _splitNames(user);
                userCache.set(user.username, user);
            }
        },

        /**
         * Will add all the supplied users by individually calling add
         * @param users an array of users
         */
        addAll: function addAll(users, force) {
            var _this = this;

            users.forEach(function (user) {
                _this.add(user, force);
            });
        },

        /**
         * @returns an array of all the users in the cache
         */
        getAll: function getAll() {
            return [].concat(_toConsumableArray(userCache.values()));
        },

        /**
         * Used for testing
         * @private
         */
        _get: function _get(username) {
            return userCache.get(username);
        },

        /**
         * Used for testing
         * @private
         */
        _clear: function _clear() {
            userCache.clear();
        }
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 14 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(0), __webpack_require__(5), __webpack_require__(13), __webpack_require__(42), __webpack_require__(49), __webpack_require__(17)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _ajs, _userSupplierManager, _userCache, _pipelines, _executor, _scoreBooster) {
    'use strict';

    var AJS = _interopRequireDefault(_ajs).default;

    var userSupplierManager = _interopRequireDefault(_userSupplierManager).default;

    var UserCache = _interopRequireDefault(_userCache).default;

    var Pipelines = _interopRequireDefault(_pipelines).default;

    var PipelineExecutor = _interopRequireDefault(_executor).default;

    var ScoreBooster = _interopRequireDefault(_scoreBooster).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    "use strict";

    /**
     * The maximum number of Users that will be displayed in the Mentions dropdown.
     */
    var DISPLAY_LIMIT = 5;
    var NON_BREAKING_SPACE = String.fromCharCode(160);

    // The last query to be triggered, used when server responses return out of order and we need to skip the render of
    // stale responses.
    var latestQuery = void 0;

    /**
     *
     * @param {string}   query              User's query
     * @param {function} renderCallback     Callback function to render the results
     * @param {function} selectedUser       (optional) the currently-selected user in the dropdown
     * @param {object} editor               the currently-active editor
     */
    function searchAndRender(query, renderCallback, selectedUser, editor) {
        // Trim the query but don't convert to lowercase just yet - the ranker should handle this. (i.e. upper case
        // letters could be weighted higher in matches).
        // Note that 160 is the non-breaking-space character and is not handled by trim().
        // It IS handled by $.trim(str) but noooooo, noooooo.
        query = query.replace(NON_BREAKING_SPACE, ' ').trim();
        latestQuery = query;

        var promises = userSupplierManager.search(query, editor);

        promises.client.then(function () {
            resolveClientUsers();
            // Guarantee that server results are handled after local ones - chain the promises!
            promises.server.then(resolveServerUsers, renderErrorOnReject);
        }, renderErrorOnReject);

        function resolveClientUsers() {
            renderPipeline(UserCache.getAll(), query, renderCallback, selectedUser, false);
        }

        function resolveServerUsers() {
            // We could in future wrap the renderCallback so that if the server render would have the same values as the
            // client render, we skip it and avoid a browser repaint.
            renderPipeline(UserCache.getAll(), query, renderCallback, selectedUser, true);
        }

        function renderErrorOnReject() {
            var iterator = new PipelineExecutor(Pipelines.error(renderCallback));
            iterator.execute([]);
        }
    }

    function renderPipeline(users, query, renderCallback, selectedUser, isServerCall) {
        var context = {
            query: query,
            latestQuery: latestQuery,
            selectedUser: selectedUser,
            isServerCall: isServerCall,
            DISPLAY_LIMIT: DISPLAY_LIMIT
        };

        var pipeline = void 0;
        if (!query) {
            pipeline = Pipelines.default(renderCallback);
        } else {
            pipeline = isServerCall ? Pipelines.server(renderCallback) : Pipelines.client(renderCallback);
        }

        var executor = new PipelineExecutor(pipeline, context);
        executor.execute(users);
    }

    // Called during testing to clear caches.
    function reset() {
        userSupplierManager.reset();
        UserCache._clear();
        ScoreBooster.reset();
    }

    exports.default = {
        searchAndRender: searchAndRender,
        prefetchSuppliers: userSupplierManager.prefetchSuppliers,
        reset: reset
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 15 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports) {
    "use strict";

    exports.default = {
        resultWithHtml: function resultWithHtml(html) {
            return {
                html: html
            };
        }
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 16 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_16__;

/***/ }),
/* 17 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(1)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _userSupplierKeys) {
    'use strict';

    var UserSupplier = _interopRequireDefault(_userSupplierKeys).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    var suggestedUsers = [];

    /**
     * When searching for a user you're likely to want a user you've recently mentioned, even if other Fuse matches have
     * slightly better (lower) scores. For now we boost all recent matches, but we could adjust this to only the recent match
     * with the best score.
     *
     * Also, contributors should bubble to the top in the search results, at least until the search token is compelling enough
     * to switch.
     */
    function boostScores(users, next, context) {
        var query = context && context.query || '';
        if (query.indexOf(' ') > 0) {
            // Don't boost on supplier once multiple names are being added - the user seems to know who they're after so
            // let Fuse do its job.
            return next(users);
        }

        // The pipeline could be ensuring that users passed down the pipe are immutable, but for now just clone. fuseScore
        // should NOT be making its way into the user cache.
        var boostedUsers = users.map(function (userIn) {
            var user = Object.assign({}, userIn);
            if (suggestedUsers.includes(user.username)) {
                user.fuseScore /= 1000; // keep ordering for multiple matched suggestions
            } else if (typeof user.fuseScore === 'number') {
                switch (user.supplier) {
                    case UserSupplier.RECENT:
                        user.fuseScore /= 5;
                        break;
                    case UserSupplier.RELATED:
                        user.fuseScore /= 10;
                        break;
                }
            }
            return user;
        });
        return next(boostedUsers);
    }

    function setSuggestedUsers(users, next) {
        suggestedUsers = users.map(function (user) {
            return user.username;
        });
        return next(users);
    }

    function reset() {
        suggestedUsers = [];
    }

    exports.default = {
        boostScores: boostScores,
        setSuggestedUsers: setSuggestedUsers,
        reset: reset
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 18 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_18__;

/***/ }),
/* 19 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_19__;

/***/ }),
/* 20 */
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__(21);


/***/ }),
/* 21 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(22), __webpack_require__(6), __webpack_require__(4), __webpack_require__(10), __webpack_require__(19)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _editorPluginInit, _relatedUsersSupplier, _recentUsersSupplier, _serverUsersSupplier, _tinymce) {
    'use strict';

    var editorPluginInit = _interopRequireDefault(_editorPluginInit).default;

    var RelatedUsersSupplier = _interopRequireDefault(_relatedUsersSupplier).default;

    var RecentUsersSupplier = _interopRequireDefault(_recentUsersSupplier).default;

    var ServerUsersSupplier = _interopRequireDefault(_serverUsersSupplier).default;

    var tinymce = _interopRequireDefault(_tinymce).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    function init(e, context) {
        var editor = context && context.editor; // in case the initCallback internal code breaks API

        tinymce.create('tinymce.plugins.InsertMentions', {
            init: editorPluginInit(editor),

            getInfo: function getInfo() {
                return {
                    longname: 'Insert Mentions',
                    author: 'Atlassian',
                    authorurl: 'http://www.atlassian.com',
                    version: tinymce.majorVersion + "." + tinymce.minorVersion
                };
            }
        });

        tinymce.PluginManager.add('insertmentions', tinymce.plugins.InsertMentions);
    }

    /**
     * This is the main export from the Mentions module set.
     */
    exports.default = {
        init: init,
        userSuppliers: {
            // Users from localstorage
            recent: RecentUsersSupplier,
            // Users from the server
            serverSearch: ServerUsersSupplier,
            // Users from the front-end cache of the Content in the editor
            contentRelated: RelatedUsersSupplier
        }
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 22 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(0), __webpack_require__(3), __webpack_require__(23), __webpack_require__(14), __webpack_require__(18), __webpack_require__(53)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _ajs, _jquery, _autocompleteAdapter, _Mentions, _autocompleteManager, _autocompleteSettings) {
    'use strict';

    var AJS = _interopRequireDefault(_ajs).default;

    var $ = _interopRequireDefault(_jquery).default;

    var Adapter = _interopRequireDefault(_autocompleteAdapter).default;

    var Mentions = _interopRequireDefault(_Mentions).default;

    var AutocompleteManager = _interopRequireDefault(_autocompleteManager).default;

    var AutocompleteSettings = _interopRequireDefault(_autocompleteSettings).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    "use strict";

    function activateMentions() {
        AJS.EventQueue.push({ name: 'confluencementioninsert' });
        AutocompleteManager.shortcutFired("@");
    }

    function onClickEvent(event) {
        event.stopPropagation();
        event.preventDefault();
        AJS.Rte.getEditor().focus();
        activateMentions();
    }

    function editorPluginInit(editor) {
        AJS.EventQueue = AJS.EventQueue || [];
        Mentions.prefetchSuppliers(editor);

        AutocompleteSettings.Settings["@"] = {
            ch: "@",
            cache: true,
            endChars: [],
            dropDownClassName: "autocomplete-mentions fabric",
            autocompleteClassNames: "fabric",
            dropDownDelay: 0, // No delay needed because there is no AJAX request involved
            selectFirstItem: true,
            minLengthForGetData: 1,
            displayHandler: function displayHandler(user) {
                // Use Jquery to encode the user name
                return $('<div/>').text(user.name).html();
            },

            getHeaderText: function getHeaderText() {
                return null; // HACK this could be an option in core, the header is currently being hidden with CSS.
            },

            getAdditionalLinks: function getAdditionalLinks(autoCompleteControl, value, callback) {
                var additionalLinks = [];
                if (callback) callback(value, additionalLinks);
                return additionalLinks;
            },

            /**
             *
             * @param autoCompleteControl
             * @param value     The user's input
             * @param {function} renderResults  function to run with the resulting users (from input-driven-dropdown in
             *                                  Core)
             */
            getDataAndRunCallback: function getDataAndRunCallback(autoCompleteControl, value, renderResults) {
                Adapter.search(autoCompleteControl, value, renderResults, editor);
            },

            /**
             * Overrides the confluence/highlighter used to highlight query term matches in results
             */
            // For now, this override is ignored: we're getting better results from the default highlighter than with the
            // highlighting based on Fuse.js output.
            // Highlighter,

            update: Adapter.insert
        };

        $('#insertmention-button').on('click', onClickEvent);

        if (AJS.Rte.Placeholder && AJS.Rte.Placeholder.addPlaceholderType) {
            AJS.Rte.Placeholder.addPlaceholderType({
                type: 'mention',
                label: "User mention",
                tooltip: "Instructional text is replaced with suggested people when a person types."
            });
        }
    }

    exports.default = editorPluginInit;
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 23 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(0), __webpack_require__(14), __webpack_require__(4), __webpack_require__(5), __webpack_require__(50), __webpack_require__(2), __webpack_require__(52), __webpack_require__(19)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _ajs, _Mentions, _recentUsersSupplier, _userSupplierManager, _mentionAnalytics, _meta, _linkObject, _tinymce) {
    'use strict';

    var AJS = _interopRequireDefault(_ajs).default;

    var Mentions = _interopRequireDefault(_Mentions).default;

    var RecentUsers = _interopRequireDefault(_recentUsersSupplier).default;

    var UserSupplierManager = _interopRequireDefault(_userSupplierManager).default;

    var MentionsAnalytics = _interopRequireDefault(_mentionAnalytics).default;

    var Meta = _interopRequireDefault(_meta).default;

    var Link = _interopRequireDefault(_linkObject).default;

    var tinymce = _interopRequireDefault(_tinymce).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    "use strict";

    var BASE_URL = Meta.get('base-url');

    function search(autoCompleteControl, value, renderResults, editor) {
        MentionsAnalytics.updateSession(autoCompleteControl);

        // The && guard here can be removed once the core tinymce3/plugins/autocomplete/autocomplete-manager.js code is released.
        // Hacky try catch to work around CONFSRVDEV-3101 and CONFSRVDEV-3138
        var selectedUser = void 0;
        try {
            var selectedItem = autoCompleteControl.getCurrentItem && autoCompleteControl.getCurrentItem();
            selectedUser = selectedItem && selectedItem.model;
        } catch (ignored) {
            console.log('Error retrieving currently-selected autoComplete item');
            console.log(ignored);
        }

        // renderResults likes a 2D array, and the query tokens in an array for highlighting
        var tokens = value && value.split(' ') || [];
        var render = function render(results, next, context) {
            return renderResults([results], value, null, tokens, context);
        };
        Mentions.searchAndRender(value, render, selectedUser, editor);
    }

    function insert(autoCompleteControl, user) {
        MentionsAnalytics.publishEventForSelection(user, autoCompleteControl.analytics);

        // Add this user to the cache - it will be retrieved with the recent-users-supplier module.
        RecentUsers.store(user);

        var earlyValidationCheck = RecentUsers.getStaleUsers(RecentUsers.ValidationType.EARLY_VALIDATION);
        if (earlyValidationCheck.length > 0) {
            //asynchronously attempt to update the recently mentioned cache to remove any stale users, after the UI insert is completed
            setTimeout(function () {
                return UserSupplierManager.deleteStaleUsers(earlyValidationCheck, RecentUsers.ValidationType.EARLY_VALIDATION);
            }, 0);
        }

        var link = {
            attrs: {
                href: user.link,
                'userkey': user.model.userKey, // required to unmarshall ResourceIdentifier
                'data-base-url': BASE_URL,
                'data-linked-resource-type': 'userinfo',
                'data-linked-resource-default-alias': user.name
            },
            body: {
                html: AJS.escapeHtml(user.name)
            },
            classes: ['confluence-link']
        };
        Link.fromData(link).insert();
        tinymce.activeEditor.selection.setContent(" ");
    }

    // Called during testing
    function reset() {
        Mentions.reset();
    }

    exports.default = {
        search: search,
        insert: insert,
        reset: reset
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 24 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(2), __webpack_require__(3)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _meta, _jquery) {
    'use strict';

    var Meta = _interopRequireDefault(_meta).default;

    var $ = _interopRequireDefault(_jquery).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    // Adapted from confluence-quick-edit/src/main/resources/jscripts/handlers/comment.js.
    /**
     Supplies the Content API model object associated with the current draft in the editor.
    
     This is basically a shim for something that the Editor JS API *should* provide but currently doesn't
     */
    function getParameter(url, paramName) {
        if (!url) {
            return '';
        }
        var regex = new RegExp("[?&]" + paramName + "=(\\d+)");
        var match = url.match(regex);
        return match && match.length > 1 ? match[1] : '';
    }

    function safeGetDraft(editor) {
        if (!editor) {
            return null;
        }

        try {
            return getDraft(editor);
        } catch (e) {
            // This might happen if the Editor is being initialised in a context we don't yet support.
            console.error(e.message);
            return null;
        }
    }

    function getDraft(editor) {
        var id = Meta.get('page-id');

        var form = editor.formElement;
        var action = form.action || '';

        if (action.indexOf('/doaddcomment.action') > -1 || action.indexOf('/doeditcomment.action') > -1 || $(form).closest('.ic-sidebar').length) {
            var commentId = getParameter(action, "commentId") || '0';

            var content = {
                id: commentId,
                type: 'comment',
                status: 'draft',
                container: {
                    id: id
                }
            };

            var parentCommentId = getParameter(action, "parentId");
            if (parentCommentId) {
                content.ancestors = [{
                    id: parentCommentId
                }];
            }

            return content;
        }

        var previewContainer = $(form).closest('.cp-container');
        if (previewContainer.length) {
            // This is a comment for a Preview. Until we have a proper API, scrape the DOM and shed a single tear.
            var previewTitle = previewContainer.find('.cp-file-title').text().replace(/"/g, "\\\"");
            // CONFSRVDEV-11704 because the previewer can be triggered from like million places, and because we suck
            // and don't set the alias for attachment titles consistently , which means we need to look for them with spaces
            // a well as with + for space
            var alternateTitle = escape(previewTitle.replace(/\s/g, "+"));
            var $element = $('body').find('*[data-linked-resource-default-alias="' + previewTitle + '"], *[data-linked-resource-default-alias="' + alternateTitle + '"]');
            if ($element.length) {
                var attachmentId = $element.attr('data-linked-resource-id');
                // Again, until Previews exposes an API, and the Editor consumes it in a way that THIS code can consume,
                // we're limited in how Smart the suggestions here can be. For now, editing an existing comment or replying
                // to a comment are treated the same as creating a new comment.
                return {
                    id: 0,
                    type: 'comment',
                    status: 'draft',
                    container: {
                        id: attachmentId
                    }
                };
            }
        }

        var newPage = Meta.get('new-page');

        var type = Meta.get('content-type');
        return {
            id: newPage ? '0' : id,
            type: type,
            status: 'draft'
        };
    }

    exports.default = safeGetDraft;
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 25 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(2), __webpack_require__(3), __webpack_require__(26), __webpack_require__(27), __webpack_require__(28)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _meta, _jquery, _aggregateUsers, _restParameters, _relatedUserTransformer) {
    'use strict';

    var Meta = _interopRequireDefault(_meta).default;

    var $ = _interopRequireDefault(_jquery).default;

    var aggregateUsers = _interopRequireDefault(_aggregateUsers).default;

    var getRestParameters = _interopRequireDefault(_restParameters).default;

    var flattenUsers = _interopRequireDefault(_relatedUserTransformer).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    "use strict"; /**
                   Supplies Users that are related to a piece of Content, calculated from server data via the Content API.
                   */


    var cache = {};

    var getUsers = function getUsers(contentStub) {
        var restParams = getRestParameters(contentStub);
        if (!restParams) {
            // Will be null for new pages and blogposts: don't make a REST call, don't cache
            return Promise.resolve([]);
        }

        if (restParams.contentId in cache) {
            return cache[restParams.contentId];
        }

        var promise = new Promise(function (resolve, reject) {
            var contextPath = Meta.get('context-path');
            var url = contextPath + '/rest/api/content/' + restParams.contentId;
            var queryParameters = {
                expand: restParams.expand
            };

            $.getJSON(url, queryParameters, function (content) {
                resolve(flattenUsers(aggregateUsers(content)));
            }).fail(reject);
        });

        cache[restParams.contentId] = promise;
        return promise;
    };

    // Used in testing.
    function reset() {
        cache = {};
    }

    exports.default = {
        getUsers: getUsers,
        reset: reset,
        _cache: cache //exposed for testing
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 26 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(7), __webpack_require__(1)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _userRole, _userSupplierKeys) {
    'use strict';

    var UserRole = _interopRequireDefault(_userRole).default;

    var UserSupplier = _interopRequireDefault(_userSupplierKeys).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    exports.default = function (content) {
        var relatedUsers = {};

        // Used to track users that have already been added to relatedUsers
        var usernames = new Set();

        // Skip anonymous users, disabled/deleted users, and users already in the result
        function shouldAddUser(user) {
            if (user.type === 'anonymous') {
                return false;
            }

            if (typeof user.status === 'undefined') {
                console.error("User status is undefined. Not adding to relatedUsers aggregate.");
                return false;
            }
            return user.status === 'current' && !usernames.has(user.username);
        }

        function addUser(user, role) {
            user.role = role;
            user.supplier = UserSupplier.RELATED;
            var roleKey = role.role;
            relatedUsers[roleKey] = relatedUsers[roleKey] || [];
            relatedUsers[roleKey].push(user);
            usernames.add(user.username);
        }

        function addUserWithRole(user, role) {
            if (shouldAddUser(user)) {
                addUser(user, role);
            }
        }

        var page = content.type === 'comment' ? content.container : content;

        // Only do this for content that has history
        if ('history' in page) {
            addUserWithRole(page.history.createdBy, UserRole.CREATOR);

            // Contributors are reversed to descending chronological order - users are more likely to mention contributors who
            // edited the content more recently.
            page.history.contributors.publishers.users.reverse().forEach(function (contributor) {
                addUserWithRole(contributor, UserRole.CONTRIBUTOR);
            });
        }

        if (content.type === 'comment' && content.ancestors) {
            // A new or existing comment that is a reply to another comment. We catch ancestor commenters before other
            // commenters because they are more likely to be mentioned.
            // Ancestor order is not reversed because they are already ordered youngest to oldest.
            content.ancestors.forEach(function (ancestorComment) {
                addUserWithRole(ancestorComment.version.by, UserRole.ANCESTOR_COMMENTER);
            });
        }

        if ('children' in page) {
            // Page commenters are also listed in reverse order
            page.children.comment.results.reverse().forEach(function (comment) {
                addUserWithRole(comment.version.by, UserRole.COMMENTER);
            });
        }

        return relatedUsers;
    };

    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 27 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports) {
    'use strict';

    /**
     Calculations the content id and expansions that should be used in the REST API call when building the
     list of users related to a piece of Content in the editor.
     */

    var PAGE_REST_EXPANSIONS = 'history.createdBy.status,history.contributors.publishers.users.status,children.comment.version.by.status';
    var COMMENT_REST_EXPANSIONS = 'ancestors.version.by.status,container.history.createdBy.status,container.history.contributors.publishers.users.status,container.children.comment.version.by.status';

    function restParams(id, expansions) {
        return {
            contentId: id,
            expand: expansions
        };
    }

    function isBlankId(val) {
        return !val || val === '0';
    }

    exports.default = function (contentStub) {
        if (!contentStub) {
            return null;
        }

        if (contentStub.type === 'page' || contentStub.type === 'blogpost') {
            var pageId = contentStub.id;
            if (isBlankId(pageId)) {
                // A new page/blogpost has no related users.
                return null;
            }
            // Editing an existing page or blogpost
            return restParams(pageId, PAGE_REST_EXPANSIONS);
        }

        if (contentStub.type === 'comment') {
            var commentId = contentStub.id;
            if (!isBlankId(commentId)) {
                // Editing an existing comment
                return restParams(commentId, COMMENT_REST_EXPANSIONS);
            }

            // A new comment: the stub will include the id of the comment it is replying to, unless this is a top-level
            // comment. NOTE: if we end up with access to a Draft comment, we should be able to use its id as the
            // content id, and not use the parent-comment or page ids here.
            var parentCommentId = contentStub.ancestors && contentStub.ancestors[0] && contentStub.ancestors[0].id;
            if (!isBlankId(parentCommentId)) {
                // A new reply
                return restParams(parentCommentId, COMMENT_REST_EXPANSIONS);
            }

            // A new top-level comment
            var _pageId = contentStub.container.id;
            return restParams(_pageId, PAGE_REST_EXPANSIONS);
        }
    };

    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 28 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(7)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _userRole) {
    "use strict";

    var UserRole = _interopRequireDefault(_userRole).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    "use strict";

    /**
     * Converts the map of users by role into a list of users.
     */

    exports.default = function (usersMap) {
        var transformedList = [];

        function addUsersWithRoleToList(userRole) {
            var users = usersMap[userRole.role];
            if (users && users.length) {
                transformedList = transformedList.concat(users);
            }
        }

        addUsersWithRoleToList(UserRole.CREATOR);
        addUsersWithRoleToList(UserRole.CONTRIBUTOR);
        addUsersWithRoleToList(UserRole.COMMENTER);
        addUsersWithRoleToList(UserRole.ANCESTOR_COMMENTER);

        return transformedList;
    };

    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 29 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


module.exports = LRUCache

// This will be a proper iterable 'Map' in engines that support it,
// or a fakey-fake PseudoMap in older versions.
var Map = __webpack_require__(30)
var util = __webpack_require__(32)

// A linked list to keep track of recently-used-ness
var Yallist = __webpack_require__(36)

// use symbols if possible, otherwise just _props
var hasSymbol = typeof Symbol === 'function'
var makeSymbol
if (hasSymbol) {
  makeSymbol = function (key) {
    return Symbol.for(key)
  }
} else {
  makeSymbol = function (key) {
    return '_' + key
  }
}

var MAX = makeSymbol('max')
var LENGTH = makeSymbol('length')
var LENGTH_CALCULATOR = makeSymbol('lengthCalculator')
var ALLOW_STALE = makeSymbol('allowStale')
var MAX_AGE = makeSymbol('maxAge')
var DISPOSE = makeSymbol('dispose')
var NO_DISPOSE_ON_SET = makeSymbol('noDisposeOnSet')
var LRU_LIST = makeSymbol('lruList')
var CACHE = makeSymbol('cache')

function naiveLength () { return 1 }

// lruList is a yallist where the head is the youngest
// item, and the tail is the oldest.  the list contains the Hit
// objects as the entries.
// Each Hit object has a reference to its Yallist.Node.  This
// never changes.
//
// cache is a Map (or PseudoMap) that matches the keys to
// the Yallist.Node object.
function LRUCache (options) {
  if (!(this instanceof LRUCache)) {
    return new LRUCache(options)
  }

  if (typeof options === 'number') {
    options = { max: options }
  }

  if (!options) {
    options = {}
  }

  var max = this[MAX] = options.max
  // Kind of weird to have a default max of Infinity, but oh well.
  if (!max ||
      !(typeof max === 'number') ||
      max <= 0) {
    this[MAX] = Infinity
  }

  var lc = options.length || naiveLength
  if (typeof lc !== 'function') {
    lc = naiveLength
  }
  this[LENGTH_CALCULATOR] = lc

  this[ALLOW_STALE] = options.stale || false
  this[MAX_AGE] = options.maxAge || 0
  this[DISPOSE] = options.dispose
  this[NO_DISPOSE_ON_SET] = options.noDisposeOnSet || false
  this.reset()
}

// resize the cache when the max changes.
Object.defineProperty(LRUCache.prototype, 'max', {
  set: function (mL) {
    if (!mL || !(typeof mL === 'number') || mL <= 0) {
      mL = Infinity
    }
    this[MAX] = mL
    trim(this)
  },
  get: function () {
    return this[MAX]
  },
  enumerable: true
})

Object.defineProperty(LRUCache.prototype, 'allowStale', {
  set: function (allowStale) {
    this[ALLOW_STALE] = !!allowStale
  },
  get: function () {
    return this[ALLOW_STALE]
  },
  enumerable: true
})

Object.defineProperty(LRUCache.prototype, 'maxAge', {
  set: function (mA) {
    if (!mA || !(typeof mA === 'number') || mA < 0) {
      mA = 0
    }
    this[MAX_AGE] = mA
    trim(this)
  },
  get: function () {
    return this[MAX_AGE]
  },
  enumerable: true
})

// resize the cache when the lengthCalculator changes.
Object.defineProperty(LRUCache.prototype, 'lengthCalculator', {
  set: function (lC) {
    if (typeof lC !== 'function') {
      lC = naiveLength
    }
    if (lC !== this[LENGTH_CALCULATOR]) {
      this[LENGTH_CALCULATOR] = lC
      this[LENGTH] = 0
      this[LRU_LIST].forEach(function (hit) {
        hit.length = this[LENGTH_CALCULATOR](hit.value, hit.key)
        this[LENGTH] += hit.length
      }, this)
    }
    trim(this)
  },
  get: function () { return this[LENGTH_CALCULATOR] },
  enumerable: true
})

Object.defineProperty(LRUCache.prototype, 'length', {
  get: function () { return this[LENGTH] },
  enumerable: true
})

Object.defineProperty(LRUCache.prototype, 'itemCount', {
  get: function () { return this[LRU_LIST].length },
  enumerable: true
})

LRUCache.prototype.rforEach = function (fn, thisp) {
  thisp = thisp || this
  for (var walker = this[LRU_LIST].tail; walker !== null;) {
    var prev = walker.prev
    forEachStep(this, fn, walker, thisp)
    walker = prev
  }
}

function forEachStep (self, fn, node, thisp) {
  var hit = node.value
  if (isStale(self, hit)) {
    del(self, node)
    if (!self[ALLOW_STALE]) {
      hit = undefined
    }
  }
  if (hit) {
    fn.call(thisp, hit.value, hit.key, self)
  }
}

LRUCache.prototype.forEach = function (fn, thisp) {
  thisp = thisp || this
  for (var walker = this[LRU_LIST].head; walker !== null;) {
    var next = walker.next
    forEachStep(this, fn, walker, thisp)
    walker = next
  }
}

LRUCache.prototype.keys = function () {
  return this[LRU_LIST].toArray().map(function (k) {
    return k.key
  }, this)
}

LRUCache.prototype.values = function () {
  return this[LRU_LIST].toArray().map(function (k) {
    return k.value
  }, this)
}

LRUCache.prototype.reset = function () {
  if (this[DISPOSE] &&
      this[LRU_LIST] &&
      this[LRU_LIST].length) {
    this[LRU_LIST].forEach(function (hit) {
      this[DISPOSE](hit.key, hit.value)
    }, this)
  }

  this[CACHE] = new Map() // hash of items by key
  this[LRU_LIST] = new Yallist() // list of items in order of use recency
  this[LENGTH] = 0 // length of items in the list
}

LRUCache.prototype.dump = function () {
  return this[LRU_LIST].map(function (hit) {
    if (!isStale(this, hit)) {
      return {
        k: hit.key,
        v: hit.value,
        e: hit.now + (hit.maxAge || 0)
      }
    }
  }, this).toArray().filter(function (h) {
    return h
  })
}

LRUCache.prototype.dumpLru = function () {
  return this[LRU_LIST]
}

LRUCache.prototype.inspect = function (n, opts) {
  var str = 'LRUCache {'
  var extras = false

  var as = this[ALLOW_STALE]
  if (as) {
    str += '\n  allowStale: true'
    extras = true
  }

  var max = this[MAX]
  if (max && max !== Infinity) {
    if (extras) {
      str += ','
    }
    str += '\n  max: ' + util.inspect(max, opts)
    extras = true
  }

  var maxAge = this[MAX_AGE]
  if (maxAge) {
    if (extras) {
      str += ','
    }
    str += '\n  maxAge: ' + util.inspect(maxAge, opts)
    extras = true
  }

  var lc = this[LENGTH_CALCULATOR]
  if (lc && lc !== naiveLength) {
    if (extras) {
      str += ','
    }
    str += '\n  length: ' + util.inspect(this[LENGTH], opts)
    extras = true
  }

  var didFirst = false
  this[LRU_LIST].forEach(function (item) {
    if (didFirst) {
      str += ',\n  '
    } else {
      if (extras) {
        str += ',\n'
      }
      didFirst = true
      str += '\n  '
    }
    var key = util.inspect(item.key).split('\n').join('\n  ')
    var val = { value: item.value }
    if (item.maxAge !== maxAge) {
      val.maxAge = item.maxAge
    }
    if (lc !== naiveLength) {
      val.length = item.length
    }
    if (isStale(this, item)) {
      val.stale = true
    }

    val = util.inspect(val, opts).split('\n').join('\n  ')
    str += key + ' => ' + val
  })

  if (didFirst || extras) {
    str += '\n'
  }
  str += '}'

  return str
}

LRUCache.prototype.set = function (key, value, maxAge) {
  maxAge = maxAge || this[MAX_AGE]

  var now = maxAge ? Date.now() : 0
  var len = this[LENGTH_CALCULATOR](value, key)

  if (this[CACHE].has(key)) {
    if (len > this[MAX]) {
      del(this, this[CACHE].get(key))
      return false
    }

    var node = this[CACHE].get(key)
    var item = node.value

    // dispose of the old one before overwriting
    // split out into 2 ifs for better coverage tracking
    if (this[DISPOSE]) {
      if (!this[NO_DISPOSE_ON_SET]) {
        this[DISPOSE](key, item.value)
      }
    }

    item.now = now
    item.maxAge = maxAge
    item.value = value
    this[LENGTH] += len - item.length
    item.length = len
    this.get(key)
    trim(this)
    return true
  }

  var hit = new Entry(key, value, len, now, maxAge)

  // oversized objects fall out of cache automatically.
  if (hit.length > this[MAX]) {
    if (this[DISPOSE]) {
      this[DISPOSE](key, value)
    }
    return false
  }

  this[LENGTH] += hit.length
  this[LRU_LIST].unshift(hit)
  this[CACHE].set(key, this[LRU_LIST].head)
  trim(this)
  return true
}

LRUCache.prototype.has = function (key) {
  if (!this[CACHE].has(key)) return false
  var hit = this[CACHE].get(key).value
  if (isStale(this, hit)) {
    return false
  }
  return true
}

LRUCache.prototype.get = function (key) {
  return get(this, key, true)
}

LRUCache.prototype.peek = function (key) {
  return get(this, key, false)
}

LRUCache.prototype.pop = function () {
  var node = this[LRU_LIST].tail
  if (!node) return null
  del(this, node)
  return node.value
}

LRUCache.prototype.del = function (key) {
  del(this, this[CACHE].get(key))
}

LRUCache.prototype.load = function (arr) {
  // reset the cache
  this.reset()

  var now = Date.now()
  // A previous serialized cache has the most recent items first
  for (var l = arr.length - 1; l >= 0; l--) {
    var hit = arr[l]
    var expiresAt = hit.e || 0
    if (expiresAt === 0) {
      // the item was created without expiration in a non aged cache
      this.set(hit.k, hit.v)
    } else {
      var maxAge = expiresAt - now
      // dont add already expired items
      if (maxAge > 0) {
        this.set(hit.k, hit.v, maxAge)
      }
    }
  }
}

LRUCache.prototype.prune = function () {
  var self = this
  this[CACHE].forEach(function (value, key) {
    get(self, key, false)
  })
}

function get (self, key, doUse) {
  var node = self[CACHE].get(key)
  if (node) {
    var hit = node.value
    if (isStale(self, hit)) {
      del(self, node)
      if (!self[ALLOW_STALE]) hit = undefined
    } else {
      if (doUse) {
        self[LRU_LIST].unshiftNode(node)
      }
    }
    if (hit) hit = hit.value
  }
  return hit
}

function isStale (self, hit) {
  if (!hit || (!hit.maxAge && !self[MAX_AGE])) {
    return false
  }
  var stale = false
  var diff = Date.now() - hit.now
  if (hit.maxAge) {
    stale = diff > hit.maxAge
  } else {
    stale = self[MAX_AGE] && (diff > self[MAX_AGE])
  }
  return stale
}

function trim (self) {
  if (self[LENGTH] > self[MAX]) {
    for (var walker = self[LRU_LIST].tail;
         self[LENGTH] > self[MAX] && walker !== null;) {
      // We know that we're about to delete this one, and also
      // what the next least recently used key will be, so just
      // go ahead and set it now.
      var prev = walker.prev
      del(self, walker)
      walker = prev
    }
  }
}

function del (self, node) {
  if (node) {
    var hit = node.value
    if (self[DISPOSE]) {
      self[DISPOSE](hit.key, hit.value)
    }
    self[LENGTH] -= hit.length
    self[CACHE].delete(hit.key)
    self[LRU_LIST].removeNode(node)
  }
}

// classy, since V8 prefers predictable objects.
function Entry (key, value, length, now, maxAge) {
  this.key = key
  this.value = value
  this.length = length
  this.now = now
  this.maxAge = maxAge || 0
}


/***/ }),
/* 30 */
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(process) {if (process.env.npm_package_name === 'pseudomap' &&
    process.env.npm_lifecycle_script === 'test')
  process.env.TEST_PSEUDOMAP = 'true'

if (typeof Map === 'function' && !process.env.TEST_PSEUDOMAP) {
  module.exports = Map
} else {
  module.exports = __webpack_require__(31)
}

/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(9)))

/***/ }),
/* 31 */
/***/ (function(module, exports) {

var hasOwnProperty = Object.prototype.hasOwnProperty

module.exports = PseudoMap

function PseudoMap (set) {
  if (!(this instanceof PseudoMap)) // whyyyyyyy
    throw new TypeError("Constructor PseudoMap requires 'new'")

  this.clear()

  if (set) {
    if ((set instanceof PseudoMap) ||
        (typeof Map === 'function' && set instanceof Map))
      set.forEach(function (value, key) {
        this.set(key, value)
      }, this)
    else if (Array.isArray(set))
      set.forEach(function (kv) {
        this.set(kv[0], kv[1])
      }, this)
    else
      throw new TypeError('invalid argument')
  }
}

PseudoMap.prototype.forEach = function (fn, thisp) {
  thisp = thisp || this
  Object.keys(this._data).forEach(function (k) {
    if (k !== 'size')
      fn.call(thisp, this._data[k].value, this._data[k].key)
  }, this)
}

PseudoMap.prototype.has = function (k) {
  return !!find(this._data, k)
}

PseudoMap.prototype.get = function (k) {
  var res = find(this._data, k)
  return res && res.value
}

PseudoMap.prototype.set = function (k, v) {
  set(this._data, k, v)
}

PseudoMap.prototype.delete = function (k) {
  var res = find(this._data, k)
  if (res) {
    delete this._data[res._index]
    this._data.size--
  }
}

PseudoMap.prototype.clear = function () {
  var data = Object.create(null)
  data.size = 0

  Object.defineProperty(this, '_data', {
    value: data,
    enumerable: false,
    configurable: true,
    writable: false
  })
}

Object.defineProperty(PseudoMap.prototype, 'size', {
  get: function () {
    return this._data.size
  },
  set: function (n) {},
  enumerable: true,
  configurable: true
})

PseudoMap.prototype.values =
PseudoMap.prototype.keys =
PseudoMap.prototype.entries = function () {
  throw new Error('iterators are not implemented in this version')
}

// Either identical, or both NaN
function same (a, b) {
  return a === b || a !== a && b !== b
}

function Entry (k, v, i) {
  this.key = k
  this.value = v
  this._index = i
}

function find (data, k) {
  for (var i = 0, s = '_' + k, key = s;
       hasOwnProperty.call(data, key);
       key = s + i++) {
    if (same(data[key].key, k))
      return data[key]
  }
}

function set (data, k, v) {
  for (var i = 0, s = '_' + k, key = s;
       hasOwnProperty.call(data, key);
       key = s + i++) {
    if (same(data[key].key, k)) {
      data[key].value = v
      return
    }
  }
  data.size++
  data[key] = new Entry(k, v, key)
}


/***/ }),
/* 32 */
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global, process) {// Copyright Joyent, Inc. and other Node contributors.
//
// Permission is hereby granted, free of charge, to any person obtaining a
// copy of this software and associated documentation files (the
// "Software"), to deal in the Software without restriction, including
// without limitation the rights to use, copy, modify, merge, publish,
// distribute, sublicense, and/or sell copies of the Software, and to permit
// persons to whom the Software is furnished to do so, subject to the
// following conditions:
//
// The above copyright notice and this permission notice shall be included
// in all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE
// USE OR OTHER DEALINGS IN THE SOFTWARE.

var formatRegExp = /%[sdj%]/g;
exports.format = function(f) {
  if (!isString(f)) {
    var objects = [];
    for (var i = 0; i < arguments.length; i++) {
      objects.push(inspect(arguments[i]));
    }
    return objects.join(' ');
  }

  var i = 1;
  var args = arguments;
  var len = args.length;
  var str = String(f).replace(formatRegExp, function(x) {
    if (x === '%%') return '%';
    if (i >= len) return x;
    switch (x) {
      case '%s': return String(args[i++]);
      case '%d': return Number(args[i++]);
      case '%j':
        try {
          return JSON.stringify(args[i++]);
        } catch (_) {
          return '[Circular]';
        }
      default:
        return x;
    }
  });
  for (var x = args[i]; i < len; x = args[++i]) {
    if (isNull(x) || !isObject(x)) {
      str += ' ' + x;
    } else {
      str += ' ' + inspect(x);
    }
  }
  return str;
};


// Mark that a method should not be used.
// Returns a modified function which warns once by default.
// If --no-deprecation is set, then it is a no-op.
exports.deprecate = function(fn, msg) {
  // Allow for deprecating things in the process of starting up.
  if (isUndefined(global.process)) {
    return function() {
      return exports.deprecate(fn, msg).apply(this, arguments);
    };
  }

  if (process.noDeprecation === true) {
    return fn;
  }

  var warned = false;
  function deprecated() {
    if (!warned) {
      if (process.throwDeprecation) {
        throw new Error(msg);
      } else if (process.traceDeprecation) {
        console.trace(msg);
      } else {
        console.error(msg);
      }
      warned = true;
    }
    return fn.apply(this, arguments);
  }

  return deprecated;
};


var debugs = {};
var debugEnviron;
exports.debuglog = function(set) {
  if (isUndefined(debugEnviron))
    debugEnviron = process.env.NODE_DEBUG || '';
  set = set.toUpperCase();
  if (!debugs[set]) {
    if (new RegExp('\\b' + set + '\\b', 'i').test(debugEnviron)) {
      var pid = process.pid;
      debugs[set] = function() {
        var msg = exports.format.apply(exports, arguments);
        console.error('%s %d: %s', set, pid, msg);
      };
    } else {
      debugs[set] = function() {};
    }
  }
  return debugs[set];
};


/**
 * Echos the value of a value. Trys to print the value out
 * in the best way possible given the different types.
 *
 * @param {Object} obj The object to print out.
 * @param {Object} opts Optional options object that alters the output.
 */
/* legacy: obj, showHidden, depth, colors*/
function inspect(obj, opts) {
  // default options
  var ctx = {
    seen: [],
    stylize: stylizeNoColor
  };
  // legacy...
  if (arguments.length >= 3) ctx.depth = arguments[2];
  if (arguments.length >= 4) ctx.colors = arguments[3];
  if (isBoolean(opts)) {
    // legacy...
    ctx.showHidden = opts;
  } else if (opts) {
    // got an "options" object
    exports._extend(ctx, opts);
  }
  // set default options
  if (isUndefined(ctx.showHidden)) ctx.showHidden = false;
  if (isUndefined(ctx.depth)) ctx.depth = 2;
  if (isUndefined(ctx.colors)) ctx.colors = false;
  if (isUndefined(ctx.customInspect)) ctx.customInspect = true;
  if (ctx.colors) ctx.stylize = stylizeWithColor;
  return formatValue(ctx, obj, ctx.depth);
}
exports.inspect = inspect;


// http://en.wikipedia.org/wiki/ANSI_escape_code#graphics
inspect.colors = {
  'bold' : [1, 22],
  'italic' : [3, 23],
  'underline' : [4, 24],
  'inverse' : [7, 27],
  'white' : [37, 39],
  'grey' : [90, 39],
  'black' : [30, 39],
  'blue' : [34, 39],
  'cyan' : [36, 39],
  'green' : [32, 39],
  'magenta' : [35, 39],
  'red' : [31, 39],
  'yellow' : [33, 39]
};

// Don't use 'blue' not visible on cmd.exe
inspect.styles = {
  'special': 'cyan',
  'number': 'yellow',
  'boolean': 'yellow',
  'undefined': 'grey',
  'null': 'bold',
  'string': 'green',
  'date': 'magenta',
  // "name": intentionally not styling
  'regexp': 'red'
};


function stylizeWithColor(str, styleType) {
  var style = inspect.styles[styleType];

  if (style) {
    return '\u001b[' + inspect.colors[style][0] + 'm' + str +
           '\u001b[' + inspect.colors[style][1] + 'm';
  } else {
    return str;
  }
}


function stylizeNoColor(str, styleType) {
  return str;
}


function arrayToHash(array) {
  var hash = {};

  array.forEach(function(val, idx) {
    hash[val] = true;
  });

  return hash;
}


function formatValue(ctx, value, recurseTimes) {
  // Provide a hook for user-specified inspect functions.
  // Check that value is an object with an inspect function on it
  if (ctx.customInspect &&
      value &&
      isFunction(value.inspect) &&
      // Filter out the util module, it's inspect function is special
      value.inspect !== exports.inspect &&
      // Also filter out any prototype objects using the circular check.
      !(value.constructor && value.constructor.prototype === value)) {
    var ret = value.inspect(recurseTimes, ctx);
    if (!isString(ret)) {
      ret = formatValue(ctx, ret, recurseTimes);
    }
    return ret;
  }

  // Primitive types cannot have properties
  var primitive = formatPrimitive(ctx, value);
  if (primitive) {
    return primitive;
  }

  // Look up the keys of the object.
  var keys = Object.keys(value);
  var visibleKeys = arrayToHash(keys);

  if (ctx.showHidden) {
    keys = Object.getOwnPropertyNames(value);
  }

  // IE doesn't make error fields non-enumerable
  // http://msdn.microsoft.com/en-us/library/ie/dww52sbt(v=vs.94).aspx
  if (isError(value)
      && (keys.indexOf('message') >= 0 || keys.indexOf('description') >= 0)) {
    return formatError(value);
  }

  // Some type of object without properties can be shortcutted.
  if (keys.length === 0) {
    if (isFunction(value)) {
      var name = value.name ? ': ' + value.name : '';
      return ctx.stylize('[Function' + name + ']', 'special');
    }
    if (isRegExp(value)) {
      return ctx.stylize(RegExp.prototype.toString.call(value), 'regexp');
    }
    if (isDate(value)) {
      return ctx.stylize(Date.prototype.toString.call(value), 'date');
    }
    if (isError(value)) {
      return formatError(value);
    }
  }

  var base = '', array = false, braces = ['{', '}'];

  // Make Array say that they are Array
  if (isArray(value)) {
    array = true;
    braces = ['[', ']'];
  }

  // Make functions say that they are functions
  if (isFunction(value)) {
    var n = value.name ? ': ' + value.name : '';
    base = ' [Function' + n + ']';
  }

  // Make RegExps say that they are RegExps
  if (isRegExp(value)) {
    base = ' ' + RegExp.prototype.toString.call(value);
  }

  // Make dates with properties first say the date
  if (isDate(value)) {
    base = ' ' + Date.prototype.toUTCString.call(value);
  }

  // Make error with message first say the error
  if (isError(value)) {
    base = ' ' + formatError(value);
  }

  if (keys.length === 0 && (!array || value.length == 0)) {
    return braces[0] + base + braces[1];
  }

  if (recurseTimes < 0) {
    if (isRegExp(value)) {
      return ctx.stylize(RegExp.prototype.toString.call(value), 'regexp');
    } else {
      return ctx.stylize('[Object]', 'special');
    }
  }

  ctx.seen.push(value);

  var output;
  if (array) {
    output = formatArray(ctx, value, recurseTimes, visibleKeys, keys);
  } else {
    output = keys.map(function(key) {
      return formatProperty(ctx, value, recurseTimes, visibleKeys, key, array);
    });
  }

  ctx.seen.pop();

  return reduceToSingleString(output, base, braces);
}


function formatPrimitive(ctx, value) {
  if (isUndefined(value))
    return ctx.stylize('undefined', 'undefined');
  if (isString(value)) {
    var simple = '\'' + JSON.stringify(value).replace(/^"|"$/g, '')
                                             .replace(/'/g, "\\'")
                                             .replace(/\\"/g, '"') + '\'';
    return ctx.stylize(simple, 'string');
  }
  if (isNumber(value))
    return ctx.stylize('' + value, 'number');
  if (isBoolean(value))
    return ctx.stylize('' + value, 'boolean');
  // For some reason typeof null is "object", so special case here.
  if (isNull(value))
    return ctx.stylize('null', 'null');
}


function formatError(value) {
  return '[' + Error.prototype.toString.call(value) + ']';
}


function formatArray(ctx, value, recurseTimes, visibleKeys, keys) {
  var output = [];
  for (var i = 0, l = value.length; i < l; ++i) {
    if (hasOwnProperty(value, String(i))) {
      output.push(formatProperty(ctx, value, recurseTimes, visibleKeys,
          String(i), true));
    } else {
      output.push('');
    }
  }
  keys.forEach(function(key) {
    if (!key.match(/^\d+$/)) {
      output.push(formatProperty(ctx, value, recurseTimes, visibleKeys,
          key, true));
    }
  });
  return output;
}


function formatProperty(ctx, value, recurseTimes, visibleKeys, key, array) {
  var name, str, desc;
  desc = Object.getOwnPropertyDescriptor(value, key) || { value: value[key] };
  if (desc.get) {
    if (desc.set) {
      str = ctx.stylize('[Getter/Setter]', 'special');
    } else {
      str = ctx.stylize('[Getter]', 'special');
    }
  } else {
    if (desc.set) {
      str = ctx.stylize('[Setter]', 'special');
    }
  }
  if (!hasOwnProperty(visibleKeys, key)) {
    name = '[' + key + ']';
  }
  if (!str) {
    if (ctx.seen.indexOf(desc.value) < 0) {
      if (isNull(recurseTimes)) {
        str = formatValue(ctx, desc.value, null);
      } else {
        str = formatValue(ctx, desc.value, recurseTimes - 1);
      }
      if (str.indexOf('\n') > -1) {
        if (array) {
          str = str.split('\n').map(function(line) {
            return '  ' + line;
          }).join('\n').substr(2);
        } else {
          str = '\n' + str.split('\n').map(function(line) {
            return '   ' + line;
          }).join('\n');
        }
      }
    } else {
      str = ctx.stylize('[Circular]', 'special');
    }
  }
  if (isUndefined(name)) {
    if (array && key.match(/^\d+$/)) {
      return str;
    }
    name = JSON.stringify('' + key);
    if (name.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)) {
      name = name.substr(1, name.length - 2);
      name = ctx.stylize(name, 'name');
    } else {
      name = name.replace(/'/g, "\\'")
                 .replace(/\\"/g, '"')
                 .replace(/(^"|"$)/g, "'");
      name = ctx.stylize(name, 'string');
    }
  }

  return name + ': ' + str;
}


function reduceToSingleString(output, base, braces) {
  var numLinesEst = 0;
  var length = output.reduce(function(prev, cur) {
    numLinesEst++;
    if (cur.indexOf('\n') >= 0) numLinesEst++;
    return prev + cur.replace(/\u001b\[\d\d?m/g, '').length + 1;
  }, 0);

  if (length > 60) {
    return braces[0] +
           (base === '' ? '' : base + '\n ') +
           ' ' +
           output.join(',\n  ') +
           ' ' +
           braces[1];
  }

  return braces[0] + base + ' ' + output.join(', ') + ' ' + braces[1];
}


// NOTE: These type checking functions intentionally don't use `instanceof`
// because it is fragile and can be easily faked with `Object.create()`.
function isArray(ar) {
  return Array.isArray(ar);
}
exports.isArray = isArray;

function isBoolean(arg) {
  return typeof arg === 'boolean';
}
exports.isBoolean = isBoolean;

function isNull(arg) {
  return arg === null;
}
exports.isNull = isNull;

function isNullOrUndefined(arg) {
  return arg == null;
}
exports.isNullOrUndefined = isNullOrUndefined;

function isNumber(arg) {
  return typeof arg === 'number';
}
exports.isNumber = isNumber;

function isString(arg) {
  return typeof arg === 'string';
}
exports.isString = isString;

function isSymbol(arg) {
  return typeof arg === 'symbol';
}
exports.isSymbol = isSymbol;

function isUndefined(arg) {
  return arg === void 0;
}
exports.isUndefined = isUndefined;

function isRegExp(re) {
  return isObject(re) && objectToString(re) === '[object RegExp]';
}
exports.isRegExp = isRegExp;

function isObject(arg) {
  return typeof arg === 'object' && arg !== null;
}
exports.isObject = isObject;

function isDate(d) {
  return isObject(d) && objectToString(d) === '[object Date]';
}
exports.isDate = isDate;

function isError(e) {
  return isObject(e) &&
      (objectToString(e) === '[object Error]' || e instanceof Error);
}
exports.isError = isError;

function isFunction(arg) {
  return typeof arg === 'function';
}
exports.isFunction = isFunction;

function isPrimitive(arg) {
  return arg === null ||
         typeof arg === 'boolean' ||
         typeof arg === 'number' ||
         typeof arg === 'string' ||
         typeof arg === 'symbol' ||  // ES6 symbol
         typeof arg === 'undefined';
}
exports.isPrimitive = isPrimitive;

exports.isBuffer = __webpack_require__(34);

function objectToString(o) {
  return Object.prototype.toString.call(o);
}


function pad(n) {
  return n < 10 ? '0' + n.toString(10) : n.toString(10);
}


var months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep',
              'Oct', 'Nov', 'Dec'];

// 26 Feb 16:19:34
function timestamp() {
  var d = new Date();
  var time = [pad(d.getHours()),
              pad(d.getMinutes()),
              pad(d.getSeconds())].join(':');
  return [d.getDate(), months[d.getMonth()], time].join(' ');
}


// log is just a thin wrapper to console.log that prepends a timestamp
exports.log = function() {
  console.log('%s - %s', timestamp(), exports.format.apply(exports, arguments));
};


/**
 * Inherit the prototype methods from one constructor into another.
 *
 * The Function.prototype.inherits from lang.js rewritten as a standalone
 * function (not on Function.prototype). NOTE: If this file is to be loaded
 * during bootstrapping this function needs to be rewritten using some native
 * functions as prototype setup using normal JavaScript does not work as
 * expected during bootstrapping (see mirror.js in r114903).
 *
 * @param {function} ctor Constructor function which needs to inherit the
 *     prototype.
 * @param {function} superCtor Constructor function to inherit prototype from.
 */
exports.inherits = __webpack_require__(35);

exports._extend = function(origin, add) {
  // Don't do anything if add isn't an object
  if (!add || !isObject(add)) return origin;

  var keys = Object.keys(add);
  var i = keys.length;
  while (i--) {
    origin[keys[i]] = add[keys[i]];
  }
  return origin;
};

function hasOwnProperty(obj, prop) {
  return Object.prototype.hasOwnProperty.call(obj, prop);
}

/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(33), __webpack_require__(9)))

/***/ }),
/* 33 */
/***/ (function(module, exports) {

var g;

// This works in non-strict mode
g = (function() {
	return this;
})();

try {
	// This works if eval is allowed (see CSP)
	g = g || Function("return this")() || (1,eval)("this");
} catch(e) {
	// This works if the window reference is available
	if(typeof window === "object")
		g = window;
}

// g can still be undefined, but nothing to do about it...
// We return undefined, instead of nothing here, so it's
// easier to handle this case. if(!global) { ...}

module.exports = g;


/***/ }),
/* 34 */
/***/ (function(module, exports) {

module.exports = function isBuffer(arg) {
  return arg && typeof arg === 'object'
    && typeof arg.copy === 'function'
    && typeof arg.fill === 'function'
    && typeof arg.readUInt8 === 'function';
}

/***/ }),
/* 35 */
/***/ (function(module, exports) {

if (typeof Object.create === 'function') {
  // implementation from standard node.js 'util' module
  module.exports = function inherits(ctor, superCtor) {
    ctor.super_ = superCtor
    ctor.prototype = Object.create(superCtor.prototype, {
      constructor: {
        value: ctor,
        enumerable: false,
        writable: true,
        configurable: true
      }
    });
  };
} else {
  // old school shim for old browsers
  module.exports = function inherits(ctor, superCtor) {
    ctor.super_ = superCtor
    var TempCtor = function () {}
    TempCtor.prototype = superCtor.prototype
    ctor.prototype = new TempCtor()
    ctor.prototype.constructor = ctor
  }
}


/***/ }),
/* 36 */
/***/ (function(module, exports) {

module.exports = Yallist

Yallist.Node = Node
Yallist.create = Yallist

function Yallist (list) {
  var self = this
  if (!(self instanceof Yallist)) {
    self = new Yallist()
  }

  self.tail = null
  self.head = null
  self.length = 0

  if (list && typeof list.forEach === 'function') {
    list.forEach(function (item) {
      self.push(item)
    })
  } else if (arguments.length > 0) {
    for (var i = 0, l = arguments.length; i < l; i++) {
      self.push(arguments[i])
    }
  }

  return self
}

Yallist.prototype.removeNode = function (node) {
  if (node.list !== this) {
    throw new Error('removing node which does not belong to this list')
  }

  var next = node.next
  var prev = node.prev

  if (next) {
    next.prev = prev
  }

  if (prev) {
    prev.next = next
  }

  if (node === this.head) {
    this.head = next
  }
  if (node === this.tail) {
    this.tail = prev
  }

  node.list.length--
  node.next = null
  node.prev = null
  node.list = null
}

Yallist.prototype.unshiftNode = function (node) {
  if (node === this.head) {
    return
  }

  if (node.list) {
    node.list.removeNode(node)
  }

  var head = this.head
  node.list = this
  node.next = head
  if (head) {
    head.prev = node
  }

  this.head = node
  if (!this.tail) {
    this.tail = node
  }
  this.length++
}

Yallist.prototype.pushNode = function (node) {
  if (node === this.tail) {
    return
  }

  if (node.list) {
    node.list.removeNode(node)
  }

  var tail = this.tail
  node.list = this
  node.prev = tail
  if (tail) {
    tail.next = node
  }

  this.tail = node
  if (!this.head) {
    this.head = node
  }
  this.length++
}

Yallist.prototype.push = function () {
  for (var i = 0, l = arguments.length; i < l; i++) {
    push(this, arguments[i])
  }
  return this.length
}

Yallist.prototype.unshift = function () {
  for (var i = 0, l = arguments.length; i < l; i++) {
    unshift(this, arguments[i])
  }
  return this.length
}

Yallist.prototype.pop = function () {
  if (!this.tail) {
    return undefined
  }

  var res = this.tail.value
  this.tail = this.tail.prev
  if (this.tail) {
    this.tail.next = null
  } else {
    this.head = null
  }
  this.length--
  return res
}

Yallist.prototype.shift = function () {
  if (!this.head) {
    return undefined
  }

  var res = this.head.value
  this.head = this.head.next
  if (this.head) {
    this.head.prev = null
  } else {
    this.tail = null
  }
  this.length--
  return res
}

Yallist.prototype.forEach = function (fn, thisp) {
  thisp = thisp || this
  for (var walker = this.head, i = 0; walker !== null; i++) {
    fn.call(thisp, walker.value, i, this)
    walker = walker.next
  }
}

Yallist.prototype.forEachReverse = function (fn, thisp) {
  thisp = thisp || this
  for (var walker = this.tail, i = this.length - 1; walker !== null; i--) {
    fn.call(thisp, walker.value, i, this)
    walker = walker.prev
  }
}

Yallist.prototype.get = function (n) {
  for (var i = 0, walker = this.head; walker !== null && i < n; i++) {
    // abort out of the list early if we hit a cycle
    walker = walker.next
  }
  if (i === n && walker !== null) {
    return walker.value
  }
}

Yallist.prototype.getReverse = function (n) {
  for (var i = 0, walker = this.tail; walker !== null && i < n; i++) {
    // abort out of the list early if we hit a cycle
    walker = walker.prev
  }
  if (i === n && walker !== null) {
    return walker.value
  }
}

Yallist.prototype.map = function (fn, thisp) {
  thisp = thisp || this
  var res = new Yallist()
  for (var walker = this.head; walker !== null;) {
    res.push(fn.call(thisp, walker.value, this))
    walker = walker.next
  }
  return res
}

Yallist.prototype.mapReverse = function (fn, thisp) {
  thisp = thisp || this
  var res = new Yallist()
  for (var walker = this.tail; walker !== null;) {
    res.push(fn.call(thisp, walker.value, this))
    walker = walker.prev
  }
  return res
}

Yallist.prototype.reduce = function (fn, initial) {
  var acc
  var walker = this.head
  if (arguments.length > 1) {
    acc = initial
  } else if (this.head) {
    walker = this.head.next
    acc = this.head.value
  } else {
    throw new TypeError('Reduce of empty list with no initial value')
  }

  for (var i = 0; walker !== null; i++) {
    acc = fn(acc, walker.value, i)
    walker = walker.next
  }

  return acc
}

Yallist.prototype.reduceReverse = function (fn, initial) {
  var acc
  var walker = this.tail
  if (arguments.length > 1) {
    acc = initial
  } else if (this.tail) {
    walker = this.tail.prev
    acc = this.tail.value
  } else {
    throw new TypeError('Reduce of empty list with no initial value')
  }

  for (var i = this.length - 1; walker !== null; i--) {
    acc = fn(acc, walker.value, i)
    walker = walker.prev
  }

  return acc
}

Yallist.prototype.toArray = function () {
  var arr = new Array(this.length)
  for (var i = 0, walker = this.head; walker !== null; i++) {
    arr[i] = walker.value
    walker = walker.next
  }
  return arr
}

Yallist.prototype.toArrayReverse = function () {
  var arr = new Array(this.length)
  for (var i = 0, walker = this.tail; walker !== null; i++) {
    arr[i] = walker.value
    walker = walker.prev
  }
  return arr
}

Yallist.prototype.slice = function (from, to) {
  to = to || this.length
  if (to < 0) {
    to += this.length
  }
  from = from || 0
  if (from < 0) {
    from += this.length
  }
  var ret = new Yallist()
  if (to < from || to < 0) {
    return ret
  }
  if (from < 0) {
    from = 0
  }
  if (to > this.length) {
    to = this.length
  }
  for (var i = 0, walker = this.head; walker !== null && i < from; i++) {
    walker = walker.next
  }
  for (; walker !== null && i < to; i++, walker = walker.next) {
    ret.push(walker.value)
  }
  return ret
}

Yallist.prototype.sliceReverse = function (from, to) {
  to = to || this.length
  if (to < 0) {
    to += this.length
  }
  from = from || 0
  if (from < 0) {
    from += this.length
  }
  var ret = new Yallist()
  if (to < from || to < 0) {
    return ret
  }
  if (from < 0) {
    from = 0
  }
  if (to > this.length) {
    to = this.length
  }
  for (var i = this.length, walker = this.tail; walker !== null && i > to; i--) {
    walker = walker.prev
  }
  for (; walker !== null && i > from; i--, walker = walker.prev) {
    ret.push(walker.value)
  }
  return ret
}

Yallist.prototype.reverse = function () {
  var head = this.head
  var tail = this.tail
  for (var walker = head; walker !== null; walker = walker.prev) {
    var p = walker.prev
    walker.prev = walker.next
    walker.next = p
  }
  this.head = tail
  this.tail = head
  return this
}

function push (self, item) {
  self.tail = new Node(item, self.tail, null, self)
  if (!self.head) {
    self.head = self.tail
  }
  self.length++
}

function unshift (self, item) {
  self.head = new Node(item, null, self.head, self)
  if (!self.tail) {
    self.tail = self.head
  }
  self.length++
}

function Node (value, prev, next, list) {
  if (!(this instanceof Node)) {
    return new Node(value, prev, next, list)
  }

  this.list = list
  this.value = value

  if (prev) {
    prev.next = this
    this.prev = prev
  } else {
    this.prev = null
  }

  if (next) {
    next.prev = this
    this.next = next
  } else {
    this.next = null
  }
}


/***/ }),
/* 37 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_37__;

/***/ }),
/* 38 */
/***/ (function(module, exports, __webpack_require__) {

/*!
 * Fuse.js v3.2.0 - Lightweight fuzzy-search (http://fusejs.io)
 * 
 * Copyright (c) 2012-2017 Kirollos Risk (http://kiro.me)
 * All Rights Reserved. Apache Software License 2.0
 * 
 * http://www.apache.org/licenses/LICENSE-2.0
 */
(function webpackUniversalModuleDefinition(root, factory) {
	if(true)
		module.exports = factory();
	else if(typeof define === 'function' && define.amd)
		define("Fuse", [], factory);
	else if(typeof exports === 'object')
		exports["Fuse"] = factory();
	else
		root["Fuse"] = factory();
})(this, function() {
return /******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// identity function for calling harmony imports with the correct context
/******/ 	__webpack_require__.i = function(value) { return value; };
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, {
/******/ 				configurable: false,
/******/ 				enumerable: true,
/******/ 				get: getter
/******/ 			});
/******/ 		}
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = 8);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


module.exports = function (obj) {
  return Object.prototype.toString.call(obj) === '[object Array]';
};

/***/ }),
/* 1 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var bitapRegexSearch = __webpack_require__(5);
var bitapSearch = __webpack_require__(7);
var patternAlphabet = __webpack_require__(4);

var Bitap = function () {
  function Bitap(pattern, _ref) {
    var _ref$location = _ref.location,
        location = _ref$location === undefined ? 0 : _ref$location,
        _ref$distance = _ref.distance,
        distance = _ref$distance === undefined ? 100 : _ref$distance,
        _ref$threshold = _ref.threshold,
        threshold = _ref$threshold === undefined ? 0.6 : _ref$threshold,
        _ref$maxPatternLength = _ref.maxPatternLength,
        maxPatternLength = _ref$maxPatternLength === undefined ? 32 : _ref$maxPatternLength,
        _ref$isCaseSensitive = _ref.isCaseSensitive,
        isCaseSensitive = _ref$isCaseSensitive === undefined ? false : _ref$isCaseSensitive,
        _ref$tokenSeparator = _ref.tokenSeparator,
        tokenSeparator = _ref$tokenSeparator === undefined ? / +/g : _ref$tokenSeparator,
        _ref$findAllMatches = _ref.findAllMatches,
        findAllMatches = _ref$findAllMatches === undefined ? false : _ref$findAllMatches,
        _ref$minMatchCharLeng = _ref.minMatchCharLength,
        minMatchCharLength = _ref$minMatchCharLeng === undefined ? 1 : _ref$minMatchCharLeng;

    _classCallCheck(this, Bitap);

    this.options = {
      location: location,
      distance: distance,
      threshold: threshold,
      maxPatternLength: maxPatternLength,
      isCaseSensitive: isCaseSensitive,
      tokenSeparator: tokenSeparator,
      findAllMatches: findAllMatches,
      minMatchCharLength: minMatchCharLength
    };

    this.pattern = this.options.isCaseSensitive ? pattern : pattern.toLowerCase();

    if (this.pattern.length <= maxPatternLength) {
      this.patternAlphabet = patternAlphabet(this.pattern);
    }
  }

  _createClass(Bitap, [{
    key: 'search',
    value: function search(text) {
      if (!this.options.isCaseSensitive) {
        text = text.toLowerCase();
      }

      // Exact match
      if (this.pattern === text) {
        return {
          isMatch: true,
          score: 0,
          matchedIndices: [[0, text.length - 1]]
        };
      }

      // When pattern length is greater than the machine word length, just do a a regex comparison
      var _options = this.options,
          maxPatternLength = _options.maxPatternLength,
          tokenSeparator = _options.tokenSeparator;

      if (this.pattern.length > maxPatternLength) {
        return bitapRegexSearch(text, this.pattern, tokenSeparator);
      }

      // Otherwise, use Bitap algorithm
      var _options2 = this.options,
          location = _options2.location,
          distance = _options2.distance,
          threshold = _options2.threshold,
          findAllMatches = _options2.findAllMatches,
          minMatchCharLength = _options2.minMatchCharLength;

      return bitapSearch(text, this.pattern, this.patternAlphabet, {
        location: location,
        distance: distance,
        threshold: threshold,
        findAllMatches: findAllMatches,
        minMatchCharLength: minMatchCharLength
      });
    }
  }]);

  return Bitap;
}();

// let x = new Bitap("od mn war", {})
// let result = x.search("Old Man's War")
// console.log(result)

module.exports = Bitap;

/***/ }),
/* 2 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var isArray = __webpack_require__(0);

var deepValue = function deepValue(obj, path, list) {
  if (!path) {
    // If there's no path left, we've gotten to the object we care about.
    list.push(obj);
  } else {
    var dotIndex = path.indexOf('.');
    var firstSegment = path;
    var remaining = null;

    if (dotIndex !== -1) {
      firstSegment = path.slice(0, dotIndex);
      remaining = path.slice(dotIndex + 1);
    }

    var value = obj[firstSegment];

    if (value !== null && value !== undefined) {
      if (!remaining && (typeof value === 'string' || typeof value === 'number')) {
        list.push(value.toString());
      } else if (isArray(value)) {
        // Search each item in the array.
        for (var i = 0, len = value.length; i < len; i += 1) {
          deepValue(value[i], remaining, list);
        }
      } else if (remaining) {
        // An object. Recurse further.
        deepValue(value, remaining, list);
      }
    }
  }

  return list;
};

module.exports = function (obj, path) {
  return deepValue(obj, path, []);
};

/***/ }),
/* 3 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


module.exports = function () {
  var matchmask = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
  var minMatchCharLength = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;

  var matchedIndices = [];
  var start = -1;
  var end = -1;
  var i = 0;

  for (var len = matchmask.length; i < len; i += 1) {
    var match = matchmask[i];
    if (match && start === -1) {
      start = i;
    } else if (!match && start !== -1) {
      end = i - 1;
      if (end - start + 1 >= minMatchCharLength) {
        matchedIndices.push([start, end]);
      }
      start = -1;
    }
  }

  // (i-1 - start) + 1 => i - start
  if (matchmask[i - 1] && i - start >= minMatchCharLength) {
    matchedIndices.push([start, i - 1]);
  }

  return matchedIndices;
};

/***/ }),
/* 4 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


module.exports = function (pattern) {
  var mask = {};
  var len = pattern.length;

  for (var i = 0; i < len; i += 1) {
    mask[pattern.charAt(i)] = 0;
  }

  for (var _i = 0; _i < len; _i += 1) {
    mask[pattern.charAt(_i)] |= 1 << len - _i - 1;
  }

  return mask;
};

/***/ }),
/* 5 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var SPECIAL_CHARS_REGEX = /[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g;

module.exports = function (text, pattern) {
  var tokenSeparator = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : / +/g;

  var regex = new RegExp(pattern.replace(SPECIAL_CHARS_REGEX, '\\$&').replace(tokenSeparator, '|'));
  var matches = text.match(regex);
  var isMatch = !!matches;
  var matchedIndices = [];

  if (isMatch) {
    for (var i = 0, matchesLen = matches.length; i < matchesLen; i += 1) {
      var match = matches[i];
      matchedIndices.push([text.indexOf(match), match.length - 1]);
    }
  }

  return {
    // TODO: revisit this score
    score: isMatch ? 0.5 : 1,
    isMatch: isMatch,
    matchedIndices: matchedIndices
  };
};

/***/ }),
/* 6 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


module.exports = function (pattern, _ref) {
  var _ref$errors = _ref.errors,
      errors = _ref$errors === undefined ? 0 : _ref$errors,
      _ref$currentLocation = _ref.currentLocation,
      currentLocation = _ref$currentLocation === undefined ? 0 : _ref$currentLocation,
      _ref$expectedLocation = _ref.expectedLocation,
      expectedLocation = _ref$expectedLocation === undefined ? 0 : _ref$expectedLocation,
      _ref$distance = _ref.distance,
      distance = _ref$distance === undefined ? 100 : _ref$distance;

  var accuracy = errors / pattern.length;
  var proximity = Math.abs(expectedLocation - currentLocation);

  if (!distance) {
    // Dodge divide by zero error.
    return proximity ? 1.0 : accuracy;
  }

  return accuracy + proximity / distance;
};

/***/ }),
/* 7 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var bitapScore = __webpack_require__(6);
var matchedIndices = __webpack_require__(3);

module.exports = function (text, pattern, patternAlphabet, _ref) {
  var _ref$location = _ref.location,
      location = _ref$location === undefined ? 0 : _ref$location,
      _ref$distance = _ref.distance,
      distance = _ref$distance === undefined ? 100 : _ref$distance,
      _ref$threshold = _ref.threshold,
      threshold = _ref$threshold === undefined ? 0.6 : _ref$threshold,
      _ref$findAllMatches = _ref.findAllMatches,
      findAllMatches = _ref$findAllMatches === undefined ? false : _ref$findAllMatches,
      _ref$minMatchCharLeng = _ref.minMatchCharLength,
      minMatchCharLength = _ref$minMatchCharLeng === undefined ? 1 : _ref$minMatchCharLeng;

  var expectedLocation = location;
  // Set starting location at beginning text and initialize the alphabet.
  var textLen = text.length;
  // Highest score beyond which we give up.
  var currentThreshold = threshold;
  // Is there a nearby exact match? (speedup)
  var bestLocation = text.indexOf(pattern, expectedLocation);

  var patternLen = pattern.length;

  // a mask of the matches
  var matchMask = [];
  for (var i = 0; i < textLen; i += 1) {
    matchMask[i] = 0;
  }

  if (bestLocation !== -1) {
    var score = bitapScore(pattern, {
      errors: 0,
      currentLocation: bestLocation,
      expectedLocation: expectedLocation,
      distance: distance
    });
    currentThreshold = Math.min(score, currentThreshold);

    // What about in the other direction? (speed up)
    bestLocation = text.lastIndexOf(pattern, expectedLocation + patternLen);

    if (bestLocation !== -1) {
      var _score = bitapScore(pattern, {
        errors: 0,
        currentLocation: bestLocation,
        expectedLocation: expectedLocation,
        distance: distance
      });
      currentThreshold = Math.min(_score, currentThreshold);
    }
  }

  // Reset the best location
  bestLocation = -1;

  var lastBitArr = [];
  var finalScore = 1;
  var binMax = patternLen + textLen;

  var mask = 1 << patternLen - 1;

  for (var _i = 0; _i < patternLen; _i += 1) {
    // Scan for the best match; each iteration allows for one more error.
    // Run a binary search to determine how far from the match location we can stray
    // at this error level.
    var binMin = 0;
    var binMid = binMax;

    while (binMin < binMid) {
      var _score3 = bitapScore(pattern, {
        errors: _i,
        currentLocation: expectedLocation + binMid,
        expectedLocation: expectedLocation,
        distance: distance
      });

      if (_score3 <= currentThreshold) {
        binMin = binMid;
      } else {
        binMax = binMid;
      }

      binMid = Math.floor((binMax - binMin) / 2 + binMin);
    }

    // Use the result from this iteration as the maximum for the next.
    binMax = binMid;

    var start = Math.max(1, expectedLocation - binMid + 1);
    var finish = findAllMatches ? textLen : Math.min(expectedLocation + binMid, textLen) + patternLen;

    // Initialize the bit array
    var bitArr = Array(finish + 2);

    bitArr[finish + 1] = (1 << _i) - 1;

    for (var j = finish; j >= start; j -= 1) {
      var currentLocation = j - 1;
      var charMatch = patternAlphabet[text.charAt(currentLocation)];

      if (charMatch) {
        matchMask[currentLocation] = 1;
      }

      // First pass: exact match
      bitArr[j] = (bitArr[j + 1] << 1 | 1) & charMatch;

      // Subsequent passes: fuzzy match
      if (_i !== 0) {
        bitArr[j] |= (lastBitArr[j + 1] | lastBitArr[j]) << 1 | 1 | lastBitArr[j + 1];
      }

      if (bitArr[j] & mask) {
        finalScore = bitapScore(pattern, {
          errors: _i,
          currentLocation: currentLocation,
          expectedLocation: expectedLocation,
          distance: distance
        });

        // This match will almost certainly be better than any existing match.
        // But check anyway.
        if (finalScore <= currentThreshold) {
          // Indeed it is
          currentThreshold = finalScore;
          bestLocation = currentLocation;

          // Already passed `loc`, downhill from here on in.
          if (bestLocation <= expectedLocation) {
            break;
          }

          // When passing `bestLocation`, don't exceed our current distance from `expectedLocation`.
          start = Math.max(1, 2 * expectedLocation - bestLocation);
        }
      }
    }

    // No hope for a (better) match at greater error levels.
    var _score2 = bitapScore(pattern, {
      errors: _i + 1,
      currentLocation: expectedLocation,
      expectedLocation: expectedLocation,
      distance: distance
    });

    if (_score2 > currentThreshold) {
      break;
    }

    lastBitArr = bitArr;
  }

  // Count exact matches (those with a score of 0) to be "almost" exact
  return {
    isMatch: bestLocation >= 0,
    score: finalScore === 0 ? 0.001 : finalScore,
    matchedIndices: matchedIndices(matchMask, minMatchCharLength)
  };
};

/***/ }),
/* 8 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var Bitap = __webpack_require__(1);
var deepValue = __webpack_require__(2);
var isArray = __webpack_require__(0);

var Fuse = function () {
  function Fuse(list, _ref) {
    var _ref$location = _ref.location,
        location = _ref$location === undefined ? 0 : _ref$location,
        _ref$distance = _ref.distance,
        distance = _ref$distance === undefined ? 100 : _ref$distance,
        _ref$threshold = _ref.threshold,
        threshold = _ref$threshold === undefined ? 0.6 : _ref$threshold,
        _ref$maxPatternLength = _ref.maxPatternLength,
        maxPatternLength = _ref$maxPatternLength === undefined ? 32 : _ref$maxPatternLength,
        _ref$caseSensitive = _ref.caseSensitive,
        caseSensitive = _ref$caseSensitive === undefined ? false : _ref$caseSensitive,
        _ref$tokenSeparator = _ref.tokenSeparator,
        tokenSeparator = _ref$tokenSeparator === undefined ? / +/g : _ref$tokenSeparator,
        _ref$findAllMatches = _ref.findAllMatches,
        findAllMatches = _ref$findAllMatches === undefined ? false : _ref$findAllMatches,
        _ref$minMatchCharLeng = _ref.minMatchCharLength,
        minMatchCharLength = _ref$minMatchCharLeng === undefined ? 1 : _ref$minMatchCharLeng,
        _ref$id = _ref.id,
        id = _ref$id === undefined ? null : _ref$id,
        _ref$keys = _ref.keys,
        keys = _ref$keys === undefined ? [] : _ref$keys,
        _ref$shouldSort = _ref.shouldSort,
        shouldSort = _ref$shouldSort === undefined ? true : _ref$shouldSort,
        _ref$getFn = _ref.getFn,
        getFn = _ref$getFn === undefined ? deepValue : _ref$getFn,
        _ref$sortFn = _ref.sortFn,
        sortFn = _ref$sortFn === undefined ? function (a, b) {
      return a.score - b.score;
    } : _ref$sortFn,
        _ref$tokenize = _ref.tokenize,
        tokenize = _ref$tokenize === undefined ? false : _ref$tokenize,
        _ref$matchAllTokens = _ref.matchAllTokens,
        matchAllTokens = _ref$matchAllTokens === undefined ? false : _ref$matchAllTokens,
        _ref$includeMatches = _ref.includeMatches,
        includeMatches = _ref$includeMatches === undefined ? false : _ref$includeMatches,
        _ref$includeScore = _ref.includeScore,
        includeScore = _ref$includeScore === undefined ? false : _ref$includeScore,
        _ref$verbose = _ref.verbose,
        verbose = _ref$verbose === undefined ? false : _ref$verbose;

    _classCallCheck(this, Fuse);

    this.options = {
      location: location,
      distance: distance,
      threshold: threshold,
      maxPatternLength: maxPatternLength,
      isCaseSensitive: caseSensitive,
      tokenSeparator: tokenSeparator,
      findAllMatches: findAllMatches,
      minMatchCharLength: minMatchCharLength,
      id: id,
      keys: keys,
      includeMatches: includeMatches,
      includeScore: includeScore,
      shouldSort: shouldSort,
      getFn: getFn,
      sortFn: sortFn,
      verbose: verbose,
      tokenize: tokenize,
      matchAllTokens: matchAllTokens
    };

    this.setCollection(list);
  }

  _createClass(Fuse, [{
    key: 'setCollection',
    value: function setCollection(list) {
      this.list = list;
      return list;
    }
  }, {
    key: 'search',
    value: function search(pattern) {
      this._log('---------\nSearch pattern: "' + pattern + '"');

      var _prepareSearchers2 = this._prepareSearchers(pattern),
          tokenSearchers = _prepareSearchers2.tokenSearchers,
          fullSearcher = _prepareSearchers2.fullSearcher;

      var _search2 = this._search(tokenSearchers, fullSearcher),
          weights = _search2.weights,
          results = _search2.results;

      this._computeScore(weights, results);

      if (this.options.shouldSort) {
        this._sort(results);
      }

      return this._format(results);
    }
  }, {
    key: '_prepareSearchers',
    value: function _prepareSearchers() {
      var pattern = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';

      var tokenSearchers = [];

      if (this.options.tokenize) {
        // Tokenize on the separator
        var tokens = pattern.split(this.options.tokenSeparator);
        for (var i = 0, len = tokens.length; i < len; i += 1) {
          tokenSearchers.push(new Bitap(tokens[i], this.options));
        }
      }

      var fullSearcher = new Bitap(pattern, this.options);

      return { tokenSearchers: tokenSearchers, fullSearcher: fullSearcher };
    }
  }, {
    key: '_search',
    value: function _search() {
      var tokenSearchers = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
      var fullSearcher = arguments[1];

      var list = this.list;
      var resultMap = {};
      var results = [];

      // Check the first item in the list, if it's a string, then we assume
      // that every item in the list is also a string, and thus it's a flattened array.
      if (typeof list[0] === 'string') {
        // Iterate over every item
        for (var i = 0, len = list.length; i < len; i += 1) {
          this._analyze({
            key: '',
            value: list[i],
            record: i,
            index: i
          }, {
            resultMap: resultMap,
            results: results,
            tokenSearchers: tokenSearchers,
            fullSearcher: fullSearcher
          });
        }

        return { weights: null, results: results };
      }

      // Otherwise, the first item is an Object (hopefully), and thus the searching
      // is done on the values of the keys of each item.
      var weights = {};
      for (var _i = 0, _len = list.length; _i < _len; _i += 1) {
        var item = list[_i];
        // Iterate over every key
        for (var j = 0, keysLen = this.options.keys.length; j < keysLen; j += 1) {
          var key = this.options.keys[j];
          if (typeof key !== 'string') {
            weights[key.name] = {
              weight: 1 - key.weight || 1
            };
            if (key.weight <= 0 || key.weight > 1) {
              throw new Error('Key weight has to be > 0 and <= 1');
            }
            key = key.name;
          } else {
            weights[key] = {
              weight: 1
            };
          }

          this._analyze({
            key: key,
            value: this.options.getFn(item, key),
            record: item,
            index: _i
          }, {
            resultMap: resultMap,
            results: results,
            tokenSearchers: tokenSearchers,
            fullSearcher: fullSearcher
          });
        }
      }

      return { weights: weights, results: results };
    }
  }, {
    key: '_analyze',
    value: function _analyze(_ref2, _ref3) {
      var key = _ref2.key,
          _ref2$arrayIndex = _ref2.arrayIndex,
          arrayIndex = _ref2$arrayIndex === undefined ? -1 : _ref2$arrayIndex,
          value = _ref2.value,
          record = _ref2.record,
          index = _ref2.index;
      var _ref3$tokenSearchers = _ref3.tokenSearchers,
          tokenSearchers = _ref3$tokenSearchers === undefined ? [] : _ref3$tokenSearchers,
          _ref3$fullSearcher = _ref3.fullSearcher,
          fullSearcher = _ref3$fullSearcher === undefined ? [] : _ref3$fullSearcher,
          _ref3$resultMap = _ref3.resultMap,
          resultMap = _ref3$resultMap === undefined ? {} : _ref3$resultMap,
          _ref3$results = _ref3.results,
          results = _ref3$results === undefined ? [] : _ref3$results;

      // Check if the texvaluet can be searched
      if (value === undefined || value === null) {
        return;
      }

      var exists = false;
      var averageScore = -1;
      var numTextMatches = 0;

      if (typeof value === 'string') {
        this._log('\nKey: ' + (key === '' ? '-' : key));

        var mainSearchResult = fullSearcher.search(value);
        this._log('Full text: "' + value + '", score: ' + mainSearchResult.score);

        if (this.options.tokenize) {
          var words = value.split(this.options.tokenSeparator);
          var scores = [];

          for (var i = 0; i < tokenSearchers.length; i += 1) {
            var tokenSearcher = tokenSearchers[i];

            this._log('\nPattern: "' + tokenSearcher.pattern + '"');

            // let tokenScores = []
            var hasMatchInText = false;

            for (var j = 0; j < words.length; j += 1) {
              var word = words[j];
              var tokenSearchResult = tokenSearcher.search(word);
              var obj = {};
              if (tokenSearchResult.isMatch) {
                obj[word] = tokenSearchResult.score;
                exists = true;
                hasMatchInText = true;
                scores.push(tokenSearchResult.score);
              } else {
                obj[word] = 1;
                if (!this.options.matchAllTokens) {
                  scores.push(1);
                }
              }
              this._log('Token: "' + word + '", score: ' + obj[word]);
              // tokenScores.push(obj)
            }

            if (hasMatchInText) {
              numTextMatches += 1;
            }
          }

          averageScore = scores[0];
          var scoresLen = scores.length;
          for (var _i2 = 1; _i2 < scoresLen; _i2 += 1) {
            averageScore += scores[_i2];
          }
          averageScore = averageScore / scoresLen;

          this._log('Token score average:', averageScore);
        }

        var finalScore = mainSearchResult.score;
        if (averageScore > -1) {
          finalScore = (finalScore + averageScore) / 2;
        }

        this._log('Score average:', finalScore);

        var checkTextMatches = this.options.tokenize && this.options.matchAllTokens ? numTextMatches >= tokenSearchers.length : true;

        this._log('\nCheck Matches: ' + checkTextMatches);

        // If a match is found, add the item to <rawResults>, including its score
        if ((exists || mainSearchResult.isMatch) && checkTextMatches) {
          // Check if the item already exists in our results
          var existingResult = resultMap[index];
          if (existingResult) {
            // Use the lowest score
            // existingResult.score, bitapResult.score
            existingResult.output.push({
              key: key,
              arrayIndex: arrayIndex,
              value: value,
              score: finalScore,
              matchedIndices: mainSearchResult.matchedIndices
            });
          } else {
            // Add it to the raw result list
            resultMap[index] = {
              item: record,
              output: [{
                key: key,
                arrayIndex: arrayIndex,
                value: value,
                score: finalScore,
                matchedIndices: mainSearchResult.matchedIndices
              }]
            };

            results.push(resultMap[index]);
          }
        }
      } else if (isArray(value)) {
        for (var _i3 = 0, len = value.length; _i3 < len; _i3 += 1) {
          this._analyze({
            key: key,
            arrayIndex: _i3,
            value: value[_i3],
            record: record,
            index: index
          }, {
            resultMap: resultMap,
            results: results,
            tokenSearchers: tokenSearchers,
            fullSearcher: fullSearcher
          });
        }
      }
    }
  }, {
    key: '_computeScore',
    value: function _computeScore(weights, results) {
      this._log('\n\nComputing score:\n');

      for (var i = 0, len = results.length; i < len; i += 1) {
        var output = results[i].output;
        var scoreLen = output.length;

        var totalScore = 0;
        var bestScore = 1;

        for (var j = 0; j < scoreLen; j += 1) {
          var weight = weights ? weights[output[j].key].weight : 1;
          var score = weight === 1 ? output[j].score : output[j].score || 0.001;
          var nScore = score * weight;

          if (weight !== 1) {
            bestScore = Math.min(bestScore, nScore);
          } else {
            output[j].nScore = nScore;
            totalScore += nScore;
          }
        }

        results[i].score = bestScore === 1 ? totalScore / scoreLen : bestScore;

        this._log(results[i]);
      }
    }
  }, {
    key: '_sort',
    value: function _sort(results) {
      this._log('\n\nSorting....');
      results.sort(this.options.sortFn);
    }
  }, {
    key: '_format',
    value: function _format(results) {
      var finalOutput = [];

      this._log('\n\nOutput:\n\n', JSON.stringify(results));

      var transformers = [];

      if (this.options.includeMatches) {
        transformers.push(function (result, data) {
          var output = result.output;
          data.matches = [];

          for (var i = 0, len = output.length; i < len; i += 1) {
            var item = output[i];

            if (item.matchedIndices.length === 0) {
              continue;
            }

            var obj = {
              indices: item.matchedIndices,
              value: item.value
            };
            if (item.key) {
              obj.key = item.key;
            }
            if (item.hasOwnProperty('arrayIndex') && item.arrayIndex > -1) {
              obj.arrayIndex = item.arrayIndex;
            }
            data.matches.push(obj);
          }
        });
      }

      if (this.options.includeScore) {
        transformers.push(function (result, data) {
          data.score = result.score;
        });
      }

      for (var i = 0, len = results.length; i < len; i += 1) {
        var result = results[i];

        if (this.options.id) {
          result.item = this.options.getFn(result.item, this.options.id)[0];
        }

        if (!transformers.length) {
          finalOutput.push(result.item);
          continue;
        }

        var data = {
          item: result.item
        };

        for (var j = 0, _len2 = transformers.length; j < _len2; j += 1) {
          transformers[j](result, data);
        }

        finalOutput.push(data);
      }

      return finalOutput;
    }
  }, {
    key: '_log',
    value: function _log() {
      if (this.options.verbose) {
        var _console;

        (_console = console).log.apply(_console, arguments);
      }
    }
  }]);

  return Fuse;
}();

module.exports = Fuse;

/***/ })
/******/ ]);
});
//# sourceMappingURL=fuse.js.map

/***/ }),
/* 39 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports) {
    "use strict";

    /**
     * Stores user search results for the server-users-supplier
     */
    // TODO CONFSRVDEV-2015 - shouldn't store the same User object more than once. Should only store lists of keys in the query map,
    // and then have a separate cross-supplier Map of User objects by key. dT
    var cache = {};
    var queries = [];

    exports.default = function (limit) {
        return {
            add: function add(query, users) {
                cache[query] = {
                    query: query,
                    users: users,
                    isExhausted: users.length < limit
                };

                // Queries list is alph sorted descending so that longer queries are above the shorter queries that
                // they contain.
                queries.push(query);
                queries.sort();
                queries.reverse();
            },

            /**
             * Look in the cache for this query or a shorter one.
             */
            getClosest: function getClosest(query) {
                if (cache[query]) {
                    return cache[query];
                }

                // Else find the longest matching substring of the query.
                // The query list is sorted, so the first item found should be the longest one.
                var queryMatch = queries.find(function (subquery) {
                    return query.indexOf(subquery) === 0;
                });
                if (queryMatch) {
                    return cache[queryMatch];
                }

                return null; // just to make this obvious...
            },

            // Used in tests.
            reset: function reset() {
                cache = {};
                queries = [];
            }
        };
    };

    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 40 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports) {
    "use strict";

    function escape(query) {
        return [].map.call(query, function escapeSpecialCharacter(char) {
            if (char === '+' || char === '-' || char === '&' || char === '|' || char === '!' || char === '(' || char === ')' || char === '{' || char === '}' || char === '[' || char === ']' || char === '^' || char === '"' || char === '~' || char === '*' || char === '?' || char === ':' || char === '\\') return '\\' + char;
            return char;
        }).join('');
    }

    exports.default = {
        escape: escape
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 41 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(2), __webpack_require__(1)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _meta, _userSupplierKeys) {
    'use strict';

    var Meta = _interopRequireDefault(_meta).default;

    var UserSupplier = _interopRequireDefault(_userSupplierKeys).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    "use strict";

    function getCurrentUser() {
        return new Promise(function (resolve) {

            var username = Meta.get('remote-user');
            if (!username) {
                // Anonymous user.
                return resolve();
            }

            var userKey = Meta.get('remote-user-key');
            var displayName = Meta.get('current-user-fullname');
            var path = Meta.get('current-user-avatar-uri-reference');

            resolve({
                type: "known",
                username: username,
                userKey: userKey,
                profilePicture: {
                    path: path,
                    width: 48,
                    height: 48
                },
                displayName: displayName,
                supplier: UserSupplier.CURRENT
            });
        });
    }

    exports.default = {
        getCurrentUser: getCurrentUser
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 42 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(16), __webpack_require__(43), __webpack_require__(12), __webpack_require__(44), __webpack_require__(15), __webpack_require__(46), __webpack_require__(47), __webpack_require__(48), __webpack_require__(17)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _templates, _resultPlaceholder, _userRanker, _userConverter, _utils, _defaultOrdering, _scoreLogger, _defaultFiltering, _scoreBooster) {
    'use strict';

    var Templates = _interopRequireDefault(_templates).default;

    var ResultPlaceholder = _interopRequireDefault(_resultPlaceholder).default;

    var SearchUsers = _interopRequireDefault(_userRanker).default;

    var ConvertUsers = _interopRequireDefault(_userConverter).default;

    var RenderUtils = _interopRequireDefault(_utils).default;

    var ensureDefaultOrder = _interopRequireDefault(_defaultOrdering).default;

    var scoreLogger = _interopRequireDefault(_scoreLogger).default;

    var filterServerResults = _interopRequireDefault(_defaultFiltering).default;

    var ScoreBooster = _interopRequireDefault(_scoreBooster).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    "use strict"; /**
                   * The contents of the UserCache is passed through the user pipeline which filters, ranks and modifies
                   * the list until we arrive at the final 5 elements to display.
                   *
                   * Want To add another function to the user pipeline? Easy...
                   *
                   * Define a function like the following and add it to a pipeline. Ordering is very important.
                   *
                   * @param results   The results array as supplied by the previous function
                   * @param next      Call this function and pass some results to trigger the next stage of the pipeline
                   * @param context   Some context about the current rendering request. See Mentions.js
                   *
                   * function pipelineTransformation(results, next, context) {
                   *      //Do some things on results
                   *      results.forEach((results) => transform(result))
                   *
                   *      //Remember to call next
                   *      next(results);
                   * }
                   */

    function filterUsingQuery(results, next, context) {
        next(SearchUsers(results, context.query));
    }

    function moveSelectedUserToTop(oldUsers, next, context) {
        if (!context.selectedUser) {
            return next(oldUsers);
        }

        var index = oldUsers.findIndex(function (user) {
            return user.username === context.selectedUser.username;
        });
        // Note that > -1 means that the user IS in the array. If index is 0, the user is already in the correct position
        // at the start of the array and there is nothing to do.
        if (index <= 0) {
            return next(oldUsers);
        }

        // Put this user at the start of the array.
        var user = oldUsers[index];
        var newUsers = oldUsers.slice(0); // clone the array to avoid modifying the original
        newUsers.splice(index, 1);
        newUsers.unshift(user);

        return next(newUsers);
    }

    /**
     * fuseScore is available on all user results for a query-term search, so we can sort at any point in the pipeline.
     */
    function sortOnScore(users, next) {
        if (users.length && typeof users[0].fuseScore === 'number') {
            // If the first result has a fuseScore they all will.
            users.sort(function (user1, user2) {
                return user1.fuseScore - user2.fuseScore;
            });
        }
        next(users);
    }

    function limit(array, next, context) {
        next(array.slice(0, context.DISPLAY_LIMIT));
    }

    // Called in the Server pipeline when there are no results.
    function userNotFound(results, next) {
        if (!results.length) {
            var notFoundResult = RenderUtils.resultWithHtml(Templates.Mentions.userNotFoundResult());
            results = [notFoundResult];
        }

        next(results);
    }

    function empty(results, next) {
        if (!results.length) {
            next([RenderUtils.resultWithHtml(Templates.Mentions.loadingPlaceholder())]);
        } else {
            next(results);
        }
    }

    function addErrorResult(results, next) {
        var failureResult = RenderUtils.resultWithHtml(Templates.Mentions.searchFailureResult());
        next([failureResult]);
    }

    /**
     * This function convert Users from API format to something that the Dropdown can display.
     *
     * All elements in the results array should be Users in API format.
     * If you want to add other elements to the results array, do this *after* convertUsers in the pipeline
     *
     * @param results
     * @param next
     */
    function convertUsers(results, next) {
        next(ConvertUsers(results));
    }

    // Don't continue the render if the query is stale.
    function staleServerResponseFilter(results, next, context) {
        if (context.latestQuery === context.query) {
            next(results);
        }
    }

    exports.default = {

        default: function _default(renderCallback) {
            return [ResultPlaceholder.cancelTimeout, filterServerResults, ensureDefaultOrder, limit, ScoreBooster.setSuggestedUsers, convertUsers, renderCallback];
        },

        client: function client(renderCallback) {
            return [ResultPlaceholder.cancelTimeout, filterUsingQuery, ScoreBooster.boostScores, sortOnScore, limit, moveSelectedUserToTop, convertUsers, ResultPlaceholder.startTimeout, empty, renderCallback];
        },
        server: function server(renderCallback) {
            return [ResultPlaceholder.cancelTimeout, staleServerResponseFilter, filterUsingQuery, ScoreBooster.boostScores, sortOnScore, limit, moveSelectedUserToTop, scoreLogger, convertUsers, userNotFound, renderCallback];
        },

        error: function error(renderCallback) {
            return [ResultPlaceholder.cancelTimeout, addErrorResult, renderCallback];
        },

        _functions: {
            moveSelectedUserToTop: moveSelectedUserToTop,
            sortOnScore: sortOnScore
        }
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 43 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(15), __webpack_require__(16)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _utils, _templates) {
    'use strict';

    var RenderUtils = _interopRequireDefault(_utils).default;

    var Templates = _interopRequireDefault(_templates).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    var displayTimeout = void 0;

    function _padResults(results, context) {
        var additionalElements = context.DISPLAY_LIMIT - results.length;
        if (additionalElements > 0) {
            var placeholder = RenderUtils.resultWithHtml(Templates.Mentions.loadingPlaceholder());
            for (var index = 0; index < additionalElements; index++) {
                results.push(placeholder);
            }
        }
        return results;
    }

    function startTimeout(results, next, context) {
        displayTimeout = setTimeout(function () {
            results = _padResults(results, context);
            next(results);
        }, window.skeletonPlaceholder || 3000); // CONFSRVDEV-3833 Remove once an appropriate value has been found.
        next(results);
    }

    function cancelTimeout(results, next) {
        clearTimeout(displayTimeout);
        next(results);
    }

    exports.default = {
        startTimeout: startTimeout,
        cancelTimeout: cancelTimeout
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 44 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(2), __webpack_require__(8), __webpack_require__(1), __webpack_require__(45)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _meta, _i18n, _userSupplierKeys, _darkFeatures) {
    'use strict';

    var Meta = _interopRequireDefault(_meta).default;

    var I18n = _interopRequireDefault(_i18n).default;

    var UserSupplier = _interopRequireDefault(_userSupplierKeys).default;

    var DarkFeatures = _interopRequireDefault(_darkFeatures).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    /**
     * Converts Users from API format to something that the Dropdown can display.
     */
    var contextPath = Meta.get('context-path');

    function getProfilePicture(user) {
        if (user && user.profilePicture && Meta.get('can-view-profile')) {
            // HACK - work around CONFSRVDEV-2936 by removing the dud context-path from the path.
            return user.profilePicture.path.replace('/_' + contextPath, '/_');
        }
        return contextPath + '/images/icons/profilepics/anonymous.svg';
    }

    var converter = function converter(users) {
        var addRecentLozenge = DarkFeatures.isEnabled('smart.mentions.recent.lozenge');
        var linkBase = Meta.get('base-url') + '/display/~';

        return users.map(function (user) {
            var link = linkBase + user.username;

            var lozenge = user.supplier === UserSupplier.RELATED && user.role && user.role.i18n;

            if (!lozenge && addRecentLozenge) {
                // Including a lozenge for Recent helps us see why an item is promoted, but make it opt-in.
                lozenge = user.supplier === UserSupplier.RECENT && I18n('user.supplier.recent');
            }
            // Uncomment this line to see why the results are in the order they are.
            // const lozenge = "" + user.fuseScore;

            return {
                className: 'insert-mentions-dropdown-option',
                name: user.displayName,
                username: user.username,
                href: link, // only used if the user tries to middle-click/open-in-new-tab the dropdown item
                icon: getProfilePicture(user),
                lozenge: lozenge,
                link: link,
                model: user,
                fuseMatches: user.fuseMatches
            };
        });
    };

    // Available for unit testing.
    converter._getProfilePicture = getProfilePicture;

    exports.default = converter;
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 45 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_45__;

/***/ }),
/* 46 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(4)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _recentUsersSupplier) {
    "use strict";

    var RecentUsers = _interopRequireDefault(_recentUsersSupplier).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) {
        return typeof obj;
    } : function (obj) {
        return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj;
    };

    var supplierToScoreMap = {
        "current": 1,
        "recent": 2,
        "related": {
            "creator": 3,
            "contributor": 4,
            "commenter": 5
        },
        "server": 6
    };

    var MAX_SCORE = 100;

    function scoreUser(user) {
        var potentialScore = supplierToScoreMap[user.supplier];

        if (typeof potentialScore === "number") {
            if (typeof user.sortIndex === "number") {
                // This allows us to sort recent users coming out of the cache. The highest calculated score will be just < 3.
                potentialScore += user.sortIndex / (RecentUsers.RECENT_USER_LIMIT + 1);
            }
            return potentialScore;
        }

        // Not a number, probably another object, index into it with role
        // Otherwise, it might have been undefined
        return (typeof potentialScore === "undefined" ? "undefined" : _typeof(potentialScore)) === "object" ? potentialScore[user.role.role] : MAX_SCORE;
    }

    function ensureDefaultOrder(results, next) {
        var sorted = results.sort(function (user1, user2) {
            return scoreUser(user1) - scoreUser(user2);
        });
        next(sorted);
    }

    exports.default = ensureDefaultOrder;
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 47 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(0)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _ajs) {
    "use strict";

    exports.default = logScores;

    var AJS = _interopRequireDefault(_ajs).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    "use strict";

    /**
     * Just used during development, logs result score information to help us figure out reasons for result order.
     */
    function logScores(results, next, context) {
        if (context.query) {
            AJS.debug("*** Mentions *** user-pipeline/logger: Logging search results for " + context.query);

            results.forEach(function (user) {
                AJS.debug("*** Mentions *** user-pipeline/logger: " + user.displayName + " has a score of " + user.fuseScore);
            });
        }

        next(results);
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 48 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(1)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _userSupplierKeys) {
    "use strict";

    var DEFAULT_SUPPLIERS = [_userSupplierKeys.RECENT, _userSupplierKeys.CURRENT, _userSupplierKeys.RELATED];

    function filterServerResults(results, next) {
        var filteredUsers = results.filter(function (user) {
            return DEFAULT_SUPPLIERS.indexOf(user.supplier) !== -1;
        });
        next(filteredUsers);
    }

    exports.default = filterServerResults;
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 49 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports) {
    "use strict";

    function PipelineExecutor(pipeline, context) {
        this.pipeline = pipeline;
        this.context = context;
    }

    PipelineExecutor.prototype.execute = function (input) {
        this._next(0, input);
    };

    PipelineExecutor.prototype._next = function (index, results) {
        this.pipeline[index](results, this._next.bind(this, index + 1), this.context);
    };

    exports.default = PipelineExecutor;
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 50 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(0), __webpack_require__(51), __webpack_require__(18)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _ajs, _analyticsSupport, _autocompleteManager) {
    'use strict';

    var AJS = _interopRequireDefault(_ajs).default;

    var Analytics = _interopRequireDefault(_analyticsSupport).default;

    var AutocompleteManager = _interopRequireDefault(_autocompleteManager).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    "use strict";

    function publishEventForSelection(user) {
        var context = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};

        var idd = typeof AutocompleteManager.getInputDrivenDropdown === 'function' && AutocompleteManager.getInputDrivenDropdown();
        if (!idd || !user) {
            AJS.debug("Cannot publish 'confluence.mention.selection' analytics with missing dropdown, user or context.");
            return;
        }

        var query = idd._value || '';
        var dd = idd.dd;
        var index = dd && typeof dd.getFocusIndex === 'function' && dd.getFocusIndex();

        var analyticsData = {
            source: user.model.supplier,
            queryLength: query.length,
            queryWords: query.split(' ').length,
            index: index,
            numberOfSearches: context.numGetDataAndRunCallbackCalls
        };

        // By publishing the supplier source of the selected User, we can determine whether users are finding
        // the users they need from the Smart mentions or whether they still have to wait for the Dumb (server)
        // ones.
        Analytics.publish('confluence.mention.selection', analyticsData);
        AJS.debug("Published 'confluence.mention.selection' event with supplier: " + user.model.supplier);
    }

    /**
     * Updates the state of the current Mention interaction.
     * @param autoCompleteControl
     */
    function updateSession(autoCompleteControl) {
        autoCompleteControl.analytics = Object.assign({
            numGetDataAndRunCallbackCalls: 0
        }, autoCompleteControl.analytics);

        autoCompleteControl.analytics.numGetDataAndRunCallbackCalls += 1;
    }

    exports.default = {
        updateSession: updateSession,
        publishEventForSelection: publishEventForSelection
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 51 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_51__;

/***/ }),
/* 52 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_52__;

/***/ }),
/* 53 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_53__;

/***/ })
/******/ ])});;
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-mentions-plugin:smart-mentions-editor-resources', location = '/js/smart-mentions-init.js' */
require([
    'confluence-editor/loader/tinymce-bootstrap',
    'confluence-mentions'
], function (BootstrapManager,
             Mentions) {
    // Main entry point to Smart Mentions logic. To lower page weight, we could potentially pull in the Mentions
    // bundle.js via a WRM.require on the bootstrap init.
    BootstrapManager.addOnInitCallback(Mentions.init);
});

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.sticky-table-headers:stickytableheaders-resources', location = '/js/vendor/jquery.stickytableheaders.js' */
/*
 Modified by Atlassian | Copyright (c) 2011 by Jonas Mosbech - https://github.com/jmosbech/StickyTableHeaders
 MIT license info: https://github.com/jmosbech/StickyTableHeaders/blob/master/license.txt */
(function(d,l,t){function p(g,k){var a=this;a.$el=d(g);a.el=g;a.id=q++;a.$el.bind("destroyed",d.proxy(a.teardown,a));a.$clonedHeader=null;a.$originalHeader=null;a.cachedHeaderHeight=null;a.isSticky=!1;a.hasBeenSticky=!1;a.leftOffset=null;a.topOffset=null;a.init=function(){a.setOptions(k);a.$el.each(function(){var c=d(this);c.css("padding",0);a.$originalHeader=d("thead:first",this);a.$clonedHeader=a.$originalHeader.clone();c.trigger("clonedHeader.stickyTableHeaders",[a.$clonedHeader]);a.$clonedHeader.addClass("tableFloatingHeader");
a.$clonedHeader.css("display","none");a.$originalHeader.addClass("tableFloatingHeaderOriginal");a.$originalHeader.after(a.$clonedHeader);a.$printStyle=d('\x3cstyle type\x3d"text/css" media\x3d"print"\x3e.tableFloatingHeader{display:none !important;}.tableFloatingHeaderOriginal{position:static !important;}\x3c/style\x3e');a.$head.append(a.$printStyle)});a.updateWidth();a.toggleHeaders();a.bind()};a.destroy=function(){a.$el.unbind("destroyed",a.teardown);a.teardown()};a.teardown=function(){a.isSticky&&
a.$originalHeader.css("position","static");d.removeData(a.el,"plugin_stickyTableHeaders");a.unbind();a.$clonedHeader.remove();a.$originalHeader.removeClass("tableFloatingHeaderOriginal");a.$originalHeader.css("visibility","visible");a.$printStyle.remove();a.el=null;a.$el=null};a.bind=function(){a.$scrollableArea.on("scroll.stickyTableHeaders",a.toggleHeaders);a.isWindowScrolling||(a.$window.on("scroll.stickyTableHeaders"+a.id,a.setPositionValues),a.$window.on("resize.stickyTableHeaders"+a.id,a.toggleHeaders));
a.$scrollableArea.on("resize.stickyTableHeaders",a.toggleHeaders);a.$scrollableArea.on("resize.stickyTableHeaders",a.updateWidth)};a.unbind=function(){a.$scrollableArea.off(".stickyTableHeaders",a.toggleHeaders);a.isWindowScrolling||(a.$window.off(".stickyTableHeaders"+a.id,a.setPositionValues),a.$window.off(".stickyTableHeaders"+a.id,a.toggleHeaders));a.$scrollableArea.off(".stickyTableHeaders",a.updateWidth)};a.debounce=function(c,e){var f=null;return function(){var b=this,h=arguments;clearTimeout(f);
f=setTimeout(function(){c.apply(b,h)},e)}};a.toggleHeaders=a.debounce(function(){a.$el&&a.$el.each(function(){var c=d(this),e=a.isWindowScrolling?isNaN(a.options.fixedOffset)?a.options.fixedOffset.outerHeight():a.options.fixedOffset:a.$scrollableArea.offset().top+(isNaN(a.options.fixedOffset)?0:a.options.fixedOffset);var f=c.offset();var b=a.$scrollableArea.scrollTop()+e,h=a.$scrollableArea.scrollLeft(),m=a.options.cacheHeaderHeight?a.cachedHeaderHeight:a.$clonedHeader.height(),n=a.isWindowScrolling?
b>f.top:e>f.top;b=(a.isWindowScrolling?b:0)<f.top+c.height()-m-(a.isWindowScrolling?0:e);n&&b?(f=f.left-h+a.options.leftOffset,a.$originalHeader.css({position:"fixed","margin-top":a.options.marginTop,left:f,"z-index":3}),a.leftOffset=f,a.topOffset=e,a.$clonedHeader.css("display",""),a.isSticky||(a.isSticky=!0,a.updateWidth(),c.trigger("enabledStickiness.stickyTableHeaders")),a.setPositionValues()):a.isSticky&&(a.$originalHeader.css("position","static"),a.$clonedHeader.css("display","none"),a.isSticky=
!1,a.resetWidth(d("td,th",a.$clonedHeader),d("td,th",a.$originalHeader)),c.trigger("disabledStickiness.stickyTableHeaders"))})},0);a.setPositionValues=a.debounce(function(){var c=a.$window.scrollTop(),e=a.$window.scrollLeft();!a.isSticky||0>c||c+a.$window.height()>a.$document.height()||0>e||e+a.$window.width()>a.$document.width()||a.$originalHeader.css({top:a.topOffset-(a.isWindowScrolling?0:c),left:a.leftOffset-(a.isWindowScrolling?0:e)})},0);a.updateWidth=a.debounce(function(){if(a.isSticky){a.$originalHeaderCells||
(a.$originalHeaderCells=d("th,td",a.$originalHeader));a.$clonedHeaderCells||(a.$clonedHeaderCells=d("th,td",a.$clonedHeader));var c=a.getWidth(a.$clonedHeaderCells);a.setWidth(c,a.$clonedHeaderCells,a.$originalHeaderCells);a.$originalHeader.css("width",a.$clonedHeader.width());a.options.cacheHeaderHeight&&(a.cachedHeaderHeight=a.$clonedHeader.height())}},0);a.getWidth=function(c){var e=[];c.each(function(f){var b=d(this);if("border-box"===b.css("box-sizing"))b=b[0].getBoundingClientRect(),b=b.width?
b.width:b.right-b.left;else if("collapse"===d("th",a.$originalHeader).css("border-collapse"))if(l.getComputedStyle)b=parseFloat(l.getComputedStyle(this,null).width);else{var h=parseFloat(b.css("padding-left")),m=parseFloat(b.css("padding-right")),n=parseFloat(b.css("border-width"));b=b.outerWidth()-h-m-n}else b=b.width();e[f]=b});return e};a.setWidth=function(c,e,f){e.each(function(b){var h=c[b];f.eq(b).css({"min-width":h,"max-width":h})})};a.resetWidth=function(c,e){c.each(function(f){var b=d(this);
e.eq(f).css({"min-width":b.css("min-width"),"max-width":b.css("max-width")})})};a.setOptions=function(c){a.options=d.extend({},r,c);a.$window=d(a.options.objWindow);a.$head=d(a.options.objHead);a.$document=d(a.options.objDocument);a.$scrollableArea=d(a.options.scrollableArea);a.isWindowScrolling=a.$scrollableArea[0]===a.$window[0]};a.updateOptions=function(c){a.setOptions(c);a.unbind();a.bind();a.updateWidth();a.toggleHeaders()};a.init()}var q=0,r={fixedOffset:0,leftOffset:0,marginTop:0,objDocument:document,
objHead:"head",objWindow:l,scrollableArea:l,cacheHeaderHeight:!1};d.fn.stickyTableHeaders=function(g){return this.each(function(){var k=d.data(this,"plugin_stickyTableHeaders");k?"string"===typeof g?k[g].apply(k):k.updateOptions(g):"destroy"!==g&&d.data(this,"plugin_stickyTableHeaders",new p(this,g))})}})(jQuery,window);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.sticky-table-headers:stickytableheaders-resources', location = '/js/lib/utils.js' */
define("sticky-table-headers/utils",["jquery"],function(d){var e=function(){return!d("body").hasClass("theme-documentation")};return{isAValidTable:function(a){a=d(a);var b;if(b=e()&&!a.hasClass("stickyTableHeaders")&&0< !a.closest(".columnLayout").length&&0< !a.parents("table").length&&a.find("\x3e thead:first").is(":visible")&&1===a.find("thead").children().length&&1===a.find(".confluenceTh").parent().length)b=0===a.find(".confluenceTh").siblings().length||0===a.find(".confluenceTh").siblings().not(".confluenceTh").length;
return b},bindHorizontalScrolling:function(a,b){var c=b||d(window);a.closest(".table-wrap").scroll(function(){c.trigger("scroll.stickyTableHeaders")})},moveHeaderRowsToTHead:function(a){d(a).each(function(){var b=d(this);if(!(0<b.find("\x3e thead").length)){var c=b.find("\x3e tbody \x3e :first-child \x3e :first-child.confluenceTh");!(0>=c.length||0<c.parent().find("\x3e .confluenceTh[rowspan]").length)&&0< !b.parents("table").length&&0< !b.closest(".columnLayout").length&&(c=d("\x3cthead /\x3e").append(c.parent()),
b.prepend(c))}})},isNotDocumentationTheme:e}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.sticky-table-headers:stickytableheaders-resources', location = '/js/lib/viewpage.js' */
define("sticky-table-headers/viewpage",["jquery","ajs","sticky-table-headers/utils"],function(c,l,d){var e,h,f,n=function(a,b){a=c(a).filter(function(){return d.isAValidTable(this)});a.stickyTableHeaders(b).addClass("stickyTableHeaders");f?f.add(a):f=a;b=function(m,g){f.stickyTableHeaders(g)};h&&l.unbind("sticky-table-headers.change.options",h);l.bind("sticky-table-headers.change.options",b);h=b;d.bindHorizontalScrolling(a)};return{initialize:function(){var a=c(".confluenceTable:not(.stickyTableHeaders)"),
b=c(window);if(d.isNotDocumentationTheme()){d.moveHeaderRowsToTHead(a);if(window.MutationObserver){a=document.querySelector("#page")||document.querySelector("#confluence-ui");var m=/sticky|tableFloating|confluenceTh/,g=new MutationObserver(c.debounce(function(p){for(var q=!1,r,k=0,t=p.length;k<t;k++)if(r=p[k].target.className,!m.test(r)){q=!0;break}q&&b.trigger("resize.stickyTableHeaders")},0));e&&e.unobserve&&e.unobserve();g.observe(a,{subtree:!0,attributes:!0,childList:!0});e=g}n(c(".confluenceTable"),
{cacheHeaderHeight:!0})}},setupTable:n}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.sticky-table-headers:stickytableheaders-resources', location = '/js/lib/editor.js' */
define("sticky-table-headers/editor",["ajs","jquery","sticky-table-headers/utils"],function(f,c,e){var h=function(a){var b={};b.objWindow=c(a.getWin());b.scrollableArea=b.objWindow;b.objDocument=c(a.getDoc());b.objHead=b.objDocument.find("head");return b},g=function(a,b){var d=f.Rte.getEditor();d&&(d=h(d),b=c.extend({},d,b),a=c(a).filter(function(){return e.isAValidTable(this)}),a.stickyTableHeaders(b).addClass("stickyTableHeaders"),e.bindHorizontalScrolling(a,b.objWindow))};return{initialize:function(){var a=
f.Rte.getEditor();a&&(a=c(a.getBody()).find(".confluenceTable"),e.moveHeaderRowsToTHead(a),g(a))},setupTable:g}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.sticky-table-headers:stickytableheaders-resources', location = '/js/stickytableheaders.js' */
define("sticky-table-headers",["ajs","sticky-table-headers/viewpage","sticky-table-headers/editor","skate"],function(a,d,b,c){var e=a.debounce(d.initialize,0);return{initialize:function(){a.DarkFeatures.isEnabled("confluence-table-enhancements.sticky-headers.disabled")||c("confluenceTable",{type:c.types.CLASS,attached:function(f){e()}});a.DarkFeatures.isEnabled("confluence-table-enhancements.sticky-headers-editor")&&(a.bind("rte-ready",b.initialize),a.bind("rte-quick-edit-push-state",b.initialize),
a.bind("rte-quick-edit-push-hash",b.initialize))}}});require("sticky-table-headers").initialize();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'nl.avisi.confluence.plugins.numberedheadings:nh-editor-events', location = 'js/nh-editor-events.js' */
/*
 * Copyright (c) 2022 Appfire Technologies, LLC.
 * All rights reserved.
 *
 * This software is licensed under the provisions of the "Appfire EULA"
 * (https://appfire.com/eula/) as well as under the provisions of
 * the "Standard EULA" from the "Atlassian Marketplace Terms of Use" as a "Marketplace Product"
 * (http://www.atlassian.com/licensing/marketplace/termsofuse).
 *
 * See the LICENSE file for more details.
 */

(function () {
  const AJS = require('ajs')
  const tinymce = require('tinymce')

  AJS.toInit(function ($) {
    function onEdit () {
      sendEvent('edit')
    }

    function onSave () {
      sendEvent('save')
    }

    function onCancel () {
      sendEvent('cancel')
    }

    AJS.bind('show.dialog', function (e, d) {
      if (d.dialog.id === 'macro-browser-dialog') {
        onEdit()
        $('#macro-details-page button.ok').on('click', onSave)
        $('#macro-details-page a.button-panel-cancel-link').on('click', onCancel)
      }
    })

    AJS.bind('hide.dialog', function (e, d) {
      if (d.dialog.id === 'macro-browser-dialog') {
        $('#macro-details-page button.ok').off('click', onSave)
        $('#macro-details-page a.button-panel-cancel-link').off('click', onCancel)
      }
    })
  })

  function sendEvent (action) {
    const macro = AJS.MacroBrowser.selectedMacroDefinition
    if (macro && macro.name === 'numberedheadings') {
      const macroId = AJS.$(tinymce.confluence.macrobrowser.getCurrentNode()).attr('data-macro-id')

      let url = AJS.contextPath() + '/rest/numberedheadings/1.0/event/macro-edit/' + AJS.params.pageId + '/' + macro.name + '/' + action + '?'
      url += 'isNew=' + !macroId
      if (macroId) { url += '&macroId=' + macroId }
      AJS.$.ajax({
        url: url,
        type: 'POST',
        data: JSON.stringify(macro.params),
        contentType: 'application/json; charset=utf-8',
        traditional: true,
        error: function (jqXHR) {
          AJS.log(jqXHR.responseText)
        }
      })
    }
  }
})()

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'nl.avisi.confluence.plugins.numberedheadings:split_vendors~nh-tinymce-plugin', location = 'vendors~nh-tinymce-plugin.273f3052385033bc5931.js' */
(window.atlassianWebpackJsonp981e0f4effab173567f2d6cf31d7b23b=window.atlassianWebpackJsonp981e0f4effab173567f2d6cf31d7b23b||[]).push([[13],[,,,function(e,t,o){var r=o(33),n="object"==typeof self&&self&&self.Object===Object&&self,a=r||n||Function("return this")();e.exports=a},,,function(e,t,o){var r=o(73),n=o(79);e.exports=function(e,t){var o=n(e,t);return r(o)?o:void 0}},function(e){e.exports=function(e){return null!=e&&"object"==typeof e}},,function(e){e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},function(e,t,o){function r(e){var t=-1,o=null==e?0:e.length;for(this.clear();++t<o;){var r=e[t];this.set(r[0],r[1])}}var n=o(63),a=o(64),p=o(65),s=o(66),c=o(67);r.prototype.clear=n,r.prototype["delete"]=a,r.prototype.get=p,r.prototype.has=s,r.prototype.set=c,e.exports=r},function(e,t,o){var r=o(19);e.exports=function(e,t){for(var o=e.length;o--;)if(r(e[o][0],t))return o;return-1}},function(e,t,o){function r(e){return null==e?void 0===e?c:s:l&&l in Object(e)?a(e):p(e)}var n=o(13),a=o(75),p=o(76),s="[object Null]",c="[object Undefined]",l=n?n.toStringTag:void 0;e.exports=r},function(e,t,o){var r=o(3),n=r.Symbol;e.exports=n},function(e,t,o){var r=o(6),n=r(Object,"create");e.exports=n},function(e,t,o){var r=o(88);e.exports=function(e,t){var o=e.__data__;return r(t)?o["string"==typeof t?"string":"hash"]:o.map}},function(e){var t=Array.isArray;e.exports=t},function(e,t,o){var r=o(110),n=o(20),a=o(111),p=o(112),s=o(113),c=o(12),l=o(34),i="[object Map]",y="[object Promise]",d="[object Set]",x="[object WeakMap]",b="[object DataView]",h=l(r),u=l(n),g=l(a),_=l(p),f=l(s),j=c;(r&&j(new r(new ArrayBuffer(1)))!=b||n&&j(new n)!=i||a&&j(a.resolve())!=y||p&&j(new p)!=d||s&&j(new s)!=x)&&(j=function(e){var t=c(e),o=t=="[object Object]"?e.constructor:void 0,r=o?l(o):"";if(r)switch(r){case h:return b;case u:return i;case g:return y;case _:return d;case f:return x;}return t}),e.exports=j},function(e,t,o){var r=o(47),n=o(48);e.exports=function(e,t,o,a){var p=!o;o||(o={});for(var s=-1,c=t.length;++s<c;){var l=t[s],i=a?a(o[l],e[l],l,o,e):void 0;i===void 0&&(i=e[l]),p?n(o,l,i):r(o,l,i)}return o}},function(e){e.exports=function(e,t){return e===t||e!==e&&t!==t}},function(e,t,o){var r=o(6),n=o(3),a=r(n,"Map");e.exports=a},function(e,t,o){var r=o(101),n=o(41),a=Object.prototype,p=a.propertyIsEnumerable,s=Object.getOwnPropertySymbols,c=s?function(e){return null==e?[]:(e=Object(e),r(s(e),function(t){return p.call(e,t)}))}:n;e.exports=c},function(e,t,o){var r=o(42),n=o(108),a=o(46);e.exports=function(e){return a(e)?r(e):n(e)}},function(e,t,o){(function(e){var r=o(3),n=o(105),a=t&&!t.nodeType&&t,p=a&&"object"==typeof e&&e&&!e.nodeType&&e,s=p&&p.exports===a,c=s?r.Buffer:void 0,l=c?c.isBuffer:void 0;e.exports=l||n}).call(this,o(24)(e))},function(e){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],!e.children&&(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e){e.exports=function(e){return function(t){return e(t)}}},function(e,t,o){(function(e){var r=o(33),n=t&&!t.nodeType&&t,a=n&&"object"==typeof e&&e&&!e.nodeType&&e,p=a&&a.exports===n,s=p&&r.process,c=function(){try{var e=a&&a.require&&a.require("util").types;return e?e:s&&s.binding&&s.binding("util")}catch(t){}}();e.exports=c}).call(this,o(24)(e))},function(e){var t=Object.prototype;e.exports=function(e){var o=e&&e.constructor,r="function"==typeof o&&o.prototype||t;return e===r}},function(e,t,o){var r=o(42),n=o(119),a=o(46);e.exports=function(e){return a(e)?r(e,!0):n(e)}},function(e,t,o){var r=o(37);e.exports=function(e){var t=new e.constructor(e.byteLength);return new r(t).set(new r(e)),t}},function(e,t,o){e.exports=o(60)},function(e,t,o){function r(e){var t=this.__data__=new n(e);this.size=t.size}var n=o(10),a=o(68),p=o(69),s=o(70),c=o(71),l=o(72);r.prototype.clear=a,r.prototype["delete"]=p,r.prototype.get=s,r.prototype.has=c,r.prototype.set=l,e.exports=r},function(e,t,o){var r=o(12),n=o(9);e.exports=function(e){if(!n(e))return!1;var t=r(e);return t=="[object Function]"||t=="[object GeneratorFunction]"||t=="[object AsyncFunction]"||t=="[object Proxy]"}},function(e,t,o){(function(t){var o="object"==typeof t&&t&&t.Object===Object&&t;e.exports=o}).call(this,o(74))},function(e){var t=Function.prototype,o=t.toString;e.exports=function(e){if(null!=e){try{return o.call(e)}catch(t){}try{return e+""}catch(t){}}return""}},function(e,t,o){function r(e){var t=-1,o=null==e?0:e.length;for(this.clear();++t<o;){var r=e[t];this.set(r[0],r[1])}}var n=o(80),a=o(87),p=o(89),s=o(90),c=o(91);r.prototype.clear=n,r.prototype["delete"]=a,r.prototype.get=p,r.prototype.has=s,r.prototype.set=c,e.exports=r},function(e,t,o){var r=o(92),n=o(95),a=o(96);e.exports=function(e,t,o,p,s,c){var l=o&1,i=e.length,y=t.length;if(i!=y&&!(l&&y>i))return!1;var d=c.get(e),x=c.get(t);if(d&&x)return d==t&&x==e;var b=-1,h=!0,u=o&2?new r:void 0;for(c.set(e,t),c.set(t,e);++b<i;){var g=e[b],_=t[b];if(p)var f=l?p(_,g,b,t,e,c):p(g,_,b,e,t,c);if(void 0!==f){if(f)continue;h=!1;break}if(u){if(!n(t,function(e,t){if(!a(u,t)&&(g===e||s(g,e,o,p,c)))return u.push(t)})){h=!1;break}}else if(!(g===_||s(g,_,o,p,c))){h=!1;break}}return c["delete"](e),c["delete"](t),h}},function(e,t,o){var r=o(3),n=r.Uint8Array;e.exports=n},function(e,t,o){var r=o(39),n=o(21),a=o(22);e.exports=function(e){return r(e,a,n)}},function(e,t,o){var r=o(40),n=o(16);e.exports=function(e,t,o){var a=t(e);return n(e)?a:r(a,o(e))}},function(e){e.exports=function(e,t){for(var o=-1,r=t.length,n=e.length;++o<r;)e[n+o]=t[o];return e}},function(e){e.exports=function(){return[]}},function(e,t,o){var r=o(102),n=o(103),a=o(16),p=o(23),s=o(106),c=o(43),l=Object.prototype,i=l.hasOwnProperty;e.exports=function(e,t){var o=a(e),l=!o&&n(e),y=!o&&!l&&p(e),d=!o&&!l&&!y&&c(e),x=o||l||y||d,b=x?r(e.length,String):[],h=b.length;for(var u in e)(t||i.call(e,u))&&!(x&&("length"==u||y&&("offset"==u||"parent"==u)||d&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||s(u,h)))&&b.push(u);return b}},function(e,t,o){var r=o(107),n=o(25),a=o(26),p=a&&a.isTypedArray,s=p?n(p):r;e.exports=s},function(e){e.exports=function(e){return"number"==typeof e&&-1<e&&0==e%1&&e<=9007199254740991}},function(e){e.exports=function(e,t){return function(o){return e(t(o))}}},function(e,t,o){var r=o(32),n=o(44);e.exports=function(e){return null!=e&&n(e.length)&&!r(e)}},function(e,t,o){function r(e,t,o){var r=e[t];s.call(e,t)&&a(r,o)&&(o!==void 0||t in e)||n(e,t,o)}var n=o(48),a=o(19),p=Object.prototype,s=p.hasOwnProperty;e.exports=r},function(e,t,o){var r=o(116);e.exports=function(e,t,o){"__proto__"==t&&r?r(e,t,{configurable:!0,enumerable:!0,value:o,writable:!0}):e[t]=o}},function(e,t,o){var r=o(40),n=o(50),a=o(21),p=o(41),s=Object.getOwnPropertySymbols,c=s?function(e){for(var t=[];e;)r(t,a(e)),e=n(e);return t}:p;e.exports=c},function(e,t,o){var r=o(45),n=r(Object.getPrototypeOf,Object);e.exports=n},,function(e){function t(e,t,o,r,n,a,p){try{var s=e[a](p),c=s.value}catch(e){return void o(e)}s.done?t(c):Promise.resolve(c).then(r,n)}e.exports=function(e){return function(){var o=this,r=arguments;return new Promise(function(n,a){function p(e){t(c,n,a,p,s,"next",e)}function s(e){t(c,n,a,p,s,"throw",e)}var c=e.apply(o,r);p(void 0)})}}},function(e,t,o){var r=o(61);e.exports=function(e,t){return r(e,t)}},function(e,t,o){var r=o(114);e.exports=function(e){return r(e,1|4)}},function(e){"use strict";function t(e){return"function"==typeof e?e():e}function o(){var e={};return e.promise=new Promise(function(t,o){e.resolve=t,e.reject=o}),e}e.exports=function(e){function r(){var t=s;clearTimeout(c),Promise.resolve(a.accumulate?e.call(this,l):e.apply(this,l[l.length-1])).then(t.resolve,t.reject),l=[],s=null}var n=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0,a=2<arguments.length&&arguments[2]!==void 0?arguments[2]:{},p=void 0,s=void 0,c=void 0,l=[];return function(){var i=t(n),y=new Date().getTime(),d=!p||y-p>i;p=y;for(var x=arguments.length,b=Array(x),h=0;h<x;h++)b[h]=arguments[h];if(d&&a.leading)return a.accumulate?Promise.resolve(e.call(this,[b])).then(function(e){return e[0]}):Promise.resolve(e.call.apply(e,[this].concat(b)));if(s?clearTimeout(c):s=o(),l.push(b),c=setTimeout(r.bind(this),i),a.accumulate){var u=l.length-1;return s.promise.then(function(e){return e[u]})}return s.promise}}},,,,,function(e){var t=function(e){"use strict";function t(e,t,o,n){var a=t&&t.prototype instanceof r?t:r,p=Object.create(a.prototype),s=new d(n||[]);return p._invoke=c(e,o,s),p}function o(e,t,o){try{return{type:"normal",arg:e.call(t,o)}}catch(e){return{type:"throw",arg:e}}}function r(){}function n(){}function a(){}function p(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function s(e){function t(r,n,a,p){var s=o(e[r],e,n);if("throw"===s.type)p(s.arg);else{var c=s.arg,l=c.value;return l&&"object"==typeof l&&u.call(l,"__await")?Promise.resolve(l.__await).then(function(e){t("next",e,a,p)},function(e){t("throw",e,a,p)}):Promise.resolve(l).then(function(e){c.value=e,a(c)},function(e){return t("throw",e,a,p)})}}function r(e,o){function r(){return new Promise(function(r,n){t(e,o,r,n)})}return n=n?n.then(r,r):r()}var n;this._invoke=r}function c(e,t,r){var n=m;return function(a,p){if(n===A)throw new Error("Generator is already running");if(n===S){if("throw"===a)throw p;return b()}for(r.method=a,r.arg=p;;){var s=r.delegate;if(s){var c=l(s,r);if(c){if(c===v)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===m)throw n=S,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=A;var i=o(e,t,r);if("normal"===i.type){if(n=r.done?S:w,i.arg===v)continue;return{value:i.arg,done:r.done}}"throw"===i.type&&(n=S,r.method="throw",r.arg=i.arg)}}}function l(e,t){var r=e.iterator[t.method];if(void 0===r){if(t.delegate=null,"throw"===t.method){if(e.iterator["return"]&&(t.method="return",t.arg=void 0,l(e,t),"throw"===t.method))return v;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var n=o(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,v;var a=n.arg;if(!a)return t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,v;if(a.done)t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0);else return a;return t.delegate=null,v}function i(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function y(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function d(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(i,this),this.reset(!0)}function x(e){if(e){var t=e[_];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,r=function t(){for(;++o<e.length;)if(u.call(e,o))return t.value=e[o],t.done=!1,t;return t.value=void 0,t.done=!0,t};return r.next=r}}return{next:b}}function b(){return{value:void 0,done:!0}}var h=Object.prototype,u=h.hasOwnProperty,g="function"==typeof Symbol?Symbol:{},_=g.iterator||"@@iterator",f=g.asyncIterator||"@@asyncIterator",j=g.toStringTag||"@@toStringTag";e.wrap=t;var m="suspendedStart",w="suspendedYield",A="executing",S="completed",v={},k={};k[_]=function(){return this};var L=Object.getPrototypeOf,O=L&&L(L(x([])));O&&O!==h&&u.call(O,_)&&(k=O);var E=a.prototype=r.prototype=Object.create(k);return n.prototype=E.constructor=a,a.constructor=n,a[j]=n.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===n||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,a):(e.__proto__=a,!(j in e)&&(e[j]="GeneratorFunction")),e.prototype=Object.create(E),e},e.awrap=function(e){return{__await:e}},p(s.prototype),s.prototype[f]=function(){return this},e.AsyncIterator=s,e.async=function(o,r,n,a){var p=new s(t(o,r,n,a));return e.isGeneratorFunction(r)?p:p.next().then(function(e){return e.done?e.value:p.next()})},p(E),E[j]="Generator",E[_]=function(){return this},E.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var o in e)t.push(o);return t.reverse(),function o(){for(;t.length;){var r=t.pop();if(r in e)return o.value=r,o.done=!1,o}return o.done=!0,o}},e.values=x,d.prototype={constructor:d,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(y),!e)for(var t in this)"t"===t.charAt(0)&&u.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0],t=e.completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){function t(t,r){return a.type="throw",a.arg=e,o.next=t,r&&(o.method="next",o.arg=void 0),!!r}if(this.done)throw e;for(var o=this,r=this.tryEntries.length-1;0<=r;--r){var n=this.tryEntries[r],a=n.completion;if("root"===n.tryLoc)return t("end");if(n.tryLoc<=this.prev){var p=u.call(n,"catchLoc"),s=u.call(n,"finallyLoc");if(p&&s){if(this.prev<n.catchLoc)return t(n.catchLoc,!0);if(this.prev<n.finallyLoc)return t(n.finallyLoc)}else if(p){if(this.prev<n.catchLoc)return t(n.catchLoc,!0);}else if(!s)throw new Error("try statement without catch or finally");else if(this.prev<n.finallyLoc)return t(n.finallyLoc)}}},abrupt:function(e,t){for(var o,r=this.tryEntries.length-1;0<=r;--r)if(o=this.tryEntries[r],o.tryLoc<=this.prev&&u.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var n=o;break}n&&("break"===e||"continue"===e)&&n.tryLoc<=t&&t<=n.finallyLoc&&(n=null);var a=n?n.completion:{};return a.type=e,a.arg=t,n?(this.method="next",this.next=n.finallyLoc,v):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t,o=this.tryEntries.length-1;0<=o;--o)if(t=this.tryEntries[o],t.finallyLoc===e)return this.complete(t.completion,t.afterLoc),y(t),v},catch:function(e){for(var t,o=this.tryEntries.length-1;0<=o;--o)if(t=this.tryEntries[o],t.tryLoc===e){var r=t.completion;if("throw"===r.type){var n=r.arg;y(t)}return n}throw new Error("illegal catch attempt")},delegateYield:function(e,t,o){return this.delegate={iterator:x(e),resultName:t,nextLoc:o},"next"===this.method&&(this.arg=void 0),v}},e}(e.exports);try{regeneratorRuntime=t}catch(e){Function("r","regeneratorRuntime = r")(t)}},function(e,t,o){function r(e,t,o,p,s){return!(e!==t)||(null!=e&&null!=t&&(a(e)||a(t))?n(e,t,o,p,r,s):e!==e&&t!==t)}var n=o(62),a=o(7);e.exports=r},function(e,t,o){var r=o(31),n=o(36),a=o(97),p=o(100),s=o(17),c=o(16),l=o(23),i=o(43),y="[object Arguments]",d="[object Array]",x="[object Object]",b=Object.prototype,h=b.hasOwnProperty;e.exports=function(e,t,o,b,u,g){var _=c(e),f=c(t),j=_?d:s(e),m=f?d:s(t);j=j==y?x:j,m=m==y?x:m;var w=j==x,A=m==x,S=j==m;if(S&&l(e)){if(!l(t))return!1;_=!0,w=!1}if(S&&!w)return g||(g=new r),_||i(e)?n(e,t,o,b,u,g):a(e,t,j,o,b,u,g);if(!(o&1)){var v=w&&h.call(e,"__wrapped__"),k=A&&h.call(t,"__wrapped__");if(v||k){var L=v?e.value():e,O=k?t.value():t;return g||(g=new r),u(L,O,o,b,g)}}return!!S&&(g||(g=new r),p(e,t,o,b,u,g))}},function(e){e.exports=function(){this.__data__=[],this.size=0}},function(e,t,o){var r=o(11),n=Array.prototype,a=n.splice;e.exports=function(e){var t=this.__data__,o=r(t,e);if(0>o)return!1;var n=t.length-1;return o==n?t.pop():a.call(t,o,1),--this.size,!0}},function(e,t,o){var r=o(11);e.exports=function(e){var t=this.__data__,o=r(t,e);return 0>o?void 0:t[o][1]}},function(e,t,o){var r=o(11);e.exports=function(e){return-1<r(this.__data__,e)}},function(e,t,o){var r=o(11);e.exports=function(e,t){var o=this.__data__,n=r(o,e);return 0>n?(++this.size,o.push([e,t])):o[n][1]=t,this}},function(e,t,o){var r=o(10);e.exports=function(){this.__data__=new r,this.size=0}},function(e){e.exports=function(e){var t=this.__data__,o=t["delete"](e);return this.size=t.size,o}},function(e){e.exports=function(e){return this.__data__.get(e)}},function(e){e.exports=function(e){return this.__data__.has(e)}},function(e,t,o){var r=o(10),n=o(20),a=o(35);e.exports=function(e,t){var o=this.__data__;if(o instanceof r){var p=o.__data__;if(!n||p.length<200-1)return p.push([e,t]),this.size=++o.size,this;o=this.__data__=new a(p)}return o.set(e,t),this.size=o.size,this}},function(e,t,o){var r=o(32),n=o(77),a=o(9),p=o(34),s=/[\\^$.*+?()[\]{}|]/g,c=/^\[object .+?Constructor\]$/,l=Function.prototype,i=Object.prototype,y=l.toString,d=i.hasOwnProperty,x=RegExp("^"+y.call(d).replace(s,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){if(!a(e)||n(e))return!1;var t=r(e)?x:c;return t.test(p(e))}},function(e){var t=function(){return this}();try{t=t||new Function("return this")()}catch(o){"object"==typeof window&&(t=window)}e.exports=t},function(e,t,o){var r=o(13),n=Object.prototype,a=n.hasOwnProperty,p=n.toString,s=r?r.toStringTag:void 0;e.exports=function(e){var t=a.call(e,s),o=e[s];try{e[s]=void 0}catch(t){}var r=p.call(e);return t?e[s]=o:delete e[s],r}},function(e){var t=Object.prototype,o=t.toString;e.exports=function(e){return o.call(e)}},function(e,t,o){function r(e){return!!a&&a in e}var n=o(78),a=function(){var e=/[^.]+$/.exec(n&&n.keys&&n.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();e.exports=r},function(e,t,o){var r=o(3),n=r["__core-js_shared__"];e.exports=n},function(e){e.exports=function(e,t){return null==e?void 0:e[t]}},function(e,t,o){var r=o(81),n=o(10),a=o(20);e.exports=function(){this.size=0,this.__data__={hash:new r,map:new(a||n),string:new r}}},function(e,t,o){function r(e){var t=-1,o=null==e?0:e.length;for(this.clear();++t<o;){var r=e[t];this.set(r[0],r[1])}}var n=o(82),a=o(83),p=o(84),s=o(85),c=o(86);r.prototype.clear=n,r.prototype["delete"]=a,r.prototype.get=p,r.prototype.has=s,r.prototype.set=c,e.exports=r},function(e,t,o){var r=o(14);e.exports=function(){this.__data__=r?r(null):{},this.size=0}},function(e){e.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},function(e,t,o){var r=o(14),n=Object.prototype,a=n.hasOwnProperty;e.exports=function(e){var t=this.__data__;if(r){var o=t[e];return o==="__lodash_hash_undefined__"?void 0:o}return a.call(t,e)?t[e]:void 0}},function(e,t,o){var r=o(14),n=Object.prototype,a=n.hasOwnProperty;e.exports=function(e){var t=this.__data__;return r?t[e]!==void 0:a.call(t,e)}},function(e,t,o){var r=o(14);e.exports=function(e,t){var o=this.__data__;return this.size+=this.has(e)?0:1,o[e]=r&&void 0===t?"__lodash_hash_undefined__":t,this}},function(e,t,o){var r=o(15);e.exports=function(e){var t=r(this,e)["delete"](e);return this.size-=t?1:0,t}},function(e){e.exports=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},function(e,t,o){var r=o(15);e.exports=function(e){return r(this,e).get(e)}},function(e,t,o){var r=o(15);e.exports=function(e){return r(this,e).has(e)}},function(e,t,o){var r=o(15);e.exports=function(e,t){var o=r(this,e),n=o.size;return o.set(e,t),this.size+=o.size==n?0:1,this}},function(e,t,o){function r(e){var t=-1,o=null==e?0:e.length;for(this.__data__=new n;++t<o;)this.add(e[t])}var n=o(35),a=o(93),p=o(94);r.prototype.add=r.prototype.push=a,r.prototype.has=p,e.exports=r},function(e){e.exports=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this}},function(e){e.exports=function(e){return this.__data__.has(e)}},function(e){e.exports=function(e,t){for(var o=-1,r=null==e?0:e.length;++o<r;)if(t(e[o],o,e))return!0;return!1}},function(e){e.exports=function(e,t){return e.has(t)}},function(e,t,o){var r=o(13),n=o(37),a=o(19),p=o(36),s=o(98),c=o(99),l=r?r.prototype:void 0,i=l?l.valueOf:void 0;e.exports=function(e,t,o,r,l,y,d){switch(o){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!!(e.byteLength==t.byteLength&&y(new n(e),new n(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return a(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var x=s;case"[object Set]":var b=r&1;if(x||(x=c),e.size!=t.size&&!b)return!1;var h=d.get(e);if(h)return h==t;r|=2,d.set(e,t);var u=p(x(e),x(t),r,l,y,d);return d["delete"](e),u;case"[object Symbol]":if(i)return i.call(e)==i.call(t);}return!1}},function(e){e.exports=function(e){var t=-1,o=Array(e.size);return e.forEach(function(e,r){o[++t]=[r,e]}),o}},function(e){e.exports=function(e){var t=-1,o=Array(e.size);return e.forEach(function(e){o[++t]=e}),o}},function(e,t,o){function r(e,t,o,r,p,c){var l=o&a,i=n(e),y=i.length,d=n(t),x=d.length;if(y!=x&&!l)return!1;for(var b,h=y;h--;)if(b=i[h],l?!(b in t):!s.call(t,b))return!1;var u=c.get(e),g=c.get(t);if(u&&g)return u==t&&g==e;var _=!0;c.set(e,t),c.set(t,e);for(var f=l;++h<y;){b=i[h];var j=e[b],m=t[b];if(r)var w=l?r(m,j,b,t,e,c):r(j,m,b,e,t,c);if(void 0===w?!(j===m||p(j,m,o,r,c)):!w){_=!1;break}f||(f="constructor"==b)}if(_&&!f){var A=e.constructor,S=t.constructor;A!=S&&"constructor"in e&&"constructor"in t&&!("function"==typeof A&&A instanceof A&&"function"==typeof S&&S instanceof S)&&(_=!1)}return c["delete"](e),c["delete"](t),_}var n=o(38),a=1,p=Object.prototype,s=p.hasOwnProperty;e.exports=r},function(e){e.exports=function(e,t){for(var o=-1,r=null==e?0:e.length,n=0,a=[];++o<r;){var p=e[o];t(p,o,e)&&(a[n++]=p)}return a}},function(e){e.exports=function(e,t){for(var o=-1,r=Array(e);++o<e;)r[o]=t(o);return r}},function(e,t,o){var r=o(104),n=o(7),a=Object.prototype,p=a.hasOwnProperty,s=a.propertyIsEnumerable,c=r(function(){return arguments}())?r:function(e){return n(e)&&p.call(e,"callee")&&!s.call(e,"callee")};e.exports=c},function(e,t,o){var r=o(12),n=o(7);e.exports=function(e){return n(e)&&r(e)=="[object Arguments]"}},function(e){e.exports=function(){return!1}},function(e){var t=/^(?:0|[1-9]\d*)$/;e.exports=function(e,o){var r=typeof e;return o=null==o?9007199254740991:o,!!o&&("number"==r||"symbol"!=r&&t.test(e))&&-1<e&&0==e%1&&e<o}},function(e,t,o){var r=o(12),n=o(44),a=o(7),p={};p["[object Float32Array]"]=p["[object Float64Array]"]=p["[object Int8Array]"]=p["[object Int16Array]"]=p["[object Int32Array]"]=p["[object Uint8Array]"]=p["[object Uint8ClampedArray]"]=p["[object Uint16Array]"]=p["[object Uint32Array]"]=!0,p["[object Arguments]"]=p["[object Array]"]=p["[object ArrayBuffer]"]=p["[object Boolean]"]=p["[object DataView]"]=p["[object Date]"]=p["[object Error]"]=p["[object Function]"]=p["[object Map]"]=p["[object Number]"]=p["[object Object]"]=p["[object RegExp]"]=p["[object Set]"]=p["[object String]"]=p["[object WeakMap]"]=!1,e.exports=function(e){return a(e)&&n(e.length)&&!!p[r(e)]}},function(e,t,o){var r=o(27),n=o(109),a=Object.prototype,p=a.hasOwnProperty;e.exports=function(e){if(!r(e))return n(e);var t=[];for(var o in Object(e))p.call(e,o)&&"constructor"!=o&&t.push(o);return t}},function(e,t,o){var r=o(45),n=r(Object.keys,Object);e.exports=n},function(e,t,o){var r=o(6),n=o(3),a=r(n,"DataView");e.exports=a},function(e,t,o){var r=o(6),n=o(3),a=r(n,"Promise");e.exports=a},function(e,t,o){var r=o(6),n=o(3),a=r(n,"Set");e.exports=a},function(e,t,o){var r=o(6),n=o(3),a=r(n,"WeakMap");e.exports=a},function(e,t,o){function r(e,t,o,F,U,M){var B,D=t&k,G=t&L;if(o&&(B=U?o(e,F,U,M):o(e)),void 0!==B)return B;if(!w(e))return e;var N=f(e);if(!N){var R=h(e),V=R==P||R==T;if(j(e))return l(e,D);if(R!=z&&R!=E&&(!V||U)){if(!I[R])return U?e:{};B=g(e,R,D)}else if(B=G||V?{}:_(e),!D)return G?d(e,c(B,e)):y(e,s(B,e))}else if(B=u(e),!D)return i(e,B);M||(M=new n);var W=M.get(e);if(W)return W;M.set(e,B),A(e)?e.forEach(function(n){B.add(r(n,t,o,n,e,M))}):m(e)&&e.forEach(function(n,a){B.set(a,r(n,t,o,a,e,M))});var C=t&O?G?b:x:G?v:S,$=N?void 0:C(e);return a($||e,function(n,a){$&&(a=n,n=e[a]),p(B,a,r(n,t,o,a,e,M))}),B}var n=o(31),a=o(115),p=o(47),s=o(117),c=o(118),l=o(121),i=o(122),y=o(123),d=o(124),x=o(38),b=o(125),h=o(17),u=o(126),g=o(127),_=o(132),f=o(16),j=o(23),m=o(134),w=o(9),A=o(136),S=o(22),v=o(28),k=1,L=2,O=4,E="[object Arguments]",P="[object Function]",T="[object GeneratorFunction]",z="[object Object]",I={};I[E]=I["[object Array]"]=I["[object ArrayBuffer]"]=I["[object DataView]"]=I["[object Boolean]"]=I["[object Date]"]=I["[object Float32Array]"]=I["[object Float64Array]"]=I["[object Int8Array]"]=I["[object Int16Array]"]=I["[object Int32Array]"]=I["[object Map]"]=I["[object Number]"]=I[z]=I["[object RegExp]"]=I["[object Set]"]=I["[object String]"]=I["[object Symbol]"]=I["[object Uint8Array]"]=I["[object Uint8ClampedArray]"]=I["[object Uint16Array]"]=I["[object Uint32Array]"]=!0,I["[object Error]"]=I[P]=I["[object WeakMap]"]=!1,e.exports=r},function(e){e.exports=function(e,t){for(var o=-1,r=null==e?0:e.length;++o<r&&!(!1===t(e[o],o,e)););return e}},function(e,t,o){var r=o(6),n=function(){try{var e=r(Object,"defineProperty");return e({},"",{}),e}catch(t){}}();e.exports=n},function(e,t,o){var r=o(18),n=o(22);e.exports=function(e,t){return e&&r(t,n(t),e)}},function(e,t,o){var r=o(18),n=o(28);e.exports=function(e,t){return e&&r(t,n(t),e)}},function(e,t,o){var r=o(9),n=o(27),a=o(120),p=Object.prototype,s=p.hasOwnProperty;e.exports=function(e){if(!r(e))return a(e);var t=n(e),o=[];for(var p in e)("constructor"!=p||!t&&s.call(e,p))&&o.push(p);return o}},function(e){e.exports=function(e){var t=[];if(null!=e)for(var o in Object(e))t.push(o);return t}},function(e,t,o){(function(e){var r=o(3),n=t&&!t.nodeType&&t,a=n&&"object"==typeof e&&e&&!e.nodeType&&e,p=a&&a.exports===n,s=p?r.Buffer:void 0,c=s?s.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var o=e.length,r=c?c(o):new e.constructor(o);return e.copy(r),r}}).call(this,o(24)(e))},function(e){e.exports=function(e,t){var o=-1,r=e.length;for(t||(t=Array(r));++o<r;)t[o]=e[o];return t}},function(e,t,o){var r=o(18),n=o(21);e.exports=function(e,t){return r(e,n(e),t)}},function(e,t,o){var r=o(18),n=o(49);e.exports=function(e,t){return r(e,n(e),t)}},function(e,t,o){var r=o(39),n=o(49),a=o(28);e.exports=function(e){return r(e,a,n)}},function(e){var t=Object.prototype,o=t.hasOwnProperty;e.exports=function(e){var t=e.length,r=new e.constructor(t);return t&&"string"==typeof e[0]&&o.call(e,"index")&&(r.index=e.index,r.input=e.input),r}},function(e,t,o){var r=o(29),n=o(128),a=o(129),p=o(130),s=o(131);e.exports=function(e,t,o){var c=e.constructor;return t==="[object ArrayBuffer]"?r(e):t==="[object Boolean]"||t==="[object Date]"?new c(+e):t==="[object DataView]"?n(e,o):t==="[object Float32Array]"||t==="[object Float64Array]"||t==="[object Int8Array]"||t==="[object Int16Array]"||t==="[object Int32Array]"||t==="[object Uint8Array]"||t==="[object Uint8ClampedArray]"||t==="[object Uint16Array]"||t==="[object Uint32Array]"?s(e,o):t==="[object Map]"?new c:t==="[object Number]"||t==="[object String]"?new c(e):t==="[object RegExp]"?a(e):t==="[object Set]"?new c:t==="[object Symbol]"?p(e):void 0}},function(e,t,o){var r=o(29);e.exports=function(e,t){var o=t?r(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.byteLength)}},function(e){var t=/\w*$/;e.exports=function(e){var o=new e.constructor(e.source,t.exec(e));return o.lastIndex=e.lastIndex,o}},function(e,t,o){var r=o(13),n=r?r.prototype:void 0,a=n?n.valueOf:void 0;e.exports=function(e){return a?Object(a.call(e)):{}}},function(e,t,o){var r=o(29);e.exports=function(e,t){var o=t?r(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.length)}},function(e,t,o){var r=o(133),n=o(50),a=o(27);e.exports=function(e){return"function"!=typeof e.constructor||a(e)?{}:r(n(e))}},function(e,t,o){var r=o(9),n=Object.create,a=function(){function e(){}return function(t){if(!r(t))return{};if(n)return n(t);e.prototype=t;var o=new e;return e.prototype=void 0,o}}();e.exports=a},function(e,t,o){var r=o(135),n=o(25),a=o(26),p=a&&a.isMap,s=p?n(p):r;e.exports=s},function(e,t,o){var r=o(17),n=o(7);e.exports=function(e){return n(e)&&r(e)=="[object Map]"}},function(e,t,o){var r=o(137),n=o(25),a=o(26),p=a&&a.isSet,s=p?n(p):r;e.exports=s},function(e,t,o){var r=o(17),n=o(7);e.exports=function(e){return n(e)&&r(e)=="[object Set]"}}]]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'nl.avisi.confluence.plugins.numberedheadings:split_nh-config~nh-editor-events~nh-macro-browser-plugin~nh-space-tools~nh-tinymce-plugin', location = 'nh-config~nh-editor-events~nh-macro-browser-plugin~nh-space-tools~nh-tinymce-plugin.b4484b36a96394141796.js' */
(window.atlassianWebpackJsonp981e0f4effab173567f2d6cf31d7b23b=window.atlassianWebpackJsonp981e0f4effab173567f2d6cf31d7b23b||[]).push([[0],{2:function(a){a.exports=require("ajs")}}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'nl.avisi.confluence.plugins.numberedheadings:split_nh-space-tools~nh-tinymce-plugin', location = 'nh-space-tools~nh-tinymce-plugin.f69fd458b86e7ded4b07.js' */
(window.atlassianWebpackJsonp981e0f4effab173567f2d6cf31d7b23b=window.atlassianWebpackJsonp981e0f4effab173567f2d6cf31d7b23b||[]).push([[2],[function(a){a.exports=require("jquery")},function(a){a.exports=WRM.format},,,,function(a){a.exports=require("aui/flag")},,,function(a){a.exports=WRM.contextPath}]]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'nl.avisi.confluence.plugins.numberedheadings:split_nh-editor-events~nh-tinymce-plugin', location = 'nh-editor-events~nh-tinymce-plugin.b46caada78ed20c135c9.js' */
(window.atlassianWebpackJsonp981e0f4effab173567f2d6cf31d7b23b=window.atlassianWebpackJsonp981e0f4effab173567f2d6cf31d7b23b||[]).push([[1],{4:function(a){a.exports=require("tinymce")}}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'nl.avisi.confluence.plugins.numberedheadings:split_nh-tinymce-plugin', location = 'nh-tinymce-plugin.526f2c199f430168ffb1.js' */
(window.atlassianWebpackJsonp981e0f4effab173567f2d6cf31d7b23b=window.atlassianWebpackJsonp981e0f4effab173567f2d6cf31d7b23b||[]).push([[7],{144:function(a,b,c){"use strict";function d(a){return a.toString().replace(/\//g,"")}function e(a,b){return"value=\"".concat(b,"\" ").concat(a===b?"selected":"")}function f(a){var b=a.numberFormatField,c=a.startingHeadingField,f=a.startingNumberField,g=a.skipHeadingField;return"<form class=\"aui\" id=\"nh-format-options-form\">\n    <div class=\"field-group\">\n        <label for=\"nh-numberFormatField\">".concat("Number format","</label>\n        <select class=\"select\" id=\"nh-numberFormatField\" name=\"numberFormatField\">\n            <option ").concat(e(b,"decimal"),">").concat("decimal","</option>\n            <option ").concat(e(b,"iso-2145"),">").concat("iso-2145","</option>\n            <option ").concat(e(b,"full-decimal"),">").concat("full-decimal","</option>\n            <option ").concat(e(b,"lower-latin"),">").concat("lower-latin","</option>\n            <option ").concat(e(b,"lower-roman"),">").concat("lower-roman","</option>\n            <option ").concat(e(b,"lower-greek"),">").concat("lower-greek","</option>\n            <option ").concat(e(b,"upper-latin"),">").concat("upper-latin","</option>\n            <option ").concat(e(b,"upper-roman"),">").concat("upper-roman","</option>\n            <option ").concat(e(b,"upper-greek"),">").concat("upper-greek","</option>\n            <option ").concat(e(b,"custom"),">").concat("custom","</option>\n        </select>\n    </div>\n    <div class=\"field-group\">\n        <label for=\"nh-startingNumberField\">").concat("Starting number","</label>\n        <input class=\"text full-width-field\" type=\"text\"\n               id=\"nh-startingNumberField\" name=\"startingNumberField\" value=\"").concat(f,"\"\n               data-aui-validation-when=\"aui-stop-typing\" pattern=\"").concat(d(P),"\"\n               data-aui-validation-pattern-msg=\"").concat("Starting number","\">\n    </div>\n    <div class=\"field-group\">\n        <label for=\"nh-startingHeadingField\">").concat("Starting heading","</label>\n        <select class=\"select\" id=\"nh-startingHeadingField\" name=\"startingHeadingField\">\n            <option ").concat(e(c,"H1"),">H1</option>\n            <option ").concat(e(c,"H2"),">H2</option>\n            <option ").concat(e(c,"H3"),">H3</option>\n            <option ").concat(e(c,"H4"),">H4</option>\n            <option ").concat(e(c,"H5"),">H5</option>\n            <option ").concat(e(c,"H6"),">H6</option>\n        </select>\n    </div>\n    <div class=\"field-group\">\n        <label for=\"nh-skipHeadingField\">").concat("Skip headings","</label>\n        <input class=\"text full-width-field\" type=\"text\"\n               id=\"nh-skipHeadingField\" name=\"skipHeadingField\" value=\"").concat(g,"\"\n               data-aui-validation-when=\"aui-stop-typing\" pattern=\"").concat(d(Q),"\"\n               data-aui-validation-pattern-msg=\"").concat("Should be comma separated: H3, H5","\">\n        <div class=\"description\">").concat("Comma separated: H3, H5","</div>\n    </div>\n    <div class=\"toolbar-trigger-dialog-hidden\" style=\"display:none;\">\n        <br>\n        <h4>").concat("Custom number format","</h4>\n        <p>").concat("Define custom formatting per heading. Note: empty options will not render anything.","&nbsp;\n            <a data-aui-trigger aria-controls=\"nh-trigger-formatting-options\" href=\"#nh-trigger-formatting-options\">").concat("Formatting options","</a>.\n        </p>\n        <aui-inline-dialog id=\"nh-trigger-formatting-options\" alignment=\"right middle\">\n            <div class=\"format-options-styling\">\n                <h2>").concat("Formatting options","</h2>\n                <ul>\n                    <li>decimal</li>\n                    <li>iso-2145</li>\n                    <li>full-decimal</li>\n                    <li>lower-latin</li>\n                    <li>lower-roman</li>\n                    <li>lower-greek</li>\n                    <li>upper-latin</li>\n                    <li>upper-roman</li>\n                    <li>upper-greek</li>\n                    <li>custom</li>\n                </ul>\n                <h2>").concat("Examples","</h2>\n                <h3>").concat("Heading 1","</h3>\n                <span class=\"toolbar-trigger-formatting-options-code\">\n                                <code>").concat("Chapter [h1.decimal]","</code>\n                            </span>\n                <p>").concat("Results in Chapter 1, Chapter 2, etc.","</p>\n                <h3>").concat("Heading 2","</h3>\n                <span class=\"toolbar-trigger-formatting-options-code\">\n                                <code>").concat("[h1.decimal].[h2.upper-latin]","</code>\n                            </span>\n                <p>").concat("Results in 1.A, 1.B, 2.A, 2.B, etc.","</p>\n            </div>\n        </aui-inline-dialog>\n\n        <div class=\"field-group\">\n            <label for=\"nh-customFormatFieldH1\">").concat("H1 format","</label>\n            <input class=\"text full-width-field\" type=\"text\"\n                   id=\"nh-customFormatFieldH1\" name=\"customFormatFieldH1\" value=\"").concat(a.customFormatFieldH1,"\">\n        </div>\n        <div class=\"field-group\">\n            <label for=\"nh-customFormatFieldH2\">").concat("H2 format","</label>\n            <input class=\"text full-width-field\" type=\"text\"\n                   id=\"nh-customFormatFieldH2\" name=\"customFormatFieldH2\" value=\"").concat(a.customFormatFieldH2,"\">\n        </div>\n        <div class=\"field-group\">\n            <label for=\"nh-customFormatFieldH3\">").concat("H3 format","</label>\n            <input class=\"text full-width-field\" type=\"text\"\n                   id=\"nh-customFormatFieldH3\" name=\"customFormatFieldH3\" value=\"").concat(a.customFormatFieldH3,"\">\n        </div>\n        <div class=\"field-group\">\n            <label for=\"nh-customFormatFieldH4\">").concat("H4 format","</label>\n            <input class=\"text full-width-field\" type=\"text\"\n                   id=\"nh-customFormatFieldH4\" name=\"customFormatFieldH4\" value=\"").concat(a.customFormatFieldH4,"\">\n        </div>\n        <div class=\"field-group\">\n            <label for=\"nh-customFormatFieldH5\">").concat("H5 format","</label>\n            <input class=\"text full-width-field\" type=\"text\"\n                   id=\"nh-customFormatFieldH5\" name=\"customFormatFieldH5\" value=\"").concat(a.customFormatFieldH5,"\">\n        </div>\n        <div class=\"field-group\">\n            <label for=\"nh-customFormatFieldH6\">").concat("H6 format","</label>\n            <input class=\"text full-width-field\" type=\"text\"\n                   id=\"nh-customFormatFieldH6\" name=\"customFormatFieldH6\" value=\"").concat(a.customFormatFieldH6,"\">\n        </div>\n    </div>\n</form>")}function g(a,b){var c={lastLevel:0,startAt:0,counts:[0,0,0,0,0,0]},d=b.startingHeadingField;c.startAt=void 0===d?0:d[1]-1;var e=b.startingNumberField;if(e!==void 0)for(var f,g=e.split(","),j=0;j<g.length;j++)f=parseInt(g[j],10),isNaN(f)||(c.counts[c.startAt+j]=f-1);G()(a).find("h1, h2, h3, h4, h5, h6").filter(function(b,c){var d=G()(c).parents("table[data-macro-name=numberedheadings]");return 0===d.size()||d.is(a)}).each(function(a,d){h(d.nodeName[1],b)?i(c,d,b):k(d)})}function h(a,b){var c=b.skipHeadingField;if(!c)return!0;a=parseInt(a,10);for(var d,e=c.split(","),f=0;f<e.length;f++)if(d=parseInt(G.a.trim(e[f])[1],10),d===a)return!1;return!0}function j(a,b){for(var c=b;6>c;c++)a.counts[c]=0}function i(a,b,c){var d=a.lastLevel,e=a.startAt,f=a.counts,g=c.numberFormatField||"decimal",k=Y[g],l=b.nodeName[1],m="";if(l>=e+1){d>l&&j(a,l),a.counts[l-1]++;for(var n=e;n<l;n++)h(n+1,c)&&n+1>d&&n+1<l&&(a.counts[n]=f[n]+1);if("custom"===g){for(var i=[],o=1;7>o;o++)i[o-1]=c["customFormatFieldH"+o]||"";m+=k.format(a,l,i)}else for(var p=e;p<l;p++)h(p+1,c)&&(m+=k.format(a,f[p]),(!k.shouldRenderSeparator||k.shouldRenderSeparator(p+1>=l))&&(m+="."));0<m.length&&(m+=" "),a.lastLevel=l}G()(b).attr("data-nh-numbering",m)}function k(a){G()(a).removeAttr("data-nh-numbering")}function l(a){G()(a).find("h1, h2, h3, h4, h5, h6").each(function(a,b){k(b)})}function m(a){var b=G()(a).attr("data-macro-parameters"),c={"number-format":"decimal"};if(b!==void 0)for(var d,e=n(b),f=0;f<e.length;f++)d=e[f].split("="),c[Z[d[0]]]=d[1];return c}function n(a){for(var b=o(a).split(/\|(?!\\)/),c=0;c<b.length;c++){b[c]=o(b[c]);var d=b[c].indexOf("\\|");d!==void 0&&(b[c]=b[c].substring(0,d)+b[c].substring(d+1,b[c].length))}return b}function o(a){return a.split("").reverse().join("")}function p(a){return new Promise(function(b){setTimeout(function(){return b()},a)})}function q(a){var b=G.a.get(_()()+"/rest/numberedheadings/1.0/page-configuration/"+a);return Promise.resolve(b).then(function(a){return qa=a,a})}function r(){G()("#wysiwygTextarea_ifr").contents().find("table[data-macro-name=numberedheadings]").each(function(a,b){g(b,m(b))})}function s(){if(qa.spaceNumbering.isEnabled&&!qa.pageNumbering.overrideSpaceNumbering){var a=qa,b=a.spaceNumbering;return b}var c=qa,d=c.pageNumbering;return d}function t(){G()("#wysiwygTextarea_ifr").contents().each(function(a,b){(qa.pageNumbering.isEnabled||qa.spaceNumbering.isEnabled)&&(qa.pageNumbering.isEnabled||!qa.pageNumbering.overrideSpaceNumbering)&&K?(g(b,s()),(ra.isButtonEnabled||qa.pageNumbering.isEnabled||qa.spaceNumbering.isEnabled&&!qa.pageNumbering.isEnabled)&&(G()("#rte-numbered-headings-button").addClass("active"),G()("#rte-numbering-button-control").addClass("active")),ra.isTriggerEnabled?G()("#rte-numbered-headings-button-trigger").addClass("active"):!ra.isTriggerEnabled&&G()("#rte-numbered-headings-button-trigger").removeClass("active")):(l(b),G()("#rte-numbered-headings-button").removeClass("active"),G()("#rte-numbering-button-control").removeClass("active"),G()("#rte-numbered-headings-button-trigger").removeClass("active")),r()})}function u(a){if(1===a.nodeType){var b=a.tagName.toLowerCase();if(/^h[1-6]$/.test(b))return!0;if(-1<G.a.inArray(b,["span","strong","em","u","s","sub","sup","code"]))return u(a.parentElement)}return!1}function v(){ra.isTriggerEnabled=!1}function w(){var a=G()("#nh-format-options-form");a.replaceWith(f(qa.pageNumbering))}function x(){var a=G()("#nh-numberFormatField");"custom"===qa.pageNumbering.numberFormatField&&G()(".toolbar-trigger-dialog-hidden").show(),a.on("change",function(){"custom"===G()(this).val()?G()(".toolbar-trigger-dialog-hidden").show():G()(".toolbar-trigger-dialog-hidden").hide()})}function y(){function a(){var a=b.serializeArray(),c=a.reduce(function(a,b){return a[b.name]=b.value,a},{});c.isEnabled=!0,ra.isButtonEnabled=!0,ra.isTriggerEnabled=!0,c.startingNumberField!==void 0&&P.test(c.startingNumberField)||(c.startingNumberField="1"),c.skipHeadingField!==void 0&&Q.test(c.skipHeadingField)||(c.skipHeadingField=""),qa.pageNumbering.overrideSpaceNumbering&&(c.overrideSpaceNumbering=!0),la()(qa.pageNumbering,c)||(qa.pageNumbering=c,t(),sa(!0))}var b=G()("#nh-format-options-form"),c=G()("#nh-startingNumberField"),d=G()("#nh-skipHeadingField");b.on("change",a),c.on("keyup",a),d.on("keyup",a)}function z(){return G()("#rte-numbered-headings-button")}function A(){return G()("#rte-numbered-headings-button-trigger")}function B(a){return"page"===a||"blogpost"===a}function C(){if(r(),0!==G()(".rte-toolbar-group-formatting").length){var a=G()(".rte-toolbar-group-formatting").first();if(G()("#rte-numbering-button-control").remove(),!K)return void a.append(W);if(!0===S.a.params.newPage&&!1===S.a.params.collaborativeContent)return void a.append(V);a.append(X),G()(".anti-flicker").css("display",""),document.getElementById("nh-page-numbering-configuration-dialog").addEventListener("aui-hide",v);var b=z(),c=A();if(t(),w(),y(),x(),b.click(function(a){a.preventDefault(),qa.spaceNumbering.isEnabled&&(qa.pageNumbering.isEnabled||qa.pageNumbering.overrideSpaceNumbering?(qa.pageNumbering.isEnabled=!qa.pageNumbering.isEnabled,ra.isButtonEnabled=!ra.isButtonEnabled):(qa.pageNumbering.overrideSpaceNumbering=!0,qa.pageNumbering.isEnabled=!1)),qa.spaceNumbering.isEnabled||(ra.isButtonEnabled||ra.isTriggerEnabled||""!==qa.pageNumbering.numberFormatField?(qa.pageNumbering.isEnabled=!qa.pageNumbering.isEnabled,ra.isButtonEnabled=!ra.isButtonEnabled):(qa.pageNumbering.isEnabled=!qa.pageNumbering.isEnabled,ra.isButtonEnabled=!ra.isButtonEnabled,qa.pageNumbering.numberFormatField="decimal",qa.pageNumbering.startingHeadingField="H1")),t(),sa(!1)}),c.click(function(a){qa.spaceNumbering.isEnabled&&(qa.pageNumbering.overrideSpaceNumbering=!0),G()("#nh-format-options-form input[data-aui-validation-novalidate]").attr("data-aui-validation-field",""),G()("#nh-format-options-form input[data-aui-validation-novalidate]").removeAttr("data-aui-validation-novalidate");var b=document.getElementById("nh-page-numbering-configuration-dialog");b.open=!b.open,ra.isTriggerEnabled=!!b.open,b.open&&(qa.pageNumbering.isEnabled=!0,ra.isButtonEnabled=!0),a.preventDefault(),t(),sa(!0)}),7>=L&&!M&&ra.isTriggerEnabled&&K){var d="Your Numbered Headings evaluation is about to end. There ";1===L||0===L?d+="is 1 day left to start your subscription.":d=d+"are "+L+" days left to start your subscription.",ba()({type:"warning",body:d,close:"manual"})}}}function D(a){return new Promise(function(b){if("3"===ja.a.majorVersion)var c=a.onInit.add(function(d){b(d),a.onEvent.remove(c)});else a.once("init",function(a){b(a)})})}function E(){return S.a.params.synchronyAppId&&0<S.a.params.synchronyAppId.length}c.r(b);var F=c(0),G=c.n(F),H=c(51),I=c.n(H);window.nhLicenseStatus||(window.nhLicenseStatus=I.a.claim("nl.avisi.confluence.plugins.numberedheadings:nh-license-data.license-status"));var J=window.nhLicenseStatus,K=J.active||!1,L=J.expiresInDays||0,M=J.subscription||!1,N=c(57),O=c(58),P=/(^[0-9]+(, ?[0-9]+)*$)/,Q=/(^H[1-6]+(, ?H[1-6])*$)/,R=c(2),S=c.n(R),T=c(1),U="7.6.0">S.a.version?"pre-ajs-7-6-0":"post-ajs-7-6-0",V=" <li class=\"nh-hotreload-element toolbar-item aui-button aui-button-subtle rte-numbered-headings-button ".concat(U,"\"\n    id=\"rte-numbering-button-control\"\n    data-tooltip=\"Cannot enable Numbered Headings on new pages when collaborative editing is disabled. After saving this page you can enable Numbered Headings.\" data-aui-trigger>\n    <a class=\"toolbar-trigger ").concat(U,"\" id=\"rte-numbered-headings\"><span class=\"nh-button-icon\"></a>\n</li>\n"),W="<li class=\"nh-hotreload-element toolbar-item aui-button aui-button-subtle rte-numbered-headings-button ".concat(U,"\"\n    id=\"rte-numbering-button-control\"\n    data-tooltip=\"Number headings\" aria-controls=\"buy-nh\" href=\"#buy-nh\" data-aui-trigger>\n    <a class=\"toolbar-trigger ").concat(U,"\" id=\"rte-numbered-headings\"><span class=\"nh-button-icon\"></a>\n\n    <!-- Wrap the dialogs in a display none so they don't flicker for half a second while initializing-->\n    <div class=\"anti-flicker\" style=\"display: none\">\n      <aui-inline-dialog class=\"nh-hotreload-element\" alignment=\"bottom left\" id=\"buy-nh\" class=\"aui-help\">\n          <h2>Number your headings</h2>\n          <p>Number all headings on this page with the click of a button.<br/>This button is part of Numbered\n              Headings Pro.</p>\n          <p>Try Numbered Headings Pro free for 30 days.<br/>Ask your admin to start your Numbered Headings trial.\n          </p>\n      </aui-inline-dialog>\n    </div>\n</li>\n"),X="<li class=\"nh-hotreload-element toolbar-item toolbar-splitbutton ".concat(U,"\" id=\"rte-numbering-button-control\">\n    <a class=\"toolbar-trigger aui-button rte-numbered-headings-button ").concat(U,"\"\n       aria-haspopup=\"true\" aria-controls=\"nh-space-wide-numbering\"\n       id=\"rte-numbered-headings-button\"\n       data-tooltip=\"Number headings\"><span class=\"nh-button-icon\"></span></a>\n        \n    <div class=\"aui-dd-parent dd-allocated\">\n        <a class=\"toolbar-trigger aui-dd-trigger aui-button rte-numbered-headings-button-trigger ").concat(U,"\"\n           aria-haspopup=\"true\" aria-controls=\"nh-page-numbering-configuration-dialog\"\n           id=\"rte-numbered-headings-button-trigger\"\n           data-tooltip=\"").concat("More formatting options","\">\n            <span class=\"icon aui-icon aui-icon-small aui-iconfont-dropdown\"></span>\n        </a>\n    </div>\n    \n    <!-- Wrap the dialogs in a display none so they don't flicker for half a second while initializing-->\n    <div class=\"anti-flicker\" style=\"display: none\">\n      <aui-inline-dialog alignment=\"bottom left\" id=\"nh-page-numbering-configuration-dialog\" class=\"nh-hotreload-element aui-info trigger-dialog-style\">\n          <h3>").concat("Numbered Headings options","</h3>\n          <div id=\"nh-format-options-form\">\n              <p>").concat("Numbered Headings options","</p>\n          </div>\n      </aui-inline-dialog>\n    </div>\n</li>"),Y={decimal:{format:function(a,b){return b}},"iso-2145":{format:function(a,b){return Y.decimal.format(a,b)},shouldRenderSeparator:function(a){return!a}},"full-decimal":{lowNumbers:["zero","one","two","three","four","five","six","seven","eight","nine","ten","eleven","twelve","thirteen","fourteen","fifteen","sixteen","seventeen","eighteen","nineteen"],highNumbers:["","","twenty","thirty","forty","fifty","sixty","seventy","eighty","ninety"],format:function(a,b){if(b>this.lowNumbers.length-1){b=b.toString();var c=b[0],d=b[1],e=this.highNumbers[c];return 0<d&&(e+="-",e+=this.lowNumbers[d]),e}return this.lowNumbers[b]}},"lower-latin":{range:["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],format:function(a,b){return this.range[b-1]}},"upper-latin":{format:function(a,b){var c=Y["lower-latin"].format(a,b);return c.toUpperCase()}},"lower-greek":{range:["\u03B1","\u03B2","\u03B3","\u03B4","\u03B5","\u03B6","\u03B7","\u03B8","\u03B9","\u03BA","\u03BB","\u03BC","\u03BD","\u03BE","\u03BF","\u03C0","\u03C1","\u03C3","\u03C4","\u03C5","\u03C6","\u03C7","\u03C8","\u03C9"],format:function(a,b){return this.range[b-1]}},"upper-greek":{range:["\u0391","\u0392","\u0393","\u0394","\u0395","\u0396","\u0397","\u0398","\u0399","\u039A","\u039B","\u039C","\u039D","\u039E","\u039F","\u03A0","\u03A1","\u03A3","\u03A4","\u03A5","\u03A6","\u03A7","\u03A8","\u03A9"],format:function(a,b){return this.range[b-1]}},"lower-roman":{format:function(a,b){var c=Y["upper-roman"].format(a,b);return c.toLowerCase()}},"upper-roman":{units:["","I","II","III","IV","V","VI","VII","VIII","IX"],tens:["","X","XX","XXX","XL","L","LX","LXX","LXXX","XC"],hundreds:["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM"],format:function(a,b){return(this.hundreds[b/100]||"")+(this.tens[b/10]||"")+(this.units[b]||"")}},custom:{customFormatterRegex:/(\[h[1-6].[a-zA-Z0-9-]+\])/,parseCustomFormat:function(a,b){return b[a-1].split(this.customFormatterRegex)},format:function(a,b,c){for(var d,e=a.startAt,f=a.counts,g=this.parseCustomFormat(b,c),h="",j=0;j<g.length;j++)if(d=g[j],this.customFormatterRegex.test(d)){var i=d[2];if(i>=e+1&&i<=b){var k=d.substring(4,d.length-1);if("custom"!==k){var l=Y[k]||Y.decimal,m=f[i-1];h+=l.format(a,m)}}}else h+=d;return h}}},Z={"number-format":"numberFormatField","start-numbering-with":"startingNumberField","start-numbering-at":"startingHeadingField","skip-headings":"skipHeadingField",h1:"customFormatFieldH1",h2:"customFormatFieldH2",h3:"customFormatFieldH3",h4:"customFormatFieldH4",h5:"customFormatFieldH5",h6:"customFormatFieldH6"},$=c(8),_=c.n($),aa=c(5),ba=c.n(aa),ca=c(59),da=c(30),ea=c.n(da),fa=c(52),ga=c.n(fa),ha=function(){var a=ga()(ea.a.mark(function a(b,c,d,e){var f,g,h;return ea.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:f=0,g=!1,h=function(){return!0===b()||f>=e};case 3:return++f,h()&&(g=!0,c()),a.next=7,p(d);case 7:if(!g){a.next=3;break}case 8:case"end":return a.stop();}},a)}));return function(){return a.apply(this,arguments)}}(),ia=c(4),ja=c.n(ia),ka=c(53),la=c.n(ka),ma=c(54),na=c.n(ma),oa=c(55),pa=c.n(oa),qa={spaceNumbering:{isEnabled:!1,numberFormatField:"",startingNumberField:"",startingHeadingField:"",skipHeadingField:"",customFormatFieldH1:"",customFormatFieldH2:"",customFormatFieldH3:"",customFormatFieldH4:"",customFormatFieldH5:"",customFormatFieldH6:""},pageNumbering:{isEnabled:!1,overrideSpaceNumbering:!1,numberFormatField:"",startingNumberField:"",startingHeadingField:"",skipHeadingField:"",customFormatFieldH1:"",customFormatFieldH2:"",customFormatFieldH3:"",customFormatFieldH4:"",customFormatFieldH5:"",customFormatFieldH6:""}},ra={isButtonEnabled:!1,isTriggerEnabled:!1},sa=pa()(function(a){return new Promise(function(b,c){var d=na()(qa.pageNumbering);G.a.ajax({type:"PUT",contentType:"application/json",url:_()()+"/rest/numberedheadings/1.0/page-configuration/"+S.a.params.contentId,data:JSON.stringify(d),success:function(){b(),!1===a&&(qa.pageNumbering.isEnabled?ba()({type:"success",body:"Numbered Headings is enabled",close:"auto"}):ba()({type:"success",body:"Numbered Headings is disabled",close:"auto"}))},error:function(a){console.error("Failed saving page configuration",a),c(a),ba()({type:"error",title:"Unexpected error",body:"nl.avisi.confluence.plugins.numberedheadings.there.was.issue.enabling.numbered.headings",close:"auto"})},dataType:"json"})})},300,{leading:!0}),ta=c(56),ua=c.n(ta);ja.a.create("tinymce.plugins.NumberedHeadingsPlugin",{init:function(a){if(B(S.a.params.contentType)){var b=q(S.a.params.contentId);b.then(function(){E()&&(console.info("nl.avisi.nh: Synchrony is enabled, use polling async await"),ha(function(){return 1===G()("#wysiwygTextarea_ifr").contents().first().find(".synchrony-container").length},function(){console.log("nl.avisi.nh: Synchrony is initialized, initialize numbered headings"),t()},100,300))}),a.onNodeChange.add(function(a,b,c){if(u(c)){var d=G()(c).parents("table[data-macro-name=numberedheadings]"),e=1===d.size();if(e)g(d,m(d));else{var f=document.getElementById("nh-page-numbering-configuration-dialog");f&&f.open&&(f.open=!f.open),t()}}});var c=[b,D(a)];Promise.all(c).then(function(){try{C()}catch(a){console.error("Numbered headings threw an error",a)}});var d=!1;a.onEvent&&a.onEvent.add(function(){d||(r(),d=!0)})}},hotReload:function(){G()(".nh-hotreload-element").remove(),C()},getInfo:function(){return{longname:"Numbered Headings TinyMCE Plugin",author:"Avisi B.V.",authorurl:"http://avisi.nl",version:ja.a.majorVersion+"."+ja.a.minorVersion}}}),ja.a.PluginManager.add("numberedheadings",ja.a.plugins.NumberedHeadingsPlugin),ua.a.addTinyMcePluginInit(function(a){a.plugins+=",numberedheadings"}),!1},51:function(a){a.exports=WRM.data},56:function(a){a.exports=require("confluence-editor/loader/tinymce-bootstrap")},57:function(a){a.exports=void 0},58:function(a){a.exports=require("aui/inline-dialog2")},59:function(){}},[[144,12,13,0,2,1]]]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'nl.avisi.confluence.plugins.numberedheadings:entrypoint-nh-tinymce-plugin', location = 'bundled.runtime~nh-tinymce-plugin.5ac3d64c39bb0dadde61.js' */
(function(a){function b(b){for(var d,e,h=b[0],j=b[1],k=b[2],l=0,m=[];l<h.length;l++)e=h[l],f[e]&&m.push(f[e][0]),f[e]=0;for(d in j)Object.prototype.hasOwnProperty.call(j,d)&&(a[d]=j[d]);for(i&&i(b);m.length;)m.shift()();return g.push.apply(g,k||[]),c()}function c(){for(var a,b=0;b<g.length;b++){for(var c,e=g[b],h=!0,i=1;i<e.length;i++)c=e[i],0!==f[c]&&(h=!1);h&&(g.splice(b--,1),a=d(d.s=e[0]))}return a}function d(b){if(e[b])return e[b].exports;var c=e[b]={i:b,l:!1,exports:{}};return a[b].call(c.exports,c,c.exports,d),c.l=!0,c.exports}var e={},f={12:0},g=[];d.m=a,d.c=e,d.d=function(a,b,c){d.o(a,b)||Object.defineProperty(a,b,{enumerable:!0,get:c})},d.r=function(a){'undefined'!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:'Module'}),Object.defineProperty(a,'__esModule',{value:!0})},d.t=function(a,b){if(1&b&&(a=d(a)),8&b)return a;if(4&b&&'object'==typeof a&&a&&a.__esModule)return a;var c=Object.create(null);if(d.r(c),Object.defineProperty(c,'default',{enumerable:!0,value:a}),2&b&&'string'!=typeof a)for(var e in a)d.d(c,e,function(b){return a[b]}.bind(null,e));return c},d.n=function(a){var b=a&&a.__esModule?function(){return a['default']}:function(){return a};return d.d(b,'a',b),b},d.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},d.p='','undefined'!=typeof AJS&&(d.p=AJS.contextPath()+'/s/2585692b-d6e2-436b-ba22-c8f4b00be189/_/download/resources/nl.avisi.confluence.plugins.numberedheadings:assets-2585692b-d6e2-436b-ba22-c8f4b00be189/');var h=window.atlassianWebpackJsonp981e0f4effab173567f2d6cf31d7b23b=window.atlassianWebpackJsonp981e0f4effab173567f2d6cf31d7b23b||[],j=h.push.bind(h);h.push=b,h=h.slice();for(var k=0;k<h.length;k++)b(h[k]);var i=j;c()})([]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'nl.avisi.confluence.plugins.numberedheadings:split_nh-editor-events', location = 'nh-editor-events.bf7b4fb1da159eb7e62f.js' */
(window.atlassianWebpackJsonp981e0f4effab173567f2d6cf31d7b23b=window.atlassianWebpackJsonp981e0f4effab173567f2d6cf31d7b23b||[]).push([[4],{138:function(a,b,c){(function(){function a(a){var c=b.MacroBrowser.selectedMacroDefinition;if(c&&"numberedheadings"===c.name){var e=b.$(d.confluence.macrobrowser.getCurrentNode()).attr("data-macro-id"),f=b.contextPath()+"/rest/numberedheadings/1.0/event/macro-edit/"+b.params.pageId+"/"+c.name+"/"+a+"?";f+="isNew="+!e,e&&(f+="&macroId="+e),b.$.ajax({url:f,type:"POST",data:JSON.stringify(c.params),contentType:"application/json; charset=utf-8",traditional:!0,error:function(a){b.log(a.responseText)}})}}var b=c(2),d=c(4);b.toInit(function(c){function f(){a("edit")}function g(){a("save")}function h(){a("cancel")}b.bind("show.dialog",function(a,b){"macro-browser-dialog"===b.dialog.id&&(f(),c("#macro-details-page button.ok").on("click",g),c("#macro-details-page a.button-panel-cancel-link").on("click",h))}),b.bind("hide.dialog",function(a,b){"macro-browser-dialog"===b.dialog.id&&(c("#macro-details-page button.ok").off("click",g),c("#macro-details-page a.button-panel-cancel-link").off("click",h))})})})()}},[[138,9,0,1]]]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'nl.avisi.confluence.plugins.numberedheadings:entrypoint-nh-editor-events', location = 'bundled.runtime~nh-editor-events.59a169e83ec230596041.js' */
(function(a){function b(b){for(var d,e,h=b[0],j=b[1],k=b[2],l=0,m=[];l<h.length;l++)e=h[l],f[e]&&m.push(f[e][0]),f[e]=0;for(d in j)Object.prototype.hasOwnProperty.call(j,d)&&(a[d]=j[d]);for(i&&i(b);m.length;)m.shift()();return g.push.apply(g,k||[]),c()}function c(){for(var a,b=0;b<g.length;b++){for(var c,e=g[b],h=!0,i=1;i<e.length;i++)c=e[i],0!==f[c]&&(h=!1);h&&(g.splice(b--,1),a=d(d.s=e[0]))}return a}function d(b){if(e[b])return e[b].exports;var c=e[b]={i:b,l:!1,exports:{}};return a[b].call(c.exports,c,c.exports,d),c.l=!0,c.exports}var e={},f={9:0},g=[];d.m=a,d.c=e,d.d=function(a,b,c){d.o(a,b)||Object.defineProperty(a,b,{enumerable:!0,get:c})},d.r=function(a){'undefined'!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:'Module'}),Object.defineProperty(a,'__esModule',{value:!0})},d.t=function(a,b){if(1&b&&(a=d(a)),8&b)return a;if(4&b&&'object'==typeof a&&a&&a.__esModule)return a;var c=Object.create(null);if(d.r(c),Object.defineProperty(c,'default',{enumerable:!0,value:a}),2&b&&'string'!=typeof a)for(var e in a)d.d(c,e,function(b){return a[b]}.bind(null,e));return c},d.n=function(a){var b=a&&a.__esModule?function(){return a['default']}:function(){return a};return d.d(b,'a',b),b},d.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},d.p='','undefined'!=typeof AJS&&(d.p=AJS.contextPath()+'/s/2585692b-d6e2-436b-ba22-c8f4b00be189/_/download/resources/nl.avisi.confluence.plugins.numberedheadings:assets-2585692b-d6e2-436b-ba22-c8f4b00be189/');var h=window.atlassianWebpackJsonp981e0f4effab173567f2d6cf31d7b23b=window.atlassianWebpackJsonp981e0f4effab173567f2d6cf31d7b23b||[],j=h.push.bind(h);h.push=b,h=h.slice();for(var k=0;k<h.length;k++)b(h[k]);var i=j;c()})([]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.comalatech.workflow:workflow-rte-resources', location = 'templates/com/comalatech/workflow/rte/js/workflows-rte.js' */
var AWP=AWP||{};var requirejs=require||requirejs;AWP.BlueprintsHelper=(function(){requirejs(["cw","jquery"],function(a,b){a.toInit(function(){var f="#editor-messages";if(b("#editor-messages").length<=0){f="#all-messages"}var e=b("meta[name=ajs-blueprint-module-complete-key]").attr("content");var c="";if(a.getParam("pageId")=="0"){if(!e||e.length===0){if(b("#createPageLabelsString").val().length){c="?label="+b("#createPageLabelsString").val()}}else{c="?blueprintKey="+e}var d=a.contextPath+"/rest/adhocworkflows/latest/workflow/"+a.getParam("spaceKey")+"/instructions/create"+c;a.request({url:d,type:"get",cache:false,contentType:"application/json; charset=utf-8",success:function(g,i,h){if(g){setTimeout(function(){var j={title:g.title?g.title:"",body:g.body,closeable:true};a.message(g.style,f,j)},500)}}})}})})})();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-paste:autoconvert-core', location = 'js/autoconvert/tinymce-autoconvert.js' */
define("confluence-paste/autoconvert/tinymce-autoconvert","tinymce ajs jquery document confluence/api/constants confluence/meta".split(" "),function(l,j,e,n,o,i){function m(a){for(var d=m.options,a=d.parser[d.strictMode?"strict":"loose"].exec(a),c={},b=14;b--;)c[d.key[b]]=a[b]||"";c[d.q.name]={};c[d.key[12]].replace(d.q.parser,function(a,b,e){b&&(c[d.q.name][b]=e)});return c}var f=function(a){a.onUndo.add(this.cleanLinks);this.editor=a;this.weightedHandlers=[];this.handlers=[]};f.prototype={addHandler:function(a,
d){this.weightedHandlers.push({handler:a,weight:d||0});this.weightedHandlers.sort(function(a,b){return a.weight-b.weight});this.handlers=[];for(var c=this.weightedHandlers.length,b=0;b<c;b++)this.handlers.push(this.weightedHandlers[b].handler)},cleanLinks:function(a){e("a.atlassian-autoconvert",a.getDoc()).removeClass("atlassian-autoconvert");return true},callHandlers:function(a){function d(a){if(a&&(a.length!==1||!a.attr("href")))return b(a);if(a){k=a;g=0;i=m(k.attr("href"));c(h.handlers[g],i,k)}else{g++;
if(g<h.handlers.length)c(h.handlers[g],i,k);else return b(k)}}function c(a,b,c){var e=d,f;f=setTimeout(function(){j.log("Autoconvert: Callback #"+g+" failed to call continuation in time. If there is no subsequent log, the handler is improperly implemented and should be uninstalled.");e=function(){j.log("Autoconvert: Callback #"+g+" did eventualy return. Probably a slow async call.")};d()},l.plugins.Autoconvert.callbackTimeout);a(b,c,function(){var a=g;clearTimeout(f);e.apply(h,arguments);e=function(){j.log("Autoconvert: Callback #"+
a+" called the continuation multiple times.")}})}function b(a){h.editor.undoManager.beforeChange();var b=h.editor.selection,c=h.editor.selection.getBookmark();f.replaceWith(a);b.moveToBookmark(c);h.editor.undoManager.add()}var g=0,h=this,f=e(a),k=e(a).clone(),a=k.attr("href"),i=m(a.replace(/^(.*?\/\/[^/]*?\/.*?)(@)/,"$1%40"));this.handlers.length!==0&&c(this.handlers[0],i,k)}};f.callbackTimeout=5E3;f.convertMacroToDom=function(a,d,c){a={macro:a,contentId:i.get("content-id")};e.ajax({type:"POST",contentType:"application/json; charset=utf-8",
url:o.CONTEXT_PATH+"/rest/tinymce/1/macro/placeholder",data:e.toJSON(a),dataType:"text",success:d,error:c,timeout:45E3})};f.convertMacroToDomViaWikiText=function(a,d,c){var b=["{",a.name],g=true;if(a.defaultParameterValue){b.push(":",a.defaultParameterValue);g=false}for(var h in a.params){if(g){b.push(":");g=false}else b.push("|");b.push(h,"=",a.params[h])}b.push("}");f.getHtmlFromWikiMarkup(b.join(""),function(a){d(e(a)[0])},function(){c()})};f.getHtmlFromWikiMarkup=function(a,d,c){a={wiki:a,entityId:i.get("content-id"),
spaceKey:i.get("space-key"),contextType:i.get("content-type")};e.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:o.CONTEXT_PATH+"/rest/tinymce/1/wikixhtmlconverter",data:e.toJSON(a),dataType:"text",success:d,error:c,timeout:45E3})};m.options={strictMode:false,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:/?#]*)(?::(\d*))?))?((((?:[^?#/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,
loose:/^(?:(?![^:@]+:[^:@/]*@)([^:/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#/]*\.[^?#/.]+(?:[?#]|$)))*\/?)?([^?#/]*))(?:\?([^#]*))?(?:#(.*))?)/}};return{autoConverter:f,plugin:{init:function(a){function d(b,d,f){b=e(f.node).children("a");if(b.length===1&&b[0].tagName==="A"&&b.text()===b.attr("href")){b.attr("class","atlassian-autoconvert");setTimeout(function(){var b=e("a.atlassian-autoconvert",e(a.selection.getNode().ownerDocument)).removeClass("atlassian-autoconvert");
c.callHandlers(b)},0)}}var c=new f(a);l.plugins.Autoconvert.autoConvert=c;a.onInit.add(function(){e(n).bind("postPaste",d);a.addCommand("addAutoconverter",function(a,d){c.addHandler(d)})});a.onRemove.add(function(){e(n).unbind("postPaste",d)})},getInfo:function(){return{longname:"Atlassian Autoconvert",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com",version:"1.0"}}}}});
require("confluence/module-exporter").safeRequire("confluence-paste/autoconvert/tinymce-autoconvert",function(l){var j=require("tinymce");j.plugins.Autoconvert=l.autoConverter;j.create("tinymce.plugins.AutoconvertPlugin",l.plugin);j.PluginManager.add("autoconvert",j.plugins.AutoconvertPlugin)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence-invisionapp-addon:com.invisionapp.integration.confluence-autoconvert', location = 'js/com.invisionapp.integration.confluence-autoconvert.js' */
define(
  'confluence-paste/autoconvert/transformers/invisionpaste',
  ['tinymce'],
  function (tinymce) {
    'use strict'
    function isInVisionUrl (url) {
      return (
        /^https:\/\/invis.io\//i.test(url) ||
        /^https:\/\/([a-z0-9-]+(\.[a-z0-9-]+)*?\.)?(invisionapp\.com|invisionbeta\.com|invision\.works)\/(prototype|public|share|overview|console)\//i.test(
          url
        )
      )
    }

    function InvisionPaste () {
      var pasteHandler = function (uri, node, done) {
        if (isInVisionUrl(uri.source)) {
          var macro = {
            name: 'invision-for-confluence',
            params: {
              shareurl: uri.source
            },
            defaultParameterValue: ''
          }

          tinymce.plugins.Autoconvert.convertMacroToDom(macro, done, done)
        } else {
          done()
        }
      }

      tinymce.plugins.Autoconvert.autoConvert.addHandler(pasteHandler)
    }

    return InvisionPaste
  }
)

require('confluence/module-exporter').safeRequire(
  'confluence-paste/autoconvert/transformers/invisionpaste',
  function (InvisionPaste) {
    require('ajs').bind('init.rte', InvisionPaste)
  }
)

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.dataart.confluence.plugin.confluence-suite-plugin:project-manager-user-profile-resources', location = '/js/project-manager-user-profile.js' */
AJS.toInit(function(a){Confluence.Binder.userHover()});AJS.bind("init.rte",function(){if(AJS.MacroBrowser){var a={fields:{username:{user:function(e,c){c=c||{};var d=AJS.$(AJS.Confluence.Templates.MacroBrowser.macroParameter());var b=AJS.$("input[type='text']",d);b.addClass("autocomplete-user");b.attr("data-none-message","Not found");b.attr("data-show-unlicensed",true);if(e.required){b.keyup(AJS.MacroBrowser.processRequiredParameters)}b.bind("selected.autocomplete-content",function(j,h){if(c.onselect){c.onselect(h.selection)}else{if(c.setValue){c.setValue(h.content.username)}else{if(dependencies&&dependencies.length){for(var f=0,g=dependencies.length;f<g;f++){AJS.MacroBrowser.fields[dependencies[f]]&&AJS.MacroBrowser.fields[dependencies[f]].dependencyUpdated(paramName,value)}}(typeof c.onchange==="function")&&c.onchange.apply(b)}}});AJS.Confluence.Binder.autocompleteUserOrGroup(d);return AJS.MacroBrowser.Field(d,b,c)}}}};AJS.MacroBrowser.setMacroJsOverride("project-manager-user-profile",a)}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.dataart.confluence.plugin.confluence-suite-plugin:team-availability-editor-resources', location = '/js/multi-user-select.js' */
define("confluence-suite/multi-user-select",["jquery","ajs","confluence-ui-components/js/user-group-select2"],function(c,b,a){function d(){var f;function e(h){var g=[];if(h){c.each(h,function(){c.each(this[0].result,function(){g.push({id:this.username,text:this.title,imgSrc:this.thumbnailLink.href,})})})}return g}return{setupInput:function(g){f=g;g.addClass("select2-input autocomplete-multiusergroup");a.bind(g.parent())},setValues:function(h){if(!h||!h[0]){return}var i=h.map(function(j){return c.getJSON(b.contextPath()+"/rest/prototype/1/search/user.json?show-unlicensed=true&query="+encodeURI(j))});function g(){var k=i.length>1?arguments:[arguments];var j=e(k);f.auiSelect2("data",j)}return c.when.apply(c,i).done(g)}}}return{build:d}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.dataart.confluence.plugin.confluence-suite-plugin:team-availability-editor-resources', location = '/js/team-availability-macro.js' */
AJS.bind("init.rte",function(){if(AJS.MacroBrowser){require("confluence/module-exporter").safeRequire("confluence-suite/multi-user-select",function(c){var b=c.build();var a={fields:{string:{users:function(g,e){e=e||{};var f=AJS.$(AJS.Confluence.Templates.MacroBrowser.macroParameter());var d=AJS.$("input[type='text']",f);b.setupInput(d);return AJS.MacroBrowser.Field(f,d,e)}}},beforeParamsSet:function(d){var e=d.users;if(!!e){b.setValues(e.split(","))}return d}};AJS.MacroBrowser.setMacroJsOverride("team-availability",a)})}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.dataart.confluence.plugin.confluence-suite-plugin:person-availability-resources', location = '/js/person-availability.js' */
AJS.bind("init.rte",function(){if(AJS.MacroBrowser){function a(f,d){d=d||{};var e=AJS.$(AJS.Confluence.Templates.MacroBrowser.macroParameter());var c=AJS.$("input[type='text']",e);c.addClass("aui-date-picker");c.prop("type","date");c.datePicker({overrideBrowserDefault:true,dateFormat:"dd M yy"});return AJS.MacroBrowser.Field(e,c,d)}var b={fields:{username:{user:function(f,d){d=d||{};var e=AJS.$(AJS.Confluence.Templates.MacroBrowser.macroParameter());var c=AJS.$("input[type='text']",e);c.addClass("autocomplete-user");c.attr("data-none-message","Not found");c.attr("data-show-unlicensed",true);if(f.required){c.keyup(AJS.MacroBrowser.processRequiredParameters)}c.bind("selected.autocomplete-content",function(k,j){if(d.onselect){d.onselect(j.selection)}else{if(d.setValue){d.setValue(j.content.username)}else{if(dependencies&&dependencies.length){for(var g=0,h=dependencies.length;g<h;g++){AJS.MacroBrowser.fields[dependencies[g]]&&AJS.MacroBrowser.fields[dependencies[g]].dependencyUpdated(paramName,value)}}(typeof d.onchange==="function")&&d.onchange.apply(c)}}});AJS.Confluence.Binder.autocompleteUserOrGroup(e);return AJS.MacroBrowser.Field(e,c,d)},startDate:a,endDate:a}}};AJS.MacroBrowser.setMacroJsOverride("person-availability",b)}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.dataart.confluence.plugin.confluence-suite-plugin:meeting-scheduling-helper-resources', location = '/js/multi-user-select.js' */
define("confluence-suite/multi-user-select",["jquery","ajs","confluence-ui-components/js/user-group-select2"],function(c,b,a){function d(){var f;function e(h){var g=[];if(h){c.each(h,function(){c.each(this[0].result,function(){g.push({id:this.username,text:this.title,imgSrc:this.thumbnailLink.href,})})})}return g}return{setupInput:function(g){f=g;g.addClass("select2-input autocomplete-multiusergroup");a.bind(g.parent())},setValues:function(h){if(!h||!h[0]){return}var i=h.map(function(j){return c.getJSON(b.contextPath()+"/rest/prototype/1/search/user.json?show-unlicensed=true&query="+encodeURI(j))});function g(){var k=i.length>1?arguments:[arguments];var j=e(k);f.auiSelect2("data",j)}return c.when.apply(c,i).done(g)}}}return{build:d}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.dataart.confluence.plugin.confluence-suite-plugin:meeting-scheduling-helper-resources', location = '/js/timepicker.min.js' */
!function(t,i){"function"==typeof define&&define.amd?define(["jquery"],i):"object"==typeof exports?module.exports=i(require("jquery")):t.$=i(t.jQuery)}(this,function(t){"use strict";var i=function(t){return t>=10?t+"":"0"+t},e=/^[0-9]{1,2}:[0-9]{1,2}$/,s={},n=function(){},o=new Array(24).fill(null).map(function(t,e){var s=i(e);return'<li class="cell-2 js-hour-cell" data-val="'+s+'">'+s+"</li>"}).join(""),c=new Array(12).fill(null).map(function(t,e){var s=i(5*e);return'<li class="cell-2 js-minute-cell" data-val="'+s+'">'+s+"</li>"}).join(""),l=t('<div class="timepicker">\t\t<div v-show class="title">Select</div>\t\t\t<div class="chose-all">\t\t\t\t<div class="handle">\t\t\t\t\t<div class="cell-4"><a class="icon-up js-plus-houer"></a></div>\t\t\t\t\t<div class="cell-2"></div>\t\t\t\t\t<div class="cell-4"><a class="icon-up js-plus-minute"></a></div>\t\t\t\t</div>\t\t\t\t<div class="timepicker-text">\t\t\t\t\t<div class="cell-4"><a class="js-hour-show" title="Hour"></a></div>\t\t\t\t\t<div class="cell-2">:</div>\t\t\t\t\t<div class="cell-4"><a class="js-minute-show" title="Minute"></a></div>\t\t\t\t</div>\t\t\t\t<div class="handle">\t\t\t\t\t<div class="cell-4"><a class="icon-down js-minus-houer"></a></div>\t\t\t\t\t<div class="cell-2"></div>\t\t\t\t\t<div class="cell-4"><a class="icon-down js-minus-minute"></a></div>\t\t\t\t</div>\t\t\t</div>\t\t\t<div class="chose-hour">\t\t\t\t<ul class="handle">'+o+'</ul>\t\t\t</div>\t\t\t<div class="chose-minute">\t\t\t\t<ul class="handle">'+c+"</ul>\t\t\t</div>\t\t</div>\t</div>");return l.find("a").attr("href","javascript:void(0);"),s.content=l,s.title=l.find(".title"),s.choseAll=l.find(".chose-all"),s.choseMinute=l.find(".chose-minute"),s.choseHour=l.find(".chose-hour"),s.hourShow=l.find(".js-hour-show"),s.minuteShow=l.find(".js-minute-show"),s.update=function(){return this.inputTarget.val(i(this.hour)+":"+i(this.minute)),this.minuteShow.text(i(this.minute)),this.hourShow.text(i(this.hour)),this.inputTarget.$timepickerUpdate(),this},s.bindEvent=function(){var t=this;t.hasBind||(t.hasBind=!0,this.content.on("click",".js-minus-minute",function(){t.minute<=0?t.minute=59:t.minute--,t.update()}).on("click",".js-plus-minute",function(){t.minute>=59?t.minute=0:t.minute++,t.update()}).on("click",".js-plus-houer",function(){t.hour>=23?t.hour=0:t.hour++,t.update()}).on("click",".js-minus-houer",function(){t.hour<=0?t.hour=23:t.hour--,t.update()}).on("click",".js-minute-cell",function(){t.minute=+this.getAttribute("data-val"),t.update(),t.choseMinute.hide(),t.choseAll.show(),t.title.text("Select")}).on("click",".js-hour-cell",function(){t.hour=+this.getAttribute("data-val"),t.update(),t.choseHour.hide(),t.choseAll.show(),t.title.text("Select")}).on("click",function(t){t.stopPropagation()}),t.hourShow.on("click",function(){t.choseAll.hide(),t.choseHour.show(),t.title.text("Hour")}),t.minuteShow.on("click",function(){t.choseAll.hide(),t.choseMinute.show(),t.title.text("Minute")}))},t.timepicker=s,t.fn.timepicker=function(i){var s,o,c=this,l=t.timepicker,u=t("html");if(this[0].nodeName&&"INPUT"===this[0].nodeName)return this.$timepickerUpdate=n,this.off("click").on("click",function(i){var n=this.value;e.test(n)?(n=n.split(":"),s=+n[0],o=+n[1]):(n=new Date,s=n.getHours(),o=n.getMinutes());var h=this.offsetLeft+"px",a=this.offsetTop+this.offsetHeight+"px";l.inputTarget=c,l.content.appendTo(this.offsetParent).css({left:h,top:a}),l.hour=s,l.minute=o,l.choseAll.show(),l.choseHour.hide(),l.choseMinute.hide(),l.update(),t.timepicker.bindEvent(),i.stopPropagation(),u.one("click",function(){l.content.off().remove(),l.hasBind=!1})}),this.off("keydown").on("keydown",function(){return!1}),this.update=function(i){t.isFunction(i)?this.$timepickerUpdate=i:this.$timepickerUpdate=n},this},t});

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.dataart.confluence.plugin.confluence-suite-plugin:meeting-scheduling-helper-resources', location = '/js/meeting_notes.js' */
AJS.toInit(function(d){var a=d(".start-date > time").text();var c=AJS.$("h1#title-text a").text();var b="";AJS.$(".confluence-userlink.user-mention").each(function(){b+=AJS.$(this).attr("data-username")+","});if(!b){b=d(".attendees-names").text().trim()}var e;if(window.location.origin==="https://conftest.dataart.com"){e="3b7ba0a7-707a-4d9f-8177-c146579b1413"}else{e="4c9d99ab-539c-4e05-b7c6-a3611bd50c4a"}d(".createMeetingNotes").click(function(){AJS.$.ajax({url:AJS.params.baseUrl+"/rest/create-dialog/1.0/content-blueprint/create-draft",type:"POST",data:'{"spaceKey":"'+AJS.Meta.get("space-key")+'","contentBlueprintId":"'+e+'","title":"'+c+" Notes "+a+'","context":{"startDate":"'+a+'","attendees":"'+b+'","spaceKey":"ALP"},"parentPageId":"'+AJS.params.pageId+'"}',contentType:"application/json",dataType:"json",success:function(f){window.location.href=f.url}})})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.dataart.confluence.plugin.confluence-suite-plugin:meeting-scheduling-helper-resources', location = '/js/meeting-scheduling-helper.js' */
AJS.bind("init.rte",function(){if(AJS.MacroBrowser){require("confluence/module-exporter").safeRequire("confluence-suite/multi-user-select",function(e){function a(i,g){g=g||{};var h=AJS.$(AJS.Confluence.Templates.MacroBrowser.macroParameter());var f=AJS.$("input[type='text']",h);f.addClass("aui-date-picker");f.prop("type","date");f.datePicker({overrideBrowserDefault:true,dateFormat:"dd M yy"});return AJS.MacroBrowser.Field(h,f,g)}function d(i,g){g=g||{};var h=AJS.$(AJS.Confluence.Templates.MacroBrowser.macroParameter());var f=AJS.$("input[type='text']",h);f.timepicker();return AJS.MacroBrowser.Field(h,f,g)}var c=e.build();var b={fields:{string:{attendees:function(i,g){g=g||{};var h=AJS.$(AJS.Confluence.Templates.MacroBrowser.macroParameter());var f=AJS.$("input[type='text']",h);c.setupInput(f);return AJS.MacroBrowser.Field(h,f,g)},description:function(j,h){h=h||{};var i=AJS.$(AJS.Confluence.Templates.MacroBrowser.macroParameter());var g=AJS.$("input[type='text']",i);var f=AJS.$('<textarea class="text macro-param-input" id="macro-param-description" style="height: 110px;"></textarea>');g.replaceWith(f);return AJS.MacroBrowser.Field(i,f,h)},status:function(i,g){g=g||{};var h=AJS.$(AJS.Confluence.Templates.MacroBrowser.macroParameter());var f=AJS.$("input[type='text']",h);f.val("active");f.parent().css({display:"none"});return AJS.MacroBrowser.Field(h,f,g)},startDate:a,endDate:a,startTime:d,endTime:d}},beforeParamsSet:function(g){var f=g.attendees;if(!!f){c.setValues(f.split(","))}return g}};AJS.MacroBrowser.setMacroJsOverride("meeting-scheduling-helper",b)})}});AJS.toInit(function(){var b='<ac:parameter ac:name="status">active</ac:parameter>';var d='<ac:parameter ac:name="status">inactive</ac:parameter>';AJS.$(".change-status-meeting").click(function(){AJS.$.ajax({url:AJS.params.baseUrl+"/rest/api/content/"+AJS.params.pageId+"?expand=body.storage,version",type:"GET",contentType:"application/json",dataType:"json",success:function(e){var g=e.body.storage.value,f;if(g.includes(b)){f=g.replace(b,d)}else{f=g.replace(d,b)}var h={id:e.id,type:e.type,title:e.title,body:{storage:{value:f,representation:e.body.storage.representation}},version:{number:e.version.number+1}};$.ajax({type:"PUT",url:AJS.params.baseUrl+"/rest/api/content/"+e.id,contentType:"application/json; charset=utf-8",dataType:"json",async:false,data:JSON.stringify(h),success:function(){location.reload()}})}})});function a(f){var e=document.createElement("textarea");e.innerHTML=f;document.body.appendChild(e);e.select();document.execCommand("copy");document.body.removeChild(e)}function c(f,e){AJS.$("#copy-status").html(f+(e?" have ":" has ")+" been copied to clipboard")}AJS.$("#organizer").click(function(){a(AJS.$(this).find("#organizer-email").html());c("Organizer's email",false)});AJS.$("#attendees").click(function(){a(AJS.$(this).find("#attendees-emails").html());c("Attendees' emails",true)});AJS.$("#subject").click(function(){a(AJS.$(this).html());c("Subject",false)});AJS.$("#location").click(function(){a(AJS.$(this).html());c("Location",false)});AJS.$("#start-date").click(function(){a(AJS.$(this).html());c("Start date",false)});AJS.$("#end-date").click(function(){a(AJS.$(this).html());c("End date",false)});AJS.$("#start-time").click(function(){a(AJS.$(this).html());c("Start time",false)});AJS.$("#end-time").click(function(){a(AJS.$(this).html());c("End time",false)});AJS.$("#description").click(function(){a(AJS.$(this).html());c("Description",false)})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.dataart.confluence.plugin.confluence-suite-plugin:user-task-report-resources', location = '/js/task-report-macro.js' */
AJS.bind("init.rte",function(){if(AJS.MacroBrowser){var a={fields:{string:{spacekey:function(g,d){d=d||{};var f=AJS.$(AJS.Confluence.Templates.MacroBrowser.macroParameter());var c=AJS.$("input[type='text']",f);var b=[];AJS.$.ajax({url:AJS.params.baseUrl+"/rest/api/space",type:"GET",async:false,contentType:"application/json",dataType:"json",success:function(i){AJS.$.each(i.results,function(){b.push(this.name)})}});function e(i){return i.split(/,\s*/)}function h(i){return e(i).pop()}AJS.$(c).autocomplete({maxResults:10,minLength:0,source:function(k,i){var j=AJS.$.ui.autocomplete.filter(b,h(k.term));i(j.slice(0,this.options.maxResults))},focus:function(){return false},select:function(j,k){var i=e(this.value);i.pop();i.push(k.item.value);i.push("");this.value=i.join(", ");return false}});return AJS.MacroBrowser.Field(f,c,d)},}}};AJS.MacroBrowser.setMacroJsOverride("user-task-report",a)}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.dataart.confluence.plugin.confluence-suite-plugin:user-task-report-resources', location = '/js/task-report-macro-page.js' */
AJS.toInit(function(){if(AJS.$("div#tasks-report").html()){var a=new Date();var c=new Date();c.setDate(a.getDate()+14);var b=AJS.$("#fromDate").datePicker({overrideBrowserDefault:true});var d=AJS.$("#toDate").datePicker({overrideBrowserDefault:true});AJS.$("#fromDate").click();b.setDate(a);AJS.$(".ui-state-active").click();AJS.$("#toDate").click();d.setDate(c);AJS.$(".ui-state-active").click();hideTableRows(a,c)}AJS.$("#dateButton").click(function(){filterByDates()});AJS.$("#complete-tasks").click(function(){AJS.$(this).attr("aria-pressed","true");AJS.$("#incomplete-tasks").attr("aria-pressed","false");showCompleteTasks()});AJS.$("#incomplete-tasks").click(function(){AJS.$(this).attr("aria-pressed","true");AJS.$("#complete-tasks").attr("aria-pressed","false");showIncompleteTasks()});AJS.$("#checkNoDate").change(function(){if(this.checked){showTasksWithoutDate()}else{hideTasksWithoutDate()}})});function filterByDates(){AJS.$("#tasks-report > div.aui-message").each(function(){AJS.$(this).remove()});var d=AJS.$("#fromDate").val().split("-");var a=new Date(d[0],d[1]-1,d[2]);var b=AJS.$("#toDate").val().split("-");var c=new Date(b[0],b[1]-1,b[2]);hideTableRows(a,c)}function showIncompleteTasks(){AJS.$("div#tasks-report > table > tbody > tr").each(function(){var a=AJS.$(this).find(":nth-child(3) > ul > li");if(a.hasClass("checked")){a.parent().parent().parent().hide()}else{a.parent().parent().parent().show()}});checkOnNoDate();filterByDates()}function hideIncompleteTasks(){AJS.$("div#tasks-report > table > tbody > tr").each(function(){var a=AJS.$(this).find(":nth-child(3) > ul > li");if(!a.hasClass("checked")){a.parent().parent().parent().hide()}})}function hideCompleteTasks(){AJS.$("div#tasks-report > table > tbody > tr").each(function(){var a=AJS.$(this).find(":nth-child(3) > ul > li");if(a.hasClass("checked")){a.parent().parent().parent().hide()}})}function showCompleteTasks(){AJS.$("div#tasks-report > table > tbody > tr").each(function(){var a=AJS.$(this).find(":nth-child(3) > ul > li");if(a.hasClass("checked")){a.parent().parent().parent().show()}else{a.parent().parent().parent().hide()}});filterByDates();checkOnNoDate()}function checkOnComplete(){if(AJS.$("#incomplete-tasks").attr("aria-pressed")==="true"){hideCompleteTasks()}else{hideIncompleteTasks()}}function checkOnNoDate(){if(AJS.$("#checkNoDate").attr("checked")==="checked"){showTasksWithoutDate()}else{hideTasksWithoutDate()}}function showTasksWithoutDate(){AJS.$("#tasks-report > div.aui-message").each(function(){AJS.$(this).remove()});AJS.$("#tasks-report > table").css("display","");AJS.$("span.task-date").each(function(){if(AJS.$(this).text().trim()===""){AJS.$(this).parent().parent().css("display","")}});checkOnComplete();if(calcVisibleElem()===0){showEmptyTasksMessage()}}function hideTasksWithoutDate(){AJS.$("#tasks-report > div.aui-message").each(function(){AJS.$(this).remove()});AJS.$("#tasks-report > table").css("display","");AJS.$("span.task-date").each(function(){if(AJS.$(this).text().trim()===""){AJS.$(this).parent().parent().css("display","none")}});checkOnComplete();if(calcVisibleElem()===0){showEmptyTasksMessage()}}function showEmptyTasksMessage(){AJS.$("#tasks-report > table").css("display","none");AJS.messages.generic("#tasks-report",{title:"Task list is empty.",body:"<p> Please choose dates range.</p>"})}function hideTableRows(a,c){AJS.$("#tasks-report > table").css("display","");AJS.$("#tasks-report > table > tbody > tr").css("display","");var b=0;AJS.$("span.task-date").each(function(){b+=1;var e=AJS.$(this).text().split(" ");var d=new Date(e[2],getMonth(e[1])-1,e[0]);if(d<a||d>c){AJS.$(this).parent().parent().css("display","none")}});checkOnNoDate();checkOnComplete()}function getMonth(b){var d="",a=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],c=0;for(c;c<a.length;c++){if(a[c]===b){break}}c++;if(c>=10){d=c}else{d="0"+c}return d}function calcHiddenElem(){var a=0;AJS.$("span.task-date").each(function(){if(AJS.$(this).parent().parent().css("display")==="none"){a+=1}});return a}function calcVisibleElem(){var a=0;AJS.$("span.task-date").each(function(){if(AJS.$(this).parent().parent().css("display")!=="none"){a+=1}});return a};
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.binguo.confluence.headingfree.easy-heading-free:easy-heading-free-macro-browser', location = '/js/easy-heading-free-macro-browser.js' */
AJS.toInit(function(){var d=false;var c=null;AJS.bind("init.rte",function(){$(document).ajaxComplete(function(){h()})});function h(){if(AJS.$("table[data-macro-name = 'easy-heading-free']")){if(AJS.MacroBrowser){if($("#ehpe-navigation").length>0&&$("#editpageform, #createpageform").length>0){e()}else{b()}}}}function b(){AJS.MacroBrowser.setMacroJsOverride("easy-heading-free",{fields:{string:{hiddenEditedFlag:function(j){var i=AJS.MacroBrowser.ParameterFields._hidden(j,{});if(!i.getValue()||i.getValue()==""){i.setValue("false")}return i}}}})}function e(){if(d){return}d=true;var i=AJS.contextPath()+"/plugins/servlet/easy-heading-pro/page-editor-parameter";var j={action:"getSpaceSettings",spaceKey:AJS.params.spaceKey};$.ajax({url:i,type:"GET",data:j,success:function(l,m,k){c=l;a()},error:function(k,m,l){g("error",k.responseText)}})}function a(){AJS.MacroBrowser.setMacroJsOverride("easy-heading-free",{fields:{string:{hiddenEditedFlag:function(j){var i=AJS.MacroBrowser.ParameterFields._hidden(j,{});if(!i.getValue()||i.getValue()==""){i.setValue("false")}return i}}},beforeParamsSet:function(i){if(AJS.MacroBrowser.settings.mode!="insert"){return i}return f(i,c)}})}function f(j,i){if(i.expandCollapseOption=="expand-all"){i.expandCollapseOption="expand-all-by-default"}if(i.expandCollapseOption=="collapse-all"){i.expandCollapseOption="collapse-all-by-default"}if(i.expandCollapseOption=="no-expand-collapse"){i.expandCollapseOption="disable-expand-collapse"}if(i.expandCollapseNavOption=="expand-all"){i.expandCollapseNavOption="expand-all-by-default"}if(i.expandCollapseNavOption=="collapse-all"){i.expandCollapseNavOption="collapse-all-by-default"}if(i.expandCollapseNavOption=="no-expand-collapse"){i.expandCollapseNavOption="disable-expand-collapse"}j.selector=i.selector;j.headingIndent=i.headingIndent;j.expandOption=i.expandCollapseOption;j.titleExpandClickable=i.titleExpandClickable;j.useNavigation=i.useNavigation;j.useNavigationHiddenMode=i.navigationMode=="right-popup";j.wrapNavigationText=i.wrapNavigationText;j.navigationTitle=i.navigationTitle;j.navigationWidth=i.navigationWidth;j.navigationIndent=i.navigationIndent;j.disableNavLinksUnder=i.disableNavLinksUnder;j.navigationExpandOption=i.expandCollapseNavOption;j.macrosTOCDisabled=i.macrosTOCDisabled;j.hiddenEditedFlag="true";return j}function g(i,j){AJS.flag({type:i,body:j,close:"auto"})}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.profile-picture:profile-picture-editor_resources', location = 'js/profile-picture.js' */
AJS.bind("init.rte",function(){AJS.Confluence.PropertyPanel.Macro.registerButtonHandler("viewProfile",function(a,b){a=AJS.$(b);var c={};a.attr("data-macro-parameters")&&AJS.$.each(a.attr("data-macro-parameters").split("|"),function(a,b){a=b.split("\x3d");c[a[0]]=a[1]});window.open(AJS.Confluence.getBaseUrl()+"/display/~"+c.User).opener=null})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:fancy-box', location = '/includes/fancybox/jquery.fancybox-1.3.4.js' */
(function(a){var n,s,t,e,z,l,A,i,w,x,q=0,d={},o=[],p=0,b={},j=[],C=null,m=new Image,F=/\.(jpg|gif|png|bmp|jpeg)(.*)?$/i,Q=/[^\.]\.(swf)\s*$/i,G,H=1,v=0,u="",r,g,k=!1,y=a.extend(a("<div></div>")[0],{prop:0}),I=a.browser.msie&&7>a.browser.version&&!window.XMLHttpRequest,J=function(){s.hide();m.onerror=m.onload=null;C&&C.abort();n.empty()},K=function(){!1===d.onError(o,q,d)?(s.hide(),k=!1):(d.titleShow=!1,d.width="auto",d.height="auto",n.html('<p id="fancybox-error">The requested content cannot be loaded.<br />Please try again later.</p>'),
B())},E=function(){var c=o[q],b,f,e,g,j,i;J();d=a.extend({},a.fn.fancybox.defaults,"undefined"==typeof a(c).data("fancybox")?d:a(c).data("fancybox"));i=d.onStart(o,q,d);if(!1===i)k=!1;else{"object"==typeof i&&(d=a.extend(d,i));e=d.title||(c.nodeName?a(c).attr("title"):c.title)||"";d.orig=a(c).is("img")&&a(c);c.nodeName&&!d.orig&&(d.orig=a(c).children("img:first").length?a(c).children("img:first"):a(c));""===e&&(d.orig&&d.titleFromAlt)&&(e=d.orig.attr("alt"));b=d.href||(c.nodeName?a(c).attr("href"):
c.href)||null;if(/^(?:javascript)/i.test(b)||"#"==b)b=null;d.type?(f=d.type,b||(b=d.content)):d.content?f="html":d.dataAttr?(f="dataAttribute",b=d.orig.attr("data-"+d.dataAttr)):b&&(f=b.match(F)?"image":b.match(Q)?"swf":a(c).hasClass("iframe")?"iframe":0===b.indexOf("#")?"inline":"ajax");if(f)switch("inline"==f&&(c=b.substr(b.indexOf("#")),f=0<a(c).length?"inline":"ajax"),d.type=f,d.href=b,d.title=e,d.autoDimensions&&("html"==d.type||"inline"==d.type||"ajax"==d.type?(d.width="auto",d.height="auto"):
d.autoDimensions=!1),d.modal&&(d.overlayShow=!0,d.hideOnOverlayClick=!1,d.hideOnContentClick=!1,d.enableEscapeButton=!1,d.showCloseButton=!1),d.padding=parseInt(d.padding,10),d.margin=parseInt(d.margin,10),n.css("padding",d.padding+d.margin),a(".fancybox-inline-tmp").unbind("fancybox-cancel").bind("fancybox-change",function(){a(this).replaceWith(l.children())}),f){case "html":n.html(d.content);B();break;case "inline":if(!0===a(c).parent().is("#fancybox-content")){k=!1;break}a('<div class="fancybox-inline-tmp"></div>').hide().insertBefore(a(c)).bind("fancybox-cleanup",
function(){a(this).replaceWith(l.children())}).bind("fancybox-cancel",function(){a(this).replaceWith(n.children())});a(c).appendTo(n);B();break;case "image":case "dataAttribute":k=!1;a.fancybox.showActivity();m=new Image;m.onerror=function(){K()};m.onload=function(){k=true;m.onerror=m.onload=null;d.width=m.width;d.height=m.height;a("<img />").attr({id:"fancybox-img",src:m.src,alt:d.title}).appendTo(n);L()};m.src=b;break;case "swf":d.scrolling="no";g='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="'+
d.width+'" height="'+d.height+'"><param name="movie" value="'+b+'"></param>';j="";a.each(d.swf,function(a,c){g=g+('<param name="'+a+'" value="'+c+'"></param>');j=j+(" "+a+'="'+c+'"')});g+='<embed src="'+b+'" type="application/x-shockwave-flash" width="'+d.width+'" height="'+d.height+'"'+j+"></embed></object>";n.html(g);B();break;case "ajax":k=!1;a.fancybox.showActivity();d.ajax.win=d.ajax.success;C=a.ajax(a.extend({},d.ajax,{url:b,data:d.ajax.data||{},error:function(a){a.status>0&&K()},success:function(a,
c,f){if((typeof f=="object"?f:C).status==200){if(typeof d.ajax.win=="function"){i=d.ajax.win(b,a,c,f);if(i===false){s.hide();return}if(typeof i=="string"||typeof i=="object")a=i}n.html(a);B()}}}));break;case "iframe":L()}else K()}},B=function(){var c=d.width,b=d.height,c=-1<c.toString().indexOf("%")?parseInt((a(window).width()-2*d.margin)*parseFloat(c)/100,10)+"px":"auto"==c?"auto":c+"px",b=-1<b.toString().indexOf("%")?parseInt((a(window).height()-2*d.margin)*parseFloat(b)/100,10)+"px":"auto"==b?
"auto":b+"px";n.wrapInner('<div style="width:'+c+";height:"+b+";overflow: "+("auto"==d.scrolling?"auto":"yes"==d.scrolling?"scroll":"hidden")+';position:relative;"></div>');d.width=n.width();d.height=n.height();L()},L=function(){var c,h;s.hide();if(e.is(":visible")&&!1===b.onCleanup(j,p,b))a.event.trigger("fancybox-cancel"),k=!1;else{k=!0;a(l.add(t)).unbind();a(window).unbind("resize.fb scroll.fb");a(document).unbind("keydown.fb");e.is(":visible")&&"outside"!==b.titlePosition&&e.css("height",e.height());
j=o;p=q;b=d;if(b.overlayShow){if(t.css({"background-color":b.overlayColor,opacity:b.overlayOpacity,cursor:b.hideOnOverlayClick?"pointer":"auto",height:a(document).height()}),!t.is(":visible")){if(I)a("select:not(#fancybox-tmp select)").filter(function(){return"hidden"!==this.style.visibility}).css({visibility:"hidden"}).one("fancybox-cleanup",function(){this.style.visibility="inherit"});t.show()}}else t.hide();c=M();var f={},D=b.autoScale,m=2*b.padding;f.width=-1<b.width.toString().indexOf("%")?parseInt(c[0]*
parseFloat(b.width)/100,10):b.width+m;f.height=-1<b.height.toString().indexOf("%")?parseInt(c[1]*parseFloat(b.height)/100,10):b.height+m;if(D&&(f.width>c[0]||f.height>c[1]))if("image"==d.type||"dataAttribute"==d.type||"swf"==d.type){if(D=b.width/b.height,f.width>c[0]&&(f.width=c[0],f.height=parseInt((f.width-m)/D+m,10)),f.height>c[1])f.height=c[1],f.width=parseInt((f.height-m)*D+m,10)}else f.width=Math.min(f.width,c[0]),f.height=Math.min(f.height,c[1]);f.top=parseInt(Math.max(c[3]-20,c[3]+0.5*(c[1]-
f.height-40)),10);f.left=parseInt(Math.max(c[2]-20,c[2]+0.5*(c[0]-f.width-40)),10);g=f;u=b.title||"";v=0;i.empty().removeAttr("style").removeClass();if(!1!==b.titleShow&&(u=a.isFunction(b.titleFormat)?b.titleFormat(u,j,p,b):u&&u.length?"float"==b.titlePosition?'<table id="fancybox-title-float-wrap" cellpadding="0" cellspacing="0"><tr><td id="fancybox-title-float-left"></td><td id="fancybox-title-float-main">'+u+'</td><td id="fancybox-title-float-right"></td></tr></table>':'<div id="fancybox-title-'+
b.titlePosition+'">'+u+"</div>":!1)&&""!==u)switch(i.addClass("fancybox-title-"+b.titlePosition).html(u).appendTo("body").show(),b.titlePosition){case "inside":i.css({width:g.width-2*b.padding,marginLeft:b.padding,marginRight:b.padding});v=i.outerHeight(!0);i.appendTo(z);g.height+=v;break;case "over":i.css({marginLeft:b.padding,width:g.width-2*b.padding,bottom:b.padding}).appendTo(z);break;case "float":i.css("left",-1*parseInt((i.width()-g.width-40)/2,10)).appendTo(e);break;default:i.css({width:g.width-
2*b.padding,paddingLeft:b.padding,paddingRight:b.padding}).appendTo(e)}i.hide();e.is(":visible")?(a(A.add(w).add(x)).hide(),c=e.position(),r={top:c.top,left:c.left,width:e.width(),height:e.height()},h=r.width==g.width&&r.height==g.height,l.fadeTo(b.changeFade,0.3,function(){var c=function(){l.html(n.contents()).fadeTo(b.changeFade,1,N)};a.event.trigger("fancybox-change");l.empty().removeAttr("filter").css({"border-width":b.padding,width:g.width-2*b.padding,height:d.autoDimensions?"auto":g.height-
v-2*b.padding});h?c():(y.prop=0,a(y).animate({prop:1},{duration:b.changeSpeed,easing:b.easingChange,step:O,complete:c}))})):(e.removeAttr("style"),l.css("border-width",b.padding),"elastic"==b.transitionIn?(r=P(),l.html(n.contents()),e.show(),b.opacity&&(g.opacity=0),y.prop=0,a(y).animate({prop:1},{duration:b.speedIn,easing:b.easingIn,step:O,complete:N})):("inside"==b.titlePosition&&0<v&&i.show(),l.css({width:g.width-2*b.padding,height:d.autoDimensions?"auto":g.height-v-2*b.padding}).html(n.contents()),
e.css(g).fadeIn("none"==b.transitionIn?0:b.speedIn,N)))}},N=function(){a.support.opacity||(l.get(0).style.removeAttribute("filter"),e.get(0).style.removeAttribute("filter"));d.autoDimensions&&l.css("height","auto");e.css("height","auto");u&&u.length&&i.show();b.showCloseButton&&A.show();(b.enableEscapeButton||b.enableKeyboardNav)&&a(document).bind("keydown.fb",function(c){if(c.keyCode==27&&b.enableEscapeButton){c.preventDefault();a.fancybox.close()}else if((c.keyCode==37||c.keyCode==39)&&b.enableKeyboardNav&&
c.target.tagName!=="INPUT"&&c.target.tagName!=="TEXTAREA"&&c.target.tagName!=="SELECT"){c.preventDefault();a.fancybox[c.keyCode==37?"prev":"next"]()}});b.showNavArrows?((b.cyclic&&1<j.length||0!==p)&&w.show(),(b.cyclic&&1<j.length||p!=j.length-1)&&x.show()):(w.hide(),x.hide());b.hideOnContentClick&&l.bind("click",a.fancybox.close);b.hideOnOverlayClick&&t.bind("click",a.fancybox.close);a(window).bind("resize.fb",a.fancybox.resize);b.centerOnScroll&&a(window).bind("scroll.fb",a.fancybox.center);"iframe"==
b.type&&a('<iframe id="fancybox-frame" name="fancybox-frame'+(new Date).getTime()+'" frameborder="0" hspace="0" '+(a.browser.msie?'allowtransparency="true""':"")+' scrolling="'+d.scrolling+'" src="'+b.href+'"></iframe>').appendTo(l);e.show();k=!1;a.fancybox.center();b.onComplete(j,p,b);var c,h;j.length-1>p&&(c=j[p+1].href,"undefined"!==typeof c&&c.match(F)&&(h=new Image,h.src=c));0<p&&(c=j[p-1].href,"undefined"!==typeof c&&c.match(F)&&(h=new Image,h.src=c))},O=function(a){var d={width:parseInt(r.width+
(g.width-r.width)*a,10),height:parseInt(r.height+(g.height-r.height)*a,10),top:parseInt(r.top+(g.top-r.top)*a,10),left:parseInt(r.left+(g.left-r.left)*a,10)};"undefined"!==typeof g.opacity&&(d.opacity=0.5>a?0.5:a);e.css(d);l.css({width:d.width-2*b.padding,height:d.height-v*a-2*b.padding})},M=function(){return[a(window).width()-2*b.margin,a(window).height()-2*b.margin,a(document).scrollLeft()+b.margin,a(document).scrollTop()+b.margin]},P=function(){var c=d.orig?a(d.orig):!1,h={};c&&c.length?(h=c.offset(),
h.top+=parseInt(c.css("paddingTop"),10)||0,h.left+=parseInt(c.css("paddingLeft"),10)||0,h.top+=parseInt(c.css("border-top-width"),10)||0,h.left+=parseInt(c.css("border-left-width"),10)||0,h.width=c.width(),h.height=c.height(),h={width:h.width+2*b.padding,height:h.height+2*b.padding,top:h.top-b.padding-20,left:h.left-b.padding-20}):(c=M(),h={width:2*b.padding,height:2*b.padding,top:parseInt(c[3]+0.5*c[1],10),left:parseInt(c[2]+0.5*c[0],10)});return h},R=function(){s.is(":visible")?(a("div",s).css("top",
-40*H+"px"),H=(H+1)%12):clearInterval(G)};a.fn.fancybox=function(c){AJS&&AJS.log("fancybox is deprecated, please use the previewer instead. E.g. $imageLink.previewer({ src: srcOfImage }); ");if(!a(this).length)return this;a(this).data("fancybox",a.extend({},c,a.metadata?a(this).metadata():{})).unbind("click.fb").bind("click.fb",function(c){c.preventDefault();k||(k=!0,a(this).blur(),o=[],q=0,c=a(this).attr("rel")||"",!c||""==c||"nofollow"===c?o.push(this):(o=a("a[rel="+c+"], area[rel="+c+"]"),q=o.index(this)),
E())});return this};a.fancybox=function(c,b){var d;if(!k){k=!0;d="undefined"!==typeof b?b:{};o=[];q=parseInt(d.index,10)||0;if(a.isArray(c)){for(var e=0,g=c.length;e<g;e++)"object"==typeof c[e]?a(c[e]).data("fancybox",a.extend({},d,c[e])):c[e]=a({}).data("fancybox",a.extend({content:c[e]},d));o=jQuery.merge(o,c)}else"object"==typeof c?a(c).data("fancybox",a.extend({},d,c)):c=a({}).data("fancybox",a.extend({content:c},d)),o.push(c);if(q>o.length||0>q)q=0;E()}};a.fancybox.showActivity=function(){clearInterval(G);
s.show();G=setInterval(R,66)};a.fancybox.hideActivity=function(){s.hide()};a.fancybox.next=function(){return a.fancybox.pos(p+1)};a.fancybox.prev=function(){return a.fancybox.pos(p-1)};a.fancybox.pos=function(a){k||(a=parseInt(a,10),o=j,-1<a&&a<j.length?(q=a,E()):b.cyclic&&1<j.length&&(q=a>=j.length?0:j.length-1,E()))};a.fancybox.cancel=function(){k||(k=!0,a.event.trigger("fancybox-cancel"),J(),d.onCancel(o,q,d),k=!1)};a.fancybox.close=function(){function c(){t.fadeOut("fast");i.empty().hide();e.hide();
a.event.trigger("fancybox-cleanup");l.empty();b.onClosed(j,p,b);j=d=[];p=q=0;b=d={};k=!1}if(!k&&!e.is(":hidden"))if(k=!0,b&&!1===b.onCleanup(j,p,b))k=!1;else if(J(),a(A.add(w).add(x)).hide(),a(l.add(t)).unbind(),a(window).unbind("resize.fb scroll.fb"),a(document).unbind("keydown.fb"),l.find("iframe").attr("src",I&&/^https/i.test(window.location.href||"")?"javascript:void(false)":"about:blank"),"inside"!==b.titlePosition&&i.empty(),e.stop(),"elastic"==b.transitionOut){r=P();var h=e.position();g={top:h.top,
left:h.left,width:e.width(),height:e.height()};b.opacity&&(g.opacity=1);i.empty().hide();y.prop=1;a(y).animate({prop:0},{duration:b.speedOut,easing:b.easingOut,step:O,complete:c})}else e.fadeOut("none"==b.transitionOut?0:b.speedOut,c)};a.fancybox.resize=function(){t.is(":visible")&&t.css("height",a(document).height());a.fancybox.center(!0)};a.fancybox.center=function(a){var d,f;if(!k&&(f=!0===a?1:0,d=M(),f||!(e.width()>d[0]||e.height()>d[1])))e.stop().animate({top:""+parseInt(Math.max(d[3]-20,d[3]+
0.5*(d[1]-l.height()-40)-b.padding),10),left:""+parseInt(Math.max(d[2]-20,d[2]+0.5*(d[0]-l.width()-40)-b.padding),10)},"number"==typeof a?a:200)};a.fancybox.init=function(){a("#fancybox-wrap").length||(a("body").append(n=a('<div id="fancybox-tmp"></div>'),s=a('<div id="fancybox-loading"><div></div></div>'),t=a('<div id="fancybox-overlay"></div>'),e=a('<div id="fancybox-wrap"></div>')),z=a('<div id="fancybox-outer"></div>').append('<div class="fancybox-bg" id="fancybox-bg-n"></div><div class="fancybox-bg" id="fancybox-bg-ne"></div><div class="fancybox-bg" id="fancybox-bg-e"></div><div class="fancybox-bg" id="fancybox-bg-se"></div><div class="fancybox-bg" id="fancybox-bg-s"></div><div class="fancybox-bg" id="fancybox-bg-sw"></div><div class="fancybox-bg" id="fancybox-bg-w"></div><div class="fancybox-bg" id="fancybox-bg-nw"></div>').appendTo(e),
z.append(l=a('<div id="fancybox-content"></div>'),A=a('<a id="fancybox-close"></a>'),i=a('<div id="fancybox-title"></div>'),w=a('<a href="javascript:;" id="fancybox-left"><span class="fancy-ico" id="fancybox-left-ico"></span></a>'),x=a('<a href="javascript:;" id="fancybox-right"><span class="fancy-ico" id="fancybox-right-ico"></span></a>')),A.click(a.fancybox.close),s.click(a.fancybox.cancel),w.click(function(c){c.preventDefault();a.fancybox.prev()}),x.click(function(c){c.preventDefault();a.fancybox.next()}),
a.fn.mousewheel&&e.bind("mousewheel.fb",function(c,b){if(k)c.preventDefault();else if(0==a(c.target).get(0).clientHeight||a(c.target).get(0).scrollHeight===a(c.target).get(0).clientHeight)c.preventDefault(),a.fancybox[0<b?"prev":"next"]()}),a.support.opacity||e.addClass("fancybox-ie"),I&&(s.addClass("fancybox-ie6"),e.addClass("fancybox-ie6"),a('<iframe id="fancybox-hide-sel-frame" src="'+(/^https/i.test(window.location.href||"")?"javascript:void(false)":"about:blank")+'" scrolling="no" border="0" frameborder="0" tabindex="-1"></iframe>').prependTo(z)))};
a.fn.fancybox.defaults={padding:10,margin:40,opacity:!1,modal:!1,cyclic:!1,scrolling:"auto",width:560,height:340,autoScale:!0,autoDimensions:!0,centerOnScroll:!1,ajax:{},swf:{wmode:"transparent"},hideOnOverlayClick:!0,hideOnContentClick:!1,overlayShow:!0,overlayOpacity:0.7,overlayColor:"#777",titleShow:!0,titlePosition:"float",titleFormat:null,titleFromAlt:!1,transitionIn:"fade",transitionOut:"fade",speedIn:300,speedOut:300,changeSpeed:300,changeFade:"fast",easingIn:"swing",easingOut:"swing",showCloseButton:!0,
showNavArrows:!0,enableEscapeButton:!0,enableKeyboardNav:!0,onStart:function(){},onCancel:function(){},onComplete:function(){},onCleanup:function(){},onClosed:function(){},onError:function(){}};a(document).ready(function(){a.fancybox.init()})})(jQuery);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-rte-html5-resources', location = 'js/gliffy-editor-iframe.js' */
AJS.bind("gliffy.init.rte", function (event) {
    (function ($) {

        var openDiagram = function (options) {

            var editorCloseCallbackFunctions = [];
            var editorCloseCallback = function(closeEvent) {
                editorCloseCallbackFunctions.forEach(function(currentValue/*, index, array*/) {
                    currentValue(closeEvent);
                });
            };

            // fire event on close
            editorCloseCallbackFunctions.push(function (closeEvent) {
                AJS.trigger("gliffy.confluence.inlineEditorClosed");
            });
            // Diagram JSON .gon data exists
            if(options.gonContent) {
                options.editor.html5Editor.open({
                    jsonObj: options.gonContent,
                    dirty: true
                });

            // Blank diagram template (new, empty diagram)
            } else if (options.template.category == "com.gliffy.templates.blank") {
                options.editor.html5Editor.create(null, options.template.panels);

            // Existing diagram attachment
            } else if (options.template.category == "com.gliffy.diagram") {

                options.editor.html5Editor.open({
                    url:AJS.format("/diagrams/{0}", options.attachmentId)
                });
            // Transform?
            } else if (options.template.category == "com.gliffy.transform.diagram") {
                options.editor.html5Editor.open({
                    url:AJS.format("/templates/transform/{0}", options.template.name),
                    dirty:true
                });

            // Open an html5 template?
            } else {
                options.editor.html5Editor.open({
                    url:AJS.format("/templates/{0}",
                        options.template.name),
                    useShapeStyles:false,
                    dirty:true
                });
            }

            options.editor.show();

            // GCONF-1941: editor focus problem
            GLIFFY.confluence.fixEditorFocus();

            // GCONF-1914: Attach close callback to base editor.
            options.editor.html5Editor.postCloseCallback = editorCloseCallback;
        };

        // Launches the editor when in page edit mode (not page view mode).
        var launchInlineEditor = function (options) {
            options = $.extend({
                diagramName:null,
                template:{category:"com.gliffy.templates.blank", name:"com.gliffy.template.blank"},
                attachmentId:null,
                panels:null
            }, options);

            options.editor.loadedCallback = function(draft) {
                if (draft) {
                    options.gonContent = draft;                    
                }
                openDiagram(options);
            }

            // Always update URL as it is used for pinned version dialog logic
            var url;
            if(options.ownerPageId) {
                url = AJS.format("{0}/plugins/gliffy/editor.action?ceoid={1}&inline=true&pageId={2}&attachmentVersion={3}&originalAttachmentVersion={4}&isPinned={5}&wootric={6}",
                    AJS.Confluence.getContextPath(), options.ownerPageId,
                    options.referencePageId, options.attachmentVersion,
                    options.originalAttachmentVersion || options.attachmentVersion || 0,
                    options.isPinned, options.wootric);
            } else {
                url = AJS.format("{0}/plugins/gliffy/editor.action?ceoid={1}&version={2}&pagePin={3}&wootric={4}",
                    AJS.Confluence.getContextPath(),
                    Confluence.Editor.getContentId(),
                    options.isPinned || 0, options.wootric);
            }
            url += options.diagramName ? '&name=' + encodeURIComponent(options.diagramName) : '';
            url += options.displayName ? '&displayName=' + encodeURIComponent(options.displayName) : '';
            url += options.macroId ? '&macroId=' + options.macroId : '';

            if (!options.editor.obj) {
                // setup the html5 editor iframe. the iframe will load the diagram via the GLIFFY._confluence.editor.loaded function
                // Wait blanket + spinner
                $("body").append($('<div class="gliffy-spinner gliffy-spinner-icon"></div><div class="gliffy-spinner gliffy-spinner-bg"></div>'));
                options.editor.obj = $("<iframe />", {src:url, id:"gliffy-editor"})
                    .css({
                        position:"absolute",
                        width:"100%",
                        height:"100%",
                        top:0,
                        left:0,
                        border:0
                    }).appendTo("body");
            } else {
                options.editor.obj.attr("src", url);
                openDiagram(options);
            }
        };

        AJS.bind("gliffy.confluence.launchInlineEditor", function (event, options) {
            launchInlineEditor(options);
        });

        // Launch the Editor with diagram JSON .gon data
        AJS.bind("gliffy.confluence.launchEditorWithGonData", function (event, gonContent) {
            try {
                if (GLIFFY._confluence.macroDialog) {
                    GLIFFY._confluence.macroDialog.hide();
                }
            }
            catch (e) {
                console.log("Error hiding Gliffy macro dialog on gliffy.confluence.launchEditorWithGonData: " + e);
            }
            launchInlineEditor({
                editor:GLIFFY._confluence.editor,
                gonContent:gonContent
            });
        });

        AJS.bind("gliffy.confluence.launchTemplate", function (event, category, name, panels) {
            try {
                if (GLIFFY._confluence.macroDialog) {
                    GLIFFY._confluence.macroDialog.hide();
                }
            }
            catch (e) {
                console.log("Error hiding Gliffy macro dialog on gliffy.confluence.launchTemplate: " + e);
            }
            launchInlineEditor({
                editor:GLIFFY._confluence.editor,
                template:{category:category, name:name, panels:panels}
            });
        });

        AJS.bind("gliffy.confluence.addGliffyDiagramToPage", function (event, category, name) {
            try {
                if (GLIFFY._confluence.macroDialog) {
                    GLIFFY._confluence.macroDialog.hide();
                }
            }
            catch (e) {
                console.log("Error hiding Gliffy macro dialog on gliffy.confluence.addGliffyDiagramToPage: " + e);
            }
            var macroRenderRequest = {
                contentId:Confluence.Editor.getContentId(),
                macro:{
                    name:"gliffy",
                    params:{name:name, blueprint:category},
                    defaultParameterValue:"",
                    body:""
                }
            };
            GLIFFY.confluence.insertMacro(macroRenderRequest);
        });
    }(AJS.$));
});

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-rte-html5-resources', location = 'js/PromiseJS.js' */
//Add generic support for Deferred/Promise since the oldest supported version of Confluence uses JQuery 1.4.2
//https://github.com/hemanshubhojak/PromiseJS
(function (global) {

    var states = {
        Pending: "Pending",
        Resolved: "Resolved",
        Rejected: "Rejected"
    };

    //http://jira.gliffy.com/browse/GCONF-1398 For each polyfill!
    if ( !Array.prototype.forEach ) {
        Array.prototype.forEach = function(fn, scope) {
            for(var i = 0, len = this.length; i < len; ++i) {
                if (i in this) {
                    fn.call(scope, this[i], i, this);
                }
            }
        };
    }

    /**
     * @constructor
     */
    function Deferred() {
        var self = this,
            successCallbacks = [],
            failCallbacks = [],
            progressCallbacks = [],
            state = states.Pending,
            value;

        /**
         * @constructor
         */
        function Promise() {
            var self = this;

            self.success = function (callback) {
                if (state === states.Resolved) {
                    callback.call(self, value);
                }
                else {
                    successCallbacks.push(callback);
                }

                return self;
            };

            self.fail = function (callback) {
                if (state === states.Rejected) {
                    callback.call(self, value);
                }
                else {
                    failCallbacks.push(callback);
                }

                return self;
            };

            self.progress = function (callback) {
                progressCallbacks.push(callback);
                return self;
            };

            self.always = function (callback) {
                return self.success(callback).fail(callback);
            };

            self.then = function (onSuccess, onError) {
                return self.success(onSuccess).fail(onError);
            };

            self.isPending = function () {
                return state === states.Pending;
            };

            self.isResolved = function () {
                return state === states.Resolved;
            };

            self.isRejected = function () {
                return state === states.Rejected;
            };

            self.value = function () {
                return value;
            };
        }

        self.promise = new Promise();

        self.resolve = function (result) {
            if (state === states.Pending) {
                state = states.Resolved;
                value = result;
                successCallbacks.forEach(function (cb) {
                    cb.call(self.promise, value);
                });
            }
        };

        self.reject = function (error) {
            if (state === states.Pending) {
                state = states.Rejected;
                value = error;
                failCallbacks.forEach(function (cb) {
                    cb.call(self.promise, value);
                });
            }
        };

        self.notify = function () {
            if (state === states.Pending) {
                progressCallbacks.forEach(function (cb) {
                    cb.call(self.promise);
                });
            }
        };
    }

    function isArray(value) {
        return Object.prototype.toString.call(value) === "[object Array]";
    }

    function when(array) {
        var promises = isArray(array) ? array : Array.prototype.slice.call(arguments, 0),
            total = promises.length, completed = 0,
            d = new Deferred();

        promises.forEach(function (p) {
            p.always(function () {
                completed += 1;

                if (completed === total) {
                    d.resolve(promises);
                }
            });
        });

        return d.promise;
    }

    function executeChain(funcs, deferred, promises) {
        if (funcs.length === 0) {
            deferred.resolve(promises);
        }
        else {
            var promise = funcs[0].call();

            promise.always(function () {
                executeChain(
                    Array.prototype.slice.call(funcs, 1),
                    deferred,
                    promises.concat([promise])
                );
            });
        }
    }

    function chain(array) {
        var funcs = isArray(array) ? array : Array.prototype.slice.call(arguments, 0),
            d = new Deferred();

        if (funcs.length === 0) {
            d.resolve();
        }
        else {
            executeChain(funcs, d, []);
        }

        return d.promise;
    }

    global.PromiseJS = {
        Deferred: Deferred,
        when: when,
        chain: chain
    };

    //  For CommonJS environments
    if( typeof exports !== "undefined" ){
        exports.PromiseJS = global.PromiseJS;
    }

}((function () { return this; }.call())));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-rte-html5-resources', location = 'js/gliffy-rte-utils.js' */
(function($) {
    AJS.bind("init.rte", function() {
        AJS.trigger("gliffy.init.rte");
    });
}(AJS.$));

AJS.bind("gliffy.init.rte", function (event) {
    (function ($) {

        window["GLIFFY"] = window["GLIFFY"] || {};
        GLIFFY._confluence = GLIFFY._confluence || {};
        GLIFFY._confluence.gvars = {
            gliffyApiEndpoint : AJS.format("{0}/rest/gliffy/1.0", AJS.Confluence.getContextPath()),
            isAutoSearchOn : true, //this should be more tightly coupled with actual logic
            spaces : []
        };
        GLIFFY._confluence.utils = {
            // GJIRA-1890: Enhanced to also handle DOM nodes from RTE.
            getMacroParams : function (macro) {
                var macroParams = {};
                // Look for data from jQuery node.
                var macroParamsString = macro.data && macro.data("macro-parameters");
                // If none, look for data from RTE DOM node.
                macroParamsString = macroParamsString || (macro.dataset && macro.dataset.macroParameters);
                // If string found, parse into params object (KEY1=Value1|KEY2=Value2|KEY3=Value|...)
                if (macroParamsString) {
                    $.each(macroParamsString.split("|"), function (idx, item) {
                        var param = item.split("=");
                        macroParams[param[0]] = param[1];
                    });
                }
                return macroParams;
            },
            getUrlVars : function () {
                var vars = [], hash;
                var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');
                for (var i = 0; i < hashes.length; i++) {
                    hash = hashes[i].split('=');
                    vars.push(hash[0]);
                    vars[hash[0]] = decodeURIComponent(hash[1]);
                }
                return vars;
            },
            parseError : function (xhr) {
                if (xhr.responseText != null) {
                    try {
                        var responseObj = $.parseJSON(xhr.responseText);
                        return (responseObj.message != null) ? responseObj.message : xhr.responseText;
                    }
                    catch (e) {
                        return xhr.responseText;
                    }
                }
                return "";
            },
            analyticsEvent : function(type, options){
                $(window).trigger(type+'.gliffyAnalytics', options);
            },

            getAnalyticsLabel : function(){
                return 'none';
            },

            getAnalyticsProduct : function(){
                return 'Confluence';
            },

            getAnalyticsLicense : function(){
                return $('meta[name=gliffy-license-type]').attr("content");
            },

            getAnalyticsNumUsers : function(){
                return parseInt($('meta[name=gliffy-license-quantity]').attr("content"))
            },

            initAnalytics : function(){

                var analyticsLabel = GLIFFY._confluence.utils.getAnalyticsLabel(), deferred;

                //add support for deferred for old versions of confluence. use jQuery deferred once min version of jQuery is 1.5
                deferred = new PromiseJS.Deferred();
                $.ajax({
                    url : AJS.format("{0}/rest/gliffy/1.0/properties/com.gliffy.integration.confluence.ANALYTICS_OFF",
                        Confluence.getContextPath()),
                    type: "GET",
                    cache : false,
                    success: function(analyticsOff) {
                        if (!analyticsOff) {
                            GLIFFY._confluence.utils.analyticsEvent('init', {accountType:'google', accountID:'UA-248648-13', optPageName:'Gliffy Confluence RTE Init'});
                            // to debug analytics, uncomment the following line
                            //GLIFFY._confluence.utils.analyticsEvent('logEvents', {logEvents:true, logger:console});
                            GLIFFY._confluence.utils.analyticsEvent('setLabel', {label:analyticsLabel});
                            GLIFFY._confluence.utils.analyticsEvent('setCustomVariables', {
                                product : GLIFFY._confluence.utils.getAnalyticsProduct(),
                                license : GLIFFY._confluence.utils.getAnalyticsLicense(),
                                numUsers : (GLIFFY._confluence.utils.getAnalyticsNumUsers() + " Users")
                            });
                        }
                        deferred.resolve(data);
                    },
                    error: function(xhr, status, error) {
                        AJS.log('Error determining if analytics is available', error)
                        deferred.reject(xhr);
                    },
                    dataType : "json"
                });
                return deferred.promise;

            }
        };

        //confluence specific methods
        var CMeth = function () {
            var fixEditorFocus = function () {
                //remove this if chrome+mac gets rid of focus issue.
                if (AJS.Rte.getEditorFrame) {
                    $(AJS.Rte.getEditorFrame()).focus();
                }

                // GCONF-1941: fix editor focus. Perhaps AJS.Rte.getEditorFrame may not be set?
                var gliffyEditorIFrame = $("#gliffy-editor")[0];
                if(gliffyEditorIFrame) {
                    gliffyEditorIFrame.contentWindow.focus();
                }
            };
            var originalReplaceNodeFunction = tinymce.confluence.NodeUtils.replaceNode;
            var replaceNode = function (oldNode, newNode) {
                var that =  tinymce.confluence.NodeUtils,
                    ed = tinymce.activeEditor,
                    doc = that.getDoc(),
                    $newNode = $(newNode, doc),
                    $oldNode = $(oldNode, doc);
                /**
                 * Waiting for an image to be fully loaded into the DOM in the background is an asynchronous operation - hence use a jQuery.Deferred here.
                 */
                return $.Deferred(function () {
                    var deferred = this;
                    if ($newNode.is("img")) {
                        /**
                         * Here we're delaying the replacement of the node until the image's src has been
                         * fully loaded by the browser.
                         */
                        $newNode[0].onload = function() {
                            AJS.log("replaceNode: new node's src has been loaded by the browser.");
                            this.onload = null;
                            deferred.resolve(this);
                        };
// In Opera, the src has to be defined after the onLoad callback or it won't work.
                        if ($.browser.opera) {
                            $newNode[0].src = $newNode.attr('src');
                        }
                        //============ gliffy modification ===========//
                        setTimeout(function() {
                            //insert the macro anyway if the image fails to load
                            deferred.resolve($newNode[0]);
                        }, 3000);
                        //============ gliffy modification ===========//
                        /**
                         * Trigger rendering of the new DOM node, in turn requesting the image's src,
                         * ultimately triggering the onLoad event above.
                         */
                        doc.createDocumentFragment().appendChild($newNode[0]);
                    } else {
                        deferred.resolve($newNode[0]);
                    }
                }).done(function(newNode) {
                    $oldNode.replaceWith(newNode);
                }).promise();
            };
            var insertMacro = function (args, nodeToReplace) {
                var deferred, defaultParams = {
                    contentId : Confluence.Editor.getContentId(),
                    macro : { name : "gliffy", params : "", defaultParameterValue : "", body : ""}
                };

                if($.browser.msie && AJS.$.Deferred) {
                    //remove this once https://jira.atlassian.com/browse/CONF-28418 is fixed
                    tinymce.confluence.NodeUtils.replaceNode = replaceNode;
                }

                AJS.Rte.BookmarkManager.restoreBookmark();
                deferred = tinymce.confluence.MacroUtils.insertMacro($.extend(true, defaultParams, args), nodeToReplace);

                if(deferred && deferred.then) {
                    deferred.then(function() {
                        if($.browser.msie) {
                            //remove this once https://jira.atlassian.com/browse/CONF-28418 is fixed
                            tinymce.confluence.NodeUtils.replaceNode = originalReplaceNodeFunction;
                        }
                    }, function() {
                        if($.browser.msie) {
                            //remove this once https://jira.atlassian.com/browse/CONF-28418 is fixed
                            tinymce.confluence.NodeUtils.replaceNode = originalReplaceNodeFunction;
                        }
                    });
                }
                AJS.log("insert gliffy macro");
                fixEditorFocus();
                return deferred;
            };

            var setMacroParam = function(fieldName, fieldValue, param) {
                var macros = $(AJS.Rte.getEditor().dom.select('.editor-inline-macro')).filter(function (index) {
                    return $(this).data("macro-name") === 'gliffy' && $(this).attr("data-macro-parameters").indexOf(fieldName + '=' + fieldValue) != -1;
                });
                macros.each(function(index){
                    var macroData = {
                        contentId: Confluence.Editor.getContentId(),
                        macro:{
                            name:'gliffy',
                            params: GLIFFY._confluence.utils.getMacroParams(macros[index])
                        }
                    };
                    if (!macroData.macro.params.pageid) {
                        //GCONF-2730: Addresses IE10 issue
                        if (macroData.macro.params.name === undefined) {
                            macroData.macro.params.name = name;
                        }
                        macroData.macro.params = Object.assign(macroData.macro.params, param);
                        tinymce.confluence.MacroUtils.insertMacro(macroData, macros[index]);
                    }
                });
            };

            var setPagePin = function(name, version, displayName) {
                var macros = $(AJS.Rte.getEditor().dom.select('.editor-inline-macro')).filter(function (index) {
                    return $(this).data("macro-name") === 'gliffy' && $(this).attr("data-macro-parameters").indexOf('name=' + name) != -1;
                });
                macros.each(function(index){
                    var macroData = {
                        contentId: Confluence.Editor.getContentId(),
                        macro:{
                            name:'gliffy',
                            params: GLIFFY._confluence.utils.getMacroParams(macros[index])
                        }
                    };
                    if (!macroData.macro.params.pageid) {
                        //GCONF-2730: Addresses IE10 issue
                        if (macroData.macro.params.name === undefined) {
                            macroData.macro.params.name = name;
                            macroData.macro.params.displayName = displayName || name;
                        }
                        macroData.macro.params.pagePin = version;
                        macroData.macro.params.displayName = displayName || name;
                        tinymce.confluence.MacroUtils.insertMacro(macroData, macros[index]);
                    }
                });
            };

            var updatePagePinVersion = function(name, version) {
                var macros = $(AJS.Rte.getEditor().dom.select('.editor-inline-macro')).filter(function (index) {
                    return $(this).data("macro-name") === 'gliffy' && $(this).attr("data-macro-parameters").indexOf('name=' + name) != -1;
                });
                macros.each(function(index){
                    var macroData = {
                        contentId: Confluence.Editor.getContentId(),
                        macro:{
                            name:'gliffy',
                            params: GLIFFY._confluence.utils.getMacroParams(macros[index])
                        }
                    };
                    if (!macroData.macro.params.pageid) {
                        //GCONF-2730: Addresses IE10 issue
                        if (macroData.macro.params.name === undefined) {
                            macroData.macro.params.name = name;
                        }
                        macroData.macro.params.version = version;
                        macroData.macro.params.pagePin = version;
                        tinymce.confluence.MacroUtils.insertMacro(macroData, macros[index]);
                    }
                });

            };

            return {
                setMacroParam: setMacroParam,
                setPagePin: setPagePin,
                updatePagePinVersion: updatePagePinVersion,
                getMacroParams : GLIFFY._confluence.utils.getMacroParams,
                insertMacro : insertMacro,
                fixEditorFocus : fixEditorFocus,
                updateMacros : function (macroname) {
                    //find all matching macros in the editor iframe
                    var macros = $(AJS.Rte.getEditor().dom.select('.editor-inline-macro')).filter(function (index) {
                        return $(this).data("macro-name") === macroname;
                    });
                    macros.each(function (index, element) {
                        var macro = $(this);
                        var macroParams = GLIFFY._confluence.utils.getMacroParams(macro);
                        var dataJson = $.toJSON({contentId : Confluence.Editor.getContentId(), macro : {name : macro.data("macro-name"), params : macroParams, body : "", defaultParameterValue : ""}});

                        $.ajax({
                            type : "POST",
                            contentType : "application/json; charset=utf-8",
                            url : Confluence.getContextPath() + "/rest/tinymce/1/macro/placeholder",
                            data : dataJson,
                            dataType : "text",
                            success : function (macroplaceholder) {
                                macro.after(macroplaceholder);
                                macro.remove();
                            }
                        });
                    });
                }
            }
        };
        GLIFFY.confluence = CMeth();

    }(AJS.$));
});

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-rte-html5-resources', location = 'js/gliffy-rte-editor-html5.js' */
AJS.bind("gliffy.init.rte", function (event) {
    (function ($) {
        GLIFFY._confluence.editor = {
            obj:null,
            parentOverflow:null,
            isHtml5:true,
            loadedCallback:null,
            show:function () {
                // GCONF-606 Update Editor position for Editor in inline comment
                $("#gliffy-editor").css("top", $(document).scrollTop());
                this.obj.parent().css("overflow", "hidden");

                if (GLIFFY._confluence.editor.hidden) {
                    if ($.browser.msie) { //GCONF-854 IE9 crashes on hidden iframe operations, see JIRA for details
                        GLIFFY._confluence.editor.obj.css('visibility', 'visible');
                    } else {
                        GLIFFY._confluence.editor.obj.show();
                    }
                    GLIFFY._confluence.editor.hidden = false;
                }

                // GCONF-1941: editor focus problem
                GLIFFY._confluence.editor.html5Editor.focus();

                $("#gliffy-close").show();
                $("#gliffy-load-buttons").hide();
            },

            hide:function () {

                if (!GLIFFY._confluence.editor.hidden) {
                    if ($.browser.msie) { //GCONF-854 IE9 crashes on hidden iframe operations, see JIRA for details
                        GLIFFY._confluence.editor.obj.css('visibility', 'hidden');
                    } else {
                        GLIFFY._confluence.editor.obj.hide();
                    }
                    GLIFFY._confluence.editor.hidden = true;
                }

                $("#gliffy-close").hide();
                $("#gliffy-load-buttons").show();

                // GCONF-606 Update Editor position for Editor in inline comment
                this.obj.parent().css({overflow:this.parentOverflow});
            },
            hidden:false,
            html5Editor:null,
            loaded:function (html5Editor, draft) {
                GLIFFY._confluence.editor.html5Editor = html5Editor;

                // GCONF-606 Update Editor position for Editor in inline comment
                this.parentOverflow = $("#gliffy-editor").parent().css("overflow");
                $(".gliffy-spinner").remove();

                if(this.loadedCallback) {
                    this.loadedCallback(draft);
                }
            },
            hideSpinner : function() {
                $(".gliffy-spinner").remove();
            }
        };

    }(AJS.$));
});

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-rte-html5-resources', location = 'js/gliffy-rte-macro.js' */
/**
 * Gliffy RTE Macro v2
 * @author Kerry Liu
 */
AJS.bind("gliffy.init.rte", function (event) {
    (function ($) {

        //this will attempt to insert thr pagePin property into the macro so that all macros get pinned
        //if the page is saved.
        var pagePinAllUnpinnedMacros = function() {
            var macros = $(AJS.Rte.getEditor().dom.select('.editor-inline-macro')).filter(function (index) {
                return $(this).data("macro-name") === 'gliffy';
            });
            macros.each(function (m) {
                var paramArray = $(this).attr("data-macro-parameters").split('|');
                var params = {};
                _.each(paramArray, function(a) {
                    a = a.split('=');
                    params[a[0]] = a[1];
                });
                if (!params.pagePin && !params.pageid && params.name) {
                    var pageId = Confluence.Editor.getContentId();
                    $.ajax(AJS.contextPath() + '/rest/api/content/' + pageId + '/child/attachment?expand=version&filename=' + encodeURIComponent(params.name)).then(function(resp) {
                        GLIFFY.confluence.setPagePin(params.name, resp.results[0].version.number);
                    }).fail(function(err) {
                        console.log('could not get ' + params.name);
                    });
                }
            });
        };

        var setPagePinVersionForCopyPage = function() {
            var macros = $(AJS.Rte.getEditor().dom.select('.editor-inline-macro')).filter(function (index) {
                return $(this).data("macro-name") === 'gliffy';
            });
            macros.each(function() {
                var paramArray = $(this).attr("data-macro-parameters").split('|');
                var params = {};
                _.each(paramArray, function(a) {
                    a = a.split('=');
                    params[a[0]] = a[1];
                });
                if (params.name) {
                    var pageId = Confluence.Editor.getContentId();
                    $.ajax(AJS.contextPath() + '/rest/api/content/' + pageId + '/child/attachment?expand=version&filename=' + encodeURIComponent(params.name)).then(function(resp) {
                        var attVersion = resp.results[0].version.number;
                        if ( !params.version && params.pagePin > attVersion) {
                            GLIFFY.confluence.setPagePin(params.name, resp.results[0].version.number);
                        } else if (params.version && params.pagePin > attVersion) {
                            GLIFFY.confluence.updatePagePinVersion(params.name, resp.results[0].version.number);
                        }
                    }).fail(function(err) {
                        console.log('could not get ' + params.name);
                    });
                }
            });
        };

        //Ugly hack.  Doesn't seem to be a way to sync the editor content to be ready, so set an interval to
        // check for the page content to become available
        AJS.toInit(function() {

            var contentQuery = setTimeout(function () {
                var html = $(AJS.Rte.getEditor().dom.select('.mceContentBody'));
                if (html.length > 0) {
                    pagePinAllUnpinnedMacros();
                    setPagePinVersionForCopyPage();
                    clearInterval(contentQuery);
                }
            }, 500);
        });



        //note: old versions of confluence uses jQuery < 1.7 avoid using on/off until we no longer support these versions.
        var CreatePanel, Panel, TemplateCategoryPanel, ImportPanel, InsertPanel, BlueprintCategoryPanel,
        //RCB: temporary until we decide whether to launchEditor or drop a diagram directly on the page.
            skipLaunchEditor = false;

        var GliffySpinner = require('GliffySpinner');
        var recentSpinner;
        var importSpinner;
        function analyticsEvent(type, options) {
            $(window).trigger(type + '.gliffyAnalytics', options);
        }

        /******************************************************************/
        /*                         Panels                                 */
        /******************************************************************/
        /*
         Each panel should have the following methods:

         isTemplateCategory() - true if the panel is a template category
         getName() - name of the panel
         getPanelLink() - sidebar li markup
         getTemplate() - returns the html for the panel
         primaryAction(event, baseDialog) - what the panel does, when the primary button is clicked
         getPrimaryButtonText() - i18n text for the primary button ie, "Create" or "Insert Template"
         setup(baseDialog) - bind any necessary handlers/populate your panel (called whenever it is rendered)
         teardown(baseDialog) - unbind any events that were bound to the panel in bindEvents

         Note: Events for elements with class "gliffy-template" are already handled by the macro dialog, and do
         not need to be bound by your panel. Double clicking on a "gliffy-template element, will also trigger
         the primary action.
         */

        Panel = function (name) {
            this.name = name;
        };
        Panel.prototype.isTemplateCategory = function () {
            return false;
        };
        Panel.prototype.getName = function () {
            return this.name;
        };
        Panel.prototype.getPanelLink = function () {
            return gliffySoy.macro.dialog.panelLink({
                key:this.getName(),
                title:this.getPanelText()
            });
        };
        Panel.prototype.getTemplate = function () {
            return "";
        };
        Panel.prototype.getPanelText = function () {
            return "";
        };
        Panel.prototype.primaryAction = function (event, baseDialog, macroDialog) {
            event.preventDefault();
            event.stopPropagation();
            var template = baseDialog.find(".gliffy-content .gliffy-template.gliffy-active");
            //Actual editor launch logic is in gliffy-rte-editor-html5.js
            AJS.trigger('createpagetemplate', [template.data("category"), template.data("name")]);
        };
        Panel.prototype.getPrimaryButtonText = function () {
            return "";
        };
        Panel.prototype.setup = function (baseDialog) {
        };
        Panel.prototype.teardown = function (baseDialog) {
        };

        /******************************************************************/
        /*                      Create Panel                              */
        /******************************************************************/

        CreatePanel = function () {
        };
        CreatePanel.prototype = new Panel("create");
        CreatePanel.prototype.getTemplate = function () {
            return gliffySoy.macro.dialog.createPanel();
        };
        CreatePanel.prototype.primaryAction = function (event, baseDialog, macroDialog) {
            event.preventDefault();
            event.stopPropagation();
            var template = baseDialog.find(".gliffy-content .gliffy-template.gliffy-active"),
                name = template.data("name"),
                panels = template.data("panels"),
                isRecent, blankName;
            //Actual editor launch logic is in gliffy-rte-editor-html5.js
            isRecent = name !== "blank";
            blankName = panels ? "blank_" + panels : "blank";
            analyticsEvent('trackEvent', {category:'panelCreate', action:isRecent ? "recent" : blankName});

            if (panels) {
                if (panels === "basic") {
                    panels = [
                        "com.gliffy.libraries.flowchart.flowchart_v1.default",
                        "com.gliffy.libraries.basic.basic_v1.default",
                        "com.gliffy.libraries.swimlanes.swimlanes_v1.default",
                        "com.gliffy.libraries.images"
                    ];
                } else if (panels === "cloud") {
                    panels = [
                        "glib.aws_v2.compute",
                        "glib.aws_v2.database",
                        "glib.aws_v2.application_services",
                        "glib.azure_v1",
                        "glib.gcp_v1.compute",
                        "glib.gcp_v1.storage_and_databases",
                        "glib.gcp_v1.big_data",
                        "com.gliffy.libraries.uml.uml_v2.use_case",
                        "com.gliffy.libraries.erd.erd_v1.default",
                        "com.gliffy.libraries.basic.basic_v1.default"
                    ]
                } else if (panels === "flowchart") {
                    panels = [
                        "com.gliffy.libraries.flowchart.flowchart_v1.default",
                        "com.gliffy.libraries.basic.basic_v1.default",
                        "com.gliffy.libraries.swimlanes.swimlanes_v1.default",
                        "com.gliffy.libraries.images"
                    ];
                } else if (panels === "software") {
                    panels = [
                        "com.gliffy.libraries.uml.uml_v2.class",
                        "com.gliffy.libraries.uml.uml_v2.sequence",
                        "com.gliffy.libraries.uml.uml_v2.activity",
                        "com.gliffy.libraries.uml.uml_v2.state_machine",
                        "com.gliffy.libraries.uml.uml_v2.deployment",
                        "com.gliffy.libraries.uml.uml_v2.component",
                        "com.gliffy.libraries.uml.uml_v2.use_case",
                        "com.gliffy.libraries.erd.erd_v1.default",
                        "com.gliffy.libraries.basic.basic_v1.default",
                        "com.gliffy.libraries.images"
                    ];
                } else if (panels === "bpmn") {
                    panels = [
                        "com.gliffy.libraries.flowchart.flowchart_v1.default",
                        "com.gliffy.libraries.basic.basic_v1.default",
                        "com.gliffy.libraries.bpmn.bpmn_v1.events",
                        "com.gliffy.libraries.bpmn.bpmn_v1.activities",
                        "com.gliffy.libraries.bpmn.bpmn_v1.data_artifacts",
                        "com.gliffy.libraries.bpmn.bpmn_v1.gateways",
                        "com.gliffy.libraries.bpmn.bpmn_v1.connectors",
                        "com.gliffy.libraries.swimlanes.swimlanes_v1.default",
                        "com.gliffy.libraries.images"
                    ];
                } else if (panels === "network") {
                    panels = [
                        "com.gliffy.libraries.network.network_v4.rack",
                        "com.gliffy.libraries.network.network_v4.business",
                        "com.gliffy.libraries.network.network_v4.home",
                        "com.gliffy.libraries.basic.basic_v1.default",
                        "com.gliffy.libraries.images"
                    ];
                } else if (panels === "ui") {
                    panels = [
                        "com.gliffy.libraries.ui.ui_v3.containers_content",
                        "com.gliffy.libraries.ui.ui_v3.navigation",
                        "com.gliffy.libraries.ui.ui_v3.forms_controls",
                        "com.gliffy.libraries.ui.ui_v3.icon_symbols",
                        "com.gliffy.libraries.ui.ui_v2.forms_components",
                        "com.gliffy.libraries.ui.ui_v2.content",
                        "com.gliffy.libraries.ui.ui_v2.miscellaneous",
                        "com.gliffy.libraries.basic.basic_v1.default",
                        "com.gliffy.libraries.images"
                    ]
                } else if (panels === "venn") {
                    panels = [
                        "com.gliffy.libraries.venn.outline.default",
                        "com.gliffy.libraries.venn.flat.default",
                        "com.gliffy.libraries.venn.radial.default",
                        "com.gliffy.libraries.basic.basic_v1.default",
                        "com.gliffy.libraries.images"
                    ]
                } else if (panels === "org") {
                    panels = [
                        "com.gliffy.libraries.flowchart.flowchart_v1.default",
                        "com.gliffy.libraries.basic.basic_v1.default",
                        "com.gliffy.libraries.images"
                    ]
                }
            }
            AJS.trigger("gliffy.confluence.launchTemplate", [template.data("category"), name, panels]);

        };
        CreatePanel.prototype.getPanelText = function () {
            return "Create a New Diagram";
        };
        CreatePanel.prototype.getPrimaryButtonText = function (event) {
            return "Create";
        };
        CreatePanel.prototype.setup = function (baseDialog) {
            //get most recent diagrams
            var params = { matchAll:true, sort:"modified", order:"descending", index:0, results:50, filterByUser:true},
                done = false;
            //stick in a spinner for recent results

            $.ajax({
                url:GLIFFY._confluence.gvars.gliffyApiEndpoint + "/diagrams.json",
                dataType:'json',
                data:params,
                cache:false,
                success:function (data) {
                    done = true;
                    recentSpinner.stop();
                    baseDialog.find(".gliffy-content .gliffy-recent-results").append(gliffySoy.macro.dialog.searchResults({
                        diagrams: data.diagrams,
                        rootApi: GLIFFY._confluence.gvars.gliffyApiEndpoint
                    }));
                },
                error:function (xhr) {
                    done = true;
                    recentSpinner.stop();
                    baseDialog.find(".gliffy-content .gliffy-recent-results").append(gliffySoy.macro.dialog.searchResults({
                        diagrams:[],
                        rootApi:GLIFFY._confluence.gvars.gliffyApiEndpoint
                    }));
                }
            });

            recentSpinner = new GliffySpinner(baseDialog.find(".gliffy-content .gliffy-recent-results").get(0), {
                radius:25,
                color:'#666',
                inline:true
            });

            //wait 100ms, then show the spinner if it's not done
            setTimeout(function () {
                if (!done) {
                    recentSpinner.start();
                }
            }, 100);


        };
        CreatePanel.prototype.teardown = function (baseDialog) {
        };

        /******************************************************************/
        /*       Insert/Search/Create from template Diagram Panel         */
        /******************************************************************/
        InsertPanel = function (insertOnly, message, blueprint) {
            var self = this;

            this.insertOnly = insertOnly || false; //if true, the user can only insert items
            this.message = message || null;
            this.blueprint = blueprint || false;

            //DO NOT translate shortName values! they are not displayed to the user.
            this.spaces = [
                {longName:"All Spaces", shortName:""}
            ];
            this.sort = [
                {longName:"Last Modified", shortName:"modified"},
                {longName:"Title", shortName:"title"},
                {longName:"Created", shortName:"created"}
            ];
            this.name = "insert";
            this.view = "grid";
            this.query = "";
            this.maxSpaces = 50;
            this.offset = 0;

            //query for spaces
            $.ajax({
                type:"GET",
                url:AJS.format("{0}/rest/api/space?start=0&limit=" + this.maxSpaces, Confluence.getContextPath()),
                dataType:"json",
                cache:false,
                success:function (data) {
                    self.offset += data.results.length;
                    for (var i = 0; i < data.results.length; i++) {
                        self.spaces.push({shortName: data.results[i].key, longName: data.results[i].name});
                    }
                },
                error:function (xhr, textstatus, errorThrown) {
                    AJS.log("space service unavailable " + textstatus);
                }
            });

        };
        InsertPanel.prototype = new Panel();
        InsertPanel.prototype.constructor = InsertPanel;
        InsertPanel.prototype.getTemplate = function () {
            return gliffySoy.macro.dialog.insertPanel({
                query:this.query,
                insertOnly:this.insertOnly,
                message:this.message
            });
        };
        InsertPanel.prototype.getPanelText = function () {
            return "Search for a Diagram";
        };
        InsertPanel.prototype.getPrimaryButtonText = function () {
            if (this.insertOnly) {
                return "Insert Diagram";
            } else {
                return "Use as a Template";
            }
        };
        InsertPanel.prototype.scroll = function(e, baseDialog) {

            var self = this,
                now = (new Date()).getTime();

            if(!self.__tempTime) {
                self.__scrolling = true;
                self.__tempTime = now;
            } else if (now - self.__tempTime > 200 && !self.__scrolling) {
                self.__scrolling = true;
                self.__tempTime = now;
            }

            clearTimeout(self.__scrollTimeout);
            self.__scrollTimeout = setTimeout(function () {
                if (self.__scrolling) {
                    self.__scrolling = false;
                    self.scrollEnd(e, baseDialog);
                }

            }, 200);
        };

        InsertPanel.prototype.scrollEnd = function(e, baseDialog) {
            var placeholder = $("#gliffy-macro-dialog .gliffy-placeholder"),
                data;
            if(placeholder.length>0 && this.isScrolledIntoView(placeholder) ) {
                //do render more results!
                data = placeholder.data();
                placeholder.remove();
                this.search(baseDialog, data.index, data.results);
            }

        };

        InsertPanel.prototype.isScrolledIntoView = function(elem) {
            var container = $("#gliffy-macro-dialog .gliffy-content"),
                docViewTop = 0,
                docViewBottom = docViewTop + container.height(),

                elemTop = $(elem).offset().top - container.offset().top,
                elemBottom = elemTop + $(elem).height();

            return (elemBottom >= docViewTop && elemBottom <= docViewBottom) || (elemTop >= docViewTop && elemTop <=docViewBottom);
        };

        InsertPanel.prototype.search = function (baseDialog, index, results) {
            //perform the search
            var spaceKey = baseDialog.find(".gliffy-space-dropdown").data("value"),
                sort = baseDialog.find(".gliffy-sort-dropdown").data("value"),
                toggleDefaultOrder = baseDialog.find(".gliffy-sort-dropdown").data("order") || false,
                params,
                defaultOrder = {"title":"ascending", "created":"descending", "modified":"descending"},
                toggleOrder = {"title":"descending", "created":"ascending", "modified":"ascending"},
                self = this,
                query = self.query,
                searchResultsContainer;

            if(!results || !index) {
                results = 20;
                index = 0;
            }

            params = {
                query:encodeURIComponent(query),
                index:index,
                results:results,
                spaceKey:spaceKey,
                sort:sort,
                order:(toggleDefaultOrder) ? toggleOrder[sort] : defaultOrder[sort]
            };

            $.ajax({
                url:GLIFFY._confluence.gvars.gliffyApiEndpoint + "/diagrams.json",
                dataType:'json',
                data:params,
                cache:false,
                success:function (data) {

                    searchResultsContainer = baseDialog.find(".gliffy-content .gliffy-search-results");

                    if(index === 0) {
                        searchResultsContainer.empty();
                    }

                    if (self.view === "grid") {
                        searchResultsContainer.append(gliffySoy.macro.dialog.searchResults({
                            diagrams:data.diagrams,
                            rootApi:GLIFFY._confluence.gvars.gliffyApiEndpoint,
                            index: index,
                            results: results
                        }));
                    } else {
                        searchResultsContainer.append(gliffySoy.macro.dialog.listSearchResults({
                            diagrams:data.diagrams,
                            rootApi:GLIFFY._confluence.gvars.gliffyApiEndpoint,
                            index: index,
                            results: results
                        }));
                    }
                    for(var i=0; i<data.diagrams.length; i++) {
                        $(".gliffy-template[data-name='"+data.diagrams[i].attachmentId+"']").data("diagram", data.diagrams[i]);
                    }
                }
            });

        };
        InsertPanel.prototype.setup = function (baseDialog) {

            var self = this, questionLink;

            //--------------------- add checkbox and help text ------------------//
            baseDialog.find(".button-container-right").append(
                gliffySoy.macro.dialog.insertPanelCheckbox({
                    insertOnly:self.insertOnly,
                    blueprint:self.blueprint
                })
            );

            baseDialog.find(".gliffy-toggle-checkbox").change(function (event) {
                //update button text
                var checked = $(this).is(":checked"), primaryButton = baseDialog.find(".gliffy-button.gliffy-primary");
                if (checked) {
                    primaryButton.text("Insert Diagram");
                } else {
                    primaryButton.text(self.getPrimaryButtonText());
                }
                analyticsEvent('trackEvent', {category:'panelSearchToggleInsert', action:checked});
            });

            questionLink = baseDialog.find(".gliffy-question-link").click(function () {
                return false;
            });
            if (questionLink.tooltip) {
                //This uses atlassian's tipsy tooltip. We do not include this.
                questionLink.tooltip({live:false, gravity:'s', title:"data-tooltip", delayIn:500, delayOut:0, offset:5});
            } else {
                //fallback to updating the link title
                questionLink.attr("title", questionLink.data("tooltip"));
            }

            //--------------------- table delegate events ------------------//

            baseDialog.delegate("table.gliffy-list-search-results tr", "click.gliffy-row-highlight", function (event) {
                var tr = $(this), template = tr.find(".gliffy-template");
                if (template.length > 0) {
                    baseDialog.find("table .gliffy-active").removeClass("gliffy-active");
                    tr.addClass("gliffy-active");
                    template.addClass("gliffy-active");
                }
            });

            baseDialog.delegate("table.gliffy-list-search-results tr", "dblclick.gliffy-row-highlight", function (event) {
                var tr = $(this), template = tr.find(".gliffy-template");
                if (template.length > 0) {
                    //perform main action
                    self.primaryAction(event, baseDialog);
                }
            });

            //--------------------- Setup dropdown state ------------------------//

            baseDialog.find(".gliffy-insert-search-form").append(
                gliffySoy.macro.dialog.insertDropdown({
                    items:this.spaces,
                    label:"",
                    name:"gliffy-space-dropdown"
                })
            );
            baseDialog.find(".gliffy-insert-search-form").append(
                gliffySoy.macro.dialog.insertDropdown({
                    items:this.sort,
                    label:"Sort by:",
                    name:"gliffy-sort-dropdown"
                })
            );

            //also add the list/grid toggle
            baseDialog.find(".gliffy-insert-search-form").append(
                gliffySoy.macro.dialog.listGridToggle({
                    view:self.view === "grid" ? "gliffy-icon-grid" : "gliffy-icon-list"
                })
            );

            baseDialog.find(".gliffy-list-grid-toggle").click(function () {
                var toggle = $(this);
                if (self.view === "grid") {
                    toggle.removeClass("gliffy-icon-grid").addClass("gliffy-icon-list");
                    self.view = "list";
                } else {
                    toggle.removeClass("gliffy-icon-list").addClass("gliffy-icon-grid");
                    self.view = "grid";
                }
                analyticsEvent('trackEvent', {category:'panelSearchToggleGridList', action:self.view});

                self.search(baseDialog);
            });

            baseDialog.find(".gliffy-btn.gliffy-dropdown,.gliffy-btn.gliffy-dropdown-toggle").click(function (event) {
                event.preventDefault();
                event.stopPropagation();
                $(this).closest(".gliffy-btn-group").find("ul.gliffy-dropdown-menu").toggle();

            });

            baseDialog.bind("click.gliffy-btn-dropdown", function () {
                baseDialog.find(".gliffy-btn.gliffy-dropdown,.gliffy-btn.gliffy-dropdown-toggle");
                baseDialog.find("ul.gliffy-dropdown-menu:visible").hide();
            });

            $(baseDialog).delegate("ul.gliffy-dropdown-menu li", 'click', function (event) {
                event.preventDefault();
                event.stopPropagation();
                var $this = $(this), longName = $this.find("a").text(), shortName = $this.find("a").data("value"),
                    buttonGroup = $this.closest(".gliffy-btn-group");
                buttonGroup.find("button.gliffy-dropdown").text(longName);
                if (buttonGroup.data("value") === shortName) {
                    buttonGroup.data("order", !(buttonGroup.data("order") == true));
                } else {
                    buttonGroup.data("value", shortName);
                    buttonGroup.data("order", false);
                }
                buttonGroup.find("ul.gliffy-dropdown-menu").toggle();
                self.search(baseDialog);
            });

            baseDialog.find("ul.gliffy-dropdown-menu").scroll(_.debounce(function() {
                var scroller = this;
                if($(this).scrollTop() + $(this).innerHeight() >= $(this)[0].scrollHeight) {
                    $.ajax({
                        type: "GET",
                        url: AJS.format("{0}/rest/api/space?start={1}&limit={2}",
                            Confluence.getContextPath(),
                            self.offset,
                            self.maxSpaces),
                        dataType: "json",
                        cache: false,
                        success: function (data) {
                            self.offset += data.results.length;
                            for (var i = 0; i < data.results.length; i++) {
                                var result = data.results[i];
                                var name = document.createElement('span');
                                name.textContent = result.name;
                                $(scroller).append('<li><a href="#" data-value="' + result.key + '">' + name.innerHTML + '</a></li>');
                            }
                        },
                        error: function (xhr, textstatus, errorThrown) {
                            AJS.log("space service unavailable " + textstatus);
                        }
                    });
                }
            }, 200));

            //--------------------- Search ------------------------//

            //search
            baseDialog.find(".gliffy-insert-search").keyup(function (event) {
                clearTimeout(self.timeout);
                self.query = $.trim(baseDialog.find(".gliffy-insert-search").val());
                self.timeout = setTimeout(function () {
                    self.search(baseDialog);
                }, 500);
            }).keydown(function (event) {
                if (event.which === 13) {
                    //dropdown toggles otherwise...
                    event.preventDefault();
                    self.query = $.trim(baseDialog.find(".gliffy-insert-search").val());
                    self.search(baseDialog);
                }
            });
            baseDialog.find(".gliffy-insert-search-form").submit(function (event) {
                event.stopPropagation();
                event.preventDefault();
            });


            baseDialog.find(".gliffy-content").scroll(function(e) {
                self.scroll(e, baseDialog);
            });

            //populate tab
            self.search(baseDialog);

        };
        InsertPanel.prototype.teardown = function (baseDialog) {

            //------- remove diagram link checkbox and help text ------//
            baseDialog.find(".gliffy-toggle-insert").remove();
            baseDialog.unbind("click.gliffy-row-highlight");
            baseDialog.unbind("dblclick.gliffy-row-highlight");
            baseDialog.unbind("click.gliffy-btn-dropdown");
            baseDialog.find(".gliffy-content").unbind("scroll");
        };
        InsertPanel.prototype.primaryAction = function (event, baseDialog, macroDialog) {

            var template = baseDialog.find(".gliffy-content .gliffy-template.gliffy-active"),
                checkbox = baseDialog.find(".gliffy-toggle-checkbox"),
                currentParams, diagram, isBlueprint =  macroDialog.isFromBlueprint();

            event.preventDefault();
            event.stopPropagation();

            if (template.length > 0) {

                if (this.insertOnly || checkbox.is(":checked") || isBlueprint) {

                    //insert
                    diagram = template.data("diagram");

                    if (diagram) {

                        currentParams = {};
                        currentParams.name = diagram.name;

                        //mark if is blueprint on page template
                        if(isBlueprint) {
                            //we need the attachment id to transform this later
                            currentParams.attachmentId = diagram.attachmentId;
                        }

                        // Let's not add the diagram version on the macro as we don't want to fix the displayed version unless
                        // the user explicitly chooses to
                        // currentParams.version = selectedDiagramVersion;
                        if (Confluence.Editor.getContentId() != diagram["pageId"]) {
                            currentParams.pageid = diagram["pageId"];
                        }

                        AJS.Rte.BookmarkManager.storeBookmark();
                        var macroRenderRequest = {
                            contentId:Confluence.Editor.getContentId(),
                            macro:{
                                name:"gliffy",
                                params:currentParams,
                                defaultParameterValue:"",
                                body:""
                            }
                        };

                        GLIFFY.confluence.insertMacro(macroRenderRequest);
                        GLIFFY._confluence.macroDialog.hide();

                        analyticsEvent('trackEvent', {category:'panelSearch', action:"insert"});


                    }
                } else {
                    analyticsEvent('trackEvent', {category:'panelSearch', action:"create"});
                    //create
                    AJS.trigger("gliffy.confluence.launchTemplate", [template.data("category"), template.data("name")]);
                }
            }

        };

        /******************************************************************/
        /*                      Import Panel                              */
        /******************************************************************/


        ImportPanel = function () {
            var self = this;

            this.name = "import";

            //supported transformers
            this.transformers = [];

            //check for available transformers
            $.ajax({
                url:GLIFFY._confluence.gvars.gliffyApiEndpoint + "/transform/config.json",
                type:"GET",
                cache:false,
                dataType:"json",
                success:function (data) {
                    AJS.log("gliffy-transform service available");
                    for (var i = 0; i < data.transformers.length; i++) {
                        AJS.log("supports " + data.transformers[i].name);
                        self.transformers.push(data.transformers[i]);
                    }
                },
                error:function () {
                    AJS.log("gliffy-transform service unavailable.");
                    self.transformers = [
                        {"name":"Gliffy XML", "ext":'gxml'}
                    ];
                }
            });
        };
        ImportPanel.prototype = new Panel();
        ImportPanel.prototype.constructor = ImportPanel;
        ImportPanel.prototype.getTemplate = function () {
            return gliffySoy.macro.dialog.importPanel({
                contextPath:AJS.Confluence.getContextPath()
            });
        };
        ImportPanel.prototype.primaryAction = function (event, baseDialog, macroDialog) {
        };
        ImportPanel.prototype.getPanelText = function () {
            return "Import a Diagram";
        };
        ImportPanel.prototype.isExtensionSupported = function (extension) {
            return $.grep(this.transformers,function (transformer) {
                if (transformer.ext === "gliffy,gon") {
                    return "gon" === extension || "gliffy" === extension;
                } else if (transformer.ext === "xml,drawio,mxfile") {
                    return "xml" === extension || "drawio" === extension || "mxfile" === extension;
                } else {
                    return transformer.ext === extension;
                }
            }).length > 0;
        };
        ImportPanel.prototype.setupFormSubmit = function (baseDialog) {

            var errorContainer = $('#gliffy-create-import-error'), waitSpinner = $("#gliffy-import-wait"),
                fileImport = $("#gliffy-import-file"), form = $('#gliffy-create-import-form'), self = this,
                extension, token;

            //this uses confluence's ajaxForm jQuery plugin:
            baseDialog.find("#gliffy-create-import-form").ajaxForm({

                type: 'POST',
                timeout: 180000, // 3-minute timeout, for long file uploads
                beforeSubmit:function () {
                    //atlassian added a security token in 5.1.4
                    try {
                        token = AJS.Meta.get("atl-token");
                        if (token) {
                            $("#gliffy-security-token").val(token);
                        }
                    } catch (e) {
                        //let if fall through if older version
                    }

                    //you can't disable the input here, otherwise the form will not submit properly

                    if(fileImport.val().includes('.')) {
                        extension = fileImport.val().split(".").pop();
                    }
                    else {
                        extension = 'json'; // If file have no extension we treat it as json
                    }


                    if (!self.submitting && self.isExtensionSupported(extension)) {

                        //analytics on what type of file the user is attempting to upload
                        analyticsEvent('trackEvent', {category:'import', action:extension});

                        //clear errors, setup spinner
                        errorContainer.empty();
                        importSpinner = new GliffySpinner(waitSpinner.get(0), {
                            radius:10,
                            color:'#666',
                            inline:true
                        });
                        importSpinner.start();
                        self.submitting = true;
                        return true;
                    } else {
                        //notify user that the filetype is unsupported
                        AJS.messages.error("#gliffy-create-import-error", {title:"The file type is not supported for importing:" + " " + extension});
                        return false;
                    }
                },
                success: function (jsonTextResponse) {

                    self.submitting = false;

                    importSpinner.stop();
                    form.each(function () {
                        this.reset();
                    });

                    var parsedJsonResponse = $.parseJSON(jsonTextResponse);
                    var gonContent = parsedJsonResponse.gon;

                    try {
                        AJS.trigger("gliffy.confluence.launchEditorWithGonData", gonContent);
                        GLIFFY._confluence.macroDialog.hide();
                    } catch (e) {
                        errorContainer.empty();
                        AJS.messages.error("#gliffy-create-import-error", {
                            title: "Sorry, we could not import your file."
                        });
                    }
                },
                error:function (error) {
                    console.error(error);
                    self.submitting = false;

                    // reset state
                    importSpinner.stop();
                    form.each(function () {
                        this.reset();
                    });

                    AJS.messages.error("#gliffy-create-import-error", {
                        title:"Sorry, we could not import your file."
                    });
                }
            });

        };
        var importPanelInitialized = false;
        ImportPanel.prototype.setup = function (baseDialog) {
            var self = this;

            // Hide primary button
            baseDialog.find(".gliffy-button.gliffy-primary").hide();

            // Bind the inline help
            baseDialog.find("#gliffy-file-type-gxml").click(function () {
                baseDialog.find(".gliffy-import-help-container").empty()
                    .append(gliffySoy.macro.dialog.importGliffyHelpPanel({
                    contextPath:AJS.Confluence.getContextPath()
                }));
                return false;
            });

            // Bind the inline help
            baseDialog.find("#gliffy-file-type-gon").click(function () {
                baseDialog.find(".gliffy-import-help-container").empty()
                    .append(gliffySoy.macro.dialog.importGliffyGonHelpPanel({
                    contextPath:AJS.Confluence.getContextPath()
                }));
                return false;
            });

            // Bind the inline help
            baseDialog.find("#gliffy-file-type-vdx").click(function () {
                baseDialog.find(".gliffy-import-help-container").empty()
                    .append(gliffySoy.macro.dialog.importVisioHelpPanel());
                return false;
            });

            // Bind the inline help
            baseDialog.find("#gliffy-file-type-drawio").click(function () {
                baseDialog.find(".gliffy-import-help-container").empty()
                        .append(gliffySoy.macro.dialog.importDrawIoHelpPanel());
                    return false;
            });

            // Bind the inline help
            baseDialog.find("#gliffy-file-type-lucidchart").click(function () {
                baseDialog.find(".gliffy-import-help-container").empty()
                    .append(gliffySoy.macro.dialog.importLucidchartHelpPanel());
                return false;
            });

            baseDialog.find("#gliffy-import-file").bind("change.gliffyImportPanel", function () {
                $(this).closest("form").submit();
            });

            //setup upload form
            self.setupFormSubmit(baseDialog);
            importPanelInitialized = true;
        };
        ImportPanel.prototype.teardown = function (baseDialog) {
            //show primary button
            baseDialog.find(".gliffy-button.gliffy-primary").show();

            //no delegate events were added in setup, so nothing else needs to be removed
        };


        /******************************************************************/
        /*                  Template Categories Panel                     */
        /******************************************************************/

        TemplateCategoryPanel = function (category) {
            this.category = category;
            this.name = category.uid || category.id; //key
        };
        TemplateCategoryPanel.prototype = new Panel();
        TemplateCategoryPanel.prototype.constructor = TemplateCategoryPanel;
        TemplateCategoryPanel.prototype.primaryAction = function (event, baseDialog, macroDialog) {
            event.preventDefault();
            event.stopPropagation();
            var template = baseDialog.find(".gliffy-content .gliffy-template.gliffy-active"),
                name = template.data("name"), category = template.data("category");
            //Actual editor launch logic is in gliffy-rte-editor-html5.js
            analyticsEvent('trackEvent', {category:"panel." + category, action:name});

            AJS.trigger("gliffy.confluence.launchTemplate", [category, name]);


        };
        TemplateCategoryPanel.prototype.isTemplateCategory = function () {
            return true;
        };
        TemplateCategoryPanel.prototype.getTemplate = function () {

            return gliffySoy.macro.dialog.templatePanel({
                category:this.category.uid,
                templates:this.category.templates,
                contextPath:AJS.Confluence.getContextPath()
            });

        };
        TemplateCategoryPanel.prototype.getPanelText = function () {
            return this.category.desc;
        };
        TemplateCategoryPanel.prototype.getPrimaryButtonText = function (event) {
            return "Create";
        };


        /******************************************************************/
        /*                  Blueprint Categories Panel                    */
        /******************************************************************/

        BlueprintCategoryPanel = function (category) {
            this.category = category;
            this.name = category.uid || category.id;
        };
        BlueprintCategoryPanel.prototype = new Panel();
        BlueprintCategoryPanel.prototype.constructor = TemplateCategoryPanel;
        BlueprintCategoryPanel.prototype.isTemplateCategory = function () {
            return true;
        };
        BlueprintCategoryPanel.prototype.getTemplate = function () {
            return gliffySoy.macro.dialog.templatePanel({
                category:this.category.uid,
                templates:this.category.templates,
                contextPath:AJS.Confluence.getContextPath()
            });

        };
        BlueprintCategoryPanel.prototype.getPanelText = function () {
            return this.category.desc.charAt(0).toUpperCase() + this.category.desc.slice(1);
        };
        BlueprintCategoryPanel.prototype.getPrimaryButtonText = function (event) {
            return "Create";
        };

//      Add any custom logic/elements in the setup function, if you added any delegates, or
//      bound any events outside of your panel, remove it in teardown.
        BlueprintCategoryPanel.prototype.setup = function (baseDialog) {
        };
        BlueprintCategoryPanel.prototype.teardown = function (baseDialog) {
        };

        BlueprintCategoryPanel.prototype.primaryAction = function (event, baseDialog, macroDialog) {
            event.preventDefault();
            event.stopPropagation();
            var template = baseDialog.find(".gliffy-content .gliffy-template.gliffy-active");
            analyticsEvent('trackEvent', {category:'macro', action:"addToConfluenceTemplate"});
            AJS.trigger('gliffy.confluence.addGliffyDiagramToPage', [template.data("category"), template.data("name")]);

        };


        /******************************************************************/
        /*                   Macro Dialog                                 */
        /******************************************************************/

        GLIFFY._confluence.macroDialog = {
            //true if, the dialog has already been init'd and appended to body
            initialized:false,
            //our normal panels
            panels:{},
            //what the panel should do when you click the primary button
            primaryActions:{},
            //primary button text
            primaryButtonText:{},
            //can the user create attachments?
            canCreateAttachmentPromise:null,

            //panel state (what panel is currently rendered)
            panelState:null,

            setPanelState:function (state) {
                this.panelState = state;
            },

            getPanelState:function () {
                return this.panelState;
            },

            /******************************************************************/
            /*                 Button Events and Styling                      */
            /******************************************************************/

            /**
             * Sets the correct style for the active panel link
             * @param link
             */
            setActivePanelLink:function (listItem) {
                this.baseDialog.find("li.gliffy-active").removeClass("gliffy-active");
                listItem.addClass("gliffy-active");
            },

            /**
             * Sets the correct style for the active template in gliffy-content
             * @param link
             */
            setActiveTemplate:function (template) {
                this.baseDialog.find(".gliffy-content .gliffy-template.gliffy-active").removeClass("gliffy-active");
                template.addClass("gliffy-active");
            },

            /**
             * Registers what a panel should do when the primary button is clicked
             * @param key
             * @param primaryAction
             */
            registerPrimaryAction:function (panel) {
                this.primaryActions[panel.getName()] = panel;
                if (panel.getPrimaryButtonText()) {
                    this.primaryButtonText[panel.getName()] = panel.getPrimaryButtonText();
                }
            },
            /**
             * Updates the primary button text
             * @param key
             */
            updatePrimaryButtonText:function (key) {
                this.baseDialog.find(".gliffy-button.gliffy-primary").text(this.primaryButtonText[key]);
            },

            /**
             * Binds the primary button click handler. Call this once.
             */
            bindPrimaryButtonClick:function () {
                var self = this;
                this.baseDialog.delegate(".gliffy-button.gliffy-primary", "click", function (event) {
                    if (self.getPanelState()) {
                        self.primaryActions[self.getPanelState()].primaryAction(event, self.baseDialog, self);
                    }
                });
            },

            /**
             * Binds the secondary button handler. Call this once.
             */
            bindSecondaryButtonClick:function () {
                var self = this;
                this.baseDialog.delegate(".gliffy-button.gliffy-secondary", "click", function (event) {
                    event.preventDefault();
                    self.hide();
                });
            },
            /**
             * Binds the click handler for the blanket. call this once.
             */
            bindBlanketClick:function () {
                var self = this;
                this.blanket.click(function () {
                    self.hide();
                });
            },

            bindPanelLinkClick:function () {
                var self = this;
                $(this.baseDialog).delegate("ul.gliffy-panel-links li", "click", function (event) {
                    event.preventDefault();
                    event.stopPropagation();
                    var listItem = $(this), key = listItem.data("key");
                    if (key) {
                        self.renderPanel(self.panels[key]);
                    }
                });
            },

            bindTemplateElementClick:function () {
                var self = this;

                //single click
                $(this.baseDialog).delegate(".gliffy-content .gliffy-template", "click", function (event) {
                    event.preventDefault();
                    self.setActiveTemplate($(this));
                });

                //double click
                $(this.baseDialog).delegate(".gliffy-content .gliffy-template", "dblclick", function (event) {
                    event.preventDefault();
                    //trigger primary action
                    if (self.getPanelState()) {
                        self.primaryActions[self.getPanelState()].primaryAction(event, self.baseDialog, self);
                    }
                });

            },

            /******************************************************************/
            /*                       Panels                                   */
            /******************************************************************/

            /**
             * Registers the panel and adds a new link in sidebar
             */
            registerPanel:function (panel) {

                this.panels[panel.getName()] = panel;

                //give panel a reference to it's inserted panel link
                panel.insertedPanelLink = $(panel.getPanelLink());

                if (panel.isTemplateCategory()) {
                    this.baseDialog.find(".gliffy-sidebar-templates ul").append(panel.insertedPanelLink);
                } else {
                    this.baseDialog.find(".gliffy-sidebar-panels ul.gliffy-panel-links").append(panel.insertedPanelLink);
                }
                //binds any required delegate events
                this.registerPrimaryAction(panel);
            },
            /**
             * Renders a panel
             * @param panel
             */
            renderPanel:function (panel) {
                if (this.getPanelState()) {
                    this.panels[this.getPanelState()].teardown(this.baseDialog);
                }
                this.baseDialog.find(".gliffy-content").empty().append(panel.getTemplate());
                this.setActivePanelLink(panel.insertedPanelLink);
                this.updatePrimaryButtonText(panel.getName());
                this.setPanelState(panel.getName());
                panel.setup(this.baseDialog);

            },
            /******************************************************************/
            /*                       Templates                                */
            /******************************************************************/

            /**
             * ajax call to get template categories
             */
            populateTemplateCategories:function (panelType) {
                var self = this;
                $.ajax({
                    url:GLIFFY._confluence.gvars.gliffyApiEndpoint + "/templateLibraries/com.gliffy.template_library.default",
                    type:"GET",
                    cache:false,
                    success:function (data, textStatus, xhr) {
                        //add blank category for blueprint
                        if (panelType === BlueprintCategoryPanel) {
                            var blankCategory = {
                                desc:"Blank",
                                template:[
                                    {
                                        desc:"Blank",
                                        uid:"com.gliffy.template.blank",
                                        previewLocation:"",
                                        templateLocation:""
                                    }
                                ],
                                uid:"com.gliffy.templates.blank"
                            }
                            data.categories.unshift(blankCategory);
                        }

                        for (var i = 0; i < data.categories.length; i++) {
                            var category = data.categories[i];
                            //Create and Register TemplateCategoryPanels
                            self.registerPanel(new panelType(category));
                        }
                    },
                    error:function (xhr) {
                        //remove template sidebar list
                        self.baseDialog.find(".gliffy-sidebar-templates").remove();
                    }
                });

            },
            /******************************************************************/
            /*                        Init                                    */
            /******************************************************************/

            init:function () {
                this.canCreateAttachmentPromise = this.canCreateAttachments()
            },

            /**
             * Check to see if the anon user is on a draft.
             * If the user has no attachment permissions.
             *
             * This returns a promise that is rejected if they don't have the right attachment permissions
             */
            canCreateAttachments:function () {

                var deferred = new PromiseJS.Deferred(), pageId = Confluence.Editor.getContentId(), message;

                if (pageId === "0") {
                    deferred.reject("Please save the page before creating a diagram.");
                } else {
                    $.ajax({
                        type:"GET",
                        url:AJS.format("{0}/ceo/{1}/permission", GLIFFY._confluence.gvars.gliffyApiEndpoint, pageId),
                        dataType:"json",
                        cache:false,
                        success:function () {
                            deferred.resolve();
                        },
                        error:function (xhr) {
                            // If it's a license error, be more aggressive
                            if (xhr.status === 402) {
                                message = "License Error. Please contact your Administrator.";
                            }
                            else if (xhr.status === 404) {
                                //unauthorized is 401, but we substitue with 404 here for: http://jira.gliffy.com/browse/GCONF-1642
                                message = "No create permission or you are not logged in.";
                            }
                            else {
                                message = "Error. Please contact your Administrator.";
                            }
                            deferred.reject(message);
                        }
                    });
                }

                return deferred.promise;
            },

            /**
             * Did we come in from the blueprint workflow?
             */
            isFromBlueprint:function () {
                return AJS.Meta.get('form-name') === 'createpagetemplate' || AJS.Meta.get('form-name') === 'editpagetemplate';
            },


            setupButtons:function () {
                this.bindPrimaryButtonClick();
                this.bindSecondaryButtonClick();
                this.bindBlanketClick();
                this.bindPanelLinkClick();
                this.bindTemplateElementClick();
            },

            buildDialog:function () {
                var i, self = this, panels, panel, analyticsPromise;

                //initialize analytics!
                analyticsPromise = GLIFFY._confluence.utils.initAnalytics();

                //create the blanket
                this.blanket = $(gliffySoy.macro.dialog.blanket());


                if (this.isFromBlueprint()) {

                    analyticsPromise.then(function () {
                        analyticsEvent('trackEvent', {category:'macroInit', action:"blueprint"});
                    });


                    self.baseDialog = $(gliffySoy.macro.dialog.base({insertOnly:false}));

                    //start the template request
                    self.populateTemplateCategories(BlueprintCategoryPanel);

                    //create a new panel that is insert only!
                    panel = new InsertPanel(true, "", true);

                    self.registerPanel(panel);

                    //setup button state
                    self.setupButtons();

                    //render the first panel
                    self.renderPanel(panel);

                    //append the modal and blanket to body
                    self.blanket.appendTo("body");
                    self.baseDialog.appendTo("body");

                    self.initialized = true;


                } else {
                    this.canCreateAttachmentPromise.then(function () {

                        analyticsPromise.then(function () {
                            analyticsEvent('trackEvent', {category:'macroInit', action:"normal"});
                        });

                        //we can create attachments!
                        self.baseDialog = $(gliffySoy.macro.dialog.base({insertOnly:false}));

                        //start the template request
                        self.populateTemplateCategories(TemplateCategoryPanel);

                        //our static panels
                        panels = [new CreatePanel(), new ImportPanel(), new InsertPanel()];

                        //register panels
                        for (i = 0; i < panels.length; i++) {
                            self.registerPanel(panels[i]);
                        }

                        //setup button state
                        self.setupButtons();

                        //render the first panel
                        self.renderPanel(panels[0]);

                        //append the modal and blanket to body
                        self.blanket.appendTo("body");
                        self.baseDialog.appendTo("body");

                        self.initialized = true;

                    }, function (message) {


                        analyticsPromise.then(function () {
                            analyticsEvent('trackEvent', {category:'macroInit', action:"noAttachPermissions"});
                        });

                        //show the InsertPanel (Search) only, and do not populate templates

                        self.baseDialog = $(gliffySoy.macro.dialog.base({insertOnly:true}));

                        //create a new panel that is insert only!
                        panel = new InsertPanel(true, message);

                        self.registerPanel(panel);

                        //setup button state
                        self.setupButtons();

                        //render the first panel
                        self.renderPanel(panel);

                        //append the modal and blanket to body
                        self.blanket.appendTo("body");
                        self.baseDialog.appendTo("body");

                        self.initialized = true;

                    });
                }

            },
            /******************************************************************/
            /*               'Public' Methods                                 */
            /******************************************************************/
            show:function () {
                if (!this.initialized) {
                    this.buildDialog();
                } else {
                    //GCONF 1847 re-position the dialog and remove margin if the dialog height is larger than the window height
                    //to prevent the top of the dialog from being trancated at the top
                    var heightDifference = ($('body').height() - $('#gliffy-macro-dialog').height())/2;
                    var minimumTopMargin = 20;
                    if (heightDifference < minimumTopMargin) {
                        //ie hides the srollbars, so we need to show them to be able to scroll to the create/cancel buttons
                        //later versions of IE user agent string do not contain MSIE so do a check for Wind
                        if (window.navigator.userAgent.indexOf('Trident') != -1) {
                            $('body').css('overflow-y', 'scroll');
                        }
                        $('#gliffy-macro-dialog').css('top', minimumTopMargin);
                        $('#gliffy-macro-dialog').css('margin-top', 0);
                    }

                    this.blanket.show();
                    this.baseDialog.show();
                }
            },
            hide:function () {
                if (this.initialized) {
                    var heightDifference = ($('body').height() - $('#gliffy-macro-dialog').height())/2;
                    if (window.navigator.userAgent.indexOf('Trident') != -1) {
                        //put back to the original state if we close
                        $('body').css('overflow-y', 'hidden');
                        window.scrollTo(0, 0);
                    }
                    //GCONF-2702: GCONF-2599 broke Import which is described in GCONF-2702. Following addresses the fix.
                    //In the future when the code in the else block is used, this if block can be removed.
                    if (importPanelInitialized) {
                        this.blanket.hide();
                        this.baseDialog.hide();
                    } else {
                        //This vomit fixes a bug with windows/Chrome continuing
                        // to render the blanket even when it's display:none
                        // TODO: remove when windows chrome is fixed
                        this.blanket.remove().hide().appendTo('body');
                        this.baseDialog.remove().hide().appendTo('body');
                        this.setupButtons();
                        //Replace with this
                        // this.blanket.hide();
                        // this.baseDialog.hide();
                    }
                }
            }
        };
        //any other things we should check before our macro dialog is displayed?
        GLIFFY._confluence.macroDialog.init();

    }(AJS.$));
});

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-rte-html5-resources', location = 'js/gliffy-rte.js' */
// http://docs.atlassian.com/aui/3.0/
// http://confluence.atlassian.com/display/AUI/Dialog
AJS.bind("gliffy.init.rte", function (event) {
    (function ($) {
        AJS.log("AJS.version=" + AJS.version);
        var CUTOFF_TIME = 1000*60*60*24*30; //30 days in ms.  We are filtering for drafts that are over 30 days old to encourage people to publish or remove them.
        var draftCutoff = Date.now() - CUTOFF_TIME;
        //check for drafts over 15 days since last edit and nag the user if any GliffyDocumentCondition
        AJS.$.ajax(AJS.format("{0}/rest/gliffy/1.0/diagrams/drafts?before={1}&limit=1", Confluence.getContextPath(), draftCutoff)).then(function(response) {
            if (response.drafts.length === 0) {
                return;
            }
            var message = "It appears you have open Gliffy drafts over {$numberDays} days old.  \u003ca href=\u0022{$contextPath}/plugins/gliffy/gliffyUserPage.action\u0022\u003eClick here\u003c/a\u003e to navigate to your drafts or remove them if you no longer plan to publish them."
                .replace('{$numberDays}', '30')
                .replace('{$contextPath}', Confluence.getContextPath());
            var draftDialog = gliffySoy.oldDrafts.popup({
                message: message
            });
            var flagContainer = AJS.$('#aui-flag-container');
            if (flagContainer.length === 0) {
                AJS.$('body').prepend('<div id="aui-flag-container" />')
            }
            AJS.$('#aui-flag-container').prepend(draftDialog);
            AJS.$('.gliffy-close-icon').click(function() {
                AJS.$('.gliffy-draft-message-popup').hide();
            });
        });

        //==============================================================================================================
        // Show our macro dialog
        //==============================================================================================================

        var showDialogFirstEntry = function (dialog) {
            dialog.show();
            dialog.gotoPanel(0, 0);
        };

        var showPanel = function (dialog, onSuccessFunc) {
            //query for spaces
            if (GLIFFY._confluence.gvars.spaces.length < 1) {
                $.ajax({
                    type : "GET",
                    url : AJS.format("{0}/rest/api/space", Confluence.getContextPath()),
                    dataType : "json",
                    cache : false,
                    success : function (data) {
                        GLIFFY._confluence.gvars.spaces = data.categoryList;

                        $(".gliffy-space-dropdown").append(
                            gliffySoy.macro.dialog.spaceOptions({spaces : data.categoryList})
                        );

                        showDialogFirstEntry(dialog);

                        if (onSuccessFunc){
                            onSuccessFunc();
                        }
                    },
                    error : function (xhr, textstatus, errorThrown) {
                        AJS.log("space service unavailable " + textstatus);
                        showDialogFirstEntry(dialog);
                    }
                });
            }
            else {
                showDialogFirstEntry(dialog);
            }
        };

        AJS.bind("gliffy.confluence.showMacroDialog", function (event, params) {


            //clear the current selection of {gliffy
            AJS.Rte.getEditor().selection.setContent("");
            //bookmark selection
            AJS.Rte.BookmarkManager.storeBookmark();

            GLIFFY._confluence.macroDialog.show();

            return false;
        });


        //can't use live here since we want to stop immediate propagation
        $('#gliffy').click(function () {
            AJS.trigger("gliffy.confluence.showMacroDialog");
        });
        //==============================================================================================================
        // Add Diagram Workflow Setup
        //==============================================================================================================
        // If gliffy is in the hash, launch our dialog or the inline editor
        var urlParams = GLIFFY._confluence.utils.getUrlVars();
        if (urlParams["showGliffyMacro"]) {

            var ed = AJS.Rte.getEditor();
            var tmp = ed.dom.create("p");
            var $body = $(ed.getBody());

            var firstP = $body.find("p:first");
            if (firstP.length > 0) {
                firstP.before(tmp);
            } else {
                $body.prepend(tmp);
            }
            ed.dom.add(tmp, "p", {"class" : "gliffy-caret"});

            ed.focus(); //for firefox weirdness

            ed.selection.select(ed.dom.select("p.gliffy-caret")[0]);
            var bookmark = ed.selection.getBookmark();
            ed.selection.moveToBookmark(bookmark);

            ed.dom.remove(ed.dom.select("p.gliffy-caret")[0]);

            AJS.trigger("gliffy.confluence.showMacroDialog", {createDiagramType: urlParams["createDiagramType"]});
        }

    }(AJS.$));
});

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-rte-html5-resources', location = '/templates/gliffy-rte.soy' */
// This file was automatically generated from gliffy-rte.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace gliffySoy.macro.dialog.
 */

if (typeof gliffySoy == 'undefined') { var gliffySoy = {}; }
if (typeof gliffySoy.macro == 'undefined') { gliffySoy.macro = {}; }
if (typeof gliffySoy.macro.dialog == 'undefined') { gliffySoy.macro.dialog = {}; }


gliffySoy.macro.dialog.blanket = function(opt_data, opt_ignored) {
  return '<div id="gliffy-macro-blanket"></div>';
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.blanket.soyTemplateName = 'gliffySoy.macro.dialog.blanket';
}


gliffySoy.macro.dialog.base = function(opt_data, opt_ignored) {
  return '<div id="gliffy-macro-dialog"><div class="gliffy-header"><div class="gliffy-logo"></div></div><div class="gliffy-dialog-body"><div class="gliffy-sidepanel"><div class="gliffy-sidebar-panels"><ul class="gliffy-panel-links"></ul></div>' + ((opt_data.insertOnly != true) ? '<div class="gliffy-sidebar-templates"><ul class="gliffy-panel-links"><li class="gliffy-panel-title"><b>' + soy.$$escapeHtml('Templates') + '</b></li></ul></div>' : '') + '</div><div class="gliffy-content"></div><div class="gliffy-clear"></div><div class="gliffy-footer"><div class="button-container-left"></div><div class="button-container-right"><ul class="gliffy-button-list"><li><a class="gliffy-button gliffy-primary" href="#">' + soy.$$escapeHtml('Create') + '</a></li><li><a class="gliffy-button gliffy-secondary" href="#">' + soy.$$escapeHtml('Cancel') + '</a></li></ul></div><div class="gliffy-clear"></div></div></div></div>';
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.base.soyTemplateName = 'gliffySoy.macro.dialog.base';
}


gliffySoy.macro.dialog.panelLink = function(opt_data, opt_ignored) {
  return '<li ' + ((opt_data.active == true) ? 'class="gliffy-active"' : '') + '  data-key="' + soy.$$escapeHtml(opt_data.key) + '"><a href="#">' + soy.$$escapeHtml(opt_data.title) + '</a></li>';
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.panelLink.soyTemplateName = 'gliffySoy.macro.dialog.panelLink';
}


gliffySoy.macro.dialog.templatePanel = function(opt_data, opt_ignored) {
  var output = '';
  if (opt_data.category == 'com.gliffy.templates.blank') {
    output += '<div class="gliffy-template gliffy-active" data-category="com.gliffy.templates.blank" data-name="com.gliffy.template.blank"><div class="gliffy-image-placeholder"/><span>' + soy.$$escapeHtml('Blank') + '</span></div>';
  } else {
    var templateList33 = opt_data.templates;
    var templateListLen33 = templateList33.length;
    for (var templateIndex33 = 0; templateIndex33 < templateListLen33; templateIndex33++) {
      var templateData33 = templateList33[templateIndex33];
      output += '<div data-category="' + soy.$$escapeHtml(opt_data.category) + '" data-name="' + soy.$$escapeHtml(templateData33.uid) + '" class="gliffy-template ' + ((templateIndex33 == 0) ? 'gliffy-active' : '') + '"><div class="gliffy-image-placeholder" style="background-image:url(\'' + soy.$$escapeHtml(opt_data.contextPath) + '/rest/gliffy/1.0' + soy.$$escapeHtml(templateData33.thumbnailLocation) + '\')"></div><span>' + soy.$$escapeHtml(templateData33.desc) + '</span></div>';
    }
  }
  return output;
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.templatePanel.soyTemplateName = 'gliffySoy.macro.dialog.templatePanel';
}


gliffySoy.macro.dialog.createPanel = function(opt_data, opt_ignored) {
  return '<div class="gliffy-blank-container"><div class="gliffy-template gliffy-active" data-category="com.gliffy.templates.blank" data-panels="basic" data-name="com.gliffy.template.blank" ><div class="gliffy-image-placeholder gliffy-symbol-basic"></div><span>' + soy.$$escapeHtml('Basic') + '</span></div><div class="gliffy-template" data-category="com.gliffy.templates.blank" data-panels="cloud" data-name="com.gliffy.template.blank" ><div class="gliffy-image-placeholder gliffy-symbol-cloud"></div><span>' + soy.$$escapeHtml('Cloud Services') + '</span></div><div class="gliffy-template" data-category="com.gliffy.templates.blank" data-panels="bpmn" data-name="com.gliffy.template.blank" ><div class="gliffy-image-placeholder gliffy-symbol-bpmn"></div><span>' + soy.$$escapeHtml('Flowchart \x26 BPMN') + '</span></div><div class="gliffy-template" data-category="com.gliffy.templates.blank" data-panels="software" data-name="com.gliffy.template.blank" ><div class="gliffy-image-placeholder gliffy-symbol-uml"></div><span>' + soy.$$escapeHtml('Software Design: UML \x26 ERD') + '</span></div><div class="gliffy-template" data-category="com.gliffy.templates.blank" data-panels="network" data-name="com.gliffy.template.blank" ><div class="gliffy-image-placeholder gliffy-symbol-network"></div><span>' + soy.$$escapeHtml('Network') + '</span></div><div class="gliffy-template" data-category="com.gliffy.templates.blank" data-panels="ui" data-name="com.gliffy.template.blank" ><div class="gliffy-image-placeholder gliffy-symbol-wireframe"></div><span>' + soy.$$escapeHtml('Wireframe') + '</span></div><div class="gliffy-template" data-category="com.gliffy.templates.blank" data-panels="org" data-name="com.gliffy.template.blank" ><div class="gliffy-image-placeholder gliffy-symbol-org"></div><span>' + soy.$$escapeHtml('Org Chart') + '</span></div><div class="gliffy-template" data-category="com.gliffy.templates.blank" data-panels="venn" data-name="com.gliffy.template.blank" ><div class="gliffy-image-placeholder gliffy-symbol-venn"></div><span>' + soy.$$escapeHtml('Venn Diagram') + '</span></div><div class="gliffy-template" data-category="com.gliffy.template.mindmap_blank" data-panels="mindmap" data-name="com.gliffy.template.mindmap_blank" ><div class="gliffy-image-placeholder gliffy-symbol-mindmap"></div><span>' + soy.$$escapeHtml('Mind Map') + '</span></div><div class="gliffy-clear"></div></div><div class="gliffy-recent-container"><div class="gliffy-recent-title">' + soy.$$escapeHtml('Use a Recent Diagram as a Template') + '</div><div class="gliffy-recent-results"><div class="gliffy-spinner-container"></div></div></div>';
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.createPanel.soyTemplateName = 'gliffySoy.macro.dialog.createPanel';
}


gliffySoy.macro.dialog.searchResults = function(opt_data, opt_ignored) {
  var output = '';
  if (opt_data.diagrams.length > 0) {
    var diagramList75 = opt_data.diagrams;
    var diagramListLen75 = diagramList75.length;
    for (var diagramIndex75 = 0; diagramIndex75 < diagramListLen75; diagramIndex75++) {
      var diagramData75 = diagramList75[diagramIndex75];
      output += '<div data-category="com.gliffy.transform.diagram" data-name="' + soy.$$escapeHtml(diagramData75.attachmentId) + '" class="gliffy-template"><div class="gliffy-image-placeholder" style="background-image:url(\'' + soy.$$escapeHtml(opt_data.rootApi) + soy.$$escapeHtml(diagramData75.urls.thumbnail) + '\')"></div><span>' + soy.$$escapeHtml(diagramData75.displayName ? diagramData75.displayName : diagramData75.name) + '</span></div>';
    }
    output += (opt_data.results == opt_data.diagrams.length) ? '<div class="gliffy-placeholder" data-index="' + soy.$$escapeHtml(opt_data.index + opt_data.results) + '" data-results="' + soy.$$escapeHtml(opt_data.results) + '"></div>' : '';
  } else {
    output += '<div style="text-indent:7.5px;">' + soy.$$escapeHtml('No Diagrams Found') + '</div>';
  }
  return output;
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.searchResults.soyTemplateName = 'gliffySoy.macro.dialog.searchResults';
}


gliffySoy.macro.dialog.listGridToggle = function(opt_data, opt_ignored) {
  return '<span class="gliffy-list-grid-toggle ' + soy.$$escapeHtml(opt_data.view) + '"></span>';
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.listGridToggle.soyTemplateName = 'gliffySoy.macro.dialog.listGridToggle';
}


gliffySoy.macro.dialog.listSearchResults = function(opt_data, opt_ignored) {
  var output = '<table class="gliffy-list-search-results">' + ((opt_data.index == 0) ? '<thead><tr><th class="gliffy-table-column-diagram"><div class="gliffy-background-f0"></div></th><th class="gliffy-table-column-space">' + soy.$$escapeHtml('Space') + '</th><th class="gliffy-table-column-date">' + soy.$$escapeHtml('Last Modified') + '</th></tr></thead>' : '') + '<tbody>';
  if (opt_data.diagrams.length > 0) {
    var diagramList112 = opt_data.diagrams;
    var diagramListLen112 = diagramList112.length;
    for (var diagramIndex112 = 0; diagramIndex112 < diagramListLen112; diagramIndex112++) {
      var diagramData112 = diagramList112[diagramIndex112];
      output += '<tr><td><div data-category="com.gliffy.transform.diagram" data-name="' + soy.$$escapeHtml(diagramData112.attachmentId) + '" class="gliffy-template"><div class="gliffy-image-placeholder" style="background-image:url(\'' + soy.$$escapeHtml(opt_data.rootApi) + soy.$$escapeHtml(diagramData112.urls.thumbnail) + '\')"></div></div><div class="gliffy-diagram-list-info">' + soy.$$escapeHtml(diagramData112.displayName ? diagramData112.displayName : diagramData112.name) + '<div class="gliffy-list-label">' + soy.$$escapeHtml('Last Modified by') + ' ' + soy.$$escapeHtml(diagramData112.lastModifier) + '</div></div></td><td>' + soy.$$escapeHtml(diagramData112.spaceName) + '</td><td>' + soy.$$escapeHtml(diagramData112.lastModifiedFriendly) + '</td></tr>';
    }
  } else {
    output += '<tr><td><div style="text-indent:7.5px;">' + soy.$$escapeHtml('No Diagrams Found') + '</div></td><td></td><td></td></tr>';
  }
  output += '</tbody></table>' + ((opt_data.results == opt_data.diagrams.length) ? '<div class="gliffy-placeholder" data-index="' + soy.$$escapeHtml(opt_data.index + opt_data.results) + '" data-results="' + soy.$$escapeHtml(opt_data.results) + '"></div>' : '');
  return output;
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.listSearchResults.soyTemplateName = 'gliffySoy.macro.dialog.listSearchResults';
}


gliffySoy.macro.dialog.insertPanel = function(opt_data, opt_ignored) {
  return '<div><form class="gliffy-insert-search-form"><input class="gliffy-insert-search" type="text" placeholder="' + soy.$$escapeHtml('Search for a diagram') + '" value="' + soy.$$escapeHtml(opt_data.query) + '"></form>' + ((opt_data.message != null) ? '<div class="gliffy-warning-message"><div class="aui-message closeable shadowed warning"><p class="title"><span class="aui-icon icon-generic"></span><strong>' + soy.$$escapeHtml('Sorry, you cannot create new diagrams but you may insert existing ones.') + '</strong></p><p>' + soy.$$escapeHtml(opt_data.message) + '</p></div></div>' : '') + '<div class="gliffy-search-results ' + ((opt_data.insertOnly == true) ? 'gliffy-no-border' : '') + '"></div></div>';
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.insertPanel.soyTemplateName = 'gliffySoy.macro.dialog.insertPanel';
}


gliffySoy.macro.dialog.insertPanelCheckbox = function(opt_data, opt_ignored) {
  return '<form class="gliffy-toggle-insert">' + ((opt_data.blueprint != true) ? '<input class="gliffy-toggle-checkbox" type="checkbox" ' + ((opt_data.insertOnly == true) ? 'checked disabled' : '') + '/><span>' + soy.$$escapeHtml('Link to Original Diagram') + '</span><a class="gliffy-question-link" href="#" data-tooltip="' + soy.$$escapeHtml('Select this option to link and display the original diagram. Modifications to the original will be reflected in linked locations.') + '"><span class="gliffy-question-icon"></span></a>' : '') + '</form>';
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.insertPanelCheckbox.soyTemplateName = 'gliffySoy.macro.dialog.insertPanelCheckbox';
}


gliffySoy.macro.dialog.insertDropdown = function(opt_data, opt_ignored) {
  var output = ((opt_data.label.length > 0) ? '<span class="gliffy-dropdown-label">' + soy.$$escapeHtml(opt_data.label) + '</span>' : '') + '<div class="gliffy-btn-group ' + soy.$$escapeHtml(opt_data.name) + '" data-value="' + soy.$$escapeHtml(opt_data.items[0].shortName) + '"><button class="gliffy-btn gliffy-dropdown">' + soy.$$escapeHtml(opt_data.items[0].longName) + '</button><button class="gliffy-btn gliffy-dropdown-toggle"><span class="gliffy-caret"></span></button><ul class="gliffy-dropdown-menu">';
  var itemList187 = opt_data.items;
  var itemListLen187 = itemList187.length;
  for (var itemIndex187 = 0; itemIndex187 < itemListLen187; itemIndex187++) {
    var itemData187 = itemList187[itemIndex187];
    output += '<li><a href="#" data-value="' + soy.$$escapeHtml(itemData187.shortName) + '">' + soy.$$escapeHtml(itemData187.longName) + '</a></li>';
  }
  output += '</ul></div>';
  return output;
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.insertDropdown.soyTemplateName = 'gliffySoy.macro.dialog.insertDropdown';
}


gliffySoy.macro.dialog.importPanel = function(opt_data, opt_ignored) {
  return '<div id="gliffy-upload-attachment"><form id="gliffy-create-import-form" class="aui" method="post" enctype="multipart/form-data" action="' + soy.$$escapeHtml(opt_data.contextPath) + '/rest/gliffy/1.0/diagrams/import"><fieldset class="inline"><div class="field gliffy-import-field-group"><input class="gliffy-import-text-input" type="text" placeholder="' + soy.$$escapeHtml('Upload a file from your computer') + '"/><a class="gliffy-import-browse">' + soy.$$escapeHtml('Browse') + '</a><div class="gliffy-file-input-wrapper"><input type="file" name="file" id="gliffy-import-file" class="gliffy-file-upload"/></div><input id="gliffy-security-token" type="hidden" name="atl_token" value=""></input><span id="gliffy-import-wait"></span><div class="gliffy-clear"></div><div id="gliffy-create-import-error" class="error gliffy-import-description"></div><div class="gliffy-create-import-type-description">' + soy.$$escapeHtml('The following file types are supported [click each for more info]:') + '</div><div id="gliffy-create-import-types" class="gliffy-create-import-types"><ul><li><a id="gliffy-file-type-gon" href="#">' + soy.$$escapeHtml('Gliffy Diagram') + ' (.gliffy, .gon)</a></li><li><a id="gliffy-file-type-gxml" href="#">' + soy.$$escapeHtml('Gliffy Diagram') + ' (.gxml)</a></li><li><a id="gliffy-file-type-vdx" href="#">' + soy.$$escapeHtml('Visio Diagram') + ' (.vsdx, .vdx)</a></li><li><a id="gliffy-file-type-drawio" href="#">' + soy.$$escapeHtml('Draw.io Diagram') + ' - ALPHA (.drawio, .xml)</a></li><li><a id="gliffy-file-type-lucidchart" href="#">' + soy.$$escapeHtml('Lucidchart Diagram - ALPHA') + '</a></li></ul></div></div></fieldset></form><div class="#gliffy-create-import-error"></div><div class="gliffy-import-help-container"></div></div>';
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.importPanel.soyTemplateName = 'gliffySoy.macro.dialog.importPanel';
}


gliffySoy.macro.dialog.importGliffyHelpPanel = function(opt_data, opt_ignored) {
  return '<div class="gliffy-help-image"><img src="' + soy.$$escapeHtml(opt_data.contextPath) + '/download/resources/com.gliffy.integration.confluence/icons/gliffy_online_file_menu.png"/><p><sup>*</sup> ' + soy.$$escapeHtml('Gliffy Online File Menu') + '</p></div><div class="gliffy-help-text"><p>' + soy.$$escapeHtml('The import dialog supports the import of Gliffy Diagrams (.gxml) that are exported from the Gliffy Editor.') + '</p><p>' + soy.$$escapeHtml('This allows you to import a diagram from any Gliffy product be it the Gliffy JIRA Plugin, Gliffy Online *, or even from another Confluence page.') + '</p><p>' + soy.$$escapeHtml('From the Gliffy Editor, navigate to the \x27file\x27 menu and choose \x27Export as Gliffy XML\x27.') + '</p><div class="aui-message warning shadowed"><p class="title"><span class="aui-icon icon-warning"></span><strong>' + soy.$$escapeHtml('Using Gliffy Diagrams Attached to a Confluence Page or JIRA Issue') + '</strong></p><p>' + soy.$$escapeHtml('Gliffy Diagrams downloaded as an attachment from a Confluence Page or JIRA Issue are not guaranteed to work, unless it was exported using the method described above.') + '</p><p>' + soy.$$escapeHtml('An easy way to tell if your diagram will import is to look for the \x3ccode\x3e.gxml\x3c/code\x3e extension in your filename.') + '</p></div></div>';
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.importGliffyHelpPanel.soyTemplateName = 'gliffySoy.macro.dialog.importGliffyHelpPanel';
}


gliffySoy.macro.dialog.importGliffyGonHelpPanel = function(opt_data, opt_ignored) {
  return '<div class="gliffy-help-image"><img src="' + soy.$$escapeHtml(opt_data.contextPath) + '/download/resources/com.gliffy.integration.confluence/icons/gliffy_export_file_menu.png"/><p><sup>*</sup> ' + soy.$$escapeHtml('Gliffy HTML5 File Menu') + '</p></div><div class="gliffy-help-text"><p>' + soy.$$escapeHtml('The import dialog supports the import of Gliffy Diagrams (.gon) that are exported from the Gliffy HTML5 Editor.') + '</p><p>' + soy.$$escapeHtml('From the Gliffy HTML5 Editor, navigate to the \x27File\x27 menu and choose \x27Export as Gliffy\x27.') + '</p><div class="aui-message info" style="width: 440px;"><p class="title"><span class="aui-icon icon-info"></span><strong>' + soy.$$escapeHtml('Gliffy HTML5 files are fully portable!') + '</strong></p><p>' + soy.$$escapeHtml('You can download a Gliffy HTML5 diagram directly from the attachments page. Make sure your diagram is of this content type:') + '</p><p><code>' + soy.$$escapeHtml('application/gliffy+json') + '</code></p><p>' + soy.$$escapeHtml('Just attach the diagram to any Confluence page, and you can immediately use \x27Insert Diagram\x27 from the macro dialog to show it on your wiki page.  No importing is necessary!') + '</p></div></div>';
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.importGliffyGonHelpPanel.soyTemplateName = 'gliffySoy.macro.dialog.importGliffyGonHelpPanel';
}


gliffySoy.macro.dialog.importVisioHelpPanel = function(opt_data, opt_ignored) {
  return '<div class="gliffy-help-text"><span id="gliffy-visio-description-spinner"></span><p id="gliffy-visio-description">' + soy.$$escapeHtml('The import dialog supports the import of Visio diagrams (.vsdx, .vdx) that are saved from Microsoft Visio.') + '</p><h3 id="gliffy-import-visio-prep">' + soy.$$escapeHtml('Preparing the Visio File') + '</h3><ol><li>' + soy.$$escapeHtml('In Visio, open the file that you want to import into Gliffy.') + '</li><li>' + soy.$$escapeHtml('If this file has multiple worksheets, select the worksheet that you want to export.') + '</li><li>' + soy.$$escapeHtml('Select File \x3e Save As.') + '</li><li>' + soy.$$escapeHtml('Choose either \x22Visio Drawing (*.vsdx)\x22 or \x22XML Drawing (*.vdx)\x22.') + '</li><li>' + soy.$$escapeHtml('Save the file.') + '</li></ol><h3 id="gliffy-import-visio-reduce-size">' + soy.$$escapeHtml('Reducing the Visio File Size (Optional)') + '</h3><ol><li>' + soy.$$escapeHtml('Load the file into Visio.') + '</li><li>' + soy.$$escapeHtml('Select File \x3e Info.') + '</li><li>' + soy.$$escapeHtml('Click on the button \x22Reduce File Size\x22 and check the boxes.') + '</li><li>' + soy.$$escapeHtml('Save the file.') + '</li></ol><div class="aui-message warning shadowed"><p class="title"><span class="aui-icon icon-warning"></span><strong>' + soy.$$escapeHtml('Missing Shapes') + '</strong></p><div class="gliffy-import-missing-shape"></div><p>' + soy.$$escapeHtml('If you see a shape like the image on the right then you have encountered a shape that the importer was not able to convert. The most common reason for this occurs when using 3rd party symbols or Visio clip art. Feel free to contact support if you experience these at') + ' <a href="mailto:support@gliffy.com">support@gliffy.com</a>.</p></div></div>';
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.importVisioHelpPanel.soyTemplateName = 'gliffySoy.macro.dialog.importVisioHelpPanel';
}


gliffySoy.macro.dialog.importDrawIoHelpPanel = function(opt_data, opt_ignored) {
  return '<div class="gliffy-help-text"><p>' + soy.$$escapeHtml('The import dialog supports the import of Draw.io Diagrams (.drawio or .xml) that are exported from the Draw.io Editor.') + '</p><p>' + soy.$$escapeHtml('From the Draw.io Editor, navigate to the \x22File\x22 menu, choose \x22Save As...\x22 and select \x22Device\x22 to download the file.') + '</p><div class="aui-message warning" style="width: 420px;"><p class="title"><span class="aui-icon icon-info"></span><strong>' + soy.$$escapeHtml('Draw.io import is in Alpha stage') + '</strong></p><p>' + soy.$$escapeHtml('Please note that certain imported images and shapes may populate as a blank placeholder. We appreciate your patience as we continue to grow and improve this feature.') + '</p></div></div>';
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.importDrawIoHelpPanel.soyTemplateName = 'gliffySoy.macro.dialog.importDrawIoHelpPanel';
}


gliffySoy.macro.dialog.importLucidchartHelpPanel = function(opt_data, opt_ignored) {
  return '<div class="gliffy-help-text"><p>' + soy.$$escapeHtml('Navigate to the Confluence page where the diagram is and download it as an attachment to your computer.') + '</p><p>' + soy.$$escapeHtml('From the import screen, click the \x22Choose file\x22 button and select your downloaded Lucidchart attachment.') + '</p><div class="aui-message warning" style="width: 420px;"><p class="title">' + soy.$$escapeHtml('Lucidchart import is in Alpha stage') + '</p></div></div>';
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.importLucidchartHelpPanel.soyTemplateName = 'gliffySoy.macro.dialog.importLucidchartHelpPanel';
}


gliffySoy.macro.dialog.spaceOptions = function(opt_data, opt_ignored) {
  var output = '';
  var spaceList300 = opt_data.spaces;
  var spaceListLen300 = spaceList300.length;
  for (var spaceIndex300 = 0; spaceIndex300 < spaceListLen300; spaceIndex300++) {
    var spaceData300 = spaceList300[spaceIndex300];
    output += '<option value="' + soy.$$escapeHtml(spaceData300.shortName) + '">' + soy.$$escapeHtml(spaceData300.longName) + '</option>';
  }
  return output;
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.spaceOptions.soyTemplateName = 'gliffySoy.macro.dialog.spaceOptions';
}


gliffySoy.macro.dialog.searchResult = function(opt_data, opt_ignored) {
  var output = '<table><thead><tr class="gliffy-data-table-header"><th class="gliffy-title-field">' + soy.$$escapeHtml('Title') + '</th><th class="gliffy-space-field">' + soy.$$escapeHtml('Space') + '</th><th class="gliffy-last-modified-field">' + soy.$$escapeHtml('Last Modified') + '</th></tr></thead><tbody>';
  var diagramList315 = opt_data.diagrams;
  var diagramListLen315 = diagramList315.length;
  if (diagramListLen315 > 0) {
    for (var diagramIndex315 = 0; diagramIndex315 < diagramListLen315; diagramIndex315++) {
      var diagramData315 = diagramList315[diagramIndex315];
      output += '<tr data-attachment-id="' + soy.$$escapeHtml(diagramData315.attachmentId) + '" data-name="' + soy.$$escapeHtml(diagramData315.name) + '" data-page-id="' + soy.$$escapeHtml(diagramData315.pageId) + '" data-version="' + soy.$$escapeHtml(diagramData315.version) + '" ' + ((diagramIndex315 == 0) ? 'class="gliffy-selected"' : '') + '><td class="gliffy-title-field">' + soy.$$escapeHtml(diagramData315.displayName ? diagramData315.displayName : diagramData315.name) + '</td><td class="gliffy-space-field">' + soy.$$escapeHtml(diagramData315.spaceName) + '</td><td class="gliffy-last-modified-field">' + soy.$$escapeHtml(diagramData315.lastModifiedFriendly) + '</td></tr>';
    }
  } else {
    output += '<tr data-empty="true"><td>' + soy.$$escapeHtml('No results') + '</td></tr>';
  }
  output += '</tbody></table>';
  return output;
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.searchResult.soyTemplateName = 'gliffySoy.macro.dialog.searchResult';
}


gliffySoy.macro.dialog.importResult = function(opt_data, opt_ignored) {
  var output = '<ul id="gliffy-import-list" class="gliffy-image-list">';
  var attachmentList343 = opt_data.attachments;
  var attachmentListLen343 = attachmentList343.length;
  if (attachmentListLen343 > 0) {
    for (var attachmentIndex343 = 0; attachmentIndex343 < attachmentListLen343; attachmentIndex343++) {
      var attachmentData343 = attachmentList343[attachmentIndex343];
      output += gliffySoy.macro.dialog.importResultItem({attachment: attachmentData343, contextPath: opt_data.contextPath});
    }
  } else {
    output += '<li id="gliffy-import-empty" data-empty="true"><span>' + soy.$$escapeHtml('No results') + '</span></li>';
  }
  output += '</ul>';
  return output;
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.importResult.soyTemplateName = 'gliffySoy.macro.dialog.importResult';
}


gliffySoy.macro.dialog.importResultItem = function(opt_data, opt_ignored) {
  return '<li class="gliffy-attached-image" data-attachment-id="' + soy.$$escapeHtml(opt_data.attachment.attachmentId) + '" data-name="' + soy.$$escapeHtml(opt_data.attachment.name) + '" data-page-id="' + soy.$$escapeHtml(opt_data.attachment.pageId) + '" data-version="' + soy.$$escapeHtml(opt_data.attachment.version) + '"><div class="gliffy-image-container"><img width="100" height="100" title="' + soy.$$escapeHtml(opt_data.attachment.name) + '" src="' + soy.$$escapeHtml(opt_data.contextPath) + '/rest/gliffy/1.0' + soy.$$escapeHtml(opt_data.attachment.urls.thumbnail) + '" class="thumbnail"/></div><span class="caption filename">' + soy.$$escapeHtml(opt_data.attachment.name) + '</span><span class="caption owner-title">' + soy.$$escapeHtml(opt_data.attachment.lastModifiedFriendly) + '</span></li>';
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.importResultItem.soyTemplateName = 'gliffySoy.macro.dialog.importResultItem';
}


gliffySoy.macro.dialog.morePropertyPanel = function(opt_data, opt_ignored) {
  var output = '<form action="#" method="post" class="aui top-label" name="gliffy-more-form"><fieldset><div class="field-group"><label for="gliffy-dialog-more-size-field">' + soy.$$escapeHtml('Size') + '</label><input id="gliffy-dialog-more-size-field" name="gliffy-dialog-more-size-field" class="text" type="text" value="' + soy.$$escapeHtml(opt_data.size) + '"/><div id="gliffy-dialog-more-size-error-field" class="error"></div><div class="description">' + soy.$$escapeHtml('Width in #px | T (150px) | S (1:3) | M (2:3) | L (1:1)') + '</div></div><div class="field-group"><label for="gliffy-dialog-more-chrome">' + soy.$$escapeHtml('Viewer Toolbar') + '</label><select name="gliffy-chrome" id="gliffy-dialog-more-chrome-field">';
  var chromeOptionList383 = opt_data.chromeOptions;
  var chromeOptionListLen383 = chromeOptionList383.length;
  for (var chromeOptionIndex383 = 0; chromeOptionIndex383 < chromeOptionListLen383; chromeOptionIndex383++) {
    var chromeOptionData383 = chromeOptionList383[chromeOptionIndex383];
    output += (chromeOptionData383.key == opt_data.selectedChromeOption) ? '<option value="' + soy.$$escapeHtml(chromeOptionData383.key) + '" selected="selected">' + soy.$$escapeHtml(chromeOptionData383.value) + '</option>' : '<option value="' + soy.$$escapeHtml(chromeOptionData383.key) + '">' + soy.$$escapeHtml(chromeOptionData383.value) + '</option>';
  }
  output += '</select><div class="description">' + soy.$$escapeHtml('\x22Full\x22 displays Edit/Zoom controls') + '</div></div>' + ((! opt_data.isHtml5ViewerDisabledByAdmin) ? '<div class="field-group"><input class="gliffy-dialog-interactive-viewer-checkbox" type="checkbox" ' + ((opt_data.html5Viewer == true) ? 'checked' : '') + '/><span>' + soy.$$escapeHtml('Interactive HTML5 Viewer') + '</span><div class="description">' + soy.$$escapeHtml('Display preview image when disabled') + '</div></div>' : '') + '</fieldset></form>';
  return output;
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.morePropertyPanel.soyTemplateName = 'gliffySoy.macro.dialog.morePropertyPanel';
}


gliffySoy.macro.dialog.versionPropertyPanel = function(opt_data, opt_ignored) {
  var output = '<form action="#" method="post" class="aui top-label" name="gliffy-version-form"><fieldset><div class="field-group"><div class="description">' + soy.$$escapeHtml('Select which diagram version to pin to the page.') + '</div><select name="gliffy-version" id="gliffy-dialog-version-field">';
  var versionList417 = opt_data.versions;
  var versionListLen417 = versionList417.length;
  for (var versionIndex417 = 0; versionIndex417 < versionListLen417; versionIndex417++) {
    var versionData417 = versionList417[versionIndex417];
    output += (versionData417.key == opt_data.selectedVersion) ? '<option value="' + soy.$$escapeHtml(versionData417.key) + '" selected="selected">' + soy.$$escapeHtml(versionData417.value) + '</option>' : '<option value="' + soy.$$escapeHtml(versionData417.key) + '">' + soy.$$escapeHtml(versionData417.value) + '</option>';
  }
  output += '</select><div id="gliffy-version-dialog-information" class="description"></div><a id="gliffy-diagram-preview"><img id="gliffy-diagram-thumbnail"></a></div></fieldset></form>';
  return output;
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.versionPropertyPanel.soyTemplateName = 'gliffySoy.macro.dialog.versionPropertyPanel';
}


gliffySoy.macro.dialog.noSaveDialog = function(opt_data, opt_ignored) {
  return '<div>' + soy.$$escapeHtml(opt_data.pageUnsavedMessage) + '</div>';
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.noSaveDialog.soyTemplateName = 'gliffySoy.macro.dialog.noSaveDialog';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-rte-html5-resources', location = '/templates/gliffy-edit-linked-diagram.soy' */
// This file was automatically generated from gliffy-edit-linked-diagram.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace gliffySoy.editLinkedDiagram.
 */

if (typeof gliffySoy == 'undefined') { var gliffySoy = {}; }
if (typeof gliffySoy.editLinkedDiagram == 'undefined') { gliffySoy.editLinkedDiagram = {}; }


gliffySoy.editLinkedDiagram.dialog = function(opt_data, opt_ignored) {
  return '<section role="dialog" id="gliffy-dialog-edit-linked-diagram" class="aui-layer aui-dialog2 aui-dialog2-small" aria-hidden="true"><header class="aui-dialog2-header"><h2 class="aui-dialog2-header-main">' + soy.$$escapeHtml('You are being redirected') + '</h2><a class="aui-dialog2-header-close"><span class="aui-icon aui-icon-small aui-iconfont-close-dialog">X</span></a></header><div class="aui-dialog2-content"><p>' + soy.$$escapeHtml('You are being redirected to the source diagram page.') + '</p><p>' + soy.$$escapeHtml('Editing the original diagram will update all linked diagrams.') + '</p></div><footer class="aui-dialog2-footer"><div class="aui-dialog2-footer-actions"><a id="gliffy-dialog-edit-linked-diagram-ok" class="aui-button aui-button-primary" href="#" target="_blank">' + soy.$$escapeHtml('Go to source diagram page') + '</a></div></footer></section>';
};
if (goog.DEBUG) {
  gliffySoy.editLinkedDiagram.dialog.soyTemplateName = 'gliffySoy.editLinkedDiagram.dialog';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-rte-html5-resources', location = '/templates/gliffy-old-draft-message.soy' */
// This file was automatically generated from gliffy-old-draft-message.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace gliffySoy.oldDrafts.
 */

if (typeof gliffySoy == 'undefined') { var gliffySoy = {}; }
if (typeof gliffySoy.oldDrafts == 'undefined') { gliffySoy.oldDrafts = {}; }


gliffySoy.oldDrafts.popup = function(opt_data, opt_ignored) {
  return '<div class="gliffy-draft-message-popup aui-flag" aria-hidden="false"><div class="aui-message aui-message-info info closeable shadowed"><p class="title"></p><span class="draft-message">' + soy.$$filterNoAutoescape(opt_data.message) + '</span><span class="gliffy-close-icon aui-icon icon-close" role="button"></span></div></div>';
};
if (goog.DEBUG) {
  gliffySoy.oldDrafts.popup.soyTemplateName = 'gliffySoy.oldDrafts.popup';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-rte-html5-resources', location = 'gliffy/confluence/Analytics.js' */
define("gliffy/interface/analytics", [
    "jquery",
    "gliffy/confluence/rest/webRequestPromiseFactory"
], function($, webRequestPromiseFactory) {

    var isEnabled = false;

    var getAnalyticsDisabled = webRequestPromiseFactory.buildGetPropertyValuePromise("com.gliffy.integration.confluence.ANALYTICS_OFF");
    $.when(getAnalyticsDisabled).then(function(result) {
        isEnabled = !result;
        if(isEnabled) {
            analytics.event('init', {accountType:'google', accountID:'UA-248648-13', optPageName:'Gliffy Confluence Init'});
            // to debug analytics, uncomment the following line
            analytics.event('logEvents', {logEvents: true, logger: console});
            analytics.event('setLabel', {label: 'none'});
            analytics.event('setCustomVariables', {
                product: 'Confluence',
                license: $('meta[name=gliffy-license-type]').attr("content"),
                numUsers: parseInt($('meta[name=gliffy-license-quantity]').attr("content"))
            });
        }
    });

    var analytics = {
        event: function (type, options) {
            if (isEnabled) {
                $(window).trigger(type + '.gliffyAnalytics', options);
            }
        }
    };

    return analytics;
});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-rte-html5-resources', location = 'gliffy/confluence/macro/controller/PropertyPanelController.js' */
// Register as apex module so this module can be instantiated after everybody is registered.
var apexModuleManager = require("gliffy/amd/apexModuleManager");
apexModuleManager.define("gliffy/confluence/macro/controller/PropertyPanelController", [
    "jquery",
    "GliffySpinner",
    "gliffy/confluence/rest/urlFactory",
    "gliffy/confluence/rest/webRequestPromiseFactory",
    "gliffy/confluence/editor/editorLauncher",
    "gliffy/confluence/pageFacade",
    "gliffy/interface/analytics"
], function($, GliffySpinner, urlFactory, webRequestPromiseFactory, editorLauncher, pageFacade, analytics, EmbedMacroController) {

    //======================================================================================================================
    // Property panel button handlers
    //======================================================================================================================

    var LATEST = 0;
    var isEditLinkedDialogCreated = false;

    function gliffyEdit (macroNode) {

        AJS.Rte.BookmarkManager.storeBookmark();
        var name = macroNode.params ? macroNode.params['name'] : null;
        var isNamed = name && name.length >0;

        if (macroNode["params"] && (isNamed || macroNode.params['macroId'])) {

            if (AJS.Meta.get('form-name') === 'createpagetemplate' || AJS.Meta.get('form-name') === 'editpagetemplate') {
                noEditingTemplateDiagramDialog();
            } else if (macroNode.params.blueprint) {
                AJS.trigger("gliffy.confluence.launchTemplate", [macroNode.params.blueprint, macroNode.params.name]);
            } else if (macroNode.params.attachmentId) {
                //GCONF-1573
                AJS.trigger("gliffy.confluence.launchTemplate", ["com.gliffy.transform.diagram", macroNode.params.attachmentId]);
            } else if (macroNode.params.page && macroNode.params.name && !macroNode.params.pageid) {
                //GCONF-1680 old style macro - this needs to be entered by hand to trigger this case!
                launchEditorForLegacyMacro(macroNode);
            } else if(macroNode.params.pageid){
                launchLinkedDiagramEditorFlow(macroNode.params.pageid);
            } else {
                //new macros should be using ceoid (page id). This is the main flow.
                launchEditor(macroNode);
            }
        }
        else {
            //show the gliffy choice dialog
            AJS.trigger("gliffy.confluence.showMacroDialog");
        }
    };

    function noEditingTemplateDiagramDialog(){
        var alertDialog = new AJS.Dialog({
            width: 450,
            height: 250,
            id: "gliffy-no-editing-template-message",
            closeOnOutsideClick: true
        });
        alertDialog.addHeader("Gliffy in Page Templates").
        addPanel("SinglePanel", '', "gliffy-no-editing-template-content");
        $('.gliffy-no-editing-template-content').html("Gliffy diagrams cannot be edited in page templates.  Please edit the diagram from the page where it is attached and changes will be reflected here.");

        alertDialog.addCancel("Close", function () {
            alertDialog.hide();
        });

        alertDialog.show();
    };

    function launchEditorForLegacyMacro(macroNode){
        if (macroNode.params.space == null) {
            // use the current space key
            macroNode.params.space = AJS.Meta.get('space-key');
        }

        var ceoFindUrl = AJS.format(
            "{0}/ceo/find/space/{1}/page/{2}/name/{3}",
            GLIFFY._confluence.gvars.gliffyApiEndpoint,
            encodeURIComponent(macroNode.params.space),
            encodeURIComponent(macroNode.params.page),
            encodeURIComponent(macroNode.params.name)
        );

        //lookup the ceo + attachment ids (this call also checks for permission at the same time to cut down on calls)
        $.ajax({
            type: "GET",
            url: ceoFindUrl,
            dataType: "json",
            cache: false,
            success: function (data) {

                // NOTE: this won't work with linked diagrams, but linked diagrams were not supported when
                // old-style macros were used.
                editorLauncher.launchEditorFromEditPage({
                    editor: GLIFFY._confluence.editor,
                    diagramName: macroNode.params.name,
                    ownerPageId: data.id,
                    referencePageId: data.id,
                    attachmentId: data.attachmentId,
                    attachmentVersion: data.attachmentVersion,
                    pagePin: LATEST,
                    macroId: macroNode.params.macroId,
                    template: {
                        category: "com.gliffy.diagram"
                    }
                });
            },
            error: function (xhr, textstatus, errorThrown) {
                alert(GLIFFY._confluence.utils.parseError(xhr));
            }
        });
    };

    function launchLinkedDiagramEditorFlow(pageId){
        if(!isEditLinkedDialogCreated){
            createEditLinkedDialog(pageId);
        }
        showEditLinkedDialog();
    };

    function launchEditor(macroNode){
        // Use the current pageId if a pageId when it is not specified
        macroNode.params.pageid = Confluence.Editor.getContentId();

        var getEditPermission;
        if (macroNode.params['name']) {
            getEditPermission = webRequestPromiseFactory.buildGetEditDiagramPermissionPromise(macroNode.params.pageid, macroNode.params.name);
        } else{
            getEditPermission = webRequestPromiseFactory.buildGetCreateAttachmentPermissionPromise(macroNode.params.pageid);
        }
        var getWootricState = $.ajax({url:AJS.Confluence.getContextPath() + '/rest/gliffy/1.0/qa/instrumentation/wootric'});
        $.when(getEditPermission, getWootricState).done(function (permissionResponse, wootric) {
            // Edit link
            var attachmentId = permissionResponse[0] ? permissionResponse[0].attachmentId : 0;
            var attachmentVersion = parseInt(macroNode.params.version) || LATEST;
            editorLauncher.launchEditorFromEditPage({
                editor: GLIFFY._confluence.editor,
                diagramName: macroNode.params.name,
                displayName: macroNode.params.displayName,
                ownerPageId: macroNode.params.pageid,
                referencePageId: Confluence.Editor.getContentId(),
                attachmentVersion: attachmentVersion,
                pagePin: macroNode.params.pagePin,
                macroId: macroNode.params.macroId,
                attachmentId: attachmentId,
                template: {
                    category: "com.gliffy.diagram"
                },
                wootric: (wootric[0] === 'true') ? 'true' : undefined
            });
        }).fail(function (xhr) {
            alert(GLIFFY._confluence.utils.parseError(xhr));
        });
    };

    function linkToSourceDiagramPage(pageId){
        var gotoLinkedPageButton = document.getElementById('gliffy-dialog-edit-linked-diagram-ok');

        gotoLinkedPageButton.href = AJS.Confluence.getContextPath()+'/pages/editpage.action?pageId='+ pageId;

        gotoLinkedPageButton.addEventListener('click', function() {
            AJS.dialog2('#gliffy-dialog-edit-linked-diagram').hide();
        });
    };

    function appendSoyTemplate(jsSelector, soyTemplate, opt_data, opt_ignored) {
        var node = document.createElement('template');
        node.innerHTML = soyTemplate(opt_data, opt_ignored);
        jsSelector.appendChild(node.firstChild || node.content.firstChild);
    };

    function createEditLinkedDialog(pageId) {
        appendSoyTemplate(document.body, gliffySoy.editLinkedDiagram.dialog);

        linkToSourceDiagramPage(pageId);

        isEditLinkedDialogCreated = true;
    };

    function showEditLinkedDialog(){
        AJS.dialog2('#gliffy-dialog-edit-linked-diagram').show();
    };

    function gliffyImageSize (macroNode, imageSize) {

        var macroDiv = AJS.$(macroNode);
        AJS.Rte.getEditor().selection.select(macroDiv[0]);
        AJS.Rte.BookmarkManager.storeBookmark();

        var diagramReference = pageFacade.getDiagramReference(macroDiv);
        diagramReference.size = imageSize;
        pageFacade.addDiagramReference(diagramReference, macroDiv[0]);
    };

    function gliffyBorderToggle (macroNode) {

        var macroDiv = AJS.$(macroNode);
        AJS.Rte.getEditor().selection.select(macroDiv[0]);
        AJS.Rte.BookmarkManager.storeBookmark();

        var diagramReference = pageFacade.getDiagramReference(macroDiv);
        diagramReference.border = !diagramReference.border;
        pageFacade.addDiagramReference(diagramReference, macroDiv[0]);
    };

    function gliffySubmitMoreDialog (dialog) {

        var LEGACY_MACRO_SIZE_OPTIONS = ["T", "S", "M", "L", "O"];

        var sanitizeSize = function (sizeFieldValue) {

            var size = $.trim(sizeFieldValue);
            if (size.length === 0) {
                return "";
            }

            if ($.inArray(size, LEGACY_MACRO_SIZE_OPTIONS) >= 0) {
                return size;
            }

            var sizeInt = parseInt(size);
            if (isNaN(sizeInt)) {
                return false;
            }
            var isValidNumericalSizeValue = sizeInt >= 150 && sizeInt <= 3000;
            if (isValidNumericalSizeValue) {
                return sizeInt;
            }

            return false;
        };

        var diagramReference = $(".gliffy-more-panel").data("diagramReference");
        var macroNode = $(".gliffy-more-panel").data("macroNode");
        var sizeField = $("#gliffy-dialog-more-size-field");

        var sanitizedSize = sanitizeSize(sizeField.val());
        if (sanitizedSize === false) {
            $("#gliffy-dialog-more-size-error-field").text("Invalid input (150 min, 3000 max)");
            return false;
        } else {
            ("" === sanitizedSize) ? delete diagramReference.size : diagramReference.size = sanitizedSize;
        }

        diagramReference.chrome = $("#gliffy-dialog-more-chrome-field").val();
        diagramReference.html5 = $(".gliffy-dialog-interactive-viewer-checkbox").is(':checked');

        pageFacade.addDiagramReference(diagramReference, macroNode);
        dialog.remove();
    };

    function setupMoreDialogOptions (diagramReference, isHtml5ViewerDisabledByAdmin) {
        return {
            size: (diagramReference.size == null) ? "" : diagramReference.size,
            chromeOptions: [
                {key: "full", value: "Full"},
                {key: "min", value: "None"}
            ],
            selectedChromeOption: (diagramReference.chrome == null) ? "full" : diagramReference.chrome,
            html5Viewer: (diagramReference.html5 === undefined || diagramReference.html5 === null) ? true : diagramReference.html5 == "true",
            isHtml5ViewerDisabledByAdmin: isHtml5ViewerDisabledByAdmin
        };
    };

    function showMoreDialog (diagramReference, macroNode, moreDialogData) {

        var moreDialog = new AJS.Dialog(340, 380, "gliffy-dialog-more");
        moreDialog.addHeader("Additional Options", "");

        moreDialog.addPanel("More Panel", gliffySoy.macro.dialog.morePropertyPanel(moreDialogData), "gliffy-more-panel", 0);
        $(".gliffy-more-panel").data("diagramReference", diagramReference).data("macroNode", macroNode);

        moreDialog.addButton("Update", gliffySubmitMoreDialog, "gliffy-more-update");

        moreDialog.addCancel("Cancel", function (dialog) {
            AJS.Rte.BookmarkManager.restoreBookmark();
            dialog.remove();
        });

        moreDialog.show();
    };

    function gliffyMoreButton (macroNode) {

        var macroDiv = AJS.$(macroNode);
        AJS.Rte.getEditor().selection.select(macroDiv[0]);
        AJS.Rte.BookmarkManager.storeBookmark();

        var diagramReference = pageFacade.getDiagramReference(macroDiv);

        var getProperty = webRequestPromiseFactory.buildGetPropertyValuePromise("com.gliffy.integration.confluence.HTML5_OFF");
        $.when(getProperty).then(function(result) {
            var moreDialogData = setupMoreDialogOptions(diagramReference, !!result);
            showMoreDialog(diagramReference, macroNode, moreDialogData);
        });
    };

    function updateVersionInformation (versionData, diagramName, pageId) {

        $("#gliffy-version-dialog-information").text("");

        var selectedVal = +$('#gliffy-dialog-version-field').val();
        var versionInfo = versionData.allVersionInformation[selectedVal - 1];

        if (selectedVal === LATEST) {
            versionInfo = versionData.allVersionInformation[versionData.allVersionInformation.length - 1];
        }

        if (versionInfo) {
            $("#gliffy-version-dialog-information").text(versionInfo);
        }

        $("#gliffy-diagram-preview").attr('href', urlFactory.buildDiagramPreviewImageUrl(pageId, diagramName, selectedVal));
        $("#gliffy-diagram-thumbnail").attr('src', urlFactory.buildDiagramThumbnailImageUrl(pageId, diagramName, selectedVal));

        var v = (selectedVal === 0) ? versionData.allVersionInformation.length : selectedVal;

        //GCONF-2013 fancybox is depricated.  check for previewer, but fallback to fancybox if not available
        var previewImage = $("#gliffy-diagram-thumbnail");
        if (previewImage.previewer) {
            $(previewImage).previewer({
                src: $("#gliffy-diagram-preview").attr('href'),
                type: "image/png",
                title: "v" + v,
                zindex: 10000
            }).closest('a').attr('href', '#').click(function (ev) {
                ev.preventDefault(); //supresses message warning that user is navigating from the page
            }); //we're keeping the <a> link to for legacy instances that use fancy box
        } else {
            $("#gliffy-diagram-preview").fancybox({
                type: 'image',
                showCloseButton: true,
                hideOnOverlayClick: true,
                hideOnContentClick: true,
                title: 'v' + v
            });
        }
    };

    function gliffyVersionButton (macroNode) {
        analytics.event('trackEvent', {category:'viewer', action:'showVersionPinningDialog'});

        var clickOutsideDialogHandler = function(event) {
            if (!$(event.target).closest('#gliffy-version-dialog').length) {
                $(document).off('click', clickOutsideDialogHandler);
                dialog.remove();
            }
        };

        $(document).on('click', clickOutsideDialogHandler);

        var $macroNode = AJS.$(macroNode);
        var diagramReference = pageFacade.getDiagramReference($macroNode);
        var pageid = diagramReference.ownerPageId;

        var dialog = new AJS.Dialog({
            width: 340,
            height: 430,
            id: 'gliffy-version-dialog',
            closeOnOutsideClick: false // GCONF-2194: don't set this to true. it can break dialog functionality
        });
        dialog.addHeader("Version");
        dialog.addPanel('Panel 1','<div/>', 'gliffy-version-body');
        dialog.addLink("Cancel", function (dialog) {
            $(document).off('click', clickOutsideDialogHandler);
            dialog.remove();
        }, '#');
        dialog.show();

        var versionDialog = AJS.$('#gliffy-version-dialog');
        var spinner = new GliffySpinner(versionDialog.get(0), {
            radius: 50,
            color: '#666'
        });
        spinner.start();

        var getVersions = webRequestPromiseFactory.buildGetDiagramVersionsPromise(pageid, diagramReference.name);
        var processVersionsResponse = function (response) {
            spinner.stop();
            var versions = [
                {key: '0', value: "Latest"}
            ];
            var index = 0;
            for (var i = response.numRevisions; i > 0; i--) {
                versions.push({
                    key: '' + response.revisions[index].version,
                    value: 'v' + response.revisions[index].version
                });
                index++;
            }

            var data = {
                versions: versions,
                selectedVersion: diagramReference.version || 0,
                allVersionInformation: response.revisions.map(function (value) {
                    return value.lastModifiedFriendly + " by " + value.creator;
                }).reverse()

            };

            $('.gliffy-version-body').html(gliffySoy.macro.dialog.versionPropertyPanel(data));
            dialog.addButton("Update", function (dialog) {
                $(document).off('click', clickOutsideDialogHandler);

                analytics.event('trackEvent', {category: 'viewer', action: 'pinToNewVersion'});

                var selectedVal = $('#gliffy-dialog-version-field').val();
                diagramReference.version = parseInt(selectedVal);
                pageFacade.addDiagramReference(diagramReference, macroNode);
                dialog.remove();
            });

            dialog.gotoPanel(0);

            updateVersionInformation(data, diagramReference.name, pageid);

            // add a handler for version selector, to display version information when changed
            $("#gliffy-dialog-version-field").change(function () {
                updateVersionInformation(data, diagramReference.name, pageid);
            });
        };

        function getVersionsFailed (xhr) {
            spinner.stop();
            $('#gliffy-version-dialog').remove();
            if (xhr.status === 404) {

                var dialog = new AJS.Dialog({
                    width: 340,
                    height: 190,
                    id: 'gliffy-version-dialog',
                    closeOnOutsideClick: true
                });

                var data = {
                    pageUnsavedMessage: "Sorry, version information is not available until the Confluence page has been saved."
                };

                dialog.addPanel('Diagram Version Selection', gliffySoy.macro.dialog.noSaveDialog(data), 'gliffy-version-body'); // ?
                dialog.addButton("Close", function (dialog) {
                    dialog.remove();
                });

                dialog.gotoPanel(0);
                dialog.show();
            }
        };

        $.when(getVersions).done(processVersionsResponse).fail(getVersionsFailed);
    };

    // Disable submit of form
    $("form[name='gliffy-more-form']").live("submit", function () {
        return false;
    });

    //======================================================================================================================
    // Override property panel style on create
    //======================================================================================================================
    //this is the atlassian custom event that is fired when a property panel is created.
    AJS.bind("created.property-panel", function (event, panel) {
        var macro = $(panel.anchor);
        if (macro.data("macro-name") === "gliffy") {
            //check if any buttons should be selected
            var diagramReference = pageFacade.getDiagramReference(macro);
            if (diagramReference.border) {
                panel.panel.find(".macro-property-panel-gliffy-button-image-border").addClass("selected");
            }
            //size
            if (diagramReference.size) {
                switch (diagramReference.size) {
                    case '300':
                        panel.panel.find(".macro-property-panel-gliffy-button-image-small").addClass("selected");
                        break;
                    case '600':
                        panel.panel.find(".macro-property-panel-gliffy-button-image-medium").addClass("selected");
                        break;
                    case '1200':
                        panel.panel.find(".macro-property-panel-gliffy-button-image-large").addClass("selected");
                        break;
                    default:
                        break;
                }
            }
            else {
                panel.panel.find(".macro-property-panel-gliffy-button-image-original").addClass("selected");
            }
        }
    });

    //======================================================================================================================
    // Override property panel macro when rte is ready
    //======================================================================================================================
    //override property panel

    // GCONF-809
    AJS.MacroBrowser.setMacroJsOverride('gliffy', {
        opener: gliffyEdit
    });

    AJS.Confluence.PropertyPanel.Macro.registerButtonHandler("gliffy-button-image-small", function (e, macroNode) {
        gliffyImageSize(macroNode, "300");
    });

    AJS.Confluence.PropertyPanel.Macro.registerButtonHandler("gliffy-button-image-medium", function (e, macroNode) {
        gliffyImageSize(macroNode, "600");
    });

    AJS.Confluence.PropertyPanel.Macro.registerButtonHandler("gliffy-button-image-large", function (e, macroNode) {
        gliffyImageSize(macroNode, "1200");
    });

    AJS.Confluence.PropertyPanel.Macro.registerButtonHandler("gliffy-button-image-original", function (e, macroNode) {
        gliffyImageSize(macroNode, "O");
    });

    AJS.Confluence.PropertyPanel.Macro.registerButtonHandler("gliffy-button-image-border", function (e, macroNode) {
        gliffyBorderToggle(macroNode);
    });

    AJS.Confluence.PropertyPanel.Macro.registerButtonHandler("gliffy-button-more", function (e, macroNode) {
        gliffyMoreButton(macroNode);
    });

    AJS.Confluence.PropertyPanel.Macro.registerButtonHandler("gliffy-button-version", function (e, macroNode) {
        gliffyVersionButton(macroNode);
    });
});

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-rte-html5-resources', location = 'gliffy/confluence/ContextFinalizer.js' */
/**
 * Exists to require, and therefore execute, application-level bits like DOM controllers.
 * This must be included as the final resource of the web-resource definition
 */
;(function($, apexModuleManager) {
    // Wait for DOM to be loaded before instantiating apex modules.
    $(function () {
        apexModuleManager.instantiateAll();
        apexModuleManager.reset();
    });
})(require('jquery'), require('gliffy/amd/apexModuleManager'));


}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.lewe.confluence.plugins.bootstrapvisuals:macro-browser-smart-fields', location = '/com/lewe/confluence/plugins/js/confluence-core-macro-fields.js' */
(function(a){AJS.MacroBrowser.activateSmartFieldsAttachmentsOnPage("card",["gif","jpg","png"]);AJS.MacroBrowser.activateSmartFieldsAttachmentsOnPage("card5",["gif","jpg","png"]);AJS.MacroBrowser.activateSmartFieldsAttachmentsOnPage("bsvcard",["gif","jpg","png"])})(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.extra.officeconnector:macro-browser-smart-fields', location = 'javascript/office-connector-macro-fields.js' */
(function(d){AJS.MacroBrowser.activateSmartFieldsAttachmentsOnPage("viewdoc",["doc","docx"]);AJS.MacroBrowser.activateSmartFieldsAttachmentsOnPage("viewpdf",["pdf"]);AJS.MacroBrowser.activateSmartFieldsAttachmentsOnPage("viewxls",["xls","xlsx"]);AJS.MacroBrowser.activateSmartFieldsAttachmentsOnPage("viewppt",["ppt","pptx"]);AJS.MacroBrowser.Macros.viewfile={updateSelectedMacro:function(b){var a=b.params[""]||b.params.name;if(a){var c=a.lastIndexOf(".");0<c&&(a=a.substring(c+1))&&("doc"==a&&"docx"==
a&&(b.name="viewdoc"),"pdf"==a&&(b.name="viewpdf"),"ppt"==a&&"pptx"==a&&(b.name="viewppt"),"xls"==a&&"xlsx"==a&&(b.name="viewxls"))}}}})(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.stiltsoft.confluence.plugin.tablefilter.tablefilter:b71c00b4d14f9b4b01647f7b33d21f1d', location = 'build/6834.js' */
"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[6834],{6834:function(e,t,n){n.r(t),n.d(t,{default:function(){return d}});var a=n(7945),r=n.n(a),s=n(5689);function i(e,t,n,a,r,s,i){try{var o=e[s](i),u=o.value}catch(e){return void n(e)}o.done?t(u):Promise.resolve(u).then(a,r)}function o(e){return function(){var t=this,n=arguments;return new Promise((function(a,r){var s=e.apply(t,n);function o(e){i(s,a,r,o,u,"next",e)}function u(e){i(s,a,r,o,u,"throw",e)}o(void 0)}))}}function u(e,t,n){return c.apply(this,arguments)}function c(){return(c=o(r().mark((function e(t,n,a){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=JSON,e.next=3,(0,s.getAttachmentData)(t,n,a);case 3:return e.t1=e.sent,e.abrupt("return",e.t0.parse.call(e.t0,e.t1));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var p=n(3132);function f(e,t,n,a,r,s,i){try{var o=e[s](i),u=o.value}catch(e){return void n(e)}o.done?t(u):Promise.resolve(u).then(a,r)}function h(e){return function(){var t=this,n=arguments;return new Promise((function(a,r){var s=e.apply(t,n);function i(e){f(s,a,r,i,o,"next",e)}function o(e){f(s,a,r,i,o,"throw",e)}i(void 0)}))}}function l(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var d=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.params=t,this.$iframe=n}var t,n,a,s,i;return t=e,(n=[{key:"init",value:(i=h(r().mark((function e(){var t,n,a=this;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.params.attachment){e.next=6;break}return e.next=3,u(this.params.pageId,this.params.spaceKey,this.params.attachment);case 3:e.t0=e.sent,e.next=7;break;case 6:e.t0=this.params.data&&JSON.parse(this.params.data);case 7:return t=e.t0,"complete"===((n=this.$iframe[0]).contentDocument||n.contentWindow.document).readyState&&this.onIframeLoad(n,t),n.onload=function(){return setTimeout((function(){a.spreadsheetModule=null,a.onIframeLoad(n,t)}),0)},e.abrupt("return",t);case 13:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"onIframeLoad",value:function(e,t){var n=this,a=e.contentWindow;a.SpreadsheetModule&&!this.spreadsheetModule?(a.AJS=AJS,a.Confluence=Confluence,this.spreadsheetModule=new a.SpreadsheetModule({data:t,title:this.params.attachment,pageId:this.params.pageId,spaceKey:this.params.spaceKey,lang:AJS.Meta.get("user-locale"),exit:this.params.exit,save:this.params.save,open:this.openFile,openFullScreen:this.params.openFullScreen}),this.spreadsheetModule.init()):window.addEventListener("message",(function(a){a.data===p.iframeMessage&&n.onIframeLoad(e,t)}),!1)}},{key:"getModule",value:function(){return this.spreadsheetModule}},{key:"openFile",value:(s=h(r().mark((function e(){var t=arguments;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.apply(void 0,t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),function(){return s.apply(this,arguments)})}])&&l(t.prototype,n),a&&l(t,a),Object.defineProperty(t,"prototype",{writable:!1}),e}()}}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.stiltsoft.confluence.plugin.tablefilter.tablefilter:5f1538d09154f84f0b39b832e92f9e98', location = 'build/9490.js' */
(self.webpackChunk=self.webpackChunk||[]).push([[9490],{6290:function(t){t.exports={getDataFromAttachmentName:function(t,e){if(t.indexOf("^")>0){var n=t.split("^"),r=n[1],a=n[0];n[0].indexOf(":")>0&&(e=(n=n[0].split(":"))[0],a=n[1]);var c=a.indexOf("/")>0,o="";if(c){var i=a.split("/");a=i[3],o=i.slice(0,3).join("-")}return{attachmentName:r,pageTitle:a,spaceKey:e,postingDate:o,type:c?"blogpost":"page"}}return{attachmentName:t}}}},5689:function(t,e,n){"use strict";n.r(e),n.d(e,{getAttachmentData:function(){return k},getAttachments:function(){return x},getAttachmnetDataFromLink:function(){return T},getContentById:function(){return v},searchAttachments:function(){return O},searchContentByCQL:function(){return w},searchPage:function(){return b},storeAttachment:function(){return g}});var r=n(7945),a=n.n(r),c=n(6290),o=n(3926);function i(t,e,n,r,a,c,o){try{var i=t[c](o),u=i.value}catch(t){return void n(t)}i.done?e(u):Promise.resolve(u).then(r,a)}var u=function(){var t,e=(t=a().mark((function t(e,n){var r,c,o,i,u;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.resultGlobalContainer.displayUrl.split("display/")[1],c=e.resultParentContainer.title,o=e.content.title,(i=e.resultParentContainer.displayUrl.split(r+"/")[1].match("\\d{4}/\\d{2}/\\d{2}"))&&(c=i[0]+"/"+c),t.next=7,b(c,r,n);case 7:return u=t.sent,t.abrupt("return",{wikiLink:o,parentPageId:u,parentTitle:c,parentSpaceKey:r});case 9:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(r,a){var c=t.apply(e,n);function o(t){i(c,r,a,o,u,"next",t)}function u(t){i(c,r,a,o,u,"throw",t)}o(void 0)}))});return function(t,n){return e.apply(this,arguments)}}(),s=function(t){var e=new FormData;return e.append("file",t),{type:"POST",contentType:!1,processData:!1,data:e}};function p(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function l(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?p(Object(n),!0).forEach((function(e){f(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function f(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function d(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return m(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return m(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,a=function(){};return{s:a,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,i=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){i=!0,c=t},f:function(){try{o||null==n.return||n.return()}finally{if(i)throw c}}}}function m(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function h(t,e,n,r,a,c,o){try{var i=t[c](o),u=i.value}catch(t){return void n(t)}i.done?e(u):Promise.resolve(u).then(r,a)}function y(t){return function(){var e=this,n=arguments;return new Promise((function(r,a){var c=t.apply(e,n);function o(t){h(c,r,a,o,i,"next",t)}function i(t){h(c,r,a,o,i,"throw",t)}o(void 0)}))}}var v=function(t){return new Promise((function(e,n){(0,o.makeRequest)({url:"/rest/api/content/".concat(t),type:"GET",contentType:"application/json",dataType:"text",success:function(t){e(t)},error:function(t){n(new Error(t))}})}))},w=function(t){return new Promise((function(e){(0,o.makeRequest)({type:"GET",url:"/rest/api/content/search",contentType:"application/json",dataType:"text",data:t||{cql:""},success:function(t){e(t)},error:function(){e('{ "results": [] }')}})}))},b=function(){var t=y(a().mark((function t(e,n,r,c){var o,i,u,s,p,l,f,m;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=null,e){t.next=4;break}return o={id:r},t.abrupt("return",o);case 4:return i="=",-1!==e.indexOf('"')&&(e=e.replace(/"/g,""),i="~"),u='space = "'.concat(n,'" and title ').concat(i,' "').concat(e,'"'),t.next=9,w({cql:u,expand:c,limit:200});case 9:if(s=t.sent,1!==(p=JSON.parse(s).results).length){t.next=14;break}return o=p[0],t.abrupt("return",o);case 14:l=d(p),t.prev=15,l.s();case 17:if((f=l.n()).done){t.next=24;break}if(m=f.value,!e||m.title!==e){t.next=22;break}return o=m,t.abrupt("break",24);case 22:t.next=17;break;case 24:t.next=29;break;case 26:t.prev=26,t.t0=t.catch(15),l.e(t.t0);case 29:return t.prev=29,l.f(),t.finish(29);case 32:return t.abrupt("return",o);case 33:case"end":return t.stop()}}),t,null,[[15,26,29,32]])})));return function(e,n,r,a){return t.apply(this,arguments)}}(),g=function(t,e,n,r,i){return new Promise((function(u,p){y(a().mark((function f(){var d,m,h,y,v;return a().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(a.prev=0,!(d=(0,c.getDataFromAttachmentName)(r,e)).pageTitle){a.next=7;break}return a.next=5,b(d.pageTitle,d.spaceKey,t);case 5:(m=a.sent)&&(t=m.id);case 7:h=new File([n],d.attachmentName),y=s(h),v=i?"draft":"current",(0,o.makeRequest)(l(l({},y),{},{url:"/rest/api/content/".concat(t,"/child/attachment?status=").concat(v,"&allowDuplicated=true"),headers:{"X-Atlassian-Token":"nocheck"},success:function(t){u(t)},error:function(t){p(new Error(t))}})),a.next=16;break;case 13:a.prev=13,a.t0=a.catch(0),p(a.t0);case 16:case"end":return a.stop()}}),f,null,[[0,13]])})))()}))},x=function(t,e,n){return new Promise((function(r,a){var i=(0,c.getDataFromAttachmentName)(n,e);i.pageTitle?(0,o.makeRequest)({url:"/rest/api/content",type:"GET",contentType:"application/json",dataType:"text",data:{expand:"children.attachment",spaceKey:i.spaceKey,title:i.pageTitle,postingDay:i.postingDate,type:i.type},success:function(t){var e,n=JSON.parse(t);if(null!==(e=n.results)&&void 0!==e&&e.length){var c=n.results[0].children.attachment;r({response:c,name:i.attachmentName})}else a(new Error("Page with attachment not found."))},error:function(t){a(new Error(t))}}):(0,o.makeRequest)({url:"/rest/api/content/".concat(t,"/child/attachment"),type:"GET",contentType:"application/json",dataType:"text",data:{expand:"children.attachment",filename:n},success:function(t){r({response:JSON.parse(t),name:n})},error:function(t){a(new Error(t))}})}))},k=function(t,e,n){return new Promise((function(r,c){y(a().mark((function i(){var u,s,p,l;return a().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,x(t,e,n);case 3:u=a.sent,s=u.response,p=u.name,0===(l=s.results.filter((function(t){return p===t.title}))).length?c(new Error("Attachment not found.")):(0,o.makeRequest)({url:l[0]._links.download,type:"GET",contentType:"application/json",success:function(t){r(t)},error:function(t){c(new Error(t))}}),a.next=13;break;case 10:a.prev=10,a.t0=a.catch(0),c(a.t0);case 13:case"end":return a.stop()}}),i,null,[[0,10]])})))()}))},O=function(t,e,n,r){return new Promise((function(c){var i,s;i=r?function(t,e){var n=t?'title~"'.concat(t,'*" and '):"";return n+'(sitesearch~"file.extension:'+e.join('" or sitesearch~"file.extension:')+'")'}(n,r):'title~"'.concat(n,'*"'),(0,o.makeRequest)({type:"GET",url:"/rest/api/search",contentType:"application/json",dataType:"text",data:{cql:'type = "attachment" and '.concat(i," order by created desc"),excerpt:!1,limit:10},success:(s=y(a().mark((function n(r){var o;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Promise.all(JSON.parse(r).results.map(function(){var n=y(a().mark((function n(r){var c,o,i,s,p;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,u(r,t);case 2:return c=n.sent,o=c.wikiLink,i=c.parentPageId,s=c.parentTitle,p=c.parentSpaceKey,s&&t!=i&&(o="".concat(s,"^").concat(o),e===p&&-1===s.indexOf(":")||(o="".concat(p,":").concat(o))),n.abrupt("return",{label:r.content.title+(s?" (".concat(s,")"):""),value:o});case 9:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}()));case 2:o=n.sent,c(o);case 4:case"end":return n.stop()}}),n)}))),function(t){return s.apply(this,arguments)})})}))},T=function(t){return new Promise((function(e,n){var r=t.split("/"),a=r[r.length-2],c=r[r.length-1];(!a||!c)&&n(new Error("Attachment data not found.")),(0,o.makeRequest)({type:"GET",url:"/rest/api/content/".concat(a,"/child/attachment"),contentType:"application/json",dataType:"text",data:{expand:"children.attachment",filename:decodeURIComponent(c.replace(/\+/g," "))},success:function(t){try{var r=JSON.parse(t);e(r)}catch(t){n(new Error(t))}},error:function(t){return n(new Error(t))}})}))}},3132:function(t,e,n){"use strict";n.r(e),n.d(e,{iframeMessage:function(){return r}});var r="spreadsheet-ready"}}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.stiltsoft.confluence.plugin.tablefilter.tablefilter:08efd54746d67d6d02f0d5a6575dce49', location = 'build/7718.js' */
/*! For license information please see 7718.js.LICENSE.txt */
(self.webpackChunk=self.webpackChunk||[]).push([[7718],{7718:function(t,e,a){"use strict";a.r(e),a.d(e,{default:function(){return xe}});var i=a(7945),n=a.n(i),r=a(8605),u=a(2413),o=a(7559),s=a.n(o),l=a(5214);function c(t){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var h="d3pie",p=0,g={header:{title:{text:"",color:"#333333",fontSize:18,font:"arial"},subtitle:{text:"",color:"#666666",fontSize:14,font:"arial"},location:"top-center",titleSubtitlePadding:8},footer:{text:"",color:"#666666",fontSize:14,font:"arial",location:"left"},size:{canvasHeight:500,canvasWidth:500,pieInnerRadius:"0%",pieOuterRadius:null},data:{sortOrder:"none",ignoreSmallSegments:{enabled:!1,valueType:"percentage",value:null},smallSegmentGrouping:{enabled:!1,value:1,valueType:"percentage",label:"Other",color:"#cccccc"},content:[]},labels:{outer:{format:"label",hideWhenLessThanPercentage:null,pieDistance:30},inner:{format:"percentage",hideWhenLessThanPercentage:null},mainLabel:{color:"#333333",font:"arial",fontSize:10},percentage:{color:"#dddddd",font:"arial",fontSize:10,decimalPlaces:0},value:{color:"#cccc44",font:"arial",fontSize:10},lines:{enabled:!0,style:"curved",color:"segment"},truncation:{enabled:!1,truncateLength:30},formatter:null},effects:{load:{effect:"default",speed:1e3},pullOutSegmentOnClick:{effect:"bounce",speed:300,size:10},highlightSegmentOnMouseover:!0,highlightLuminosity:-.2},tooltips:{enabled:!1,type:"placeholder",string:"",placeholderParser:null,styles:{fadeInSpeed:250,backgroundColor:"#000000",backgroundOpacity:.5,color:"#efefef",borderRadius:2,font:"arial",fontSize:10,padding:4}},misc:{colors:{background:null,segments:["#2484c1","#65a620","#7b6888","#a05d56","#961a1a","#d8d23a","#e98125","#d0743c","#635222","#6ada6a","#0c6197","#7d9058","#207f33","#44b9b0","#bca44a","#e4a14b","#a3acb2","#8cc3e9","#69a6f9","#5b388f","#546e91","#8bde95","#d2ab58","#273c71","#98bf6e","#4daa4b","#98abc5","#cc1010","#31383b","#006391","#c2643f","#b0a474","#a5a39c","#a9c2bc","#22af8c","#7fcecf","#987ac6","#3d3b87","#b77b1c","#c9c2b6","#807ece","#8db27c","#be66a2","#9ed3c6","#00644b","#005064","#77979f","#77e079","#9c73ab","#1f79a7"],segmentStroke:"#ffffff"},gradient:{enabled:!1,percentage:95,color:"#000000"},canvasPadding:{top:5,right:5,bottom:5,left:5},pieCenterOffset:{x:0,y:0},cssPrefix:null},callbacks:{onload:null,onMouseoverSegment:null,onMouseoutSegment:null,onClickSegment:null}},f=function(t){var e=t.cssPrefix,a=t.element,i=t.options;if(!(a instanceof HTMLElement||a instanceof SVGElement))return!1;if(!/[a-zA-Z][a-zA-Z0-9_-]*$/.test(e))return!1;if(!m.isArray(i.data.content))return!1;if(0===i.data.content.length)return!1;for(var n=[],r=0;r<i.data.content.length;r++)"number"!=typeof i.data.content[r].value||isNaN(i.data.content[r].value)||i.data.content[r].value<=0||n.push(i.data.content[r]);return t.options.data.content=n,!0},m={addSVGSpace:function(t){var e=t.element,a=t.options.size.canvasWidth,i=t.options.size.canvasHeight,n=t.options.misc.colors.background,u=r.default.select(e).append("svg:svg").attr("width",a).attr("height",i);return"transparent"!==n&&u.style("background-color",(function(){return n})),u},whenIdExists:function(t,e){var a=1,i=setInterval((function(){document.getElementById(t)&&(clearInterval(i),e()),a>1e3&&clearInterval(i),a++}),1)},whenElementsExist:function(t,e){var a=1,i=setInterval((function(){for(var n=!0,r=0;r<t.length;r++)if(!document.getElementById(t[r])){n=!1;break}n&&(clearInterval(i),e()),a>1e3&&clearInterval(i),a++}),1)},shuffleArray:function(t){for(var e,a,i=t.length;0!==i;)a=Math.floor(Math.random()*i),e=t[i-=1],t[i]=t[a],t[a]=e;return t},processObj:function(t,e,a){return"string"==typeof e?m.processObj(t,e.split("."),a):1===e.length&&void 0!==a?(t[e[0]]=a,t[e[0]]):0===e.length?t:m.processObj(t[e[0]],e.slice(1),a)},getDimensions:function(t){var e=document.getElementById(t),a=0,i=0;if(e){var n=e.getBBox();a=n.width,i=n.height}return{w:a,h:i}},rectIntersect:function(t,e){return!(e.x>t.x+t.w||e.x+e.w<t.x||e.y+e.h<t.y||e.y>t.y+t.h)},getColorShade:function(t,e){(t=String(t).replace(/[^0-9a-f]/gi,"")).length<6&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]),e=e||0;for(var a="#",i=0;i<3;i++){var n=parseInt(t.substr(2*i,2),16);a+=("00"+(n=Math.round(Math.min(Math.max(0,n+n*e),255)).toString(16))).substr(n.length)}return a},initSegmentColors:function(t){for(var e=t.options.data.content,a=t.options.misc.colors.segments,i=[],n=0;n<e.length;n++)e[n].hasOwnProperty("color")?i.push(e[n].color):i.push(a[n]);return i},applySmallSegmentGrouping:function(t,e){var a;"percentage"===e.valueType&&(a=y.getTotalPieSize(t));for(var i=[],n=[],r=0,u=0;u<t.length;u++)if("percentage"===e.valueType){if(t[u].value/a*100<=e.value){n.push(t[u]),r+=t[u].value;continue}t[u].isGrouped=!1,i.push(t[u])}else{if(t[u].value<=e.value){n.push(t[u]),r+=t[u].value;continue}t[u].isGrouped=!1,i.push(t[u])}return n.length&&i.push({color:e.color,label:e.label,value:r,isGrouped:!0,groupedData:n}),i},showPoint:function(t,e,a){t.append("circle").attr("cx",e).attr("cy",a).attr("r",2).style("fill","black")},isFunction:function(t){return t&&"[object Function]"==={}.toString.call(t)},isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)}},x=function t(){var e,a,i,n,r,u,o=arguments[0]||{},s=1,l=arguments.length,h=!1,d=Object.prototype.toString,p=Object.prototype.hasOwnProperty,g={"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Date]":"date","[object RegExp]":"regexp","[object Object]":"object"},f={isFunction:function(t){return"function"===f.type(t)},isArray:Array.isArray||function(t){return"array"===f.type(t)},isWindow:function(t){return null!==t&&t===t.window},isNumeric:function(t){return!isNaN(parseFloat(t))&&isFinite(t)},type:function(t){return null===t?String(t):g[d.call(t)]||"object"},isPlainObject:function(t){if(!t||"object"!==f.type(t)||t.nodeType)return!1;try{if(t.constructor&&!p.call(t,"constructor")&&!p.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}var e;for(e in t);return void 0===e||p.call(t,e)}};for("boolean"==typeof o&&(h=o,o=arguments[1]||{},s=2),"object"===c(o)||f.isFunction(o)||(o={}),l===s&&(o=this,--s);s<l;s++)if(null!==(e=arguments[s]))for(a in e)i=o[a],o!==(n=e[a])&&(h&&n&&(f.isPlainObject(n)||(r=f.isArray(n)))?(r?(r=!1,u=i&&f.isArray(i)?i:[]):u=i&&f.isPlainObject(i)?i:{},o[a]=t(h,u,n)):void 0!==n&&(o[a]=n));return o},y={toRadians:function(t){return t*(Math.PI/180)},toDegrees:function(t){return t*(180/Math.PI)},computePieRadius:function(t){var e=t.options.size,a=t.options.misc.canvasPadding,i=e.canvasWidth-a.left-a.right,n=e.canvasHeight-a.top-a.bottom;"pie-center"!==t.options.header.location&&(n-=t.textComponents.headerHeight),t.textComponents.footer.exists&&(n-=t.textComponents.footer.h);var r,u,o=(i<(n=n<0?0:n)?i:n)/("none"===t.options.labels.outer.format?2:3);if(null!==e.pieOuterRadius)if(/%/.test(e.pieOuterRadius)){u=(u=(u=parseInt(e.pieOuterRadius.replace(/[\D]/,""),10))>99?99:u)<0?0:u;var s=i<n?i:n;if("none"!==t.options.labels.outer.format){var l=2*parseInt(t.options.labels.outer.pieDistance,10);s-l>0&&(s-=l)}o=Math.floor(s/100*u)/2}else o=parseInt(e.pieOuterRadius,10);/%/.test(e.pieInnerRadius)?(u=(u=(u=parseInt(e.pieInnerRadius.replace(/[\D]/,""),10))>99?99:u)<0?0:u,r=Math.floor(o/100*u)):r=parseInt(e.pieInnerRadius,10),t.innerRadius=r,t.outerRadius=o},getTotalPieSize:function(t){for(var e=0,a=0;a<t.length;a++)e+=t[a].value;return e},sortPieData:function(t){var e=t.options.data.content;switch(t.options.data.sortOrder){case"none":break;case"random":e=m.shuffleArray(e);break;case"value-asc":e.sort((function(t,e){return t.value<e.value?-1:1}));break;case"value-desc":e.sort((function(t,e){return t.value<e.value?1:-1}));break;case"label-asc":e.sort((function(t,e){return t.label.toLowerCase()>e.label.toLowerCase()?1:-1}));break;case"label-desc":e.sort((function(t,e){return t.label.toLowerCase()<e.label.toLowerCase()?1:-1}))}return e},getPieTranslateCenter:function(t){return"translate("+t.x+","+t.y+")"},calculatePieCenter:function(t){var e=t.options.misc.pieCenterOffset,a=t.textComponents.title.exists&&"pie-center"!==t.options.header.location,i=t.textComponents.subtitle.exists&&"pie-center"!==t.options.header.location,n=t.options.misc.canvasPadding.top;a&&i?n+=t.textComponents.title.h+t.options.header.titleSubtitlePadding+t.textComponents.subtitle.h:a?n+=t.textComponents.title.h:i&&(n+=t.textComponents.subtitle.h);var r=0;t.textComponents.footer.exists&&(r=t.textComponents.footer.h+t.options.misc.canvasPadding.bottom);var u=(t.options.size.canvasWidth-t.options.misc.canvasPadding.left-t.options.misc.canvasPadding.right)/2+t.options.misc.canvasPadding.left,o=(t.options.size.canvasHeight-r-n)/2+n;u+=e.x,o+=e.y,t.pieCenter={x:u,y:o}},rotate:function(t,e,a,i,n){n=n*Math.PI/180;var r=Math.cos,u=Math.sin;return{x:(t-a)*r(n)-(e-i)*u(n)+a,y:(t-a)*u(n)+(e-i)*r(n)+i}},translate:function(t,e,a,i){var n=y.toRadians(i);return{x:t+a*Math.sin(n),y:e-a*Math.cos(n)}},pointIsInArc:function(t,e,a){var i=a.innerRadius()(e),n=a.outerRadius()(e),r=a.startAngle()(e),u=a.endAngle()(e),o=t.x*t.x+t.y*t.y,s=Math.atan2(t.x,-t.y);return s=s<0?s+2*Math.PI:s,i*i<=o&&o<=n*n&&r<=s&&s<=u}},D={add:function(t,e,a){var i=D.getIncludes(a),n=t.options.labels,r=t.svg.insert("g","."+t.cssPrefix+"labels-"+e).attr("class",t.cssPrefix+"labels-"+e).selectAll("."+t.cssPrefix+"labelGroup-"+e).data(t.options.data.content).enter().append("g").attr("id",(function(a,i){return t.cssPrefix+"labelGroup"+i+"-"+e})).attr("data-index",(function(t,e){return e})).attr("class",t.cssPrefix+"labelGroup-"+e).style("opacity",0),u={section:e,sectionDisplayType:a};i.mainLabel&&r.append("text").attr("id",(function(a,i){return t.cssPrefix+"segmentMainLabel"+i+"-"+e})).attr("class",t.cssPrefix+"segmentMainLabel-"+e).text((function(t,e){var a=t.label;return n.formatter?(u.index=e,u.part="mainLabel",u.value=t.value,u.label=a,a=n.formatter(u)):n.truncation.enabled&&t.label.length>n.truncation.truncateLength&&(a=t.label.substring(0,n.truncation.truncateLength)+"..."),a})).style("font-size",n.mainLabel.fontSize+"px").style("font-family",n.mainLabel.font).style("fill",n.mainLabel.color),i.percentage&&r.append("text").attr("id",(function(a,i){return t.cssPrefix+"segmentPercentage"+i+"-"+e})).attr("class",t.cssPrefix+"segmentPercentage-"+e).text((function(t,e){var a=t.percentage;return n.formatter?(u.index=e,u.part="percentage",u.value=t.value,u.label=t.percentage,a=n.formatter(u)):a+="%",a})).style("font-size",n.percentage.fontSize+"px").style("font-family",n.percentage.font).style("fill",n.percentage.color),i.value&&r.append("text").attr("id",(function(a,i){return t.cssPrefix+"segmentValue"+i+"-"+e})).attr("class",t.cssPrefix+"segmentValue-"+e).text((function(t,e){return u.index=e,u.part="value",u.value=t.value,u.label=t.value,n.formatter?n.formatter(u,t.value):t.value})).style("font-size",n.value.fontSize+"px").style("font-family",n.value.font).style("fill",n.value.color)},positionLabelElements:function(t,e,a){D["dimensions-"+e]=[],r.default.selectAll("."+t.cssPrefix+"labelGroup-"+e).each((function(a,i){var n=r.default.select(this).selectAll("."+t.cssPrefix+"segmentMainLabel-"+e),u=r.default.select(this).selectAll("."+t.cssPrefix+"segmentPercentage-"+e),o=r.default.select(this).selectAll("."+t.cssPrefix+"segmentValue-"+e);D["dimensions-"+e].push({mainLabel:null!==n.node()?n.node().getBBox():null,percentage:null!==u.node()?u.node().getBBox():null,value:null!==o.node()?o.node().getBBox():null})}));var i=D["dimensions-"+e];switch(a){case"label-value1":r.default.selectAll("."+t.cssPrefix+"segmentValue-"+e).attr("dx",(function(t,e){return i[e].mainLabel.width+5}));break;case"label-value2":r.default.selectAll("."+t.cssPrefix+"segmentValue-"+e).attr("dy",(function(t,e){return i[e].mainLabel.height}));break;case"label-percentage1":r.default.selectAll("."+t.cssPrefix+"segmentPercentage-"+e).attr("dx",(function(t,e){return i[e].mainLabel.width+5}));break;case"label-percentage2":r.default.selectAll("."+t.cssPrefix+"segmentPercentage-"+e).attr("dx",(function(t,e){return i[e].mainLabel.width/2-i[e].percentage.width/2})).attr("dy",(function(t,e){return i[e].mainLabel.height}));break;case"value-percentage":r.default.selectAll("."+t.cssPrefix+"segmentValue-"+e).attr("dx",(function(t,e){return i[e].percentage.width/2-i[e].value.width/2})).attr("dy",(function(t,e){return-i[e].percentage.height/2})),r.default.selectAll("."+t.cssPrefix+"segmentPercentage-"+e).attr("dy",(function(t,e){return i[e].percentage.height/2}));break;case"percentage-value":r.default.selectAll("."+t.cssPrefix+"segmentValue-"+e).attr("dx",(function(t,e){return i[e].percentage.width/2-i[e].value.width/2})).attr("dy",(function(t,e){return i[e].percentage.height/2})),r.default.selectAll("."+t.cssPrefix+"segmentPercentage-"+e).attr("dy",(function(t,e){return-i[e].percentage.height/2}))}},computeLabelLinePositions:function(t){t.lineCoordGroups=[],r.default.selectAll("."+t.cssPrefix+"labelGroup-outer").each((function(e,a){return D.computeLinePosition(t,a)}))},computeLinePosition:function(t,e){var a,i,n,r,u=v.getSegmentAngle(e,t.options.data.content,t.totalSize,{midpoint:!0}),o=y.rotate(t.pieCenter.x,t.pieCenter.y-t.outerRadius,t.pieCenter.x,t.pieCenter.y,u),s=t.outerLabelGroupData[e].h/5,l=Math.floor(u/90);switch(2===l&&180===u&&(l=1),l){case 0:a=t.outerLabelGroupData[e].x-6-(t.outerLabelGroupData[e].x-6-o.x)/2,i=t.outerLabelGroupData[e].y+(o.y-t.outerLabelGroupData[e].y)/4,n=t.outerLabelGroupData[e].x-6,r=t.outerLabelGroupData[e].y-s;break;case 1:a=o.x+(t.outerLabelGroupData[e].x-o.x)/4,i=o.y+(t.outerLabelGroupData[e].y-o.y)/4,n=t.outerLabelGroupData[e].x-6,r=t.outerLabelGroupData[e].y-s;break;case 2:var c=t.outerLabelGroupData[e].x+t.outerLabelGroupData[e].w+6;a=o.x-(o.x-c)/4,i=o.y+(t.outerLabelGroupData[e].y-o.y)/4,n=t.outerLabelGroupData[e].x+t.outerLabelGroupData[e].w+6,r=t.outerLabelGroupData[e].y-s;break;case 3:var h=t.outerLabelGroupData[e].x+t.outerLabelGroupData[e].w+6;a=h+(o.x-h)/4,i=t.outerLabelGroupData[e].y+(o.y-t.outerLabelGroupData[e].y)/4,n=t.outerLabelGroupData[e].x+t.outerLabelGroupData[e].w+6,r=t.outerLabelGroupData[e].y-s}"straight"===t.options.labels.lines.style?t.lineCoordGroups[e]=[{x:o.x,y:o.y},{x:n,y:r}]:t.lineCoordGroups[e]=[{x:o.x,y:o.y},{x:a,y:i},{x:n,y:r}]},addLabelLines:function(t){var e=t.svg.insert("g","."+t.cssPrefix+"pieChart").attr("class",t.cssPrefix+"lineGroups").style("opacity",0).selectAll("."+t.cssPrefix+"lineGroup").data(t.lineCoordGroups).enter().append("g").attr("class",t.cssPrefix+"lineGroup"),a=r.default.line().curve(r.default.curveBasis).x((function(t){return t.x})).y((function(t){return t.y}));e.append("path").attr("d",a).attr("stroke",(function(e,a){return"segment"===t.options.labels.lines.color?t.options.colors[a]:t.options.labels.lines.color})).attr("stroke-width",1).attr("fill","none").style("opacity",(function(e,a){var i=t.options.labels.outer.hideWhenLessThanPercentage;return null!==i&&e.percentage<i||""===t.options.data.content[a].label?0:1}))},positionLabelGroups:function(t,e){"none"!==t.options.labels[e].format&&r.default.selectAll("."+t.cssPrefix+"labelGroup-"+e).style("opacity",0).attr("transform",(function(a,i){var n,r;if("outer"===e)n=t.outerLabelGroupData[i].x,r=t.outerLabelGroupData[i].y;else{var u=x(!0,{},t.pieCenter);if(t.innerRadius>0){var o=v.getSegmentAngle(i,t.options.data.content,t.totalSize,{midpoint:!0}),s=y.translate(t.pieCenter.x,t.pieCenter.y,t.innerRadius,o);u.x=s.x,u.y=s.y}var l=m.getDimensions(t.cssPrefix+"labelGroup"+i+"-inner"),c=l.w/2,h=l.h/4;n=u.x+(t.lineCoordGroups[i][0].x-u.x)/1.8,r=u.y+(t.lineCoordGroups[i][0].y-u.y)/1.8,n-=c,r+=h}return"translate("+n+","+r+")"}))},fadeInLabelsAndLines:function(t){var e="default"===t.options.effects.load.effect?t.options.effects.load.speed:1;setTimeout((function(){var e="default"===t.options.effects.load.effect?400:1;r.default.selectAll("."+t.cssPrefix+"labelGroup-outer").transition().duration(e).style("opacity",(function(e,a){var i=t.options.labels.outer.hideWhenLessThanPercentage;return null!==i&&e.percentage<i?0:1})),r.default.selectAll("."+t.cssPrefix+"labelGroup-inner").transition().duration(e).style("opacity",(function(e,a){var i=t.options.labels.inner.hideWhenLessThanPercentage;return null!==i&&e.percentage<i?0:1})),r.default.selectAll("g."+t.cssPrefix+"lineGroups").transition().duration(e).style("opacity",1),m.isFunction(t.options.callbacks.onload)&&setTimeout((function(){try{t.options.callbacks.onload()}catch(t){}}),e)}),e)},getIncludes:function(t){var e=!1,a=!1,i=!1;switch(t){case"label":e=!0;break;case"value":a=!0;break;case"percentage":i=!0;break;case"label-value1":case"label-value2":e=!0,a=!0;break;case"label-percentage1":case"label-percentage2":e=!0,i=!0;break;case"value-percentage":case"percentage-value":a=!0,i=!0}return{mainLabel:e,value:a,percentage:i}},computeOuterLabelCoords:function(t){t.svg.selectAll("."+t.cssPrefix+"labelGroup-outer").each((function(e,a){return D.getIdealOuterLabelPositions(t,a)})),D.resolveOuterLabelCollisions(t)},resolveOuterLabelCollisions:function(t){if("none"!==t.options.labels.outer.format){var e=t.options.data.content.length;D.checkConflict(t,0,"clockwise",e),D.checkConflict(t,e-1,"anticlockwise",e)}},checkConflict:function(t,e,a,i){var n,r;if(!(i<=1)){var u=t.outerLabelGroupData[e].hs;if(!("clockwise"===a&&"right"!==u||"anticlockwise"===a&&"left"!==u)){var o="clockwise"===a?e+1:e-1,s=t.outerLabelGroupData[e],l=t.outerLabelGroupData[o],c={labelHeights:t.outerLabelGroupData[0].h,center:t.pieCenter,lineLength:t.outerRadius+t.options.labels.outer.pieDistance,heightChange:t.outerLabelGroupData[0].h+1};if("clockwise"===a){for(n=0;n<=e;n++)if(r=t.outerLabelGroupData[n],!D.isLabelHidden(t,n)&&m.rectIntersect(r,l)){D.adjustLabelPos(t,o,s,c);break}}else for(n=i-1;n>=e;n--)if(r=t.outerLabelGroupData[n],!D.isLabelHidden(t,n)&&m.rectIntersect(r,l)){D.adjustLabelPos(t,o,s,c);break}D.checkConflict(t,o,a,i)}}},isLabelHidden:function(t,e){var a=t.options.labels.outer.hideWhenLessThanPercentage;return null!==a&&d.percentage<a||""===t.options.data.content[e].label},adjustLabelPos:function(t,e,a,i){var n,r,u,o;o=a.y+i.heightChange,r=i.center.y-o,n=Math.abs(i.lineLength)>Math.abs(r)?Math.sqrt(i.lineLength*i.lineLength-r*r):Math.sqrt(r*r-i.lineLength*i.lineLength),u="right"===a.hs?i.center.x+n:i.center.x-n-t.outerLabelGroupData[e].w,t.outerLabelGroupData[e].x=u,t.outerLabelGroupData[e].y=o},getIdealOuterLabelPositions:function(t,e){var a=r.default.select("#"+t.cssPrefix+"labelGroup"+e+"-outer").node();if(a){var i=a.getBBox(),n=v.getSegmentAngle(e,t.options.data.content,t.totalSize,{midpoint:!0}),u=t.pieCenter.x,o=t.pieCenter.y-(t.outerRadius+t.options.labels.outer.pieDistance),s=y.rotate(u,o,t.pieCenter.x,t.pieCenter.y,n),l="right";n>180?(s.x-=i.width+8,l="left"):s.x+=8,t.outerLabelGroupData[e]={x:s.x,y:s.y,w:i.width,h:i.height,hs:l}}}},v={effectMap:{none:r.default.easeLinear,bounce:r.default.easeBounce,linear:r.default.easeLinear,sin:r.default.easeSin,elastic:r.default.easeElastic,back:r.default.easeBack,quad:r.default.easeQuad,circle:r.default.easeCircle,exp:r.default.easeExp},create:function(t){var e=t.pieCenter,a=t.options.colors,i=t.options.effects.load,n=t.options.misc.colors.segmentStroke,u=t.svg.insert("g","#"+t.cssPrefix+"title").attr("transform",(function(){return y.getPieTranslateCenter(e)})).attr("class",t.cssPrefix+"pieChart"),o=r.default.arc().innerRadius(t.innerRadius).outerRadius(t.outerRadius).startAngle(0).endAngle((function(e){return e.value/t.totalSize*2*Math.PI})),s=u.selectAll("."+t.cssPrefix+"arc").data(t.options.data.content).enter().append("g").attr("class",t.cssPrefix+"arc"),l=i.speed;"none"===i.effect&&(l=0),s.append("path").attr("id",(function(e,a){return t.cssPrefix+"segment"+a})).attr("fill",(function(e,i){var n=a[i];return t.options.misc.gradient.enabled&&(n="url(#"+t.cssPrefix+"grad"+i+")"),n})).style("stroke",n).style("stroke-width",1).transition().ease(r.default.easeCubicInOut).duration(l).attr("data-index",(function(t,e){return e})).attrTween("d",(function(e){var a=r.default.interpolate({value:0},e);return function(e){return t.arc(a(e))}})),t.svg.selectAll("g."+t.cssPrefix+"arc").attr("transform",(function(e,a){var i=0;return a>0&&(i=v.getSegmentAngle(a-1,t.options.data.content,t.totalSize)),"rotate("+i+")"})),t.arc=o},addGradients:function(t){var e=t.svg.append("defs").selectAll("radialGradient").data(t.options.data.content).enter().append("radialGradient").attr("gradientUnits","userSpaceOnUse").attr("cx",0).attr("cy",0).attr("r","120%").attr("id",(function(e,a){return t.cssPrefix+"grad"+a}));e.append("stop").attr("offset","0%").style("stop-color",(function(e,a){return t.options.colors[a]})),e.append("stop").attr("offset",t.options.misc.gradient.percentage+"%").style("stop-color",t.options.misc.gradient.color)},addSegmentEventHandlers:function(t){var e=r.default.selectAll("."+t.cssPrefix+"arc,."+t.cssPrefix+"labelGroup-inner,."+t.cssPrefix+"labelGroup-outer");e.on("click",(function(){var e,a=r.default.select(this);if(a.attr("class")===t.cssPrefix+"arc")e=a.select("path");else{var i=a.attr("data-index");e=r.default.select("#"+t.cssPrefix+"segment"+i)}var n=e.attr("class")===t.cssPrefix+"expanded";v.onSegmentEvent(t,t.options.callbacks.onClickSegment,e,n),"none"!==t.options.effects.pullOutSegmentOnClick.effect&&(n?v.closeSegment(t,e.node()):v.openSegment(t,e.node()))})),e.on("mouseover",(function(){var e,a,i=r.default.select(this);if(i.attr("class")===t.cssPrefix+"arc"?e=i.select("path"):(a=i.attr("data-index"),e=r.default.select("#"+t.cssPrefix+"segment"+a)),t.options.effects.highlightSegmentOnMouseover){a=e.attr("data-index");var n=t.options.colors[a];e.style("fill",m.getColorShade(n,t.options.effects.highlightLuminosity))}t.options.tooltips.enabled&&(a=e.attr("data-index"),F.showTooltip(t,a));var u=e.attr("class")===t.cssPrefix+"expanded";v.onSegmentEvent(t,t.options.callbacks.onMouseoverSegment,e,u)})),e.on("mousemove",(function(){F.moveTooltip(t)})),e.on("mouseout",(function(){var e,a,i=r.default.select(this);if(i.attr("class")===t.cssPrefix+"arc"?e=i.select("path"):(a=i.attr("data-index"),e=r.default.select("#"+t.cssPrefix+"segment"+a)),t.options.effects.highlightSegmentOnMouseover){a=e.attr("data-index");var n=t.options.colors[a];t.options.misc.gradient.enabled&&(n="url(#"+t.cssPrefix+"grad"+a+")"),e.style("fill",n)}t.options.tooltips.enabled&&(a=e.attr("data-index"),F.hideTooltip(t,a));var u=e.attr("class")===t.cssPrefix+"expanded";v.onSegmentEvent(t,t.options.callbacks.onMouseoutSegment,e,u)}))},onSegmentEvent:function(t,e,a,i){if(m.isFunction(e)){var n=parseInt(a.attr("data-index"),10);e({segment:a.node(),index:n,expanded:i,data:t.options.data.content[n]})}},openSegment:function(t,e){t.isOpeningSegment||(t.isOpeningSegment=!0,v.maybeCloseOpenSegment(t),r.default.select(e).transition().ease(v.effectMap[t.options.effects.pullOutSegmentOnClick.effect]).duration(t.options.effects.pullOutSegmentOnClick.speed).attr("transform",(function(e,a){var i=t.arc.centroid(e),n=i[0],r=i[1],u=Math.sqrt(n*n+r*r),o=parseInt(t.options.effects.pullOutSegmentOnClick.size,10);return"translate("+n/u*o+","+r/u*o+")"})).on("end",(function(a,i){t.currentlyOpenSegment=e,t.isOpeningSegment=!1,r.default.select(e).attr("class",t.cssPrefix+"expanded")})))},maybeCloseOpenSegment:function(t){r.default.selectAll("."+t.cssPrefix+"expanded").size()>0&&v.closeSegment(t,r.default.select("."+t.cssPrefix+"expanded").node())},closeSegment:function(t,e){r.default.select(e).transition().duration(400).attr("transform","translate(0,0)").on("end",(function(a,i){r.default.select(e).attr("class",""),t.currentlyOpenSegment=null}))},getCentroid:function(t){var e=t.getBBox();return{x:e.x+e.width/2,y:e.y+e.height/2}},getSegmentAngle:function(t,e,a,i){var n,r=x({compounded:!0,midpoint:!1},i),u=e[t].value;if(r.compounded){n=0;for(var o=0;o<=t;o++)n+=e[o].value}void 0===n&&(n=u);var s=n/a*360;r.midpoint&&(s-=u/a*360/2);return s}},b={offscreenCoord:-1e4,addTitle:function(t){t.svg.selectAll("."+t.cssPrefix+"title").data([t.options.header.title]).enter().append("text").text((function(t){return t.text})).attr("id",t.cssPrefix+"title").attr("class",t.cssPrefix+"title").attr("x",b.offscreenCoord).attr("y",b.offscreenCoord).attr("text-anchor",(function(){return"top-center"===t.options.header.location||"pie-center"===t.options.header.location?"middle":"left"})).attr("fill",(function(t){return t.color})).style("font-size",(function(t){return t.fontSize+"px"})).style("font-family",(function(t){return t.font}))},positionTitle:function(t){var e,a=t.textComponents,i=t.options.header.location,n=t.options.misc.canvasPadding,r=t.options.size.canvasWidth,u=t.options.header.titleSubtitlePadding;e="top-left"===i?n.left:(r-n.right)/2+n.left,e+=t.options.misc.pieCenterOffset.x;var o=n.top+a.title.h;"pie-center"===i&&(o=t.pieCenter.y,a.subtitle.exists?o=o-(a.title.h+u+a.subtitle.h)/2+a.title.h:o+=a.title.h/4);t.svg.select("#"+t.cssPrefix+"title").attr("x",e).attr("y",o)},addSubtitle:function(t){var e=t.options.header.location;t.svg.selectAll("."+t.cssPrefix+"subtitle").data([t.options.header.subtitle]).enter().append("text").text((function(t){return t.text})).attr("x",b.offscreenCoord).attr("y",b.offscreenCoord).attr("id",t.cssPrefix+"subtitle").attr("class",t.cssPrefix+"subtitle").attr("text-anchor",(function(){return"top-center"===e||"pie-center"===e?"middle":"left"})).attr("fill",(function(t){return t.color})).style("font-size",(function(t){return t.fontSize+"px"})).style("font-family",(function(t){return t.font}))},positionSubtitle:function(t){var e,a=t.options.misc.canvasPadding,i=t.options.size.canvasWidth;e="top-left"===t.options.header.location?a.left:(i-a.right)/2+a.left,e+=t.options.misc.pieCenterOffset.x;var n=b.getHeaderHeight(t);t.svg.select("#"+t.cssPrefix+"subtitle").attr("x",e).attr("y",n)},addFooter:function(t){t.svg.selectAll("."+t.cssPrefix+"footer").data([t.options.footer]).enter().append("text").text((function(t){return t.text})).attr("x",b.offscreenCoord).attr("y",b.offscreenCoord).attr("id",t.cssPrefix+"footer").attr("class",t.cssPrefix+"footer").attr("text-anchor",(function(){var e="left";return"bottom-center"===t.options.footer.location?e="middle":"bottom-right"===t.options.footer.location&&(e="left"),e})).attr("fill",(function(t){return t.color})).style("font-size",(function(t){return t.fontSize+"px"})).style("font-family",(function(t){return t.font}))},positionFooter:function(t){var e,a=t.options.footer.location,i=t.textComponents.footer.w,n=t.options.size.canvasWidth,r=t.options.size.canvasHeight,u=t.options.misc.canvasPadding;e="bottom-left"===a?u.left:"bottom-right"===a?n-i-u.right:n/2,t.svg.select("#"+t.cssPrefix+"footer").attr("x",e).attr("y",r-u.bottom)},getHeaderHeight:function(t){var e;if(t.textComponents.title.exists){var a=t.textComponents.title.h+t.options.header.titleSubtitlePadding+t.textComponents.subtitle.h;e="pie-center"===t.options.header.location?t.pieCenter.y-a/2+a:a+t.options.misc.canvasPadding.top}else if("pie-center"===t.options.header.location){var i=t.options.misc.canvasPadding.bottom+t.textComponents.footer.h;e=(t.options.size.canvasHeight-i)/2+t.options.misc.canvasPadding.top+t.textComponents.subtitle.h/2}else e=t.options.misc.canvasPadding.top+t.textComponents.subtitle.h;return e}},F={addTooltips:function(t){var e=t.svg.insert("g").attr("class",t.cssPrefix+"tooltips");e.selectAll("."+t.cssPrefix+"tooltip").data(t.options.data.content).enter().append("g").attr("class",t.cssPrefix+"tooltip").attr("id",(function(e,a){return t.cssPrefix+"tooltip"+a})).style("opacity",0).append("rect").attr("rx",t.options.tooltips.styles.borderRadius).attr("ry",t.options.tooltips.styles.borderRadius).attr("x",-t.options.tooltips.styles.padding).attr("opacity",t.options.tooltips.styles.backgroundOpacity).style("fill",t.options.tooltips.styles.backgroundColor),e.selectAll("."+t.cssPrefix+"tooltip").data(t.options.data.content).append("text").attr("fill",(function(e){return t.options.tooltips.styles.color})).style("font-size",(function(e){return t.options.tooltips.styles.fontSize})).style("font-family",(function(e){return t.options.tooltips.styles.font})).text((function(e,a){var i=t.options.tooltips.string;return"caption"===t.options.tooltips.type&&(i=e.caption),F.replacePlaceholders(t,i,a,{label:e.label,value:e.value,percentage:e.percentage})})),e.selectAll("."+t.cssPrefix+"tooltip rect").attr("width",(function(e,a){return m.getDimensions(t.cssPrefix+"tooltip"+a).w+2*t.options.tooltips.styles.padding})).attr("height",(function(e,a){return m.getDimensions(t.cssPrefix+"tooltip"+a).h+2*t.options.tooltips.styles.padding})).attr("y",(function(e,a){return-m.getDimensions(t.cssPrefix+"tooltip"+a).h/2+1}))},showTooltip:function(t,e){var a=t.options.tooltips.styles.fadeInSpeed;F.currentTooltip===e&&(a=1),F.currentTooltip=e,r.default.select("#"+t.cssPrefix+"tooltip"+e).transition().duration(a).style("opacity",(function(){return 1})),F.moveTooltip(t)},moveTooltip:function(t){r.default.selectAll("#"+t.cssPrefix+"tooltip"+F.currentTooltip).attr("transform",(function(e){var a=r.default.pointer(event,this.parentNode);return"translate("+(a[0]+t.options.tooltips.styles.padding+2)+","+(a[1]-2*t.options.tooltips.styles.padding-2)+")"}))},hideTooltip:function(t,e){r.default.select("#"+t.cssPrefix+"tooltip"+e).style("opacity",(function(){return 0})),r.default.select("#"+t.cssPrefix+"tooltip"+F.currentTooltip).attr("transform",(function(e,a){return"translate("+(t.options.size.canvasWidth+1e3)+","+(t.options.size.canvasHeight+1e3)+")"}))},replacePlaceholders:function(t,e,a,i){m.isFunction(t.options.tooltips.placeholderParser)&&t.options.tooltips.placeholderParser(a,i);return e.replace(/\{(\w+)\}/g,(function(t){var e=arguments[1];return i.hasOwnProperty(e)?i[arguments[1]]:arguments[0]}))}},C=function(t,e){if(this.element=t,"string"==typeof t){var a=t.replace(/^#/,"");this.element=document.getElementById(a)}var i={};x(!0,i,g,e),this.options=i,null!==this.options.misc.cssPrefix?this.cssPrefix=this.options.misc.cssPrefix:(this.cssPrefix="p"+p+"_",p++),f(this)&&(r.default.select(this.element).attr(h,"0.2.1"),A.call(this),E.call(this))};C.prototype.recreate=function(){f(this)&&(A.call(this),E.call(this))},C.prototype.redraw=function(){this.element.innerHTML="",E.call(this)},C.prototype.destroy=function(){this.element.innerHTML="",r.default.select(this.element).attr(h,null)},C.prototype.getOpenSegment=function(){var t=this.currentlyOpenSegment;if(null!=t){var e=parseInt(r.default.select(t).attr("data-index"),10);return{element:t,index:e,data:this.options.data.content[e]}}return null},C.prototype.openSegment=function(t){(t=parseInt(t,10))<0||t>this.options.data.content.length-1||v.openSegment(this,r.default.select("#"+this.cssPrefix+"segment"+t).node())},C.prototype.closeSegment=function(t){v.maybeCloseOpenSegment(t)},C.prototype.updateProp=function(t,e){switch(t){case"header.title.text":var a=m.processObj(this.options,t);m.processObj(this.options,t,e),r.default.select("#"+this.cssPrefix+"title").html(e),(""===a&&""!==e||""!==a&&""===e)&&this.redraw();break;case"header.subtitle.text":var i=m.processObj(this.options,t);m.processObj(this.options,t,e),r.default.select("#"+this.cssPrefix+"subtitle").html(e),(""===i&&""!==e||""!==i&&""===e)&&this.redraw();break;case"callbacks.onload":case"callbacks.onMouseoverSegment":case"callbacks.onMouseoutSegment":case"callbacks.onClickSegment":case"effects.pullOutSegmentOnClick.effect":case"effects.pullOutSegmentOnClick.speed":case"effects.pullOutSegmentOnClick.size":case"effects.highlightSegmentOnMouseover":case"effects.highlightLuminosity":m.processObj(this.options,t,e);break;default:m.processObj(this.options,t,e),this.destroy(),this.recreate()}};var A=function(){this.options.data.content=y.sortPieData(this),this.options.data.smallSegmentGrouping.enabled&&(this.options.data.content=m.applySmallSegmentGrouping(this.options.data.content,this.options.data.smallSegmentGrouping)),this.options.colors=m.initSegmentColors(this),this.totalSize=y.getTotalPieSize(this.options.data.content);for(var t=this.options.labels.percentage.decimalPlaces,e=0;e<this.options.data.content.length;e++)this.options.data.content[e].percentage=_(this.options.data.content[e].value,this.totalSize,t);for(var a=0,i=0;i<this.options.data.content.length;i++)i===this.options.data.content.length-1&&(this.options.data.content[i].percentage=(100-a).toFixed(t)),a+=parseFloat(this.options.data.content[i].percentage)},E=function(){this.svg=m.addSVGSpace(this),this.textComponents={headerHeight:0,title:{exists:""!==this.options.header.title.text,h:0,w:0},subtitle:{exists:""!==this.options.header.subtitle.text,h:0,w:0},footer:{exists:""!==this.options.footer.text,h:0,w:0}},this.outerLabelGroupData=[],this.textComponents.title.exists&&b.addTitle(this),this.textComponents.subtitle.exists&&b.addSubtitle(this),b.addFooter(this);var t=this;m.whenIdExists(this.cssPrefix+"footer",(function(){b.positionFooter(t);var e=m.getDimensions(t.cssPrefix+"footer");t.textComponents.footer.h=e.h,t.textComponents.footer.w=e.w}));var e=[];this.textComponents.title.exists&&e.push(this.cssPrefix+"title"),this.textComponents.subtitle.exists&&e.push(this.cssPrefix+"subtitle"),this.textComponents.footer.exists&&e.push(this.cssPrefix+"footer"),m.whenElementsExist(e,(function(){if(t.textComponents.title.exists){var e=m.getDimensions(t.cssPrefix+"title");t.textComponents.title.h=e.h,t.textComponents.title.w=e.w}if(t.textComponents.subtitle.exists){var a=m.getDimensions(t.cssPrefix+"subtitle");t.textComponents.subtitle.h=a.h,t.textComponents.subtitle.w=a.w}if(t.textComponents.title.exists||t.textComponents.subtitle.exists){var i=0;t.textComponents.title.exists&&(i+=t.textComponents.title.h,t.textComponents.subtitle.exists&&(i+=t.options.header.titleSubtitlePadding)),t.textComponents.subtitle.exists&&(i+=t.textComponents.subtitle.h),t.textComponents.headerHeight=i}y.computePieRadius(t),y.calculatePieCenter(t),b.positionTitle(t),b.positionSubtitle(t),t.options.misc.gradient.enabled&&v.addGradients(t),v.create(t),D.add(t,"inner",t.options.labels.inner.format),D.add(t,"outer",t.options.labels.outer.format),D.positionLabelElements(t,"inner",t.options.labels.inner.format),D.positionLabelElements(t,"outer",t.options.labels.outer.format),D.computeOuterLabelCoords(t),D.positionLabelGroups(t,"outer"),D.computeLabelLinePositions(t),t.options.labels.lines.enabled&&"none"!==t.options.labels.outer.format&&D.addLabelLines(t),D.positionLabelGroups(t,"inner"),D.fadeInLabelsAndLines(t),t.options.tooltips.enabled&&F.addTooltips(t),v.addSegmentEventHandlers(t)}))},_=function(t,e,a){var i=t/e;return a<=0?Math.round(100*i):(100*i).toFixed(a)},w=C,B=a(5546),k=a(9264),S=a(2166),T=a.n(S),P={};function L(t,e,a,i){if(t.endAngle-t.startAngle==0)return"M 0 0";var n=e*Math.cos(t.startAngle),r=a*Math.sin(t.startAngle),u=e*Math.cos(6.283185307179587===t.endAngle?6.283185307179586:t.endAngle),o=a*Math.sin(6.283185307179587===t.endAngle?6.283185307179586:t.endAngle),s=[];return s.push("M",n,r,"A",e,a,"0",t.endAngle-t.startAngle>Math.PI?1:0,"1",u,o,"L",i*u,i*o),s.push("A",i*e,i*a,"0",t.endAngle-t.startAngle>Math.PI?1:0,"0",i*n,i*r,"z"),s.join(" ")}function M(t,e,a,i){var n=t.startAngle>Math.PI?Math.PI:t.startAngle,r=t.endAngle>Math.PI?Math.PI:t.endAngle,u=e*Math.cos(n),o=a*Math.sin(n),s=e*Math.cos(r),l=a*Math.sin(r),c=[];return c.push("M",u,i+o,"A",e,a,"0 0 1",s,i+l,"L",s,l,"A",e,a,"0 0 0",u,o,"z"),c.join(" ")}function I(t,e,a,i,n){var r=t.startAngle<Math.PI?Math.PI:t.startAngle,u=t.endAngle<Math.PI?Math.PI:t.endAngle,o=n*e*Math.cos(r),s=n*a*Math.sin(r),l=n*e*Math.cos(u),c=n*a*Math.sin(u),h=[];return h.push("M",o,s,"A",n*e,n*a,"0 0 1",l,c,"L",l,i+c,"A",n*e,n*a,"0 0 0",o,i+s,"z"),h.join(" ")}function V(t,e,a,i,n,r,u){t.data(e).enter().append("text").attr("class","percent").attr("x",(function(t){var e=AJS.$("<span></span>").text(u(t));e.appendTo("body");var n=e.width();e.remove();var r=i*a,o=Math.cos(.5*(t.startAngle+t.endAngle));return.5*(i-r)*o+r*o-n/2})).attr("y",(function(t){var e=n*a,i=Math.sin(.5*(t.startAngle+t.endAngle));return.5*(n-e)*i+e*i+r})).text((function(t){return u(t)})).style("fill",(function(t){return t.data.textColor})).each((function(t){this._current=t}))}P.getPercent=function(t){return Math.round(1e3*(t.endAngle-t.startAngle)/(2*Math.PI))/10+"%"},P.transition=function(t,e,a,i,n,u){var o=r.default.pie().sort(null).value((function(t){return t.value}))(e);r.default.select("#"+t).selectAll(".innerSlice").data(o).transition().duration(750).attrTween("d",(function(t){var e=r.default.interpolate(this._current,t);return this._current=e(0),function(t){return I(e(t),a+.5,i+.5,n,u)}})),r.default.select("#"+t).selectAll(".topSlice").data(o).transition().duration(750).attrTween("d",(function(t){var e=r.default.interpolate(this._current,t);return this._current=e(0),function(t){return L(e(t),a,i,u)}})),r.default.select("#"+t).selectAll(".outerSlice").data(o).transition().duration(750).attrTween("d",(function(t){var e=r.default.interpolate(this._current,t);return this._current=e(0),function(t){return M(e(t),a-.5,i-.5,n)}})),r.default.select("#"+t).selectAll(".percent").data(o).transition().duration(750).attrTween("x",(function(t){var e=r.default.interpolate(this._current,t);return this._current=e(0),function(t){return.6*a*Math.cos(.5*(e(t).startAngle+e(t).endAngle))}})).attrTween("y",(function(t){var e=r.default.interpolate(this._current,t);return this._current=e(0),function(t){return.6*a*Math.sin(.5*(e(t).startAngle+e(t).endAngle))}})).text(P.getPercent)},P.draw=function(t,e,a,i,n,u,o,s,l,c,h,d){var p=r.default.pie().sort(null).value((function(t){return t.value}))(e),g=r.default.select("#"+t).append("g").attr("transform","translate("+a+","+i+")").attr("class","slices");g.selectAll(".innerSlice").data(p).enter().append("path").attr("class","innerSlice").style("fill",(function(t){return r.default.hsl(t.data.color).darker(.7)})).attr("d",(function(t){return I(t,n+.5,u+.5,o,s)})).each((function(t){this._current=t})),g.selectAll(".topSlice").data(p).enter().append("path").attr("class","topSlice").style("fill",(function(t){return t.data.color})).style("stroke",(function(t){return t.data.color})).attr("d",(function(t){return L(t,n,u,s)})).each((function(t){this._current=t})),g.selectAll(".outerSlice").data(p).enter().append("path").attr("class","outerSlice").style("fill",(function(t){return r.default.hsl(t.data.color).darker(.7)})).attr("d",(function(t){return M(t,n-.5,u-.5,o)})).each((function(t){this._current=t}));var f=s||.25,m=g.selectAll(".percent"),x=d?0:-10;if(l){var y=function(){V(m,p,f,n,u,x,(function(t){return P.getPercent(t)})),x-=20},D=function(){V(m,p,f,n,u,x,(function(t){return h(t.value)})),x-=20};c.value_percentage?(x+=20,y(),D()):c.percentage_value?(x+=20,D(),y()):(x+=10,c.value?D():y())}d&&V(m,p,f,n,u,x,(function(t){return t.data.label}))};var O=P,W=a(3931),N=20,z=150,G=120,H="",R=10.42,X=20,Y=18,j=6,K=4,U=20,J=10,q="dash",Z="circle",Q=["Task","Task - Done","Task - Todo","Milestone","Event"],tt=/(^(?:[!-#%-\/:-@\[-\]_\{-~\xA1\xA7\xAB\xAC\xB1\xB6\xB7\xBB\xBF\xD7\xF7\u037E\u0387\u03F6\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0606-\u060A\u060C\u060D\u061B\u061D-\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1B7D\u1B7E\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u205E\u207A-\u207E\u208A-\u208E\u2118\u2140-\u2144\u214B\u2190-\u2194\u219A\u219B\u21A0\u21A3\u21A6\u21AE\u21CE\u21CF\u21D2\u21D4\u21F4-\u22FF\u2308-\u230B\u2320\u2321\u2329\u232A\u237C\u239B-\u23B3\u23DC-\u23E1\u25B7\u25C1\u25F8-\u25FF\u266F\u2768-\u2775\u27C0-\u27FF\u2900-\u2AFF\u2B30-\u2B44\u2B47-\u2B4C\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u2E52-\u2E5D\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFB29\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE66\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0F\uFF1A-\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B-\uFF65\uFFE2\uFFE9-\uFFEC]|\uD800[\uDD00-\uDD02\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDEAD\uDF55-\uDF59\uDF86-\uDF89]|\uD804[\uDC47-\uDC4D\uDCBB\uDCBC\uDCBE-\uDCC1\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5A\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDEB9\uDF3C-\uDF3E]|\uD806[\uDC3B\uDD44-\uDD46\uDDE2\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8\uDFFF]|\uD809[\uDC70-\uDC74]|\uD80B[\uDFF1\uDFF2]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3B\uDF44]|\uD81B[\uDE97-\uDE9A\uDFE2]|\uD82F\uDC9F|\uD835[\uDEC1\uDEDB\uDEFB\uDF15\uDF35\uDF4F\uDF6F\uDF89\uDFA9\uDFC3]|\uD836[\uDE87-\uDE8B]|\uD83A[\uDD5E\uDD5F]|\uD83B[\uDEF0\uDEF1])|(?:(?![!-#%-\/:-@\[-\]_\{-~\xA1\xA7\xAB\xAC\xB1\xB6\xB7\xBB\xBF\xD7\xF7\u037E\u0387\u03F6\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0606-\u060A\u060C\u060D\u061B\u061D-\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1B7D\u1B7E\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u205E\u207A-\u207E\u208A-\u208E\u2118\u2140-\u2144\u214B\u2190-\u2194\u219A\u219B\u21A0\u21A3\u21A6\u21AE\u21CE\u21CF\u21D2\u21D4\u21F4-\u22FF\u2308-\u230B\u2320\u2321\u2329\u232A\u237C\u239B-\u23B3\u23DC-\u23E1\u25B7\u25C1\u25F8-\u25FF\u266F\u2768-\u2775\u27C0-\u27FF\u2900-\u2AFF\u2B30-\u2B44\u2B47-\u2B4C\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u2E52-\u2E5D\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFB29\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE66\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0F\uFF1A-\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B-\uFF65\uFFE2\uFFE9-\uFFEC]|\uD800[\uDD00-\uDD02\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDEAD\uDF55-\uDF59\uDF86-\uDF89]|\uD804[\uDC47-\uDC4D\uDCBB\uDCBC\uDCBE-\uDCC1\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5A\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDEB9\uDF3C-\uDF3E]|\uD806[\uDC3B\uDD44-\uDD46\uDDE2\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8\uDFFF]|\uD809[\uDC70-\uDC74]|\uD80B[\uDFF1\uDFF2]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3B\uDF44]|\uD81B[\uDE97-\uDE9A\uDFE2]|\uD82F\uDC9F|\uD835[\uDEC1\uDEDB\uDEFB\uDF15\uDF35\uDF4F\uDF6F\uDF89\uDFA9\uDFC3]|\uD836[\uDE87-\uDE8B]|\uD83A[\uDD5E\uDD5F]|\uD83B[\uDEF0\uDEF1])[\s\S]))?(?:(?![!-#%-\/:-\]_\{-~\xA1\xA7\xAB\xAC\xB1\xB6\xB7\xBB\xBF-\xDE\xF7\u0100\u0102\u0104\u0106\u0108\u010A\u010C\u010E\u0110\u0112\u0114\u0116\u0118\u011A\u011C\u011E\u0120\u0122\u0124\u0126\u0128\u012A\u012C\u012E\u0130\u0132\u0134\u0136\u0139\u013B\u013D\u013F\u0141\u0143\u0145\u0147\u014A\u014C\u014E\u0150\u0152\u0154\u0156\u0158\u015A\u015C\u015E\u0160\u0162\u0164\u0166\u0168\u016A\u016C\u016E\u0170\u0172\u0174\u0176\u0178\u0179\u017B\u017D\u0181\u0182\u0184\u0186\u0187\u0189-\u018B\u018E-\u0191\u0193\u0194\u0196-\u0198\u019C\u019D\u019F\u01A0\u01A2\u01A4\u01A6\u01A7\u01A9\u01AC\u01AE\u01AF\u01B1-\u01B3\u01B5\u01B7\u01B8\u01BC\u01C4\u01C7\u01CA\u01CD\u01CF\u01D1\u01D3\u01D5\u01D7\u01D9\u01DB\u01DE\u01E0\u01E2\u01E4\u01E6\u01E8\u01EA\u01EC\u01EE\u01F1\u01F4\u01F6-\u01F8\u01FA\u01FC\u01FE\u0200\u0202\u0204\u0206\u0208\u020A\u020C\u020E\u0210\u0212\u0214\u0216\u0218\u021A\u021C\u021E\u0220\u0222\u0224\u0226\u0228\u022A\u022C\u022E\u0230\u0232\u023A\u023B\u023D\u023E\u0241\u0243-\u0246\u0248\u024A\u024C\u024E\u0370\u0372\u0376\u037E\u037F\u0386-\u038A\u038C\u038E\u038F\u0391-\u03A1\u03A3-\u03AB\u03CF\u03D2-\u03D4\u03D8\u03DA\u03DC\u03DE\u03E0\u03E2\u03E4\u03E6\u03E8\u03EA\u03EC\u03EE\u03F4\u03F6\u03F7\u03F9\u03FA\u03FD-\u042F\u0460\u0462\u0464\u0466\u0468\u046A\u046C\u046E\u0470\u0472\u0474\u0476\u0478\u047A\u047C\u047E\u0480\u048A\u048C\u048E\u0490\u0492\u0494\u0496\u0498\u049A\u049C\u049E\u04A0\u04A2\u04A4\u04A6\u04A8\u04AA\u04AC\u04AE\u04B0\u04B2\u04B4\u04B6\u04B8\u04BA\u04BC\u04BE\u04C0\u04C1\u04C3\u04C5\u04C7\u04C9\u04CB\u04CD\u04D0\u04D2\u04D4\u04D6\u04D8\u04DA\u04DC\u04DE\u04E0\u04E2\u04E4\u04E6\u04E8\u04EA\u04EC\u04EE\u04F0\u04F2\u04F4\u04F6\u04F8\u04FA\u04FC\u04FE\u0500\u0502\u0504\u0506\u0508\u050A\u050C\u050E\u0510\u0512\u0514\u0516\u0518\u051A\u051C\u051E\u0520\u0522\u0524\u0526\u0528\u052A\u052C\u052E\u0531-\u0556\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0606-\u060A\u060C\u060D\u061B\u061D-\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10A0-\u10C5\u10C7\u10CD\u10FB\u1360-\u1368\u13A0-\u13F5\u1400\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1B7D\u1B7E\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1C90-\u1CBA\u1CBD-\u1CC7\u1CD3\u1E00\u1E02\u1E04\u1E06\u1E08\u1E0A\u1E0C\u1E0E\u1E10\u1E12\u1E14\u1E16\u1E18\u1E1A\u1E1C\u1E1E\u1E20\u1E22\u1E24\u1E26\u1E28\u1E2A\u1E2C\u1E2E\u1E30\u1E32\u1E34\u1E36\u1E38\u1E3A\u1E3C\u1E3E\u1E40\u1E42\u1E44\u1E46\u1E48\u1E4A\u1E4C\u1E4E\u1E50\u1E52\u1E54\u1E56\u1E58\u1E5A\u1E5C\u1E5E\u1E60\u1E62\u1E64\u1E66\u1E68\u1E6A\u1E6C\u1E6E\u1E70\u1E72\u1E74\u1E76\u1E78\u1E7A\u1E7C\u1E7E\u1E80\u1E82\u1E84\u1E86\u1E88\u1E8A\u1E8C\u1E8E\u1E90\u1E92\u1E94\u1E9E\u1EA0\u1EA2\u1EA4\u1EA6\u1EA8\u1EAA\u1EAC\u1EAE\u1EB0\u1EB2\u1EB4\u1EB6\u1EB8\u1EBA\u1EBC\u1EBE\u1EC0\u1EC2\u1EC4\u1EC6\u1EC8\u1ECA\u1ECC\u1ECE\u1ED0\u1ED2\u1ED4\u1ED6\u1ED8\u1EDA\u1EDC\u1EDE\u1EE0\u1EE2\u1EE4\u1EE6\u1EE8\u1EEA\u1EEC\u1EEE\u1EF0\u1EF2\u1EF4\u1EF6\u1EF8\u1EFA\u1EFC\u1EFE\u1F08-\u1F0F\u1F18-\u1F1D\u1F28-\u1F2F\u1F38-\u1F3F\u1F48-\u1F4D\u1F59\u1F5B\u1F5D\u1F5F\u1F68-\u1F6F\u1FB8-\u1FBB\u1FC8-\u1FCB\u1FD8-\u1FDB\u1FE8-\u1FEC\u1FF8-\u1FFB\u2010-\u2027\u2030-\u205E\u207A-\u207E\u208A-\u208E\u2102\u2107\u210B-\u210D\u2110-\u2112\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u212D\u2130-\u2133\u213E-\u2145\u214B\u2183\u2190-\u2194\u219A\u219B\u21A0\u21A3\u21A6\u21AE\u21CE\u21CF\u21D2\u21D4\u21F4-\u22FF\u2308-\u230B\u2320\u2321\u2329\u232A\u237C\u239B-\u23B3\u23DC-\u23E1\u25B7\u25C1\u25F8-\u25FF\u266F\u2768-\u2775\u27C0-\u27FF\u2900-\u2AFF\u2B30-\u2B44\u2B47-\u2B4C\u2C00-\u2C2F\u2C60\u2C62-\u2C64\u2C67\u2C69\u2C6B\u2C6D-\u2C70\u2C72\u2C75\u2C7E-\u2C80\u2C82\u2C84\u2C86\u2C88\u2C8A\u2C8C\u2C8E\u2C90\u2C92\u2C94\u2C96\u2C98\u2C9A\u2C9C\u2C9E\u2CA0\u2CA2\u2CA4\u2CA6\u2CA8\u2CAA\u2CAC\u2CAE\u2CB0\u2CB2\u2CB4\u2CB6\u2CB8\u2CBA\u2CBC\u2CBE\u2CC0\u2CC2\u2CC4\u2CC6\u2CC8\u2CCA\u2CCC\u2CCE\u2CD0\u2CD2\u2CD4\u2CD6\u2CD8\u2CDA\u2CDC\u2CDE\u2CE0\u2CE2\u2CEB\u2CED\u2CF2\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u2E52-\u2E5D\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA640\uA642\uA644\uA646\uA648\uA64A\uA64C\uA64E\uA650\uA652\uA654\uA656\uA658\uA65A\uA65C\uA65E\uA660\uA662\uA664\uA666\uA668\uA66A\uA66C\uA673\uA67E\uA680\uA682\uA684\uA686\uA688\uA68A\uA68C\uA68E\uA690\uA692\uA694\uA696\uA698\uA69A\uA6F2-\uA6F7\uA722\uA724\uA726\uA728\uA72A\uA72C\uA72E\uA732\uA734\uA736\uA738\uA73A\uA73C\uA73E\uA740\uA742\uA744\uA746\uA748\uA74A\uA74C\uA74E\uA750\uA752\uA754\uA756\uA758\uA75A\uA75C\uA75E\uA760\uA762\uA764\uA766\uA768\uA76A\uA76C\uA76E\uA779\uA77B\uA77D\uA77E\uA780\uA782\uA784\uA786\uA78B\uA78D\uA790\uA792\uA796\uA798\uA79A\uA79C\uA79E\uA7A0\uA7A2\uA7A4\uA7A6\uA7A8\uA7AA-\uA7AE\uA7B0-\uA7B4\uA7B6\uA7B8\uA7BA\uA7BC\uA7BE\uA7C0\uA7C2\uA7C4-\uA7C7\uA7C9\uA7D0\uA7D6\uA7D8\uA7F5\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFB29\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE66\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0F\uFF1A-\uFF3D\uFF3F\uFF5B-\uFF65\uFFE2\uFFE9-\uFFEC]|\uD800[\uDD00-\uDD02\uDF9F\uDFD0]|\uD801[\uDC00-\uDC27\uDCB0-\uDCD3\uDD6F-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95]|\uD802[\uDC57\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDC80-\uDCB2\uDEAD\uDF55-\uDF59\uDF86-\uDF89]|\uD804[\uDC47-\uDC4D\uDCBB\uDCBC\uDCBE-\uDCC1\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5A\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDEB9\uDF3C-\uDF3E]|\uD806[\uDC3B\uDCA0-\uDCBF\uDD44-\uDD46\uDDE2\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8\uDFFF]|\uD809[\uDC70-\uDC74]|\uD80B[\uDFF1\uDFF2]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3B\uDF44]|\uD81B[\uDE40-\uDE5F\uDE97-\uDE9A\uDFE2]|\uD82F\uDC9F|\uD835[\uDC00-\uDC19\uDC34-\uDC4D\uDC68-\uDC81\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB5\uDCD0-\uDCE9\uDD04\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD38\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD6C-\uDD85\uDDA0-\uDDB9\uDDD4-\uDDED\uDE08-\uDE21\uDE3C-\uDE55\uDE70-\uDE89\uDEA8-\uDEC1\uDEDB\uDEE2-\uDEFB\uDF15\uDF1C-\uDF35\uDF4F\uDF56-\uDF6F\uDF89\uDF90-\uDFA9\uDFC3\uDFCA]|\uD836[\uDE87-\uDE8B]|\uD83A[\uDD00-\uDD21\uDD5E\uDD5F]|\uD83B[\uDEF0\uDEF1])[\s\S])+((?:[!-#%-\/:-@\[-\]_\{-~\xA1\xA7\xAB\xAC\xB1\xB6\xB7\xBB\xBF\xD7\xF7\u037E\u0387\u03F6\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0606-\u060A\u060C\u060D\u061B\u061D-\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1B7D\u1B7E\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u205E\u207A-\u207E\u208A-\u208E\u2118\u2140-\u2144\u214B\u2190-\u2194\u219A\u219B\u21A0\u21A3\u21A6\u21AE\u21CE\u21CF\u21D2\u21D4\u21F4-\u22FF\u2308-\u230B\u2320\u2321\u2329\u232A\u237C\u239B-\u23B3\u23DC-\u23E1\u25B7\u25C1\u25F8-\u25FF\u266F\u2768-\u2775\u27C0-\u27FF\u2900-\u2AFF\u2B30-\u2B44\u2B47-\u2B4C\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u2E52-\u2E5D\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFB29\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE66\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0F\uFF1A-\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B-\uFF65\uFFE2\uFFE9-\uFFEC]|\uD800[\uDD00-\uDD02\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDEAD\uDF55-\uDF59\uDF86-\uDF89]|\uD804[\uDC47-\uDC4D\uDCBB\uDCBC\uDCBE-\uDCC1\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5A\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDEB9\uDF3C-\uDF3E]|\uD806[\uDC3B\uDD44-\uDD46\uDDE2\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8\uDFFF]|\uD809[\uDC70-\uDC74]|\uD80B[\uDFF1\uDFF2]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3B\uDF44]|\uD81B[\uDE97-\uDE9A\uDFE2]|\uD82F\uDC9F|\uD835[\uDEC1\uDEDB\uDEFB\uDF15\uDF35\uDF4F\uDF6F\uDF89\uDFA9\uDFC3]|\uD836[\uDE87-\uDE8B]|\uD83A[\uDD5E\uDD5F]|\uD83B[\uDEF0\uDEF1])?|(?:[a-z\xB5\xDF-\xF6\xF8-\xFF\u0101\u0103\u0105\u0107\u0109\u010B\u010D\u010F\u0111\u0113\u0115\u0117\u0119\u011B\u011D\u011F\u0121\u0123\u0125\u0127\u0129\u012B\u012D\u012F\u0131\u0133\u0135\u0137\u0138\u013A\u013C\u013E\u0140\u0142\u0144\u0146\u0148\u0149\u014B\u014D\u014F\u0151\u0153\u0155\u0157\u0159\u015B\u015D\u015F\u0161\u0163\u0165\u0167\u0169\u016B\u016D\u016F\u0171\u0173\u0175\u0177\u017A\u017C\u017E-\u0180\u0183\u0185\u0188\u018C\u018D\u0192\u0195\u0199-\u019B\u019E\u01A1\u01A3\u01A5\u01A8\u01AA\u01AB\u01AD\u01B0\u01B4\u01B6\u01B9\u01BA\u01BD-\u01BF\u01C6\u01C9\u01CC\u01CE\u01D0\u01D2\u01D4\u01D6\u01D8\u01DA\u01DC\u01DD\u01DF\u01E1\u01E3\u01E5\u01E7\u01E9\u01EB\u01ED\u01EF\u01F0\u01F3\u01F5\u01F9\u01FB\u01FD\u01FF\u0201\u0203\u0205\u0207\u0209\u020B\u020D\u020F\u0211\u0213\u0215\u0217\u0219\u021B\u021D\u021F\u0221\u0223\u0225\u0227\u0229\u022B\u022D\u022F\u0231\u0233-\u0239\u023C\u023F\u0240\u0242\u0247\u0249\u024B\u024D\u024F-\u0293\u0295-\u02AF\u0371\u0373\u0377\u037B-\u037D\u0390\u03AC-\u03CE\u03D0\u03D1\u03D5-\u03D7\u03D9\u03DB\u03DD\u03DF\u03E1\u03E3\u03E5\u03E7\u03E9\u03EB\u03ED\u03EF-\u03F3\u03F5\u03F8\u03FB\u03FC\u0430-\u045F\u0461\u0463\u0465\u0467\u0469\u046B\u046D\u046F\u0471\u0473\u0475\u0477\u0479\u047B\u047D\u047F\u0481\u048B\u048D\u048F\u0491\u0493\u0495\u0497\u0499\u049B\u049D\u049F\u04A1\u04A3\u04A5\u04A7\u04A9\u04AB\u04AD\u04AF\u04B1\u04B3\u04B5\u04B7\u04B9\u04BB\u04BD\u04BF\u04C2\u04C4\u04C6\u04C8\u04CA\u04CC\u04CE\u04CF\u04D1\u04D3\u04D5\u04D7\u04D9\u04DB\u04DD\u04DF\u04E1\u04E3\u04E5\u04E7\u04E9\u04EB\u04ED\u04EF\u04F1\u04F3\u04F5\u04F7\u04F9\u04FB\u04FD\u04FF\u0501\u0503\u0505\u0507\u0509\u050B\u050D\u050F\u0511\u0513\u0515\u0517\u0519\u051B\u051D\u051F\u0521\u0523\u0525\u0527\u0529\u052B\u052D\u052F\u0560-\u0588\u10D0-\u10FA\u10FD-\u10FF\u13F8-\u13FD\u1C80-\u1C88\u1D00-\u1D2B\u1D6B-\u1D77\u1D79-\u1D9A\u1E01\u1E03\u1E05\u1E07\u1E09\u1E0B\u1E0D\u1E0F\u1E11\u1E13\u1E15\u1E17\u1E19\u1E1B\u1E1D\u1E1F\u1E21\u1E23\u1E25\u1E27\u1E29\u1E2B\u1E2D\u1E2F\u1E31\u1E33\u1E35\u1E37\u1E39\u1E3B\u1E3D\u1E3F\u1E41\u1E43\u1E45\u1E47\u1E49\u1E4B\u1E4D\u1E4F\u1E51\u1E53\u1E55\u1E57\u1E59\u1E5B\u1E5D\u1E5F\u1E61\u1E63\u1E65\u1E67\u1E69\u1E6B\u1E6D\u1E6F\u1E71\u1E73\u1E75\u1E77\u1E79\u1E7B\u1E7D\u1E7F\u1E81\u1E83\u1E85\u1E87\u1E89\u1E8B\u1E8D\u1E8F\u1E91\u1E93\u1E95-\u1E9D\u1E9F\u1EA1\u1EA3\u1EA5\u1EA7\u1EA9\u1EAB\u1EAD\u1EAF\u1EB1\u1EB3\u1EB5\u1EB7\u1EB9\u1EBB\u1EBD\u1EBF\u1EC1\u1EC3\u1EC5\u1EC7\u1EC9\u1ECB\u1ECD\u1ECF\u1ED1\u1ED3\u1ED5\u1ED7\u1ED9\u1EDB\u1EDD\u1EDF\u1EE1\u1EE3\u1EE5\u1EE7\u1EE9\u1EEB\u1EED\u1EEF\u1EF1\u1EF3\u1EF5\u1EF7\u1EF9\u1EFB\u1EFD\u1EFF-\u1F07\u1F10-\u1F15\u1F20-\u1F27\u1F30-\u1F37\u1F40-\u1F45\u1F50-\u1F57\u1F60-\u1F67\u1F70-\u1F7D\u1F80-\u1F87\u1F90-\u1F97\u1FA0-\u1FA7\u1FB0-\u1FB4\u1FB6\u1FB7\u1FBE\u1FC2-\u1FC4\u1FC6\u1FC7\u1FD0-\u1FD3\u1FD6\u1FD7\u1FE0-\u1FE7\u1FF2-\u1FF4\u1FF6\u1FF7\u210A\u210E\u210F\u2113\u212F\u2134\u2139\u213C\u213D\u2146-\u2149\u214E\u2184\u2C30-\u2C5F\u2C61\u2C65\u2C66\u2C68\u2C6A\u2C6C\u2C71\u2C73\u2C74\u2C76-\u2C7B\u2C81\u2C83\u2C85\u2C87\u2C89\u2C8B\u2C8D\u2C8F\u2C91\u2C93\u2C95\u2C97\u2C99\u2C9B\u2C9D\u2C9F\u2CA1\u2CA3\u2CA5\u2CA7\u2CA9\u2CAB\u2CAD\u2CAF\u2CB1\u2CB3\u2CB5\u2CB7\u2CB9\u2CBB\u2CBD\u2CBF\u2CC1\u2CC3\u2CC5\u2CC7\u2CC9\u2CCB\u2CCD\u2CCF\u2CD1\u2CD3\u2CD5\u2CD7\u2CD9\u2CDB\u2CDD\u2CDF\u2CE1\u2CE3\u2CE4\u2CEC\u2CEE\u2CF3\u2D00-\u2D25\u2D27\u2D2D\uA641\uA643\uA645\uA647\uA649\uA64B\uA64D\uA64F\uA651\uA653\uA655\uA657\uA659\uA65B\uA65D\uA65F\uA661\uA663\uA665\uA667\uA669\uA66B\uA66D\uA681\uA683\uA685\uA687\uA689\uA68B\uA68D\uA68F\uA691\uA693\uA695\uA697\uA699\uA69B\uA723\uA725\uA727\uA729\uA72B\uA72D\uA72F-\uA731\uA733\uA735\uA737\uA739\uA73B\uA73D\uA73F\uA741\uA743\uA745\uA747\uA749\uA74B\uA74D\uA74F\uA751\uA753\uA755\uA757\uA759\uA75B\uA75D\uA75F\uA761\uA763\uA765\uA767\uA769\uA76B\uA76D\uA76F\uA771-\uA778\uA77A\uA77C\uA77F\uA781\uA783\uA785\uA787\uA78C\uA78E\uA791\uA793-\uA795\uA797\uA799\uA79B\uA79D\uA79F\uA7A1\uA7A3\uA7A5\uA7A7\uA7A9\uA7AF\uA7B5\uA7B7\uA7B9\uA7BB\uA7BD\uA7BF\uA7C1\uA7C3\uA7C8\uA7CA\uA7D1\uA7D3\uA7D5\uA7D7\uA7D9\uA7F6\uA7FA\uAB30-\uAB5A\uAB60-\uAB68\uAB70-\uABBF\uFB00-\uFB06\uFB13-\uFB17\uFF41-\uFF5A]|\uD801[\uDC28-\uDC4F\uDCD8-\uDCFB\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC]|\uD803[\uDCC0-\uDCF2]|\uD806[\uDCC0-\uDCDF]|\uD81B[\uDE60-\uDE7F]|\uD835[\uDC1A-\uDC33\uDC4E-\uDC54\uDC56-\uDC67\uDC82-\uDC9B\uDCB6-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDCCF\uDCEA-\uDD03\uDD1E-\uDD37\uDD52-\uDD6B\uDD86-\uDD9F\uDDBA-\uDDD3\uDDEE-\uDE07\uDE22-\uDE3B\uDE56-\uDE6F\uDE8A-\uDEA5\uDEC2-\uDEDA\uDEDC-\uDEE1\uDEFC-\uDF14\uDF16-\uDF1B\uDF36-\uDF4E\uDF50-\uDF55\uDF70-\uDF88\uDF8A-\uDF8F\uDFAA-\uDFC2\uDFC4-\uDFC9\uDFCB]|\uD837[\uDF00-\uDF09\uDF0B-\uDF1E]|\uD83A[\uDD22-\uDD43]))|(?:[!-#%-\/:-@\[-\]_\{-~\xA1\xA7\xAB\xAC\xB1\xB6\xB7\xBB\xBF\xD7\xF7\u037E\u0387\u03F6\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0606-\u060A\u060C\u060D\u061B\u061D-\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1B7D\u1B7E\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u205E\u207A-\u207E\u208A-\u208E\u2118\u2140-\u2144\u214B\u2190-\u2194\u219A\u219B\u21A0\u21A3\u21A6\u21AE\u21CE\u21CF\u21D2\u21D4\u21F4-\u22FF\u2308-\u230B\u2320\u2321\u2329\u232A\u237C\u239B-\u23B3\u23DC-\u23E1\u25B7\u25C1\u25F8-\u25FF\u266F\u2768-\u2775\u27C0-\u27FF\u2900-\u2AFF\u2B30-\u2B44\u2B47-\u2B4C\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u2E52-\u2E5D\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFB29\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE66\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0F\uFF1A-\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B-\uFF65\uFFE2\uFFE9-\uFFEC]|\uD800[\uDD00-\uDD02\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDEAD\uDF55-\uDF59\uDF86-\uDF89]|\uD804[\uDC47-\uDC4D\uDCBB\uDCBC\uDCBE-\uDCC1\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5A\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDEB9\uDF3C-\uDF3E]|\uD806[\uDC3B\uDD44-\uDD46\uDDE2\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8\uDFFF]|\uD809[\uDC70-\uDC74]|\uD80B[\uDFF1\uDFF2]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3B\uDF44]|\uD81B[\uDE97-\uDE9A\uDFE2]|\uD82F\uDC9F|\uD835[\uDEC1\uDEDB\uDEFB\uDF15\uDF35\uDF4F\uDF6F\uDF89\uDFA9\uDFC3]|\uD836[\uDE87-\uDE8B]|\uD83A[\uDD5E\uDD5F]|\uD83B[\uDEF0\uDEF1])|(?:[A-Z\xC0-\xD6\xD8-\xDE\u0100\u0102\u0104\u0106\u0108\u010A\u010C\u010E\u0110\u0112\u0114\u0116\u0118\u011A\u011C\u011E\u0120\u0122\u0124\u0126\u0128\u012A\u012C\u012E\u0130\u0132\u0134\u0136\u0139\u013B\u013D\u013F\u0141\u0143\u0145\u0147\u014A\u014C\u014E\u0150\u0152\u0154\u0156\u0158\u015A\u015C\u015E\u0160\u0162\u0164\u0166\u0168\u016A\u016C\u016E\u0170\u0172\u0174\u0176\u0178\u0179\u017B\u017D\u0181\u0182\u0184\u0186\u0187\u0189-\u018B\u018E-\u0191\u0193\u0194\u0196-\u0198\u019C\u019D\u019F\u01A0\u01A2\u01A4\u01A6\u01A7\u01A9\u01AC\u01AE\u01AF\u01B1-\u01B3\u01B5\u01B7\u01B8\u01BC\u01C4\u01C7\u01CA\u01CD\u01CF\u01D1\u01D3\u01D5\u01D7\u01D9\u01DB\u01DE\u01E0\u01E2\u01E4\u01E6\u01E8\u01EA\u01EC\u01EE\u01F1\u01F4\u01F6-\u01F8\u01FA\u01FC\u01FE\u0200\u0202\u0204\u0206\u0208\u020A\u020C\u020E\u0210\u0212\u0214\u0216\u0218\u021A\u021C\u021E\u0220\u0222\u0224\u0226\u0228\u022A\u022C\u022E\u0230\u0232\u023A\u023B\u023D\u023E\u0241\u0243-\u0246\u0248\u024A\u024C\u024E\u0370\u0372\u0376\u037F\u0386\u0388-\u038A\u038C\u038E\u038F\u0391-\u03A1\u03A3-\u03AB\u03CF\u03D2-\u03D4\u03D8\u03DA\u03DC\u03DE\u03E0\u03E2\u03E4\u03E6\u03E8\u03EA\u03EC\u03EE\u03F4\u03F7\u03F9\u03FA\u03FD-\u042F\u0460\u0462\u0464\u0466\u0468\u046A\u046C\u046E\u0470\u0472\u0474\u0476\u0478\u047A\u047C\u047E\u0480\u048A\u048C\u048E\u0490\u0492\u0494\u0496\u0498\u049A\u049C\u049E\u04A0\u04A2\u04A4\u04A6\u04A8\u04AA\u04AC\u04AE\u04B0\u04B2\u04B4\u04B6\u04B8\u04BA\u04BC\u04BE\u04C0\u04C1\u04C3\u04C5\u04C7\u04C9\u04CB\u04CD\u04D0\u04D2\u04D4\u04D6\u04D8\u04DA\u04DC\u04DE\u04E0\u04E2\u04E4\u04E6\u04E8\u04EA\u04EC\u04EE\u04F0\u04F2\u04F4\u04F6\u04F8\u04FA\u04FC\u04FE\u0500\u0502\u0504\u0506\u0508\u050A\u050C\u050E\u0510\u0512\u0514\u0516\u0518\u051A\u051C\u051E\u0520\u0522\u0524\u0526\u0528\u052A\u052C\u052E\u0531-\u0556\u10A0-\u10C5\u10C7\u10CD\u13A0-\u13F5\u1C90-\u1CBA\u1CBD-\u1CBF\u1E00\u1E02\u1E04\u1E06\u1E08\u1E0A\u1E0C\u1E0E\u1E10\u1E12\u1E14\u1E16\u1E18\u1E1A\u1E1C\u1E1E\u1E20\u1E22\u1E24\u1E26\u1E28\u1E2A\u1E2C\u1E2E\u1E30\u1E32\u1E34\u1E36\u1E38\u1E3A\u1E3C\u1E3E\u1E40\u1E42\u1E44\u1E46\u1E48\u1E4A\u1E4C\u1E4E\u1E50\u1E52\u1E54\u1E56\u1E58\u1E5A\u1E5C\u1E5E\u1E60\u1E62\u1E64\u1E66\u1E68\u1E6A\u1E6C\u1E6E\u1E70\u1E72\u1E74\u1E76\u1E78\u1E7A\u1E7C\u1E7E\u1E80\u1E82\u1E84\u1E86\u1E88\u1E8A\u1E8C\u1E8E\u1E90\u1E92\u1E94\u1E9E\u1EA0\u1EA2\u1EA4\u1EA6\u1EA8\u1EAA\u1EAC\u1EAE\u1EB0\u1EB2\u1EB4\u1EB6\u1EB8\u1EBA\u1EBC\u1EBE\u1EC0\u1EC2\u1EC4\u1EC6\u1EC8\u1ECA\u1ECC\u1ECE\u1ED0\u1ED2\u1ED4\u1ED6\u1ED8\u1EDA\u1EDC\u1EDE\u1EE0\u1EE2\u1EE4\u1EE6\u1EE8\u1EEA\u1EEC\u1EEE\u1EF0\u1EF2\u1EF4\u1EF6\u1EF8\u1EFA\u1EFC\u1EFE\u1F08-\u1F0F\u1F18-\u1F1D\u1F28-\u1F2F\u1F38-\u1F3F\u1F48-\u1F4D\u1F59\u1F5B\u1F5D\u1F5F\u1F68-\u1F6F\u1FB8-\u1FBB\u1FC8-\u1FCB\u1FD8-\u1FDB\u1FE8-\u1FEC\u1FF8-\u1FFB\u2102\u2107\u210B-\u210D\u2110-\u2112\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u2130-\u2133\u213E\u213F\u2145\u2183\u2C00-\u2C2F\u2C60\u2C62-\u2C64\u2C67\u2C69\u2C6B\u2C6D-\u2C70\u2C72\u2C75\u2C7E-\u2C80\u2C82\u2C84\u2C86\u2C88\u2C8A\u2C8C\u2C8E\u2C90\u2C92\u2C94\u2C96\u2C98\u2C9A\u2C9C\u2C9E\u2CA0\u2CA2\u2CA4\u2CA6\u2CA8\u2CAA\u2CAC\u2CAE\u2CB0\u2CB2\u2CB4\u2CB6\u2CB8\u2CBA\u2CBC\u2CBE\u2CC0\u2CC2\u2CC4\u2CC6\u2CC8\u2CCA\u2CCC\u2CCE\u2CD0\u2CD2\u2CD4\u2CD6\u2CD8\u2CDA\u2CDC\u2CDE\u2CE0\u2CE2\u2CEB\u2CED\u2CF2\uA640\uA642\uA644\uA646\uA648\uA64A\uA64C\uA64E\uA650\uA652\uA654\uA656\uA658\uA65A\uA65C\uA65E\uA660\uA662\uA664\uA666\uA668\uA66A\uA66C\uA680\uA682\uA684\uA686\uA688\uA68A\uA68C\uA68E\uA690\uA692\uA694\uA696\uA698\uA69A\uA722\uA724\uA726\uA728\uA72A\uA72C\uA72E\uA732\uA734\uA736\uA738\uA73A\uA73C\uA73E\uA740\uA742\uA744\uA746\uA748\uA74A\uA74C\uA74E\uA750\uA752\uA754\uA756\uA758\uA75A\uA75C\uA75E\uA760\uA762\uA764\uA766\uA768\uA76A\uA76C\uA76E\uA779\uA77B\uA77D\uA77E\uA780\uA782\uA784\uA786\uA78B\uA78D\uA790\uA792\uA796\uA798\uA79A\uA79C\uA79E\uA7A0\uA7A2\uA7A4\uA7A6\uA7A8\uA7AA-\uA7AE\uA7B0-\uA7B4\uA7B6\uA7B8\uA7BA\uA7BC\uA7BE\uA7C0\uA7C2\uA7C4-\uA7C7\uA7C9\uA7D0\uA7D6\uA7D8\uA7F5\uFF21-\uFF3A]|\uD801[\uDC00-\uDC27\uDCB0-\uDCD3\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95]|\uD803[\uDC80-\uDCB2]|\uD806[\uDCA0-\uDCBF]|\uD81B[\uDE40-\uDE5F]|\uD835[\uDC00-\uDC19\uDC34-\uDC4D\uDC68-\uDC81\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB5\uDCD0-\uDCE9\uDD04\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD38\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD6C-\uDD85\uDDA0-\uDDB9\uDDD4-\uDDED\uDE08-\uDE21\uDE3C-\uDE55\uDE70-\uDE89\uDEA8-\uDEC0\uDEE2-\uDEFA\uDF1C-\uDF34\uDF56-\uDF6E\uDF90-\uDFA8\uDFCA]|\uD83A[\uDD00-\uDD21])+(?:[!-#%-\/:-@\[-\]_\{-~\xA1\xA7\xAB\xAC\xB1\xB6\xB7\xBB\xBF\xD7\xF7\u037E\u0387\u03F6\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0606-\u060A\u060C\u060D\u061B\u061D-\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1B7D\u1B7E\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u205E\u207A-\u207E\u208A-\u208E\u2118\u2140-\u2144\u214B\u2190-\u2194\u219A\u219B\u21A0\u21A3\u21A6\u21AE\u21CE\u21CF\u21D2\u21D4\u21F4-\u22FF\u2308-\u230B\u2320\u2321\u2329\u232A\u237C\u239B-\u23B3\u23DC-\u23E1\u25B7\u25C1\u25F8-\u25FF\u266F\u2768-\u2775\u27C0-\u27FF\u2900-\u2AFF\u2B30-\u2B44\u2B47-\u2B4C\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u2E52-\u2E5D\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFB29\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE66\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0F\uFF1A-\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B-\uFF65\uFFE2\uFFE9-\uFFEC]|\uD800[\uDD00-\uDD02\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDEAD\uDF55-\uDF59\uDF86-\uDF89]|\uD804[\uDC47-\uDC4D\uDCBB\uDCBC\uDCBE-\uDCC1\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5A\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDEB9\uDF3C-\uDF3E]|\uD806[\uDC3B\uDD44-\uDD46\uDDE2\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8\uDFFF]|\uD809[\uDC70-\uDC74]|\uD80B[\uDFF1\uDFF2]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3B\uDF44]|\uD81B[\uDE97-\uDE9A\uDFE2]|\uD82F\uDC9F|\uD835[\uDEC1\uDEDB\uDEFB\uDF15\uDF35\uDF4F\uDF6F\uDF89\uDFA9\uDFC3]|\uD836[\uDE87-\uDE8B]|\uD83A[\uDD5E\uDD5F]|\uD83B[\uDEF0\uDEF1])?/g,et=a(1706),at=function(t,e){var a=0;return t.ticks().forEach((function(i){var n=(e.tickFormat()||t.tickFormat())(i);a=Math.max((0,et.getTextWidth)(n),a)})),a},it=function(t){var e=nt(t);return(299*e.r+587*e.g+114*e.b)/1e3>=128?"black":"white"},nt=function(t){return r.default.hsl(t).rgb()},rt=function(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:z,i=arguments.length>3?arguments[3]:void 0,n=Y+K;i?a-=U+J:a=n+z;var r={values:ot(t,e),width:0,height:0,maxLegendItemWidth:a,keysWidth:0,firstInRow:[]};r.values.forEach((function(t){t.textWidth=(0,et.getTextWidth)(t.view),t.textWidth+n>a&&(i?(t.view=ft(t.view,a-n-R),t.textWidth=(0,et.getTextWidth)(t.view)+R):(t.views=mt(t.view,a-Y-K),t.textWidth=(0,et.findLongestText)(t.views).width),t.isShorten=!0),t.width=t.textWidth+n,r.width+=t.width,r.keysWidth=Math.max(r.keysWidth,t.width-n+j)}));var u=0,o=0;return r.values.forEach((function(t,e){i?(0!==e&&u+r.values[e-1].width+j+t.width<a?u+=r.values[e-1].width+j:(u=r.width<=a?a/2-r.width/2:U,r.firstInRow.push(e),o+=e>0?X:0),t.x=u,t.y=o,t.arrayRowNumber=e):(t.y=o,t.height=t.isShorten?14*t.views.length:X,o+=t.height+6)})),r.rowsCount=i?r.firstInRow.length:r.values.length,r.height=i?o:o+X,r},ut=function(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:30,i={values:ot(t,e),width:0,keysWidth:0};return i.values.forEach((function(t){var e=(0,et.getTextWidth)(t.view);e>z&&(t.view=t.view.substr(0,N-1)+"",e=(0,et.getTextWidth)(t.view)),t.width=parseInt(e)+a,i.width+=t.width,i.keysWidth=Math.max(i.keysWidth,t.width-a)})),i},ot=function(t,e){var a=[],i=e?st(t):0;return t.forEach((function(t){var e=i>3?t.substring(i):t;!e&&t&&(e="Total"),a.push({key:t,view:e})})),a},st=function(t){for(var e=t.concat().sort((function(t,e){return t.localeCompare(e)})),a=e[0],i=e[e.length-1],n=a.length,r=0;r<n&&a.charAt(r)===i.charAt(r);)r++;return Math.min(r,a.substring(0,r).lastIndexOf(" ")+1)},lt=function(t,e,a,i){var n=rt(t,a,e,i),r=n.width<=e?e/2-n.width/2:U;return{rows:n.rowsCount,maxWidth:n.keysWidth,firstInRow:n.firstInRow,posX:r}},ct=function(t,e){for(var a=[],i=Math.ceil(t[0]/e)*e;i<=t[1];i=W.default.addFloats(i,e))a.push(i);return a},ht=function(t,e,a){var i=t;return i=Math.max(e,i),i=Math.min(a,i)},dt=function(t){return t.xScaleStep.indexOf("h")>-1?r.default.timeHour:t.xScaleStep.indexOf("w")>-1?r.default.timeWeek:t.xScaleStep.indexOf("m")>-1?r.default.timeMonth:t.xScaleStep.indexOf("y")>-1?r.default.timeYear:r.default.timeDay},pt=function(t,e){var a,i;return e<864e6&&-1===t.workingDateFormat.toLowerCase().indexOf("hh:mm")?(i=r.default.timeDay,a=1):t.workingDateFormat.indexOf("i")>=0?(i=r.default.timeMonth,a=3):t.workingDateFormat.indexOf("w")>=0?(i=r.default.timeWeek,a=Math.floor(e/6048e6)):-1===t.workingDateFormat.toLowerCase().indexOf("m")&&e<31536e7?(i=r.default.timeYear,a=1):-1===t.workingDateFormat.indexOf("d")&&e<2592e7&&(i=r.default.timeMonth,a=1),{ticksStep:a,ticksSize:i}},gt=function(t,e,a){var i=t,n=(0,et.getTextWidth)(e.substr(0,i));if(n>a)for(;n>a&&--i>0;)n=(0,et.getTextWidth)(e.substr(0,i));else{for(;n<a&&++i<e.length;)n=(0,et.getTextWidth)(e.substr(0,i));i=Math.max(0,--i)}return i},ft=function(t,e){var a=Math.floor(t.length*e/(0,et.getTextWidth)(t));return t.slice(0,gt(a,t,e))},mt=function(t,e){for(var a=t.split(/\s+/),i=[],n="",r=0,u=function(){i.push(n),n="",r=0},o=0;o<a.length;o++){var s=n.length>0?" ":"",l=(0,et.getTextWidth)(a[o]),c=n.length>0?3.85:0;if((r+=c)+c+l<=e)n+=s+a[o],r+=l;else if(l>e){var h=e-r,d=0,p=a[o].match(tt),g=!1;if(p&&p.length>0){var f=0,m=0,x=0;do{m+=(0,et.getTextWidth)(p[f]),0===f?g=m>h&&m<=e:x+=p[f-1].length}while(!g&&h>=m&&++f<p.length);d=x}if(!g){if(!d){var y=Math.floor(a[o].length*h/l);d=gt(y,a[o],h)}d&&(n+=s+a[o].substring(0,d),r+=d,a[o]=a[o].substring(d))}n.length>0&&(o--,u())}else u(),n+=a[o],r+=l}return n.length&&u(),i},xt=function t(e,a,i){if(e<=18||i>=a.width)return a.width;i=i||z;var n=14*mt(a.text,i).length+4;return n>e?t(e,a,i=Math.ceil(i*n/e)):i},yt=function(t,e){t.offset().top>42?(e.direction("n"),e.offset([-5,0])):(e.direction("s"),e.offset([5,0]))},Dt={draw:function(t,e,a){var i=this,n={nodeRadius:5,factorLegend:.85,radians:2*Math.PI,opacityArea:.1,padding:{left:20,right:20,top:20,bottom:20},maxValue:0,grid:!0};if(void 0!==a)for(var o in a)void 0!==a[o]&&(n[o]=a[o]);var s={},l={},c=[];e.forEach((function(t){l[t.aggregation]=Math.max(Math.max(t.value,l[t.aggregation]?l[t.aggregation]:0),n.maxValue),s[t.label]||(s[t.label]=[]),s[t.label].push({axis:t.aggregation,value:t.value}),-1===c.indexOf(t.aggregation)&&c.push(t.aggregation)}));var h=c.length;n.chartDimension={w:n.w-n.padding.left-n.padding.right,h:n.h-n.padding.top-n.padding.bottom},n.radius=Math.min(n.chartDimension.w/2,n.chartDimension.h/2),n.center={x:n.chartDimension.w/2+n.padding.left,y:n.radius+n.padding.top},n.angle=n.radians/h;var d=t.append("svg").attr("width",n.w).attr("height",n.center.y+n.radius+n.padding.bottom).append("g");if(n.maxValue>0&&n.grid){var p=[];if(n.scaleStep)for(var g=0;g<=n.maxValue;g=W.default.addFloats(g,n.scaleStep))p.push(g);else{var f=r.default.scaleLinear();f.domain([0,n.maxValue]),p=f.ticks(3)}p.forEach((function(t){if(t>0){var e=n.radius*t/n.maxValue;d.selectAll(".levels").data(c).enter().append("svg:line").attr("x1",(function(t,a){return n.center.x-e*Math.sin(a*n.angle)})).attr("y1",(function(t,a){return n.center.y-e*Math.cos(a*n.angle)})).attr("x2",(function(t,a){return n.center.x-e*Math.sin((a+1)*n.angle)})).attr("y2",(function(t,a){return n.center.y-e*Math.cos((a+1)*n.angle)})).attr("class","line").style("stroke","#d3d3d3").style("stroke-width","1px"),d.append("text").attr("class","axis-text").text(n.formatter(t,c[0])).style("font-size","14px").attr("y",n.center.y-e+19).attr("x",n.center.x+5)}}))}var m=d.selectAll(".axis").data(c).enter().append("g").attr("class","axis");m.append("line").attr("x1",n.center.x).attr("y1",n.center.y).attr("x2",(function(t,e){return n.center.x-n.radius*Math.sin(e*n.angle)})).attr("y2",(function(t,e){return n.center.y-n.radius*Math.cos(e*n.angle)})).attr("class","line").style("stroke","grey").style("stroke-width","1px"),m.append("text").attr("class","axis-text").text((function(t){return t})).style("font-size","14px").attr("text-anchor","middle").attr("transform",(function(t,e){var a=i.calcTextAngle(n,e);return"rotate("+a/Math.PI*180+" "+i.calcAxisTextX(n,e,a)+","+i.calcAxisTextY(n,e,a)+")"})).attr("x",(function(t,e){return i.calcAxisTextX(n,e,i.calcTextAngle(n,e))})).attr("y",(function(t,e){return i.calcAxisTextY(n,e,i.calcTextAngle(n,e))})),Object.keys(s).forEach((function(t,e){var a=s[t],u=[];d.selectAll(".nodes").data(a,(function(t,e){u.push([i.calcCY(n,t,l,e),i.calcCX(n,t,l,e)])})),u.push(u[0]),d.selectAll(".area").data([u]).enter().append("polygon").attr("class","radar-chart-serie"+e).attr("key",t).style("stroke-width","2px").style("stroke",n.color(t)).attr("points",(function(t){for(var e="",a=0;a<t.length;a++)e=e+t[a][0]+","+t[a][1]+" ";return e})).style("fill",(function(){return n.color(t)})).style("fill-opacity",n.opacityArea).on("mouseover",(function(){var t="polygon."+r.default.select(this).attr("class");d.selectAll("polygon").transition(200).style("fill-opacity",0),d.selectAll(t).transition(200).style("fill-opacity",.5)})).on("mouseout",(function(){d.selectAll("polygon").transition(200).style("fill-opacity",n.opacityArea)}))}));var x=(0,u.default)().attr("class","d3-tip chart"+n.id).offset([-8,0]).html((function(t){return W.default.escapeString(t.key+" ("+n.formatter(t.data.value,t.data.axis)+")")}));return d.call(x),Object.keys(s).forEach((function(t,e){var a=s[t];d.selectAll(".nodes").data(a).enter().append("svg:circle").attr("class","radar-chart-serie"+e).attr("key",t).attr("r",n.nodeRadius).attr("cx",(function(t,e){return i.calcCY(n,t,l,e)})).attr("cy",(function(t,e){return i.calcCX(n,t,l,e)})).attr("data-id",(function(t){return t.axis})).style("fill",n.color(t)).style("fill-opacity",.9).on("mouseover",(function(e,a){yt($(this),x),x.show({key:t,data:a},this);var i="polygon."+r.default.select(this).attr("class");d.selectAll("polygon").transition(200).style("fill-opacity",.1),d.selectAll(i).transition(200).style("fill-opacity",.7)})).on("mouseout",(function(){x.hide(),d.selectAll("polygon").transition(200).style("fill-opacity",n.opacityArea)}))})),{svg:d,cfg:n}},calcCY:function(t,e,a,i){return t.center.x-t.radius*Math.sin(i*t.angle)*Math.max(e.value,0)/a[e.axis]},calcCX:function(t,e,a,i){return t.center.y-t.radius*Math.cos(i*t.angle)*Math.max(e.value,0)/a[e.axis]},calcAxisTextX:function(t,e,a){var i=e*t.angle;return t.center.x-t.radius*Math.sin(i)-(t.nodeRadius+4+9.5*Math.min(1,i+a))*Math.sin(i)},calcAxisTextY:function(t,e,a){var i=e*t.angle;return t.center.y-t.radius*Math.cos(i)-(t.nodeRadius+4+9.5*Math.min(1,i+a))*Math.cos(i)},calcTextAngle:function(t,e){var a=-e*t.angle;return a<-Math.PI/2&&a>1.5*-Math.PI&&(a+=Math.PI),a}},vt=a(8644),bt=a(8933),Ft=a(4238),Ct=a(9497),At=a(3778);function Et(t){return"Line"===t||"Time Line"===t}var _t=function(t,e,a,i){var n;e.selectAll(a).on("mouseover",(function(e,i){clearTimeout(n);var r=$(this);r.is(a)||(r=r.parent()),yt(r,t),t.show(i,r[0])})).on("mouseout",(function(){n=setTimeout((function(){n=null,i.tipHover||t.hide()}),50)}))},wt=function(t){for(var e=t?r.default.min:r.default.max,a=arguments.length,i=new Array(a>1?a-1:0),n=1;n<a;n++)i[n-1]=arguments[n];return e(i.map((function(a,i){return e(a,(function(e){return 0===i?t?e.startDate:e.endDate:e.date}))})))},Bt=function(t){var e=t.attr("transform").match(/translate\((.+)[(, ?) ](.+)\)/);e=e&&e.length>2?e:[0,0,0];var a=t.select("rect"),i=Number.parseFloat(a.attr("height")),n=Number.parseFloat(a.attr("width"));return[Number.parseFloat(e[1]),Number.parseFloat(e[2]),n,i]},kt=function(t,e){var a,i=t.sourceEvent.target||t.sourceEvent.srcElement,n=null;return(a=i.getAttribute("class"))&&-1!==a.indexOf("g_task")?n=i:(a=i.parentNode.getAttribute("class"))&&-1!==a.indexOf("g_task")&&(n=i.parentNode),n&&n!==e?r.default.select(n):null};function St(t,e){for(var a=0;a<e.length;a++){var i=e[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Tt(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var Pt=10,Lt={arrow:{triangleArrowPoints:[[-10,-5],[0,0],[-10,5]],margin:5,offset:3},removeBtn:{radius:5,chord:2.2}},Mt=function(){function t(e,a,i,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.setTasks(i,n),this.barsContainer=e,this.ganttArrows=a,this.arrow=null,this.initGanttArrows(),i&&this.createArrow(i)}var e,a,i;return e=t,(a=[{key:"setTasks",value:function(e,a){this.task1=e||this.task1,this.task2=a||this.task2,e&&a&&t.arrows.add(this)}},{key:"initGanttArrows",value:function(){var t=this.barsContainer.select(".gantt-arrows");this.arrowsContainer=t.empty()?this.barsContainer.append("g").attr("class","gantt-arrows"):t}},{key:"createArrow",value:function(t){var e=this,a=t.data()[0].style.match(/#[0-9a-f]{3,6}$/i),i=a&&-1===["#fff","#ffffff"].indexOf(a[0].toLowerCase())&&a[0]||"black";this.arrow=this.arrowsContainer.append("g").attr("class","arrow").attr("stroke",i).attr("fill",i).attr("transform",t.attr("transform")),this.arrowTriangle=this.arrow.append("path").attr("d",r.default.line()(Lt.arrow.triangleArrowPoints)).style("stroke","none"),this.arrowLine=this.arrow.append("path").attr("class","arrowLine").style("fill","none").on("resize",(function(){return e.draw()}))}},{key:"draw",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.task1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.task2;this.arrow.attr("transform",t.attr("transform")),this.coord1=Bt(this.task1);var a=Bt(e);a[0]-=this.coord1[0],a[1]-=this.coord1[1]-a[3]/2,this.drawByPoins([this.coord1[2],this.coord1[3]/2],a)}},{key:"drawByPoins",value:function(t,e){var a=Lt.arrow.margin,i=t[0],n=e[0],u=t[1],o=e[1];this.lineCoords=[[i,u],[i+a,u],[i+a,(o+u)/2],[n-a-Pt,(o+u)/2],[n-a-Pt,o],[n-Pt,o]],this.setAbsoluteLineCoords(),this.correctCrossLinesMargin(),this.arrowLine.attr("d",r.default.line()(this.lineCoords)),this.arrowTriangle.attr("transform","translate(".concat(n,", ").concat(o,")")),this.addRemoveBtn((this.lineCoords[2][0]+this.lineCoords[3][0])/2,this.lineCoords[2][1])}},{key:"correctCrossLinesMargin",value:function(){var e=this,a=Lt.arrow.offset;Array.from(t.arrows).some((function(t){if(t!==e){var i=!1;if(e.hitTestYLines([e.absoluteLineCoords[1],e.absoluteLineCoords[2]],[t.absoluteLineCoords[1],t.absoluteLineCoords[2]])?(e.lineCoords[1][0]+=a,e.lineCoords[2][0]+=a,i=!0):e.hitTestYLines([e.absoluteLineCoords[3],e.absoluteLineCoords[4]],[t.absoluteLineCoords[3],t.absoluteLineCoords[4]])?(e.lineCoords[3][0]-=a,e.lineCoords[4][0]-=a,i=!0):e.hitTestXLines([e.absoluteLineCoords[2],e.absoluteLineCoords[3]],[t.absoluteLineCoords[2],t.absoluteLineCoords[3]])&&(e.lineCoords[2][1]-=a,e.lineCoords[3][1]-=a,i=!0),i)return e.setAbsoluteLineCoords(),!0}}))&&this.correctCrossLinesMargin()}},{key:"setAbsoluteLineCoords",value:function(){var t=this;this.coord1=void 0===this.coord1?Bt(this.task1):this.coord1,this.absoluteLineCoords=this.lineCoords.map((function(e){return[e[0]+t.coord1[0],e[1]+t.coord1[1]]}))}},{key:"hitTestYLines",value:function(t,e){if(t[0][0]===e[0][0]){var a=function(t,e){return t-e},i=[t[0][1],t[1][1]].sort(a),n=[e[0][1],e[1][1]].sort(a);return i[0]<=n[1]&&i[0]>=n[0]||n[0]<=i[1]&&n[0]>=i[0]}return!1}},{key:"hitTestXLines",value:function(t,e){if(t[0][1]===e[0][1]){var a=function(t,e){return t-e},i=[t[0][0],t[1][0]].sort(a),n=[e[0][0],e[1][0]].sort(a);return i[0]<=n[1]&&i[0]>=n[0]||n[0]<=i[1]&&n[0]>=i[0]}return!1}},{key:"addRemoveBtn",value:function(t,e){var a=this;this.removeBtn||(this.removeBtn=this.arrow.append("g").attr("class","removeBtn").on("click",(function(t){t.stopPropagation(),a.remove();var e=a.task1&&a.task1.data()[0].id,i=a.task2&&a.task2.data()[0].id,n=a.ganttArrows[e+""];if(n){var r=n.indexOf(i+"");-1!==r&&n.splice(r,1)}})),this.removeBtn.append("circle").attr("r",Lt.removeBtn.radius),this.removeBtn.append("line").attr("x1",-Lt.removeBtn.chord).attr("y1",-Lt.removeBtn.chord).attr("x2",Lt.removeBtn.chord).attr("y2",Lt.removeBtn.chord),this.removeBtn.append("line").attr("x1",Lt.removeBtn.chord).attr("y1",-Lt.removeBtn.chord).attr("x2",-Lt.removeBtn.chord).attr("y2",Lt.removeBtn.chord)),this.removeBtn.attr("transform","translate(".concat(t,", ").concat(e,")"))}},{key:"remove",value:function(){this.arrow.remove(),t.arrows.delete(this)}}])&&St(e.prototype,a),i&&St(e,i),Object.defineProperty(e,"prototype",{writable:!1}),t}();Tt(Mt,"arrows",new Set),Tt(Mt,"resetArrowsSet",(function(){return Mt.arrows=new Set}));var It=Mt,Vt=function(){var t=[],e={axisLength:600},a=null,i=null,n=r.default.timeFormat("%d%b"),u=null,o=null;function s(){}return s.appendTicks=function(t){return t.tickSize(5).ticks(s.getTicks())},s.appendFormattedTicks=function(t,e){return e?t.tickSize(5).tickFormat(n):s.appendTicks(t).tickFormat(n)},s.init=function(){a=r.default.scaleTime().domain([t[0],t[1]]).range([0,e.axisLength]).clamp(!0),i=s.appendTicks(r.default.axisBottom(a)).tickFormat(n)},s.getTicks=function(){return u===r.default.timeDay&&1!==o?u.filter((function(e){return r.default.timeDay.count(t[0],e)%o==0})):u?u.every(o):void 0},s.ticks=function(){return a.ticks(s.getTicks()).map((function(t){return a(t)}))},s.position=function(t){return a(t)},s.draw=function(t){t.call(i).selectAll("text").attr("transform","translate(0,0)")},s.getAxisLine=function(){return a},s.getAxis=function(){return i},s.domain=function(e){return arguments.length?(t=e,s):t},s.ticksConfig=function(t){return u=t.ticksSize,o=t.ticksStep,s},s.config=function(t){if(!arguments.length)return e;for(var a in e)e[a]=t[a];return s},s.configValue=function(t,a){return e[t]=a,s},s.tickFormat=function(t){return arguments.length?(n=t,s):n},s},Ot=function(){var t,e=1,a=[],i={},n=0,r=xe.maxTextWidth,u={axisLength:null,barHeight:15,setBarHeight:null,progressBarPorcHeight:100,barPadding:5,barMargin:5,minTaskBandHeight:30,mileStoneHeight:0};p.init=function(){for(var t,e=0,r=0,l=0;l<a.length;l++){t=a[l];var c=o(t);r=e+c+s(t),i[t]={taskIni:e,taskEnd:e+c,mStoneIni:e+c,mStoneEnd:r},e=r}return n=r,u.axisLength=u.setBarHeight?n*u.setBarHeight/u.barHeight:u.axisLength,p},p.ticks=function(){for(var t,e,i=[],n=0;n<a.length;n++)t=a[n],e=c(t),i.push(p.scaleValue(e[0]));return null!=e&&i.push(p.scaleValue(e[1])),i},p.position=function(e){if(Nt(e,"startDate"))var a=t.taskTotalOverlaps(e),i=h(e.category)[0]+u.barMargin+a*(u.barHeight+u.barPadding);else{if(!Nt(e,"date"))return null;i=d(e.category)[0]+u.mileStoneHeight-6}return p.scaleValue(i)},p.textWidth=function(t){return r=t||r},p.draw=function(t){return t.selectAll("line.axisY").remove(),t.append("line").attr("x1","0").attr("y1","0").attr("x2","0").attr("y2",p.scaleValue(n)).attr("class","axisY").attr("style","stroke:black"),t.selectAll("g").remove(),t.selectAll("g").data(a,(function(t){return t})).enter().append("g").attr("transform",l).append("text").attr("x","-5").attr("style","text-anchor: end").attr("class","tickY-label").text((function(t){return t})).call(xe.textsToMultiline,r),t.selectAll("line.tickY").remove(),t.selectAll("line.tickY").data(p.ticks()).enter().append("line").attr("class","tickY").attr("x1","0").attr("y1",(function(t){return t})).attr("x2","-5").attr("y2",(function(t){return t})),p};var o=function(e){var a=t.categoryMaxOverlaps(e),i=u.minTaskBandHeight;return a>0&&(i=u.barMargin+(a-1)*(u.barHeight+u.barPadding)+u.barHeight+u.barMargin),i},s=function(){return u.mileStoneHeight},l=function(t){var e=c(t),a=e[0]+(e[1]-e[0])/2;return"translate(0,"+p.scaleValue(a)+")"};p.scaleValue=function(t){var e=1;return null!=u.axisLength&&n>0&&(e=u.axisLength/n),t*e};var c=function(t){return[i[t].taskIni,i[t].mStoneEnd]},h=function(t){return[i[t].taskIni,i[t].taskEnd]},d=function(t){return[i[t].mStoneIni,i[t].mStoneEnd]};function p(){}return p.overlappingResolver=function(e){return arguments.length?(t=e,p):t},p.categories=function(t){return arguments.length?(a=t,p):a},p.scale=function(t){return arguments.length?(e=t,p):e},p.config=function(t){if(!arguments.length)return u;for(var e in u)u[e]=t[e];return p},p.configValue=function(t,e){return u[t]=e,p},p.calculatedLength=function(){return n},p},Wt=function(){var t=[],e=[],a={},i=[];function n(t,e){if(Nt(a,t))for(var i=0;i<a[t].length;i++)n(a[t][i],e),e.push(a[t][i])}o.categories=function(e){return arguments.length?(t=e,o):t},o.tasks=function(t){return arguments.length?(e=t,a={},i=[],o):e},o.categoryMaxOverlaps=function(t){return i[t]?i[t].length:0},o.taskOverlaps=function(t){return a[t.id]},o.taskTotalOverlapsOld=function(t){var e=[];return n(t.id,e),e.filter((function(t,a){return e.indexOf(t)==a}))},o.taskTotalOverlaps=function(t){var e=t.id;return null!=a[e]?a[e].length:0};o.calculateOverlapping=function(){for(var e=0;e<t.length;e++){var a=[];i[t[e]]=a,r(t[e],a)}return o};var r=function(t,a){var i=e.filter((function(e){return e.category==t}));if(null!=i&&i.length>0)for(var n=0;n<i.length;n++)u(i[n],a)},u=function(t,e){for(var i,n,r=e.length,u=0;u<e.length;u++){if(!(t.startDate<e[u].endDate)){r=u;break}i=t,n=e[u],Nt(a,i.id)||(a[i.id]=[]),a[i.id].push(n.id)}e[r]=t};function o(){return o}return o};function Nt(t,e){var a=t.__proto__||t.constructor.prototype;return e in t&&(!(e in a)||a[e]!==t[e])}var zt=function(t){var e={axisLength:600,barHeight:15,progressBarHeight:5},a=null,i=null,n=function(t){for(var e in i)t.on(e,i[e])};function r(){}return r.getTruncatedTaskText=function(t,e){if(!t.label)return"";var a=e(t)-10,i=t.label,n=t.label.length;if(this.textContent=t.label,this.getComputedTextLength())for(;n>0&&this.getSubStringLength(0,n)>a;)n--;return n===t.label.length?i:0===n?"":i.substring(0,n)+""},r.draw=function(i){i.append("rect").attr("y",0).attr("height",t.scaleValue(e.barHeight)).attr("width",(function(t){return a(t)})).attr("class",(function(t){return Nt(t,"class")?t.class+"-bar":"task-bar"})).attr("style",(function(t){return t.style})).attr("rx",3).attr("ry",3).call(n),i.append("rect").attr("y",t.scaleValue((e.barHeight-e.progressBarHeight)/2)).attr("height",t.scaleValue(e.progressBarHeight)).attr("width",(function(t){return Nt(t,"progress")?a(t):0})).attr("style",(function(t){return t.todoStyle})).attr("class","task-progress-bar-total"),i.append("rect").attr("y",t.scaleValue((e.barHeight-e.progressBarHeight)/2)).attr("height",t.scaleValue(e.progressBarHeight)).attr("width",(function(t){return Nt(t,"progress")?a(t,t.progress):0})).attr("class",(function(t){return Nt(t,"class")?t.class+"-progress-bar":"task-progress-bar"})).attr("style",(function(t){return t.doneStyle})).call(n),i.append("text").attr("y",(function(a){var i=t.scaleValue(e.barHeight);return null==a.progress?i/2+5:i-3})).attr("x",5).attr("class",(function(t){return Nt(t,"class")?t.class+"-label":"task-label"})).attr("style",(function(t){return t.labelStyle})).text((function(t){return r.getTruncatedTaskText.call(this,t,a)}))},r.eventHandlers=function(t){return arguments.length?(i=t,r):i},r.calculateBarWidth=function(t){return arguments.length?(a=t,r):a},r.config=function(t){if(!arguments.length)return e;for(var a in e)e[a]=t[a];return r},r.configValue=function(t,a){return e[t]=a,r},r},Gt=function(){var t=null,e={mileStoneRadius:2},a=function(e){for(var a in t)e.on(a,t[a])};function i(){}return i.draw=function(t){t.append("polygon").attr("points","10,1 4,19.8 19,7.8 1,7.8 16,19.8").attr("class",(function(t){return Nt(t,"class")?t.class+"-mark":"milestone-mark"})).attr("style",(function(t){return t.style})).call(a),t.append("text").attr("x",2).attr("y",30).attr("style",(function(t){return t.style+";font-size: 14px"})).attr("class",(function(t){return Nt(t,"class")?t.class+"-label":"milestone-label"})).text((function(t){return t.label}))},i.eventHandlers=function(e){return arguments.length?(t=e,i):t},i.config=function(t){if(!arguments.length)return e;for(var a in e)e[a]=t[a];return i},i.configValue=function(t,a){return e[t]=a,i},i},Ht=function(){var t=null,e={chartHeight:100};function a(){}return a.draw=function(t){t.append("line").attr("x1","0").attr("y1","0").attr("x2","0").attr("y2",e.chartHeight).attr("class",(function(t){return Nt(t,"class")?t.class+"-line":"dateline-line"})).attr("style",(function(t){return t.style}));var a=t.append("text").attr("y",-4).attr("class",(function(t){return Nt(t,"class")?t.class+"-label":"dateline-label"})).style("text-anchor","middle").text((function(t){return t.label})),i=[];a.each((function(){var t=this.getBoundingClientRect(),e=0;i.some((function(a){if(a<t.x)return!0;e++})),i[e]=t.x+t.width,this.setAttribute("y",parseFloat(this.getAttribute("y"))+16*e),e>0&&(i[e]=i[e]+5,this.setAttribute("x",0))}))},a.eventHandlers=function(e){return arguments.length?(t=e,a):t},a.config=function(t){if(!arguments.length)return e;for(var i in e)e[i]=t[i];return a},a.configValue=function(t,i){return e[t]=i,a},a},Rt=function(t,e){t=t;var a=Math.floor(1e6*Math.random()+1),i={top:20,right:40,bottom:140,left:150},n=null,u=null,o=null,s=null,l="fit",c="%d/%b",h=null,d=null,p=!0,g=[],f=[],m=null,x=[],y=[],D=Wt(),v=Ot(),b=Vt(),F=zt(v),C=Gt(),A=Ht(),E={task:{},milestone:{},dateline:{}},_=function(){return null!=n&&n>0?n:v.config().setBarHeight?v.config().axisLength:v.calculatedLength()},w=function(){return null!=u&&u>0?u-i.right-i.left-5:document.body.clientWidth-i.right-i.left-5},B=function(t){return"t_"+t.id},k=function(t){return"ms_"+t.id},S=function(t){return"translate("+b.position(t.startDate)+","+v.position(t)+")"},T=function(t){var e=P(t);return"translate("+e.x+","+e.y+")"},P=function(t){var e=b.position(t.date)-10,a=v.position(t),i=$.grep(f,(function(e){return e.category===t.category}));if(i.length){var n=i[0];i.some((function(e){if(!(e.startDate<=t.date))return!0;n=e})),a=v.position(n)+v.scaleValue(15)/2}return{x:e,y:a-10}},L=function(t){return"translate("+b.position(t.date)+",0)"},M=function(){return t.selectAll("svg").data([a],(function(t){return t})).selectAll(".gantt-chart")},I=function(t,e){var a=E[e],i=function(a){t.on(a,(function(t){E[e].hasOwnProperty(a)&&E[e][a](t)}))};for(var n in a)i(n)},V=function(){var t=f.filter(H);D.tasks(t).calculateOverlapping(),b.domain([o,s]).tickFormat(c).ticksConfig({ticksSize:h,ticksStep:d}).configValue("axisLength",w()),b.init(),null==g&&(g=function(t){var e={};t.map((function(t){e.hasOwnProperty(e,t.category)||(e[t.category]=!0)}));var a=[];for(var i in e)a.push(i);return a}(f)),v.overlappingResolver(D).categories(g),null!=n&&v.configValue("axisLength",n),v.init()},O=function(){var t=M(),e=t.select("g.yaxis-group");v.draw(e);var a=t.select("g.xaxis-group");a.attr("transform","translate(0, "+_()+")"),b.draw(a),a.selectAll(".tick").classed("minor",(function(t){return t.getMonth()}))},W=function(t,e,a){var i,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M().select("g.grid-group");i=t?r.default.axisBottom().tickFormat("").tickSize(_()).scale(a):r.default.axisBottom().tickFormat("").tickSize(_()).ticks(b.getTicks()).scale(a),n.transition().duration(e?750:0).call(i).call((function(t){return t.select(".domain").attr("display","none")})).call((function(t){return t.selectAll("g.tick > line").attr("stroke","#ccc")}))},N=function(){var t=M().select("g.grid-group");W(!1,!1,b.getAxisLine(),t);var e=w();t.selectAll("line.gridY").remove(),t.selectAll("line.gridY").data(v.ticks(),(function(t){return t})).enter().append("line").attr("class","gridY").attr("x1",0).attr("x2",e).attr("y1",(function(t){return t})).attr("y2",(function(t){return t})).style("stroke","#ccc")},z=function(){var c,h;!function(t){if("fit"===l){if(void 0===t||t.length<1)return o=r.default.timeDay.offset(new Date,-3),void(s=r.default.timeHour.offset(new Date,3));o=t.reduce((function(t,e){return t.startDate<e.startDate?t:e})).startDate,s=t.reduce((function(t,e){return t.endDate>e.endDate?t:e})).endDate,b.domain([o,s]).init()}}(f),c=t.selectAll("svg").data([a],(function(t){return t})).enter().append("svg").attr("class","chart").attr("width",u).attr("height",n).append("g").attr("class","gantt-chart").attr("transform","translate("+i.left+", "+i.top+")"),(h=c.append("g").attr("class","gantt--clipped-area").attr("clip-path","url(#clip".concat(e.macroId).concat(e.pageId,")"))).append("g").attr("class","grid-group"),h.append("g").attr("class","gantt-bars"),c.append("g").attr("class","yaxis-group"),c.append("g").attr("class","xaxis-group")},G=function(t){var e=16*(t.length-1);t.forEach((function(t,a){t.forEach((function(t){var i=P(t.d);AJS.$(t.el).attr("transform","translate("+i.x+","+(i.y-e+32*a)+")")}))}))},H=function(t){return t.endDate>o&&t.startDate<s},R=function(t){return t.date>=o&&t.date<=s},X=function(t){return t.date>=o&&t.date<=s},Y=function(t,e){var a=null!=e?t.startDate.getTime()+(t.endDate-t.startDate)*e:t.endDate,i=Math.max(o,t.startDate),n=Math.min(s,a);return b.position(n)-b.position(i)};function j(){return j}return j.draw=function(){return t.selectAll("svg").data([a],(function(t){return t})).empty()?z():t.selectAll("svg").data([a],(function(t){return t})).selectAll("g.gantt-chart").attr("transform","translate("+i.left+", "+i.top+")"),V(),p&&N(),O(),function(t,e){var a=t.filter(H),i=M().select(".gantt-bars");i.selectAll("g").remove();var n=i.selectAll("g.g_task").data(a,B).enter().append("g").attr("class","g_task").attr("y",0).attr("transform",S);F.calculateBarWidth(Y).eventHandlers(E.task).draw(n),e&&function(){var t=new Map;n.each((function(e){t.set(e.id+"",r.default.select(this))})),It.resetArrowsSet();var a=function(a){e[a].forEach((function(n){t.get(a)&&t.get(n)&&new It(i,e,t.get(a),t.get(n)).draw()}))};for(var u in e)a(u)}()}(f,m),function(t){var e=t.filter(X).sort((function(t,e){return t.date.getTime()-e.date.getTime()})),a=M().select(".gantt-bars");a.selectAll("g.g_dateline").remove();var i=a.selectAll("g").data(e,(function(t){return t.date})).enter().append("g").attr("class","g_dateline").attr("y",0).attr("transform",L).call(I,"dateline");A.configValue("chartHeight",_()).eventHandlers(E.dateline).draw(i)}(y),function(t){var e=t.filter(R).sort((function(t,e){return t.date.getTime()-e.date.getTime()})),a=M().select(".gantt-bars");a.selectAll("g.g_mileStone").remove();var i=a.selectAll("g.g_milestone").data(e,k).enter().append("g").attr("class","g_milestone").attr("y",0).attr("transform",T);C.eventHandlers(E.milestone).draw(i);var n=[],r=[];i.each((function(t){var e=this.getBoundingClientRect();e.y=Math.round(e.y),n[e.y]||(n[e.y]=[],r[e.y]=[]);var a=0,i=!0,u=!1;n[e.y].some((function(t){if(t<e.x)u=!0;else{if(i=!1,u)return!0;a++}})),i&&(G(r[e.y]),n[e.y]=[],r[e.y]=[]),n[e.y][a]=e.x+e.width,r[e.y][a]||(r[e.y][a]=[]),r[e.y][a].push({el:this,d:t})})),r.forEach((function(t){G(t)}))}(x),r.default.select("body").select("svg").data([a],(function(t){return t})).style("height",_()+i.top+i.bottom),j},j.init=function(){z(),V()},j.getTimeAxisRenderer=function(){return b},j.margin=function(t){return arguments.length?(i=t,j):i},j.timeDomain=function(t){return arguments.length?(o=+t[0],s=+t[1],j):[o,s]},j.timeDomainMode=function(t){return arguments.length?(l=t,j):l},j.ticks=function(t){return h=t.ticksSize,d=t.ticksStep,j},j.container=function(e){return t=e,j},j.grid=function(t){return p=t,j},j.id=function(t){return arguments.length?(a=t,j):a},j.width=function(t){return arguments.length?(u=t,j):u},j.height=function(t,e){return arguments.length?(e?v.configValue("setBarHeight",e):n=t,j):n},j.tickFormat=function(t){return arguments.length?(c=t,j):c},j.categories=function(t){return arguments.length?(g=t,D.categories(g),j):g},j.tasks=function(t){return arguments.length?(f=t,j):f},j.arrows=function(t){return arguments.length?(m=t,j):m},j.mileStones=function(t){return arguments.length?(x=t,j):x},j.dateLines=function(t){return arguments.length?(y=t,j):y},j.overlappingResolver=function(t){return arguments.length?(D=t,j):D},j.categoryAxisRenderer=function(t){return arguments.length?(v=t,j):v},j.taskRenderer=function(t){return arguments.length?(F=t,j):F},j.msRenderer=function(t){return arguments.length?(C=t,j):C},j.datelineRenderer=function(t){return arguments.length?(A=t,j):A},j.taskEventHandler=function(t,e){return E.task[t]=e,j},j.milestoneEventHandler=function(t,e){return E.milestone[t]=e,j},j.datelineEventHandler=function(t,e){return E.dateline[t]=e,j},j.rescaleGridX=W,j};function Xt(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var a=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==a)return;var i,n,r=[],u=!0,o=!1;try{for(a=a.call(t);!(u=(i=a.next()).done)&&(r.push(i.value),!e||r.length!==e);u=!0);}catch(t){o=!0,n=t}finally{try{u||null==a.return||a.return()}finally{if(o)throw n}}return r}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return Yt(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);"Object"===a&&t.constructor&&(a=t.constructor.name);if("Map"===a||"Set"===a)return Array.from(t);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Yt(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Yt(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,i=new Array(e);a<e;a++)i[a]=t[a];return i}var jt=a(3e3);var Kt=2.5;function $t(t){var e=t.chart.select(".gantt-bars"),a=(0,u.default)().attr("class","d3-tip").offset([-5,0]).html("Drag and Drop");e.selectAll(".roundBtn").remove(),e.selectAll(".g_task").each((function(i){var n=r.default.select(this),u=n.select("rect"),o=u.attr("height")/2,s=u.attr("width");!function(t,e,a,i,n,u){var o,s=a.node(),l=a.append("g").attr("transform","translate(".concat(i,", ").concat(n,")")),c=function(){function u(i,n){o=new It(e,t.ganttArrows,a),e.classed("dragging",!0)}function l(t,e){var r=kt(t,s);r?o.draw(a,r):o.drawByPoins([i,n],[i+t.x,n+t.y])}function c(i,n){var r,u=kt(i,s);if(u){var l=a.data()[0].id,c=u.data()[0].id;t.ganttArrows[l+""]?r=t.ganttArrows[l+""]:(r=[],t.ganttArrows[l+""]=r),-1===r.indexOf(c+"")?(r.push(c+""),o.setTasks(a,u),o.draw()):o.remove()}else o.remove();e.classed("dragging",!1)}return r.default.drag().on("start",u).on("drag",l).on("end",c)},h=function(t,e){var a=$(this);yt(a,u),u.show(e,a[0]),t.stopPropagation(),setTimeout((function(){u.hide(),h=null}),1e3)};l.attr("class","draggable roundBtn").append("circle").attr("r",Kt),l.append("circle").attr("r",Kt).call(c()).call(u).on("mouseover",h).attr("stroke-opacity",0).transition().duration(500).attr("r",8*Kt).attr("stroke-opacity",1).transition().duration(500).attr("r",2*Kt)}(t,e,n,parseFloat(s),o,a)})),e.classed("editMode",!0),t.enableSaveBtn()}function Ut(t){var e=t.chart.select(".gantt-bars"),a=e.selectAll(".g_task");a.selectAll(".arrow").selectAll(".removeBtn").remove(),a.selectAll(".roundBtn").remove(),e.classed("editMode",!1)}var Jt=a(4818),qt=a(4865),Zt=function(t,e){return Object.assign(this,e),this.rawValue=t,this.valueType=e.valueType||W.default.getValueType(t,e.separator,e.worklog),this.value=t,this.parsed=!1,this};Object.assign(Zt.prototype,{getValue:function(){return this.value},setValue:function(t){this.value=t},getRawValue:function(){return this.rawValue},getValueType:function(){return this.valueType},isEmpty:function(){return null===this.rawValue||""===this.rawValue},isParsed:function(){return this.parsed},parseValueByType:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.parsed)return this.value;if(this.valueType===W.default.date)this.value=W.default.parseDate(this.value,t.formats,t.locales);else{var e=t.separator||this.separator,a=t.worklog||this.worklog;this.value=W.default.parseValueByType(this.valueType,this.rawValue,e,a)}return this.parsed=!0,this.value},parseValueWithType:function(t,e){return this.valueType=t,this.parseValueByType(e)},isNumber:function(){return this.parsed||this.parseValueByType(),W.default.isNumber(this.value)},getTextWidth:function(){return(0,et.getTextWidth)(this.rawValue)},valueOf:function(){return this.value.valueOf()}});var Qt=Zt;function te(t,e,a,i,n,r,u){try{var o=t[r](u),s=o.value}catch(t){return void a(t)}o.done?e(s):Promise.resolve(s).then(i,n)}function ee(t){return function(){var e=this,a=arguments;return new Promise((function(i,n){var r=t.apply(e,a);function u(t){te(r,i,n,u,o,"next",t)}function o(t){te(r,i,n,u,o,"throw",t)}u(void 0)}))}}var ae=function t(e){var a=this;a.palette=W.default.chartColors,a.colors=e.colors?e.colors.split(","):[],a.colorColumns=e.colorColumns?e.colorColumns.split(","):[],a.pieKeys=e.pieKeys?e.pieKeys.split(""):[],a.barColoringType=t.initParamBarColoringType(e),a.ganttCatColors="mono"===a.barColoringType?Q:a.pieKeys.slice(),a.visiblePieKeysLength=a.pieKeys.length,a.macroId=e.macroId,a.pageId=e.pageId,a.dateFormat=e.dateFormat||"yy-mm-dd",a.dateFormat=a.dateFormat.replace("yyyy","yy"),a.hasTimeFormat=a.dateFormat.toLowerCase().indexOf("hh:mm")>=0,a.localeDateFormat=W.default.getLocaleDateFormat(a.dateFormat),a.separator=e.separator,a.worklog=W.default.getWorklog(e.worklog),a.columns=e.columns?e.columns.split(""):[],a.aggregation=e.aggregation?e.aggregation.split(""):[],a.trimParams(a.columns),a.trimParams(a.aggregation),a.aggregationCache=a.aggregation.slice(),a.columnsCache=a.columns.slice(),a.transpose="Horizontal"===e.dataorientation,a.grid=e.grid,a.legend=e.legend&&"none"!==e.legend,a.isLegendUnderGraph="under"===e.legend,a.xValueType=null,a.valueType=W.default.getValueType(e.minvalue,a.separator,a.worklog)||W.default.getValueType(e.maxvalue,a.separator,a.worklog)||W.default.getValueType(e.scalestep,a.separator,a.worklog)||null,a.minvalue=W.default.parseValueByType(a.valueType,e.minvalue,a.separator,a.worklog),a.minvalue=!1===a.minvalue?NaN:a.minvalue,a.maxvalue=W.default.parseValueByType(a.valueType,e.maxvalue,a.separator,a.worklog),a.maxvalue=!1===a.maxvalue?NaN:a.maxvalue,a.xminvalue=e.xminvalue,a.xmaxvalue=e.xmaxvalue,a.yminvalue=e.minvalue,a.ymaxvalue=e.maxvalue,a.scaleStep=W.default.parseValueByType(a.valueType,e.scalestep,a.separator,a.worklog),a.scaleStep=!1===a.scaleStep?NaN:a.scaleStep,a.xScaleStep=e.xscalestep,a.yScaleStep=e.scalestep,a.locale=W.default.getLocale(),a.title=e.title,a.xtitle=e.xtitle,a.ytitle=e.ytitle,a.isLog=e.isLog,a.isXLog=e.isXLog,a.titleHeight=e.title?20:0,a.xtitleHeight=e.xtitle?20:0,a.ytitleHeight=e.ytitle?20:0,a.showTrendLine="string"==typeof e.showTrendLine?"true"==e.showTrendLine:1==e.showTrendLine,a.tabs=e.tabs,a.hide=e.hide,a.textWidth=0,a.bubleMaxTextWidthX=t.maxTextWidth,a.bubleMaxTextWidthY=t.maxTextWidth,a.argumentWidth=0,a.lineSettings=e.lineSettings?e.lineSettings.split(","):{},a.version=3,a.interpolation=e.interpolation?e.interpolation.split(","):["Linear"],a.defaultInterpolation=e.version>=3?"Linear":a.interpolation[0],a.outerLabels=e.outerLabels,a.storedParams={},a.sessionId=e.sessionId||1,a.isEditor=e.isEditor,a.isCloud=e.isCloud,a.ganttArrows=e.ganttArrows?JSON.parse(decodeURI(e.ganttArrows)):{},a.isWasSavedEarlier=!(!a.columns.length||!a.aggregation.length),e.version>=3?(a.showInnerLabels="None"!==e.showInnerLabels,a.innerLabelsType={percentage:"Percentage"===e.showInnerLabels,value_percentage:"Value (Percentage)"===e.showInnerLabels,percentage_value:"Percentage (Value)"===e.showInnerLabels,value:"Value"===e.showInnerLabels||!e.showInnerLabels}):(a.showInnerLabels="string"==typeof e.showInnerLabels?"false"!=e.showInnerLabels:0!=e.showInnerLabels,a.innerLabelsType={}),fe(a.colors,a.palette),a.colorsCache=a.colors.slice(),a.initFormaters(),"editor"!==a.macroId&&(a.initElements(),a.content.data("rendered")||(a.content.data("rendered",!0),a.isPivot&&(a.separator=a.pivotContent.data("decimalseparator")),a.getOriginalTable(),a.getType(),a.getDimension(),a.setIsMultiColorColumn(),a.bindUpdate(),At.default.bindUnloadPage(a,a.settings),a.setChosen(),a.bindUI(),a.setControls(),a.draw(),a.bindTips(),a.bindPageResize(),a.setStoreParams()))};function ie(t,e,a){return t[e]||(t[e]=[0]),t[e].push(a),t}function ne(t){if(window.XMLSerializer&&t.length){var e=(new XMLSerializer).serializeToString(t[0]);return(e=e.replace(/xmlns="http:\/\/www.w3.org\/2000\/svg"/g,"")).substring(0,4)+' xmlns="http://www.w3.org/2000/svg"'+e.substring(4,e.length)}return t.prop("outerHTML")}function re(t){var e=0;t.forEach((function(t){e+=t.value}));var a=0,i={},n=0,r=[],u=$.grep(t,(function(t){var u,o,s=Math.round(1e3*t.value/e)/10;if(t.percent=s,s>1)return!0;a=W.default.addFloats(a,t.value),n++,r.push({label:t.label,value:t.value,percent:s}),u=i,o=t.rowNumber,$.each(o,(function(t,e){u[t]||(u[t]=[]),u[t]=u[t].concat(e)})),i=u}));return a&&n>1&&u.push({label:"Other",value:a,percent:Math.round(1e3*a/e)/10,other:!0,rowNumber:i}),{data:u,smallData:r,count:n}}function ue(t,e,a){var i=0,n=0;return e.length===a.length?e.length&&(a[0].absTotal?n=a[0].absTotal:(n=0,a.forEach((function(t){n+=t.total})),a[0].absTotal=n)):a.some((function(e){if(e.label===t.label)return n=e.total,!0})),n&&(i=100*t.value/n),i.toFixed(1)+"%"}function oe(t){return r.default.hsl(t).darker(.7)}function se(t,e,a,i,n,r){var u=parseFloat(t);if(0==u)return"";var o=8*r(u).length+4,s=n?he(e):de(e);if(o>=s&&(i||o>=a-s)){if(u>0&&u<1e-4||u>99999.999)return u.toExponential(1);var l=5-Math.floor(u).toString().length;return r(parseFloat(u.toFixed(l>0?l:0)))}return r(u)}function le(t){var e=t.offset().left,a=he(t);return{left:e,right:e+a,width:a}}function ce(t){var e=t.offset().top,a=de(t);return{top:e,bottom:e+a,height:a}}function he(t){return t[0].getBoundingClientRect().width}function de(t){return t[0].getBoundingClientRect().height}function pe(t,e){var a=le(t);0!==a.width&&"0"!==e.parent().css("opacity")&&e.each((function(){for(var t=$(this),e=le(t),i=13,n=parseFloat(t.attr("x"))||0;(e.left<a.left||e.right>a.right)&&i>0;){t.css("font-size",i--);var r=e.width;(e=le(t)).left<a.left&&e.right<=a.right?(n=n+r-he(t),t.attr("x",n)):e.right>a.right&&e.left>=a.left&&(n=n-r+he(t),t.attr("x",n))}}))}function ge(t){return"M"+(t=t.map((function(t){return t.join(",")}))).join("L")+"Z"}function fe(t,e){e.forEach((function(e){-1===$.inArray(e,t)&&t.push(e)}))}function me(t){return null!=t.position}ae.textMaxLength=N,ae.maxTextWidth=z,ae.minHorizontalTextWidth=G,ae.prototype.initElements=function(){var t=this;t.content=$('[id="chart'+t.macroId+'"][data-pageid="'+t.pageId+'"][data-sessionid="'+t.sessionId+'"]'),t.chartBody=t.content.children(".chart-body"),t.chartBody=W.default.addExcerpt(t.chartBody,"chart-body"),t.chartBody=W.default.addIframe(t.chartBody,"chart-body",(function(e){t.chartBody=e,t.getOriginalTable(),t.setControls(),t.draw()})),t.wrapper=t.content.children(".chart-wrapper"),t.svgWrapper=t.wrapper.find(".svg-wrapper"),t.chart=r.default.selectAll('[id="chart'+t.macroId+'"][data-pageid="'+t.pageId+'"][data-sessionid="'+t.sessionId+'"] > .chart-wrapper .svg-wrapper'),t.canvas=t.content.find("canvas").eq(0),t.png=t.content.find("#pngdataurl").eq(0),t.columnSelect=t.wrapper.find(".chart-column"),t.aggregationSelect=t.wrapper.find(".chart-aggregation"),t.typeSelect=t.wrapper.find(".chart-type"),t.is3DInput=t.wrapper.find(".is3d"),t.is3D=t.is3DInput.is(":checked"),t.heightInput=t.wrapper.find(".chart-height"),t.widthInput=t.wrapper.find(".chart-width"),t.is3DWrapper=t.wrapper.find(".is3d-wrapper"),t.noTableMessage=t.wrapper.find(".no-table-message"),t.previewTutorial=t.content.find(".preview-tutorial"),t.badSettings=t.wrapper.find(".bad-settings-message"),t.wrongDateFormat=t.wrapper.find(".wrong-date-message"),t.noDataMessage=t.wrapper.find(".no-data-message"),t.customMessage=t.wrapper.find(".custom-message"),t.logZeroMessage=t.wrapper.find(".log-zero-message"),t.loader=t.wrapper.find("#chart-loading"),t.controls=t.wrapper.find(".chart-controls"),t.settings=t.controls.find(".chart-settings"),t.menu=t.content.find("#chart-menu-view-".concat(t.macroId,"-").concat(t.pageId,"-").concat(t.sessionId)),t.showRawDataItem=t.menu.find(".chart-showrawdata"),t.hideRawDataItem=t.menu.find(".chart-hiderawdata"),t.hideRawDataTableItem=t.menu.find(".chart-hiderawdata-table"),t.hideRawDataAllItem=t.menu.find(".chart-hiderawdata-all"),t.setDependenciesItem=t.menu.find(".set-dependencies"),t.selectColors=t.menu.find(".chart-change-color"),t.btn=t.menu.find(".chart-save").not("body.content-preview .chart-save"),t.download=t.menu.find(".save-as-png"),t.dateFormatInput=t.wrongDateFormat.find(".chart-date-format"),t.setInterpolationBtn=t.menu.find(".chart-set-interpolation"),t.changeLineSettingsBtn=t.menu.find(".chart-set-line-settings"),t.checkPivotContent()},ae.prototype.setStoreParams=function(){var t=this;t.storedParams={column:t.getSaveParams(t.columns),aggregation:t.getSaveParams(t.aggregation),type:t.type,"tfc-height":t.heightInput.val(),"tfc-width":t.widthInput.val(),hide:t.hide,barColoringType:t.barColoringType,colors:t.colors,colorColumns:t.colorColumns,pieKeys:t.pieKeys,is3d:t.is3D,lineSettings:t.lineSettings,interpolation:t.interpolation,ganttArrows:encodeURI(JSON.stringify(t.ganttArrows))}},ae.prototype.getStoreParams=function(){return this.storedParams},ae.prototype.checkPivotContent=function(){var t=this;t.pivotContent=t.chartBody.find(".pivot-content"),t.isPivot=t.pivotContent.length>0},ae.prototype.initFormaters=function(){var t=this;t.formatNum=T()({mark:t.separator,thousand:" "}),t.formatNumShort=T()({mark:t.separator,thousand:""}),t.formatNumTo=function(e,a){var i=W.default.formatValueByType(e,a&&t.valueType instanceof Object?t.valueType[a]:t.valueType,(function(e){return"number"==typeof e?Math.abs(e)>=1e3?t.formatNum.to(e):t.formatNumShort.to(e):e}),t.worklog,t.separator),n=a&&t.valueFormatter instanceof Object&&"function"!=typeof t.valueFormatter?t.valueFormatter[a]:t.valueFormatter;return n?n(i):i},t.formatNumToX=function(e){var a=W.default.formatValueByType(e,t.xValueType,(function(e){return"number"==typeof e?Math.abs(e)>=1e3?t.formatNum.to(e):t.formatNumShort.to(e):e}),t.worklog,t.separator);return t.xValueFormatter?t.xValueFormatter(a):a}},ae.prototype.trimParams=function(t){for(var e=0;e<t.length;e++)t[e]=t[e].replace("",""),t.indexOf(t[e])!==e&&t.splice(e--,1)},ae.prototype.getSaveParams=function(t){for(var e=[],a=0;a<t.length;a++)""==t[a]?e.push(""):e.push(t[a]);return e.length?e.join(""):""},ae.prototype.getDimension=function(){var t=this;if(t.height=t.heightInput.val(),t.ganttBarHeight=null,t.width=t.widthInput.val(),t.adaptiveDimensions=!1,W.default.isNumber(t.width))t.width=parseInt(t.width);else{t.width=t.content.closest(":visible").width()||320,t.width-=20;var e=$("body.content-preview").length>0;e||"none"===t.controls.css("display")||(t.width-=190),e&&(t.width=t.width>300?t.width:$(window.parent).width()-250),t.adaptiveDimensions=!0}W.default.isNumber(t.height)?t.height=parseInt(t.height):(t.isGantt&&/\d+(.\d+)?\/bar/i.test(t.height)?t.ganttBarHeight=W.default.parseNumber(t.height):"undefined"!=typeof AP?t.height=Math.round(9*t.width/16):(t.height=Math.min(.7*window.innerHeight,600),t.height=t.height<300?300:t.height),t.adaptiveDimensions=!0)},ae.prototype.bindPageResize=function(){var t=this;if(t.widthInput.val().trim())t.resizeSensor&&t.resizeSensor.detach();else{var e=$(".wiki-content, .ac-content, .touch-tile"),a=e.width();t.resizeSensor=new k.ResizeSensor(e[0],(function(){var i=e.width();Math.abs(i-a)>17&&(a=i,t.getDimension(),t.draw(!0))}))}},ae.prototype.getType=function(){var t=this;t.type=t.typeSelect.val(),t.initType(),t.isTime?(t.wrapper.find("label.simple-text, label.series-text, label.bubble-text").hide(),t.wrapper.find("label.time-text").show()):t.isSeries?(t.wrapper.find("label.simple-text, label.time-text, label.bubble-text").hide(),t.wrapper.find("label.series-text").show()):t.isBubblePie?(t.wrapper.find("label.simple-text, label.time-text, label.series-text").hide(),t.wrapper.find("label.bubble-text").show()):(t.wrapper.find("label.time-text, label.series-text, label.bubble-text").hide(),t.wrapper.find("label.simple-text").show()),t.isTime||t.isSeries||t.isGantt||t.isBubblePie||t.isRadar?(t.is3DWrapper.hide(),t.typeSelect.removeClass("short")):(t.is3DWrapper.show(),t.typeSelect.addClass("short"))},ae.prototype.initType=function(){var t=this;t.isPie="Pie"===t.type||"Donut"===t.type,t.isTime=-1!=t.type.indexOf("Time"),t.isSeries="Line"==t.type||"Area"==t.type||"Stacked Area"==t.type,t.isArea=-1!=t.type.indexOf("Area"),t.isBar=t.type.indexOf("Bar")>=0||t.type.indexOf("Column")>=0,t.isGantt=t.type.indexOf("Gantt")>=0,t.isBubblePie="Bubble Pie"===t.type,t.isRadar="Radar"===t.type,t.multiple=t.isBar||t.isSeries||t.isTime||t.isGantt},ae.prototype.getOriginalTable=function(){var t=this,e=t.tabs&&W.default.hasTabs(t.chartBody);t.originalTable=W.default.getTableNodes(t.chartBody).filter((function(){var t=$(this);return!(e&&W.default.hasInactiveTab(t))})),t.isPivot||(W.default.normalizeTable(t.originalTable,"data-tf-ready"),W.default.processMergedCells(t.originalTable)),t.originalTable.unbind("sortEnd.tfchart-".concat(t.macroId)).bind("sortEnd.tfchart-".concat(t.macroId),(function(){t.sorting=!1,t.setMutationObserver(),t.getTable(),t.draw(!0)})).unbind("sortStart.tfchart-".concat(t.macroId)).bind("sortStart.tfchart-".concat(t.macroId),(function(){t.sorting=!0,t.setMutationObserver()})),t.resetDateFormats(),W.default.setPaginationMsg(t.chartBody),t.getTable()},ae.prototype.resetDateFormats=function(){var t=this;t.dateFormats=[],t.locales=[],t.originalTable.each((function(){t.dateFormats.push([]),t.locales.push([])}))},ae.prototype.updateSettingsForPivot=function(){var t=this;t.isPivot&&(t.columnSelect.parent().hide(),t.aggregationSelect.parent().hide(),t.columnHidden=!0,t.aggregationHidden=!0,(W.default.getRawColumns(t.tables).length>2||t.isGantt)&&(t.aggregationSelect.parent().show(),t.aggregationHidden=!1,t.columnSelect.parent().show(),t.columnHidden=!1))},ae.prototype.bindUpdate=function(){var t=this,e=function(e){e&&(t.getOriginalTable(),t.setControls()),t.draw()};W.default.bindTFACEvents(t.chartBody,".pivot-content, .tablefilter-table-wrapper","tf-filtered pt-calculated",(function(a){return e("tf-filtered"!==a.type||t.isPivot)}),!0)||t.chartBody.bind("tf-filtered-charts",(function(){e(!1)}));var a=null;t.chartBody.bind("tf-jira-updated DOMCharacterDataModified changed.chk",(function(t){W.default.isIgnoreCharacterModified(t)||(clearTimeout(a),a=setTimeout((function(){e(!0)}),100))})),W.default.bindTaskList(t.chartBody,(function(){e(!0)}));var i=function(i,n){if(!i.parents(".pivot-table").length)return!W.default.isIgnoreUpdateNode(i)&&(n.className===t.chartBody[0].className||W.default.hasRowForUpdate(i)||W.default.hasCellUpdate(i)||W.default.hasTableForUpdate(i)||W.default.hasCharsForUpdate(i,n))?(clearTimeout(a),a=setTimeout((function(){a=null,e(!0)}),100),!0):void 0};t.observer=new MutationObserver((function(t){W.default.mutationObserverFilter(t,i)})),t.setMutationObserver(),t.tabs&&W.default.onTabChange(t.chartBody,(function(){e(!0)})),t.chartBody.bind("tf-save",(function(){return t.content.trigger("tf-save"),!1})).bind("tf-export-ready",(function(e,a){return t.macroId===a.macroId}))},ae.prototype.setMutationObserver=function(){var t=this;if(t.observer)if(t.sorting)t.observer.disconnect();else{var e={childList:!0,subtree:!0};t.chartBody.each((function(){t.observer.observe(this,e)}))}},ae.prototype.setChosen=function(){var t=this;t.setChosenSelect(t.columnSelect,t.columns,t.columnsCache,!0),t.setChosenSelect(t.aggregationSelect,t.aggregation,t.aggregationCache,!1)},ae.prototype.setChosenSelect=function(t,e,a,i){var n=this;t.chosenTF({max_selected_options:i&&n.isBubblePie?2:void 0,no_results_text:"No matches for",placeholder_text_multiple:"Click and start typing...",display_selected_options:!1,width:"178px"}).change((function(r,u){null!=u.selected?(t.find("option").filter((function(){return this.textContent==u.selected})).prop("selected","selected"),e.push(u.selected)):null!=u.deselected&&(t.find("option").filter((function(){return this.textContent==u.deselected})).prop("selected",!1),e.splice($.inArray(u.deselected,e),1)),i&&!n.isGantt&&(n.pieKeys=[],n.visiblePieKeysLength=0),a.length=0,$.merge(a,e),n.aggregationChange=!1,n.columnsChange=!1,n.enableSaveBtn(),n.draw()}));var r=t.parent().find(".chosen-choices");r.sortable({tolerance:"pointer",cursor:"move",helper:"clone",items:".search-choice",stop:function(){var t=e.slice();if(e.length=0,r.find(".search-choice").each((function(){e.push(this.textContent)})),a.length=0,$.merge(a,e),!n.isGantt&&n.multiple){var i=n.colors.slice();t.forEach((function(t,a){var r=$.inArray(t,e);r>=0&&i.length>r&&(n.colors[r]=i[a])})),n.colorsCache=n.colors.slice()}n.btn.prop("disabled",!1),n.enableSaveBtn(),n.draw()}})},ae.prototype.bindUI=function(){var t=this;t.typeSelect.change((function(){var e=t.isGantt;t.getType(),(e||t.isGantt)&&(t.ganttBarHeight&&t.getDimension(),t.setDependenciesItem.toggleClass("hidden",!t.isGantt)),t.shiftInterpolationBtn(),t.shiftChangeLineSettingsBtn(),t.enableSaveBtn(),t.draw()}));var e=null;t.heightInput.add(t.widthInput).bind("input",(function(){clearTimeout(e),e=setTimeout((function(){t.getDimension(),t.enableSaveBtn(),t.draw(),t.bindPageResize()}),330)})),t.is3DInput.change((function(){t.is3D=t.is3DInput.is(":checked"),t.enableSaveBtn(),t.draw()})),t.btn.click((function(e){var a,i;t.btn.toggleClass("tf-disabled-link"),t.controls.add(t.btn).find(".tfac-unsaved").hide(),At.default.removeFromUnloadPageAction(t),t.type&&(t.type.indexOf("Line")>=0||t.type.indexOf("Area")>=0)&&(a=t.calcInterpolation(),t.type.indexOf("Line")>=0&&(i=t.calcLineSettings()));var n=t.getAllChartColorLabels().length,r={column:t.getSaveParams(t.columns),aggregation:t.getSaveParams(t.aggregation),type:t.type,"tfc-height":t.heightInput.val(),"tfc-width":t.widthInput.val(),hide:t.hide,barColoringType:t.barColoringType,colors:t.colors.slice(0,n).join(","),colorColumns:t.colorColumns.slice(0,n).join(","),interpolation:a,pieKeys:t.pieKeys.join(""),is3d:t.is3D,ganttArrows:encodeURI(JSON.stringify(t.ganttArrows))};Ut(t);var u=t.getStoreParams();u.colors&&(u.colors=u.colors.slice(0,n)),Ct.default.gaChartSaveChange(r,u),bt.default.saveChanges(t.pageId,t.macroId,r.column,r.aggregation,r.type,r["tfc-height"],r["tfc-width"],r.hide,r.barColoringType,r.colors,r.colorColumns,r.pieKeys,r.is3d,void 0,t.content,t.version,r.interpolation,i,t.getInnerLabelsParam(),r.ganttArrows),t.content.trigger("tf-save",t.getExportEventData()),e.preventDefault()})),t.menu.find(".tf-remove").click((function(e){e.preventDefault(),W.default.createDialogRemoveMacro(t,"Chart from Table","Chart from Table")}));var a=function(e){switch(t.hide=e,e){case"true":t.showRawDataItem.parent().show(),t.hideRawDataItem.parent().hide(),t.chartBody.removeClass("hidden-all"),t.chartBody.addClass("chart-hidden");break;case"all":t.showRawDataItem.parent().show(),t.hideRawDataItem.parent().hide(),t.chartBody.addClass("chart-hidden hidden-all");break;case"false":t.hideRawDataItem.parent().show(),t.showRawDataItem.parent().hide(),t.chartBody.removeClass("chart-hidden hidden-all")}};a(t.hide),t.showRawDataItem.click((function(e){a("false"),t.enableSaveBtn(),e.preventDefault()})),t.hideRawDataTableItem.click((function(e){a("true"),t.enableSaveBtn(),e.preventDefault()})),t.hideRawDataAllItem.click((function(e){a("all"),t.enableSaveBtn(),e.preventDefault()})),t.setDependenciesItem.click((function(e){$t(t),Ct.default.gaEnableEditArrowsMode(t.ganttArrows)}));var i=t.menu.find(".export-file-pdf"),n=t.menu.find(".export-file-doc"),r=t.menu.find(".export-file-print");void 0===B.saveAs?(i.hide(),n.hide(),r.hide()):(i.click((function(e){Ft.default.loadScriptsBeforeExport((function(){W.default.exportToPdf(t.getExportContent(),!0)})),e.preventDefault()})),n.click((function(e){W.default.exportToDoc(t.getExportContent()),e.preventDefault()})),r.click((function(e){W.default.browserPrint(t.getExportContent()),e.preventDefault()})));var u=vt.default.initChartColorsDialog(t),o=vt.default.initInterpolationDialog(t),s=vt.default.initLineSettingsDialog(t),l=!1;t.menu.find(".chart-change-color").click((function(e){l=!0,u.show(),t.controls.addClass("active"),e.preventDefault()})),t.setInterpolationBtn.click((function(e){l=!0,o.show(),t.controls.addClass("active"),e.preventDefault()})),t.changeLineSettingsBtn.click((function(e){l=!0,s.show(),t.controls.addClass("active"),e.preventDefault()})),t.controls.find(".aui-dropdown2").bind("aui-dropdown2-show",(function(){t.controls.addClass("active")})).bind("aui-dropdown2-hide",(function(){l?l=!1:t.controls.removeClass("active")}));var c=null;t.dateFormatInput.bind("change selected keyup",(function(e){var a=function(){t.dateFormat=t.dateFormatInput.val().trim(),t.resetDateFormats(),t.draw()&&bt.default.saveDateFormat(t.pageId,t.macroId,t.dateFormat)};"keyup"===e.type?13===e.which&&a():(clearTimeout(c),c=setTimeout((function(){a()}),300))})),t.download.click((function(){W.default.isIE11()&&window.navigator.msSaveBlob(t.canvas[0].msToBlob(),"Chart.jpg"),Ct.default.gaChartExportJPEG()})),t.shiftInterpolationBtn(),t.shiftChangeLineSettingsBtn()},ae.prototype.getExportContent=function(){var t=this,e=t.png;return t.hide&&"false"!==t.hide||(e=e.add(t.chartBody.not(".table-excerpt"))),e},ae.prototype.calcInterpolation=function(){var t=this,e=[];return t.interpolation instanceof Array?t.chartKeys.forEach((function(a,i){e.push(i<t.interpolation.length?t.interpolation[i]:t.defaultInterpolation)})):t.chartKeys.forEach((function(a,i){e.push(t.interpolation[a]?t.interpolation[a]:t.defaultInterpolation)})),e.join(",")},ae.prototype.calcLineSettings=function(){var t=this,e=[],a="solid-1.5";return t.lineSettings instanceof Array?t.chartKeys.forEach((function(i,n){e.push(n<t.lineSettings.length?t.lineSettings[n]:a)})):t.chartKeys.forEach((function(i,n){e.push(t.lineSettings[i]?t.lineSettings[i].type+"-"+t.lineSettings[i].width:a)})),e.join(",")},ae.prototype.getChartColorLabels=function(){return this.getColorLabels(this)},ae.prototype.getAllChartColorLabels=function(){return this.getColorLabels(this,!0)},ae.prototype.getColorLabelsForMenu=function(t){return"columns"===this.barColoringType?this.isGantt?Q:this.isPie?["Colors column"]:this.getColorLabels(this,t):this.getColorLabels(this,t)},ae.prototype.getColorLabels=function(t,e){if(t.isGantt)return e&&"mono"!==t.barColoringType?t.pieKeys:t.ganttCatColors||[];if(t.multiple&&!t.isMultiColorColumn){var a=t.chartKeys?t.chartKeys.slice():[];return e&&a.length<t.columnsCache.length*t.aggregationCache.length&&(t.columnsCache.length>1&&t.aggregation.length>1?t.columnsCache.forEach((function(e){t.aggregationCache.forEach((function(t){var i=t+" - "+e;-1===a.indexOf(i)&&a.push(i)}))})):t.columnsCache.length>1?t.columnsCache.forEach((function(t){-1===a.indexOf(t)&&a.push(t)})):t.aggregationCache.forEach((function(t){-1===a.indexOf(t)&&a.push(t)}))),a}return e?t.pieKeys:t.pieKeys.slice(0,t.visiblePieKeysLength)},ae.prototype.getTable=function(){var t=this,e=W.default.getTablesAndRowsFromTables(t.originalTable,W.default.mixedType,null,t.transpose);t.rows=e.rows,t.tables=e.tables},ae.prototype.setControls=function(){var t=this;t.updateSettingsForPivot();var e=W.default.getRawColumns(t.tables),a=e.slice().sort((function(t,e){return t.localeCompare(e)}));if(t.columnSelect.empty(),t.aggregationSelect.empty(),a.length){W.default.updateI18nSettings([a],[t.columns,t.aggregation,t.columnsCache,t.aggregationCache],t.locale,t.chartBody),t.colorKeyMap||"columns"===t.barColoringType||t.updateColorsKeyMap(t.colors),t.tableColumnsCache&&($(t.tableColumnsCache).not(a).length>0||$(a).not(t.tableColumnsCache).length>0)&&(t.aggregationChange&&(t.aggregation.length=0,$.merge(t.aggregation,t.aggregationCache),t.multiple&&!t.isGantt&&(t.colors=t.colorsCache.slice())),t.columnsChange&&(t.columns.length=0,$.merge(t.columns,t.columnsCache))),t.tableColumnsCache=a.slice();var i=document.createDocumentFragment(),n=document.createDocumentFragment(),r=function(e,a){return a.indexOf(e)>=0||t.isPivot&&($.inArray(e+" "+"Total",a)>=0||$.inArray(e.replace(" "+"Total",""),a)>=0)},u=function(a,i){return r(a,i)||!t.isPivot&&0===i.length&&0===$.inArray(a,e)?'selected="selected"':""};if($.each(a,(function(e,a){i.appendChild($("<option "+u(a,t.columns)+"></option>").text(a)[0]),n.appendChild($("<option "+u(a,t.aggregation)+"></option>").text(a)[0])})),t.columnSelect.append(i),t.aggregationSelect.append(n),$.each(t.columns.slice(),(function(e,i){r(i,a)||(t.columns.splice($.inArray(i,t.columns),1),t.columnsChange=!0)})),$.each(t.aggregation.slice(),(function(e,i){if(!r(i,a)){var n=$.inArray(i,t.aggregation);t.aggregation.splice(n,1),t.aggregationChange=!0,t.multiple&&!t.isGantt&&t.colors.splice(t.aggregationCache.length-1,0,t.colors.splice(n,1)[0])}})),t.isPivot)0===t.columns.length&&void 0!==e[0]&&(t.columns.push(e[0]),t.columnSelect.find("option").filter((function(){return this.textContent===e[0]})).prop("selected",!0)),0===t.aggregation.length&&void 0!==e[e.length-1]&&(t.aggregation.push(e[e.length-1]),t.aggregationSelect.find("option").filter((function(){return this.textContent===e[e.length-1]})).prop("selected",!0));else if(0===t.columns.length&&(t.columns.push(e[0]),t.transpose&&e[0]&&t.columnSelect.find("option").filter((function(){return this.textContent===e[0]})).prop("selected",!0)),0===t.aggregation.length){var o=Math.min(1,e.length-1);t.aggregation.push(e[o]),t.transpose&&e[o]&&t.aggregationSelect.find("option").filter((function(){return this.textContent===e[o]})).prop("selected",!0)}}t.columnSelect.trigger("chosen:updated"),t.aggregationSelect.trigger("chosen:updated"),W.default.sortSelectedOptions(t.columnSelect,t.columns),W.default.sortSelectedOptions(t.aggregationSelect,t.aggregation)},ae.prototype.getDateFormat=function(t,e){var a=this;return W.default.setDateFormatForColumn(a.dateFormats[t],a.locales[t],a.dateFormat,a.locale,a.localeDateFormat,e,a.rows[t],a.hasTimeFormat,a.tables[t]),a.workingDateFormat=a.dateFormats[t][e],a.dateFormats[t][e]},ae.prototype.calculateBubblePieData=function(t){var e=this,a=[];if(2!==e.columns.length||0===e.aggregation.length)return a;e.bubblePieSetting={},e.bubblePieSetting.axisX={title:e.columns[0],order:[]},e.bubblePieSetting.axisY={title:e.columns[1],order:[]},e.bubblePieSetting.indicator={valueType:null},e.bubblePieSetting.sameValuesCount={},e.bubblePieSetting.filterAggregation=[];var i=[],n=[];e.tables.forEach((function(r,u){r.forEach((function(r,o){if(0===o)i=r.slice(0);else if(t[u][o]){for(var s,l,c,h,d={},p=[],g=new qt.default,f=new qt.default,m=0,x=r.length;m<x;m++){var y=e.getDateFormat(u,m),D=e.locales[u][m];if(i[m]===e.bubblePieSetting.axisX.title&&r[m])null===e.xValueType&&(e.xValueType=W.default.getAnyValueType(r[m],e.separator,e.worklog,!0,y,D)),null!==e.xValueType?(e.bubblePieSetting.axisX.dateFormat=y,s=W.default.parseAnyValueByType(e.xValueType,r[m],e.separator,e.worklog,!0,y,D),W.default.isNumber(s)&&e.xValueType===W.default.number&&(e.xValueFormatter=g.getFormatter(r[m],e.separator)),(void 0===e.bubblePieSetting.axisX.maxValue||e.bubblePieSetting.axisX.maxValue<s)&&(e.bubblePieSetting.axisX.maxValue=s),(void 0===e.bubblePieSetting.axisX.minValue||e.bubblePieSetting.axisX.minValue>s)&&(e.bubblePieSetting.axisX.minValue=s)):s=r[m],e.bubblePieSetting.axisX.order.includes(s)||e.bubblePieSetting.axisX.order.push(s);else if(i[m]===e.bubblePieSetting.axisY.title&&r[m])null===e.valueType&&(e.valueType=W.default.getAnyValueType(r[m],e.separator,e.worklog,!0,y,D)),n.push(r[m]),null!==e.valueType?(e.bubblePieSetting.axisY.dateFormat=y,l=W.default.parseAnyValueByType(e.valueType,r[m],e.separator,e.worklog,!0,y,D),W.default.isNumber(l)&&e.valueType===W.default.number&&(e.valueFormatter=f.getFormatter(r[m],e.separator)),(void 0===e.bubblePieSetting.axisY.maxValue||e.bubblePieSetting.axisY.maxValue<l)&&(e.bubblePieSetting.axisY.maxValue=l),(void 0===e.bubblePieSetting.axisY.minValue||e.bubblePieSetting.axisY.minValue>l)&&(e.bubblePieSetting.axisY.minValue=l)):l=r[m],e.bubblePieSetting.axisY.order.includes(l)||e.bubblePieSetting.axisY.order.push(l);else{if(!e.aggregation.includes(i[m])||!r[m])continue;null===e.bubblePieSetting.indicator.valueType&&(e.bubblePieSetting.indicator.valueType=W.default.getAnyValueType(r[m],e.separator,e.worklog,!0,y,D)),[W.default.number,W.default.worklog,W.default.duration].includes(e.bubblePieSetting.indicator.valueType)&&(h=W.default.getAnyValueType(r[m],e.separator,e.worklog,!0,y,D))===e.bubblePieSetting.indicator.valueType&&(c=W.default.parseAnyValueByType(h,r[m],e.separator,e.worklog,!0,y,D),e.bubblePieSetting.filterAggregation.includes(i[m])||e.bubblePieSetting.filterAggregation.push(i[m]),p.push({indicator:i[m],value:c>0?c:null}))}}p.length>0&&s&&l&&p.forEach((function(t){d[e.bubblePieSetting.axisX.title]=s,d[e.bubblePieSetting.axisY.title]=l,d.indicator=t.indicator,d.value=t.value,d.tableI=u,d.rowI=o,a.push(JSON.parse(JSON.stringify(d))),e.valueType!==W.default.number&&e.xValueType!==W.default.number&&e.valueType!==W.default.duration&&e.xValueType!==W.default.duration||(s=JSON.parse(JSON.stringify(s)),l=JSON.parse(JSON.stringify(l)),e.bubblePieSetting.sameValuesCount[s+"_"+l]>0?e.bubblePieSetting.sameValuesCount[s+"_"+l]+=1:e.bubblePieSetting.sameValuesCount[s+"_"+l]=1)}))}}))})),e.bubblePieSetting.filterAggregation.sort((function(t,a){return e.aggregation.indexOf(t)-e.aggregation.indexOf(a)})),e.bubblePieSetting.filterAggregation.length>0&&(e.pieKeys=e.bubblePieSetting.filterAggregation.slice(0)),e.visiblePieKeysLength=e.pieKeys.length,!e.colorKeyMap&&e.updateColorsKeyMap(e.colors),e.colors=e.getColorsFromMap(e.colorKeyMap,e.pieKeys,e.palette),e.colorsCache=e.colors.slice(),e.calcBubbleChartExtremum(),e.filterBubbleChartData(a);var r=function(t){return null==t||t!==W.default.date&&t!==W.default.worklog&&t!==W.default.number&&t!==W.default.duration};e.bubleMaxTextWidthX=ae.maxTextWidth,e.bubleMaxTextWidthY=ae.maxTextWidth;var u=e.getBubbleChartFormattedData(e.bubblePieSetting.axisY.order,e.valueType,e.bubblePieSetting.axisY.dateFormat,e.formatNumTo);e.bubblePieSetting.axisY.longestTitleObject=(0,et.findLongestText)(u);var o=e.bubblePieSetting.axisY.longestTitleObject.width;if(e.bubblePieSetting.axisY.longestTitle=(r(e.valueType)?Math.min(o,e.bubleMaxTextWidthY):o)+9,r(e.xValueType)){var s=e.getBubbleChartFormattedData(e.bubblePieSetting.axisX.order,e.xValueType,e.bubblePieSetting.axisX.dateFormat,e.formatNumToX);e.bubblePieSetting.axisX.longestTitleObject=(0,et.findLongestText)(s)}return a},ae.prototype.getBubbleChartFormattedData=function(t,e,a,i){if(e===W.default.date){this.workingDateFormat=a;var n=this.getTimeFormat(Math.max(t)-Math.min(t));return t.map((function(t){return n(t)}))}return null!==e?t.map((function(t){return i(t)})):t},ae.prototype.filterBubbleChartData=function(t){for(var e=this,a=e.bubblePieSetting.axisX.title,i=e.bubblePieSetting.axisY.title,n=e.bubblePieSetting.axisX.minValue,r=e.bubblePieSetting.axisX.maxValue,u=e.bubblePieSetting.axisY.minValue,o=e.bubblePieSetting.axisY.maxValue,s=t.length-1;s>=0;){var l=t[s][i],c=t[s][a],h=e.valueType===W.default.date?W.default.toDateObject(l):l,d=e.xValueType===W.default.date?W.default.toDateObject(c):c;r&&d>r||n&&d<n||o&&h>o||u&&h<u?t.splice(s,1):(e.valueType!==W.default.number&&e.valueType!==W.default.duration||(t[s]["orig_"+i]=l,t[s][i]=parseFloat(l/e.bubblePieSetting.sameValuesCount[c+"_"+l])),e.xValueType!==W.default.number&&e.xValueType!==W.default.duration||(t[s]["orig_"+a]=c,t[s][a]=parseFloat(c/e.bubblePieSetting.sameValuesCount[c+"_"+l]))),s-=1}},Object.assign(ae.prototype,{setValueType:function(t,e){if(t.isNumber()){var a=t.getValueType();2===arguments.length?null==this.valueType[e]&&(this.valueType[e]=a):null==this.valueType&&(this.valueType=a)}},setXValueType:function(t){null==this.xValueType&&(this.xValueType=t)},getCellValue:function(t,e,a){var i=t[e],n=a||{};return Object.assign(n,{separator:this.separator,worklog:this.worklog}),new Qt(i,n)},createKeyGenerator:function(t,e){return this.isSeries||this.isTime?e.length>1?t?function(t,e){return"".concat(t," = ").concat(e.name)}:function(t,e){return e.name}:function(t){return t}:!this.isRadar&&t?e.length>1?function(t,e){return"".concat(e.name," - ").concat(t)}:function(t){return t}:function(t,e){return e.name}},resetColorKeyMap:function(){delete this.colorKeyMap},getColumnsAndAggregations:function(){return this.isSeries||this.isTime?{columnHidden:this.aggregationHidden,aggregationHidden:this.columnHidden,columns:this.aggregation,aggregations:this.columns}:{columnHidden:this.columnHidden,aggregationHidden:this.aggregationHidden,columns:this.columns,aggregations:this.aggregation}}}),ae.prototype.calculate=function(){var t=this,e=[],a={},i=[],n=[];t.parsedDate=!1,t.ganttProgressPercentage=!1,t.textWidth=0,t.argumentWidth=0,t.aggregationWidth=0,t.valueType=t.isRadar?{}:null,t.xValueType=null,t.valueFormatter=t.isRadar?{}:null,t.xValueFormatter=null,t.chartKeys=[],t.setIsMultiColorColumn(),t.columnWidth=0;var r=W.default.getRelevantRows(t.rows,t.transpose);if(t.isBubblePie)return t.calculateBubblePieData(r);var u=t.isSeries||t.isTime,o=this.getColumnsAndAggregations(),s=o.columnHidden,l=o.aggregationHidden,c=o.columns,h=o.aggregations;if(c.forEach((function(e){a[e]=[],t.columnWidth=Math.max(t.columnWidth,(0,et.getTextWidth)(e))})),h.forEach((function(e){a[e]=[],t.aggregationWidth=Math.max(t.aggregationWidth,(0,et.getTextWidth)(e))})),t.tables.forEach((function(o,d){var p=c.map((function(t,e){return{name:t,index:e,position:s?u?1:0:W.default.getCellPosition(o,t)}})),g=h.map((function(t,e){return{name:t,index:e,position:l?u?0:1:W.default.getCellPosition(o,t)}})),f="columns"===t.barColoringType?t.colorColumns.map((function(t){return W.default.getCellPosition(o,t)})):[];if(p.length&&g.length){var m=[],x=!0,y=new qt.default,D=new qt.default,v=p.length>1,b=this.createKeyGenerator(v,g);o.forEach((function(o,s){if(function(t){return t>0&&r[d][t]}(s)){var l=f.map((function(t){return o[t]}));p.filter(me).some((function(r,c,h){var p=r.name;if(t.isGantt){var f=o[r.position],F={id:e.length,category:f,label:v>1?p:"",hint:f,rowNumber:ie({},d,s),colorFromColumns:l},C=0,A=-1===i.indexOf(f),E=t.textWidth;A&&(i.push(f),n.push(f),g.length>2&&(n.push(f+" - Done"),n.push(f+" - Todo")))}var _=t.getCellValue(o,r.position);if(g.filter(me).forEach((function(i){var n="".concat(r.index,"-").concat(i.index),c=t.getCellValue(o,i.position);if(t.isGantt){if(2===C)c.parseValueByType(),c.isNumber()&&(t.ganttProgressPercentage||(c.value>1||c.rawValue.indexOf("%")>0)&&(t.ganttProgressPercentage=!0),F.progress=c.value);else{if(c.isEmpty())return!0;var h={formats:t.getDateFormat(d,i.position),locales:t.locales[d][i.position]};try{c.parseValueWithType(W.default.date,h),t.parsedDate=!0,F.text=c.rawValue,0===C?F.startDate=c.value:F.endDate=c.value}catch(t){return AJS.log("Error while parsing date '"+c+"': "+t),!0}}C++}else{var g=b(p,i);a[g]||(a[g]=[]);var f=t.isRadar?_.value:g;if(-1===t.chartKeys.indexOf(f)&&t.chartKeys.push(f),t.isTime){if(c.isEmpty())return!0;if(_.parseValueByType(),!_.isNumber())return!0;t.setValueType(_),_.valueType===W.default.number&&(t.valueFormatter=D.getFormatter(_.rawValue,t.separator));var v={formats:t.getDateFormat(d,i.position),locales:t.locales[d][i.position]};try{c.parseValueWithType(W.default.date,v),t.parsedDate=!0}catch(t){return AJS.log("Error while parsing date '"+c+"': "+t),!0}}else if(t.isSeries){if(_.parseValueByType(),c.parseValueByType(),!_.isNumber()||!c.isNumber())return!0;t.setValueType(_),t.setXValueType(c.valueType),_.valueType===W.default.number&&(t.valueFormatter=D.getFormatter(_.rawValue,t.separator)),c.valueType===W.default.number&&(t.xValueFormatter=y.getFormatter(c.rawValue,t.separator))}else if(t.isRadar)c.parseValueByType(),t.setValueType(c,g),c.isNumber()?c.valueType===W.default.number&&(t.valueFormatter[g]=D.getFormatter(c.rawValue,t.separator)):c.setValue(0);else if(c.parseValueByType(),t.setValueType(c),x&&r.position===i.position&&(m[n]=isNaN(W.default.parseNumberQuietly(c.rawValue))),!m[n]){if(!c.isNumber())return!0;c.valueType===W.default.number&&(t.valueFormatter=D.getFormatter(c.rawValue,t.separator))}if(u)-1===a[g].indexOf(c.valueOf())?(e.push({label:_.value,value:c.value,key:g,aggregation:i.name,rowNumber:ie({},d,s)}),a[g].push(c.valueOf())):e.forEach((function(t){t.key===g&&t.value.valueOf()===c.valueOf()&&(t.label=W.default.addFloats(t.label,_.value),ie(t.rowNumber,d,s))}));else{var A=m[n]?1:c.value;-1===a[g].indexOf(_.value)?(e.push({label:_.value,value:A,key:p,aggregation:g,rowNumber:ie({},d,s),colorFromColumns:l}),a[g].push(_.value)):e.forEach((function(t){t.aggregation===g&&t.label===_.value&&(t.value=W.default.addFloats(t.value,A),ie(t.rowNumber,d,s))}))}}u||(t.textWidth=Math.max(t.textWidth,Math.min(_.getTextWidth(),ae.maxTextWidth)))})),t.isGantt){if(F.startDate){var w;for(e.push(F),F.endDate||(F.label=null),w=c+1;w<h.length;w++){var B=o[h[w].position];if(B){if(F.label)F.label+=": ";else if(!A){var k=F.category+": "+B;n.push(k)}F.label=(F.label||"")+B,F.hint=(F.hint?F.hint+" - ":"")+B,c=w;break}}for(w=c+1;w<h.length;w++){var S=o[h[w].position];S&&(F.hint=(F.hint?F.hint+" - ":"")+S)}if(!F.endDate&&!F.label&&!A){var T=F.category+": milestone";-1===n.indexOf(T)&&n.push(T)}}return!A||F.endDate&&F.startDate||(i.splice(-1,1),t.textWidth=E),!A||F.endDate||F.startDate||n.splice(-1,1),!(A&&g.length>2)||void 0!==F.progress&&F.startDate&&F.endDate||(n.splice(-1,1),n.splice(-1,1)),!0}})),x=!1}}))}}),this),u&&e.sort((function(t,e){return t.value>e.value?1:-1})),this.ganttCatColors=n,this.ganttCategories=i,t.isGantt&&"mono"===t.barColoringType)t.ganttCatColors=Q;else if(!t.multiple||t.isGantt||t.isMultiColorColumn){var d=[];t.isGantt?d=t.ganttCatColors:$.each(a,(function(t,e){e.forEach((function(t){-1===d.indexOf(t)&&d.push(t)}))})),d&&(t.visiblePieKeysLength=d.length,t.pieKeys=d.concat(t.pieKeys.filter((function(t){return-1===d.indexOf(t)}))))}else t.columns.forEach((function(e){var a=t.chartKeys.indexOf(e);a>=0&&t.chartKeys.push(t.chartKeys.splice(a,1)[0]),t.aggregation.forEach((function(a){var i=t.chartKeys.indexOf(a);i>=0&&t.chartKeys.push(t.chartKeys.splice(i,1)[0]);var n=a+" - "+e,r=t.chartKeys.indexOf(n);r>=0&&t.chartKeys.push(t.chartKeys.splice(r,1)[0])}))}));var p=t.getAllChartColorLabels();return!t.colorKeyMap&&t.updateColorsKeyMap(t.colors),t.colors=t.getColorsFromMap(t.colorKeyMap,p,t.palette),t.colorsCache=t.colors.slice(),e},ae.prototype.getColorsData=function(){return{pieKeys:this.pieKeys,colors:this.colors,chartKeys:this.chartKeys}},ae.prototype.draw=function(t){var e=this;e.preventExport=t,e.clearTableHighlight(),e.svgWrapper.css({height:"",width:""}),e.svgWrapper.html(""),e.png.html(""),$("body").find("div.d3-tip.chart"+e.macroId+e.pageId).remove();var a=W.default.hasLoadingContent(e.chartBody)||W.default.hasAnyTFACUnfinishedContent(e.originalTable,e.chartBody);if(0===e.originalTable.length||a)e.isEditor&&e.isCloud&&!e.chartBody.data("hasFrame")?(e.previewTutorial.show(),e.loader.hide(),e.wrapper.hide()):(e.previewTutorial.hide(),e.badSettings.hide(),e.logZeroMessage.hide(),e.chartBody.data("hasFrame")||a?(e.noTableMessage.hide(),e.loader.show()):(e.noTableMessage.show(),e.loader.hide()));else{if(clearTimeout(e.timeoutDatePicker),!e.isTime&&!e.isGantt||$.datepicker){e.logZeroMessage.hide(),e.noTableMessage.hide(),e.previewTutorial.hide(),e.badSettings.hide(),e.wrongDateFormat.hide(),e.noDataMessage.hide(),e.customMessage.hide();var i=e.calculate();return e.calculatedData=i,0===i.length?(0===e.columns.length||0===e.aggregation.length?e.badSettings.show():!e.isTime&&!e.isGantt||e.parsedDate?e.noDataMessage.show():(e.wrongDateFormat.show(),e.dateFormatInput.hasClass("autocomplete")||(W.default.dateFormatAutocomplete(e.dateFormatInput),e.dateFormatInput.addClass("autocomplete"))),e.loader.hide(),e.selectColors.hide(),e.setInterpolationBtn.hide(),e.changeLineSettingsBtn.hide(),e.download.hasClass("tf-disabled-link")||e.download.toggleClass("tf-disabled-link"),void e.controls.animate({opacity:1},100)):(e.loader.hide(),e.selectColors.show(),e.shiftInterpolationBtn(),e.shiftChangeLineSettingsBtn(),e.download.hasClass("tf-disabled-link")&&e.download.toggleClass("tf-disabled-link"),e.controls.css("opacity",""),e.drawChart(i),!0)}e.timeoutDatePicker=setTimeout((function(){e.draw()}),100)}},ae.prototype.drawChart=function(t){var e=this;if(clearTimeout(e.chartTimer),e.content.is(":visible")){if("Donut"!==e.type||e.is3D)if(e.type.indexOf("Column")>=0)e.drawColumn(t);else if("Pie"!==e.type||e.is3D)if(e.type.indexOf("Bar")>=0)e.drawBar(t);else if(-1!==e.type.indexOf("Area")||-1!==e.type.indexOf("Line"))e.drawSeries(t);else if("Donut"===e.type&&e.is3D)e.drawDonut3D(t,.4);else if("Pie"===e.type&&e.is3D)e.drawDonut3D(t,0);else if(e.isGantt){if(1===e.aggregation.length)return void e.customMessage.show().find(".text").text("Gantt chart requires projects to have start and end dates. Please select start and end date columns.");e.drawGantt(t)}else e.isBubblePie?e.drawBubblePie(t):e.isRadar&&e.drawRadar(t);else e.drawPie(t,0);else e.drawPie(t,"40%");e.isLog&&e.multiple&&e.svgWrapper.find('[y="NaN"], [x="NaN"], [d*="NaN"]').length&&(e.logZeroMessage.show(),e.svgWrapper.html("")),(e.is3D||"Donut"!==e.type&&"Pie"!==e.type)&&setTimeout((function(){e.convertToImage()}),100)}else e.chartTimer=setTimeout((function(){e.drawChart(t)}),200)},ae.prototype.drawBubblePie=function(t){var e=this,a=s().newSvg(e.svgWrapper[0],e.width,e.height),i=new(s().chart)(a,t),n=e.setBubbleAxisX(i),r=e.setBubbleAxisY(i);e.bubblePieSetting.filterAggregation.map((function(t){i.assignColor(t,e.colorKeyMap[t],e.colorKeyMap[t],1)})),e.setBubbleAxisXScale(n),e.setBubbleAxisYScale(r),e.settingBubbleAxis(n,r),i.addMeasureAxis("p","value"),i.addMeasureAxis("z","value");var u=i.addSeries([e.bubblePieSetting.axisX.title,e.bubblePieSetting.axisY.title,"indicator"],s().plot.pie);null===e.xValueType&&n.addOrderRule(e.bubblePieSetting.axisX.order),null===e.valueType&&r.addOrderRule(e.bubblePieSetting.axisY.order),u.addOrderRule(e.bubblePieSetting.filterAggregation),u.tooltipFontSize="14px",e.calculateBubbleLegendSize();var o,l={top:20+e.titleHeight,right:20+(e.isLegendUnderGraph||!e.legend?0:10+e.bubblePieSetting.legendWidth),bottom:40+e.xtitleHeight+(e.isLegendUnderGraph?5+e.bubblePieSetting.legendHeight+(e.xtitleHeight?10:0):5),left:25+e.bubblePieSetting.axisY.longestTitle+e.ytitleHeight};i.setBounds(l.left,l.top,e.width-l.left-l.right,e.height-l.top-l.bottom),i.draw(),e.formatExtremumAxesX(n,u,l,i),i.draw(),e.maxSizeX=(o=0,n.shapes.selectAll("text").each((function(){o=Math.max(de($(this)),o)})),o);var c,h=function(){l={top:20+e.titleHeight,right:20+(e.isLegendUnderGraph||!e.legend?0:10+e.bubblePieSetting.legendWidth),bottom:40+e.maxSizeX+e.xtitleHeight+(e.isLegendUnderGraph?5+e.bubblePieSetting.legendHeight+(e.xtitleHeight?10:0):5),left:25+e.bubblePieSetting.axisY.longestTitle+e.ytitleHeight}};h(),e.optimizeBubbleMultilineWidth(l,n,r,h),e.addTitle(a,e.width+l.left-l.right,{top:0}),e.calculateBubbleLegendSize(),e.legend&&((c=i.addLegend(e.isLegendUnderGraph?l.left+e.bubblePieSetting.posX:e.width-l.right+10,e.isLegendUnderGraph?e.height-e.bubblePieSetting.legendHeight-20+(e.xtitleHeight?5:0):l.top,e.bubblePieSetting.legendWidth||e.width-l.left,e.bubblePieSetting.legendHeight,"left"))._getEntries=function(){var t=[];return ut(e.bubblePieSetting.filterAggregation,e.isPivot).values.forEach((function(e){t.push({key:e.view,fill:i.getColor(e.key).fill,stroke:i.getColor(e.key).stroke,opacity:i.getColor(e.key).opacity,series:u,aggField:[e.key]})}),this),t}),i.setBounds(l.left,l.top,e.width-l.left-l.right,e.height-l.top-l.bottom),i.draw(),e.formatExtremumAxesY(r,u,l,i),i.draw(),e.settingSeriesTooltip(u),e.eventHandlerSeries(u,t),e.formatDimpleAxisX(n),e.legend&&(e.formatBubbleLegend(c),e.eventHandleLegendClick(i,c,t,(function(){return e.formatDimpleAxisX(n)}))),u.shapes.style("opacity",(function(t){return null===t.angle?0:1}))},ae.prototype.drawPie=function(t,e){var a=this,i=a.calcGroupSize(a.chartKeys.length);a.addGroupTitle();var n=r.default.scaleOrdinal().range(a.colors);n.domain(a.pieKeys);var u=0,o=[];a.chartKeys.forEach((function(r){var s=$.grep(t,(function(t){return t.aggregation==r})),l=s,c=re(s);if(c.count>1&&(s=c.data),s.length){var h=[];l.forEach((function(t){-1==$.inArray(t,s)||!t.value&&0!==t.value||h.push(n(t.label))})),h.push("#a3acb2");var d={};(a.title||a.chartKeys.length>1)&&(d={title:{text:a.chartKeys.length>1?r:a.title,color:"#333333",fontSize:16,font:"arial"},location:"top-center"}),s.forEach((function(t,e){t.color=t.colorFromColumns&&t.colorFromColumns[0]||h[e%h.length],t.contrastColor=it(t.color)}));var p=new w(a.svgWrapper[0],{header:d,data:{content:s},size:{canvasHeight:i.height,canvasWidth:i.width,pieInnerRadius:e},labels:{mainLabel:{fontSize:14},percentage:{color:function(t,e){return t.contrastColor},decimalPlaces:1,fontSize:14},value:{color:function(t,e){return t.contrastColor},fontSize:14},inner:{format:a.innerLabelsType.value_percentage?"value-percentage":a.innerLabelsType.percentage_value?"percentage-value":a.innerLabelsType.value?"value":a.showInnerLabels?"percentage":"none",hideWhenLessThanPercentage:4},outer:{format:"None"!==a.outerLabels?"label":"none"},formatter:function(t){var e=t.label;return"inner"===t.section&&("percentage"===t.part?e+="%":"value"===t.part&&(e=a.formatNumTo(t.value))),e}},tooltips:{enabled:!0,type:"placeholder",string:"{label}: {value} ({percentage}%)",placeholderParser:function(t,e){e.value=a.formatNumTo(e.value)},styles:{color:"white",backgroundColor:"black",backgroundOpacity:.8,padding:12,fontSize:14}},callbacks:{onload:function(){var t=$(p.svg._groups[0]),e=t.find('[class$="_segmentMainLabel-outer"]').css({fill:"#333","font-size":"14px","font-weight":"normal"});c.count>1&&e.last().css("font-style","italic"),u++,function(t,e){var a=le(t);e.each((function(){var t=$(this),e=le(t),i=parseFloat(t.attr("y"))||0;if(e.left<a.left||e.right>a.right){var n=e.width,r=Math.max(e.left,a.left),u=Math.min(e.right,a.right)-r,o=n-u;if(e.left<a.left){var s=parseFloat(t.attr("x"))||0;s+=o,t.attr("x",s)}var l=t.text(),c=Math.floor(l.length*u/n);if(c>0)for(var h=[];l.length>c;){t.text(l.substring(0,c)),l=l.substring(c);var d=t.clone();i+=7,d.text(l).attr("y",i),t.after(d),h.push(t),t=d,h.forEach((function(t){t.attr("y",(t.attr("y")||0)-7)}))}}}))}(t,e);var i=t.find('[class$="_segmentPercentage-inner"],[class$="_segmentValue-inner"]'),n=t.find('g[class$="_arc"]'),r=i.length/n.length;i.each((function(t){pe(n.eq(parseInt(t/r)),$(this))})),u===a.chartKeys.length&&a.convertToImage()},onClickSegment:function(t){a.clearTableHighlight(),t.expanded||a.highlightTable({rowNumber:t.data.rowNumber,column:t.data.aggregation.replace(" - "+t.data.key,"")}),o.forEach((function(e){if(p!==e){var i=e.getOpenSegment();i&&a.highlightTable({rowNumber:i.data.rowNumber,column:i.data.aggregation.replace(" - "+t.data.key,"")})}}))}},misc:{colors:{segments:h},canvasPadding:{top:20,right:20,bottom:20,left:20}}});o.push(p)}else++u===a.chartKeys.length&&a.convertToImage()}))},ae.prototype.drawDonut3D=function(t,e){var a=this,i=a.calcGroupSize(a.chartKeys.length),n=a.chartKeys.length>1?20:a.titleHeight,o=Math.min(i.width,i.height-n)/2;a.addGroupTitle();var s=r.default.scaleOrdinal().range(a.colors);s.domain(a.pieKeys);var l=[];a.hideTips=function(){for(var t=0;t<l.length;t++)l[t].hide()},a.chartKeys.forEach((function(c,h){var d=$.grep(t,(function(t){return t.aggregation===c})),p=d,g=re(d);g.count>1&&(d=g.data);var f=[];p.forEach((function(t){-1!==$.inArray(t,d)&&f.push(s(t.label))})),f.push("#a3acb2");var m=a.chart.append("svg").attr("width",i.width).attr("height",i.height);m.append("g").attr("id","donut3d"+a.macroId+a.pageId+h);var x=r.default.scaleOrdinal().range(f),y=d.map((function(t){var e=t.colorFromColumns&&t.colorFromColumns[0]||x(t.label);return{label:t.label,value:t.value,color:e,textColor:it(e),other:t.other,rowNumber:t.rowNumber,name:c}}));O.draw("donut3d"+a.macroId+a.pageId+h,y,i.width/2,i.height/2,o,.7*o,.2*o,e,a.showInnerLabels,a.innerLabelsType,a.formatNumTo,"None"!==a.outerLabels);var D,v=(0,u.default)().attr("class","d3-tip chart"+a.macroId+a.pageId).offset([-5,0]).html((function(t){var e=W.default.escapeString(t.data.label+": "+a.formatNumTo(t.value)+" ("+O.getPercent(t)+")");return t.data.other&&g.smallData.forEach((function(t){e+="<br>"+W.default.escapeString(t.label+": "+a.formatNumTo(t.value)+" ("+t.percent+"%)")})),e}));l.push(v),a.chartKeys.length>1?a.addTitle(m,i.width,{top:0},{title:c,titleHeight:n}):a.addTitle(m,i.width,{top:0}),m.call(v),m.selectAll(".topSlice, .percent").on("mouseover",(function(t,e){clearTimeout(D);var a=null,i=b.find(".percent").each((function(t,i){if(i.textContent===e.data.label)return a=i,!1}));a=a||i[e.index],v.show(e,a),a.__data__.data.other?v.style("font-style","italic"):v.style("font-style","normal")})).on("mouseout",(function(){D=setTimeout((function(){D=null,a.tipHover||v.hide()}),50)})),a.bindElementSelect(m,".topSlice",(function(t){return{rowNumber:t.__data__.data.rowNumber,column:a.getColumnNameForHighlight(t.__data__.data.name)}})),g.count>1&&a.svgWrapper.find("#donut3d"+a.macroId+a.pageId+h+".percent").last().css("font-style","italic");var b=$(m._groups[0]),F=b.find(".percent"),C=b.find(".topSlice");F.each((function(t){var e=$(this),a=C.eq(t%C.length);pe(a,e),function(t,e){var a=ce(t);if(0===a.height)return;e.each((function(){for(var t=$(this),e=ce(t),i=parseInt(t.css("font-size")),n=parseFloat(t.attr("y"))||0,r=parseFloat(t.attr("x"))||0;(e.top<a.top||e.bottom>a.bottom)&&i>0;){var u=he(t);t.css("font-size",i--);var o=e.height;(e=ce(t)).top<a.top&&e.bottom<=a.bottom?(n=n+o-de(t),t.attr("y",n),r+=(u-he(t))/2,t.attr("x",r)):e.bottom>a.bottom&&e.top>=a.top&&(n=n-o+de(t),t.attr("y",n),r-=(u-he(t))/2,t.attr("x",r))}}))}(a,e)}))}))},ae.prototype.drawColumn=function(t){var e=this,a=0,i=e.type.indexOf("Stacked")>=0,n=e.convertData(t),o=e.isLog?r.default.scaleLog():r.default.scaleLinear(),s=r.default.axisLeft(o);e.isLog||s.tickFormat(e.formatNumTo);var l=r.default.min(i&&!e.isLog?n:t,(function(t){return i&&!e.isLog?t.min:t.value})),c=r.default.max(i?n:t,(function(t){return i?t.total:t.value}));e.isLog&&0==e.minvalue&&(e.minvalue=Number.MIN_VALUE,c<0&&(e.minvalue*=-1)),e.isLog&&(l=Math.pow(10,Math.floor(Math.log(l)/Math.LN10))),o.domain([isNaN(e.minvalue)?e.isLog?l:Math.min(0,l):e.minvalue,isNaN(e.maxvalue)?Math.max(c,0):e.maxvalue]),isNaN(e.scaleStep)||s.tickValues(ct(o.domain(),e.scaleStep));var h=e.chart.append("svg"),d=h.append("g");e.argumentWidth=at(o,s);var p=n.length*r.default.max(n,(function(t){return t.values.length})),g=lt(i?e.chartKeys.slice().reverse():e.chartKeys.slice(),Math.min(e.width,e.argumentWidth+20+e.ytitleHeight+20+200*p)-(e.argumentWidth+20+e.ytitleHeight)-20,e.isPivot,e.isLegendUnderGraph),f={top:20+e.titleHeight+(e.titleHeight&&e.is3D?10:0),right:e.legend&&!e.isLegendUnderGraph&&e.chartKeys.length>1?25+g.maxWidth:20,bottom:20+1.5*e.xtitleHeight+(e.isLegendUnderGraph?20*(g.rows+1)+10:0),left:e.argumentWidth+20+e.ytitleHeight},m=Math.min(e.width,f.left+f.right+200*p)-f.left-f.right,x=e.height-f.top-f.bottom;h.attr("width",m+f.left+f.right).attr("height",e.height),d.attr("transform","translate("+f.left+","+f.top+")");var y=r.default.scaleBand().rangeRound([0,m]).padding(.1),D=r.default.scaleBand();o.range([x,0]);var v=r.default.scaleOrdinal().range(e.colors),b=r.default.axisBottom(y),F=(0,u.default)().attr("class","d3-tip chart"+e.macroId+e.pageId).offset([-5,0]).html((function(t){return W.default.escapeString(t.name+" ("+e.formatNumTo(t.value)+")")}));e.addTitle(d,m,f),d.call(F),v.domain(e.isMultiColorColumn?e.pieKeys:e.chartKeys);var C=function(t){return t.colorFromColumn||v(e.isMultiColorColumn?t.label:t.name)};y.domain(n.map((function(t){return t.label}))),D.domain(e.chartKeys).rangeRound([0,y.bandwidth()]);var A=isNaN(e.minvalue)?e.isLog?l:0:Math.max(0,e.minvalue);if(A=isNaN(e.maxvalue)?A:Math.min(e.maxvalue,A),e.xtitle)var E=d.append("text").attr("x",m/2).attr("y",x+f.bottom-10).attr("class","axis-title").style("text-anchor","middle").style("font-weight","bold").text(e.xtitle);if(e.ytitle)var _=d.append("text").attr("transform","rotate(-90)").attr("y",15-f.left).attr("class","axis-title").attr("x",-x/2).style("text-anchor","middle").style("font-weight","bold").text(e.ytitle);var w,B=d.selectAll(".bar").data(n).enter().append("g").attr("class","g").attr("label",(function(t){return t.label})).attr("transform",(function(t){return"translate("+y(t.label)+",0)"}));e.hideTips=function(){F.hide()};var k=B.selectAll("rect").data((function(t){return t.values})).enter(),S=function(t){return ht(t.value,o.domain()[0],o.domain()[1])},T=function(t){return i?0:D(t.name)},P=function(t){if(i)return o(ht(t.y1,o.domain()[0],o.domain()[1]));var e=S(t);return o(e)-o(Math.min(A,e))+o(A)},L=function(t){if(i)return o(ht(t.y0,o.domain()[0],o.domain()[1]))-P(t);var e=S(t);return Math.abs(o(e)-o(A))},M=i?y.bandwidth():D.bandwidth();if(e.addBarTrendLine(d,i,t,n,y,o,C,M),e.is3D){M=parseInt(.8*M);var I=parseInt(M/4),V=function(t){if(!t.value)return ge([[0,0]]);var e=T(t)+M,a=P(t),i=a+L(t);return ge([[e,parseInt(a)],[e+I,a-20],[e+I,i-20],[e,i]])},O=function(t){if(!t.value)return ge([[0,0]]);var e=T(t),a=e+M,i=Math.ceil(P(t));return ge([[e,i],[e+I,i-20],[a+I,i-20],[a,i]])};k.append("path").attr("class","bar-top").attr("key",(function(t){return t.name})).attr("d",O).style("fill",(function(t){return oe(C(t))})),k.append("path").attr("class","bar-right").attr("key",(function(t){return t.name})).attr("d",V).style("fill",(function(t){return oe(C(t))}))}if(k.append("rect").attr("class",e.is3D?"bar 3d":"bar").attr("width",M).attr("x",T).attr("y",P).attr("height",L).attr("key",(function(t){return t.name})).style("fill",(function(t){return C(t)})),!e.isLog)var N=d.append("g").attr("class","y axis").append("line").attr("y1",o(A)).attr("y2",o(A)).attr("x2",m);d.append("g").attr("class","x axis").attr("transform","translate(0,"+x+")").call(b).selectAll("text"),d.append("g").attr("class","y axis").call(s).append("text").attr("transform","rotate(-90)").attr("y",6).attr("dy",".71em").style("text-anchor","end");var z,G,H=!0,R=function(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return t.each((function(t){t.barY=P(e||t),t.barHeight=L(e||t)})).style("font-size",(function(t){return M<12||i&&t.rotatedInnerTextHeight>t.barHeight-5?0:14})),a&&(t=t.transition().duration(a)),t.attr("y",(function(t){return t.rotatedInnerTextHeight>t.barHeight-5?t.pivotY=i?0:t.barY-5:t.pivotY=t.barY+t.barHeight/2+(H?7:t.innerTextWidth/2),t.pivotY})).attr("x",(function(t){return t.pivotX=i?y.bandwidth()/2:D(t.name)+D.bandwidth()/2,t.pivotX})).style("fill",(function(t){return t.rotatedInnerTextHeight>t.barHeight-5?"black":it(C(t))})),H?t.style("text-anchor","middle"):t.attr("transform",(function(t){return"rotate(-90, ".concat(t.pivotX,", ").concat(t.pivotY,")")})),t};if(e.showInnerLabels){var X=function(a,r,u){return e.formatBarInnerLabel((function(){return ue(a,t,n)}),(function(){return se(a.value,$(u).parent().find(".bar").eq(r),x,i,!1,e.formatNumTo)}))};k.append("text").attr("class","inner-value-label").attr("key",(function(t,e){return t.innerTextWidth=(0,et.getTextWidth)(X(t,e,this)),H=H&&t.innerTextWidth<M-5,t.rotatedInnerTextHeight=H?14:t.innerTextWidth,t.name})).attr("dy",H?".0em":".35em").text((function(t,e){return X(t,e,this)})).call(R)}d.selectAll(".bar, .inner-value-label").on("mouseover",(function(t,a){clearTimeout(w);var i=$(this);i.is(".inner-value-label")&&(i=i.parent().find(".bar[key]").filterByAttr("key",a.name));var n=a;if(!a.name&&a.values){var r=this.getAttribute("key");n=$.grep(a.values,(function(t){return t.name===r}))[0]}var u=i.offset();u.top>42?(F.direction("n"),F.offset([-5,0])):u.left>e.width/2?(F.direction("w"),F.offset([0,-6])):(F.direction("e"),F.offset([0,6])),F.show(n,i[0])})).on("mouseout",(function(){w=setTimeout((function(){w=null,e.tipHover||e.hideTips()}),50)})),e.bindElementSelect(d,".bar");var Y=function(t){var a=(0,et.findLongestText)(y.domain()),i=y.bandwidth();z=a.width>i&&i<ae.minHorizontalTextWidth,e.textWidth=z?ae.calcTextMaxWidth(i,a,ae.maxTextWidth):i,G!=e.textWidth&&(G=e.textWidth,b.tickFormat(ae.formatedMultiline(e.textWidth)),t&&d.selectAll(".x.axis").call(b).selectAll)};Y(!0);var j,K,U,J=parseFloat(e.svgWrapper.find("svg").attr("height")),q=function(t){var i=d.selectAll("g.x.axis text");if(z)j="end",U="middle",a=e.textWidth+10,K="translate(-14, 7) rotate(-90)",h.transition().duration(t).attr("height",J+e.textWidth),e.xtitle&&E.transition().duration(t).attr("y",x+f.bottom-15+e.textWidth-(e.isLegendUnderGraph?20*(g.rows+1)+10:0));else{j="middle",U="top";var n=(a=Math.max(22,ae.getMultilineHeight(i)+10))-22;K="translate(0, 0)",h.transition().duration(t).attr("height",J+n),e.xtitle&&E.transition().duration(t).attr("y",x+f.bottom-15+n-(e.isLegendUnderGraph?20*(g.rows+1)+5:0))}i.transition().duration(t).attr("transform",K).style("text-anchor",j).call(ae.multilineAlign,U)};q(0);if(e.legend&&e.chartKeys.length>1){var Z=e.chartKeys.slice();e.addLegend(d,m,x+e.xtitleHeight+a,f.top,"columns"!==e.barColoringType&&v,i?Z.reverse():Z,e.isLegendUnderGraph,(function(a,n){var u=[];t.forEach((function(t){t.aggregation==a&&(t.hidden=!n),t.hidden||-1!=$.inArray(t.aggregation,u)||u.push(t.aggregation)}));var p=$.grep(t,(function(t){return!t.hidden}));if(p.length){var g=e.convertData(p);y.domain(g.map((function(t){return t.label}))),Y(),D.domain(u).rangeRound([0,y.bandwidth()]),l=e.isLog?l:r.default.min(i?g:p,(function(t){return i?t.min:t.value})),c=r.default.max(i?g:p,(function(t){return i?t.total:t.value})),o.domain([isNaN(e.minvalue)?e.isLog?l:Math.min(0,l):e.minvalue,isNaN(e.maxvalue)?Math.max(c,0):e.maxvalue]),M=i?y.bandwidth():D.bandwidth(),e.is3D&&(M*=.8,I=parseInt(M/4)),isNaN(e.scaleStep)||s.tickValues(ct(o.domain(),e.scaleStep)),g.forEach((function(t){var a=d.selectAll("[label]").filterByAttr("label",t.label),i=function(){a.transition().duration(300).attr("transform",(function(t){return"translate("+y(t.label)+",0)"}))};n||i(),t.values.forEach((function(t){var i=P(t),n=L(t);a.selectAll(".bar[key]").filterByAttr("key",t.name).transition().duration(300).attr("width",M).attr("x",T(t)).attr("y",i).attr("height",n),e.is3D&&(a.selectAll(".bar-right[key]").filterByAttr("key",t.name).transition().duration(300).attr("d",V(t)),a.selectAll(".bar-top[key]").filterByAttr("key",t.name).transition().duration(300).attr("d",O(t))),e.showInnerLabels&&a.selectAll("text[key]").filterByAttr("key",t.name).call(R,t,300)})),n&&i()})),d.selectAll(".x.axis").transition().duration(300).on("start",(function(){q(300)})).call(b).selectAll(".x.axis text").style("text-anchor",j).attr("transform",K),d.selectAll(".y.axis").transition().duration(300).on("start",(function(){f.left-=e.argumentWidth,e.argumentWidth=at(o,s),f.left+=e.argumentWidth,h.transition().duration(300).attr("width",m+f.left+f.right),d.transition().duration(300).attr("transform","translate("+f.left+","+f.top+")"),e.ytitle&&_.transition().duration(300).attr("y",15-f.left)})).call(s),e.isLog||N.transition().duration(300).attr("y1",o(A)).attr("y2",o(A)),setTimeout((function(){e.convertToImage({noExport:!0})}),400)}}))}},ae.prototype.drawBar=function(t){var e=this,a=e.type.indexOf("Stacked")>=0,i=e.convertData(t),n=e.isLog?r.default.scaleLog():r.default.scaleLinear(),o=r.default.axisTop(n);e.isLog||o.tickFormat(e.formatNumTo);var s=r.default.min(a&&!e.isLog?i:t,(function(t){return a&&!e.isLog?t.min:t.value})),l=r.default.max(a?i:t,(function(t){return a?t.total:t.value}));e.isLog&&0==e.minvalue&&(e.minvalue=Number.MIN_VALUE,l<0&&(e.minvalue*=-1)),e.isLog&&(s=Math.pow(10,Math.floor(Math.log(s)/Math.LN10))),n.domain([isNaN(e.minvalue)?e.isLog?s:Math.min(0,s):e.minvalue,isNaN(e.maxvalue)?Math.max(l,0):e.maxvalue]),isNaN(e.scaleStep)||o.tickValues(ct(n.domain(),e.scaleStep));var c=e.chart.append("svg"),h=c.append("g");e.argumentWidth=at(n,o);var d,p,g,f,m=e.is3D?20:0,x=function(){d=lt(e.chartKeys.slice(),e.width-(e.textWidth+10+e.ytitleHeight)-40,e.isPivot,e.isLegendUnderGraph),p={top:e.argumentWidth+30+e.titleHeight+e.xtitleHeight,right:m+(e.legend&&!e.isLegendUnderGraph&&e.chartKeys.length>1?25+d.maxWidth:40),bottom:10+(e.isLegendUnderGraph?20*(d.rows+1)+10:0),left:e.textWidth+10+e.ytitleHeight},g=e.width-p.left-p.right,f=e.height-p.top-p.bottom},y=i.map((function(t){return t.label}));x();var D=(0,et.findLongestText)(y),v=ae.calcTextMaxWidth(f/y.length,D,ae.maxTextWidth);e.textWidth<v&&(e.textWidth=v,x()),n.range([0,g]);var b=r.default.scaleBand().rangeRound([0,f]).padding(.2),F=r.default.scaleBand(),C=r.default.scaleOrdinal().range(e.colors),A=r.default.axisLeft(b).tickFormat(ae.formatedMultiline(e.textWidth)),E=(0,u.default)().attr("class","d3-tip chart"+e.macroId+e.pageId).offset([-5,0]).html((function(t){return W.default.escapeString(t.name+" ("+e.formatNumTo(t.value)+")")}));c.attr("width",e.width).attr("height",e.height),h.attr("transform","translate("+p.left+","+p.top+")");var _=e.addTitle(h,g,p);h.call(E),C.domain(e.isMultiColorColumn?e.pieKeys:e.chartKeys);var w=function(t){return t.colorFromColumn||C(e.isMultiColorColumn?t.label:t.name)};if(b.domain(y),F.domain(e.chartKeys).rangeRound([0,b.bandwidth()]),e.xtitle)var B=h.append("text").attr("x",g/2).attr("y",e.titleHeight+20-p.top).attr("class","axis-title").style("text-anchor","middle").style("font-weight","bold").text(e.xtitle);e.ytitle&&h.append("text").attr("transform","rotate(-90)").attr("y",15-p.left).attr("class","axis-title").attr("x",-f/2).style("text-anchor","middle").style("font-weight","bold").text(e.ytitle);var k=isNaN(e.minvalue)?e.isLog?s:0:Math.max(0,e.minvalue);k=isNaN(e.maxvalue)?k:Math.min(k,e.maxvalue);var S,T=h.selectAll(".bar").data(i).enter().append("g").attr("class","g").attr("label",(function(t){return t.label})).attr("transform",(function(t){return"translate(0,"+b(t.label)+")"}));e.hideTips=function(){E.hide()};var P,L,M=T.selectAll("rect").data((function(t){return t.values})).enter(),I=function(t){return n(a?ht(t.y0,n.domain()[0],n.domain()[1]):Math.min(k,ht(t.value,n.domain()[0],n.domain()[1])))},V=function(t){return a?0:F(t.name)},O=function(t){return a?n(ht(t.y1,n.domain()[0],n.domain()[1]))-I(t):Math.abs(n(ht(t.value,n.domain()[0],n.domain()[1]))-n(k))},N=a?b.bandwidth():F.bandwidth();if(e.addBarTrendLine(h,a,t,i,b,n,w,N,!0),e.is3D){N=parseInt(.8*N);var z=parseInt(N/4),G=function(t){if(!t.value)return ge([[0,0]]);var e=I(t),a=e+O(t),i=V(t)+N;return ge([[e,i],[a,i],[a+m,i+z],[e+m,i+z]])},H=function(t){if(!t.value)return ge([[0,0]]);var e=I(t)+O(t),a=V(t),i=a+N;return ge([[e,a],[e+m,a+z],[e+m,i+z],[e,i]])};M.append("path").attr("class","bar-right").attr("key",(function(t){return t.name})).attr("d",H).style("fill",(function(t){return oe(w(t))})),M.append("path").attr("class","bar-bottom").attr("key",(function(t){return t.name})).attr("d",G).style("fill",(function(t){return oe(w(t))}))}if(M.append("rect").attr("class","bar").attr("width",O).attr("x",I).attr("y",V).attr("height",N).attr("key",(function(t){return t.name})).style("fill",(function(t){return w(t)})),e.showInnerLabels){var R=function(n,r){return e.formatBarInnerLabel((function(){return ue(n,t,i)}),(function(){return se(n.value,r,g,a,!0,e.formatNumTo)}))};M.append("text").attr("class","inner-value-label").attr("key",(function(t){return t.name})).attr("x",(function(t,e){var i=$(this).parent().find(".bar").eq(e),r=(0,et.getTextWidth)(R(t,i)),u=he(i);return n(ht(a?Math.min(t.y0,t.y1):Math.min(t.value,k),n.domain()[0],n.domain()[1]))+(r>u-5?u+5:(u-r)/2)})).attr("y",(function(t){return a?b.bandwidth()/2:F(t.name)+F.bandwidth()/2})).attr("dy",".35em").text((function(t,e){return R(t,$(this).parent().find(".bar").eq(e))})).style("font-size",(function(t,e){var i=$(this).parent().find(".bar").eq(e),n=(0,et.getTextWidth)(R(t,i)),r=he(i);return(a?b.bandwidth()<14||n>r-5:F.bandwidth()<14)?0:14})).style("fill",(function(t){return it(w(t))}))}h.selectAll(".bar, .inner-value-label").on("mouseover",(function(t,e){S&&(clearTimeout(S),S=null);var a=$(this);a.is(".inner-value-label")&&(a=a.parent().find(".bar[key]").filterByAttr("key",e.name));var i=e;if(!e.name){var n=this.getAttribute("key");i=$.grep(e.values,(function(t){return t.name==n}))[0]}E.show(i,a[0])})).on("mouseout",(function(){S=setTimeout((function(){S=null,e.tipHover||e.hideTips()}),50)})),e.bindElementSelect(h,".bar"),h.append("g").attr("class","x axis").call(o);var X=function(t,a){p.top-=e.argumentWidth,e.argumentWidth=at(n,o),p.top+=e.argumentWidth,t>e.width/(e.argumentWidth+30)?(P="start",L="translate(12, -4) rotate(-65)",c.transition().duration(a).attr("height",e.height).selectAll("svg > g").attr("transform","translate("+p.left+","+p.top+")"),_&&_.transition().duration(a).attr("y",e.titleHeight-p.top),B&&B.transition().duration(a).attr("y",e.titleHeight+20-p.top)):(P="middle",L="translate(0, 0)",c.transition().duration(a).attr("height",e.height-e.argumentWidth).selectAll("svg > g").attr("transform","translate("+p.left+","+(p.top-e.argumentWidth)+")"),_&&_.transition().duration(a).attr("y",e.titleHeight-p.top+e.argumentWidth),B&&B.transition().duration(a).attr("y",e.titleHeight+20-p.top+e.argumentWidth)),h.selectAll(".x.axis text").transition().duration(a).style("text-anchor",P).attr("transform",L)};X(h.selectAll(".x.axis text").size(),0),h.append("g").attr("class","y axis").call(A);var Y=h.append("g").attr("class","y axis").append("line").attr("x1",n(k)).attr("x2",n(k)).attr("y2",f);if(e.legend&&e.chartKeys.length>1){var j=e.chartKeys.slice();e.addLegend(h,g+m,f,p.top,"columns"!==e.barColoringType&&C,j,e.isLegendUnderGraph,(function(i,u){var c=[];t.forEach((function(t){t.aggregation==i&&(t.hidden=!u),t.hidden||-1!=$.inArray(t.aggregation,c)||c.push(t.aggregation)}));var d=$.grep(t,(function(t){return!t.hidden}));if(d.length){var p=e.convertData(d);s=e.isLog?s:r.default.min(a?p:d,(function(t){return a?t.min:t.value})),l=r.default.max(a?p:d,(function(t){return a?t.total:t.value})),n.domain([isNaN(e.minvalue)?e.isLog?s:Math.min(0,s):e.minvalue,isNaN(e.maxvalue)?Math.max(l,0):e.maxvalue]),b.domain(p.map((function(t){return t.label}))),F.domain(c).rangeRound([0,b.bandwidth()]),isNaN(e.scaleStep)||o.tickValues(ct(n.domain(),e.scaleStep)),N=a?b.bandwidth():F.bandwidth(),e.is3D&&(N=parseInt(.8*N),z=parseInt(N/4)),p.forEach((function(t){var i=h.selectAll("[label]").filterByAttr("label",t.label),r=function(){i.transition().duration(300).attr("transform",(function(t){return"translate(0,"+b(t.label)+")"}))};u||r(),t.values.forEach((function(t){var r=i.selectAll(".bar[key]").filterByAttr("key",t.name),u=i.selectAll("text[key]").filterByAttr("key",t.name),o=O(t);if(r.transition().duration(300).attr("width",o).attr("x",I(t)).attr("y",V(t)).attr("height",N),e.is3D&&(i.selectAll(".bar-right[key]").filterByAttr("key",t.name).transition().duration(300).attr("d",H(t)),i.selectAll(".bar-bottom[key]").filterByAttr("key",t.name).transition().duration(300).attr("d",G(t))),e.showInnerLabels){var s=$(u._groups[0]).parent().find(".bar[key]").filterByAttr("key",t.name),l=function(t){return e.formatBarInnerLabel((function(){return ue(t,d,p)}),(function(){return se(t.value,s,g,a,!0,e.formatNumTo)}))},c=l(t),h=(0,et.getTextWidth)(l(t)),f=n(ht(a?Math.min(t.y0,t.y1):Math.min(t.value,k),n.domain()[0],n.domain()[1]));u.transition().duration(300).attr("x",f+(h>o-5?o+5:(o-h)/2)).attr("y",a?b.bandwidth()/2:F(t.name)+F.bandwidth()/2).style("font-size",(a?b.bandwidth()<14||h>o-5:F.bandwidth()<14)?0:14).style("fill",h>o-5?"black":it(w(t))).text(c)}})),u&&r()}));var f=h.append("g").attr("class","xaxis-tmp").call(o),m=h.selectAll(".xaxis-tmp .tick").size();f.remove(),h.selectAll(".x.axis").transition().duration(300).on("start",(function(){X(m,300)})).call(o).selectAll(".x.axis text").style("text-anchor",P).attr("transform",L),h.select(".y.axis").transition().duration(300).call(A),Y.transition().duration(300).attr("x1",n(k)).attr("x2",n(k)),setTimeout((function(){e.convertToImage({noExport:!0})}),400)}}))}},ae.prototype.drawSeries=function(t){var e=this,a=null,i=null,n=0,u=-1!==e.type.indexOf("Stacked"),o=e.chartKeys,s=W.default.parseValueByType(e.xValueType,e.xScaleStep,e.separator,e.worklog);if(s=isNaN(s)||!1===s?null:s,u&&e.convertSeriesDataStacked(t,o),e.isTime){try{a=W.default.parseDate(e.xminvalue,e.dateFormat,e.locale)}catch(t){a=null}try{i=W.default.parseDate(e.xmaxvalue,e.dateFormat,e.locale)}catch(t){i=null}var l=dt(e),c=t[t.length-1].value-t[0].value;if(null==s){var h=pt(e,c);l=h.ticksSize,s=h.xStep}else s=Math.floor(s)}else a=W.default.parseValueByType(e.xValueType,e.xminvalue,e.separator,e.worklog),i=W.default.parseValueByType(e.xValueType,e.xmaxvalue,e.separator,e.worklog),a=isNaN(a)||!1===a?null:a,i=isNaN(i)||!1===i?null:i;if(0!==(t=$.grep(t,(function(t){return(null==a||t.value>=a)&&(null==i||t.value<=i)}))).length){var d;d=e.isTime?r.default.scaleTime():e.isXLog?r.default.scaleLog():r.default.scaleLinear();var p=e.isLog?r.default.scaleLog():r.default.scaleLinear(),g=r.default.axisBottom(d);if(e.isTime){var f=e.getTimeFormat(c);g.tickFormat(f)}else e.isXLog||g.tickFormat(e.formatNumToX);var m=r.default.axisLeft(p);e.isLog||m.tickFormat(e.formatNumTo);var x=r.default.min(t,(function(t){return t.value})),y=r.default.max(t,(function(t){return t.value}));!e.isTime&&e.isXLog&&0==a&&(a=Number.MIN_VALUE,y<0&&(a*=-1)),d.domain([null==a?x:a,null==i?y:i]);var D=r.default.min(t,(function(t){return t.label})),v=r.default.max(t,(function(t){return u?t.y1:t.label}));e.isLog&&0==e.minvalue&&(e.minvalue=Number.MIN_VALUE,v<0&&(e.minvalue*=-1)),isNaN(e.minvalue)?p.domain([e.isLog?D:Math.min(0,D),isNaN(e.maxvalue)?v:e.maxvalue]):p.domain([e.minvalue,isNaN(e.maxvalue)?v:e.maxvalue]),st(g),isNaN(e.scaleStep)||m.tickValues(ct(p.domain(),e.scaleStep));var b=e.chart.append("svg"),F=b.append("g");e.argumentWidth=at(d,g),e.textWidth=Math.max(at(p,m),e.argumentWidth/2);var C,A,E=lt(u?o.slice().reverse():o.slice(),e.width-(e.textWidth+20+e.ytitleHeight)-40,e.isPivot,e.isLegendUnderGraph),_={top:20+e.titleHeight,right:e.legend&&!e.isLegendUnderGraph&&o.length>1?E.maxWidth+25:40,bottom:e.argumentWidth+25+e.xtitleHeight+(e.isLegendUnderGraph?20*(E.rows+1)+10:0),left:e.textWidth+20+e.ytitleHeight},w=e.width-_.left-_.right;if(d.range([0,w]),p.range([e.height,0]),b.attr("oncontextmenu","return false;").attr("width",e.width).attr("height",e.height+_.top+_.bottom),F.attr("transform","translate("+_.left+","+_.top+")"),e.addTitle(F,w,_),e.xtitle)var B=F.append("text").attr("x",w/2).attr("y",e.height+_.bottom-10).attr("class","axis-title").style("text-anchor","middle").style("font-weight","bold").text(e.xtitle);if(e.ytitle)var k=F.append("text").attr("transform","rotate(-90)").attr("y",20-_.left).attr("class","axis-title").attr("x",-e.height/2).style("text-anchor","middle").style("font-weight","bold").text(e.ytitle);var S=function(t,a){_.bottom-=e.argumentWidth,e.argumentWidth=at(d,g),_.bottom+=e.argumentWidth;var i=e.height+_.top+_.bottom;return t>w/(e.argumentWidth+10)?(C="end",n=e.argumentWidth+10,A="translate(-14, 7) rotate(-65)",e.xtitle&&B.transition().duration(a).attr("y",e.height+_.bottom-15-(e.isLegendUnderGraph?20*(E.rows+1)+5:0))):(C="middle",n=22,A="translate(0, 0)",i-=e.argumentWidth,e.xtitle&&B.transition().duration(a).attr("y",e.height+_.bottom-e.argumentWidth-(e.isLegendUnderGraph?20*(E.rows+1)+5:0))),F.selectAll(".x.axis text").transition().duration(a).style("text-anchor",C).attr("transform",A),i};F.append("clipPath").attr("id","clip"+e.macroId+e.pageId).append("rect").attr("x",1).attr("width",w).attr("height",e.height);var T,P,L=F.append("g").attr("clip-path","url(#clip"+e.macroId+e.pageId+")");F.append("path").datum(t),e.grid&&!e.isArea&&(T=F.append("g"),P=F.append("g"));var M=function(t){var a=$.inArray(t,o);return e.colors[a%e.colors.length]},I=[];r.default.group(t,(function(t){return t.key})).forEach((function(t,e){I.push({key:e,values:t})}));var V=e.isArea?"area":"line",O=1,N={};if(o.forEach((function(t){var a,i=$.grep(I,(function(e){return e.key===t}));if(a=e.isArea?r.default.area().curve(e.getInterpolation(t)).x((function(t){return d(t.value)})).y0((function(t){return t.y0?p(t.y0):e.height})).y1((function(t){return p(u?t.y1:t.label)})):r.default.line().curve(e.getInterpolation(t)).x((function(t){return d(t.value)})).y((function(t){return p(t.label)})),N[t]=a,i.length>0){if(i=i[0],Et(e.type)&&e.getLineType(i.key)===Z)!function(t){var a=r.default.symbol().type(r.default.symbolCircle).size(100*e.getLineWidth(t.key));L.selectAll('path[key="'+t.key+'"]').data(t.values).enter().append("path").attr("key",t.key).attr("transform",(function(t){return"translate("+d(t.value)+","+p(t.label)+")"})).attr("d",a()).style("fill",M(t.key))}(i);else{var n=L.append("path").attr("class",V).attr("d",a(i.values)).attr("key",i.key);e.isArea?n.style("fill",M(i.key)).style("opacity",O):(n.style("stroke",M(i.key)).style("stroke-width",e.getLineWidth(i.key)+"px"),Et(e.type)&&e.getLineType(i.key)===q&&n.style("stroke-dasharray","9, 6"))}u||(O*=.8),e.addTrendLine(i,F,d,p,M(i.key))}})),e.grid&&e.isArea&&(T=F.append("g"),P=F.append("g")),e.grid){var z=r.default.axisLeft(p).tickSize(-w,0,0).tickFormat(""),G=r.default.axisBottom(d).tickSize(e.height,0,0).tickFormat("");st(G),isNaN(e.scaleStep)||z.tickValues(ct(p.domain(),e.scaleStep)),T.attr("class","grid").call(z).selectAll("line, .domain").attr("stroke",""),P.attr("class","grid").call(G).selectAll("line, .domain").attr("stroke","")}F.append("g").attr("class","x axis").attr("transform","translate(0,"+e.height+")").call(g).selectAll("text"),F.append("g").attr("class","y axis").call(m).append("text").attr("transform","rotate(-90)").attr("y",6).attr("dy",".71em").style("text-anchor","end"),b.attr("height",S(F.selectAll(".x.axis text").size(),0));var H=r.default.bisector((function(t){return t.value})).left,R={},X={};I.forEach((function(t){var a=F.append("g").attr("class","focus").style("display","none");a.append("circle").attr("r",4.5).style("fill",M(t.key));var i=$('<div class="d3-tip n chart'+e.macroId+e.pageId+'" style="position: absolute; pointer-events: all; box-sizing: border-box; display: none"></div>');e.svgWrapper.append(i),X[t.key]=i,R[t.key]=a}));var Y=null;e.hideTips=function(){for(var t in R)R[t].style("display","none"),X[t].hide()};var j=r.default.drag(),K=!1;F.append("rect").attr("class","overlay").attr("width",w).attr("height",e.height).style("fill","none").on("mouseover",(function(){if(!K)for(var t in clearTimeout(Y),R)R[t].style("display",""),X[t].show()})).on("mouseout",(function(){Y=setTimeout((function(){Y=null,e.tipHover||e.hideTips()}),50)})).on("mousemove",(function(t){if(!K)if(t.altKey||t.ctrlKey||t.shiftKey)e.hideTips();else{var a=this,i=[];I.forEach((function(n){var o=R[n.key],s=d.invert(r.default.pointer(t,a)[0]),l=H(n.values,s,1),c=n.values[l-1],h=n.values[l],g=h&&s-c.value>h.value-s?h:c,m=d(g.value),x=p(u?g.y1:g.label);if(!isNaN(m)){if(m<0||m>w||x<0||x>e.height)return X[n.key].hide(),void o.style("display","none");o.style("display",""),o.attr("transform","translate("+m+","+x+")");var y=e.isTime?f(g.value):e.formatNumToX(g.value);X[n.key].show().text(e.formatNumTo(g.label)+" ("+y+")");var D=$(o._groups[0]).offset();D.top-=X[n.key].outerHeight()+6,D.left-=X[n.key].outerWidth()/2-4,i.push({key:n.key,offset:D,y:p(ht(u?g.y1:g.label,p.domain()[0],p.domain()[1]))})}})),i.sort((function(t,e){return t.y-e.y}));var n=0;i.forEach((function(t){n>t.offset.top?(t.offset.top+=60,X[t.key].removeClass("n").addClass("s").offset(t.offset)):X[t.key].removeClass("s").addClass("n").offset(t.offset),n=t.offset.top+45}))}})).on("wheel",(function(t){if(t.altKey||t.ctrlKey){t.preventDefault(),t.stopPropagation();var a=t.deltaY,i=r.default.pointer(t,this),n=w/10,u=i[0]/w*n,o=(1-i[0]/w)*n,s=e.height/10,l=i[1]/e.height*s,c=(1-i[1]/e.height)*s;a<0?(Q.x1=d.invert(u),Q.x2=d.invert(w-o),Q.y2=p.invert(l),Q.y1=p.invert(e.height-c)):(Q.x1=Math.max(d.invert(-u),tt.x1),Q.x2=Math.min(d.invert(w+o),tt.x2),Q.y2=Math.min(p.invert(-l),tt.y2),Q.y1=Math.max(p.invert(e.height+c),tt.y1)),rt()}})).call(j);var U=d.domain(),J=p.domain(),Q={x1:U[0],y1:J[0],x2:U[1],y2:J[1]},tt={x1:U[0],y1:J[0],x2:U[1],y2:J[1]};e.legend&&o.length>1&&e.addLegend(F,w,e.height+n+5+e.xtitleHeight,_.top,M,u?o.slice().reverse():o,e.isLegendUnderGraph,(function(n,s){t.forEach((function(t){t.key==n&&(t.hidden=!s,X[n].css("visibility",s?"":"hidden"),R[n].style("visibility",s?"":"hidden"))}));var l=$.grep(t,(function(t){return!t.hidden}));l.length&&(u&&e.convertSeriesDataStacked(l,o),x=!e.isTime&&e.isXLog?x:r.default.min(l,(function(t){return t.value})),y=r.default.max(l,(function(t){return t.value})),d.domain([null==a?x:a,null==i?y:i]),U=d.domain(),d.domain([U[0]>Q.x1?U[0]:Q.x1,U[1]<Q.x2?U[1]:Q.x2]),D=r.default.min(l,(function(t){return t.label})),v=r.default.max(l,(function(t){return u?t.y1:t.label})),isNaN(e.minvalue)?p.domain([e.isLog?D:Math.min(0,D),isNaN(e.maxvalue)?v:e.maxvalue]):p.domain([e.minvalue,isNaN(e.maxvalue)?v:e.maxvalue]),J=p.domain(),p.domain([Math.max(J[0],Q.y1),Math.min(J[1],Q.y2)]),ot($.grep(I,(function(t){return t.key==n&&(t.hidden=!s),!t.hidden}))))}));var et=F.append("rect").attr("width",0).attr("height",0).attr("x",0).attr("y",0).attr("class","band"),it=[-1,-1];j.filter((function(t){return!t.button})),j.on("end",(function(t){if(K=!1,0==t.sourceEvent.button&&!(t.sourceEvent.altKey||t.sourceEvent.ctrlKey||t.sourceEvent.shiftKey)){var e=r.default.pointer(t,this),a=-1==it[0]||it[0]==e[0]||it[1]==e[1];Q.x1=d.invert(it[0]),Q.x2=d.invert(e[0]),Q.y1=p.invert(e[1]),Q.y2=p.invert(it[1]);var i=it[0]>e[0];it=[-1,-1],et.transition().attr("width",0).attr("height",0).attr("x",it[0]).attr("y",it[1]),a||(i?ut():rt())}})),j.on("drag",(function(t){if(K=!0,e.hideTips(),0==t.sourceEvent.button){if(t.sourceEvent.altKey||t.sourceEvent.ctrlKey)return a=t.dx,i=t.dy,Q.x1=d.invert(-a),Q.x2=d.invert(w-a),Q.y2=p.invert(-i),Q.y1=p.invert(e.height-i),void rt(0);var a,i;if(t.sourceEvent.shiftKey)!function(t,a){Q.x1=d.invert(t),Q.x2=d.invert(w-t),Q.y2=p.invert(-a),Q.y1=p.invert(e.height+a),rt(0)}(t.dx,t.dy);else{var n=r.default.pointer(t,this);n[0]<it[0]?et.attr("stroke","#14892c").attr("transform","translate("+n[0]+","+it[1]+")"):et.attr("stroke","#707070"),n[1]<it[1]&&et.attr("transform","translate("+n[0]+","+n[1]+")"),n[1]<it[1]&&n[0]>it[0]&&et.attr("transform","translate("+it[0]+","+n[1]+")"),-1==it[0]&&(it=n,et.attr("transform","translate("+it[0]+","+it[1]+")")),et.transition().duration(1).attr("width",Math.abs(it[0]-n[0])).attr("height",Math.abs(it[1]-n[1]))}}}));var nt=null}function rt(t){Q.x1!=Q.x2&&(Q.x1>Q.x2?ut():(d.domain([Q.x1,Q.x2]),Q.y1>Q.y2?p.domain([Q.y2,Q.y1]):p.domain([Q.y1,Q.y2]),ot(I,t)))}function ut(){Q={x1:tt.x1,y1:tt.y1,x2:tt.x2,y2:tt.y2},d.domain(U),p.domain(J),ot(I)}function ot(t,a){a=null==a?300:a;var i,n=F.transition().duration(a);t.forEach((function(t){n.selectAll(".line[key], .area[key]").filterByAttr("key",t.key).attr("d",N[t.key](t.values)),Et(e.type)&&e.getLineType(t.key)==Z&&n.selectAll('path[key="'+t.key+'"]').attr("transform",(function(t){return"translate("+d(t.value)+","+p(t.label)+")"})),e.showTrendLine&&n.selectAll(".trendline[key]").filterByAttr("key",t.key).attr("x1",d(t.trendData.x1)).attr("y1",p(t.trendData.y1)).attr("x2",d(t.trendData.x2)).attr("y2",p(t.trendData.y2))})),null!=s&&e.isSeries&&(i=ct(d.domain(),s),g.tickValues(i),e.grid&&G.tickValues(i)),isNaN(e.scaleStep)||(i=ct(p.domain(),e.scaleStep),m.tickValues(i),e.grid&&z.tickValues(i));var r=F.append("g").attr("class","xaxis-tmp").call(g),u=F.selectAll(".xaxis-tmp .tick").size();r.remove(),n.selectAll(".x.axis").call(g).selectAll(".x.axis text").style("text-anchor",C).attr("transform",A),n.selectAll(".y.axis").on("start",(function(){var t=e.textWidth;e.textWidth=Math.max(at(p,m),e.argumentWidth/2),t-=e.textWidth,_.left-=t,e.width-=t,b.transition().duration(a).attr("width",e.width).attr("height",S(u,a)),F.transition().duration(a).attr("transform","translate("+_.left+","+_.top+")"),e.ytitle&&k.transition().duration(a).attr("y",20-_.left)})).call(m),e.grid&&(T.transition().duration(a).call(z).selectAll("line").attr("stroke",""),P.transition().duration(a).call(G).selectAll("line").attr("stroke","")),clearTimeout(nt),nt=setTimeout((function(){e.convertToImage({noExport:!0})}),a+100)}function st(t){null!=s&&(e.isSeries?t.tickValues(ct(d.domain(),s)):l===r.default.timeDay&&1!==s?t.ticks(l.filter((function(t){return r.default.timeDay.count(d.domain()[0],t)%s==0}))):t.ticks(l.every(s)))}},ae.prototype.drawGantt=function(t){var e=this,a=r.default.scaleOrdinal().range(e.colors);a.domain(e.ganttCatColors);var i=[],n=[],o=[],s=[],l=[],c=[],h=null;if(t.forEach((function(t,r){var u=t.colorFromColumns||[];if(t.endDate){var h="mono"===e.barColoringType?"Task":t.category,d=u[0]||a(h);if(t.style="fill:"+d,t.doneStyle="fill:"+(u[1]||a(h+" - Done")),t.todoStyle="fill:"+(u[2]||a(h+" - Todo")),t.labelStyle="fill:"+it(d),t.label){var p=t.label.split(": ")[0];-1===o.indexOf(p)&&o.push(p)}e.hasTimeFormat||t.endDate.setHours(23,59,59);var g="";if(t.label){var f=t.label.split(": ");f.length>1&&(g="("+t.label.replace(f[0],"").replace(": ","")+")")}var m=Math.round((t.endDate-t.startDate)/864e5);e.ganttProgressPercentage&&t.progress&&(t.progress/=100);var x=t.progress>=0?" "+Math.round(100*t.progress)+"%":"";t.hint=t.category+" "+g+": "+m+" "+"days"+x,i.push(t)}else{var y=-1!==e.ganttCategories.indexOf(t.category),D=-1!==e.ganttCategories.indexOf(t.label);if(y||D){if(D&&c.push(t.label+"-"+t.startDate.getTime()),D||-1===c.indexOf(t.category+"-"+t.startDate.getTime())){var v,b=y?t.label:t.category,F=y?t.category:t.label,C=new RegExp((0,jt.default)("^".concat(F," - ")),"g");v="mono"===e.barColoringType?"Milestone":D?b:F+": "+(b||"milestone"),e.hasTimeFormat||t.startDate.setHours(12),s.push({id:r,category:F,label:b,date:t.startDate,style:"fill:"+(u[3]||a(v)),hint:t.hint.replace(C,"")}),l.push(b)}}else{var A="mono"===e.barColoringType?"Event":t.category;n.push({date:t.startDate,style:"stroke:"+(u[4]||a(A)),label:t.category||t.label,hint:t.hint,text:t.text})}}})),0!==i.length){if(1===o.length&&i.length>1&&i.forEach((function(t){t.label=t.label.replace(o[0],"").replace(": ","")})),l.length){var d=n.slice();n=[],d.forEach((function(t){-1===l.indexOf(t.label)&&n.push(t)}))}i.sort((function(t,e){return t.startDate-e.startDate||(t.label>e.label?1:0)}));var p,g,f=null,m=null;try{f=W.default.parseDate(e.xminvalue,e.dateFormat,e.locale)}catch(t){}try{m=W.default.parseDate(e.xmaxvalue,e.dateFormat,e.locale)}catch(t){}if(f||(f=wt(!0,i,s,n)),!m){var x=$.grep(n,(function(t){return-1===["today","heute"].indexOf(t.text.toLowerCase())}));m=wt(!1,i,s,x);var y=W.default.parseDate("today");if(x.length<n.length&&y>m)if(.25*(m-f)>y-m)m=y;else{var D=.25*(m-f)+m.getTime();(m=new Date).setTime(D),n.filter((function(t){return-1!==["today","heute"].indexOf(t.text.toLowerCase())}))[0].date=m}}var v=W.default.parseNumber(e.xScaleStep,e.separator);v=isNaN(v)||!1===v?null:v;var b=i[i.length-1].endDate-i[0].startDate;if(null!=v)p=dt(e),g=Math.floor(v);else{var F=pt(e,b);p=F.ticksSize,g=F.ticksStep}var C=Rt(e.chart,e).height(e.height,e.ganttBarHeight).width(e.width).grid(e.grid).categories(e.ganttCategories).tasks(i).arrows(e.ganttArrows).dateLines(n).mileStones(s).tickFormat(e.getTimeFormat(b)).ticks({ticksSize:p,ticksStep:g}).timeDomain([f,m]).timeDomainMode("fixed");C.init();var A=e.chart.selectAll("svg");e.argumentWidth=at(C.getTimeAxisRenderer().getAxisLine(),C.getTimeAxisRenderer().getAxis());var E={top:20+e.titleHeight,right:40,bottom:e.argumentWidth+25+e.ytitleHeight},_=(0,et.findLongestText)(e.ganttCategories),w=C.categoryAxisRenderer().config().axisLength;e.textWidth=xt(w/e.ganttCategories.length,_,z),C.categoryAxisRenderer().textWidth(e.textWidth),E.left=e.textWidth+20+e.xtitleHeight,C.margin(E).draw();var B=e.width-E.left-E.right,k=A.selectAll(".gantt-chart");e.addTitle(k,B,E),e.ytitle&&(h=k.append("text").attr("x",B/2).attr("y",w+E.bottom-10).attr("class","axis-title").style("text-anchor","middle").style("font-weight","bold").text(e.ytitle)),e.xtitle&&k.append("text").attr("transform","rotate(-90)").attr("y",20-E.left).attr("class","axis-title").attr("x",-w/2).style("text-anchor","middle").style("font-weight","bold").text(e.xtitle);var S=function(t,a){var i,n,r;t>B/(e.argumentWidth+10)?(n="end",i="translate(-14, 7) rotate(-65)",r=w+E.top+E.bottom,A.transition().duration(a).attr("height",r).style("height",r+"px"),e.ytitle&&h.transition().duration(a).attr("y",w+E.bottom-10)):(n="middle",i="translate(0, 0)",r=w+E.top+E.bottom-e.argumentWidth,A.transition().duration(a).attr("height",r).style("height",r+"px"),e.ytitle&&h.transition().duration(a).attr("y",w+E.bottom-10-e.argumentWidth)),A.selectAll(".xaxis-group text").transition().duration(a).style("text-anchor",n).attr("transform",i)};S(A.selectAll(".xaxis-group text").size(),0);var T=(0,u.default)().attr("class","d3-tip chart"+e.macroId+e.pageId).offset([-5,0]).html((function(t){return W.default.escapeString(t.hint)}));e.hideTips=function(){T.hide()};var P=function(t){var e=t.gantt,a=t.ganttChartNode,i=t.width,n=t.height,u=t.grid,o=t.rotateText,s=t.tableChart,l=e.getTimeAxisRenderer(),c=e.taskRenderer().getTruncatedTaskText,h=l.appendFormattedTicks,d=l.getAxisLine(),p=a.selectAll("g.xaxis-group"),g=a.selectAll("g.gantt-bars"),f=g.selectAll(".g_task"),m=a.selectAll("g.g_milestone"),x=a.selectAll("g.g_dateline"),y=750,D=Xt(l.domain(),2),v=D[0],b=D[1],F=Math.round((b-v)/864e6);a.append("defs").append("clipPath").attr("id","clip".concat(s.macroId).concat(s.pageId)).append("rect").attr("x",0).attr("y",-30).attr("width",i-5).attr("height",n+30);var C=function(t,e,a,i){return t.transition().duration(a?y:0).attr("transform","translate(0,".concat(n,")")).call(h(r.default.axisBottom(d).scale(e),i)).call((function(t){return t.select(".domain")}))},A=r.default.zoom().scaleExtent([1,F]).translateExtent([[0,0],[i,n]]).extent([[0,0],[i,n]]).filter((function(t){return(t.altKey||t.ctrlKey)&&(t.preventDefault(),t.stopPropagation()),t.altKey||t.ctrlKey})).wheelDelta((function(t){return-t.deltaY/1e3})).on("zoom",(function(t){var i=t.transform,n=i.k/E.k;E=i;var s=i.rescaleX(d),l=1!==n,h=1!==i.k;p.call(C,s,l,h),o(p.selectAll(".xaxis-group text").size(),0),u&&e.rescaleGridX(h,l,s);var D=g.selectAll(".g_task"),v=function(t){return s(t.endDate)-s(t.startDate)};function b(t,e){t.each((function(t){var a=r.default.select(this).attr("transform");a=a?a.replace(/translate\(.*,(.*)\)/,(function(a,i){return"translate(".concat(e(t),", ").concat(i,")")})):"translate(".concat(e(t),", ",0,")"),r.default.select(this).transition().duration(l?y:0).attr("transform",a)}))}D.selectAll("rect:first-child").transition().duration(l?y:0).attr("width",v),D.selectAll(".task-progress-bar-total").transition().duration(l?y:0).attr("width",(function(t){return isNaN(t.progress)?0:v(t)})),D.selectAll(".task-progress-bar").transition().duration(l?y:0).attr("width",(function(t){return isNaN(t.progress)?0:s(new Date(t.startDate.getTime()+(t.endDate.getTime()-t.startDate.getTime())*t.progress))-s(t.startDate)})),D.selectAll("text[class$=-label]").transition().duration(l?y:0).text((function(t){return c.call(this,t,v)})),f.size()&&b(f,(function(t){return s(t.startDate)})),m.size()&&b(m,(function(t){return i.applyX(d(t.date))-10})),x.size()&&b(x,(function(t){return i.applyX(d(t.date))})),g.select(".gantt-arrows").selectAll(".arrowLine").transition().duration(l?y:0).attrTween("d",(function(){var t=r.default.select(this);return function(e){return g.classed("editMode")&&Ut({chart:a}),t.dispatch("resize"),t.attr("d")}}))})),E=r.default.zoomIdentity;return A}({gantt:C,ganttChartNode:k,width:B,height:w,grid:e.grid,rotateText:S,tableChart:e});k.insert("rect",":first-child").attr("class","overlay").attr("width",B).attr("height",w).style("fill","none").call(T),k.call(P),_t(T,A,".g_task",e),_t(T,A,".g_dateline",e),_t(T,A,".g_milestone",e),e.bindElementSelect(A,".g_task")}else e.customMessage.show().find(".text").text("No project data found. Please select project name, start and end date columns.")},ae.prototype.drawRadar=function(t){var e=this,a=r.default.scaleOrdinal().range(e.colors);a.domain(e.chartKeys);var i=lt(e.chartKeys.slice(),e.width-40,e.isPivot,e.isLegendUnderGraph),n={id:e.macroId+""+e.pageId,w:e.width,h:e.height,scaleStep:isNaN(e.scaleStep)?void 0:e.scaleStep,formatter:e.formatNumTo,color:a,padding:{left:20,right:e.legend&&!e.isLegendUnderGraph&&e.chartKeys.length>1?50+i.maxWidth:20,top:20+2*e.titleHeight,bottom:e.isLegendUnderGraph&&e.chartKeys.length>1?30+20*(i.rows+1):20},maxValue:isNaN(e.maxvalue)?0:e.maxvalue,grid:e.grid},u=Dt.draw(e.chart,t,n);if(e.addTitle(u.svg,2*u.cfg.center.x,{top:0}),e.legend&&e.chartKeys.length>1){var o=e.chartKeys.slice();e.addLegend(u.svg,u.cfg.center.x+u.cfg.radius+n.padding.left,u.cfg.center.y+u.cfg.radius+20,n.padding.top,a,o,e.isLegendUnderGraph,(function(){}))}},ae.prototype.addLegend=function(t,e,a,i,n,u,o,s){var l=this,c=rt(u,l.isPivot,e,o),h=t.selectAll(".legend").data(o?c.values:c.values.filter((function(t){return t.y+t.height<=l.svgWrapper.find("svg").attr("height")-i}))).enter().append("g").attr("class","legend").attr("transform",(function(t,i){return"translate("+(o?c.values[i].x:e+j)+","+(o?a+10+c.values[i].y:c.values[i].y)+")"})).on("click",(function(e,a){var i=t.selectAll("[key]").filterByAttr("key",a.key),n="hidden"==i.style("visibility")?1:0;$(this).css("opacity",0==n?.5:1),n||i.style("visibility","hidden"),s(a.key,n),n&&setTimeout((function(){t.selectAll("[key]").filterByAttr("key",a.key).style("visibility","")}),330)}));h.append("title").text("Click to hide/show this data");var d=h.append("rect").attr("x",0).attr("width",Y).attr("height",Y);n?d.style("fill",(function(t){return n(t.key)})):(l.appenColoredGradient(t),d.style("fill","url(#colored-gradient)"));var p=h.append("text").attr("x",(function(t){return Y+K})).attr("y",Y/2).attr("dy",".35em").style("text-anchor","start");o?p.text((function(t){return t.view})).filter((function(t){return t.isShorten})).append("tspan").text(H).append("title").text((function(t){return t.key})):p.text((function(t){return t.isShorten?null:t.view})).filter((function(t){return t.isShorten})).each((function(t){var e=r.default.select(this),a=e.attr("x")||"0em";t.views.forEach((function(t,i){e.append("tspan").attr("dx","0").attr("x",a).attr("dy",0===i?"0":"1em").text(t)}))}))},ae.prototype.appenColoredGradient=function(t){var e=t.selectChild("defs");if(!(e=e.empty()?null:e)||e.selectChild("#colored-gradient").empty()){var a=(e||t.append("defs")).append("linearGradient").attr("id","colored-gradient").attr("x1","0%").attr("x2","100%").attr("y1","0%").attr("y2","100%");a.append("stop").attr("offset","0%").attr("stop-color","red"),a.append("stop").attr("offset","100%").attr("stop-color","greenyellow")}},ae.prototype.formatBarInnerLabel=function(t,e){var a=this;return a.innerLabelsType.percentage?t():a.innerLabelsType.value_percentage?e()+" ("+t()+")":a.innerLabelsType.percentage_value?t()+" ("+e()+")":e()},ae.prototype.addTitle=function(t,e,a,i){var n=this;if(n.title||i&&i.title)return t.append("text").attr("x",e/2).attr("y",(i&&i.titleHeight?i.titleHeight:n.titleHeight)-a.top).attr("class","title").attr("text-anchor","middle").style("font-size","16px").style("font-weight","bold").style("fill","#333").text(i&&i.title?i.title:n.title)},ae.prototype.addGroupTitle=function(){var t=this,e=0;if(t.title&&t.chartKeys.length>1){var a=$(document.createElementNS("http://www.w3.org/2000/svg","text")).attr("class","_title").attr("x",t.width/2).attr("y",16).attr("text-anchor","middle").text(t.title).css({"font-size":"16px","font-family":et.FONT_FAMILY,"font-weight":"bold"}),i=$(document.createElementNS("http://www.w3.org/2000/svg","svg")).attr("width",t.width).attr("height",17).append(a);t.svgWrapper.prepend(i),e=i.outerHeight()}t.svgWrapper.height(t.height+e+5).width(t.width)},ae.prototype.convertToImage=function(){var t=ee(n().mark((function t(e){var a,i,r,u,o,s,c,h,d,p;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=this,!document.hidden){t.next=4;break}return $(document).one("visibilitychange",(function(){setTimeout((function(){a.convertToImage(e)}),1e3)})),t.abrupt("return");case 4:if(a.svgWrapper.find(".axis").css("font-size","10"),a.svgWrapper.find(".axis path, .axis line, .xaxis-group path, .xaxis-group line").css({fill:"none",stroke:"#000","shape-rendering":"crispEdges"}),a.svgWrapper.find(".line").css({fill:"none"}),a.svgWrapper.find("text").css({"font-family":et.FONT_FAMILY}),a.svgWrapper.find(".axis-title").css({"font-size":"14px"}),a.svgWrapper.find(':not([class$="_tooltip"]) > text:not(.legend):not(.title):not(.percent):not(.axis-title):not(.milestone-label):not([class$="_title"]):not([class$="_segmentPercentage-inner"]):not([class$="_segmentValue-inner"]):not(.inner-value-label):not([class$="_segmentMainLabel-outer"]):not(.task-label)').css({fill:"#333","font-size":"14px","font-weight":"normal"}),a.svgWrapper.find(".grid .tick").css({stroke:"lightgrey","stroke-opacity":.7,"shape-rendering":"crispEdges"}),a.svgWrapper.find(".grid .path").css({"stroke-width":0}),a.svgWrapper.find('[class$="_title"]').css("font-weight","bold"),a.svgWrapper.find('[class$="_tooltips"], .focus').hide(),a.svgWrapper.find(".tickY, .axisY").css({stroke:"black","shape-rendering":"crispEdges"}),a.svgWrapper.find(".gridX").css({"shape-rendering":"crispEdges"}),a.svgWrapper.find(".tick").css("opacity",""),(i=a.svgWrapper.find("svg")).find("#p0_footer").remove(),i.attr("version",1.1).attr("xmlns","http://www.w3.org/2000/svg"),r=ne(i),"undefined"!=typeof btoa&&r&&!$("body").hasClass("edit")&&!$("body").hasClass("content-preview")){t.next=24;break}return a.download.hide(),t.abrupt("return");case 24:return u=a.canvas.attr("width",a.svgWrapper.width()||a.width).attr("height",a.svgWrapper.height()||a.height)[0],o=u.getContext("2d"),s=a.svgWrapper.offset(),c=[],h=[],i.each(ee(n().mark((function t(){var e,a,i;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=$(this),a=e.offset(),r=ne(e),i=l.default.from(o,r,{offsetX:a.left-s.left,offsetY:a.top-s.top,ignoreDimensions:!0,ignoreClear:!0}),c.push(i),t.t0=h,t.next=8,i;case 8:t.t1=t.sent.render(),t.t0.push.call(t.t0,t.t1);case 10:case"end":return t.stop()}}),t,this)})))),t.next=31,Promise.all(c);case 31:return t.next=33,Promise.all(h);case 33:o.globalCompositeOperation="destination-over",o.fillStyle="#ffffff",o.fillRect(0,0,u.width,u.height),d=u.toDataURL("image/jpeg",1),p='<img src="'+d+'">',a.png.html(p),a.download.attr("href",d),a.preventExport||e&&e.noExport||(clearTimeout(a.exportTimer),a.exportTimer=setTimeout((function(){a.content.trigger("tf-export-ready",a.getExportEventData())}),300)),a.svgWrapper.find('[class$="_tooltips"]').show();case 42:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),ae.prototype.getExportEventData=function(){var t=this;return{macroId:t.macroId,adaptiveDimensions:t.adaptiveDimensions,data:t.calculatedData,params:[t.type,t.columns,t.aggregation,t.hide,t.grid,t.legend,t.minvalue,t.maxvalue,t.xminvalue,t.xmaxvalue,t.scalestep,t.xscalestep,t.title,t.xtitle,t.ytitle,t.isLog,t.isXLog,t.colors,t.pieKeys,t.showInnerLabels,t.showTrendLine,t.worklog,t.interpolation,t.lineSettings,t.is3D]}},ae.prototype.convertData=function(t){var e=this,a=[],i=[];t.forEach((function(t,n){-1==$.inArray(t.label,i)&&i.push(t.label),a[t.label]||(a[t.label]={label:t.label,values:[]});var r=e.chartKeys.indexOf(t.aggregation);a[t.label].values[r]={name:t.aggregation,value:t.value,label:t.label,rowNumber:t.rowNumber};var u=t.colorFromColumns&&t.colorFromColumns[e.isMultiColorColumn?n:r];u&&(a[t.label].values[r].colorFromColumn=u),t.transformedData=a[t.label].values[r]}));var n=[];return i.forEach((function(t){n.push(a[t])})),n.forEach((function(t){for(var a=e.isLog?Number.MIN_VALUE:0,i=a,n=0;n<t.values.length;n++){var r=t.values[n];r?r.value>=0?(r.y0=a,a+=r.value,r.y1=a):(r.y1=i,i+=r.value,r.y0=i):t.values.splice(n--,1)}t.total=a,t.min=i})),n},ae.prototype.convertSeriesDataStacked=function(t,e){var a=[];e.forEach((function(e){t.forEach((function(t){t.key===e&&(a[t.value]||(a[t.value]=0),t.y0=a[t.value],t.y1=t.y0+t.label,a[t.value]+=t.label)}))}))},ae.prototype.calcGroupSize=function(t){var e=this,a=e.width/e.height,i=Math.ceil(Math.sqrt(t*a)),n=Math.ceil(t/i),r=e.width/i,u=e.height/n,o=Math.min(r,u),s=i-1,l=Math.ceil(t/s);return o<=Math.min(e.width/s,e.height/l)&&(r=e.width/s,u=e.height/l),{width:r,height:u}},ae.prototype.addBarTrendLine=function(t,e,a,i,n,r,u,o,s){var l=this;if(l.showTrendLine){var c={};e?(c._total_={key:"",values:[],transformedData:{}},i.forEach((function(t){c._total_.values.push({value:t.label,label:t.total})}))):a.forEach((function(t){c[t.aggregation]||(c[t.aggregation]={key:t.aggregation,values:[],transformedData:t.transformedData}),c[t.aggregation].values.push({value:t.label,label:t.value})}));var h=0;$.each(c,(function(e,a){l.addTrendLine(a,t,n,r,u(a.transformedData),o*(.5+h++),s)}))}},ae.prototype.addTrendLine=function(t,e,a,i,n,r,u){var o=this;if(o.showTrendLine){var s=t.values.map((function(t){return t.value})),l=s.map((function(t){return a(t)})),c=function(t,e){var a=function(t,e){return t+e},i=1*t.reduce(a)/t.length,n=1*e.reduce(a)/e.length,r=t.map((function(t){return Math.pow(t-i,2)})).reduce(a),u=e.map((function(t){return Math.pow(t-n,2)})).reduce(a),o=t.map((function(t,a){return(t-i)*(e[a]-n)})).reduce(a),s=o/r,l=n-i*s,c=Math.pow(o,2)/(r*u);return[s,l,c]}(l,t.values.map((function(t){return parseFloat(t.label)}))),h=a.domain()[a.domain().length-1];t.trendData={x1:s[0],y1:c[0]*l[0]+c[1],x2:h,y2:c[0]*a(h)+c[1]};var d=a(t.trendData.x1),p=i(t.trendData.y1),g=a(t.trendData.x2),f=i(t.trendData.y2);if(!(isNaN(p)||isNaN(f)||isNaN(d)||isNaN(g)))r=r||0,e.selectAll(".trendline[key]").filterByAttr("key",t.key).data([{}]).enter().append("line").attr("class","trendline").attr("clip-path","url(#clip"+o.macroId+o.pageId+")").attr("key",t.key).attr(u?"y1":"x1",d+r).attr(u?"x1":"y1",p).attr(u?"y2":"x2",g+r).attr(u?"x2":"y2",f).attr("stroke",n).attr("stroke-dasharray","10,10").attr("stroke-width",1)}},ae.prototype.enableSaveBtn=function(){var t=this;t.btn.removeClass("tf-disabled-link"),t.controls.add(t.btn).find(".tfac-unsaved").show(),At.default.addToUnloadPageAction(t)},ae.prototype.shiftInterpolationBtn=function(){var t=this;!t.type||-1===t.type.indexOf("Line")&&-1===t.type.indexOf("Area")?t.setInterpolationBtn.hide():t.setInterpolationBtn.show()},ae.prototype.shiftChangeLineSettingsBtn=function(){var t=this;t.type&&-1!==t.type.indexOf("Line")?t.changeLineSettingsBtn.show():t.changeLineSettingsBtn.hide()},ae.prototype.bindTips=function(){var t=this;$("body").delegate(".d3-tip.chart"+t.macroId+t.pageId,"mouseover",(function(){t.tipHover=!0})).delegate(".d3-tip.chart"+t.macroId+t.pageId,"mouseout",(function(){t.tipHover=!1,t.hideTips()}))},ae.prototype.getTimeFormat=function(t){var e=this;if(-1===e.workingDateFormat.toLowerCase().indexOf("hh:mm"))return function(t){return W.default.formatDate(t,e.workingDateFormat,e.locale)};var a=W.default.getDateFormatWithoutTime(e.workingDateFormat);return function(i){return 0===i.getHours()&&0===i.getMinutes()&&0===i.getSeconds()?W.default.formatDate(i,a,e.locale):t>864e6?W.default.formatDate(i,e.workingDateFormat,e.locale):W.default.formatTime(i,e.workingDateFormat)}},ae.prototype.getInterpolation=function(t){return function(t){switch(t){case"Linear":return r.default.curveLinear;case"Step":return r.default.curveStep;case"Natural cubic":return r.default.curveNatural;case"Monotone X cubic":return r.default.curveMonotoneX;case"Monotone Y cubic":return r.default.curveMonotoneY;case"Cubic CatmullRom":return r.default.curveCatmullRom;case"Cubic cardinal":return r.default.curveCardinal;case"Cubic basis":case"Straightened cubic basis":return r.default.curveBasis;default:return r.default.curveLinear}}(this.getInterpolationName(t))},ae.prototype.getInterpolationName=function(t){var e=this;return e.interpolation instanceof Array&&e.updateInterpolation(),e.interpolation[t]||(e.interpolation[t]=e.defaultInterpolation),e.interpolation[t]},ae.prototype.getLineWidth=function(t){var e=this;return e.lineSettings instanceof Array&&e.updateLineSettings(),e.lineSettings[t]&&e.lineSettings[t].width||1.5},ae.prototype.getLineType=function(t){var e=this;return e.lineSettings instanceof Array&&e.updateLineSettings(),e.lineSettings[t]&&e.lineSettings[t].type||"solid"},ae.prototype.updateInterpolation=function(){var t=this,e={};t.chartKeys.forEach((function(a,i){e[a]=i<t.interpolation.length?t.interpolation[i]:t.defaultInterpolation})),t.interpolation=e},ae.prototype.updateLineSettings=function(){var t=this,e={};t.chartKeys.forEach((function(a,i){e[a]=i<t.lineSettings.length?{type:t.lineSettings[i].split("-")[0],width:parseFloat(t.lineSettings[i].split("-")[1])}:{type:"solid",width:1.5}})),t.lineSettings=e},ae.prototype.getInnerLabelsParam=function(){var t=this;return t.showInnerLabels?t.innerLabelsType.value_percentage?"Value (Percentage)":t.innerLabelsType.percentage_value?"Percentage (Value)":t.innerLabelsType.percentage?"Percentage":t.innerLabelsType.value?"Value":"Donut"===t.type||"Pie"===t.type?"Percentage":"":"None"},ae.prototype.clearTableHighlight=function(){var t=this;t.originalTable.removeClass("tf-chart-highlight"),t.rows.forEach((function(t){t.filter(".tf-chart-highlight").removeClass("tf-chart-highlight")})),t.originalTable.trigger("tf-chart-highlight-off")},ae.prototype.highlightTable=function(t){var e,a=this;a.originalTable.addClass("tf-chart-highlight"),$.each(t.rowNumber,(function(i,n){var r=a.rows[i];n.forEach((function(t){var a=r.eq(t).addClass("tf-chart-highlight");e=e||!!(0,Jt.getChildren)(a).filter("[rowspan]").length})),a.originalTable.eq(i).trigger("tf-chart-highlight-on",{rowNumbers:n,column:t.column})})),e&&(a.originalTable.addClass("tf-table-with-rowspan"),(W.default.isIE11()||W.default.isSafari())&&a.originalTable.addClass("tf-opacity-highlight"))},ae.prototype.bindElementSelect=function(t,e,a){var i=this;function n(t){i.clearTableHighlight();var n=r.default.select(t);n.classed("highlighted",!n.classed("highlighted")),i.svgWrapper.find(e+".highlighted").each((function(){i.highlightTable(a?a(this):{rowNumber:this.__data__.rowNumber,column:i.getColumnNameForHighlight(this.__data__.name)})}))}t.selectAll(e).on("click",(function(){n(this)})),t.selectAll("text.inner-value-label, text.percent").on("click",(function(){var t=$(this.parentNode),a=t.find(e);n(a.eq(t.find("text.inner-value-label, text.percent").index(this)%a.length)[0])}))},ae.prototype.getColumnNameForHighlight=function(t){return t?this.columns.length<2?t:t.substring(0,t.lastIndexOf(" - ")):""},ae.prototype.triggerSettingsButtonInvoke=function(){var t=this;t.settings.trigger("aui-button-invoke"),t.settings.is(".active")&&t.settings.trigger("aui-button-invoke")},ae.prototype.formatBubbleLegend=function(t){var e=this,a=[];t.shapes._groups[0].forEach((function(t,i){var n=$(t).children("text"),r=$(t).children("rect"),u=n.text();r.attr("height",18).attr("width",18);var o=r.width()+5+(0,et.getTextWidth)(u),s=0,l=0;e.isLegendUnderGraph?(0===i||(e.bubblePieSetting.indexFirstLegendInRow||[]).includes(i)?(0!==i&&(r.attr("y",a[i-1].signaturePosY+5+18),n.attr("y",a[i-1].signaturePosY+5+18)),s=+r.attr("x"),l=+r.attr("y"),n.attr("x",+n.attr("x")+3)):(s=a[i-1].signaturePosX+a[i-1].width+10,l=a[i-1].signaturePosY,r.attr("y",l)),n.attr("y",l+13),a.push({width:o,signaturePosX:s,signaturePosY:l}),0!==i&&((e.bubblePieSetting.indexFirstLegendInRow||[]).includes(i)?0:(1,n.attr("x",+s+23),r.attr("x",+s)))):0!==i?(n.attr("y",+n.attr("y")+3+9*i),r.attr("y",+r.attr("y")+9*i)):n.attr("y",+n.attr("y")+3)}))},ae.prototype.calcBubbleChartExtremum=function(){var t,e,a=this,i=31536e6;if(null!=a.xminvalue){var n=W.default.getAnyValueType(a.xminvalue,a.separator,a.worklog,!0,a.dateFormat,a.locale);n===a.xValueType&&(a.bubblePieSetting.axisX.minValue=W.default.parseAnyValueByType(n,a.xminvalue,a.separator,a.worklog,!0,a.dateFormat,a.locale))}if(null!=a.xmaxvalue){var r=W.default.getAnyValueType(a.xmaxvalue,a.separator,a.worklog,!0,a.dateFormat,a.locale);r===a.xValueType&&(a.bubblePieSetting.axisX.maxValue=W.default.parseAnyValueByType(r,a.xmaxvalue,a.separator,a.worklog,!0,a.dateFormat,a.locale))}if(a.bubblePieSetting.axisX.maxValue<a.bubblePieSetting.axisX.minValue){var u=a.bubblePieSetting.axisX.minValue,o=a.bubblePieSetting.axisX.maxValue;a.bubblePieSetting.axisX.minValue=o,a.bubblePieSetting.axisX.maxValue=u}a.bubblePieSetting.axisX.maxValue===a.bubblePieSetting.axisX.minValue&&(a.xValueType===W.default.date?t=i/2:a.xValueType===W.default.worklog?t=W.default.parseAnyValueByType(a.xValueType,"8h",a.separator,a.worklog,!0,a.dateFormat,a.locale):a.xValueType===W.default.number?t=W.default.parseAnyValueByType(a.xValueType,.5*a.bubblePieSetting.axisX.maxValue,a.separator,a.worklog,!0,a.dateFormat,a.locale):a.xValueType===W.default.duration&&(t=W.default.parseAnyValueByType(a.xValueType,"8:00",a.separator,a.worklog,!0,a.dateFormat,a.locale)),a.bubblePieSetting.axisX.maxValue=+a.bubblePieSetting.axisX.maxValue+t,a.bubblePieSetting.axisX.minValue=a.bubblePieSetting.axisX.minValue-t);if(null!=a.yminvalue){var s=W.default.getAnyValueType(a.yminvalue,a.separator,a.worklog,!0,a.dateFormat,a.locale);s===a.valueType&&(a.bubblePieSetting.axisY.minValue=W.default.parseAnyValueByType(s,a.yminvalue,a.separator,a.worklog,!0,a.dateFormat,a.locale))}if(null!=a.ymaxvalue){var l=W.default.getAnyValueType(a.ymaxvalue,a.separator,a.worklog,!0,a.dateFormat,a.locale);l===a.valueType&&(a.bubblePieSetting.axisY.maxValue=W.default.parseAnyValueByType(l,a.ymaxvalue,a.separator,a.worklog,!0,a.dateFormat,a.locale))}if(a.bubblePieSetting.axisY.maxValue<a.bubblePieSetting.axisY.minValue){var c=a.bubblePieSetting.axisY.minValue,h=a.bubblePieSetting.axisY.maxValue;a.bubblePieSetting.axisY.minValue=h,a.bubblePieSetting.axisY.maxValue=c}a.bubblePieSetting.axisY.maxValue===a.bubblePieSetting.axisY.minValue&&(a.valueType===W.default.date?e=i/2:a.valueType===W.default.worklog?e=W.default.parseAnyValueByType(a.valueType,"8h",a.separator,a.worklog,!0,a.dateFormat,a.locale):a.valueType===W.default.number?e=W.default.parseAnyValueByType(a.valueType,.5*a.bubblePieSetting.axisY.maxValue,a.separator,a.worklog,!0,a.dateFormat,a.locale):a.valueType===W.default.duration&&(e=W.default.parseAnyValueByType(a.valueType,"8:00",a.separator,a.worklog,!0,a.dateFormat,a.locale)),a.bubblePieSetting.axisY.maxValue=+a.bubblePieSetting.axisY.maxValue+e,a.bubblePieSetting.axisY.minValue=a.bubblePieSetting.axisY.minValue-e)},ae.prototype.setBubbleAxisX=function(t){var e,a=this;if(a.xValueType===W.default.date){a.workingDateFormat=a.bubblePieSetting.axisX.dateFormat;var i=a.getTimeFormat(a.bubblePieSetting.axisX.maxValue-a.bubblePieSetting.axisX.minValue);(e=t.addTimeAxis("x",a.bubblePieSetting.axisX.title))._getFormat=function(){return i}}else a.xValueType===W.default.worklog?(e=t.addTimeAxis("x",a.bubblePieSetting.axisX.title))._getFormat=function(){return a.formatNumToX}:a.xValueType===W.default.number||a.xValueType===W.default.duration?(e=t.addMeasureAxis("x",a.bubblePieSetting.axisX.title))._getFormat=function(){return function(t){return a.formatNumToX(t)}}:(e=t.addCategoryAxis("x",a.bubblePieSetting.axisX.title))._getFormat=function(){return e.maxTextWidth=a.bubleMaxTextWidthX,ae.formatedMultiline(a.bubleMaxTextWidthX,null!==a.xValueType?a.formatNumToX:null)};return e},ae.prototype.setBubbleAxisY=function(t){var e,a=this;if(a.valueType===W.default.date){a.workingDateFormat=a.bubblePieSetting.axisY.dateFormat;var i=a.getTimeFormat(a.bubblePieSetting.axisY.maxValue-a.bubblePieSetting.axisY.minValue);(e=t.addTimeAxis("y",a.bubblePieSetting.axisY.title))._getFormat=function(){return i}}else a.valueType===W.default.worklog?(e=t.addTimeAxis("y",a.bubblePieSetting.axisY.title))._getFormat=function(){return a.formatNumTo}:a.valueType===W.default.number||a.valueType===W.default.duration?(e=t.addMeasureAxis("y",a.bubblePieSetting.axisY.title))._getFormat=function(){return function(t){return a.formatNumTo(t)}}:(e=t.addCategoryAxis("y",a.bubblePieSetting.axisY.title))._getFormat=function(){return e.maxTextWidth=a.bubleMaxTextWidthY,ae.formatedMultiline(a.bubleMaxTextWidthY,null!==a.valueType?a.formatNumTo:null)};return e},ae.prototype.setBubbleAxisXScale=function(t){var e=this;if(null!=e.bubblePieSetting.axisX.maxValue&&null!=e.bubblePieSetting.axisX.minValue&&e.bubblePieSetting.axisX.maxValue>e.bubblePieSetting.axisX.minValue){if(t.overrideMax=e.bubblePieSetting.axisX.maxValue,t.overrideMin=e.bubblePieSetting.axisX.minValue,!e.xScaleStep&&e.xValueType===W.default.date){var a=e.bubblePieSetting.axisX.maxValue-e.bubblePieSetting.axisX.minValue;a<1728e5?e.xScaleStep=Math.ceil(a/36e5/12)+"h":a<864e6&&(e.xScaleStep="1d")}if(e.xScaleStep){var i=W.default.parseNumber(e.xScaleStep.toString(),e.separator);e.xValueType===W.default.date&&(t.timePeriod=e.xScaleStep.indexOf("h")>-1?r.default.timeHour:e.xScaleStep.indexOf("w")>-1?r.default.timeWeek:e.xScaleStep.indexOf("m")>-1?r.default.timeMonth:e.xScaleStep.indexOf("y")>-1?r.default.timeYear:r.default.timeDay,t.timeInterval=i),e.xValueType===W.default.worklog&&(t.timePeriod=e.xScaleStep.indexOf("h")>-1?r.default.timeHour:e.xScaleStep.indexOf("w")>-1?r.default.timeWeek:r.default.timeDay,t.timeInterval=i)}}},ae.prototype.setBubbleAxisYScale=function(t){var e=this;if(null!=e.bubblePieSetting.axisY.maxValue&&null!=e.bubblePieSetting.axisY.minValue&&e.bubblePieSetting.axisY.maxValue>e.bubblePieSetting.axisY.minValue){if(t.overrideMax=e.bubblePieSetting.axisY.maxValue,t.overrideMin=e.bubblePieSetting.axisY.minValue,!e.yScaleStep&&e.valueType===W.default.date){var a=e.bubblePieSetting.axisY.maxValue-e.bubblePieSetting.axisY.minValue;a<1728e5?e.yScaleStep=Math.ceil(a/36e5/12)+"h":a<864e6&&(e.yScaleStep="1d")}if(e.yScaleStep){var i=W.default.parseNumber(e.yScaleStep.toString(),e.separator);e.valueType===W.default.date&&(t.timePeriod=e.yScaleStep.indexOf("h")>-1?r.default.timeHour:e.yScaleStep.indexOf("w")>-1?r.default.timeWeek:e.yScaleStep.indexOf("m")>-1?r.default.timeMonth:e.yScaleStep.indexOf("y")>-1?r.default.timeYear:r.default.timeDay,t.timeInterval=i),e.valueType===W.default.worklog&&(t.timePeriod=e.yScaleStep.indexOf("h")>-1?r.default.timeHour:e.yScaleStep.indexOf("w")>-1?r.default.timeWeek:r.default.timeDay,t.timeInterval=i)}}},ae.prototype.settingBubbleAxis=function(t,e){var a=this;t.showGridlines=a.grid,e.showGridlines=a.grid,t.title=a.xtitle||"",e.title=a.ytitle||"",t.fontSize="14px",e.fontSize="14px"},ae.prototype.calculateBubbleLegendSize=function(){var t=this;if(t.isLegendUnderGraph){var e=function(t,e,a,i){for(var n,r=0,u=[],o=ut(t,a,i),s=n=o.width<=e?e/2-o.width/2:20,l=0;l<t.length;l++)0!==l&&n+o.values[l-1].width+o.values[l].width<e?n+=o.values[l-1].width:(u.push(l),r+=1,n=o.width<=e?e/2-o.width/2:20);return{rows:r,maxWidth:o.keysWidth,firstInRow:u,posX:s}}(t.bubblePieSetting.filterAggregation.slice(),t.width-(20+t.bubblePieSetting.axisY.longestTitle+5+t.ytitleHeight),t.isPivot,36);t.bubblePieSetting.legendHeight=25*(e.rows+1),t.bubblePieSetting.indexFirstLegendInRow=e.firstInRow,t.bubblePieSetting.posX=e.posX}else{var a=W.default.getLongestWordInArr(t.bubblePieSetting.filterAggregation).substr(0,ae.textMaxLength);t.bubblePieSetting.legendWidth=23+(0,et.getTextWidth)(a),t.bubblePieSetting.legendHeight=22*t.bubblePieSetting.filterAggregation.length}},ae.prototype.optimizeBubbleMultilineWidth=function(t,e,a,i){var n=this,r=0,u=0,o=n.bubleMaxTextWidthX,s=n.bubleMaxTextWidthY,l=n.width-t.left-t.right,c=n.height-t.top-t.bottom,h=n.bubblePieSetting.axisX.order.length,d=n.bubblePieSetting.axisY.order.length,p=function(){s=ae.calcTextMaxWidth(c/d,n.bubblePieSetting.axisY.longestTitleObject,n.bubleMaxTextWidthY),r=s-n.bubleMaxTextWidthY,l-=r},g=function(){var t,i;a.maxTextWidth&&p(),e.maxTextWidth&&(i=(t=l/h)>e.maxTextWidth,o=i?Math.min(t-5,n.bubblePieSetting.axisX.longestTitleObject.width):ae.calcTextMaxWidth(t,n.bubblePieSetting.axisX.longestTitleObject,n.bubleMaxTextWidthX),i?(n.bubleMaxTextWidthX=o,u=0):(u=o-n.bubleMaxTextWidthX,c-=u)),u&&!r&&a.maxTextWidth&&p(),u&&(n.bubleMaxTextWidthX=o,n.maxSizeX=n.bubleMaxTextWidthX),r&&(n.bubleMaxTextWidthY=s,n.bubblePieSetting.axisY.longestTitle=n.bubleMaxTextWidthY+9)},f=0;do{g()}while((r>0||u>0)&&++f<2&&l>0&&c>0);i&&i(),t.left>n.width-t.right&&(t.left=n.width-t.right-100),t.bottom>n.height-t.top&&(t.bottom=n.height-t.top-100)},ae.prototype.formatDimpleAxisX=function(t){t.shapes.selectAll("text").each((function(){if(!$(this).attr("transform"))return!1;var t=r.default.select(this),e=t.attr("transform").replace("rotate(90","rotate(-90").replace("translate(-5","translate(5");t.attr("transform",e),"start"===t.style("text-anchor")&&t.style("text-anchor","end")})).call(ae.multilineAlign),this.xtitleHeight&&t.titleShape.attr("y",+t.titleShape.attr("y")+5)},ae.prototype.eventHandlerSeries=function(t,e){var a=this,i={},n={},r={};t.shapes.on("click",(function(t,u){var o="push",s=u.aggField[0],l=u.aggField[1],c=u.cy,h=u.cx,d=u.aggField[2],p=this;p.classList.contains("highlighted")?(p.classList.remove("highlighted"),o="remove"):p.classList.add("highlighted"),e.forEach((function(t){if(n[t.tableI]||(n[t.tableI]=[0]),-1===n[t.tableI].indexOf(t.rowI)&&n[t.tableI].push(t.rowI),t.indicator===d){if(a.valueType===W.default.number||a.valueType===W.default.duration){if(t["orig_"+a.bubblePieSetting.axisY.title]!==c)return}else if(t[a.bubblePieSetting.axisY.title]!==l)return;if(a.xValueType===W.default.number||a.xValueType===W.default.duration){if(t["orig_"+a.bubblePieSetting.axisX.title]!==h)return}else if(t[a.bubblePieSetting.axisX.title]!==s)return;"push"===o?(i[t.tableI]||(i[t.tableI]=[0],r[t.tableI]=[]),-1===i[t.tableI].indexOf(t.rowI)&&i[t.tableI].push(t.rowI),r[t.tableI].push(t.rowI)):(r[t.tableI].indexOf(t.rowI)>-1&&r[t.tableI].splice(r[t.tableI].indexOf(t.rowI),1),i[t.tableI].indexOf(t.rowI)>-1&&-1===r[t.tableI].indexOf(t.rowI)&&i[t.tableI].splice(i[t.tableI].indexOf(t.rowI),1),1===i[t.tableI].length&&delete i[t.tableI])}})),a.clearTableHighlight(),a.highlightTable({rowNumber:$.isEmptyObject(i)?n:i})}))},ae.prototype.eventHandleLegendClick=function(t,e,a,i){var n=this;t.legends=[];var u=s().getUniqueValues(a,"indicator");e.shapes.selectAll("rect").on("click",(function(e,o){var l=!1,c=[];u.forEach((function(t){t===o.aggField.slice(-1)[0]?l=!0:c.push(t)})),l?r.default.select(this).style("opacity",.2):(c.push(o.aggField.slice(-1)[0]),r.default.select(this).style("opacity",1)),u=c;var h=n.bubblePieSetting.axisX.title,d=n.bubblePieSetting.axisY.title;n.bubblePieSetting.sameValuesCount={},a.forEach((function(t){u.includes(t.indicator)&&(n.valueType!==W.default.number&&n.valueType!==W.default.duration&&n.xValueType!==W.default.number&&n.xValueType!==W.default.duration||(n.bubblePieSetting.sameValuesCount[(t["orig_"+h]||t[h])+"_"+(t["orig_"+d]||t[d])]>0?n.bubblePieSetting.sameValuesCount[(t["orig_"+h]||t[h])+"_"+(t["orig_"+d]||t[d])]+=1:n.bubblePieSetting.sameValuesCount[(t["orig_"+h]||t[h])+"_"+(t["orig_"+d]||t[d])]=1))}));var p=s().filterData(a,"indicator",u);p.forEach((function(t){n.valueType!==W.default.number&&n.valueType!==W.default.duration||(t[d]=parseFloat(t["orig_"+d]/n.bubblePieSetting.sameValuesCount[(t["orig_"+h]||t[h])+"_"+(t["orig_"+d]||t[d])])),n.xValueType!==W.default.number&&n.xValueType!==W.default.duration||(t[h]=parseFloat(t["orig_"+h]/n.bubblePieSetting.sameValuesCount[(t["orig_"+h]||t[h])+"_"+(t["orig_"+d]||t[d])]))})),t.data=p,t.draw(),i&&i()}))},ae.prototype.settingSeriesTooltip=function(t){var e=this;t.getTooltipText=function(t){var a=function(t,a,i){return W.default.formatAnyValueByType(t,a,(function(t){return t>=1e4?e.formatNum.to(t):e.formatNumShort.to(t)}),e.worklog,i,e.locale,e.separator)},i=null!==e.xValueType?a(t.cx,e.xValueType,e.bubblePieSetting.axisX.dateFormat):t.cx,n=null!==e.valueType?a(t.cy,e.valueType,e.bubblePieSetting.axisY.dateFormat):t.cy,r=null!==e.bubblePieSetting.indicator.valueType?a(t.cz,e.bubblePieSetting.indicator.valueType):t.cz;switch(e.getInnerLabelsParam()){case"Value (Percentage)":r+=" ("+Math.round(100*t.piePct)+"%)";break;case"Percentage (Value)":r=Math.round(100*t.piePct)+"% ("+r+")";break;case"Percentage":r=Math.round(100*t.piePct)+"%"}return[e.bubblePieSetting.axisX.title+": "+i,e.bubblePieSetting.axisY.title+": "+n,t.aggField[2]+": "+r]}},ae.prototype.formatExtremumAxesX=function(t,e,a,i){var n=this;if(null!==n.xValueType||null!==n.valueType){var r=le($(i.svg._groups[0])),u={left:0,right:0,tickXSize:0},o=0,s=0,l=0;t.shapes.selectAll("g").each((function(){o+=1})),u.left=r.left+a.left,u.right=r.right-a.right,u.tickXSize=r.width/o,e.shapes.each((function(){var t=le($(this));t.left<u.left&&(l=Math.max(l,u.left-t.left)),t.right>u.right&&(s=Math.max(s,t.right-u.right))})),l>0&&null!==n.xValueType&&(t.overrideMin-=(t.overrideMax-t.overrideMin)/o*Math.ceil(l/u.tickXSize)),s>0&&null!==n.xValueType&&(t.overrideMax=+t.overrideMax+(t.overrideMax-t.overrideMin)/o*Math.ceil(s/u.tickXSize))}},ae.prototype.formatExtremumAxesY=function(t,e,a,i){var n=this;if(null!==n.xValueType||null!==n.valueType){var r=ce($(i.svg._groups[0])),u={top:0,bottom:0,tickYSize:0},o=0,s=0,l=0;t.shapes.selectAll("g").each((function(){o+=1})),u.top=r.top+a.top,u.bottom=r.bottom-a.bottom,u.tickYSize=r.height/o,e.shapes.each((function(){var t=ce($(this));t.top<u.top&&(s=Math.max(s,u.top-t.top)),t.bottom>u.bottom&&(l=Math.max(l,t.bottom-u.bottom))})),s>0&&null!==n.valueType&&(t.overrideMax=+t.overrideMax+(t.overrideMax-t.overrideMin)/o*Math.ceil(s/u.tickYSize)),l>0&&null!==n.valueType&&(t.overrideMin-=(t.overrideMax-t.overrideMin)/o*Math.ceil(l/u.tickYSize))}},ae.calcTextMaxWidth=xt,ae.formatedMultiline=function(t,e){return function(a,i){if(a=e?e(a,i):a,(0,et.getTextWidth)(a)<=t)return a;var n=this.cloneNode(!0);return this.parentNode.insertBefore(n,this),r.default.select(n).text(a).call(ae.textToMultiline,t),this.parentNode.removeChild(this),null}},ae.textsToMultiline=function(t,e,a){return t.each((function(){ae.textToMultiline(r.default.select(this),e,a)})),t},ae.textToMultiline=function(t,e,a){e=e||ae.textMaxWidth,a=a||"middle";var i=t.text();if((0,et.getTextWidth)(i)<=e)return t;ae.stringToLines=mt;var n=ae.stringToLines(i,e),r=t.attr("x")||"0em";return t.text(null),n.forEach((function(e,a){t.append("tspan").attr("x",r).attr("dy","1em").text(e)})),t.call(ae.tspanAlign,a),t},ae.multilineAlign=function(t,e){return t.each((function(){ae.tspanAlign(r.default.select(this),e)})),t},ae.tspanAlign=function(t,e){var a=t.selectAll("tspan");if(e=e||("middle"===t.style("text-anchor")?"top":"middle"),a.size()){var i=parseFloat(t.attr("dy"))||0;"middle"===e&&(i-=(a.size()-1)/2),r.default.select(a.nodes()[0]).attr("dy",i+"em")}return t},ae.getMultilineHeight=function(t){var e=0;return t.each((function(){r.default.select(this).select("tspan").size()&&(e=Math.max(this.getBBox().height,e))})),e},ae.initParamBarColoringType=function(t){return t.barColoringType||(t.barColoringType="Gantt"===t.type?"multi":"mono"),t.barColoringType},ae.prototype.updateColorsKeyMap=function(t){var e=this.getAllChartColorLabels();return this.colorKeyMap=e.reduce((function(e,a,i){return e[a]=t[i],e}),{}),this.colorKeyMap},ae.prototype.getColorsFromMap=function(t,e,a){var i=e.map((function(e){return t[e]})),n=i.filter((function(t){return t})),r=n.length;fe(n,a);var u=0;return fe(i=i.slice(0,e.length).map((function(a,i){return a||(a=n[(r+u++)%n.length],t[e[i]]=a),a})),a),i},ae.prototype.setIsMultiColorColumn=function(){this.isMultiColorColumn="multi"===this.barColoringType&&this.columns.length<=1&&this.aggregation.length<=1&&-1!==["Column","Bar"].indexOf(this.type)};var xe=ae},7559:function(t,e,a){var i,n;function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}!function(u,o){"use strict";"object"==r(e)?t.exports=o(a(2506)):(i=[a(2506)],void 0===(n=function(t){return u.dimple=o(t),u.dimple}.apply(e,i))||(t.exports=n))}(this,(function(t){"use strict";var e={version:"2.2.0",plot:{},aggregateMethod:{},axis:function(a,i,n,r,u,o){this.chart=a,this.position=i,this.categoryFields=null==u?n:[].concat(u),this.measure=r,this.timeField=u,this.floatingBarWidth=5,this.hidden=!1,this.showPercent=!1,this.colors=null,this.overrideMin=null,this.overrideMax=null,this.shapes=null,this.showGridlines=null,this.gridlineShapes=null,this.titleShape=null,this.dateParseFormat=null,this.tickFormat=null,this.timePeriod=null,this.timeInterval=1,this.useLog=!1,this.logBase=10,this.title=void 0,this.clamp=!0,this.ticks=null,this.fontSize="10px",this.fontFamily="sans-serif",this.autoRotateLabel=null==o||o,this._slaves=[],this._scale=null,this._min=0,this._max=0,this._previousOrigin=null,this._origin=null,this._orderRules=[],this._groupOrderRules=[],this._draw=null,this._getAxisData=function(){var t,e,a=[],i=!1;if(this.chart&&this.chart.series){for(t=0;t<this.chart.series.length;t+=1)(e=this.chart.series[t])[this.position]===this&&(e.data&&e.data.length>0?a=a.concat(e.data):i=!0);i&&this.chart.data&&(a=a.concat(this.chart.data))}return a},this._getFontSize=function(){return this.fontSize&&"auto"!==this.fontSize.toString().toLowerCase()?isNaN(this.fontSize)?this.fontSize:this.fontSize+"px":(this.chart._heightPixels()/35>10?this.chart._heightPixels()/35:10)+"px"},this._getFormat=function(){var e,a,i,n,r,u,o;return null!==this.tickFormat&&void 0!==this.tickFormat?e=this._hasTimeField()?t.timeFormat(this.tickFormat):t.format(this.tickFormat):this.showPercent?e=t.format(".0%"):this.useLog&&null!==this.measure?e=function(e){var a=Math.floor(Math.abs(e),0).toString().length,i=Math.min(Math.floor((a-1)/3),4),n="kmBT".substring(i-1,i),r="0"===Math.round(e/Math.pow(1e3,i)*10).toString().slice(-1)?0:1;return 0===e?0:t.format(",."+r+"f")(e/Math.pow(1e3,i))+n}:null!==this.measure?(a=Math.floor(Math.abs(this._max),0).toString(),i=Math.floor(Math.abs(this._min),0).toString(),(n=Math.max(i.length,a.length))>3?(r=Math.min(Math.floor((n-1)/3),4),u="kmBT".substring(r-1,r),o=n-3*r<=1?1:0,e=function(e){return 0===e?0:t.format(",."+o+"f")(e/Math.pow(1e3,r))+u}):(o=Math.max(-(this._tick_step?Math.floor(Math.log(this._tick_step)/Math.LN10):0),0),e=t.format(",."+o+"f"))):e=function(t){return t},e},this._getTimePeriod=function(){var e=this.timePeriod,a=30,i=this._max-this._min;return this._hasTimeField()&&!this.timePeriod&&(e=i/1e3<=a?t.timeSecond:i/6e4<=a?t.timeMinute:i/36e5<=a?t.timeHour:i/864e5<=a?t.timeHay:i/6048e5<=a?t.timeWeek:i/26298e5<=a?t.timeMonth:t.timeYear),e},this._getTooltipText=function(e,a){if(this._hasTimeField())a[this.position+"Field"][0]&&e.push(this.timeField+": "+this._getFormat()(a[this.position+"Field"][0]));else if(this._hasCategories())this.categoryFields.forEach((function(t,i){null!=t&&a[this.position+"Field"][i]&&e.push(t+(a[this.position+"Field"][i]!==t?": "+a[this.position+"Field"][i]:""))}),this);else if(this._hasMeasure())switch(this.position){case"x":e.push(this.measure+": "+this._getFormat()(a.width));break;case"y":e.push(this.measure+": "+this._getFormat()(a.height));break;case"p":e.push(this.measure+": "+this._getFormat()(a.angle)+" ("+t.format(".0%")(a.piePct)+")");break;default:e.push(this.measure+": "+this._getFormat()(a[this.position+"Value"]))}},this._getTopMaster=function(){var t=this;return null!==this.master&&void 0!==this.master&&(t=this.master._getTopMaster()),t},this._hasCategories=function(){return null!==this.categoryFields&&void 0!==this.categoryFields&&this.categoryFields.length>0},this._hasMeasure=function(){return null!==this.measure&&void 0!==this.measure},this._hasTimeField=function(){return null!==this.timeField&&void 0!==this.timeField},this._parseDate=function(e){return null===this.dateParseFormat||void 0===this.dateParseFormat?isNaN(e)?Date.parse(e):new Date(e):t.timeParse(this.dateParseFormat)(e)},this._update=function(a){var i,n,r,u,o=[],s=this.ticks||10,l=function(t,a,i){var n,r,u=t.categoryFields[0],o=t._getAxisData(),s=u,l=!1,c=!0,h=null;for(n=0;n<o.length;n+=1)if(null!=(h=t._parseDate(o[n][u]))&&isNaN(h)){c=!1;break}return c||t.chart.series.forEach((function(e){e[a]===t&&e[i]._hasMeasure()&&(s=e[i].measure,l=!0)}),this),r=t._orderRules.concat({ordering:s,desc:l}),e._getOrderedList(o,u,r)};if(this._min=this.showPercent&&this._min<-1?-1:this._min,this._max=this.showPercent&&this._max>1?1:this._max,this._min=null!==this.overrideMin?this.overrideMin:this._min,this._max=null!==this.overrideMax?this.overrideMax:this._max,"x"!==this.position||null!==this._scale&&!a){if("y"!==this.position||null!==this._scale&&!a)this.position.length>0&&"z"===this.position[0]&&null===this._scale?this.useLog?this._scale=t.scaleLog().range([this.chart._heightPixels()/300,this.chart._heightPixels()/10]).domain([0===this._min?Math.pow(this.logBase,-1):this._min,0===this._max?-1*Math.pow(this.logBase,-1):this._max]).clamp(this.clamp).base(this.logBase):this._scale=t.scaleLinear().range([1,this.chart._heightPixels()/10]).domain([this._min,this._max]).clamp(this.clamp):this.position.length>0&&"p"===this.position[0]&&null===this._scale?this.useLog?this._scale=t.scaleLog().range([0,360]).domain([0===this._min?Math.pow(this.logBase,-1):this._min,0===this._max?-1*Math.pow(this.logBase,-1):this._max]).clamp(this.clamp).base(this.logBase):this._scale=t.scaleLinear().range([0,360]).domain([this._min,this._max]).clamp(this.clamp):this.position.length>0&&"c"===this.position[0]&&null===this._scale&&(this._scale=t.scaleLinear().range([0,null===this.colors||1===this.colors.length?1:this.colors.length-1]).domain([this._min,this._max]).clamp(this.clamp));else if(this._hasTimeField()?this._scale=t.scaleTime().range([this.chart._yPixels()+this.chart._heightPixels(),this.chart._yPixels()]).domain([this._min,this._max]).clamp(this.clamp):this.useLog?this._scale=t.scaleLog().range([this.chart._yPixels()+this.chart._heightPixels(),this.chart._yPixels()]).domain([0===this._min?Math.pow(this.logBase,-1):this._min,0===this._max?-1*Math.pow(this.logBase,-1):this._max]).clamp(this.clamp).base(this.logBase).nice():null===this.measure||void 0===this.measure?(o=l(this,"y","x"),null!==this._slaves&&void 0!==this._slaves&&this._slaves.forEach((function(t){o=o.concat(l(t,"y","x"))}),this),this._scale=t.scalePoint().range([this.chart._yPixels()+this.chart._heightPixels(),this.chart._yPixels()]).domain(o.concat([""]))):this._scale=t.scaleLinear().range([this.chart._yPixels()+this.chart._heightPixels(),this.chart._yPixels()]).domain([this._min,this._max]).clamp(this.clamp).nice(),!this.hidden)switch(this.chart._axisIndex(this,"y")){case 0:this._draw=t.axisLeft().scale(this._scale),this.ticks&&this._draw.ticks(s);break;case 1:this._draw=t.axisRight().scale(this._scale),this.ticks&&this._draw.ticks(s)}}else if(this._hasTimeField()?this._scale=t.scaleTime().range([this.chart._xPixels(),this.chart._xPixels()+this.chart._widthPixels()]).domain([this._min,this._max]).clamp(this.clamp):this.useLog?this._scale=t.scaleLog().range([this.chart._xPixels(),this.chart._xPixels()+this.chart._widthPixels()]).domain([0===this._min?Math.pow(this.logBase,-1):this._min,0===this._max?-1*Math.pow(this.logBase,-1):this._max]).clamp(this.clamp).base(this.logBase).nice():null===this.measure||void 0===this.measure?(o=l(this,"x","y"),null!==this._slaves&&void 0!==this._slaves&&this._slaves.forEach((function(t){o=o.concat(l(t,"x","y"))}),this),this._scale=t.scalePoint().range([this.chart._xPixels(),this.chart._xPixels()+this.chart._widthPixels()]).domain(o.concat([""]))):this._scale=t.scaleLinear().range([this.chart._xPixels(),this.chart._xPixels()+this.chart._widthPixels()]).domain([this._min,this._max]).clamp(this.clamp).nice(),!this.hidden)switch(this.chart._axisIndex(this,"x")){case 0:this._draw=t.axisBottom().scale(this._scale),this.ticks&&this._draw.ticks(s);break;case 1:this._draw=t.axisTop().scale(this._scale),this.ticks&&this._draw.ticks(s)}return null!==this._slaves&&void 0!==this._slaves&&this._slaves.length>0&&this._slaves.forEach((function(t){t._scale=this._scale}),this),null!=a&&!1!==a||this._hasTimeField()||null===this._scale||null===this._scale.ticks||void 0===this._scale.ticks||!(this._scale.ticks(s).length>0)||"x"!==this.position&&"y"!==this.position||(n=(i=this._scale.ticks(s))[1]-i[0],r=((this._max-this._min)%n).toFixed(0),this._tick_step=n,0!==r&&(this._max=Math.ceil(this._max/n)*n,this._min=Math.floor(this._min/n)*n,this._update(!0))),u=null!=o&&o.length>0?this._scale.copy()(o[0]):this._min>0?this._scale.copy()(this._min):this._max<0?this._scale.copy()(this._max):this._scale.copy()(0),this._origin!==u&&(this._previousOrigin=null===this._origin?u:this._origin,this._origin=u),this},this.addGroupOrderRule=function(t,e){this._groupOrderRules.push({ordering:t,desc:e})},this.addOrderRule=function(t,e){this._orderRules.push({ordering:t,desc:e})}},chart:function(a,i){this.svg=a,this.x="10%",this.y="10%",this.width="80%",this.height="80%",this.data=i,this.noFormats=!1,this.axes=[],this.series=[],this.legends=[],this.storyboard=null,this.titleShape=null,this.shapes=null,this.ease=t.easeCubicInOut,this.staggerDraw=!1,this.transition={},this._group=a.append("g"),this._group.attr("class","dimple-chart"),this._gridlines_group=this._group.insert("g"),this._gridlines_group.attr("class","dimple-gridlines-group"),this._axis_group=this._group.insert("g"),this._axis_group.attr("class","dimple-axis-group"),this._tooltipGroup=null,this._assignedColors={},this._assignedClasses={},this._nextColor=0,this._nextClass=0,this._axisIndex=function(t,e){var a=0,i=0,n=-1;for(a=0;a<this.axes.length;a+=1){if(this.axes[a]===t){n=i;break}null!=e&&e[0]!==this.axes[a].position[0]||(i+=1)}return n},this._getAllData=function(){var t=[];return null!==this.data&&void 0!==this.data&&this.data.length>0&&(t=t.concat(this.data)),null!==this.series&&void 0!==this.series&&this.series.length>0&&this.series.forEach((function(e){null!==e.data&&void 0!==e.data&&e.data.length>0&&(t=t.concat(e.data))})),t},this._getData=function(a,i,n,r,u,o,s,l,c,h){var d,p,g=[],f=function(t,e){var a=[];return null!==t&&(t._hasTimeField()?a.push(t._parseDate(e[t.timeField])):t._hasCategories()&&t.categoryFields.forEach((function(t){a.push(e[t])}),this)),a},m={x:!1,y:!1,z:!1,p:!1,c:!1},x={x:[],y:[]},y={x:[],y:[],z:[],p:[]},D={min:null,max:null},v={x:[],y:[],z:[],p:[]},b=[],F={},C={x:0,y:0,z:0,p:0},A="",E=[],_=[],w=[],B="",k=[],S="",T=[],P="",L=[],M=[],I=a,V=[];for(p in this.storyboard&&this.storyboard.categoryFields.length>0&&(A=this.storyboard.categoryFields[0],E=e._getOrderedList(I,A,this.storyboard._orderRules)),o&&o._hasCategories()&&o._hasMeasure()&&(B=o.categoryFields[0],k=e._getOrderedList(I,B,o._orderRules.concat([{ordering:o.measure,desc:!0}]))),s&&s._hasCategories()&&s._hasMeasure()&&(S=s.categoryFields[0],T=e._getOrderedList(I,S,s._orderRules.concat([{ordering:s.measure,desc:!0}]))),c&&c._hasCategories()&&c._hasMeasure()&&(P=c.categoryFields[0],L=e._getOrderedList(I,P,c._orderRules.concat([{ordering:c.measure,desc:!0}]))),I.length>0&&i&&i.length>0&&(M=[].concat(r),_=[],i.forEach((function(t){void 0!==I[0][t]&&_.push(t)}),this),c&&c._hasMeasure()?M.push({ordering:c.measure,desc:!0}):h&&h._hasMeasure()?M.push({ordering:h.measure,desc:!0}):l&&l._hasMeasure()?M.push({ordering:l.measure,desc:!0}):o&&o._hasMeasure()?M.push({ordering:o.measure,desc:!0}):s&&s._hasMeasure()&&M.push({ordering:s.measure,desc:!0}),w=e._getOrderedList(I,_,M)),I.sort((function(t,e){var a,i,n,r,u,o,s=0;if(""!==A&&(s=E.indexOf(t[A])-E.indexOf(e[A])),""!==B&&0===s&&(s=k.indexOf(t[B])-k.indexOf(e[B])),""!==S&&0===s&&(s=T.indexOf(t[S])-T.indexOf(e[S])),""!==P&&0===s&&(s=L.indexOf(t[P])-T.indexOf(e[P])),_&&_.length>0&&0===s)for(a=[].concat(_),s=0,n=0;n<w.length;n+=1){for(i=[].concat(w[n]),u=!0,o=!0,r=0;r<a.length;r+=1)u=u&&t[a[r]]===i[r],o=o&&e[a[r]]===i[r];if(u||o){s=u&&o?0:u?-1:1;break}}return s})),I.forEach((function(t){var e,a,r,u,d,p=-1,x=f(o,t),y=f(s,t),D=f(l,t),v=f(c,t),b=[];if(i&&0!==i.length)for(r=0;r<i.length;r+=1)void 0===t[i[r]]?b.push(i[r]):b.push(t[i[r]]);else b=["All"];for(e=b.join("/")+"_"+x.join("/")+"_"+y.join("/")+"_"+v.join("/")+"_"+D.join("/"),a=0;a<g.length;a+=1)if(g[a].key===e){p=a;break}-1===p&&(u={key:e,aggField:b,xField:x,xValue:null,xCount:0,yField:y,yValue:null,yCount:0,pField:v,pValue:null,pCount:0,zField:D,zValue:null,zCount:0,cValue:0,cCount:0,x:0,y:0,xOffset:0,yOffset:0,width:0,height:0,cx:0,cy:0,xBound:0,yBound:0,xValueList:[],yValueList:[],zValueList:[],pValueList:[],cValueList:[],fill:{},stroke:{}},g.push(u),p=g.length-1),(d=function(e,a){var i,r,u=!0,o={value:0,count:1},s={value:0,count:1},l="";null!==a&&(i=a.getFrameValue(),a.categoryFields.forEach((function(e,a){a>0&&(l+="/"),l+=t[e],u=l===i}),this)),null!=e&&u&&(r=g[p],e._hasMeasure()&&null!==t[e.measure]&&void 0!==t[e.measure]&&(-1===r[e.position+"ValueList"].indexOf(t[e.measure])&&r[e.position+"ValueList"].push(t[e.measure]),isNaN(parseFloat(t[e.measure]))&&(m[e.position]=!0),o.value=r[e.position+"Value"],o.count=r[e.position+"Count"],s.value=t[e.measure],r[e.position+"Value"]=n(o,s),r[e.position+"Count"]+=1))})(o,this.storyboard),d(s,this.storyboard),d(l,this.storyboard),d(c,this.storyboard),d(h,this.storyboard)}),this),o&&o._hasCategories()&&o.categoryFields.length>1&&void 0!==x.x&&(V=[],s._hasMeasure()&&V.push({ordering:s.measure,desc:!0}),x.x=e._getOrderedList(I,o.categoryFields[1],o._groupOrderRules.concat(V))),s&&s._hasCategories()&&s.categoryFields.length>1&&void 0!==x.y&&(V=[],o._hasMeasure()&&V.push({ordering:o.measure,desc:!0}),x.y=e._getOrderedList(I,s.categoryFields[1],s._groupOrderRules.concat(V)),x.y.reverse()),g.forEach((function(t){null!==o&&(!0===m.x&&(t.xValue=t.xValueList.length),d=o._hasMeasure()&&o._hasCategories()?(y.x[t.xField.join("/")]||0)+(o._hasMeasure()?Math.abs(t.xValue):0):(y.x[t.xField.join("/")]||0)+(s._hasMeasure()?Math.abs(t.yValue):0),y.x[t.xField.join("/")]=d),null!==s&&(!0===m.y&&(t.yValue=t.yValueList.length),d=s._hasMeasure()&&s._hasCategories()?(y.y[t.yField.join("/")]||0)+(s._hasMeasure()?Math.abs(t.yValue):0):(y.y[t.yField.join("/")]||0)+(o._hasMeasure()?Math.abs(t.xValue):0),y.y[t.yField.join("/")]=d),null!==c&&(!0===m.p&&(t.pValue=t.pValueList.length),d=(y.p[t.pField.join("/")]||0)+(c._hasMeasure()?Math.abs(t.pValue):0),y.p[t.pField.join("/")]=d),null!==l&&(!0===m.z&&(t.zValue=t.zValueList.length),d=(y.z[t.zField.join("/")]||0)+(l._hasMeasure()?Math.abs(t.zValue):0),y.z[t.zField.join("/")]=d),null!==h&&((null===D.min||t.cValue<D.min)&&(D.min=t.cValue),(null===D.max||t.cValue>D.max)&&(D.max=t.cValue))}),this),y.x)y.x.hasOwnProperty(p)&&(C.x+=y.x[p]);for(p in y.y)y.y.hasOwnProperty(p)&&(C.y+=y.y[p]);for(p in y.p)y.p.hasOwnProperty(p)&&(C.p+=y.p[p]);for(p in y.z)y.z.hasOwnProperty(p)&&(C.z+=y.z[p]);return g.forEach((function(e){var a,i,n,r,d=function(t,a,i){var n,r,o,s,l;null!=t&&(s=t.position,t._hasCategories()?t._hasMeasure()?(n=e[t.position+"Field"].join("/"),r=t.showPercent?y[t.position][n]/C[t.position]:y[t.position][n],-1===b.indexOf(n)&&(F[n]=r+(b.length>0?F[b[b.length-1]]:0),b.push(n)),o=e[s+"Bound"]=e["c"+s]="x"!==s&&"y"!==s||!u?r:F[n],e[i]=r,e[s]=o-("x"===s&&r>=0||"y"===s&&r<=0?r:0)):(e[s]=e["c"+s]=e[s+"Field"][0],e[i]=1,void 0!==x[s]&&null!==x[s]&&x[s].length>=2&&(e[s+"Offset"]=x[s].indexOf(e[s+"Field"][1]),e[i]=1/x[s].length)):(r=t.showPercent?e[s+"Value"]/y[a][e[a+"Field"].join("/")]:e[s+"Value"],n=e[a+"Field"].join("/")+(e[s+"Value"]>=0),l=v[s][n]=(null===v[s][n]||void 0===v[s][n]||"z"===s||"p"===s?0:v[s][n])+r,o=e[s+"Bound"]=e["c"+s]="x"!==s&&"y"!==s||!u?r:l,e[i]=r,e[s]=o-("x"===s&&r>=0||"y"===s&&r<=0?r:0)))};d(o,"y","width"),d(s,"x","height"),d(l,"z","r"),d(c,"p","angle"),null!==h&&null!==D.min&&null!==D.max&&(D.min===D.max&&(D.min-=.5,D.max+=.5),D.min=h.overrideMin||D.min,D.max=h.overrideMax||D.max,e.cValue=e.cValue>D.max?D.max:e.cValue<D.min?D.min:e.cValue,r=(n=t.scaleLinear().range([0,null===h.colors||1===h.colors.length?1:h.colors.length-1]).domain([D.min,D.max])(e.cValue))-Math.floor(n),e.cValue===D.max&&(r=1),h.colors&&1===h.colors.length?(a=t.rgb(h.colors[0]),i=t.rgb(this.getColor(e.aggField.slice(-1)[0]).fill)):h.colors&&h.colors.length>1?(a=t.rgb(h.colors[Math.floor(n)]),i=t.rgb(h.colors[Math.ceil(n)])):(a=t.rgb("white"),i=t.rgb(this.getColor(e.aggField.slice(-1)[0]).fill)),a.r=Math.floor(a.r+(i.r-a.r)*r),a.g=Math.floor(a.g+(i.g-a.g)*r),a.b=Math.floor(a.b+(i.b-a.b)*r),e.fill=a.toString(),e.stroke=a.darker(.5).toString())}),this),g},this._getDelay=function(t,a,i){return function(n){var r=0;return i&&a.staggerDraw&&(i.x._hasCategories()?r=e._helpers.cx(n,a,i)/a._widthPixels()*t:i.y._hasCategories()&&(r=(1-e._helpers.cy(n,a,i)/a._heightPixels())*t)),r}},this._getSeriesData=function(){null!==this.series&&void 0!==this.series&&this.series.forEach((function(t){var e,a,i,n,r,u=t.data||this.data||[],o=[].concat(t.categoryFields||"All"),s=this._getData(u,o,t.aggregate,t._orderRules,t._isStacked(),t.x,t.y,t.z,t.p,t.c),l=[],c={},h=t.startAngle*(Math.PI/180)||0,d=(t.endAngle||360)*(Math.PI/180);if(h>d&&(h-=2*Math.PI),t.p&&o.length>0){if(t.x&&t.y){for(o.pop(),l=this._getData(u,["__dimple_placeholder__"].concat(o),t.aggregate,t._orderRules,t._isStacked(),t.x,t.y,t.z,t.p,t.c),e=0;e<s.length;e+=1)for((i=["__dimple_placeholder__"].concat(s[e].aggField)).pop(),t.x&&t.x._hasCategories()&&(i=i.concat(s[e].xField)),t.y&&t.y._hasCategories()&&(i=i.concat(s[e].yField)),n=i.join("|"),a=0;a<l.length;a+=1)if(r=[].concat(l[a].aggField),t.x&&t.x._hasCategories()&&(r=r.concat(l[a].xField)),t.y&&t.y._hasCategories()&&(r=r.concat(l[a].yField)),n===r.join("|")){s[e].xField=l[a].xField,s[e].xValue=l[a].xValue,s[e].xCount=l[a].xCount,s[e].yField=l[a].yField,s[e].yValue=l[a].yValue,s[e].yCount=l[a].yCount,s[e].zField=l[a].zField,s[e].zValue=l[a].zValue,s[e].zCount=l[a].zCount,s[e].x=l[a].x,s[e].y=l[a].y,s[e].r=l[a].r,s[e].xOffset=l[a].xOffset,s[e].yOffset=l[a].yOffset,s[e].width=l[a].width,s[e].height=l[a].height,s[e].cx=l[a].cx,s[e].cy=l[a].cy,s[e].xBound=l[a].xBound,s[e].yBound=l[a].yBound,s[e].xValueList=l[a].xValueList,s[e].yValueList=l[a].yValueList,s[e].zValueList=l[a].zValueList,s[e].cValueList=l[a].cValueList,s[e].pieKey=l[a].key,s[e].value=s.pValue,c[l[a].key]||(c[l[a].key]={total:0,angle:h}),c[l[a].key].total+=s[e].pValue;break}}else for(e=0;e<s.length;e+=1)s[e].pieKey="All",s[e].value=s.pValue,c[s[e].pieKey]||(c[s[e].pieKey]={total:0,angle:h}),c[s[e].pieKey].total+=s[e].pValue;for(e=0;e<s.length;e+=1)0===c[s[e].pieKey].total?s[e].piePct=0:s[e].piePct=s[e].pValue/c[s[e].pieKey].total,s[e].startAngle=c[s[e].pieKey].angle,s[e].endAngle=s[e].startAngle+s[e].piePct*(d-h),c[s[e].pieKey].angle=s[e].endAngle}t._positionData=s}),this)},this._handleTransition=function(t,a,i,n){var r=null;return 0===a?r=t:(r=t.transition().duration(a).delay(i._getDelay(a,i,n)),e._ease(r,i.ease)),r},this._heightPixels=function(){return e._parseYPosition(this.height,this.svg.node())},this._registerEventHandlers=function(a){null!==a._eventHandlers&&a._eventHandlers.length>0&&a._eventHandlers.forEach((function(i){var n,r=function(n){var r=new e.eventArgs;null!==a.chart.storyboard&&(r.frameValue=a.chart.storyboard.getFrameValue()),r.seriesValue=n.aggField,r.xValue=n.x,r.yValue=n.y,r.zValue=n.z,r.pValue=n.p,r.colorValue=n.cValue,r.seriesShapes=a.shapes,r.selectedShape=t.select(this),i.handler(r)};if(null!==i.handler&&"function"==typeof i.handler)if(null!==a._markers&&void 0!==a._markers)for(n in a._markers)a._markers.hasOwnProperty(n)&&a._markers[n].on(i.event,r);else a.shapes.on(i.event,r)}),this)},this._widthPixels=function(){return e._parseXPosition(this.width,this.svg.node())},this._xPixels=function(){return e._parseXPosition(this.x,this.svg.node())},this._yPixels=function(){return e._parseYPosition(this.y,this.svg.node())},this.addAxis=function(t,a,i,n){var r,u=null,o=null;if(null!=a&&(a=[].concat(a)),"string"==typeof t||t instanceof String)u=new e.axis(this,t,a,i,n),this.axes.push(u);else{if(o=t,(u=new e.axis(this,o.position,a,i,n))._hasMeasure()!==o._hasMeasure()?r="You have specified a composite axis where some but not all axes have a measure - this is not supported, all axes must be of the same type.":u._hasTimeField()!==o._hasTimeField()?r="You have specified a composite axis where some but not all axes have a time field - this is not supported, all axes must be of the same type.":(null===u.categoryFields||void 0===u.categoryFields?0:u.categoryFields.length)!==(null===o.categoryFields||void 0===o.categoryFields?0:o.categoryFields.length)&&(r="You have specified a composite axis where axes have differing numbers of category fields - this is not supported, all axes must be of the same type."),r)throw r;o._slaves.push(u)}return u},this.addCategoryAxis=function(t,e){return this.addAxis(t,e,null)},this.addColorAxis=function(t,e){var a=this.addAxis("c",null,t);return a.colors=null==e?null:[].concat(e),a},this.addLegend=function(t,a,i,n,r,u){u=null==u?this.series:[].concat(u),r=null==r?"left":r;var o=new e.legend(this,t,a,i,n,r,u);return this.legends.push(o),o},this.addLogAxis=function(t,e,a){var i=this.addAxis(t,null,e,null);return null!=a&&(i.logBase=a),i.useLog=!0,i},this.addMeasureAxis=function(t,e){return this.addAxis(t,null,e)},this.addPctAxis=function(t,e,a){var i=null;return(i=null!=a?this.addAxis(t,a,e):this.addMeasureAxis(t,e)).showPercent=!0,i},this.addSeries=function(t,a,i){null!=i||(i=this.axes),null!=a||(a=e.plot.bubble);var n,r=null,u=null,o=null,s=null,l=null;return i.forEach((function(t){null!==t&&a.supportedAxes.indexOf(t.position)>-1&&(null===r&&"x"===t.position[0]?r=t:null===u&&"y"===t.position[0]?u=t:null===o&&"z"===t.position[0]?o=t:null===s&&"c"===t.position[0]?s=t:null===s&&"p"===t.position[0]&&(l=t))}),this),t&&(t=[].concat(t)),n=new e.series(this,t,r,u,o,s,l,a,e.aggregateMethod.sum,a.stacked),this.series.push(n),n},this.addTimeAxis=function(t,e,a,i){var n=this.addAxis(t,null,null,e);return n.tickFormat=i,n.dateParseFormat=a,n},this.assignClass=function(t,e){return this._assignedClasses[t]=e,this._assignedClasses[t]},this.assignColor=function(t,a,i,n){return this._assignedColors[t]=new e.color(a,i,n),this._assignedColors[t]},this.customClassList={axisLine:"dimple-custom-axis-line",axisLabel:"dimple-custom-axis-label",axisTitle:"dimple-custom-axis-title",tooltipBox:"dimple-custom-tooltip-box",tooltipLabel:"dimple-custom-tooltip-label",tooltipDropLine:"dimple-custom-tooltip-dropline",lineMarker:"dimple-custom-line-marker",lineMarkerCircle:"dimple-custom-line-marker-circle",legendLabel:"dimple-custom-legend-label",legendKey:"dimple-custom-legend-key",areaSeries:"dimple-custom-series-area",barSeries:"dimple-custom-series-bar",bubbleSeries:"dimple-custom-series-bubble",lineSeries:"dimple-custom-series-line",pieSeries:"dimple-custom-series-pie",gridline:"dimple-custom-gridline",colorClasses:["dimple-custom-format-1","dimple-custom-format-2","dimple-custom-format-3","dimple-custom-format-4","dimple-custom-format-5","dimple-custom-format-6","dimple-custom-format-7","dimple-custom-format-8","dimple-custom-format-9","dimple-custom-format-10"]},this.defaultColors=[new e.color("#80B1D3"),new e.color("#FB8072"),new e.color("#FDB462"),new e.color("#B3DE69"),new e.color("#FFED6F"),new e.color("#BC80BD"),new e.color("#8DD3C7"),new e.color("#CCEBC5"),new e.color("#FFFFB3"),new e.color("#BEBADA"),new e.color("#FCCDE5"),new e.color("#D9D9D9")],this.draw=function(e,a){e=e||0;var i,n,r=null,u=null,o=!1,s=!1,l=this._xPixels(),c=this._yPixels(),h=this._widthPixels(),d=this._heightPixels();return null!=a&&!1!==a||this._getSeriesData(),this.axes.forEach((function(t){t._scale=null}),this),this.axes.forEach((function(t){if(t._min=0,t._max=0,n=[],t._hasMeasure()){var e=!1;this.series.forEach((function(a){if(a._deepMatch(t)){var i=a._axisBounds(t.position);t._min>i.min&&(t._min=i.min),t._max<i.max&&(t._max=i.max),e=!0}}),this),e||this._getAllData().forEach((function(e){t._min>e[t.measure]&&(t._min=e[t.measure]),t._max<e[t.measure]&&(t._max=e[t.measure])}),this)}else t._hasTimeField()?(t._min=null,t._max=null,this.series.forEach((function(e){e._deepMatch(t)&&null!==e[t.position].timeField&&void 0!==e[t.position].timeField&&-1===n.indexOf(e[t.position].timeField)&&n.push(e[t.position].timeField)}),this),t._getAxisData().forEach((function(e){n.forEach((function(a){var i=t._parseDate(e[a]);(null===t._min||i<t._min)&&(t._min=i),(null===t._max||i>t._max)&&(t._max=i)}),this)}),this)):t._hasCategories()&&(t._min=0,i=[],this.series.forEach((function(e){e._deepMatch(t)&&null!==e[t.position].categoryFields[0]&&void 0!==e[t.position].categoryFields[0]&&-1===n.indexOf(e[t.position].categoryFields[0])&&n.push(e[t.position].categoryFields[0])}),this),t._getAxisData().forEach((function(t){n.forEach((function(e){-1===i.indexOf(t[e])&&i.push(t[e])}),this)}),this),t._max=i.length);null!==t._slaves&&void 0!==t._slaves&&t._slaves.length>0&&t._slaves.forEach((function(e){e._min=t._min,e._max=t._max}),this),t._update(),null===r&&"x"===t.position?r=t:null===u&&"y"===t.position&&(u=t)}),this),this.axes.forEach((function(a){var i=!1,n=null,p=0,g=null,f=!1,m=0,x={l:null,t:null,r:null,b:null},y=0,D=0,v="",b=this,F=function(t){return null===n||0===e||i?t:b._handleTransition(t,e,b)},C=function(){var e=t.select(this).selectAll("text");return!a.measure&&a._max>0&&("x"===a.position?e.attr("x",h/a._max/2):"y"===a.position&&e.attr("y",d/a._max*-1/2)),a.categoryFields&&a.categoryFields.length>0&&(a!==r||null!==u.categoryFields&&0!==u.categoryFields.length||e.attr("y",c+d-u._scale(0)+9),a!==u||null!==r.categoryFields&&0!==r.categoryFields.length||e.attr("x",-1*(r._scale(0)-l)-9)),this},A=function(e){return function(){var a=t.select(this).attr("class")||"";return-1===a.indexOf(e)&&(a+=" "+e),a.trim()}};null===a.gridlineShapes?(a.showGridlines||null===a.showGridlines&&!a._hasCategories()&&(!o&&"x"===a.position||!s&&"y"===a.position))&&(a.gridlineShapes=this._gridlines_group.append("g").attr("class","dimple-gridline"),"x"===a.position?o=!0:s=!0):"x"===a.position?o=!0:s=!0,null===a.shapes&&(a.shapes=this._axis_group.append("g").attr("class","dimple-axis dimple-axis-"+a.position).each((function(){b.noFormats||t.select(this).style("font-family",a.fontFamily).style("font-size",a._getFontSize())})),i=!0),a===r&&null!==u?(n="translate(0, "+(null===u.categoryFields||0===u.categoryFields.length?u._scale(0):c+d)+")",g="translate(0, "+(a===r?c+d:c)+")",p=-d):a===u&&null!==r?(n="translate("+(null===r.categoryFields||0===r.categoryFields.length?r._scale(0):l)+", 0)",g="translate("+(a===u?l:l+h)+", 0)",p=-h):"x"===a.position?(g=n="translate(0, "+(a===r?c+d:c)+")",p=-d):"y"===a.position&&(g=n="translate("+(a===u?l:l+h)+", 0)",p=-h),null!==n&&null!==a._draw&&(a._hasTimeField()?F(a.shapes).call(a._draw.ticks(a._getTimePeriod(),a.timeInterval).tickFormat(a._getFormat())).attr("transform",n).each(C):a.useLog?F(a.shapes).call(a._draw.ticks(4,a._getFormat())).attr("transform",n).each(C):F(a.shapes).call(a._draw.tickFormat(a._getFormat())).attr("transform",n).each(C),null!==a.gridlineShapes&&F(a.gridlineShapes).call(a._draw.tickSize(p,0,0).tickFormat("")).attr("transform",g)),F(a.shapes.selectAll("text")).attr("class",A(b.customClassList.axisLabel)).call((function(t){b.noFormats||t.style("font-family",a.fontFamily).style("font-size",a._getFontSize())})),F(a.shapes.selectAll("path, line")).attr("class",A(b.customClassList.axisLine)).call((function(t){b.noFormats||t.style("fill","none").style("stroke","black").style("shape-rendering","crispEdges")})),null!==a.gridlineShapes&&(a.gridlineShapes.selectAll("path").remove(),F(a.gridlineShapes.selectAll("line")).attr("class",A(b.customClassList.gridline)).call((function(t){b.noFormats||t.style("fill","none").style("stroke","lightgray").style("opacity",.8)}))),null!==a.measure&&void 0!==a.measure||(a.autoRotateLabel?a===r?(m=0,a.shapes.selectAll("text").each((function(){var t=a.maxTextWidth||this.getComputedTextLength();m=t>m?t:m})),m>(a._scale.step?a._scale.step():h/a.shapes.selectAll("text").nodes().length)?(f=!0,a.shapes.selectAll("text").style("text-anchor","start").each((function(){var e=this.getBBox();t.select(this).attr("transform","rotate(90,"+e.x+","+(e.y+e.height/2)+") translate(-5, 0)")}))):(f=!1,a.shapes.selectAll("text").style("text-anchor","middle").attr("transform",""))):"x"===a.position&&(m=0,a.shapes.selectAll("text").each((function(){var t=this.getComputedTextLength();m=t>m?t:m})),m>h/a.shapes.selectAll("text").nodes().length?(f=!0,a.shapes.selectAll("text").style("text-anchor","end").each((function(){var e=this.getBBox();t.select(this).attr("transform","rotate(90,"+(e.x+e.width)+","+(e.y+e.height/2)+") translate(5, 0)")}))):(f=!1,a.shapes.selectAll("text").style("text-anchor","middle").attr("transform",""))):(f=!1,a.shapes.selectAll("text").style("text-anchor","middle").attr("transform",""))),null!==a.titleShape&&void 0!==a.titleShape&&a.titleShape.remove(),a.shapes.selectAll("text").each((function(){var t=this.getBBox();(null===x.l||-9-t.width<x.l)&&(x.l=-9-t.width),(null===x.r||t.x+t.width>x.r)&&(x.r=t.x+t.width),f?((null===x.t||t.y+t.height-t.width<x.t)&&(x.t=t.y+t.height-t.width),(null===x.b||t.height+t.width>x.b)&&(x.b=(a.maxTextWidth?20:t.height)+t.width)):((null===x.t||t.y<x.t)&&(x.t=t.y),(null===x.b||9+t.height>x.b)&&(x.b=9+t.height))})),"x"===a.position?(D=a===r?c+d+x.b+5:c+x.t-10,y=l+h/2):"y"===a.position&&(v="rotate(270, "+(y=a===u?l+x.l-10:l+h+x.r+20)+", "+(D=c+d/2)+")"),a.hidden||"x"!==a.position&&"y"!==a.position||null===a.title||(a.titleShape=this._axis_group.append("text").attr("class","dimple-axis dimple-title "+b.customClassList.axisTitle+" dimple-axis-"+a.position),a.titleShape.attr("x",y).attr("y",D).attr("text-anchor","middle").attr("transform",v).text(void 0!==a.title?a.title:null===a.categoryFields||void 0===a.categoryFields||0===a.categoryFields.length?a.measure:a.categoryFields.join("/")).each((function(){b.noFormats||t.select(this).style("font-family",a.fontFamily).style("font-size",a._getFontSize())})),a===r?a.titleShape.each((function(){t.select(this).attr("y",D+this.getBBox().height/1.65)})):a===u&&a.titleShape.each((function(){t.select(this).attr("x",y+this.getBBox().height/1.65)})))}),this),this.series.forEach((function(t){t.plot.draw(this,t,e),this._registerEventHandlers(t)}),this),this.legends.forEach((function(t){t._draw()}),this),this.storyboard&&(this.storyboard._drawText(),this.storyboard.autoplay&&this.storyboard.startAnimation()),this},this.getClass=function(t){return this._assignedClasses[t]||(this._assignedClasses[t]=this.customClassList.colorClasses[this._nextClass],this._nextClass=(this._nextClass+1)%this.customClassList.colorClasses.length),this._assignedClasses[t]},this.getColor=function(t){return null!==this._assignedColors[t]&&void 0!==this._assignedColors[t]||(this._assignedColors[t]=this.defaultColors[this._nextColor],this._nextColor=(this._nextColor+1)%this.defaultColors.length),this._assignedColors[t]},this.setBounds=function(t,a,i,n){return this.x=t,this.y=a,this.width=i,this.height=n,this._xPixels=function(){return e._parseXPosition(this.x,this.svg.node())},this.draw(0,!0),this._yPixels=function(){return e._parseYPosition(this.y,this.svg.node())},this._widthPixels=function(){return e._parseXPosition(this.width,this.svg.node())},this._heightPixels=function(){return e._parseYPosition(this.height,this.svg.node())},this},this.setMargins=function(t,a,i,n){return this.x=t,this.y=a,this.width=0,this.height=0,this._xPixels=function(){return e._parseXPosition(this.x,this.svg.node())},this._yPixels=function(){return e._parseYPosition(this.y,this.svg.node())},this._widthPixels=function(){return e._parentWidth(this.svg.node())-this._xPixels()-e._parseXPosition(i,this.svg.node())},this._heightPixels=function(){return e._parentHeight(this.svg.node())-this._yPixels()-e._parseYPosition(n,this.svg.node())},this},this.setStoryboard=function(t,a){return this.storyboard=new e.storyboard(this,t),null!=a&&(this.storyboard.onTick=a),this.storyboard}},color:function(e,a,i){this.fill=e,this.stroke=null==a?t.rgb(e).darker(.5).toString():a,this.opacity=null==i?.8:i},eventArgs:function(){this.seriesValue=null,this.xValue=null,this.yValue=null,this.zValue=null,this.pValue=null,this.colorValue=null,this.frameValue=null,this.seriesShapes=null,this.selectedShape=null},legend:function(a,i,n,r,u,o,s){this.chart=a,this.series=s,this.x=i,this.y=n,this.width=r,this.height=u,this.horizontalAlign=o,this.shapes=null,this.fontSize="10px",this.fontFamily="sans-serif",this._draw=function(){var a,i=this._getEntries(),n=0,r=0,u=0,o=0,s=this;this.shapes&&this.shapes.remove(),(a=this.chart._group.selectAll(".dimple-dont-select-any").data(i).enter().append("g").attr("class",(function(t){return"dimple-legend "+e._createClass(t.aggField)})).attr("opacity",1)).append("text").attr("class",(function(t){return"dimple-legend dimple-legend-text "+e._createClass(t.aggField)+" "+s.chart.customClassList.legendLabel})).text((function(t){return t.key})).call((function(t){s.chart.noFormats||t.style("font-family",s.fontFamily).style("font-size",s._getFontSize()).style("shape-rendering","crispEdges")})).each((function(){var t=this.getBBox();t.width>n&&(n=t.width),t.height>r&&(r=t.height)})),a.append("rect").attr("class",(function(t){return"dimple-legend dimple-legend-key "+e._createClass(t.aggField)})).attr("height",9).attr("width",15),r=(r<9?9:r)+s._getVerticalPadding(),n+=15+s._getHorizontalPadding(),a.each((function(a){u+n>s._widthPixels()&&(u=0,o+=r),o>s._heightPixels()?t.select(this).remove():(t.select(this).select("text").attr("x","left"===s.horizontalAlign?s._xPixels()+15+5+u:s._xPixels()+(s._widthPixels()-u-n)+15+5).attr("y",(function(){return s._yPixels()+o+this.getBBox().height/1.65})).attr("width",s._widthPixels()).attr("height",s._heightPixels()),t.select(this).select("rect").attr("class",(function(t){return"dimple-legend dimple-legend-key "+e._createClass(t.aggField)+" "+s.chart.customClassList.legendKey+" "+t.css})).attr("x","left"===s.horizontalAlign?s._xPixels()+u:s._xPixels()+(s._widthPixels()-u-n)).attr("y",s._yPixels()+o).attr("height",9).attr("width",15).call((function(t){s.chart.noFormats||t.style("fill",a.fill).style("stroke",a.stroke).style("opacity",a.opacity).style("shape-rendering","crispEdges")})),u+=n)})),this.shapes=a},this._getEntries=function(){var t=[];return this.series&&this.series.forEach((function(e){e._positionData.forEach((function(a){var i,n=-1,r=e.plot.grouped&&!e.x._hasCategories()&&!e.y._hasCategories()&&a.aggField.length<2?"All":a.aggField.slice(-1)[0];for(i=0;i<t.length;i+=1)if(t[i].key===r){n=i;break}-1===n&&e.chart._assignedColors[r]&&(t.push({key:r,fill:e.chart._assignedColors[r].fill,stroke:e.chart._assignedColors[r].stroke,opacity:e.chart._assignedColors[r].opacity,css:e.chart._assignedClasses[r],series:e,aggField:a.aggField}),n=t.length-1)}))}),this),t},this._getFontSize=function(){return this.fontSize&&"auto"!==this.fontSize.toString().toLowerCase()?isNaN(this.fontSize)?this.fontSize:this.fontSize+"px":(this.chart._heightPixels()/35>10?this.chart._heightPixels()/35:10)+"px"},this._getHorizontalPadding=function(){return isNaN(this.horizontalPadding)?20:this.horizontalPadding},this._getVerticalPadding=function(){return isNaN(this.verticalPadding)?2:this.verticalPadding},this._heightPixels=function(){return e._parseYPosition(this.height,this.chart.svg.node())},this._widthPixels=function(){return e._parseXPosition(this.width,this.chart.svg.node())},this._xPixels=function(){return e._parseXPosition(this.x,this.chart.svg.node())},this._yPixels=function(){return e._parseYPosition(this.y,this.chart.svg.node())}},series:function(t,e,a,i,n,r,u,o,s,l){this.chart=t,this.x=a,this.y=i,this.z=n,this.c=r,this.p=u,this.plot=o,this.categoryFields=e,this.aggregate=s,this.stacked=l,this.barGap=.2,this.clusterBarGap=.1,this.lineWeight=2,this.lineMarkers=!1,this.afterDraw=null,this.interpolation="linear",this.tooltipFontSize="10px",this.tooltipFontFamily="sans-serif",this.radius="auto",this._group=t._group.append("g"),this._group.attr("class","dimple-series-group-"+t.series.length),this._eventHandlers=[],this._positionData=[],this._orderRules=[],this._axisBounds=function(t){var e,a,i,n={min:0,max:0},r=null,u=null,o=[],s=0,l=this._positionData;return"x"===t?(r=this.x,u=this.y):"y"===t?(r=this.y,u=this.x):"z"===t?r=this.z:"p"===t?r=this.p:"c"===t&&(r=this.c),r.showPercent?l.forEach((function(t){t[r.position+"Bound"]<n.min&&(n.min=t[r.position+"Bound"]),t[r.position+"Bound"]>n.max&&(n.max=t[r.position+"Bound"])}),this):null===u||null===u.categoryFields||0===u.categoryFields.length?l.forEach((function(t){!this._isStacked()||"x"!==r.position&&"y"!==r.position?(t[r.position+"Value"]<n.min&&(n.min=t[r.position+"Value"]),t[r.position+"Value"]>n.max&&(n.max=t[r.position+"Value"])):t[r.position+"Value"]<0?n.min=n.min+t[r.position+"Value"]:n.max=n.max+t[r.position+"Value"]}),this):(e=r.position+"Value",a=u.position+"Field",i=[],l.forEach((function(t){var n=t[a].join("/"),r=i.indexOf(n);-1===r&&(i.push(n),r=i.length-1),void 0===o[r]&&(o[r]={min:0,max:0},r>=s&&(s=r+1)),this.stacked?t[e]<0?o[r].min=o[r].min+t[e]:o[r].max=o[r].max+t[e]:(t[e]<o[r].min&&(o[r].min=t[e]),t[e]>o[r].max&&(o[r].max=t[e]))}),this),o.forEach((function(t){void 0!==t&&(t.min<n.min&&(n.min=t.min),t.max>n.max&&(n.max=t.max))}),this)),n},this._deepMatch=function(t){var e=!1;return this[t.position]===t?e=!0:void 0!==t._slaves&&null!==t._slaves&&t._slaves.length>0&&t._slaves.forEach((function(t){e=e||this._deepMatch(t)}),this),e},this._dropLineOrigin=function(){var t=0,e=0,a={x:null,y:null},i={x:null,y:null};return this.chart.axes.forEach((function(t){"x"===t.position&&null===i.x?t._hasTimeField()?i.x=this.chart._xPixels():i.x=t._origin:"y"===t.position&&null===i.y&&(t._hasTimeField()?i.y=this.chart._yPixels()+this.chart._heightPixels():i.y=t._origin)}),this),this.chart.axes.forEach((function(n){"x"!==n.position||this.x.hidden?"y"!==n.position||this.y.hidden||(this._deepMatch(n)&&(0===e?a.x=i.x:1===e&&(a.x=this.chart._xPixels()+this.chart._widthPixels())),e+=1):(this._deepMatch(n)&&(0===t?a.y=i.y:1===t&&(a.y=this.chart._yPixels())),t+=1)}),this),a},this._getTooltipFontSize=function(){return this.tooltipFontSize&&"auto"!==this.tooltipFontSize.toString().toLowerCase()?isNaN(this.tooltipFontSize)?this.tooltipFontSize:this.tooltipFontSize+"px":(this.chart._heightPixels()/35>10?this.chart._heightPixels()/35:10)+"px"},this._isStacked=function(){return this.stacked&&(this.x._hasCategories()||this.y._hasCategories())},this.addEventHandler=function(t,e){this._eventHandlers.push({event:t,handler:e})},this.addOrderRule=function(t,e){this._orderRules.push({ordering:t,desc:e})},this.getTooltipText=function(t){var e=[];return null!==this.categoryFields&&void 0!==this.categoryFields&&this.categoryFields.length>0&&this.categoryFields.forEach((function(a,i){null!=a&&null!==t.aggField[i]&&void 0!==t.aggField[i]&&e.push(a+(t.aggField[i]!==a?": "+t.aggField[i]:""))}),this),this.p?(this.x&&this.x._hasCategories()&&this.x._getTooltipText(e,t),this.y&&this.y._hasCategories()&&this.y._getTooltipText(e,t),this.z&&this.z._hasCategories()&&this.z._getTooltipText(e,t),this.p._getTooltipText(e,t)):(this.x&&this.x._getTooltipText(e,t),this.y&&this.y._getTooltipText(e,t),this.z&&this.z._getTooltipText(e,t)),this.c&&this.c._getTooltipText(e,t),e.filter((function(t,a){return e.indexOf(t)===a}))}},storyboard:function(t,e){null!=e&&(e=[].concat(e)),this.chart=t,this.categoryFields=e,this.autoplay=!0,this.frameDuration=3e3,this.storyLabel=null,this.onTick=null,this.fontSize="10px",this.fontFamily="sans-serif",this._frame=0,this._animationTimer=null,this._categories=[],this._cachedCategoryFields=[],this._orderRules=[],this._drawText=function(){var e=this,a=0;e.storyLabel||(e.chart.axes.forEach((function(t){"x"===t.position&&(a+=1)}),e),e.storyLabel=e.chart._group.append("text").attr("class","dimple-storyboard-label").attr("opacity",1).attr("x",e.chart._xPixels()+.01*e.chart._widthPixels()).attr("y",e.chart._yPixels()+(e.chart._heightPixels()/35>10?e.chart._heightPixels()/35:10)*(a>1?1.25:-1)).call((function(a){t.noFormats||a.style("font-family",e.fontFamily).style("font-size",e._getFontSize())}))),e.storyLabel.text(e.categoryFields.join("\\")+": "+e.getFrameValue())},this._getCategories=function(){return this._categoryFields!==this._cachedCategoryFields&&(this._categories=[],this.chart._getAllData().forEach((function(t){var e="";null!==this.categoryFields&&(this.categoryFields.forEach((function(a,i){i>0&&(e+="/"),e+=t[a]}),this),-1===this._categories.indexOf(e)&&(this._categories.push(e),this._categories.length))}),this),this._cachedCategoryFields=this._categoryFields),this._categories},this._getFontSize=function(){return this.fontSize&&"auto"!==this.fontSize.toString().toLowerCase()?isNaN(this.fontSize)?this.fontSize:this.fontSize+"px":(this.chart._heightPixels()/35>10?this.chart._heightPixels()/35:10)+"px"},this._goToFrameIndex=function(t){this._frame=t%this._getCategories().length,this.chart.draw(this.frameDuration/2)},this.addOrderRule=function(t,e){this._orderRules.push({ordering:t,desc:e})},this.getFrameValue=function(){var t=null;return this._frame>=0&&this._getCategories().length>this._frame&&(t=this._getCategories()[this._frame]),t},this.goToFrame=function(t){if(this._getCategories().length>0){var e=this._getCategories().indexOf(t);this._goToFrameIndex(e)}},this.pauseAnimation=function(){null!==this._animationTimer&&(window.clearInterval(this._animationTimer),this._animationTimer=null)},this.startAnimation=function(){null===this._animationTimer&&(null!==this.onTick&&this.onTick(this.getFrameValue()),this._animationTimer=window.setInterval(function(t){return function(){t._goToFrameIndex(t._frame+1),null!==t.onTick&&t.onTick(t.getFrameValue()),t._drawText(t.frameDuration/2)}}(this),this.frameDuration))},this.stopAnimation=function(){null!==this._animationTimer&&(window.clearInterval(this._animationTimer),this._animationTimer=null,this._frame=0)}}};return e.aggregateMethod.avg=function(t,e){return t.value=null===t.value||void 0===t.value?0:parseFloat(t.value),t.count=null===t.count||void 0===t.count?1:parseFloat(t.count),e.value=null===e.value||void 0===e.value?0:parseFloat(e.value),e.count=null===e.count||void 0===e.count?1:parseFloat(e.count),(t.value*t.count+e.value*e.count)/(t.count+e.count)},e.aggregateMethod.count=function(t,e){return t.count=null===t.count||void 0===t.count?0:parseFloat(t.count),e.count=null===e.count||void 0===e.count?0:parseFloat(e.count),t.count+e.count},e.aggregateMethod.max=function(t,e){return t.value=null===t.value||void 0===t.value?0:parseFloat(t.value),e.value=null===e.value||void 0===e.value?0:parseFloat(e.value),t.value>e.value?t.value:e.value},e.aggregateMethod.min=function(t,e){return null===t.value?parseFloat(e.value):parseFloat(t.value)<parseFloat(e.value)?parseFloat(t.value):parseFloat(e.value)},e.aggregateMethod.sum=function(t,e){return t.value=null===t.value||void 0===t.value?0:parseFloat(t.value),e.value=null===e.value||void 0===e.value?0:parseFloat(e.value),t.value+e.value},e.plot.area={stacked:!0,grouped:!0,supportedAxes:["x","y","c"],draw:function(a,i,n){var r,u,o,s,l,c,h,d,p,g,f,m,x,y,D,v,b,F,C,A,E,_,w,B,k=i._positionData,S=[],T=null,P="dimple-series-"+a.series.indexOf(i),L=i.x._hasCategories()||i.y._hasCategories()?0:1,M=!1,I={},V=[],O=[],W=function(){return function(a,i,n,r){t.select(i).style("opacity",1),e._showPointTooltip(a,i,n,r)}},N=function(a){return function(i,n,r,u){t.select(n).style("opacity",u.lineMarkers||a.data.length<2?e._helpers.opacity(i,r,u):0),e._removeTooltip(i,n,r,u)}},z=function(t,r){e._drawMarkers(t,a,i,n,P,M,W(),N(t),r)},G=function(t,n){var r;return"step"===i.interpolation&&i[t]._hasCategories()?(r=e._helpers[t](n,a,i)+("y"===t?e._helpers.height(n,a,i):0),i[t].categoryFields.length<2&&(r+=("y"===t?1:-1)*e._helpers[t+"Gap"](a,i))):r=e._helpers["c"+t](n,a,i),parseFloat(r)},H=function(a,n){var r=t.line().x((function(t){return i.x._hasCategories()||!n?t.x:i.x[n]})).y((function(t){return i.y._hasCategories()||!n?t.y:i.y[n]}));return e._interpolate(r,a),r},R=function(t,e){return parseFloat(t)-parseFloat(e)},X=function(t,e){return parseFloat(t.x)-parseFloat(e.x)},Y=function(t,e,a){var i,n,r=e[e.length-1],u=9999,o=r;for(i=0;i<t.length;i+=1)t[i].x===r.x&&t[i].y===r.y||(n=180-Math.atan2(t[i].x-r.x,t[i].y-r.y)*(180/Math.PI))>a&&n<u&&(o=t[i],u=n);return e.push(o),u};for(r="step"===i.interpolation?"step-after":i.interpolation,f=e._getSeriesOrder(i.data||a.data,i),i.c&&(i.x._hasCategories()&&i.y._hasMeasure()||i.y._hasCategories()&&i.x._hasMeasure())&&(M=!0),i.x._hasCategories()?(w="x",B="y"):i.y._hasCategories()&&(w="y",B="x"),u=0;u<k.length;u+=1){for(l=[],h=-1,s=L;s<k[u].aggField.length;s+=1)l.push(k[u].aggField[s]);for(c=e._createClass(l),s=0;s<S.length;s+=1)if(S[s].keyString===c){h=s;break}-1===h&&(h=S.length,S.push({key:l,keyString:c,color:"white",data:[],points:[],area:{},entry:{},exit:{},group:w&&k[u][w+"Field"]&&k[u][w+"Field"].length>=2?k[u][w+"Field"][0]:"All"})),S[h].data.push(k[u])}for(f&&S.sort((function(t,a){return e._arrayIndexCompare(f,t.key,a.key)})),u=0;u<S.length;u+=1){for(S[u].data.sort(e._getSeriesSortPredicate(a,i,f)),o=0;o<S[u].data.length;o+=1)S[u].points.push({x:G("x",S[u].data[o]),y:G("y",S[u].data[o])}),w&&(I[S[u].group]||(I[S[u].group]={}),I[S[u].group][S[u].points[S[u].points.length-1][w]]=i[B]._origin);m=S[u].points,"step"===i.interpolation&&m.length>1&&w&&(i.x._hasCategories()?(m.push({x:2*m[m.length-1].x-m[m.length-2].x,y:m[m.length-1].y}),I[S[u].group][m[m.length-1][w]]=i[B]._origin):i.y._hasCategories()&&(m=[{x:m[0].x,y:2*m[0].y-m[1].y}].concat(m),I[S[u].group][m[0][w]]=i[B]._origin,S[u].points=m))}for(D in I)if(I.hasOwnProperty(D)){for(v in V[D]=[],I[D])I[D].hasOwnProperty(v)&&V[D].push(parseFloat(v));V[D].sort(R)}for(u=0;u<S.length;u+=1){if(m=S[u].points,b=S[u].group,x=[],O=[],M&&e._addGradient(S[u].key,"fill-area-gradient-"+S[u].keyString,i.x._hasCategories()?i.x:i.y,k,a,n,"fill"),V[b]&&V[b].length>0)for(o=0,s=0;o<V[b].length;o+=1)V[b][o]>=m[0][w]&&V[b][o]<=m[m.length-1][w]&&((y={})[w]=V[b][o],y[B]=I[b][V[b][o]],x.push(y),m[s][w]>V[b][o]?O.push(y):(O.push(m[s]),I[S[u].group][V[b][o]]=m[s][B],s+=1));else if(i._orderRules&&i._orderRules.length>0)O=m.concat(m[0]);else{m=m.sort(X),O.push(m[0]),_=0;do{_=Y(m,O,_)}while(O.length<=m.length&&(O[0].x!==O[O.length-1].x||O[0].y!==O[O.length-1].y))}x=x.reverse(),F=H(r,"_previousOrigin")(O),C=H("step-after"===r?"step-before":"step-before"===r?"step-after":r,"_previousOrigin")(x),E=-1===(A=H("linear","_previousOrigin")(O)).indexOf("L")?void 0:A.indexOf("L"),S[u].entry=F+(C&&C.length>0?"L"+C.substring(1):"")+(A&&A.length>0?"L"+A.substring(1,E):0),F=H(r)(O),C=H("step-after"===r?"step-before":"step-before"===r?"step-after":r)(x),E=-1===(A=H("linear")(O)).indexOf("L")?void 0:A.indexOf("L"),S[u].update=F+(C&&C.length>0?"L"+C.substring(1):"")+(A&&A.length>0?"L"+A.substring(1,E):0),F=H(r,"_origin")(O),C=H("step-after"===r?"step-before":"step-before"===r?"step-after":r,"_origin")(x),E=-1===(A=H("linear","_origin")(O)).indexOf("L")?void 0:A.indexOf("L"),S[u].exit=F+(C&&C.length>0?"L"+C.substring(1):"")+(A&&A.length>0?"L"+A.substring(1,E):0),S[u].color=a.getColor(S[u].key.length>0?S[u].key[S[u].key.length-1]:"All"),S[u].css=a.getClass(S[u].key.length>0?S[u].key[S[u].key.length-1]:"All")}a._tooltipGroup&&a._tooltipGroup.remove(),d=(T=i.shapes?i.shapes.data(S,(function(t){return t.key})):i._group.selectAll("."+P).data(S,(function(t){return t.key}))).enter().append("path").attr("id",(function(t){return e._createClass([t.key])})).attr("class",(function(t){return P+" dimple-line "+t.keyString+" "+a.customClassList.areaSeries+" "+t.css})).attr("d",(function(t){return t.entry})).call((function(t){a.noFormats||t.attr("opacity",(function(t){return M?1:t.color.opacity})).style("fill",(function(t){return M?"url(#"+e._createClass(["fill-area-gradient-"+t.keyString])+")":t.color.fill})).style("stroke",(function(t){return M?"url(#"+e._createClass(["stroke-area-gradient-"+t.keyString])+")":t.color.stroke})).style("stroke-width",i.lineWeight)})).each((function(t){t.markerData=t.data,z(t,this)})),p=a._handleTransition(T.merge(d),n,a).attr("d",(function(t){return t.update})).each((function(t){t.markerData=t.data,z(t,this)})),g=a._handleTransition(T.exit(),n,a).attr("d",(function(t){return t.exit})).each((function(t){t.markerData=[],z(t,this)})),e._postDrawHandling(i,p,g,n),i.shapes=i._group.selectAll("."+P)}},e.plot.bar={stacked:!0,grouped:!1,supportedAxes:["x","y","c"],draw:function(t,a,i){var n,r,u,o=a._positionData,s=null,l=["dimple-series-"+t.series.indexOf(a),"dimple-bar"],c=!a._isStacked()&&a.x._hasMeasure(),h=!a._isStacked()&&a.y._hasMeasure(),d="none";a.x._hasCategories()&&a.y._hasCategories()?d="both":a.x._hasCategories()?d="x":a.y._hasCategories()&&(d="y"),t._tooltipGroup&&t._tooltipGroup.remove(),n=(s=a.shapes?a.shapes.data(o,(function(t){return t.key})):a._group.selectAll("."+l.join(".")).data(o,(function(t){return t.key}))).enter().append("rect").attr("id",(function(t){return e._createClass([t.key])})).attr("class",(function(a){var i=[];return i=(i=(i=i.concat(a.aggField)).concat(a.xField)).concat(a.yField),l.join(" ")+" "+e._createClass(i)+" "+t.customClassList.barSeries+" "+e._helpers.css(a,t)})).attr("x",(function(i){var n=a.x._previousOrigin;return"x"===d?n=e._helpers.x(i,t,a):"both"===d&&(n=e._helpers.cx(i,t,a)),n})).attr("y",(function(i){var n=a.y._previousOrigin;return"y"===d?n=e._helpers.y(i,t,a):"both"===d&&(n=e._helpers.cy(i,t,a)),n})).attr("width",(function(i){return"x"===d?e._helpers.width(i,t,a):0})).attr("height",(function(i){return"y"===d?e._helpers.height(i,t,a):0})).on("mouseover",(function(i,n){e._showBarTooltip(n,this,t,a)})).on("mouseleave",(function(i,n){e._removeTooltip(n,this,t,a)})).call((function(i){t.noFormats||i.attr("opacity",(function(i){return e._helpers.opacity(i,t,a)})).style("fill",(function(i){return e._helpers.fill(i,t,a)})).style("stroke",(function(i){return e._helpers.stroke(i,t,a)}))})),r=t._handleTransition(s.merge(n),i,t,a).attr("x",(function(i){return c?e._helpers.cx(i,t,a)-a.x.floatingBarWidth/2:e._helpers.x(i,t,a)})).attr("y",(function(i){return h?e._helpers.cy(i,t,a)-a.y.floatingBarWidth/2:e._helpers.y(i,t,a)})).attr("width",(function(i){return c?a.x.floatingBarWidth:e._helpers.width(i,t,a)})).attr("height",(function(i){return h?a.y.floatingBarWidth:e._helpers.height(i,t,a)})).call((function(i){t.noFormats||i.attr("fill",(function(i){return e._helpers.fill(i,t,a)})).attr("stroke",(function(i){return e._helpers.stroke(i,t,a)}))})),u=t._handleTransition(s.exit(),i,t,a).attr("x",(function(i){var n=a.x._origin;return"x"===d?n=e._helpers.x(i,t,a):"both"===d&&(n=e._helpers.cx(i,t,a)),n})).attr("y",(function(i){var n=a.y._origin;return"y"===d?n=e._helpers.y(i,t,a):"both"===d&&(n=e._helpers.cy(i,t,a)),n})).attr("width",(function(i){return"x"===d?e._helpers.width(i,t,a):0})).attr("height",(function(i){return"y"===d?e._helpers.height(i,t,a):0})),e._postDrawHandling(a,r,u,i),a.shapes=a._group.selectAll("."+l.join("."))}},e.plot.bubble={stacked:!1,grouped:!1,supportedAxes:["x","y","z","c"],draw:function(t,a,i){var n,r,u,o=a._positionData,s=null,l=["dimple-series-"+t.series.indexOf(a),"dimple-bubble"];t._tooltipGroup&&t._tooltipGroup.remove(),n=(s=a.shapes?a.shapes.data(o,(function(t){return t.key})):a._group.selectAll("."+l.join(".")).data(o,(function(t){return t.key}))).enter().append("circle").attr("id",(function(t){return e._createClass([t.key])})).attr("class",(function(a){var i=[];return i=(i=(i=(i=i.concat(a.aggField)).concat(a.xField)).concat(a.yField)).concat(a.zField),l.join(" ")+" "+e._createClass(i)+" "+t.customClassList.bubbleSeries+" "+e._helpers.css(a,t)})).attr("cx",(function(i){return a.x._hasCategories()?e._helpers.cx(i,t,a):a.x._previousOrigin})).attr("cy",(function(i){return a.y._hasCategories()?e._helpers.cy(i,t,a):a.y._previousOrigin})).attr("r",0).on("mouseover",(function(i,n){e._showPointTooltip(n,this,t,a)})).on("mouseleave",(function(i,n){e._removeTooltip(n,this,t,a)})).call((function(i){t.noFormats||i.attr("opacity",(function(i){return e._helpers.opacity(i,t,a)})).style("fill",(function(i){return e._helpers.fill(i,t,a)})).style("stroke",(function(i){return e._helpers.stroke(i,t,a)}))})),r=t._handleTransition(s.merge(n),i,t,a).attr("cx",(function(i){return e._helpers.cx(i,t,a)})).attr("cy",(function(i){return e._helpers.cy(i,t,a)})).attr("r",(function(i){return e._helpers.r(i,t,a)})).call((function(i){t.noFormats||i.attr("fill",(function(i){return e._helpers.fill(i,t,a)})).attr("stroke",(function(i){return e._helpers.stroke(i,t,a)}))})),u=t._handleTransition(s.exit(),i,t,a).attr("r",0).attr("cx",(function(i){return a.x._hasCategories()?e._helpers.cx(i,t,a):a.x._origin})).attr("cy",(function(i){return a.y._hasCategories()?e._helpers.cy(i,t,a):a.y._origin})),e._postDrawHandling(a,r,u,i),a.shapes=a._group.selectAll("."+l.join("."))}},e.plot.line={stacked:!1,grouped:!0,supportedAxes:["x","y","c"],draw:function(a,i,n){var r,u,o,s,l,c,h,d,p,g,f,m=i._positionData,x=[],y=null,D="dimple-series-"+a.series.indexOf(i),v=i.x._hasCategories()||i.y._hasCategories()?0:1,b=!1,F=function(){return function(a,i,n,r){t.select(i).style("opacity",1),e._showPointTooltip(a,i,n,r)}},C=function(a){return function(i,n,r,u){t.select(n).style("opacity",u.lineMarkers||a.data.length<2?e._helpers.opacity(i,r,u):0),e._removeTooltip(i,n,r,u)}},A=function(t,r){e._drawMarkers(t,a,i,n,D,b,F(),C(t),r)},E=function(t,n){var r;return"step"===i.interpolation&&i[t]._hasCategories()?(i.barGap=0,i.clusterBarGap=0,r=e._helpers[t](n,a,i)+("y"===t?e._helpers.height(n,a,i):0)):r=e._helpers["c"+t](n,a,i),parseFloat(r.toFixed(1))},_=function(a,n){var r=t.line().x((function(t){return i.x._hasCategories()||!n?t.x:i.x[n]})).y((function(t){return i.y._hasCategories()||!n?t.y:i.y[n]}));return e._interpolate(r,a),r};for(r="step"===i.interpolation?"step-after":i.interpolation,f=e._getSeriesOrder(i.data||a.data,i),i.c&&(i.x._hasCategories()&&i.y._hasMeasure()||i.y._hasCategories()&&i.x._hasMeasure())&&(b=!0),u=0;u<m.length;u+=1){for(l=[],h=-1,s=v;s<m[u].aggField.length;s+=1)l.push(m[u].aggField[s]);for(c=e._createClass(l),s=0;s<x.length;s+=1)if(x[s].keyString===c){h=s;break}-1===h&&(h=x.length,x.push({key:l,keyString:c,color:"white",data:[],markerData:[],points:[],line:{},entry:{},exit:{}})),x[h].data.push(m[u])}for(f&&x.sort((function(t,a){return e._arrayIndexCompare(f,t.key,a.key)})),u=0;u<x.length;u+=1){for(x[u].data.sort(e._getSeriesSortPredicate(a,i,f)),b&&e._addGradient(x[u].key,"fill-line-gradient-"+x[u].keyString,i.x._hasCategories()?i.x:i.y,m,a,n,"fill"),o=0;o<x[u].data.length;o+=1)x[u].points.push({x:E("x",x[u].data[o]),y:E("y",x[u].data[o])});"step"===i.interpolation&&x[u].points.length>1&&(i.x._hasCategories()?x[u].points.push({x:2*x[u].points[x[u].points.length-1].x-x[u].points[x[u].points.length-2].x,y:x[u].points[x[u].points.length-1].y}):i.y._hasCategories()&&(x[u].points=[{x:x[u].points[0].x,y:2*x[u].points[0].y-x[u].points[1].y}].concat(x[u].points))),x&&x[u]&&x[u].points&&1===x[u].points.length&&x[u].points.push({x:x[u].points[0].x,y:x[u].points[0].y}),x[u].entry=_(r,"_previousOrigin")(x[u].points),x[u].update=_(r)(x[u].points),x[u].exit=_(r,"_origin")(x[u].points),x[u].color=a.getColor(x[u].key.length>0?x[u].key[x[u].key.length-1]:"All"),x[u].css=a.getClass(x[u].key.length>0?x[u].key[x[u].key.length-1]:"All")}a._tooltipGroup&&a._tooltipGroup.remove(),d=(y=i.shapes?i.shapes.data(x,(function(t){return t.key})):i._group.selectAll("."+D).data(x,(function(t){return t.key}))).enter().append("path").attr("id",(function(t){return e._createClass([t.key])})).attr("class",(function(t){return D+" dimple-line "+t.keyString+" "+a.customClassList.lineSeries+" "+t.css})).attr("d",(function(t){return t.entry})).call((function(t){a.noFormats||t.attr("opacity",(function(t){return b?1:t.color.opacity})).style("fill","none").style("stroke",(function(t){return b?"url(#"+e._createClass(["fill-line-gradient-"+t.keyString])+")":t.color.stroke})).style("stroke-width",i.lineWeight)})).each((function(t){t.markerData=t.data,A(t,this)})),p=a._handleTransition(y.merge(d),n,a).attr("d",(function(t){return t.update})).each((function(t){t.markerData=t.data,A(t,this)})),g=a._handleTransition(y.exit(),n,a).attr("d",(function(t){return t.exit})).each((function(t){t.markerData=[],A(t,this)})),e._postDrawHandling(i,p,g,n),i.shapes=i._group.selectAll("."+D)}},e.plot.pie={stacked:!1,grouped:!1,supportedAxes:["x","y","c","z","p"],draw:function(a,i,n){var r,u,o,s=i._positionData,l=null,c=["dimple-series-"+a.series.indexOf(i),"dimple-pie"],h=function(t){return i.x&&i.y?e._helpers.r(t,a,i):a._widthPixels()<a._heightPixels()?a._widthPixels()/2:a._heightPixels()/2},d=function(t){var a=h(t);return i.outerRadius&&(a=e._parsePosition(i.outerRadius,a)),Math.max(a,0)},p=function(t){var a=0;return i.innerRadius&&(a=e._parsePosition(i.innerRadius,h(t))),Math.max(a,0)},g=function(e){return t.arc().innerRadius(p(e)).outerRadius(d(e))(e)},f=function(e){e.innerRadius=p(e),e.outerRadius=d(e);var a,i=t.interpolate(this._current,e);return a=t.arc().innerRadius((function(t){return t.innerRadius})).outerRadius((function(t){return t.outerRadius})),this._current=i(0),function(t){return a(i(t))}},m=function(t){return function(n){var r,u;return i.x&&i.y?(r=!t||i.x._hasCategories()?e._helpers.cx(n,a,i):i.x._previousOrigin,u=!t||i.y._hasCategories()?e._helpers.cy(n,a,i):i.y._previousOrigin):(r=a._xPixels()+a._widthPixels()/2,u=a._yPixels()+a._heightPixels()/2),"translate("+r+","+u+")"}};a._tooltipGroup&&a._tooltipGroup.remove(),r=(l=i.shapes?i.shapes.data(s,(function(t){return t.key})):i._group.selectAll("."+c.join(".")).data(s,(function(t){return t.key}))).enter().append("path").attr("id",(function(t){return e._createClass([t.key])})).attr("class",(function(t){var i=[];return i=(i=i.concat(t.aggField)).concat(t.pField),c.join(" ")+" "+e._createClass(i)+" "+a.customClassList.pieSeries+" "+e._helpers.css(t,a)})).attr("d",g).on("mouseover",(function(t,n){e._showBarTooltip(n,this,a,i)})).on("mouseleave",(function(t,n){e._removeTooltip(n,this,a,i)})).call((function(t){a.noFormats||t.attr("opacity",(function(t){return e._helpers.opacity(t,a,i)})).style("fill",(function(t){return e._helpers.fill(t,a,i)})).style("stroke",(function(t){return e._helpers.stroke(t,a,i)}))})).attr("transform",m(!0)).each((function(t){this._current=t,t.innerRadius=p(t),t.outerRadius=d(t)})),u=a._handleTransition(l.merge(r),n,a,i).call((function(t){n&&n>0?t.attrTween("d",f):t.attr("d",g),a.noFormats||t.attr("fill",(function(t){return e._helpers.fill(t,a,i)})).attr("stroke",(function(t){return e._helpers.stroke(t,a,i)}))})).attr("transform",m(!1)),o=a._handleTransition(l.exit(),n,a,i).attr("transform",m(!0)).attr("d",g),e._postDrawHandling(i,u,o,n),i.shapes=i._group.selectAll("."+c.join("."))}},e._addGradient=function(t,a,i,n,r,u,o){var s=[].concat(t),l=r.svg.select("#"+e._createClass([a])),c=[],h=i.position+"Field",d=!0,p=[];n.forEach((function(t){-1===c.indexOf(t[h])&&t.aggField.join("_")===s.join("_")&&c.push(t[h])}),this),c=c.sort((function(t,e){return i._scale(t)-i._scale(e)})),null===l.node()&&(d=!1,l=r.svg.append("defs").append("linearGradient").attr("id",e._createClass([a])).attr("gradientUnits","userSpaceOnUse").attr("x1","x"===i.position?i._scale(c[0])+r._widthPixels()/c.length/2:0).attr("y1","y"===i.position?i._scale(c[0])-r._heightPixels()/c.length/2:0).attr("x2","x"===i.position?i._scale(c[c.length-1])+r._widthPixels()/c.length/2:0).attr("y2","y"===i.position?i._scale(c[c.length-1])-r._heightPixels()/c.length/2:0)),c.forEach((function(t,e){var a={},i=0;for(i=0;i<n.length;i+=1)if(n[i].aggField.join("_")===s.join("_")&&n[i][h].join("_")===t.join("_")){a=n[i];break}p.push({offset:Math.round(e/(c.length-1)*100)+"%",color:a[o]})}),this),d?r._handleTransition(l.selectAll("stop").data(p),u,r).attr("offset",(function(t){return t.offset})).attr("stop-color",(function(t){return t.color})):l.selectAll("stop").data(p).enter().append("stop").attr("offset",(function(t){return t.offset})).attr("stop-color",(function(t){return t.color}))},e._arrayIndexCompare=function(t,e,a){var i,n,r,u,o,s;for(n=0;n<t.length;n+=1){for(u=!0,o=!0,s=[].concat(t[n]),r=0;r<e.length;r+=1)u=u&&e[r]===s[r];for(r=0;r<a.length;r+=1)o=o&&a[r]===s[r];if(u||o){i=u&&o?0:u?-1:1;break}}return i},e._createClass=function(t){var e,a,i=[];if(a=function(t){var e=t.charCodeAt(0),a="-";return e>=65&&e<=90&&(a=t.toLowerCase()),a},t.length>0)for(e=0;e<t.length;e+=1)t[e]&&i.push("dimple-"+t[e].toString().replace(/[^a-z0-9]/g,a));else i=["dimple-all"];return i.join(" ")},e._drawMarkerBacks=function(a,i,n,r,u,o){var s,l,c,h=["dimple-marker-back",u,a.keyString];n.lineMarkers&&(s=null===n._markerBacks||void 0===n._markerBacks||void 0===n._markerBacks[a.keyString]?n._group.selectAll("."+h.join(".")).data(a.markerData):n._markerBacks[a.keyString].data(a.markerData,(function(t){return t.key})),(c=o.nextSibling&&o.nextSibling.id?s.enter().insert("circle","#"+o.nextSibling.id):s.enter().append("circle")).attr("id",(function(t){return e._createClass([t.key+" Marker Back"])})).attr("class",(function(t){var a=[];return n.x._hasCategories()&&(a=a.concat(t.xField)),n.y._hasCategories()&&(a=a.concat(t.yField)),e._createClass(a)+" "+h.join(" ")})).attr("cx",(function(t){return n.x._hasCategories()?e._helpers.cx(t,i,n):n.x._previousOrigin})).attr("cy",(function(t){return n.y._hasCategories()?e._helpers.cy(t,i,n):n.y._previousOrigin})).attr("r",0).attr("fill","white").attr("stroke","none"),i._handleTransition(s.merge(c),r,i).attr("cx",(function(t){return e._helpers.cx(t,i,n)})).attr("cy",(function(t){return e._helpers.cy(t,i,n)})).attr("r",2+n.lineWeight),l=i._handleTransition(s.exit(),r,i).attr("cx",(function(t){return n.x._hasCategories()?e._helpers.cx(t,i,n):n.x._origin})).attr("cy",(function(t){return n.y._hasCategories()?e._helpers.cy(t,i,n):n.y._origin})).attr("r",0),0===r?l.remove():l.each("end",(function(){t.select(this).remove()})),void 0!==n._markerBacks&&null!==n._markerBacks||(n._markerBacks={}),n._markerBacks[a.keyString]=s)},e._drawMarkers=function(a,i,n,r,u,o,s,l,c){var h,d,p,g=["dimple-marker",u,a.keyString];h=null===n._markers||void 0===n._markers||void 0===n._markers[a.keyString]?n._group.selectAll("."+g.join(".")).data(a.markerData):n._markers[a.keyString].data(a.markerData,(function(t){return t.key})),(p=c.nextSibling&&c.nextSibling.id?h.enter().insert("circle","#"+c.nextSibling.id):h.enter().append("circle")).attr("id",(function(t){return e._createClass([t.key+" Marker"])})).attr("class",(function(t){var a=[],r=i.getClass(t.aggField.length>0?t.aggField[t.aggField.length-1]:"All");return n.x._hasCategories()&&(a=a.concat(t.xField)),n.y._hasCategories()&&(a=a.concat(t.yField)),e._createClass(a)+" "+g.join(" ")+" "+i.customClassList.lineMarker+" "+r})).on("mouseover",(function(t,e){s(e,this,i,n)})).on("mouseleave",(function(t,e){l(e,this,i,n)})).attr("cx",(function(t){return n.x._hasCategories()?e._helpers.cx(t,i,n):n.x._previousOrigin})).attr("cy",(function(t){return n.y._hasCategories()?e._helpers.cy(t,i,n):n.y._previousOrigin})).attr("r",0).attr("opacity",n.lineMarkers||a.data.length<2?a.color.opacity:0).call((function(t){i.noFormats||t.attr("fill","white").style("stroke-width",n.lineWeight).attr("stroke",(function(t){return o?e._helpers.fill(t,i,n):a.color.stroke}))})),i._handleTransition(h.merge(p),r,i).attr("cx",(function(t){return e._helpers.cx(t,i,n)})).attr("cy",(function(t){return e._helpers.cy(t,i,n)})).attr("r",2+n.lineWeight).attr("opacity",n.lineMarkers||a.data.length<2?a.color.opacity:0).call((function(t){i.noFormats||t.attr("fill","white").style("stroke-width",n.lineWeight).attr("stroke",(function(t){return o?e._helpers.fill(t,i,n):a.color.stroke}))})),d=i._handleTransition(h.exit(),r,i).attr("cx",(function(t){return n.x._hasCategories()?e._helpers.cx(t,i,n):n.x._origin})).attr("cy",(function(t){return n.y._hasCategories()?e._helpers.cy(t,i,n):n.y._origin})).attr("r",0),0===r?d.remove():d.each("end",(function(){t.select(this).remove()})),void 0!==n._markers&&null!==n._markers||(n._markers={}),n._markers[a.keyString]=h,e._drawMarkerBacks(a,i,n,r,u,c)},e._ease=function(e,a){if(e&&a&&"[object String]"===Object.prototype.toString.call(a)){switch(a){case"linear":a=t.easeLinear;break;case"poly":a=t.easePoly;break;case"quad":a=t.easeQuad;break;case"cubic":a=t.easeCubic;break;case"sin":a=t.easeSin;break;case"exp":a=t.easeExp;break;case"circle":a=t.easeCircle;break;case"elastic":a=t.easeElastic;break;case"back":a=t.easeBack;break;case"bounce":a=t.easeBounce}e.ease(a)}},e._getOrderedList=function(t,a,i){var n,r=[],u=[],o=[].concat(a),s=[].concat(a),l=[];return null!=i&&(l=l.concat(i)),(l=l.concat({ordering:o,desc:!1})).forEach((function(e){var a,i=[],n=[];if("function"==typeof e.ordering){if(t&&t.length>0)for(a in t[0])t[0].hasOwnProperty(a)&&-1===s.indexOf(a)&&s.push(a)}else if(e.ordering instanceof Array){for(a=0;a<e.ordering.length;a+=1)t&&t.length>0&&t[0].hasOwnProperty(e.ordering[a])&&n.push(e.ordering[a]),i.push(e.ordering[a]);n.length>i.length/2?s.concat(n):e.values=i}else s.push(e.ordering)}),this),n=e._rollUp(t,o,s),l.length>=1&&(l.forEach((function(t){var e=null!==t.desc&&void 0!==t.desc&&t.desc,a=t.ordering,i=[],n=function(t){var e,a=0;for(e=0;e<t.length;e+=1){if(isNaN(t[e])){a=void 0;break}a+=parseFloat(t[e])}return a},u=function(t,e){var a=0,i=n(t),r=n(e);return isNaN(i)||isNaN(r)?isNaN(Date.parse(t[0]))||isNaN(Date.parse(e[0]))?t[0]<e[0]?a=-1:t[0]>e[0]&&(a=1):a=Date.parse(t[0])-Date.parse(e[0]):a=parseFloat(i)-parseFloat(r),a};"function"==typeof a?r.push((function(t,i){return(e?-1:1)*a(t,i)})):t.values&&t.values.length>0?(t.values.forEach((function(t){i.push([].concat(t).join("|"))}),this),r.push((function(t,a){var n,r,u,s="",l="";for(u=0;u<o.length;u+=1)u>0&&(s+="|",l+="|"),s+=t[o[u]],l+=a[o[u]];return n=i.indexOf(s),r=i.indexOf(l),n=n<0?e?-1:i.length:n,r=r<0?e?-1:i.length:r,(e?-1:1)*(n-r)}))):[].concat(t.ordering).forEach((function(t){r.push((function(a,i){var n=0;return void 0!==a[t]&&void 0!==i[t]&&(n=u([].concat(a[t]),[].concat(i[t]))),(e?-1:1)*n}))}))})),n.sort((function(t,e){for(var a=0,i=0;a<r.length&&0===i;)i=r[a](t,e),a+=1;return i})),n.forEach((function(t){var e,a=[];if(1===o.length)u.push(t[o[0]]);else{for(e=0;e<o.length;e+=1)a.push(t[o[e]]);u.push(a)}}),this)),u},e._getSeriesOrder=function(t,a){var i=[].concat(a._orderRules),n=a.categoryFields,r=[];return null!=n&&n.length>0&&(null!==a.c&&void 0!==a.c&&a.c._hasMeasure()&&i.push({ordering:a.c.measure,desc:!0}),a.x._hasMeasure()&&i.push({ordering:a.x.measure,desc:!0}),a.y._hasMeasure()&&i.push({ordering:a.y.measure,desc:!0}),r=e._getOrderedList(t,n,i)),r},e._getSeriesSortPredicate=function(t,a,i){return function(n,r){var u=0;return a.x._hasCategories()&&(u=e._helpers.cx(n,t,a)-e._helpers.cx(r,t,a)),0===u&&a.y._hasCategories()&&(u=e._helpers.cy(n,t,a)-e._helpers.cy(r,t,a)),0===u&&i&&(u=e._arrayIndexCompare(i,n.aggField,r.aggField)),u}},e._helpers={cx:function(t,a,i){return null!==i.x.measure&&void 0!==i.x.measure?i.x._scale(t.cx):i.x._hasCategories()&&i.x.categoryFields.length>=2?i.x._scale(t.cx)+e._helpers.xGap(a,i)+(t.xOffset+.5)*((a._widthPixels()/i.x._max-2*e._helpers.xGap(a,i))*t.width):i.x._scale(t.cx)+a._widthPixels()/i.x._max/2},cy:function(t,a,i){return null!==i.y.measure&&void 0!==i.y.measure?i.y._scale(t.cy):null!==i.y.categoryFields&&void 0!==i.y.categoryFields&&i.y.categoryFields.length>=2?i.y._scale(t.cy)-a._heightPixels()/i.y._max+e._helpers.yGap(a,i)+(t.yOffset+.5)*((a._heightPixels()/i.y._max-2*e._helpers.yGap(a,i))*t.height):i.y._scale(t.cy)-a._heightPixels()/i.y._max/2},r:function(t,e,a){var i=0,n=1;return null===a.z||void 0===a.z?i=a.radius&&"auto"!==a.radius?a.radius:5:(a.radius&&"auto"!==a.radius&&a.radius>1&&(n=a.radius/a.z._scale(a.z._max)),i=a.z._hasMeasure()?a.z._scale(t.r)*n:a.z._scale(e._heightPixels()/100)*n),i},xGap:function(t,e){var a=0;return(null===e.x.measure||void 0===e.x.measure)&&e.barGap>0&&(a=t._widthPixels()/e.x._max*(e.barGap>.99?.99:e.barGap)/2),a},xClusterGap:function(t,a,i){var n=0;return null!==i.x.categoryFields&&void 0!==i.x.categoryFields&&i.x.categoryFields.length>=2&&i.clusterBarGap>0&&!i.x._hasMeasure()&&(n=t.width*(a._widthPixels()/i.x._max-2*e._helpers.xGap(a,i))*(i.clusterBarGap>.99?.99:i.clusterBarGap)/2),n},yGap:function(t,e){var a=0;return(null===e.y.measure||void 0===e.y.measure)&&e.barGap>0&&(a=t._heightPixels()/e.y._max*(e.barGap>.99?.99:e.barGap)/2),a},yClusterGap:function(t,a,i){var n=0;return null!==i.y.categoryFields&&void 0!==i.y.categoryFields&&i.y.categoryFields.length>=2&&i.clusterBarGap>0&&!i.y._hasMeasure()&&(n=t.height*(a._heightPixels()/i.y._max-2*e._helpers.yGap(a,i))*(i.clusterBarGap>.99?.99:i.clusterBarGap)/2),n},x:function(t,a,i){return i.x._hasTimeField()?i.x._scale(t.x)-e._helpers.width(t,a,i)/2:null!==i.x.measure&&void 0!==i.x.measure?i.x._scale(t.x):i.x._scale(t.x)+e._helpers.xGap(a,i)+t.xOffset*(e._helpers.width(t,a,i)+2*e._helpers.xClusterGap(t,a,i))+e._helpers.xClusterGap(t,a,i)},y:function(t,a,i){return i.y._hasTimeField()?i.y._scale(t.y)-e._helpers.height(t,a,i)/2:null!==i.y.measure&&void 0!==i.y.measure?i.y._scale(t.y):i.y._scale(t.y)-a._heightPixels()/i.y._max+e._helpers.yGap(a,i)+t.yOffset*(e._helpers.height(t,a,i)+2*e._helpers.yClusterGap(t,a,i))+e._helpers.yClusterGap(t,a,i)},width:function(t,a,i){return null!==i.x.measure&&void 0!==i.x.measure?Math.abs(i.x._scale(t.x<0?t.x-t.width:t.x+t.width)-i.x._scale(t.x)):i.x._hasTimeField()?i.x.floatingBarWidth:t.width*(a._widthPixels()/i.x._max-2*e._helpers.xGap(a,i))-2*e._helpers.xClusterGap(t,a,i)},height:function(t,a,i){return i.y._hasTimeField()?i.y.floatingBarWidth:null!==i.y.measure&&void 0!==i.y.measure?Math.abs(i.y._scale(t.y)-i.y._scale(t.y<=0?t.y+t.height:t.y-t.height)):t.height*(a._heightPixels()/i.y._max-2*e._helpers.yGap(a,i))-2*e._helpers.yClusterGap(t,a,i)},opacity:function(t,e,a){return null!==a.c&&void 0!==a.c?t.opacity:e.getColor(t.aggField.slice(-1)[0]).opacity},fill:function(t,e,a){return null!==a.c&&void 0!==a.c?t.fill:e.getColor(t.aggField.slice(-1)[0]).fill},stroke:function(t,e,a){return null!==a.c&&void 0!==a.c?t.stroke:e.getColor(t.aggField.slice(-1)[0]).stroke},css:function(t,e){return e.getClass(t.aggField.slice(-1)[0])}},e._interpolate=function(e,a){if(e&&a){if("[object String]"===Object.prototype.toString.call(a))switch(a){case"linear":a=t.curveLinear;break;case"linear-closed":a=t.curveLinearClosed;break;case"step":a=t.curveStep;break;case"step-before":a=t.curveStepBefore;break;case"step-after":a=t.curveStepAfter;break;case"basis":a=t.curveBasis;break;case"basis-open":a=t.curveBasisOpen;break;case"basis-closed":a=t.curveBasisClosed;break;case"bundle":a=t.curveBundle;break;case"cardinal":a=t.curveCardinal;break;case"cardinal-open":a=t.curveCardinalOpen;break;case"cardinal-closed":a=t.curveCardinalClosed;break;case"monotone":a=t.curveMonotoneX}e.curve(a)}},e._parentHeight=function(t){var e=t.getBoundingClientRect().height;return(!e||e<0)&&(e=t.clientHeight),e},e._parentWidth=function(t){var e=t.getBoundingClientRect().width;return(!e||e<0)&&(e=t.clientWidth),e},e._parsePosition=function(t,e){var a=0;return t&&t.toString().split(",").forEach((function(i){i&&(isNaN(i)?"%"===i.slice(-1)?a+=e*(parseFloat(i.slice(0,i.length-1))/100):"px"===i.slice(-2)?a+=parseFloat(i.slice(0,i.length-2)):a=t:a+=parseFloat(i))}),this),a<0&&(a=e+a),a},e._parseXPosition=function(t,a){return e._parsePosition(t,e._parentWidth(a))},e._parseYPosition=function(t,a){return e._parsePosition(t,e._parentHeight(a))},e._postDrawHandling=function(t,e,a,i){0===i?(e.each((function(e,a){t.afterDraw&&t.afterDraw(this,e,a)})),a.remove()):(e.on("end",(function(e,a){t.afterDraw&&t.afterDraw(this,e,a)})),a.call((function(){t.shapes&&t.shapes.exit().remove()})))},e._removeTooltip=function(t,e,a,i){a._tooltipGroup&&a._tooltipGroup.remove()},e._rollUp=function(t,e,a){var i=[];return e=null!=e?[].concat(e):[],t.forEach((function(t){var n=-1,r={},u=!0;i.forEach((function(a,i){-1===n&&(u=!0,e.forEach((function(e){u=u&&t[e]===a[e]}),this),u&&(n=i))}),this),-1!==n?r=i[n]:(e.forEach((function(e){r[e]=t[e]}),this),i.push(r),n=i.length-1),a.forEach((function(a){-1===e.indexOf(a)&&(void 0===r[a]&&(r[a]=[]),r[a]=r[a].concat(t[a]))}),this),i[n]=r}),this),i},e._showBarTooltip=function(e,a,i,n){var r,u,o,s,l,c,h=10,d=t.select(a),p=d.node().getBBox().x,g=d.node().getBBox().y,f=d.node().getBBox().width,m=d.node().getBBox().height,x=d.attr("opacity"),y=d.attr("fill"),D=n._dropLineOrigin(),v=t.rgb(t.rgb(y).r+.6*(255-t.rgb(y).r),t.rgb(y).g+.6*(255-t.rgb(y).g),t.rgb(y).b+.6*(255-t.rgb(y).b)),b=t.rgb(t.rgb(y).r+.8*(255-t.rgb(y).r),t.rgb(y).g+.8*(255-t.rgb(y).g),t.rgb(y).b+.8*(255-t.rgb(y).b)),F=n.getTooltipText(e),C=0,A=0,E=0,_=function(t,e){var a=d.node().getCTM(),n=i.svg.node().createSVGPoint();return n.x=t||0,n.y=e||0,n.matrixTransform(a)};null!==i._tooltipGroup&&void 0!==i._tooltipGroup&&i._tooltipGroup.remove(),i._tooltipGroup=i.svg.append("g"),n.p||(c=n._isStacked()?1:f/2,n.x._hasCategories()||null===D.y||i._tooltipGroup.append("line").attr("class","dimple-tooltip-dropline "+i.customClassList.tooltipDropLine).attr("x1",p<n.x._origin?p+c:p+f-c).attr("y1",g<D.y?g+m:g).attr("x2",p<n.x._origin?p+c:p+f-c).attr("y2",g<D.y?g+m:g).call((function(t){i.noFormats||t.style("fill","none").style("stroke",y).style("stroke-width",2).style("stroke-dasharray","3, 3").style("opacity",x)})).transition().delay(375).duration(375).ease(t.easeLinear).attr("y2",g<D.y?D.y-1:D.y+1),c=n._isStacked()?1:m/2,n.y._hasCategories()||null===D.x||i._tooltipGroup.append("line").attr("class","dimple-tooltip-dropline "+i.customClassList.tooltipDropLine).attr("x1",p<D.x?p+f:p).attr("y1",g<n.y._origin?g+c:g+m-c).attr("x2",p<D.x?p+f:p).attr("y2",g<n.y._origin?g+c:g+m-c).call((function(t){i.noFormats||t.style("fill","none").style("stroke",y).style("stroke-width",2).style("stroke-dasharray","3, 3").style("opacity",x)})).transition().delay(375).duration(375).ease(t.easeLinear).attr("x2",p<D.x?D.x-1:D.x+1)),u=(r=i._tooltipGroup.append("g")).append("rect").attr("class","dimple-tooltip "+i.customClassList.tooltipBox),r.selectAll(".dimple-dont-select-any").data(F).enter().append("text").attr("class","dimple-tooltip "+i.customClassList.tooltipLabel).text((function(t){return t})).call((function(t){i.noFormats||t.style("font-family",n.tooltipFontFamily).style("font-size",n._getTooltipFontSize())})),r.each((function(){A=this.getBBox().width>A?this.getBBox().width:A,E=this.getBBox().width>E?this.getBBox().height:E})),r.selectAll("text").attr("x",0).attr("y",(function(){return(C+=this.getBBox().height)-this.getBBox().height/2})),u.attr("x",-5).attr("y",-5).attr("height",Math.floor(C+5)-.5).attr("width",A+10).attr("rx",5).attr("ry",5).call((function(t){i.noFormats||t.style("fill",b).style("stroke",v).style("stroke-width",2).style("opacity",.95)})),_(p+f+5+h+A).x<parseFloat(i.svg.node().getBBox().width)?(o=p+f+5+h,s=g+m/2-(C-(E-5))/2):_(p-(15+A)).x>0?(o=p-(15+A),s=g+m/2-(C-(E-5))/2):_(0,g+m+C+h+5).y<parseFloat(i.svg.node().getBBox().height)?(o=(o=(o=p+f/2-(10+A)/2)>0?o:h)+A<parseFloat(i.svg.node().getBBox().width)?o:parseFloat(i.svg.node().getBBox().width)-A-h,s=g+m+10):(o=(o=(o=p+f/2-(10+A)/2)>0?o:h)+A<parseFloat(i.svg.node().getBBox().width)?o:parseFloat(i.svg.node().getBBox().width)-A-h,s=g-C-(E-5)),l=_(o,s),r.attr("transform","translate("+l.x+" , "+l.y+")")},e._showPointTooltip=function(a,i,n,r){var u,o,s,l,c=10,h=t.select(i),d=parseFloat(h.attr("cx")),p=parseFloat(h.attr("cy")),g=parseFloat(h.attr("r")),f=e._helpers.opacity(a,n,r),m=h.attr("stroke"),x=r._dropLineOrigin(),y=t.rgb(t.rgb(m).r+.6*(255-t.rgb(m).r),t.rgb(m).g+.6*(255-t.rgb(m).g),t.rgb(m).b+.6*(255-t.rgb(m).b)),D=t.rgb(t.rgb(m).r+.8*(255-t.rgb(m).r),t.rgb(m).g+.8*(255-t.rgb(m).g),t.rgb(m).b+.8*(255-t.rgb(m).b)),v=0,b=0,F=0,C=r.getTooltipText(a);null!==n._tooltipGroup&&void 0!==n._tooltipGroup&&n._tooltipGroup.remove(),n._tooltipGroup=n.svg.append("g"),n._tooltipGroup.append("circle").attr("class","dimple-line-marker-circle "+n.customClassList.lineMarkerCircle).attr("cx",d).attr("cy",p).attr("r",g).call((function(t){n.noFormats||t.attr("opacity",0).style("fill","none").style("stroke",m).style("stroke-width",1)})).transition().duration(375).ease(t.easeLinear).attr("r",g+r.lineWeight+2).call((function(t){n.noFormats||t.attr("opacity",1).style("stroke-width",2)})),null!==x.y&&n._tooltipGroup.append("line").attr("class","dimple-tooltip-dropline "+n.customClassList.tooltipDropLine).attr("x1",d).attr("y1",p<x.y?p+g+r.lineWeight+2:p-g-r.lineWeight-2).attr("x2",d).attr("y2",p<x.y?p+g+r.lineWeight+2:p-g-r.lineWeight-2).call((function(t){n.noFormats||t.style("fill","none").style("stroke",m).style("stroke-width",2).style("stroke-dasharray","3, 3").style("opacity",f)})).transition().delay(375).duration(375).ease(t.easeLinear).attr("y2",p<x.y?x.y-1:x.y+1),null!==x.x&&n._tooltipGroup.append("line").attr("class","dimple-tooltip-dropline "+n.customClassList.tooltipDropLine).attr("x1",d<x.x?d+g+r.lineWeight+2:d-g-r.lineWeight-2).attr("y1",p).attr("x2",d<x.x?d+g+r.lineWeight+2:d-g-r.lineWeight-2).attr("y2",p).call((function(t){n.noFormats||t.style("fill","none").style("stroke",m).style("stroke-width",2).style("stroke-dasharray","3, 3").style("opacity",f)})).transition().delay(375).duration(375).ease(t.easeLinear).attr("x2",d<x.x?x.x-1:x.x+1),o=(u=n._tooltipGroup.append("g")).append("rect").attr("class","dimple-tooltip "+n.customClassList.tooltipBox),u.selectAll(".dont-select-any").data(C).enter().append("text").attr("class","dimple-tooltip "+n.customClassList.tooltipLabel).text((function(t){return t})).call((function(t){n.noFormats||t.style("font-family",r.tooltipFontFamily).style("font-size",r._getTooltipFontSize())})),u.each((function(){b=this.getBBox().width>b?this.getBBox().width:b,F=this.getBBox().width>F?this.getBBox().height:F})),u.selectAll("text").attr("x",0).attr("y",(function(){return(v+=this.getBBox().height)-this.getBBox().height/2})),o.attr("x",-5).attr("y",-5).attr("height",Math.floor(v+5)-.5).attr("width",b+10).attr("rx",5).attr("ry",5).call((function(t){n.noFormats||t.style("fill",D).style("stroke",y).style("stroke-width",2).style("opacity",.95)})),d+g+5+c+b<parseFloat(n.svg.node().getBBox().width)?(s=d+g+5+c,l=p-(v-(F-5))/2):d-g-(15+b)>0?(s=d-g-(15+b),l=p-(v-(F-5))/2):p+g+v+c+5<parseFloat(n.svg.node().getBBox().height)?(s=(s=(s=d-(10+b)/2)>0?s:c)+b<parseFloat(n.svg.node().getBBox().width)?s:parseFloat(n.svg.node().getBBox().width)-b-c,l=p+g+10):(s=(s=(s=d-(10+b)/2)>0?s:c)+b<parseFloat(n.svg.node().getBBox().width)?s:parseFloat(n.svg.node().getBBox().width)-b-c,l=p-v-(F-5)),u.attr("transform","translate("+s+" , "+l+")")},e.filterData=function(t,e,a){var i=t;return null!==e&&null!==a&&(null!=a&&(a=[].concat(a)),i=[],t.forEach((function(t){(null===t[e]||a.indexOf([].concat(t[e]).join("/"))>-1)&&i.push(t)}),this)),i},e.getUniqueValues=function(t,e){var a=[];return null!=e&&(e=[].concat(e),t.forEach((function(t){var i="";e.forEach((function(e,a){a>0&&(i+="/"),i+=t[e]}),this),-1===a.indexOf(i)&&a.push(i)}),this)),a},e.newSvg=function(e,a,i){var n=null;if(null!=e||(e="body"),(n=t.select(e)).empty())throw"The '"+e+"' selector did not match any elements.  Please prefix with '#' to select by id or '.' to select by class";return n.append("svg").attr("width",a).attr("height",i)},e}))},8605:function(t,e,a){"use strict";a.r(e);var i=a(2506);i.selection.prototype.filterByAttr=function(t,e){return this.filter((function(){return this.attributes[t].textContent===e}))},i.transition.prototype.filterByAttr=i.selection.prototype.filterByAttr,e.default=i},8644:function(t,e,a){"use strict";a.r(e);var i=a(3348),n=(a(3931),a(6631)),r=a.n(n);function u(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}function o(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?u(Object(a),!0).forEach((function(e){s(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):u(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function s(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var l={initChartColorsDialog:function(t){var e="tf-chart-color-"+t.macroId,a=e+"-"+t.pageId;return i.default.initAJSDialog(o(o({container:t.settings,dialogName:e,dialogId:a,options:{offsetX:-20,width:220,gravity:"n",noBind:!0,addActiveClass:!1}},i.default.getColorsDialogOptions(t,a,!0)),{},{cancelCallback:function(){t.triggerSettingsButtonInvoke()}}))},initInterpolationDialog:function(t){var e="tf-interpolation-dialog-"+t.macroId,a=e+"-"+t.pageId;return i.default.initAJSDialog({container:t.settings,dialogName:e,dialogId:a,options:{offsetX:-20,width:250,gravity:"n",noBind:!0,addActiveClass:!1},getContent:function(){var e=t.getChartColorLabels(),n=[];return e.forEach((function(e,a){t.interpolation[e]||(t.interpolation[e]=t.defaultInterpolation),n.push({field:e,value:t.interpolation[e],variant:i.default.FIELD_VARIANTS.INTERPOLATION_SELECT})})),r().inlineDialog({clazz:"tf-interpolation-dialog",name:"interpolation",inputs:n,dialogId:a})},applyCallback:function(e){t.triggerSettingsButtonInvoke(),t.enableSaveBtn();var a={};e.popup.find("form").find("select").each((function(t,e){var i=$(e);a[i.data("name")]=i.val()})),t.interpolation=a,t.draw()},cancelCallback:function(){t.triggerSettingsButtonInvoke()},hideCallback:function(){t.controls.removeClass("active")}})},initLineSettingsDialog:function(t){var e="tf-line-settings-dialog-"+t.macroId,a=e+"-"+t.pageId;return i.default.initAJSDialog({container:t.settings,dialogName:e,dialogId:a,options:{offsetX:-20,width:250,gravity:"n",noBind:!0,addActiveClass:!1},getContent:function(){var e=t.getChartColorLabels(),n=[];return e.forEach((function(e,a){t.lineSettings[e]||(t.lineSettings[e]={type:"solid",width:1.5}),n.push({field:e,value:t.lineSettings[e],variant:i.default.FIELD_VARIANTS.LINE_SETTINGS})})),r().inlineDialog({clazz:"tf-line-settings-dialog",name:"line-settings",inputs:n,dialogId:a})},applyCallback:function(e){t.triggerSettingsButtonInvoke(),t.enableSaveBtn();var a={};e.popup.find("form").find(".field-group").each((function(t,e){var i=$(e),n=i.find("select"),r=n.data("name"),u=n.val(),o=Math.abs(parseFloat(i.find("input").val()||"1.5"));a[r]={type:u,width:o}})),t.lineSettings=a,t.draw()},cancelCallback:function(){t.triggerSettingsButtonInvoke()},hideCallback:function(){t.controls.removeClass("active")}})}};e.default=l},8933:function(t,e,a){"use strict";a.r(e);var i=a(4238),n=a(3926),r={saveChanges:function(t,e,a,r,u,o,s,l,c,h,d,p,g,f,m,x,y,D,v,b){(0,n.makeAjax)({contentType:"application/x-www-form-urlencoded; charset=utf-8",type:"POST",cache:!1,url:Confluence.getContextPath()+"/rest/table-filter/1.0/service/save-chart",dataType:"json",data:{pageId:t,id:e,column:a,aggregation:r,type:$.trim(u),height:o,width:s,hide:l,version:x,barColoringType:c,colors:h,colorColumns:d,pieKeys:p,interpolation:y,is3D:g,lineSettings:D,innerLabels:v,ganttArrows:b},success:f,error:function(t){i.default.showError(t,m)}})},saveDateFormat:function(t,e,a){(0,n.makeAjax)({contentType:"application/x-www-form-urlencoded; charset=utf-8",type:"POST",cache:!1,url:Confluence.getContextPath()+"/rest/table-filter/1.0/service/save-chart/dateformat",dataType:"json",data:{pageId:t,id:e,dateformat:a}})}};e.default=r}}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.stiltsoft.confluence.plugin.tablefilter.tablefilter:bd39dfae66cd59f32e3214253a3d53dd', location = 'build/8265.js' */
(self.webpackChunk=self.webpackChunk||[]).push([[8265],{8265:function(){(function(){var t,e,s,i,r={}.hasOwnProperty;(i=function(){function t(){this.options_index=0,this.parsed=[]}return t.prototype.add_node=function(t,e){return"OPTGROUP"===t.nodeName.toUpperCase()?this.add_group(t):this.add_option(t,null,null,e)},t.prototype.add_group=function(t){var e,s,i,r,n,o;for(e=this.parsed.length,this.parsed.push({array_index:e,group:!0,label:t.label,title:t.title?t.title:void 0,children:0,disabled:t.disabled,classes:t.className}),o=[],s=0,i=(n=t.childNodes).length;s<i;s++)r=n[s],o.push(this.add_option(r,e,t.disabled));return o},t.prototype.add_option=function(t,e,s,i){if("OPTION"===t.nodeName.toUpperCase())return null!=e&&(this.parsed[e].children+=1),this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,value:t.value,text:t.text,html:i?t.text:t.innerHTML,title:t.title?t.title:void 0,selected:t.selected,disabled:!0===s?s:t.disabled,group_array_index:e,group_label:null!=e?this.parsed[e].label:null,classes:t.className,style:t.style.cssText}),this.options_index+=1},t}()).select_to_array=function(t,e){var s,r,n,o,h;for(o=new i,r=0,n=(h=t.childNodes).length;r<n;r++)s=h[r],o.add_node(s,e);return o.parsed},e=function(){function t(e,s){this.form_field=e,this.options=null!=s?s:{},this.label_click_handler=function(t,e){return function(){return t.apply(e,arguments)}}(this.label_click_handler,this),t.browser_is_supported()&&(this.is_multiple=this.form_field.multiple,this.set_default_text(),this.set_default_values(),this.setup(),this.set_up_html(),this.register_observers(),this.on_ready())}return t.prototype.set_default_values=function(){return this.click_test_action=function(t){return function(e){return t.test_active_click(e)}}(this),this.activate_action=function(t){return function(e){return t.activate_field(e)}}(this),this.active_field=!1,this.mouse_on_container=!1,this.results_showing=!1,this.result_highlighted=null,this.is_rtl=this.options.rtl||/\bchosen-rtl\b/.test(this.form_field.className),this.allow_single_deselect=null!=this.options.allow_single_deselect&&null!=this.form_field.options[0]&&""===this.form_field.options[0].text&&this.options.allow_single_deselect,this.disable_search_threshold=this.options.disable_search_threshold||0,this.disable_search=this.options.disable_search||!1,this.enable_split_word_search=null==this.options.enable_split_word_search||this.options.enable_split_word_search,this.group_search=null==this.options.group_search||this.options.group_search,this.search_contains=this.options.search_contains||!1,this.single_backstroke_delete=null==this.options.single_backstroke_delete||this.options.single_backstroke_delete,this.max_selected_options=this.options.max_selected_options||1/0,this.inherit_select_classes=this.options.inherit_select_classes||!1,this.display_selected_options=null==this.options.display_selected_options||this.options.display_selected_options,this.display_disabled_options=null==this.options.display_disabled_options||this.options.display_disabled_options,this.include_group_label_in_selected=this.options.include_group_label_in_selected||!1,this.max_shown_results=this.options.max_shown_results||Number.POSITIVE_INFINITY,this.case_sensitive_search=this.options.case_sensitive_search||!1,this.hide_results_on_select=null==this.options.hide_results_on_select||this.options.hide_results_on_select},t.prototype.set_default_text=function(){return this.form_field.getAttribute("data-placeholder")?this.default_text=this.form_field.getAttribute("data-placeholder"):this.is_multiple?this.default_text=this.options.placeholder_text_multiple||this.options.placeholder_text||t.default_multiple_text:this.default_text=this.options.placeholder_text_single||this.options.placeholder_text||t.default_single_text,this.default_text=this.escape_html(this.default_text),this.results_none_found=this.form_field.getAttribute("data-no_results_text")||this.options.no_results_text||t.default_no_result_text},t.prototype.choice_label=function(t){return this.include_group_label_in_selected&&null!=t.group_label?"<b class='group-name'>"+this.escape_html(t.group_label)+"</b>"+t.html:t.html},t.prototype.mouse_enter=function(){return this.mouse_on_container=!0},t.prototype.mouse_leave=function(){return this.mouse_on_container=!1},t.prototype.input_focus=function(t){if(this.is_multiple){if(!this.active_field)return setTimeout(function(t){return function(){return t.container_mousedown()}}(this),50)}else if(!this.active_field)return this.activate_field()},t.prototype.input_blur=function(t){if(!this.mouse_on_container)return this.active_field=!1,setTimeout(function(t){return function(){return t.blur_test()}}(this),100)},t.prototype.label_click_handler=function(t){return this.is_multiple?this.container_mousedown(t):this.activate_field()},t.prototype.results_option_build=function(t){var e,s,i,r,n,o,h;for(e="",h=0,r=0,n=(o=this.results_data).length;r<n&&("",""!==(i=(s=o[r]).group?this.result_add_group(s):this.result_add_option(s))&&(h++,e+=i),(null!=t?t.first:void 0)&&(s.selected&&this.is_multiple?this.choice_build(s):s.selected&&!this.is_multiple&&this.single_set_selected_text(this.choice_label(s))),!(h>=this.max_shown_results));r++);return e},t.prototype.result_add_option=function(t){var e,s;return t.search_match&&this.include_option_in_results(t)?(e=[],t.disabled||t.selected&&this.is_multiple||e.push("active-result"),!t.disabled||t.selected&&this.is_multiple||e.push("disabled-result"),t.selected&&e.push("result-selected"),null!=t.group_array_index&&e.push("group-option"),""!==t.classes&&e.push(t.classes),(s=document.createElement("li")).className=e.join(" "),t.style&&(s.style.cssText=t.style),s.setAttribute("data-option-array-index",t.array_index),s.innerHTML=t.highlighted_html||t.html,t.title&&(s.title=t.title),this.outerHTML(s)):""},t.prototype.result_add_group=function(t){var e,s;return(t.search_match||t.group_match)&&t.active_options>0?((e=[]).push("group-result"),t.classes&&e.push(t.classes),(s=document.createElement("li")).className=e.join(" "),s.innerHTML=t.highlighted_html||this.escape_html(t.label),t.title&&(s.title=t.title),this.outerHTML(s)):""},t.prototype.results_update_field=function(){if(this.set_default_text(),this.is_multiple||this.results_reset_cleanup(),this.result_clear_highlight(),this.results_build(),this.results_showing)return this.winnow_results()},t.prototype.reset_single_select_options=function(){var t,e,s,i,r;for(r=[],t=0,e=(s=this.results_data).length;t<e;t++)(i=s[t]).selected?r.push(i.selected=!1):r.push(void 0);return r},t.prototype.results_toggle=function(){return this.results_showing?this.results_hide():this.results_show()},t.prototype.results_search=function(t){return this.results_showing?this.winnow_results():this.results_show()},t.prototype.winnow_results=function(t){var e,s,i,r,n,o,h,l,c,_,a,u,d,p,f;for(this.no_results_clear(),_=0,e=(h=this.get_search_text()).replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),c=this.get_search_regex(e),i=0,r=(l=this.results_data).length;i<r;i++)(n=l[i]).search_match=!1,a=null,u=null,n.highlighted_html="",this.include_option_in_results(n)&&(n.group&&(n.group_match=!1,n.active_options=0),null!=n.group_array_index&&this.results_data[n.group_array_index]&&(0===(a=this.results_data[n.group_array_index]).active_options&&a.search_match&&(_+=1),a.active_options+=1),f=n.group?n.label:n.text,n.group&&!this.group_search||(u=this.search_string_match(f,c),n.search_match=null!=u,n.search_match&&!n.group&&(_+=1),n.search_match?(h.length&&(d=u.index,o=f.slice(0,d),s=f.slice(d,d+h.length),p=f.slice(d+h.length),n.highlighted_html=this.escape_html(o)+"<em>"+this.escape_html(s)+"</em>"+this.escape_html(p)),null!=a&&(a.group_match=!0)):null!=n.group_array_index&&this.results_data[n.group_array_index].search_match&&(n.search_match=!0)));return this.result_clear_highlight(),_<1&&h.length?(this.update_results_content(""),this.no_results(h)):(this.update_results_content(this.results_option_build()),(null!=t?t.skip_highlight:void 0)?void 0:this.winnow_results_set_highlight())},t.prototype.get_search_regex=function(t){var e,s;return s=this.search_contains?t:"(^|\\s|\\b)"+t+"[^\\s]*",this.enable_split_word_search||this.search_contains||(s="^"+s),e=this.case_sensitive_search?"":"i",new RegExp(s,e)},t.prototype.search_string_match=function(t,e){var s;return s=e.exec(t),!this.search_contains&&(null!=s?s[1]:void 0)&&(s.index+=1),s},t.prototype.choices_count=function(){var t,e,s;if(null!=this.selected_option_count)return this.selected_option_count;for(this.selected_option_count=0,t=0,e=(s=this.form_field.options).length;t<e;t++)s[t].selected&&(this.selected_option_count+=1);return this.selected_option_count},t.prototype.choices_click=function(t){if(t.preventDefault(),this.activate_field(),!this.results_showing&&!this.is_disabled)return this.results_show()},t.prototype.keydown_checker=function(t){var e,s;switch(s=null!=(e=t.which)?e:t.keyCode,this.search_field_scale(),8!==s&&this.pending_backstroke&&this.clear_backstroke(),s){case 8:this.backstroke_length=this.get_search_field_value().length;break;case 9:this.results_showing&&!this.is_multiple&&this.result_select(t),this.mouse_on_container=!1;break;case 13:this.results_showing&&(t.stopPropagation(),t.preventDefault());break;case 27:this.results_showing&&t.preventDefault();break;case 32:this.disable_search&&t.preventDefault();break;case 38:t.preventDefault(),this.keyup_arrow();break;case 40:t.preventDefault(),this.keydown_arrow()}},t.prototype.keyup_checker=function(t){var e,s;switch(s=null!=(e=t.which)?e:t.keyCode,this.search_field_scale(),s){case 8:this.is_multiple&&this.backstroke_length<1&&this.choices_count()>0?this.keydown_backstroke():this.pending_backstroke||(this.result_clear_highlight(),this.results_search());break;case 13:t.preventDefault(),this.results_showing&&this.result_select(t);break;case 27:this.results_showing&&this.results_hide();break;case 9:case 16:case 17:case 18:case 38:case 40:case 91:break;default:this.results_search()}},t.prototype.clipboard_event_checker=function(t){if(!this.is_disabled)return setTimeout(function(t){return function(){return t.results_search()}}(this),50)},t.prototype.container_width=function(){return null!=this.options.width?this.options.width:this.form_field.offsetWidth+"px"},t.prototype.include_option_in_results=function(t){return!(this.is_multiple&&!this.display_selected_options&&t.selected||!this.display_disabled_options&&t.disabled||t.empty)},t.prototype.search_results_touchstart=function(t){return this.touch_started=!0,this.search_results_mouseover(t)},t.prototype.search_results_touchmove=function(t){return this.touch_started=!1,this.search_results_mouseout(t)},t.prototype.search_results_touchend=function(t){if(this.touch_started)return this.search_results_mouseup(t)},t.prototype.outerHTML=function(t){var e;return t.outerHTML?t.outerHTML:((e=document.createElement("div")).appendChild(t),e.innerHTML)},t.prototype.get_single_html=function(){return'<div class="chosen-single chosen-default">\n  <span>'+this.default_text+'</span>\n  <div><b></b></div>\n</div>\n<div class="chosen-drop">\n  <div class="chosen-search">\n    <input class="chosen-search-input" type="text" autocomplete="off" />\n  </div>\n  <ul class="chosen-results"></ul>\n</div>'},t.prototype.get_multi_html=function(){return'<ul class="chosen-choices">\n  <li class="search-field">\n    <input class="chosen-search-input" type="text" autocomplete="off" placeholder="'+this.default_text+'"/>\n  </li>\n</ul>\n<div class="chosen-drop">\n  <ul class="chosen-results"></ul>\n</div>'},t.prototype.get_no_results_html=function(t){return'<li class="no-results">\n  '+this.results_none_found+" <span>"+this.escape_html(t)+"</span>\n</li>"},t.browser_is_supported=function(){return"Microsoft Internet Explorer"!==window.navigator.appName||document.documentMode>=8},t.default_multiple_text="Select Some Options",t.default_single_text="Select an Option",t.default_no_result_text="No results match",t}(),(t=window.$||jQuery).fn.extend({chosenTF:function(i){return e.browser_is_supported()?this.each((function(e){var r,n;n=(r=t(this)).data("chosen"),"destroy"!==i?n instanceof s||r.data("chosen",new s(this,i)):n instanceof s&&n.destroy()})):this}}),s=function(s){function n(){return n.__super__.constructor.apply(this,arguments)}return function(t,e){function s(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);s.prototype=e.prototype,t.prototype=new s,t.__super__=e.prototype}(n,e),n.prototype.setup=function(){return this.form_field_jq=t(this.form_field),this.current_selectedIndex=this.form_field.selectedIndex},n.prototype.set_up_html=function(){var e,s;return(e=["chosen-container"]).push("chosen-container-"+(this.is_multiple?"multi":"single")),this.inherit_select_classes&&this.form_field.className&&e.push(this.form_field.className),this.is_rtl&&e.push("chosen-rtl"),s={class:e.join(" "),title:this.form_field.title},this.form_field.id.length&&(s.id=this.form_field.id.replace(/[^\w]/g,"_")+"_chosen"),this.container=t("<div />",s),this.container.width(this.container_width()),this.is_multiple?this.container.html(this.get_multi_html()):this.container.html(this.get_single_html()),this.form_field_jq.hide().after(this.container),this.dropdown=this.container.find("div.chosen-drop").first(),this.search_field=this.container.find("input").first(),this.search_results=this.container.find("ul.chosen-results").first(),this.search_field_scale(),this.search_no_results=this.container.find("li.no-results").first(),this.is_multiple?(this.search_choices=this.container.find("ul.chosen-choices").first(),this.search_container=this.container.find("li.search-field").first()):(this.search_container=this.container.find("div.chosen-search").first(),this.selected_item=this.container.find(".chosen-single").first()),this.results_build(),this.set_tab_index(),this.set_label_behavior()},n.prototype.on_ready=function(){return this.form_field_jq.trigger("chosen:ready",{chosen:this})},n.prototype.register_observers=function(){return this.container.on("touchstart.chosen",function(t){return function(e){t.container_mousedown(e)}}(this)),this.container.on("touchend.chosen",function(t){return function(e){t.container_mouseup(e)}}(this)),this.container.on("mousedown.chosen",function(t){return function(e){t.container_mousedown(e)}}(this)),this.container.on("mouseup.chosen",function(t){return function(e){t.container_mouseup(e)}}(this)),this.container.on("mouseenter.chosen",function(t){return function(e){t.mouse_enter(e)}}(this)),this.container.on("mouseleave.chosen",function(t){return function(e){t.mouse_leave(e)}}(this)),this.search_results.on("mouseup.chosen",function(t){return function(e){t.search_results_mouseup(e)}}(this)),this.search_results.on("mouseover.chosen",function(t){return function(e){t.search_results_mouseover(e)}}(this)),this.search_results.on("mouseout.chosen",function(t){return function(e){t.search_results_mouseout(e)}}(this)),this.search_results.on("mousewheel.chosen DOMMouseScroll.chosen",function(t){return function(e){t.search_results_mousewheel(e)}}(this)),this.search_results.on("touchstart.chosen",function(t){return function(e){t.search_results_touchstart(e)}}(this)),this.search_results.on("touchmove.chosen",function(t){return function(e){t.search_results_touchmove(e)}}(this)),this.search_results.on("touchend.chosen",function(t){return function(e){t.search_results_touchend(e)}}(this)),this.form_field_jq.on("chosen:updated.chosen",function(t){return function(e){t.results_update_field(e)}}(this)),this.form_field_jq.on("chosen:activate.chosen",function(t){return function(e){t.activate_field(e)}}(this)),this.form_field_jq.on("chosen:open.chosen",function(t){return function(e){t.container_mousedown(e)}}(this)),this.form_field_jq.on("chosen:close.chosen",function(t){return function(e){t.close_field(e)}}(this)),this.search_field.on("blur.chosen",function(t){return function(e){t.input_blur(e)}}(this)),this.search_field.on("keyup.chosen",function(t){return function(e){t.keyup_checker(e)}}(this)),this.search_field.on("keydown.chosen",function(t){return function(e){t.keydown_checker(e)}}(this)),this.search_field.on("focus.chosen",function(t){return function(e){t.input_focus(e)}}(this)),this.search_field.on("cut.chosen",function(t){return function(e){t.clipboard_event_checker(e)}}(this)),this.search_field.on("paste.chosen",function(t){return function(e){t.clipboard_event_checker(e)}}(this)),this.is_multiple?this.search_choices.on("click.chosen touchstart.chosen",function(t){return function(e){t.choices_click(e)}}(this)):this.container.on("click.chosen",(function(t){t.preventDefault()}))},n.prototype.destroy=function(){return t(this.container[0].ownerDocument).off("click.chosen",this.click_test_action),this.form_field_label.length>0&&this.form_field_label.off("click.chosen"),this.search_field[0].tabIndex&&(this.form_field_jq[0].tabIndex=this.search_field[0].tabIndex),this.container.remove(),this.form_field_jq.removeData("chosen"),this.form_field_jq.show()},n.prototype.search_field_disabled=function(){return this.is_disabled=this.form_field.disabled||this.form_field_jq.parents("fieldset").is(":disabled"),this.container.toggleClass("chosen-disabled",this.is_disabled),this.search_field[0].disabled=this.is_disabled,this.is_multiple||this.selected_item.off("focus.chosen",this.activate_field),this.is_disabled?this.close_field():this.is_multiple?void 0:this.selected_item.on("focus.chosen",this.activate_field)},n.prototype.container_mousedown=function(e){var s;if(!this.is_disabled)return!e||"mousedown"!==(s=e.type)&&"touchstart"!==s||this.results_showing||e.preventDefault(),null!=e&&t(e.target).hasClass("ui-resizable-handle")?this.results_hide():null!=e&&t(e.target).hasClass("search-choice-close")?void 0:(this.active_field?this.is_multiple||!e||t(e.target)[0]!==this.selected_item[0]&&!t(e.target).parents("div.chosen-single").length||(e.preventDefault(),this.results_toggle()):(this.is_multiple&&this.search_field.val(""),t(this.container[0].ownerDocument).on("click.chosen",this.click_test_action),this.results_show()),this.activate_field())},n.prototype.container_mouseup=function(t){if("ABBR"===t.target.nodeName&&!this.is_disabled)return this.results_reset(t)},n.prototype.search_results_mousewheel=function(t){var e;if(t.originalEvent&&(e=t.originalEvent.deltaY||-t.originalEvent.wheelDelta||t.originalEvent.detail),null!=e)return t.preventDefault(),"DOMMouseScroll"===t.type&&(e*=40),this.search_results.scrollTop(e+this.search_results.scrollTop())},n.prototype.blur_test=function(t){if(!this.active_field&&this.container.hasClass("chosen-container-active"))return this.close_field()},n.prototype.close_field=function(){return t(this.container[0].ownerDocument).off("click.chosen",this.click_test_action),this.active_field=!1,this.results_hide(),this.container.removeClass("chosen-container-active"),this.clear_backstroke(),this.show_search_field_default(),this.search_field_scale(),this.search_field.blur()},n.prototype.activate_field=function(){if(!this.is_disabled)return this.container.addClass("chosen-container-active"),this.active_field=!0,this.search_field.val(this.search_field.val()),this.search_field.focus()},n.prototype.test_active_click=function(e){var s;return(s=t(e.target).closest(".chosen-container")).length&&this.container[0]===s[0]?this.active_field=!0:this.close_field()},n.prototype.results_build=function(){return this.parsing=!0,this.selected_option_count=null,this.results_data=i.select_to_array(this.form_field,this.options.isHtml),this.is_multiple?this.search_choices.find("li.search-choice").remove():(this.single_set_selected_text(),this.disable_search||this.form_field.options.length<=this.disable_search_threshold?(this.search_field[0].readOnly=!0,this.container.addClass("chosen-container-single-nosearch")):(this.search_field[0].readOnly=!1,this.container.removeClass("chosen-container-single-nosearch"))),this.update_results_content(this.results_option_build({first:!0})),this.search_field_disabled(),this.show_search_field_default(),this.search_field_scale(),this.parsing=!1},n.prototype.result_do_highlight=function(t){var e,s,i,r,n;if(t.length){if(this.result_clear_highlight(),this.result_highlight=t,this.result_highlight.addClass("highlighted"),r=(i=parseInt(this.search_results.css("maxHeight"),10))+(n=this.search_results.scrollTop()),(e=(s=this.result_highlight.position().top+this.search_results.scrollTop())+this.result_highlight.outerHeight())>=r)return this.search_results.scrollTop(e-i>0?e-i:0);if(s<n)return this.search_results.scrollTop(s)}},n.prototype.result_clear_highlight=function(){return this.result_highlight&&this.result_highlight.removeClass("highlighted"),this.result_highlight=null},n.prototype.results_show=function(){return this.is_multiple&&this.max_selected_options<=this.choices_count()?(this.form_field_jq.trigger("chosen:maxselected",{chosen:this}),!1):(this.container.addClass("chosen-with-drop"),this.results_showing=!0,this.search_field.focus(),this.search_field.val(this.get_search_field_value()),this.winnow_results(),this.form_field_jq.trigger("chosen:showing_dropdown",{chosen:this}))},n.prototype.update_results_content=function(t){return this.search_results.html(t)},n.prototype.results_hide=function(){return this.results_showing&&(this.result_clear_highlight(),this.container.removeClass("chosen-with-drop"),this.form_field_jq.trigger("chosen:hiding_dropdown",{chosen:this})),this.results_showing=!1},n.prototype.set_tab_index=function(t){var e;if(this.form_field.tabIndex)return e=this.form_field.tabIndex,this.form_field.tabIndex=-1,this.search_field[0].tabIndex=e},n.prototype.set_label_behavior=function(){if(this.form_field_label=this.form_field_jq.parents("label"),!this.form_field_label.length&&this.form_field.id.length&&(this.form_field_label=t("label[for='"+this.form_field.id+"']")),this.form_field_label.length>0)return this.form_field_label.on("click.chosen",this.label_click_handler)},n.prototype.show_search_field_default=function(){return this.search_field.val(""),this.is_multiple&&this.choices_count()<1&&!this.active_field?(this.search_field.attr("placeholder",this.default_text),this.search_field.addClass("default")):(this.search_field.attr("placeholder",""),this.search_field.removeClass("default"))},n.prototype.search_results_mouseup=function(e){var s;if((s=t(e.target).hasClass("active-result")?t(e.target):t(e.target).parents(".active-result").first()).length)return this.result_highlight=s,this.result_select(e),this.search_field.focus()},n.prototype.search_results_mouseover=function(e){var s;if(s=t(e.target).hasClass("active-result")?t(e.target):t(e.target).parents(".active-result").first())return this.result_do_highlight(s)},n.prototype.search_results_mouseout=function(e){if(t(e.target).hasClass("active-result")||t(e.target).parents(".active-result").first())return this.result_clear_highlight()},n.prototype.choice_build=function(e){var s,i;return(s=t("<li />",{class:"search-choice"}).html("<span>"+this.choice_label(e)+"</span>")).css("max-width",this.container.width()>100?this.container.width()-40:""),e.disabled?s.addClass("search-choice-disabled"):((i=t("<span />",{class:"search-choice-close","data-option-array-index":e.array_index})).on("click.chosen touchstart.chosen",function(t){return function(e){return t.choice_destroy_link_click(e)}}(this)),s.append(i)),this.search_container.before(s)},n.prototype.choice_destroy_link_click=function(e){if(e.preventDefault(),e.stopPropagation(),!this.is_disabled)return this.choice_destroy(t(e.target))},n.prototype.choice_destroy=function(t){if(0===t.length&&(t=this.pending_backstroke.find(".search-choice-close")),this.result_deselect(t[0].getAttribute("data-option-array-index")))return this.active_field?this.search_field.focus():this.show_search_field_default(),this.is_multiple&&this.choices_count()>0&&this.get_search_field_value().length<1&&this.results_hide(),t.parents("li").first().remove(),this.search_field_scale()},n.prototype.results_reset=function(){if(this.reset_single_select_options(),this.form_field.options[0].selected=!0,this.single_set_selected_text(),this.show_search_field_default(),this.results_reset_cleanup(),this.trigger_form_field_change(),this.active_field)return this.results_hide()},n.prototype.results_reset_cleanup=function(){return this.current_selectedIndex=this.form_field.selectedIndex,this.selected_item.find("abbr").remove()},n.prototype.result_select=function(e){var s,i,r,n,o;if(this.result_highlight)return i=this.result_highlight,this.result_clear_highlight(),this.is_multiple&&this.max_selected_options<=this.choices_count()?(this.form_field_jq.trigger("chosen:maxselected",{chosen:this}),!1):(this.is_multiple?i.removeClass("active-result"):this.reset_single_select_options(),i.addClass("result-selected"),(r=this.results_data[i[0].getAttribute("data-option-array-index")]).selected=!0,this.form_field.options[r.options_index].selected=!0,this.selected_option_count=null,this.is_multiple?this.choice_build(r):this.single_set_selected_text(this.choice_label(r)),this.is_multiple&&(!this.hide_results_on_select||e.metaKey||e.ctrlKey)?e.metaKey||e.ctrlKey?this.winnow_results({skip_highlight:!0}):(this.search_field.val(""),this.winnow_results()):(this.results_hide(),this.show_search_field_default()),(this.is_multiple||this.form_field.selectedIndex!==this.current_selectedIndex)&&this.trigger_form_field_change({selected:this.form_field.options[r.options_index].value}),this.current_selectedIndex=this.form_field.selectedIndex,e.preventDefault(),this.search_field_scale());this.options.addUserOption&&(o=this.search_field.val(),s=!1,this.results_data.some((function(t){if(t.text===o)return s=!0,!0})),s||(n=t('<option selected="selected"></option>').attr("value",o).text(o),this.form_field_jq.append(n).trigger("change",{selected:o}).trigger("chosen:updated")))},n.prototype.single_set_selected_text=function(t){return null==t&&(t=this.default_text),t===this.default_text?this.selected_item.addClass("chosen-default"):(this.single_deselect_control_build(),this.selected_item.removeClass("chosen-default")),this.selected_item.find("span").html(t)},n.prototype.result_deselect=function(t){var e;return e=this.results_data[t],!this.form_field.options[e.options_index].disabled&&(e.selected=!1,this.form_field.options[e.options_index].selected=!1,this.selected_option_count=null,this.result_clear_highlight(),this.results_showing&&this.winnow_results(),this.trigger_form_field_change({deselected:this.form_field.options[e.options_index].value}),this.search_field_scale(),!0)},n.prototype.single_deselect_control_build=function(){if(this.allow_single_deselect)return this.selected_item.find("abbr").length||this.selected_item.find("span").first().after('<abbr class="search-choice-close"></abbr>'),this.selected_item.addClass("chosen-single-with-deselect")},n.prototype.get_search_field_value=function(){return this.search_field.val()},n.prototype.get_search_text=function(){return t.trim(this.get_search_field_value())},n.prototype.escape_html=function(e){return t("<div/>").text(e).html()},n.prototype.winnow_results_set_highlight=function(){var t,e;if(null!=(t=(e=this.is_multiple?[]:this.search_results.find(".result-selected.active-result")).length?e.first():this.search_results.find(".active-result").first()))return this.result_do_highlight(t)},n.prototype.no_results=function(e){var s,i;return s=t(this.get_no_results_html(e)),this.search_results.append(s),this.options.addUserOption&&(i=this,s.addClass("add-user-option").click((function(){i.result_select()}))),this.form_field_jq.trigger("chosen:no_results",{chosen:this})},n.prototype.no_results_clear=function(){return this.search_results.find(".no-results").remove()},n.prototype.keydown_arrow=function(){var t;return this.results_showing&&this.result_highlight?(t=this.result_highlight.nextAll("li.active-result").first())?this.result_do_highlight(t):void 0:this.results_show()},n.prototype.keyup_arrow=function(){var t;return this.results_showing||this.is_multiple?this.result_highlight?(t=this.result_highlight.prevAll("li.active-result")).length?this.result_do_highlight(t.first()):(this.choices_count()>0&&this.results_hide(),this.result_clear_highlight()):void 0:this.results_show()},n.prototype.keydown_backstroke=function(){var t;return this.pending_backstroke?(this.choice_destroy(this.pending_backstroke.find("a").first()),this.clear_backstroke()):(t=this.search_container.siblings("li.search-choice").last()).length&&!t.hasClass("search-choice-disabled")?(this.pending_backstroke=t,this.single_backstroke_delete?this.keydown_backstroke():this.pending_backstroke.addClass("search-choice-focus")):void 0},n.prototype.clear_backstroke=function(){return this.pending_backstroke&&this.pending_backstroke.removeClass("search-choice-focus"),this.pending_backstroke=null},n.prototype.search_field_scale=function(){var e,s,i,r,n,o,h;if(this.is_multiple){if(h=25,this.search_field.attr("placeholder")||this.get_search_field_value()){for(n={position:"absolute",left:"-1000px",top:"-1000px",display:"none",whiteSpace:"pre"},s=0,i=(o=["fontSize","fontStyle","fontWeight","fontFamily","lineHeight","textTransform","letterSpacing"]).length;s<i;s++)n[r=o[s]]=this.search_field.css(r);(e=t("<div />").css(n)).text(this.search_field.attr("placeholder")||this.get_search_field_value()),t("body").append(e),h+=e.width(),e.remove()}return this.container.is(":visible")&&(h=Math.min(this.container.outerWidth()-10,h)),this.search_field.width(h)}},n.prototype.trigger_form_field_change=function(t){return this.form_field_jq.trigger("input",t),this.form_field_jq.trigger("change",t)},n}()}).call(this)}}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.stiltsoft.confluence.plugin.tablefilter.tablefilter:5a3c22fd74e85cde8b67b97efad6d31e', location = 'build/2434.js' */
(self.webpackChunk=self.webpackChunk||[]).push([[2434],{2413:function(t,n,e){"use strict";e.r(n),e.d(n,{default:function(){return bt}});var r="$";function i(){}function o(t,n){var e=new i;if(t instanceof i)t.each((function(t,n){e.set(n,t)}));else if(Array.isArray(t)){var r,o=-1,a=t.length;if(null==n)for(;++o<a;)e.set(o,t[o]);else for(;++o<a;)e.set(n(r=t[o],o,t),r)}else if(t)for(var u in t)e.set(u,t[u]);return e}i.prototype=o.prototype={constructor:i,has:function(t){return r+t in this},get:function(t){return this[r+t]},set:function(t,n){return this[r+t]=n,this},remove:function(t){var n=r+t;return n in this&&delete this[n]},clear:function(){for(var t in this)t[0]===r&&delete this[t]},keys:function(){var t=[];for(var n in this)n[0]===r&&t.push(n.slice(1));return t},values:function(){var t=[];for(var n in this)n[0]===r&&t.push(this[n]);return t},entries:function(){var t=[];for(var n in this)n[0]===r&&t.push({key:n.slice(1),value:this[n]});return t},size:function(){var t=0;for(var n in this)n[0]===r&&++t;return t},empty:function(){for(var t in this)if(t[0]===r)return!1;return!0},each:function(t){for(var n in this)n[0]===r&&t(this[n],n.slice(1),this)}};var a=o;function u(){}var c=a.prototype;function s(t,n){var e=new u;if(t instanceof u)t.each((function(t){e.add(t)}));else if(t){var r=-1,i=t.length;if(null==n)for(;++r<i;)e.add(t[r]);else for(;++r<i;)e.add(n(t[r],r,t))}return e}u.prototype=s.prototype={constructor:u,has:c.has,add:function(t){return this[r+(t+="")]=t,this},remove:c.remove,clear:c.clear,values:c.keys,size:c.size,empty:c.empty,each:c.each};function f(){}function l(t){return null==t?f:function(){return this.querySelector(t)}}function h(){return[]}function d(t){return new Array(t.length)}function p(t,n){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=n}p.prototype={constructor:p,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,n){return this._parent.insertBefore(t,n)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function y(t,n,e,r,i,o){for(var a,u=0,c=n.length,s=o.length;u<s;++u)(a=n[u])?(a.__data__=o[u],r[u]=a):e[u]=new p(t,o[u]);for(;u<c;++u)(a=n[u])&&(i[u]=a)}function g(t,n,e,r,i,o,a){var u,c,s,f={},l=n.length,h=o.length,d=new Array(l);for(u=0;u<l;++u)(c=n[u])&&(d[u]=s="$"+a.call(c,c.__data__,u,n),s in f?i[u]=c:f[s]=c);for(u=0;u<h;++u)(c=f[s="$"+a.call(t,o[u],u,o)])?(r[u]=c,c.__data__=o[u],f[s]=null):e[u]=new p(t,o[u]);for(u=0;u<l;++u)(c=n[u])&&f[d[u]]===c&&(i[u]=c)}function v(t,n){return t<n?-1:t>n?1:t>=n?0:NaN}var m="http://www.w3.org/1999/xhtml",b={svg:"http://www.w3.org/2000/svg",xhtml:m,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function x(t){var n=t+="",e=n.indexOf(":");return e>=0&&"xmlns"!==(n=t.slice(0,e))&&(t=t.slice(e+1)),b.hasOwnProperty(n)?{space:b[n],local:t}:t}function _(t){return function(){this.removeAttribute(t)}}function w(t){return function(){this.removeAttributeNS(t.space,t.local)}}function A(t,n){return function(){this.setAttribute(t,n)}}function S(t,n){return function(){this.setAttributeNS(t.space,t.local,n)}}function M(t,n){return function(){var e=n.apply(this,arguments);null==e?this.removeAttribute(t):this.setAttribute(t,e)}}function T(t,n){return function(){var e=n.apply(this,arguments);null==e?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,e)}}function E(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function C(t){return function(){this.style.removeProperty(t)}}function k(t,n,e){return function(){this.style.setProperty(t,n,e)}}function N(t,n,e){return function(){var r=n.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,e)}}function O(t,n){return t.style.getPropertyValue(n)||E(t).getComputedStyle(t,null).getPropertyValue(n)}function P(t){return function(){delete this[t]}}function I(t,n){return function(){this[t]=n}}function R(t,n){return function(){var e=n.apply(this,arguments);null==e?delete this[t]:this[t]=e}}function z(t){return t.trim().split(/^|\s+/)}function V(t){return t.classList||new D(t)}function D(t){this._node=t,this._names=z(t.getAttribute("class")||"")}function j(t,n){for(var e=V(t),r=-1,i=n.length;++r<i;)e.add(n[r])}function L(t,n){for(var e=V(t),r=-1,i=n.length;++r<i;)e.remove(n[r])}function U(t){return function(){j(this,t)}}function B(t){return function(){L(this,t)}}function F(t,n){return function(){(n.apply(this,arguments)?j:L)(this,t)}}function q(){this.textContent=""}function H(t){return function(){this.textContent=t}}function Y(t){return function(){var n=t.apply(this,arguments);this.textContent=null==n?"":n}}function X(){this.innerHTML=""}function $(t){return function(){this.innerHTML=t}}function W(t){return function(){var n=t.apply(this,arguments);this.innerHTML=null==n?"":n}}function G(){this.nextSibling&&this.parentNode.appendChild(this)}function Q(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Z(t){return function(){var n=this.ownerDocument,e=this.namespaceURI;return e===m&&n.documentElement.namespaceURI===m?n.createElement(t):n.createElementNS(e,t)}}function K(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function J(t){var n=x(t);return(n.local?K:Z)(n)}function tt(){return null}function nt(){var t=this.parentNode;t&&t.removeChild(this)}function et(){var t=this.cloneNode(!1),n=this.parentNode;return n?n.insertBefore(t,this.nextSibling):t}function rt(){var t=this.cloneNode(!0),n=this.parentNode;return n?n.insertBefore(t,this.nextSibling):t}D.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var n=this._names.indexOf(t);n>=0&&(this._names.splice(n,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var it={},ot=null;"undefined"!=typeof document&&("onmouseenter"in document.documentElement||(it={mouseenter:"mouseover",mouseleave:"mouseout"}));function at(t,n,e){return t=ut(t,n,e),function(n){var e=n.relatedTarget;e&&(e===this||8&e.compareDocumentPosition(this))||t.call(this,n)}}function ut(t,n,e){return function(r){var i=ot;ot=r;try{t.call(this,this.__data__,n,e)}finally{ot=i}}}function ct(t){return t.trim().split(/^|\s+/).map((function(t){var n="",e=t.indexOf(".");return e>=0&&(n=t.slice(e+1),t=t.slice(0,e)),{type:t,name:n}}))}function st(t){return function(){var n=this.__on;if(n){for(var e,r=0,i=-1,o=n.length;r<o;++r)e=n[r],t.type&&e.type!==t.type||e.name!==t.name?n[++i]=e:this.removeEventListener(e.type,e.listener,e.capture);++i?n.length=i:delete this.__on}}}function ft(t,n,e){var r=it.hasOwnProperty(t.type)?at:ut;return function(i,o,a){var u,c=this.__on,s=r(n,o,a);if(c)for(var f=0,l=c.length;f<l;++f)if((u=c[f]).type===t.type&&u.name===t.name)return this.removeEventListener(u.type,u.listener,u.capture),this.addEventListener(u.type,u.listener=s,u.capture=e),void(u.value=n);this.addEventListener(t.type,s,e),u={type:t.type,name:t.name,value:n,listener:s,capture:e},c?c.push(u):this.__on=[u]}}function lt(t,n,e){var r=E(t),i=r.CustomEvent;"function"==typeof i?i=new i(n,e):(i=r.document.createEvent("Event"),e?(i.initEvent(n,e.bubbles,e.cancelable),i.detail=e.detail):i.initEvent(n,!1,!1)),t.dispatchEvent(i)}function ht(t,n){return function(){return lt(this,t,n)}}function dt(t,n){return function(){return lt(this,t,n.apply(this,arguments))}}var pt=[null];function yt(t,n){this._groups=t,this._parents=n}function gt(){return new yt([[document.documentElement]],pt)}yt.prototype=gt.prototype={constructor:yt,select:function(t){"function"!=typeof t&&(t=l(t));for(var n=this._groups,e=n.length,r=new Array(e),i=0;i<e;++i)for(var o,a,u=n[i],c=u.length,s=r[i]=new Array(c),f=0;f<c;++f)(o=u[f])&&(a=t.call(o,o.__data__,f,u))&&("__data__"in o&&(a.__data__=o.__data__),s[f]=a);return new yt(r,this._parents)},selectAll:function(t){"function"!=typeof t&&(t=function(t){return null==t?h:function(){return this.querySelectorAll(t)}}(t));for(var n=this._groups,e=n.length,r=[],i=[],o=0;o<e;++o)for(var a,u=n[o],c=u.length,s=0;s<c;++s)(a=u[s])&&(r.push(t.call(a,a.__data__,s,u)),i.push(a));return new yt(r,i)},filter:function(t){"function"!=typeof t&&(t=function(t){return function(){return this.matches(t)}}(t));for(var n=this._groups,e=n.length,r=new Array(e),i=0;i<e;++i)for(var o,a=n[i],u=a.length,c=r[i]=[],s=0;s<u;++s)(o=a[s])&&t.call(o,o.__data__,s,a)&&c.push(o);return new yt(r,this._parents)},data:function(t,n){if(!t)return p=new Array(this.size()),f=-1,this.each((function(t){p[++f]=t})),p;var e,r=n?g:y,i=this._parents,o=this._groups;"function"!=typeof t&&(e=t,t=function(){return e});for(var a=o.length,u=new Array(a),c=new Array(a),s=new Array(a),f=0;f<a;++f){var l=i[f],h=o[f],d=h.length,p=t.call(l,l&&l.__data__,f,i),v=p.length,m=c[f]=new Array(v),b=u[f]=new Array(v);r(l,h,m,b,s[f]=new Array(d),p,n);for(var x,_,w=0,A=0;w<v;++w)if(x=m[w]){for(w>=A&&(A=w+1);!(_=b[A])&&++A<v;);x._next=_||null}}return(u=new yt(u,i))._enter=c,u._exit=s,u},enter:function(){return new yt(this._enter||this._groups.map(d),this._parents)},exit:function(){return new yt(this._exit||this._groups.map(d),this._parents)},join:function(t,n,e){var r=this.enter(),i=this,o=this.exit();return r="function"==typeof t?t(r):r.append(t+""),null!=n&&(i=n(i)),null==e?o.remove():e(o),r&&i?r.merge(i).order():i},merge:function(t){for(var n=this._groups,e=t._groups,r=n.length,i=e.length,o=Math.min(r,i),a=new Array(r),u=0;u<o;++u)for(var c,s=n[u],f=e[u],l=s.length,h=a[u]=new Array(l),d=0;d<l;++d)(c=s[d]||f[d])&&(h[d]=c);for(;u<r;++u)a[u]=n[u];return new yt(a,this._parents)},order:function(){for(var t=this._groups,n=-1,e=t.length;++n<e;)for(var r,i=t[n],o=i.length-1,a=i[o];--o>=0;)(r=i[o])&&(a&&4^r.compareDocumentPosition(a)&&a.parentNode.insertBefore(r,a),a=r);return this},sort:function(t){function n(n,e){return n&&e?t(n.__data__,e.__data__):!n-!e}t||(t=v);for(var e=this._groups,r=e.length,i=new Array(r),o=0;o<r;++o){for(var a,u=e[o],c=u.length,s=i[o]=new Array(c),f=0;f<c;++f)(a=u[f])&&(s[f]=a);s.sort(n)}return new yt(i,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){var t=new Array(this.size()),n=-1;return this.each((function(){t[++n]=this})),t},node:function(){for(var t=this._groups,n=0,e=t.length;n<e;++n)for(var r=t[n],i=0,o=r.length;i<o;++i){var a=r[i];if(a)return a}return null},size:function(){var t=0;return this.each((function(){++t})),t},empty:function(){return!this.node()},each:function(t){for(var n=this._groups,e=0,r=n.length;e<r;++e)for(var i,o=n[e],a=0,u=o.length;a<u;++a)(i=o[a])&&t.call(i,i.__data__,a,o);return this},attr:function(t,n){var e=x(t);if(arguments.length<2){var r=this.node();return e.local?r.getAttributeNS(e.space,e.local):r.getAttribute(e)}return this.each((null==n?e.local?w:_:"function"==typeof n?e.local?T:M:e.local?S:A)(e,n))},style:function(t,n,e){return arguments.length>1?this.each((null==n?C:"function"==typeof n?N:k)(t,n,null==e?"":e)):O(this.node(),t)},property:function(t,n){return arguments.length>1?this.each((null==n?P:"function"==typeof n?R:I)(t,n)):this.node()[t]},classed:function(t,n){var e=z(t+"");if(arguments.length<2){for(var r=V(this.node()),i=-1,o=e.length;++i<o;)if(!r.contains(e[i]))return!1;return!0}return this.each(("function"==typeof n?F:n?U:B)(e,n))},text:function(t){return arguments.length?this.each(null==t?q:("function"==typeof t?Y:H)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?X:("function"==typeof t?W:$)(t)):this.node().innerHTML},raise:function(){return this.each(G)},lower:function(){return this.each(Q)},append:function(t){var n="function"==typeof t?t:J(t);return this.select((function(){return this.appendChild(n.apply(this,arguments))}))},insert:function(t,n){var e="function"==typeof t?t:J(t),r=null==n?tt:"function"==typeof n?n:l(n);return this.select((function(){return this.insertBefore(e.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(nt)},clone:function(t){return this.select(t?rt:et)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,n,e){var r,i,o=ct(t+""),a=o.length;if(!(arguments.length<2)){for(u=n?ft:st,null==e&&(e=!1),r=0;r<a;++r)this.each(u(o[r],n,e));return this}var u=this.node().__on;if(u)for(var c,s=0,f=u.length;s<f;++s)for(r=0,c=u[s];r<a;++r)if((i=o[r]).type===c.type&&i.name===c.name)return c.value},dispatch:function(t,n){return this.each(("function"==typeof n?dt:ht)(t,n))}};var vt=gt;function mt(t){return"string"==typeof t?new yt([[document.querySelector(t)]],[document.documentElement]):new yt([[t]],pt)}function bt(){var t=function(){return"n"},n=function(){return[0,0]},e=function(){return" "},r=document.body,i=h(),o=null,u=null,c=null;function s(t){var n;n=t.node(),(o=n?"svg"===n.tagName.toLowerCase()?n:n.ownerSVGElement:null)&&(u=o.createSVGPoint(),r.appendChild(i))}s.show=function(){var i=Array.prototype.slice.call(arguments);i[i.length-1]instanceof SVGElement&&(c=i.pop());var o,a=e.apply(this,i),u=n.apply(this,i),h=t.apply(this,i),p=d(),y=l.length,g=document.documentElement.scrollTop||r.scrollTop,v=document.documentElement.scrollLeft||r.scrollLeft;for(p.html(a).style("opacity",1).style("pointer-events","all");y--;)p.classed(l[y],!1);return o=f.get(h).apply(this),p.classed(h,!0).style("top",o.top+u[0]+g+"px").style("left",o.left+u[1]+v+"px"),s},s.hide=function(){return d().style("opacity",0).style("pointer-events","none"),s},s.attr=function(t,n){if(arguments.length<2&&"string"==typeof t)return d().attr(t);var e=Array.prototype.slice.call(arguments);return vt.prototype.attr.apply(d(),e),s},s.style=function(t,n){if(arguments.length<2&&"string"==typeof t)return d().style(t);var e=Array.prototype.slice.call(arguments);return vt.prototype.style.apply(d(),e),s},s.direction=function(n){return arguments.length?(t=null==n?n:y(n),s):t},s.offset=function(t){return arguments.length?(n=null==t?t:y(t),s):n},s.html=function(t){return arguments.length?(e=null==t?t:y(t),s):e},s.rootElement=function(t){return arguments.length?(r=null==t?t:y(t),s):r},s.destroy=function(){return i&&(d().remove(),i=null),s};var f=a({n:function(){var t=p(this);return{top:t.n.y-i.offsetHeight,left:t.n.x-i.offsetWidth/2}},s:function(){var t=p(this);return{top:t.s.y,left:t.s.x-i.offsetWidth/2}},e:function(){var t=p(this);return{top:t.e.y-i.offsetHeight/2,left:t.e.x}},w:function(){var t=p(this);return{top:t.w.y-i.offsetHeight/2,left:t.w.x-i.offsetWidth}},nw:function(){var t=p(this);return{top:t.nw.y-i.offsetHeight,left:t.nw.x-i.offsetWidth}},ne:function(){var t=p(this);return{top:t.ne.y-i.offsetHeight,left:t.ne.x}},sw:function(){var t=p(this);return{top:t.sw.y,left:t.sw.x-i.offsetWidth}},se:function(){var t=p(this);return{top:t.se.y,left:t.se.x}}}),l=f.keys();function h(){var t=mt(document.createElement("div"));return t.style("position","absolute").style("top",0).style("opacity",0).style("pointer-events","none").style("box-sizing","border-box"),t.node()}function d(){return null==i&&(i=h(),r.appendChild(i)),mt(i)}function p(t){for(var n=c||t;null==n.getScreenCTM&&null!=n.parentNode;)n=n.parentNode;var e={},r=n.getScreenCTM(),i=n.getBBox(),o=i.width,a=i.height,s=i.x,f=i.y;return u.x=s,u.y=f,e.nw=u.matrixTransform(r),u.x+=o,e.ne=u.matrixTransform(r),u.y+=a,e.se=u.matrixTransform(r),u.x-=o,e.sw=u.matrixTransform(r),u.y-=a/2,e.w=u.matrixTransform(r),u.x+=o,e.e=u.matrixTransform(r),u.x-=o/2,u.y-=a/2,e.n=u.matrixTransform(r),u.y+=a,e.s=u.matrixTransform(r),e}function y(t){return"function"==typeof t?t:function(){return t}}return s}},9264:function(t,n,e){t.exports={ResizeSensor:e(6118),ElementQueries:e(8415)}},8415:function(t,n,e){"use strict";var r,i,o;"undefined"!=typeof window&&window,i=[e(6118)],void 0===(o="function"==typeof(r=function(t){var n=function(){var n,e={},r=[];function i(t){t||(t=document.documentElement);var n=window.getComputedStyle(t,null).fontSize;return parseFloat(n)||16}function o(t){if(!t.getBoundingClientRect)return{width:t.offsetWidth,height:t.offsetHeight};var n=t.getBoundingClientRect();return{width:Math.round(n.width),height:Math.round(n.height)}}function a(t,n){var e=n.split(/\d/),r=e[e.length-1];switch(n=parseFloat(n),r){case"px":return n;case"em":return n*i(t);case"rem":return n*i();case"vw":return n*document.documentElement.clientWidth/100;case"vh":return n*document.documentElement.clientHeight/100;case"vmin":case"vmax":var o=document.documentElement.clientWidth/100,a=document.documentElement.clientHeight/100;return n*(0,Math["vmin"===r?"min":"max"])(o,a);default:return n}}function u(t,n){var r,i,u,c,s,f,l,h;this.element=t;var d=["min-width","min-height","max-width","max-height"];this.call=function(){for(r in u=o(this.element),f={},e[n])e[n].hasOwnProperty(r)&&(i=e[n][r],c=a(this.element,i.value),s="width"===i.property?u.width:u.height,h=i.mode+"-"+i.property,l="","min"===i.mode&&s>=c&&(l+=i.value),"max"===i.mode&&s<=c&&(l+=i.value),f[h]||(f[h]=""),l&&-1===(" "+f[h]+" ").indexOf(" "+l+" ")&&(f[h]+=" "+l));for(var t in d)d.hasOwnProperty(t)&&(f[d[t]]?this.element.setAttribute(d[t],f[d[t]].substr(1)):this.element.removeAttribute(d[t]))}}function c(n,e){n.elementQueriesSetupInformation||(n.elementQueriesSetupInformation=new u(n,e)),n.elementQueriesSensor||(n.elementQueriesSensor=new t(n,(function(){n.elementQueriesSetupInformation.call()})))}function s(t,i,o,a){if(void 0===e[t]){e[t]=[];var u=r.length;n.innerHTML+="\n"+t+" {animation: 0.1s element-queries;}",n.innerHTML+="\n"+t+" > .resize-sensor {min-width: "+u+"px;}",r.push(t)}e[t].push({mode:i,property:o,value:a})}function f(t){var n;if(document.querySelectorAll&&(n=t?t.querySelectorAll.bind(t):document.querySelectorAll.bind(document)),n||"undefined"==typeof $$||(n=$$),n||"undefined"==typeof jQuery||(n=jQuery),!n)throw"No document.querySelectorAll, jQuery or Mootools's $$ found.";return n}function l(t){var n=f(t);for(var r in e)if(e.hasOwnProperty(r))for(var i=n(r,t),o=0,a=i.length;o<a;o++)c(i[o],r)}function h(n){var e=[],r=[],i=[],o=0,a=-1,u=[];for(var c in n.children)if(n.children.hasOwnProperty(c)&&n.children[c].tagName&&"img"===n.children[c].tagName.toLowerCase()){e.push(n.children[c]);var s=n.children[c].getAttribute("min-width")||n.children[c].getAttribute("data-min-width"),f=n.children[c].getAttribute("data-src")||n.children[c].getAttribute("url");i.push(f);var l={minWidth:s};r.push(l),s?n.children[c].style.display="none":(o=e.length-1,n.children[c].style.display="block")}function h(){var t,c=!1;for(t in e)e.hasOwnProperty(t)&&r[t].minWidth&&n.offsetWidth>r[t].minWidth&&(c=t);if(c||(c=o),a!==c)if(u[c])e[a].style.display="none",e[c].style.display="block",a=c;else{var s=new Image;s.onload=function(){e[c].src=i[c],e[a].style.display="none",e[c].style.display="block",u[c]=!0,a=c},s.src=i[c]}else e[c].src=i[c]}a=o,n.resizeSensorInstance=new t(n,h),h()}function d(){for(var t=f()("[data-responsive-image],[responsive-image]"),n=0,e=t.length;n<e;n++)h(t[n])}var p=/,?[\s\t]*([^,\n]*?)((?:\[[\s\t]*?(?:min|max)-(?:width|height)[\s\t]*?[~$\^]?=[\s\t]*?"[^"]*?"[\s\t]*?])+)([^,\n\s\{]*)/gim,y=/\[[\s\t]*?(min|max)-(width|height)[\s\t]*?[~$\^]?=[\s\t]*?"([^"]*?)"[\s\t]*?]/gim;function g(t){var n,e,r,i;for(t=t.replace(/'/g,'"');null!==(n=p.exec(t));)for(e=n[1]+n[3],r=n[2];null!==(i=y.exec(r));)s(e,i[1],i[2],i[3])}function v(t){var n="";if(t)if("string"==typeof t)-1===(t=t.toLowerCase()).indexOf("min-width")&&-1===t.indexOf("max-width")||g(t);else for(var e=0,r=t.length;e<r;e++)1===t[e].type?-1!==(n=t[e].selectorText||t[e].cssText).indexOf("min-height")||-1!==n.indexOf("max-height")?g(n):-1===n.indexOf("min-width")&&-1===n.indexOf("max-width")||g(n):4===t[e].type?v(t[e].cssRules||t[e].rules):3===t[e].type&&t[e].styleSheet.hasOwnProperty("cssRules")&&v(t[e].styleSheet.cssRules)}var m=!1;this.init=function(){var e="animationstart";void 0!==document.documentElement.style.webkitAnimationName?e="webkitAnimationStart":void 0!==document.documentElement.style.MozAnimationName?e="mozanimationstart":void 0!==document.documentElement.style.OAnimationName&&(e="oanimationstart"),document.body.addEventListener(e,(function(n){var e=n.target,i=e&&window.getComputedStyle(e,null),o=i&&i.getPropertyValue("animation-name");if(o&&-1!==o.indexOf("element-queries")){e.elementQueriesSensor=new t(e,(function(){e.elementQueriesSetupInformation&&e.elementQueriesSetupInformation.call()}));var a=window.getComputedStyle(e.resizeSensor,null).getPropertyValue("min-width");a=parseInt(a.replace("px","")),c(n.target,r[a])}})),m||((n=document.createElement("style")).type="text/css",n.innerHTML="[responsive-image] > img, [data-responsive-image] {overflow: hidden; padding: 0; } [responsive-image] > img, [data-responsive-image] > img {width: 100%;}",n.innerHTML+="\n@keyframes element-queries { 0% { visibility: inherit; } }",document.getElementsByTagName("head")[0].appendChild(n),m=!0);for(var i=0,o=document.styleSheets.length;i<o;i++)try{document.styleSheets[i].href&&document.styleSheets[i].href.indexOf("file://"),v(document.styleSheets[i].cssRules||document.styleSheets[i].rules||document.styleSheets[i].cssText)}catch(t){}d()},this.findElementQueriesElements=function(t){l(t)},this.update=function(){this.init()}};n.update=function(){n.instance.update()},n.detach=function(t){t.elementQueriesSetupInformation?(t.elementQueriesSensor.detach(),delete t.elementQueriesSetupInformation,delete t.elementQueriesSensor):t.resizeSensorInstance&&(t.resizeSensorInstance.detach(),delete t.resizeSensorInstance)},n.init=function(){n.instance||(n.instance=new n),n.instance.init()};var e=function(t){if(document.addEventListener)document.addEventListener("DOMContentLoaded",t,!1);else if(/KHTML|WebKit|iCab/i.test(navigator.userAgent))var n=setInterval((function(){/loaded|complete/i.test(document.readyState)&&(t(),clearInterval(n))}),10);else window.onload=t};return n.findElementQueriesElements=function(t){n.instance.findElementQueriesElements(t)},n.listen=function(){e(n.init)},n})?r.apply(n,i):r)||(t.exports=o)},6118:function(t,n,e){"use strict";var r,i;"undefined"!=typeof window&&window,void 0===(i="function"==typeof(r=function(){if("undefined"==typeof window)return null;var t="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")(),n=t.requestAnimationFrame||t.mozRequestAnimationFrame||t.webkitRequestAnimationFrame||function(n){return t.setTimeout(n,20)},e=t.cancelAnimationFrame||t.mozCancelAnimationFrame||t.webkitCancelAnimationFrame||function(n){t.clearTimeout(n)};function r(t,n){var e=Object.prototype.toString.call(t),r="[object Array]"===e||"[object NodeList]"===e||"[object HTMLCollection]"===e||"[object Object]"===e||"undefined"!=typeof jQuery&&t instanceof jQuery||"undefined"!=typeof Elements&&t instanceof Elements,i=0,o=t.length;if(r)for(;i<o;i++)n(t[i]);else n(t)}function i(t){if(!t.getBoundingClientRect)return{width:t.offsetWidth,height:t.offsetHeight};var n=t.getBoundingClientRect();return{width:Math.round(n.width),height:Math.round(n.height)}}function o(t,n){Object.keys(n).forEach((function(e){t.style[e]=n[e]}))}var a=function(t,u){var c=0;function s(){var t,n,e=[];this.add=function(t){e.push(t)},this.call=function(r){for(t=0,n=e.length;t<n;t++)e[t].call(this,r)},this.remove=function(r){var i=[];for(t=0,n=e.length;t<n;t++)e[t]!==r&&i.push(e[t]);e=i},this.length=function(){return e.length}}function f(t,e){if(t)if(t.resizedAttached)t.resizedAttached.add(e);else{t.resizedAttached=new s,t.resizedAttached.add(e),t.resizeSensor=document.createElement("div"),t.resizeSensor.dir="ltr",t.resizeSensor.className="resize-sensor";var r={pointerEvents:"none",position:"absolute",left:"0px",top:"0px",right:"0px",bottom:"0px",overflow:"hidden",zIndex:"-1",visibility:"hidden",maxWidth:"100%"},a={position:"absolute",left:"0px",top:"0px",transition:"0s"};o(t.resizeSensor,r);var u=document.createElement("div");u.className="resize-sensor-expand",o(u,r);var f=document.createElement("div");o(f,a),u.appendChild(f);var l=document.createElement("div");l.className="resize-sensor-shrink",o(l,r);var h=document.createElement("div");o(h,a),o(h,{width:"200%",height:"200%"}),l.appendChild(h),t.resizeSensor.appendChild(u),t.resizeSensor.appendChild(l),t.appendChild(t.resizeSensor);var d=window.getComputedStyle(t),p=d?d.getPropertyValue("position"):null;"absolute"!==p&&"relative"!==p&&"fixed"!==p&&"sticky"!==p&&(t.style.position="relative");var y=!1,g=0,v=i(t),m=0,b=0,x=!0;c=0;var _=function(){var n=t.offsetWidth,e=t.offsetHeight;f.style.width=n+10+"px",f.style.height=e+10+"px",u.scrollLeft=n+10,u.scrollTop=e+10,l.scrollLeft=n+10,l.scrollTop=e+10},w=function(){if(x){if(0===t.offsetWidth&&0===t.offsetHeight)return void(c||(c=n((function(){c=0,w()}))));x=!1}_()};t.resizeSensor.resetSensor=w;var A=function(){g=0,y&&(m=v.width,b=v.height,t.resizedAttached&&t.resizedAttached.call(v))},S=function(){v=i(t),(y=v.width!==m||v.height!==b)&&!g&&(g=n(A)),w()},M=function(t,n,e){t.attachEvent?t.attachEvent("on"+n,e):t.addEventListener(n,e)};M(u,"scroll",S),M(l,"scroll",S),c=n((function(){c=0,w()}))}}r(t,(function(t){f(t,u)})),this.detach=function(n){c||(e(c),c=0),a.detach(t,n)},this.reset=function(){t.resizeSensor.resetSensor()}};if(a.reset=function(t){r(t,(function(t){t.resizeSensor.resetSensor()}))},a.detach=function(t,n){r(t,(function(t){t&&(t.resizedAttached&&"function"==typeof n&&(t.resizedAttached.remove(n),t.resizedAttached.length())||t.resizeSensor&&(t.contains(t.resizeSensor)&&t.removeChild(t.resizeSensor),delete t.resizeSensor,delete t.resizedAttached))}))},"undefined"!=typeof MutationObserver){var u=new MutationObserver((function(t){for(var n in t)if(t.hasOwnProperty(n))for(var e=t[n].addedNodes,r=0;r<e.length;r++)e[r].resizeSensor&&a.reset(e[r])}));document.addEventListener("DOMContentLoaded",(function(t){u.observe(document.body,{childList:!0,subtree:!0})}))}return a})?r.call(n,e,n,t):r)||(t.exports=i)},2930:function(t){(function(){var n,e,r,i,o,a;"undefined"!=typeof performance&&null!==performance&&performance.now?t.exports=function(){return performance.now()}:"undefined"!=typeof process&&null!==process&&process.hrtime?(t.exports=function(){return(n()-o)/1e6},e=process.hrtime,i=(n=function(){var t;return 1e9*(t=e())[0]+t[1]})(),a=1e9*process.uptime(),o=i-a):Date.now?(t.exports=function(){return Date.now()-r},r=Date.now()):(t.exports=function(){return(new Date).getTime()-r},r=(new Date).getTime())}).call(this)},8729:function(t,n,e){for(var r=e(2930),i="undefined"==typeof window?e.g:window,o=["moz","webkit"],a="AnimationFrame",u=i["request"+a],c=i["cancel"+a]||i["cancelRequest"+a],s=0;!u&&s<o.length;s++)u=i[o[s]+"Request"+a],c=i[o[s]+"Cancel"+a]||i[o[s]+"CancelRequest"+a];if(!u||!c){var f=0,l=0,h=[];u=function(t){if(0===h.length){var n=r(),e=Math.max(0,16.666666666666668-(n-f));f=e+n,setTimeout((function(){var t=h.slice(0);h.length=0;for(var n=0;n<t.length;n++)if(!t[n].cancelled)try{t[n].callback(f)}catch(t){setTimeout((function(){throw t}),0)}}),Math.round(e))}return h.push({handle:++l,callback:t,cancelled:!1}),l},c=function(t){for(var n=0;n<h.length;n++)h[n].handle===t&&(h[n].cancelled=!0)}}t.exports=function(t){return u.call(i,t)},t.exports.cancel=function(){c.apply(i,arguments)},t.exports.polyfill=function(t){t||(t=i),t.requestAnimationFrame=u,t.cancelAnimationFrame=c}},1091:function(t){t.exports=function(t){this.ok=!1,this.alpha=1,"#"==t.charAt(0)&&(t=t.substr(1,6)),t=(t=t.replace(/ /g,"")).toLowerCase();var n={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};t=n[t]||t;for(var e=[{re:/^rgba\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3}),\s*((?:\d?\.)?\d)\)$/,example:["rgba(123, 234, 45, 0.8)","rgba(255,234,245,1.0)"],process:function(t){return[parseInt(t[1]),parseInt(t[2]),parseInt(t[3]),parseFloat(t[4])]}},{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(t){return[parseInt(t[1]),parseInt(t[2]),parseInt(t[3])]}},{re:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,example:["#00ff00","336699"],process:function(t){return[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]}},{re:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,example:["#fb0","f0f"],process:function(t){return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)]}}],r=0;r<e.length;r++){var i=e[r].re,o=e[r].process,a=i.exec(t);if(a){var u=o(a);this.r=u[0],this.g=u[1],this.b=u[2],u.length>3&&(this.alpha=u[3]),this.ok=!0}}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.alpha=this.alpha<0?0:this.alpha>1||isNaN(this.alpha)?1:this.alpha,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toRGBA=function(){return"rgba("+this.r+", "+this.g+", "+this.b+", "+this.alpha+")"},this.toHex=function(){var t=this.r.toString(16),n=this.g.toString(16),e=this.b.toString(16);return 1==t.length&&(t="0"+t),1==n.length&&(n="0"+n),1==e.length&&(e="0"+e),"#"+t+n+e},this.getHelpXML=function(){for(var t=new Array,r=0;r<e.length;r++)for(var i=e[r].example,o=0;o<i.length;o++)t[t.length]=i[o];for(var a in n)t[t.length]=a;var u=document.createElement("ul");u.setAttribute("id","rgbcolor-examples");for(r=0;r<t.length;r++)try{var c=document.createElement("li"),s=new RGBColor(t[r]),f=document.createElement("div");f.style.cssText="margin: 3px; border: 1px solid black; background:"+s.toHex()+"; color:"+s.toHex(),f.appendChild(document.createTextNode("test"));var l=document.createTextNode(" "+t[r]+" -> "+s.toRGB()+" -> "+s.toHex());c.appendChild(f),c.appendChild(l),u.appendChild(c)}catch(t){}return u}}},2506:function(t,n,e){"use strict";function r(t,n){return null==t||null==n?NaN:t<n?-1:t>n?1:t>=n?0:NaN}function i(t){var n=t,e=t;function i(t,n,r,i){for(null==r&&(r=0),null==i&&(i=t.length);r<i;){var o=r+i>>>1;e(t[o],n)<0?r=o+1:i=o}return r}return 1===t.length&&(n=function(n,e){return t(n)-e},e=function(t){return function(n,e){return r(t(n),e)}}(t)),{left:i,center:function(t,e,r,o){null==r&&(r=0),null==o&&(o=t.length);var a=i(t,e,r,o-1);return a>r&&n(t[a-1],e)>-n(t[a],e)?a-1:a},right:function(t,n,r,i){for(null==r&&(r=0),null==i&&(i=t.length);r<i;){var o=r+i>>>1;e(t[o],n)>0?i=o:r=o+1}return r}}}e.r(n),e.d(n,{Adder:function(){return L},Delaunay:function(){return Hs},FormatSpecifier:function(){return Jl},InternMap:function(){return ut},InternSet:function(){return ct},Node:function(){return Av},Voronoi:function(){return Rs},ZoomTransform:function(){return GE},active:function(){return Wa},arc:function(){return LM},area:function(){return WM},areaRadial:function(){return rT},ascending:function(){return r},autoType:function(){return Sf},axisBottom:function(){return qe},axisLeft:function(){return He},axisRight:function(){return Fe},axisTop:function(){return Be},bin:function(){return Kt},bisect:function(){return y},bisectCenter:function(){return p},bisectLeft:function(){return d},bisectRight:function(){return h},bisector:function(){return i},blob:function(){return ol},brush:function(){return Eu},brushSelection:function(){return Su},brushX:function(){return Mu},brushY:function(){return Tu},buffer:function(){return ul},chord:function(){return Bu},chordDirected:function(){return qu},chordTranspose:function(){return Fu},cluster:function(){return fv},color:function(){return qi},contourDensity:function(){return ns},contours:function(){return Gc},count:function(){return m},create:function(){return hM},creator:function(){return ni},cross:function(){return T},csv:function(){return hl},csvFormat:function(){return lf},csvFormatBody:function(){return hf},csvFormatRow:function(){return pf},csvFormatRows:function(){return df},csvFormatValue:function(){return yf},csvParse:function(){return sf},csvParseRows:function(){return ff},cubehelix:function(){return Lc},cumsum:function(){return E},curveBasis:function(){return VT},curveBasisClosed:function(){return jT},curveBasisOpen:function(){return UT},curveBumpX:function(){return qT},curveBumpY:function(){return HT},curveBundle:function(){return XT},curveCardinal:function(){return GT},curveCardinalClosed:function(){return ZT},curveCardinalOpen:function(){return JT},curveCatmullRom:function(){return eE},curveCatmullRomClosed:function(){return iE},curveCatmullRomOpen:function(){return aE},curveLinear:function(){return HM},curveLinearClosed:function(){return cE},curveMonotoneX:function(){return gE},curveMonotoneY:function(){return vE},curveNatural:function(){return xE},curveStep:function(){return wE},curveStepAfter:function(){return SE},curveStepBefore:function(){return AE},descending:function(){return C},deviation:function(){return P},difference:function(){return me},disjoint:function(){return _e},dispatch:function(){return Ze},drag:function(){return Js},dragDisable:function(){return Ai},dragEnable:function(){return Si},dsv:function(){return ll},dsvFormat:function(){return uf},easeBack:function(){return Jf},easeBackIn:function(){return Zf},easeBackInOut:function(){return Jf},easeBackOut:function(){return Kf},easeBounce:function(){return Wf},easeBounceIn:function(){return $f},easeBounceInOut:function(){return Gf},easeBounceOut:function(){return Wf},easeCircle:function(){return Hf},easeCircleIn:function(){return Ff},easeCircleInOut:function(){return Hf},easeCircleOut:function(){return qf},easeCubic:function(){return Ha},easeCubicIn:function(){return Fa},easeCubicInOut:function(){return Ha},easeCubicOut:function(){return qa},easeElastic:function(){return el},easeElasticIn:function(){return nl},easeElasticInOut:function(){return rl},easeElasticOut:function(){return el},easeExp:function(){return Bf},easeExpIn:function(){return Lf},easeExpInOut:function(){return Bf},easeExpOut:function(){return Uf},easeLinear:function(){return Tf},easePoly:function(){return Pf},easePolyIn:function(){return Nf},easePolyInOut:function(){return Pf},easePolyOut:function(){return Of},easeQuad:function(){return kf},easeQuadIn:function(){return Ef},easeQuadInOut:function(){return kf},easeQuadOut:function(){return Cf},easeSin:function(){return Df},easeSinIn:function(){return zf},easeSinInOut:function(){return Df},easeSinOut:function(){return Vf},every:function(){return ae},extent:function(){return z},fcumsum:function(){return B},filter:function(){return he},flatGroup:function(){return wt},flatRollup:function(){return At},forceCenter:function(){return _l},forceCollide:function(){return Rl},forceLink:function(){return jl},forceManyBody:function(){return Hl},forceRadial:function(){return Yl},forceSimulation:function(){return ql},forceX:function(){return Xl},forceY:function(){return $l},format:function(){return ih},formatDefaultLocale:function(){return sh},formatLocale:function(){return ch},formatPrefix:function(){return oh},formatSpecifier:function(){return Kl},fsum:function(){return U},geoAlbers:function(){return Mg},geoAlbersUsa:function(){return Tg},geoArea:function(){return dd},geoAzimuthalEqualArea:function(){return Ng},geoAzimuthalEqualAreaRaw:function(){return kg},geoAzimuthalEquidistant:function(){return Pg},geoAzimuthalEquidistantRaw:function(){return Og},geoBounds:function(){return Wd},geoCentroid:function(){return ap},geoCircle:function(){return vp},geoClipAntimeridian:function(){return Cp},geoClipCircle:function(){return kp},geoClipExtent:function(){return Dp},geoClipRectangle:function(){return Vp},geoConicConformal:function(){return jg},geoConicConformalRaw:function(){return Dg},geoConicEqualArea:function(){return Sg},geoConicEqualAreaRaw:function(){return Ag},geoConicEquidistant:function(){return Fg},geoConicEquidistantRaw:function(){return Bg},geoContains:function(){return ty},geoDistance:function(){return Yp},geoEqualEarth:function(){return Gg},geoEqualEarthRaw:function(){return Wg},geoEquirectangular:function(){return Ug},geoEquirectangularRaw:function(){return Lg},geoGnomonic:function(){return Zg},geoGnomonicRaw:function(){return Qg},geoGraticule:function(){return ry},geoGraticule10:function(){return iy},geoIdentity:function(){return Kg},geoInterpolate:function(){return oy},geoLength:function(){return Fp},geoMercator:function(){return Rg},geoMercatorRaw:function(){return Ig},geoNaturalEarth1:function(){return tv},geoNaturalEarth1Raw:function(){return Jg},geoOrthographic:function(){return ev},geoOrthographicRaw:function(){return nv},geoPath:function(){return ug},geoProjection:function(){return xg},geoProjectionMutator:function(){return _g},geoRotation:function(){return pp},geoStereographic:function(){return iv},geoStereographicRaw:function(){return rv},geoStream:function(){return qh},geoTransform:function(){return cg},geoTransverseMercator:function(){return av},geoTransverseMercatorRaw:function(){return ov},gray:function(){return mc},greatest:function(){return Yn},greatestIndex:function(){return Wn},group:function(){return bt},groupSort:function(){return jt},groups:function(){return xt},hcl:function(){return Ec},hierarchy:function(){return mv},histogram:function(){return Kt},hsl:function(){return to},html:function(){return bl},image:function(){return pl},index:function(){return Tt},indexes:function(){return Et},interpolate:function(){return Co},interpolateArray:function(){return mo},interpolateBasis:function(){return io},interpolateBasisClosed:function(){return oo},interpolateBlues:function(){return LS},interpolateBrBG:function(){return ZA},interpolateBuGn:function(){return yS},interpolateBuPu:function(){return vS},interpolateCividis:function(){return QS},interpolateCool:function(){return JS},interpolateCubehelix:function(){return Nm},interpolateCubehelixDefault:function(){return ZS},interpolateCubehelixLong:function(){return Om},interpolateDate:function(){return xo},interpolateDiscrete:function(){return vm},interpolateGnBu:function(){return bS},interpolateGreens:function(){return BS},interpolateGreys:function(){return qS},interpolateHcl:function(){return Em},interpolateHclLong:function(){return Cm},interpolateHsl:function(){return Am},interpolateHslLong:function(){return Sm},interpolateHue:function(){return mm},interpolateInferno:function(){return fM},interpolateLab:function(){return Mm},interpolateMagma:function(){return sM},interpolateNumber:function(){return _o},interpolateNumberArray:function(){return go},interpolateObject:function(){return Ao},interpolateOrRd:function(){return _S},interpolateOranges:function(){return GS},interpolatePRGn:function(){return JA},interpolatePiYG:function(){return nS},interpolatePlasma:function(){return lM},interpolatePuBu:function(){return MS},interpolatePuBuGn:function(){return AS},interpolatePuOr:function(){return rS},interpolatePuRd:function(){return ES},interpolatePurples:function(){return YS},interpolateRainbow:function(){return nM},interpolateRdBu:function(){return oS},interpolateRdGy:function(){return uS},interpolateRdPu:function(){return kS},interpolateRdYlBu:function(){return sS},interpolateRdYlGn:function(){return lS},interpolateReds:function(){return $S},interpolateRgb:function(){return lo},interpolateRgbBasis:function(){return po},interpolateRgbBasisClosed:function(){return yo},interpolateRound:function(){return bm},interpolateSinebow:function(){return oM},interpolateSpectral:function(){return dS},interpolateString:function(){return To},interpolateTransformCss:function(){return sa},interpolateTransformSvg:function(){return fa},interpolateTurbo:function(){return aM},interpolateViridis:function(){return cM},interpolateWarm:function(){return KS},interpolateYlGn:function(){return IS},interpolateYlGnBu:function(){return OS},interpolateYlOrBr:function(){return zS},interpolateYlOrRd:function(){return DS},interpolateZoom:function(){return _m},interrupt:function(){return ra},intersection:function(){return Me},interval:function(){return XE},isoFormat:function(){return HE},isoParse:function(){return YE},json:function(){return gl},lab:function(){return bc},lch:function(){return Tc},least:function(){return Ln},leastIndex:function(){return Fn},line:function(){return $M},lineRadial:function(){return eT},linkHorizontal:function(){return lT},linkRadial:function(){return dT},linkVertical:function(){return hT},local:function(){return pM},map:function(){return de},matcher:function(){return rr},max:function(){return nn},maxIndex:function(){return pn},mean:function(){return vn},median:function(){return mn},merge:function(){return An},min:function(){return on},minIndex:function(){return Tn},mode:function(){return On},namespace:function(){return wr},namespaces:function(){return _r},nice:function(){return Wt},now:function(){return Fo},pack:function(){return Hv},packEnclose:function(){return Mv},packSiblings:function(){return jv},pairs:function(){return Rn},partition:function(){return Qv},path:function(){return Zu},permute:function(){return Nt},pie:function(){return ZM},piecewise:function(){return Pm},pointRadial:function(){return iT},pointer:function(){return No},pointers:function(){return gM},polygonArea:function(){return Rm},polygonCentroid:function(){return zm},polygonContains:function(){return Um},polygonHull:function(){return Lm},polygonLength:function(){return Bm},precisionFixed:function(){return fh},precisionPrefix:function(){return lh},precisionRound:function(){return hh},quadtree:function(){return Tl},quantile:function(){return cn},quantileSorted:function(){return sn},quantize:function(){return Im},quickselect:function(){return an},radialArea:function(){return rT},radialLine:function(){return eT},randomBates:function(){return Wm},randomBernoulli:function(){return Zm},randomBeta:function(){return tb},randomBinomial:function(){return nb},randomCauchy:function(){return rb},randomExponential:function(){return Gm},randomGamma:function(){return Jm},randomGeometric:function(){return Km},randomInt:function(){return Hm},randomIrwinHall:function(){return $m},randomLcg:function(){return sb},randomLogNormal:function(){return Xm},randomLogistic:function(){return ib},randomNormal:function(){return Ym},randomPareto:function(){return Qm},randomPoisson:function(){return ob},randomUniform:function(){return qm},randomWeibull:function(){return eb},range:function(){return Vn},reduce:function(){return pe},reverse:function(){return ye},rgb:function(){return $i},ribbon:function(){return cc},ribbonArrow:function(){return sc},rollup:function(){return St},rollups:function(){return Mt},scaleBand:function(){return mb},scaleDiverging:function(){return IA},scaleDivergingLog:function(){return RA},scaleDivergingPow:function(){return VA},scaleDivergingSqrt:function(){return DA},scaleDivergingSymlog:function(){return zA},scaleIdentity:function(){return Ib},scaleImplicit:function(){return pb},scaleLinear:function(){return Pb},scaleLog:function(){return Fb},scaleOrdinal:function(){return yb},scalePoint:function(){return xb},scalePow:function(){return Zb},scaleQuantile:function(){return ix},scaleQuantize:function(){return ux},scaleRadial:function(){return nx},scaleSequential:function(){return wA},scaleSequentialLog:function(){return AA},scaleSequentialPow:function(){return MA},scaleSequentialQuantile:function(){return kA},scaleSequentialSqrt:function(){return TA},scaleSequentialSymlog:function(){return SA},scaleSqrt:function(){return Kb},scaleSymlog:function(){return Xb},scaleThreshold:function(){return cx},scaleTime:function(){return gA},scaleUtc:function(){return vA},scan:function(){return Gn},schemeAccent:function(){return UA},schemeBlues:function(){return jS},schemeBrBG:function(){return QA},schemeBuGn:function(){return pS},schemeBuPu:function(){return gS},schemeCategory10:function(){return LA},schemeDark2:function(){return BA},schemeGnBu:function(){return mS},schemeGreens:function(){return US},schemeGreys:function(){return FS},schemeOrRd:function(){return xS},schemeOranges:function(){return WS},schemePRGn:function(){return KA},schemePaired:function(){return FA},schemePastel1:function(){return qA},schemePastel2:function(){return HA},schemePiYG:function(){return tS},schemePuBu:function(){return SS},schemePuBuGn:function(){return wS},schemePuOr:function(){return eS},schemePuRd:function(){return TS},schemePurples:function(){return HS},schemeRdBu:function(){return iS},schemeRdGy:function(){return aS},schemeRdPu:function(){return CS},schemeRdYlBu:function(){return cS},schemeRdYlGn:function(){return fS},schemeReds:function(){return XS},schemeSet1:function(){return YA},schemeSet2:function(){return XA},schemeSet3:function(){return $A},schemeSpectral:function(){return hS},schemeTableau10:function(){return WA},schemeYlGn:function(){return PS},schemeYlGnBu:function(){return NS},schemeYlOrBr:function(){return RS},schemeYlOrRd:function(){return VS},select:function(){return mi},selectAll:function(){return vM},selection:function(){return vi},selector:function(){return Je},selectorAll:function(){return er},shuffle:function(){return Qn},shuffler:function(){return Zn},some:function(){return se},sort:function(){return zt},stack:function(){return OE},stackOffsetDiverging:function(){return IE},stackOffsetExpand:function(){return PE},stackOffsetNone:function(){return ME},stackOffsetSilhouette:function(){return RE},stackOffsetWiggle:function(){return zE},stackOrderAppearance:function(){return VE},stackOrderAscending:function(){return jE},stackOrderDescending:function(){return UE},stackOrderInsideOut:function(){return BE},stackOrderNone:function(){return TE},stackOrderReverse:function(){return FE},stratify:function(){return nm},style:function(){return Ir},subset:function(){return ke},sum:function(){return te},superset:function(){return Ce},svg:function(){return xl},symbol:function(){return PT},symbolCircle:function(){return pT},symbolCross:function(){return yT},symbolDiamond:function(){return mT},symbolSquare:function(){return AT},symbolStar:function(){return wT},symbolTriangle:function(){return MT},symbolWye:function(){return NT},symbols:function(){return OT},text:function(){return sl},thresholdFreedmanDiaconis:function(){return fn},thresholdScott:function(){return ln},thresholdSturges:function(){return Gt},tickFormat:function(){return Nb},tickIncrement:function(){return Xt},tickStep:function(){return $t},ticks:function(){return Yt},timeDay:function(){return Px},timeDays:function(){return Ix},timeFormat:function(){return Y_},timeFormatDefaultLocale:function(){return hA},timeFormatLocale:function(){return q_},timeFriday:function(){return Ux},timeFridays:function(){return $x},timeHour:function(){return kx},timeHours:function(){return Nx},timeInterval:function(){return mx},timeMillisecond:function(){return xx},timeMilliseconds:function(){return _x},timeMinute:function(){return Tx},timeMinutes:function(){return Ex},timeMonday:function(){return Vx},timeMondays:function(){return qx},timeMonth:function(){return Qx},timeMonths:function(){return Zx},timeParse:function(){return X_},timeSaturday:function(){return Bx},timeSaturdays:function(){return Wx},timeSecond:function(){return Ax},timeSeconds:function(){return Sx},timeSunday:function(){return zx},timeSundays:function(){return Fx},timeThursday:function(){return Lx},timeThursdays:function(){return Xx},timeTickInterval:function(){return L_},timeTicks:function(){return j_},timeTuesday:function(){return Dx},timeTuesdays:function(){return Hx},timeWednesday:function(){return jx},timeWednesdays:function(){return Yx},timeWeek:function(){return zx},timeWeeks:function(){return Fx},timeYear:function(){return Jx},timeYears:function(){return t_},timeout:function(){return Qo},timer:function(){return Yo},timerFlush:function(){return Xo},transition:function(){return La},transpose:function(){return ne},tree:function(){return cm},treemap:function(){return dm},treemapBinary:function(){return pm},treemapDice:function(){return Gv},treemapResquarify:function(){return gm},treemapSlice:function(){return sm},treemapSliceDice:function(){return ym},treemapSquarify:function(){return hm},tsv:function(){return dl},tsvFormat:function(){return bf},tsvFormatBody:function(){return xf},tsvFormatRow:function(){return wf},tsvFormatRows:function(){return _f},tsvFormatValue:function(){return Af},tsvParse:function(){return vf},tsvParseRows:function(){return mf},union:function(){return Pe},utcDay:function(){return c_},utcDays:function(){return s_},utcFormat:function(){return $_},utcFriday:function(){return g_},utcFridays:function(){return A_},utcHour:function(){return o_},utcHours:function(){return a_},utcMillisecond:function(){return xx},utcMilliseconds:function(){return _x},utcMinute:function(){return e_},utcMinutes:function(){return r_},utcMonday:function(){return h_},utcMondays:function(){return b_},utcMonth:function(){return T_},utcMonths:function(){return E_},utcParse:function(){return W_},utcSaturday:function(){return v_},utcSaturdays:function(){return S_},utcSecond:function(){return Ax},utcSeconds:function(){return Sx},utcSunday:function(){return l_},utcSundays:function(){return m_},utcThursday:function(){return y_},utcThursdays:function(){return w_},utcTickInterval:function(){return V_},utcTicks:function(){return z_},utcTuesday:function(){return d_},utcTuesdays:function(){return x_},utcWednesday:function(){return p_},utcWednesdays:function(){return __},utcWeek:function(){return l_},utcWeeks:function(){return m_},utcYear:function(){return k_},utcYears:function(){return N_},variance:function(){return O},window:function(){return kr},xml:function(){return ml},zip:function(){return re},zoom:function(){return aC},zoomIdentity:function(){return QE},zoomTransform:function(){return ZE}});var o=e(7945),a=o.mark(f);function u(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return c(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return c(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function c(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function s(t){return null===t?NaN:+t}function f(t,n){var e,r,i,c,s,f,l;return o.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(void 0!==n){o.next=21;break}e=u(t),o.prev=2,e.s();case 4:if((r=e.n()).done){o.next=11;break}if(!(null!=(i=r.value)&&(i=+i)>=i)){o.next=9;break}return o.next=9,i;case 9:o.next=4;break;case 11:o.next=16;break;case 13:o.prev=13,o.t0=o.catch(2),e.e(o.t0);case 16:return o.prev=16,e.f(),o.finish(16);case 19:o.next=40;break;case 21:c=-1,s=u(t),o.prev=23,s.s();case 25:if((f=s.n()).done){o.next=32;break}if(l=f.value,!(null!=(l=n(l,++c,t))&&(l=+l)>=l)){o.next=30;break}return o.next=30,l;case 30:o.next=25;break;case 32:o.next=37;break;case 34:o.prev=34,o.t1=o.catch(23),s.e(o.t1);case 37:return o.prev=37,s.f(),o.finish(37);case 40:case"end":return o.stop()}}),a,null,[[2,13,16,19],[23,34,37,40]])}var l=i(r),h=l.right,d=l.left,p=i(s).center,y=h;function g(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return v(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return v(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function v(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function m(t,n){var e=0;if(void 0===n){var r,i=g(t);try{for(i.s();!(r=i.n()).done;){var o=r.value;null!=o&&(o=+o)>=o&&++e}}catch(t){i.e(t)}finally{i.f()}}else{var a,u=-1,c=g(t);try{for(c.s();!(a=c.n()).done;){var s=a.value;null!=(s=n(s,++u,t))&&(s=+s)>=s&&++e}}catch(t){c.e(t)}finally{c.f()}}return e}function b(t){return function(t){if(Array.isArray(t))return x(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,n){if(!t)return;if("string"==typeof t)return x(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return x(t,n)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function _(t){return(_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function w(t){return 0|t.length}function A(t){return!(t>0)}function S(t){return"object"!==_(t)||"length"in t?t:Array.from(t)}function M(t){return function(n){return t.apply(void 0,b(n))}}function T(){for(var t=arguments.length,n=new Array(t),e=0;e<t;e++)n[e]=arguments[e];var r="function"==typeof n[n.length-1]&&M(n.pop()),i=(n=n.map(S)).map(w),o=n.length-1,a=new Array(o+1).fill(0),u=[];if(o<0||i.some(A))return u;for(;;){u.push(a.map((function(t,e){return n[e][t]})));for(var c=o;++a[c]===i[c];){if(0===c)return r?u.map(r):u;a[c--]=0}}}function E(t,n){var e=0,r=0;return Float64Array.from(t,void 0===n?function(t){return e+=+t||0}:function(i){return e+=+n(i,r++,t)||0})}function C(t,n){return null==t||null==n?NaN:n<t?-1:n>t?1:n>=t?0:NaN}function k(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return N(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return N(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function N(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function O(t,n){var e,r=0,i=0,o=0;if(void 0===n){var a,u=k(t);try{for(u.s();!(a=u.n()).done;){var c=a.value;null!=c&&(c=+c)>=c&&(o+=(e=c-i)*(c-(i+=e/++r)))}}catch(t){u.e(t)}finally{u.f()}}else{var s,f=-1,l=k(t);try{for(l.s();!(s=l.n()).done;){var h=s.value;null!=(h=n(h,++f,t))&&(h=+h)>=h&&(o+=(e=h-i)*(h-(i+=e/++r)))}}catch(t){l.e(t)}finally{l.f()}}if(r>1)return o/(r-1)}function P(t,n){var e=O(t,n);return e?Math.sqrt(e):e}function I(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return R(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return R(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function R(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function z(t,n){var e,r;if(void 0===n){var i,o=I(t);try{for(o.s();!(i=o.n()).done;){var a=i.value;null!=a&&(void 0===e?a>=a&&(e=r=a):(e>a&&(e=a),r<a&&(r=a)))}}catch(t){o.e(t)}finally{o.f()}}else{var u,c=-1,s=I(t);try{for(s.s();!(u=s.n()).done;){var f=u.value;null!=(f=n(f,++c,t))&&(void 0===e?f>=f&&(e=r=f):(e>f&&(e=f),r<f&&(r=f)))}}catch(t){s.e(t)}finally{s.f()}}return[e,r]}function V(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return D(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return D(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function D(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function j(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var L=function(){function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this._partials=new Float64Array(32),this._n=0}var n,e,r;return n=t,(e=[{key:"add",value:function(t){for(var n=this._partials,e=0,r=0;r<this._n&&r<32;r++){var i=n[r],o=t+i,a=Math.abs(t)<Math.abs(i)?t-(o-i):i-(o-t);a&&(n[e++]=a),t=o}return n[e]=t,this._n=e+1,this}},{key:"valueOf",value:function(){var t,n,e,r=this._partials,i=this._n,o=0;if(i>0){for(o=r[--i];i>0&&(t=o,!(e=(n=r[--i])-((o=t+n)-t))););i>0&&(e<0&&r[i-1]<0||e>0&&r[i-1]>0)&&(n=2*e)==(t=o+n)-o&&(o=t)}return o}}])&&j(n.prototype,e),r&&j(n,r),Object.defineProperty(n,"prototype",{writable:!1}),t}();function U(t,n){var e=new L;if(void 0===n){var r,i=V(t);try{for(i.s();!(r=i.n()).done;){var o=r.value;(o=+o)&&e.add(o)}}catch(t){i.e(t)}finally{i.f()}}else{var a,u=-1,c=V(t);try{for(c.s();!(a=c.n()).done;){var s=a.value;(s=+n(s,++u,t))&&e.add(s)}}catch(t){c.e(t)}finally{c.f()}}return+e}function B(t,n){var e=new L,r=-1;return Float64Array.from(t,void 0===n?function(t){return e.add(+t||0)}:function(i){return e.add(+n(i,++r,t)||0)})}function F(t){return(F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function q(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==e)return;var r,i,o=[],a=!0,u=!1;try{for(e=e.call(t);!(a=(r=e.next()).done)&&(o.push(r.value),!n||o.length!==n);a=!0);}catch(t){u=!0,i=t}finally{try{a||null==e.return||e.return()}finally{if(u)throw i}}return o}(t,n)||Y(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function H(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=Y(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function Y(t,n){if(t){if("string"==typeof t)return X(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?X(t,n):void 0}}function X(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function $(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function W(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function G(t,n,e){return n&&W(t.prototype,n),e&&W(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Q(){return(Q="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,n,e){var r=Z(t,n);if(r){var i=Object.getOwnPropertyDescriptor(r,n);return i.get?i.get.call(arguments.length<3?t:e):i.value}}).apply(this,arguments)}function Z(t,n){for(;!Object.prototype.hasOwnProperty.call(t,n)&&null!==(t=at(t)););return t}function K(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),n&&ot(t,n)}function J(t){var n=it();return function(){var e,r=at(t);if(n){var i=at(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return tt(this,e)}}function tt(t,n){if(n&&("object"===F(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return nt(t)}function nt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function et(t){var n="function"==typeof Map?new Map:void 0;return(et=function(t){if(null===t||(e=t,-1===Function.toString.call(e).indexOf("[native code]")))return t;var e;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(t))return n.get(t);n.set(t,r)}function r(){return rt(t,arguments,at(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),ot(r,t)})(t)}function rt(t,n,e){return(rt=it()?Reflect.construct:function(t,n,e){var r=[null];r.push.apply(r,n);var i=new(Function.bind.apply(t,r));return e&&ot(i,e.prototype),i}).apply(null,arguments)}function it(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function ot(t,n){return(ot=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}function at(t){return(at=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var ut=function(t){K(e,t);var n=J(e);function e(t){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ht;if($(this,e),r=n.call(this),Object.defineProperties(nt(r),{_intern:{value:new Map},_key:{value:i}}),null!=t){var o,a=H(t);try{for(a.s();!(o=a.n()).done;){var u=q(o.value,2),c=u[0],s=u[1];r.set(c,s)}}catch(t){a.e(t)}finally{a.f()}}return r}return G(e,[{key:"get",value:function(t){return Q(at(e.prototype),"get",this).call(this,st(this,t))}},{key:"has",value:function(t){return Q(at(e.prototype),"has",this).call(this,st(this,t))}},{key:"set",value:function(t,n){return Q(at(e.prototype),"set",this).call(this,ft(this,t),n)}},{key:"delete",value:function(t){return Q(at(e.prototype),"delete",this).call(this,lt(this,t))}}]),e}(et(Map)),ct=function(t){K(e,t);var n=J(e);function e(t){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ht;if($(this,e),r=n.call(this),Object.defineProperties(nt(r),{_intern:{value:new Map},_key:{value:i}}),null!=t){var o,a=H(t);try{for(a.s();!(o=a.n()).done;){var u=o.value;r.add(u)}}catch(t){a.e(t)}finally{a.f()}}return r}return G(e,[{key:"has",value:function(t){return Q(at(e.prototype),"has",this).call(this,st(this,t))}},{key:"add",value:function(t){return Q(at(e.prototype),"add",this).call(this,ft(this,t))}},{key:"delete",value:function(t){return Q(at(e.prototype),"delete",this).call(this,lt(this,t))}}]),e}(et(Set));function st(t,n){var e=t._intern,r=(0,t._key)(n);return e.has(r)?e.get(r):n}function ft(t,n){var e=t._intern,r=(0,t._key)(n);return e.has(r)?e.get(r):(e.set(r,n),n)}function lt(t,n){var e=t._intern,r=(0,t._key)(n);return e.has(r)&&(n=e.get(n),e.delete(r)),n}function ht(t){return null!==t&&"object"===F(t)?t.valueOf():t}function dt(t){return t}function pt(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=vt(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function yt(t){return function(t){if(Array.isArray(t))return mt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||vt(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function gt(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==e)return;var r,i,o=[],a=!0,u=!1;try{for(e=e.call(t);!(a=(r=e.next()).done)&&(o.push(r.value),!n||o.length!==n);a=!0);}catch(t){u=!0,i=t}finally{try{a||null==e.return||e.return()}finally{if(u)throw i}}return o}(t,n)||vt(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function vt(t,n){if(t){if("string"==typeof t)return mt(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?mt(t,n):void 0}}function mt(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function bt(t){for(var n=arguments.length,e=new Array(n>1?n-1:0),r=1;r<n;r++)e[r-1]=arguments[r];return kt(t,dt,dt,e)}function xt(t){for(var n=arguments.length,e=new Array(n>1?n-1:0),r=1;r<n;r++)e[r-1]=arguments[r];return kt(t,Array.from,dt,e)}function _t(t,n){for(var e=1,r=n.length;e<r;++e)t=t.flatMap((function(t){return t.pop().map((function(n){var e=gt(n,2),r=e[0],i=e[1];return[].concat(yt(t),[r,i])}))}));return t}function wt(t){for(var n=arguments.length,e=new Array(n>1?n-1:0),r=1;r<n;r++)e[r-1]=arguments[r];return _t(xt.apply(void 0,[t].concat(e)),e)}function At(t,n){for(var e=arguments.length,r=new Array(e>2?e-2:0),i=2;i<e;i++)r[i-2]=arguments[i];return _t(Mt.apply(void 0,[t,n].concat(r)),r)}function St(t,n){for(var e=arguments.length,r=new Array(e>2?e-2:0),i=2;i<e;i++)r[i-2]=arguments[i];return kt(t,dt,n,r)}function Mt(t,n){for(var e=arguments.length,r=new Array(e>2?e-2:0),i=2;i<e;i++)r[i-2]=arguments[i];return kt(t,Array.from,n,r)}function Tt(t){for(var n=arguments.length,e=new Array(n>1?n-1:0),r=1;r<n;r++)e[r-1]=arguments[r];return kt(t,dt,Ct,e)}function Et(t){for(var n=arguments.length,e=new Array(n>1?n-1:0),r=1;r<n;r++)e[r-1]=arguments[r];return kt(t,Array.from,Ct,e)}function Ct(t){if(1!==t.length)throw new Error("duplicate key");return t[0]}function kt(t,n,e,r){return function t(i,o){if(o>=r.length)return e(i);var a,u=new ut,c=r[o++],s=-1,f=pt(i);try{for(f.s();!(a=f.n()).done;){var l=a.value,h=c(l,++s,i),d=u.get(h);d?d.push(l):u.set(h,[l])}}catch(t){f.e(t)}finally{f.f()}var p,y=pt(u);try{for(y.s();!(p=y.n()).done;){var g=gt(p.value,2),v=g[0],m=g[1];u.set(v,t(m,o))}}catch(t){y.e(t)}finally{y.f()}return n(u)}(t,0)}function Nt(t,n){return Array.from(n,(function(n){return t[n]}))}function Ot(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=It(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function Pt(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==e)return;var r,i,o=[],a=!0,u=!1;try{for(e=e.call(t);!(a=(r=e.next()).done)&&(o.push(r.value),!n||o.length!==n);a=!0);}catch(t){u=!0,i=t}finally{try{a||null==e.return||e.return()}finally{if(u)throw i}}return o}(t,n)||It(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function It(t,n){if(t){if("string"==typeof t)return Rt(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?Rt(t,n):void 0}}function Rt(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function zt(t){for(var n=arguments.length,e=new Array(n>1?n-1:0),i=1;i<n;i++)e[i-1]=arguments[i];if("function"!=typeof t[Symbol.iterator])throw new TypeError("values is not iterable");t=Array.from(t);var o=e,a=Pt(o,1),u=a[0],c=void 0===u?r:u;if(1===c.length||e.length>1){var s=Uint32Array.from(t,(function(t,n){return n}));return e.length>1?(e=e.map((function(n){return t.map(n)})),s.sort((function(t,n){var i,o=Ot(e);try{for(o.s();!(i=o.n()).done;){var a=i.value,u=r(a[t],a[n]);if(u)return u}}catch(t){o.e(t)}finally{o.f()}}))):(c=t.map(c),s.sort((function(t,n){return r(c[t],c[n])}))),Nt(t,s)}return t.sort(c)}function Vt(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==e)return;var r,i,o=[],a=!0,u=!1;try{for(e=e.call(t);!(a=(r=e.next()).done)&&(o.push(r.value),!n||o.length!==n);a=!0);}catch(t){u=!0,i=t}finally{try{a||null==e.return||e.return()}finally{if(u)throw i}}return o}(t,n)||function(t,n){if(!t)return;if("string"==typeof t)return Dt(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Dt(t,n)}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Dt(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function jt(t,n,e){return(1===n.length?zt(St(t,n,e),(function(t,n){var e=Vt(t,2),i=e[0],o=e[1],a=Vt(n,2),u=a[0];return r(o,a[1])||r(i,u)})):zt(bt(t,e),(function(t,e){var i=Vt(t,2),o=i[0],a=i[1],u=Vt(e,2),c=u[0],s=u[1];return n(a,s)||r(o,c)}))).map((function(t){return Vt(t,1)[0]}))}var Lt=Array.prototype,Ut=Lt.slice;Lt.map;function Bt(t){return function(){return t}}var Ft=Math.sqrt(50),qt=Math.sqrt(10),Ht=Math.sqrt(2);function Yt(t,n,e){var r,i,o,a,u=-1;if(e=+e,(t=+t)===(n=+n)&&e>0)return[t];if((r=n<t)&&(i=t,t=n,n=i),0===(a=Xt(t,n,e))||!isFinite(a))return[];if(a>0){var c=Math.round(t/a),s=Math.round(n/a);for(c*a<t&&++c,s*a>n&&--s,o=new Array(i=s-c+1);++u<i;)o[u]=(c+u)*a}else{a=-a;var f=Math.round(t*a),l=Math.round(n*a);for(f/a<t&&++f,l/a>n&&--l,o=new Array(i=l-f+1);++u<i;)o[u]=(f+u)/a}return r&&o.reverse(),o}function Xt(t,n,e){var r=(n-t)/Math.max(0,e),i=Math.floor(Math.log(r)/Math.LN10),o=r/Math.pow(10,i);return i>=0?(o>=Ft?10:o>=qt?5:o>=Ht?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(o>=Ft?10:o>=qt?5:o>=Ht?2:1)}function $t(t,n,e){var r=Math.abs(n-t)/Math.max(0,e),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),o=r/i;return o>=Ft?i*=10:o>=qt?i*=5:o>=Ht&&(i*=2),n<t?-i:i}function Wt(t,n,e){for(var r;;){var i=Xt(t,n,e);if(i===r||0===i||!isFinite(i))return[t,n];i>0?(t=Math.floor(t/i)*i,n=Math.ceil(n/i)*i):i<0&&(t=Math.ceil(t*i)/i,n=Math.floor(n*i)/i),r=i}}function Gt(t){return Math.ceil(Math.log(m(t))/Math.LN2)+1}function Qt(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==e)return;var r,i,o=[],a=!0,u=!1;try{for(e=e.call(t);!(a=(r=e.next()).done)&&(o.push(r.value),!n||o.length!==n);a=!0);}catch(t){u=!0,i=t}finally{try{a||null==e.return||e.return()}finally{if(u)throw i}}return o}(t,n)||function(t,n){if(!t)return;if("string"==typeof t)return Zt(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Zt(t,n)}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Zt(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function Kt(){var t=dt,n=z,e=Gt;function r(r){Array.isArray(r)||(r=Array.from(r));var i,o,a=r.length,u=new Array(a);for(i=0;i<a;++i)u[i]=t(r[i],i,r);var c=n(u),s=c[0],f=c[1],l=e(u,s,f);if(!Array.isArray(l)){var h=f,d=+l;if(n===z){var p=Qt(Wt(s,f,d),2);s=p[0],f=p[1]}if((l=Yt(s,f,d))[l.length-1]>=f)if(h>=f&&n===z){var g=Xt(s,f,d);isFinite(g)&&(g>0?f=(Math.floor(f/g)+1)*g:g<0&&(f=(Math.ceil(f*-g)+1)/-g))}else l.pop()}for(var v=l.length;l[0]<=s;)l.shift(),--v;for(;l[v-1]>f;)l.pop(),--v;var m,b=new Array(v+1);for(i=0;i<=v;++i)(m=b[i]=[]).x0=i>0?l[i-1]:s,m.x1=i<v?l[i]:f;for(i=0;i<a;++i)null!=(o=u[i])&&s<=o&&o<=f&&b[y(l,o,0,v)].push(r[i]);return b}return r.value=function(n){return arguments.length?(t="function"==typeof n?n:Bt(n),r):t},r.domain=function(t){return arguments.length?(n="function"==typeof t?t:Bt([t[0],t[1]]),r):n},r.thresholds=function(t){return arguments.length?(e="function"==typeof t?t:Array.isArray(t)?Bt(Ut.call(t)):Bt(t),r):e},r}function Jt(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return tn(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return tn(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function tn(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function nn(t,n){var e;if(void 0===n){var r,i=Jt(t);try{for(i.s();!(r=i.n()).done;){var o=r.value;null!=o&&(e<o||void 0===e&&o>=o)&&(e=o)}}catch(t){i.e(t)}finally{i.f()}}else{var a,u=-1,c=Jt(t);try{for(c.s();!(a=c.n()).done;){var s=a.value;null!=(s=n(s,++u,t))&&(e<s||void 0===e&&s>=s)&&(e=s)}}catch(t){c.e(t)}finally{c.f()}}return e}function en(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return rn(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return rn(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function rn(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function on(t,n){var e;if(void 0===n){var r,i=en(t);try{for(i.s();!(r=i.n()).done;){var o=r.value;null!=o&&(e>o||void 0===e&&o>=o)&&(e=o)}}catch(t){i.e(t)}finally{i.f()}}else{var a,u=-1,c=en(t);try{for(c.s();!(a=c.n()).done;){var s=a.value;null!=(s=n(s,++u,t))&&(e>s||void 0===e&&s>=s)&&(e=s)}}catch(t){c.e(t)}finally{c.f()}}return e}function an(t,n){for(var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length-1,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:r;i>e;){if(i-e>600){var a=i-e+1,u=n-e+1,c=Math.log(a),s=.5*Math.exp(2*c/3),f=.5*Math.sqrt(c*s*(a-s)/a)*(u-a/2<0?-1:1),l=Math.max(e,Math.floor(n-u*s/a+f)),h=Math.min(i,Math.floor(n+(a-u)*s/a+f));an(t,n,l,h,o)}var d=t[n],p=e,y=i;for(un(t,e,n),o(t[i],d)>0&&un(t,e,i);p<y;){for(un(t,p,y),++p,--y;o(t[p],d)<0;)++p;for(;o(t[y],d)>0;)--y}0===o(t[e],d)?un(t,e,y):un(t,++y,i),y<=n&&(e=y+1),n<=y&&(i=y-1)}return t}function un(t,n,e){var r=t[n];t[n]=t[e],t[e]=r}function cn(t,n,e){if(r=(t=Float64Array.from(f(t,e))).length){if((n=+n)<=0||r<2)return on(t);if(n>=1)return nn(t);var r,i=(r-1)*n,o=Math.floor(i),a=nn(an(t,o).subarray(0,o+1));return a+(on(t.subarray(o+1))-a)*(i-o)}}function sn(t,n){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:s;if(r=t.length){if((n=+n)<=0||r<2)return+e(t[0],0,t);if(n>=1)return+e(t[r-1],r-1,t);var r,i=(r-1)*n,o=Math.floor(i),a=+e(t[o],o,t),u=+e(t[o+1],o+1,t);return a+(u-a)*(i-o)}}function fn(t,n,e){return Math.ceil((e-n)/(2*(cn(t,.75)-cn(t,.25))*Math.pow(m(t),-1/3)))}function ln(t,n,e){return Math.ceil((e-n)/(3.5*P(t)*Math.pow(m(t),-1/3)))}function hn(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return dn(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return dn(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function dn(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function pn(t,n){var e,r=-1,i=-1;if(void 0===n){var o,a=hn(t);try{for(a.s();!(o=a.n()).done;){var u=o.value;++i,null!=u&&(e<u||void 0===e&&u>=u)&&(e=u,r=i)}}catch(t){a.e(t)}finally{a.f()}}else{var c,s=hn(t);try{for(s.s();!(c=s.n()).done;){var f=c.value;null!=(f=n(f,++i,t))&&(e<f||void 0===e&&f>=f)&&(e=f,r=i)}}catch(t){s.e(t)}finally{s.f()}}return r}function yn(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return gn(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return gn(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function gn(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function vn(t,n){var e=0,r=0;if(void 0===n){var i,o=yn(t);try{for(o.s();!(i=o.n()).done;){var a=i.value;null!=a&&(a=+a)>=a&&(++e,r+=a)}}catch(t){o.e(t)}finally{o.f()}}else{var u,c=-1,s=yn(t);try{for(s.s();!(u=s.n()).done;){var f=u.value;null!=(f=n(f,++c,t))&&(f=+f)>=f&&(++e,r+=f)}}catch(t){s.e(t)}finally{s.f()}}if(e)return r/e}function mn(t,n){return cn(t,.5,n)}var bn=o.mark(wn);function xn(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return _n(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return _n(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function _n(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function wn(t){var n,e,r;return o.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:n=xn(t),i.prev=1,n.s();case 3:if((e=n.n()).done){i.next=8;break}return r=e.value,i.delegateYield(r,"t0",6);case 6:i.next=3;break;case 8:i.next=13;break;case 10:i.prev=10,i.t1=i.catch(1),n.e(i.t1);case 13:return i.prev=13,n.f(),i.finish(13);case 16:case"end":return i.stop()}}),bn,null,[[1,10,13,16]])}function An(t){return Array.from(wn(t))}function Sn(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return Mn(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Mn(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function Mn(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function Tn(t,n){var e,r=-1,i=-1;if(void 0===n){var o,a=Sn(t);try{for(a.s();!(o=a.n()).done;){var u=o.value;++i,null!=u&&(e>u||void 0===e&&u>=u)&&(e=u,r=i)}}catch(t){a.e(t)}finally{a.f()}}else{var c,s=Sn(t);try{for(s.s();!(c=s.n()).done;){var f=c.value;null!=(f=n(f,++i,t))&&(e>f||void 0===e&&f>=f)&&(e=f,r=i)}}catch(t){s.e(t)}finally{s.f()}}return r}function En(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==e)return;var r,i,o=[],a=!0,u=!1;try{for(e=e.call(t);!(a=(r=e.next()).done)&&(o.push(r.value),!n||o.length!==n);a=!0);}catch(t){u=!0,i=t}finally{try{a||null==e.return||e.return()}finally{if(u)throw i}}return o}(t,n)||kn(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Cn(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=kn(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function kn(t,n){if(t){if("string"==typeof t)return Nn(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?Nn(t,n):void 0}}function Nn(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function On(t,n){var e,r=new ut;if(void 0===n){var i,o=Cn(t);try{for(o.s();!(i=o.n()).done;){var a=i.value;null!=a&&a>=a&&r.set(a,(r.get(a)||0)+1)}}catch(t){o.e(t)}finally{o.f()}}else{var u,c=-1,s=Cn(t);try{for(s.s();!(u=s.n()).done;){var f=u.value;null!=(f=n(f,++c,t))&&f>=f&&r.set(f,(r.get(f)||0)+1)}}catch(t){s.e(t)}finally{s.f()}}var l,h=0,d=Cn(r);try{for(d.s();!(l=d.n()).done;){var p=En(l.value,2),y=p[0],g=p[1];g>h&&(h=g,e=y)}}catch(t){d.e(t)}finally{d.f()}return e}function Pn(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return In(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return In(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function In(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function Rn(t){var n,e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:zn,i=[],o=!1,a=Pn(t);try{for(a.s();!(e=a.n()).done;){var u=e.value;o&&i.push(r(n,u)),n=u,o=!0}}catch(t){a.e(t)}finally{a.f()}return i}function zn(t,n){return[t,n]}function Vn(t,n,e){t=+t,n=+n,e=(i=arguments.length)<2?(n=t,t=0,1):i<3?1:+e;for(var r=-1,i=0|Math.max(0,Math.ceil((n-t)/e)),o=new Array(i);++r<i;)o[r]=t+r*e;return o}function Dn(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return jn(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return jn(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function jn(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function Ln(t){var n,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r,i=!1;if(1===e.length){var o,a,u=Dn(t);try{for(u.s();!(a=u.n()).done;){var c=a.value,s=e(c);(i?r(s,o)<0:0===r(s,s))&&(n=c,o=s,i=!0)}}catch(t){u.e(t)}finally{u.f()}}else{var f,l=Dn(t);try{for(l.s();!(f=l.n()).done;){var h=f.value;(i?e(h,n)<0:0===e(h,h))&&(n=h,i=!0)}}catch(t){l.e(t)}finally{l.f()}}return n}function Un(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return Bn(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Bn(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function Bn(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function Fn(t){var n,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r;if(1===e.length)return Tn(t,e);var i,o=-1,a=-1,u=Un(t);try{for(u.s();!(i=u.n()).done;){var c=i.value;++a,(o<0?0===e(c,c):e(c,n)<0)&&(n=c,o=a)}}catch(t){u.e(t)}finally{u.f()}return o}function qn(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return Hn(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Hn(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function Hn(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function Yn(t){var n,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r,i=!1;if(1===e.length){var o,a,u=qn(t);try{for(u.s();!(a=u.n()).done;){var c=a.value,s=e(c);(i?r(s,o)>0:0===r(s,s))&&(n=c,o=s,i=!0)}}catch(t){u.e(t)}finally{u.f()}}else{var f,l=qn(t);try{for(l.s();!(f=l.n()).done;){var h=f.value;(i?e(h,n)>0:0===e(h,h))&&(n=h,i=!0)}}catch(t){l.e(t)}finally{l.f()}}return n}function Xn(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return $n(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return $n(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function $n(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function Wn(t){var n,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r;if(1===e.length)return pn(t,e);var i,o=-1,a=-1,u=Xn(t);try{for(u.s();!(i=u.n()).done;){var c=i.value;++a,(o<0?0===e(c,c):e(c,n)>0)&&(n=c,o=a)}}catch(t){u.e(t)}finally{u.f()}return o}function Gn(t,n){var e=Fn(t,n);return e<0?void 0:e}var Qn=Zn(Math.random);function Zn(t){return function(n){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n.length,i=r-(e=+e);i;){var o=t()*i--|0,a=n[i+e];n[i+e]=n[o+e],n[o+e]=a}return n}}function Kn(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return Jn(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Jn(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function Jn(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function te(t,n){var e=0;if(void 0===n){var r,i=Kn(t);try{for(i.s();!(r=i.n()).done;){var o=r.value;(o=+o)&&(e+=o)}}catch(t){i.e(t)}finally{i.f()}}else{var a,u=-1,c=Kn(t);try{for(c.s();!(a=c.n()).done;){var s=a.value;(s=+n(s,++u,t))&&(e+=s)}}catch(t){c.e(t)}finally{c.f()}}return e}function ne(t){if(!(i=t.length))return[];for(var n=-1,e=on(t,ee),r=new Array(e);++n<e;)for(var i,o=-1,a=r[n]=new Array(i);++o<i;)a[o]=t[o][n];return r}function ee(t){return t.length}function re(){return ne(arguments)}function ie(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return oe(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return oe(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function oe(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function ae(t,n){if("function"!=typeof n)throw new TypeError("test is not a function");var e,r=-1,i=ie(t);try{for(i.s();!(e=i.n()).done;){if(!n(e.value,++r,t))return!1}}catch(t){i.e(t)}finally{i.f()}return!0}function ue(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return ce(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return ce(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function ce(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function se(t,n){if("function"!=typeof n)throw new TypeError("test is not a function");var e,r=-1,i=ue(t);try{for(i.s();!(e=i.n()).done;){if(n(e.value,++r,t))return!0}}catch(t){i.e(t)}finally{i.f()}return!1}function fe(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return le(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return le(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function le(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function he(t,n){if("function"!=typeof n)throw new TypeError("test is not a function");var e,r=[],i=-1,o=fe(t);try{for(o.s();!(e=o.n()).done;){var a=e.value;n(a,++i,t)&&r.push(a)}}catch(t){o.e(t)}finally{o.f()}return r}function de(t,n){if("function"!=typeof t[Symbol.iterator])throw new TypeError("values is not iterable");if("function"!=typeof n)throw new TypeError("mapper is not a function");return Array.from(t,(function(e,r){return n(e,r,t)}))}function pe(t,n,e){if("function"!=typeof n)throw new TypeError("reducer is not a function");var r,i,o=t[Symbol.iterator](),a=-1;if(arguments.length<3){var u=o.next();if(r=u.done,e=u.value,r)return;++a}for(;r=(c=o.next()).done,i=c.value,!r;){var c;e=n(e,i,++a,t)}return e}function ye(t){if("function"!=typeof t[Symbol.iterator])throw new TypeError("values is not iterable");return Array.from(t).reverse()}function ge(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return ve(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return ve(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function ve(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function me(t){t=new Set(t);for(var n=arguments.length,e=new Array(n>1?n-1:0),r=1;r<n;r++)e[r-1]=arguments[r];for(var i=0,o=e;i<o.length;i++){var a,u=o[i],c=ge(u);try{for(c.s();!(a=c.n()).done;){var s=a.value;t.delete(s)}}catch(t){c.e(t)}finally{c.f()}}return t}function be(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return xe(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return xe(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function xe(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function _e(t,n){var e,r=n[Symbol.iterator](),i=new Set,o=be(t);try{for(o.s();!(e=o.n()).done;){var a=e.value;if(i.has(a))return!1;for(var u=void 0,c=void 0;u=(s=r.next()).value,c=s.done,s;){var s;if(c)break;if(Object.is(a,u))return!1;i.add(u)}}}catch(t){o.e(t)}finally{o.f()}return!0}function we(t){return t instanceof Set?t:new Set(t)}function Ae(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return Se(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Se(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function Se(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function Me(t){for(var n=arguments.length,e=new Array(n>1?n-1:0),r=1;r<n;r++)e[r-1]=arguments[r];t=new Set(t),e=e.map(we);var i,o=Ae(t);try{t:for(o.s();!(i=o.n()).done;){var a,u=i.value,c=Ae(e);try{for(c.s();!(a=c.n()).done;){var s=a.value;if(!s.has(u)){t.delete(u);continue t}}}catch(t){c.e(t)}finally{c.f()}}}catch(t){o.e(t)}finally{o.f()}return t}function Te(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return Ee(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Ee(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function Ee(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function Ce(t,n){var e,r=t[Symbol.iterator](),i=new Set,o=Te(n);try{for(o.s();!(e=o.n()).done;){var a=e.value;if(!i.has(a))for(var u=void 0,c=void 0;u=(s=r.next()).value,c=s.done,s;){var s;if(c)return!1;if(i.add(u),Object.is(a,u))break}}}catch(t){o.e(t)}finally{o.f()}return!0}function ke(t,n){return Ce(n,t)}function Ne(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return Oe(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Oe(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function Oe(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function Pe(){for(var t=new Set,n=arguments.length,e=new Array(n),r=0;r<n;r++)e[r]=arguments[r];for(var i=0,o=e;i<o.length;i++){var a,u=o[i],c=Ne(u);try{for(c.s();!(a=c.n()).done;){var s=a.value;t.add(s)}}catch(t){c.e(t)}finally{c.f()}}return t}function Ie(t){return t}var Re=1e-6;function ze(t){return"translate("+t+",0)"}function Ve(t){return"translate(0,"+t+")"}function De(t){return function(n){return+t(n)}}function je(t,n){return n=Math.max(0,t.bandwidth()-2*n)/2,t.round()&&(n=Math.round(n)),function(e){return+t(e)+n}}function Le(){return!this.__axis}function Ue(t,n){var e=[],r=null,i=null,o=6,a=6,u=3,c="undefined"!=typeof window&&window.devicePixelRatio>1?0:.5,s=1===t||4===t?-1:1,f=4===t||2===t?"x":"y",l=1===t||3===t?ze:Ve;function h(h){var d=null==r?n.ticks?n.ticks.apply(n,e):n.domain():r,p=null==i?n.tickFormat?n.tickFormat.apply(n,e):Ie:i,y=Math.max(o,0)+u,g=n.range(),v=+g[0]+c,m=+g[g.length-1]+c,b=(n.bandwidth?je:De)(n.copy(),c),x=h.selection?h.selection():h,_=x.selectAll(".domain").data([null]),w=x.selectAll(".tick").data(d,n).order(),A=w.exit(),S=w.enter().append("g").attr("class","tick"),M=w.select("line"),T=w.select("text");_=_.merge(_.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),w=w.merge(S),M=M.merge(S.append("line").attr("stroke","currentColor").attr(f+"2",s*o)),T=T.merge(S.append("text").attr("fill","currentColor").attr(f,s*y).attr("dy",1===t?"0em":3===t?"0.71em":"0.32em")),h!==x&&(_=_.transition(h),w=w.transition(h),M=M.transition(h),T=T.transition(h),A=A.transition(h).attr("opacity",Re).attr("transform",(function(t){return isFinite(t=b(t))?l(t+c):this.getAttribute("transform")})),S.attr("opacity",Re).attr("transform",(function(t){var n=this.parentNode.__axis;return l((n&&isFinite(n=n(t))?n:b(t))+c)}))),A.remove(),_.attr("d",4===t||2===t?a?"M"+s*a+","+v+"H"+c+"V"+m+"H"+s*a:"M"+c+","+v+"V"+m:a?"M"+v+","+s*a+"V"+c+"H"+m+"V"+s*a:"M"+v+","+c+"H"+m),w.attr("opacity",1).attr("transform",(function(t){return l(b(t)+c)})),M.attr(f+"2",s*o),T.attr(f,s*y).text(p),x.filter(Le).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",2===t?"start":4===t?"end":"middle"),x.each((function(){this.__axis=b}))}return h.scale=function(t){return arguments.length?(n=t,h):n},h.ticks=function(){return e=Array.from(arguments),h},h.tickArguments=function(t){return arguments.length?(e=null==t?[]:Array.from(t),h):e.slice()},h.tickValues=function(t){return arguments.length?(r=null==t?null:Array.from(t),h):r&&r.slice()},h.tickFormat=function(t){return arguments.length?(i=t,h):i},h.tickSize=function(t){return arguments.length?(o=a=+t,h):o},h.tickSizeInner=function(t){return arguments.length?(o=+t,h):o},h.tickSizeOuter=function(t){return arguments.length?(a=+t,h):a},h.tickPadding=function(t){return arguments.length?(u=+t,h):u},h.offset=function(t){return arguments.length?(c=+t,h):c},h}function Be(t){return Ue(1,t)}function Fe(t){return Ue(2,t)}function qe(t){return Ue(3,t)}function He(t){return Ue(4,t)}var Ye={value:function(){}};function Xe(){for(var t,n=0,e=arguments.length,r={};n<e;++n){if(!(t=arguments[n]+"")||t in r||/[\s.]/.test(t))throw new Error("illegal type: "+t);r[t]=[]}return new $e(r)}function $e(t){this._=t}function We(t,n){return t.trim().split(/^|\s+/).map((function(t){var e="",r=t.indexOf(".");if(r>=0&&(e=t.slice(r+1),t=t.slice(0,r)),t&&!n.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:e}}))}function Ge(t,n){for(var e,r=0,i=t.length;r<i;++r)if((e=t[r]).name===n)return e.value}function Qe(t,n,e){for(var r=0,i=t.length;r<i;++r)if(t[r].name===n){t[r]=Ye,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=e&&t.push({name:n,value:e}),t}$e.prototype=Xe.prototype={constructor:$e,on:function(t,n){var e,r=this._,i=We(t+"",r),o=-1,a=i.length;if(!(arguments.length<2)){if(null!=n&&"function"!=typeof n)throw new Error("invalid callback: "+n);for(;++o<a;)if(e=(t=i[o]).type)r[e]=Qe(r[e],t.name,n);else if(null==n)for(e in r)r[e]=Qe(r[e],t.name,null);return this}for(;++o<a;)if((e=(t=i[o]).type)&&(e=Ge(r[e],t.name)))return e},copy:function(){var t={},n=this._;for(var e in n)t[e]=n[e].slice();return new $e(t)},call:function(t,n){if((e=arguments.length-2)>0)for(var e,r,i=new Array(e),o=0;o<e;++o)i[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=0,e=(r=this._[t]).length;o<e;++o)r[o].value.apply(n,i)},apply:function(t,n,e){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,o=r.length;i<o;++i)r[i].value.apply(n,e)}};var Ze=Xe;function Ke(){}function Je(t){return null==t?Ke:function(){return this.querySelector(t)}}function tr(t){return null==t?[]:Array.isArray(t)?t:Array.from(t)}function nr(){return[]}function er(t){return null==t?nr:function(){return this.querySelectorAll(t)}}function rr(t){return function(){return this.matches(t)}}function ir(t){return function(n){return n.matches(t)}}var or=Array.prototype.find;function ar(){return this.firstElementChild}var ur=Array.prototype.filter;function cr(){return Array.from(this.children)}function sr(t){return new Array(t.length)}function fr(t,n){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=n}function lr(t){return function(){return t}}function hr(t){return(hr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function dr(t,n,e,r,i,o){for(var a,u=0,c=n.length,s=o.length;u<s;++u)(a=n[u])?(a.__data__=o[u],r[u]=a):e[u]=new fr(t,o[u]);for(;u<c;++u)(a=n[u])&&(i[u]=a)}function pr(t,n,e,r,i,o,a){var u,c,s,f=new Map,l=n.length,h=o.length,d=new Array(l);for(u=0;u<l;++u)(c=n[u])&&(d[u]=s=a.call(c,c.__data__,u,n)+"",f.has(s)?i[u]=c:f.set(s,c));for(u=0;u<h;++u)s=a.call(t,o[u],u,o)+"",(c=f.get(s))?(r[u]=c,c.__data__=o[u],f.delete(s)):e[u]=new fr(t,o[u]);for(u=0;u<l;++u)(c=n[u])&&f.get(d[u])===c&&(i[u]=c)}function yr(t){return t.__data__}function gr(t){return"object"===hr(t)&&"length"in t?t:Array.from(t)}function vr(t,n){return t<n?-1:t>n?1:t>=n?0:NaN}function mr(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return br(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return br(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function br(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}fr.prototype={constructor:fr,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,n){return this._parent.insertBefore(t,n)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var xr="http://www.w3.org/1999/xhtml",_r={svg:"http://www.w3.org/2000/svg",xhtml:xr,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function wr(t){var n=t+="",e=n.indexOf(":");return e>=0&&"xmlns"!==(n=t.slice(0,e))&&(t=t.slice(e+1)),_r.hasOwnProperty(n)?{space:_r[n],local:t}:t}function Ar(t){return function(){this.removeAttribute(t)}}function Sr(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Mr(t,n){return function(){this.setAttribute(t,n)}}function Tr(t,n){return function(){this.setAttributeNS(t.space,t.local,n)}}function Er(t,n){return function(){var e=n.apply(this,arguments);null==e?this.removeAttribute(t):this.setAttribute(t,e)}}function Cr(t,n){return function(){var e=n.apply(this,arguments);null==e?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,e)}}function kr(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function Nr(t){return function(){this.style.removeProperty(t)}}function Or(t,n,e){return function(){this.style.setProperty(t,n,e)}}function Pr(t,n,e){return function(){var r=n.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,e)}}function Ir(t,n){return t.style.getPropertyValue(n)||kr(t).getComputedStyle(t,null).getPropertyValue(n)}function Rr(t){return function(){delete this[t]}}function zr(t,n){return function(){this[t]=n}}function Vr(t,n){return function(){var e=n.apply(this,arguments);null==e?delete this[t]:this[t]=e}}function Dr(t){return t.trim().split(/^|\s+/)}function jr(t){return t.classList||new Lr(t)}function Lr(t){this._node=t,this._names=Dr(t.getAttribute("class")||"")}function Ur(t,n){for(var e=jr(t),r=-1,i=n.length;++r<i;)e.add(n[r])}function Br(t,n){for(var e=jr(t),r=-1,i=n.length;++r<i;)e.remove(n[r])}function Fr(t){return function(){Ur(this,t)}}function qr(t){return function(){Br(this,t)}}function Hr(t,n){return function(){(n.apply(this,arguments)?Ur:Br)(this,t)}}function Yr(){this.textContent=""}function Xr(t){return function(){this.textContent=t}}function $r(t){return function(){var n=t.apply(this,arguments);this.textContent=null==n?"":n}}function Wr(){this.innerHTML=""}function Gr(t){return function(){this.innerHTML=t}}function Qr(t){return function(){var n=t.apply(this,arguments);this.innerHTML=null==n?"":n}}function Zr(){this.nextSibling&&this.parentNode.appendChild(this)}function Kr(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Jr(t){return function(){var n=this.ownerDocument,e=this.namespaceURI;return e===xr&&n.documentElement.namespaceURI===xr?n.createElement(t):n.createElementNS(e,t)}}function ti(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function ni(t){var n=wr(t);return(n.local?ti:Jr)(n)}function ei(){return null}function ri(){var t=this.parentNode;t&&t.removeChild(this)}function ii(){var t=this.cloneNode(!1),n=this.parentNode;return n?n.insertBefore(t,this.nextSibling):t}function oi(){var t=this.cloneNode(!0),n=this.parentNode;return n?n.insertBefore(t,this.nextSibling):t}function ai(t){return t.trim().split(/^|\s+/).map((function(t){var n="",e=t.indexOf(".");return e>=0&&(n=t.slice(e+1),t=t.slice(0,e)),{type:t,name:n}}))}function ui(t){return function(){var n=this.__on;if(n){for(var e,r=0,i=-1,o=n.length;r<o;++r)e=n[r],t.type&&e.type!==t.type||e.name!==t.name?n[++i]=e:this.removeEventListener(e.type,e.listener,e.options);++i?n.length=i:delete this.__on}}}function ci(t,n,e){return function(){var r,i=this.__on,o=function(t){return function(n){t.call(this,n,this.__data__)}}(n);if(i)for(var a=0,u=i.length;a<u;++a)if((r=i[a]).type===t.type&&r.name===t.name)return this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=o,r.options=e),void(r.value=n);this.addEventListener(t.type,o,e),r={type:t.type,name:t.name,value:n,listener:o,options:e},i?i.push(r):this.__on=[r]}}function si(t,n,e){var r=kr(t),i=r.CustomEvent;"function"==typeof i?i=new i(n,e):(i=r.document.createEvent("Event"),e?(i.initEvent(n,e.bubbles,e.cancelable),i.detail=e.detail):i.initEvent(n,!1,!1)),t.dispatchEvent(i)}function fi(t,n){return function(){return si(this,t,n)}}function li(t,n){return function(){return si(this,t,n.apply(this,arguments))}}Lr.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var n=this._names.indexOf(t);n>=0&&(this._names.splice(n,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var hi=o.mark(di);function di(){var t,n,e,r,i,a,u;return o.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:t=this._groups,n=0,e=t.length;case 1:if(!(n<e)){o.next=13;break}r=t[n],i=0,a=r.length;case 3:if(!(i<a)){o.next=10;break}if(!(u=r[i])){o.next=7;break}return o.next=7,u;case 7:++i,o.next=3;break;case 10:++n,o.next=1;break;case 13:case"end":return o.stop()}}),hi,this)}var pi=[null];function yi(t,n){this._groups=t,this._parents=n}function gi(){return new yi([[document.documentElement]],pi)}yi.prototype=gi.prototype=function(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}({constructor:yi,select:function(t){"function"!=typeof t&&(t=Je(t));for(var n=this._groups,e=n.length,r=new Array(e),i=0;i<e;++i)for(var o,a,u=n[i],c=u.length,s=r[i]=new Array(c),f=0;f<c;++f)(o=u[f])&&(a=t.call(o,o.__data__,f,u))&&("__data__"in o&&(a.__data__=o.__data__),s[f]=a);return new yi(r,this._parents)},selectAll:function(t){t="function"==typeof t?function(t){return function(){return tr(t.apply(this,arguments))}}(t):er(t);for(var n=this._groups,e=n.length,r=[],i=[],o=0;o<e;++o)for(var a,u=n[o],c=u.length,s=0;s<c;++s)(a=u[s])&&(r.push(t.call(a,a.__data__,s,u)),i.push(a));return new yi(r,i)},selectChild:function(t){return this.select(null==t?ar:function(t){return function(){return or.call(this.children,t)}}("function"==typeof t?t:ir(t)))},selectChildren:function(t){return this.selectAll(null==t?cr:function(t){return function(){return ur.call(this.children,t)}}("function"==typeof t?t:ir(t)))},filter:function(t){"function"!=typeof t&&(t=rr(t));for(var n=this._groups,e=n.length,r=new Array(e),i=0;i<e;++i)for(var o,a=n[i],u=a.length,c=r[i]=[],s=0;s<u;++s)(o=a[s])&&t.call(o,o.__data__,s,a)&&c.push(o);return new yi(r,this._parents)},data:function(t,n){if(!arguments.length)return Array.from(this,yr);var e=n?pr:dr,r=this._parents,i=this._groups;"function"!=typeof t&&(t=lr(t));for(var o=i.length,a=new Array(o),u=new Array(o),c=new Array(o),s=0;s<o;++s){var f=r[s],l=i[s],h=l.length,d=gr(t.call(f,f&&f.__data__,s,r)),p=d.length,y=u[s]=new Array(p),g=a[s]=new Array(p),v=c[s]=new Array(h);e(f,l,y,g,v,d,n);for(var m,b,x=0,_=0;x<p;++x)if(m=y[x]){for(x>=_&&(_=x+1);!(b=g[_])&&++_<p;);m._next=b||null}}return(a=new yi(a,r))._enter=u,a._exit=c,a},enter:function(){return new yi(this._enter||this._groups.map(sr),this._parents)},exit:function(){return new yi(this._exit||this._groups.map(sr),this._parents)},join:function(t,n,e){var r=this.enter(),i=this,o=this.exit();return"function"==typeof t?(r=t(r))&&(r=r.selection()):r=r.append(t+""),null!=n&&(i=n(i))&&(i=i.selection()),null==e?o.remove():e(o),r&&i?r.merge(i).order():i},merge:function(t){for(var n=t.selection?t.selection():t,e=this._groups,r=n._groups,i=e.length,o=r.length,a=Math.min(i,o),u=new Array(i),c=0;c<a;++c)for(var s,f=e[c],l=r[c],h=f.length,d=u[c]=new Array(h),p=0;p<h;++p)(s=f[p]||l[p])&&(d[p]=s);for(;c<i;++c)u[c]=e[c];return new yi(u,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,n=-1,e=t.length;++n<e;)for(var r,i=t[n],o=i.length-1,a=i[o];--o>=0;)(r=i[o])&&(a&&4^r.compareDocumentPosition(a)&&a.parentNode.insertBefore(r,a),a=r);return this},sort:function(t){function n(n,e){return n&&e?t(n.__data__,e.__data__):!n-!e}t||(t=vr);for(var e=this._groups,r=e.length,i=new Array(r),o=0;o<r;++o){for(var a,u=e[o],c=u.length,s=i[o]=new Array(c),f=0;f<c;++f)(a=u[f])&&(s[f]=a);s.sort(n)}return new yi(i,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,n=0,e=t.length;n<e;++n)for(var r=t[n],i=0,o=r.length;i<o;++i){var a=r[i];if(a)return a}return null},size:function(){var t,n=0,e=mr(this);try{for(e.s();!(t=e.n()).done;){t.value;++n}}catch(t){e.e(t)}finally{e.f()}return n},empty:function(){return!this.node()},each:function(t){for(var n=this._groups,e=0,r=n.length;e<r;++e)for(var i,o=n[e],a=0,u=o.length;a<u;++a)(i=o[a])&&t.call(i,i.__data__,a,o);return this},attr:function(t,n){var e=wr(t);if(arguments.length<2){var r=this.node();return e.local?r.getAttributeNS(e.space,e.local):r.getAttribute(e)}return this.each((null==n?e.local?Sr:Ar:"function"==typeof n?e.local?Cr:Er:e.local?Tr:Mr)(e,n))},style:function(t,n,e){return arguments.length>1?this.each((null==n?Nr:"function"==typeof n?Pr:Or)(t,n,null==e?"":e)):Ir(this.node(),t)},property:function(t,n){return arguments.length>1?this.each((null==n?Rr:"function"==typeof n?Vr:zr)(t,n)):this.node()[t]},classed:function(t,n){var e=Dr(t+"");if(arguments.length<2){for(var r=jr(this.node()),i=-1,o=e.length;++i<o;)if(!r.contains(e[i]))return!1;return!0}return this.each(("function"==typeof n?Hr:n?Fr:qr)(e,n))},text:function(t){return arguments.length?this.each(null==t?Yr:("function"==typeof t?$r:Xr)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?Wr:("function"==typeof t?Qr:Gr)(t)):this.node().innerHTML},raise:function(){return this.each(Zr)},lower:function(){return this.each(Kr)},append:function(t){var n="function"==typeof t?t:ni(t);return this.select((function(){return this.appendChild(n.apply(this,arguments))}))},insert:function(t,n){var e="function"==typeof t?t:ni(t),r=null==n?ei:"function"==typeof n?n:Je(n);return this.select((function(){return this.insertBefore(e.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(ri)},clone:function(t){return this.select(t?oi:ii)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,n,e){var r,i,o=ai(t+""),a=o.length;if(!(arguments.length<2)){for(u=n?ci:ui,r=0;r<a;++r)this.each(u(o[r],n,e));return this}var u=this.node().__on;if(u)for(var c,s=0,f=u.length;s<f;++s)for(r=0,c=u[s];r<a;++r)if((i=o[r]).type===c.type&&i.name===c.name)return c.value},dispatch:function(t,n){return this.each(("function"==typeof n?li:fi)(t,n))}},Symbol.iterator,di);var vi=gi;function mi(t){return"string"==typeof t?new yi([[document.querySelector(t)]],[document.documentElement]):new yi([[t]],pi)}var bi={passive:!1},xi={capture:!0,passive:!1};function _i(t){t.stopImmediatePropagation()}function wi(t){t.preventDefault(),t.stopImmediatePropagation()}function Ai(t){var n=t.document.documentElement,e=mi(t).on("dragstart.drag",wi,xi);"onselectstart"in n?e.on("selectstart.drag",wi,xi):(n.__noselect=n.style.MozUserSelect,n.style.MozUserSelect="none")}function Si(t,n){var e=t.document.documentElement,r=mi(t).on("dragstart.drag",null);n&&(r.on("click.drag",wi,xi),setTimeout((function(){r.on("click.drag",null)}),0)),"onselectstart"in e?r.on("selectstart.drag",null):(e.style.MozUserSelect=e.__noselect,delete e.__noselect)}function Mi(t,n,e){t.prototype=n.prototype=e,e.constructor=t}function Ti(t,n){var e=Object.create(t.prototype);for(var r in n)e[r]=n[r];return e}function Ei(){}var Ci=.7,ki=1/Ci,Ni="\\s*([+-]?\\d+)\\s*",Oi="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Pi="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Ii=/^#([0-9a-f]{3,8})$/,Ri=new RegExp("^rgb\\("+[Ni,Ni,Ni]+"\\)$"),zi=new RegExp("^rgb\\("+[Pi,Pi,Pi]+"\\)$"),Vi=new RegExp("^rgba\\("+[Ni,Ni,Ni,Oi]+"\\)$"),Di=new RegExp("^rgba\\("+[Pi,Pi,Pi,Oi]+"\\)$"),ji=new RegExp("^hsl\\("+[Oi,Pi,Pi]+"\\)$"),Li=new RegExp("^hsla\\("+[Oi,Pi,Pi,Oi]+"\\)$"),Ui={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Bi(){return this.rgb().formatHex()}function Fi(){return this.rgb().formatRgb()}function qi(t){var n,e;return t=(t+"").trim().toLowerCase(),(n=Ii.exec(t))?(e=n[1].length,n=parseInt(n[1],16),6===e?Hi(n):3===e?new Wi(n>>8&15|n>>4&240,n>>4&15|240&n,(15&n)<<4|15&n,1):8===e?Yi(n>>24&255,n>>16&255,n>>8&255,(255&n)/255):4===e?Yi(n>>12&15|n>>8&240,n>>8&15|n>>4&240,n>>4&15|240&n,((15&n)<<4|15&n)/255):null):(n=Ri.exec(t))?new Wi(n[1],n[2],n[3],1):(n=zi.exec(t))?new Wi(255*n[1]/100,255*n[2]/100,255*n[3]/100,1):(n=Vi.exec(t))?Yi(n[1],n[2],n[3],n[4]):(n=Di.exec(t))?Yi(255*n[1]/100,255*n[2]/100,255*n[3]/100,n[4]):(n=ji.exec(t))?Ki(n[1],n[2]/100,n[3]/100,1):(n=Li.exec(t))?Ki(n[1],n[2]/100,n[3]/100,n[4]):Ui.hasOwnProperty(t)?Hi(Ui[t]):"transparent"===t?new Wi(NaN,NaN,NaN,0):null}function Hi(t){return new Wi(t>>16&255,t>>8&255,255&t,1)}function Yi(t,n,e,r){return r<=0&&(t=n=e=NaN),new Wi(t,n,e,r)}function Xi(t){return t instanceof Ei||(t=qi(t)),t?new Wi((t=t.rgb()).r,t.g,t.b,t.opacity):new Wi}function $i(t,n,e,r){return 1===arguments.length?Xi(t):new Wi(t,n,e,null==r?1:r)}function Wi(t,n,e,r){this.r=+t,this.g=+n,this.b=+e,this.opacity=+r}function Gi(){return"#"+Zi(this.r)+Zi(this.g)+Zi(this.b)}function Qi(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function Zi(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function Ki(t,n,e,r){return r<=0?t=n=e=NaN:e<=0||e>=1?t=n=NaN:n<=0&&(t=NaN),new no(t,n,e,r)}function Ji(t){if(t instanceof no)return new no(t.h,t.s,t.l,t.opacity);if(t instanceof Ei||(t=qi(t)),!t)return new no;if(t instanceof no)return t;var n=(t=t.rgb()).r/255,e=t.g/255,r=t.b/255,i=Math.min(n,e,r),o=Math.max(n,e,r),a=NaN,u=o-i,c=(o+i)/2;return u?(a=n===o?(e-r)/u+6*(e<r):e===o?(r-n)/u+2:(n-e)/u+4,u/=c<.5?o+i:2-o-i,a*=60):u=c>0&&c<1?0:a,new no(a,u,c,t.opacity)}function to(t,n,e,r){return 1===arguments.length?Ji(t):new no(t,n,e,null==r?1:r)}function no(t,n,e,r){this.h=+t,this.s=+n,this.l=+e,this.opacity=+r}function eo(t,n,e){return 255*(t<60?n+(e-n)*t/60:t<180?e:t<240?n+(e-n)*(240-t)/60:n)}function ro(t,n,e,r,i){var o=t*t,a=o*t;return((1-3*t+3*o-a)*n+(4-6*o+3*a)*e+(1+3*t+3*o-3*a)*r+a*i)/6}function io(t){var n=t.length-1;return function(e){var r=e<=0?e=0:e>=1?(e=1,n-1):Math.floor(e*n),i=t[r],o=t[r+1],a=r>0?t[r-1]:2*i-o,u=r<n-1?t[r+2]:2*o-i;return ro((e-r/n)*n,a,i,o,u)}}function oo(t){var n=t.length;return function(e){var r=Math.floor(((e%=1)<0?++e:e)*n),i=t[(r+n-1)%n],o=t[r%n],a=t[(r+1)%n],u=t[(r+2)%n];return ro((e-r/n)*n,i,o,a,u)}}Mi(Ei,qi,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:Bi,formatHex:Bi,formatHsl:function(){return Ji(this).formatHsl()},formatRgb:Fi,toString:Fi}),Mi(Wi,$i,Ti(Ei,{brighter:function(t){return t=null==t?ki:Math.pow(ki,t),new Wi(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?Ci:Math.pow(Ci,t),new Wi(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Gi,formatHex:Gi,formatRgb:Qi,toString:Qi})),Mi(no,to,Ti(Ei,{brighter:function(t){return t=null==t?ki:Math.pow(ki,t),new no(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?Ci:Math.pow(Ci,t),new no(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),n=isNaN(t)||isNaN(this.s)?0:this.s,e=this.l,r=e+(e<.5?e:1-e)*n,i=2*e-r;return new Wi(eo(t>=240?t-240:t+120,i,r),eo(t,i,r),eo(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));var ao=function(t){return function(){return t}};function uo(t,n){return function(e){return t+e*n}}function co(t,n){var e=n-t;return e?uo(t,e>180||e<-180?e-360*Math.round(e/360):e):ao(isNaN(t)?n:t)}function so(t){return 1==(t=+t)?fo:function(n,e){return e-n?function(t,n,e){return t=Math.pow(t,e),n=Math.pow(n,e)-t,e=1/e,function(r){return Math.pow(t+r*n,e)}}(n,e,t):ao(isNaN(n)?e:n)}}function fo(t,n){var e=n-t;return e?uo(t,e):ao(isNaN(t)?n:t)}var lo=function t(n){var e=so(n);function r(t,n){var r=e((t=$i(t)).r,(n=$i(n)).r),i=e(t.g,n.g),o=e(t.b,n.b),a=fo(t.opacity,n.opacity);return function(n){return t.r=r(n),t.g=i(n),t.b=o(n),t.opacity=a(n),t+""}}return r.gamma=t,r}(1);function ho(t){return function(n){var e,r,i=n.length,o=new Array(i),a=new Array(i),u=new Array(i);for(e=0;e<i;++e)r=$i(n[e]),o[e]=r.r||0,a[e]=r.g||0,u[e]=r.b||0;return o=t(o),a=t(a),u=t(u),r.opacity=1,function(t){return r.r=o(t),r.g=a(t),r.b=u(t),r+""}}}var po=ho(io),yo=ho(oo);function go(t,n){n||(n=[]);var e,r=t?Math.min(n.length,t.length):0,i=n.slice();return function(o){for(e=0;e<r;++e)i[e]=t[e]*(1-o)+n[e]*o;return i}}function vo(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function mo(t,n){return(vo(n)?go:bo)(t,n)}function bo(t,n){var e,r=n?n.length:0,i=t?Math.min(r,t.length):0,o=new Array(i),a=new Array(r);for(e=0;e<i;++e)o[e]=Co(t[e],n[e]);for(;e<r;++e)a[e]=n[e];return function(t){for(e=0;e<i;++e)a[e]=o[e](t);return a}}function xo(t,n){var e=new Date;return t=+t,n=+n,function(r){return e.setTime(t*(1-r)+n*r),e}}function _o(t,n){return t=+t,n=+n,function(e){return t*(1-e)+n*e}}function wo(t){return(wo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ao(t,n){var e,r={},i={};for(e in null!==t&&"object"===wo(t)||(t={}),null!==n&&"object"===wo(n)||(n={}),n)e in t?r[e]=Co(t[e],n[e]):i[e]=n[e];return function(t){for(e in r)i[e]=r[e](t);return i}}var So=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Mo=new RegExp(So.source,"g");function To(t,n){var e,r,i,o=So.lastIndex=Mo.lastIndex=0,a=-1,u=[],c=[];for(t+="",n+="";(e=So.exec(t))&&(r=Mo.exec(n));)(i=r.index)>o&&(i=n.slice(o,i),u[a]?u[a]+=i:u[++a]=i),(e=e[0])===(r=r[0])?u[a]?u[a]+=r:u[++a]=r:(u[++a]=null,c.push({i:a,x:_o(e,r)})),o=Mo.lastIndex;return o<n.length&&(i=n.slice(o),u[a]?u[a]+=i:u[++a]=i),u.length<2?c[0]?function(t){return function(n){return t(n)+""}}(c[0].x):function(t){return function(){return t}}(n):(n=c.length,function(t){for(var e,r=0;r<n;++r)u[(e=c[r]).i]=e.x(t);return u.join("")})}function Eo(t){return(Eo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Co(t,n){var e,r=Eo(n);return null==n||"boolean"===r?ao(n):("number"===r?_o:"string"===r?(e=qi(n))?(n=e,lo):To:n instanceof qi?lo:n instanceof Date?xo:vo(n)?go:Array.isArray(n)?bo:"function"!=typeof n.valueOf&&"function"!=typeof n.toString||isNaN(n)?Ao:_o)(t,n)}function ko(t){for(var n;n=t.sourceEvent;)t=n;return t}function No(t,n){if(t=ko(t),void 0===n&&(n=t.currentTarget),n){var e=n.ownerSVGElement||n;if(e.createSVGPoint){var r=e.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,[(r=r.matrixTransform(n.getScreenCTM().inverse())).x,r.y]}if(n.getBoundingClientRect){var i=n.getBoundingClientRect();return[t.clientX-i.left-n.clientLeft,t.clientY-i.top-n.clientTop]}}return[t.pageX,t.pageY]}function Oo(t){return(Oo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var Po,Io,Ro=0,zo=0,Vo=0,Do=0,jo=0,Lo=0,Uo="object"===("undefined"==typeof performance?"undefined":Oo(performance))&&performance.now?performance:Date,Bo="object"===("undefined"==typeof window?"undefined":Oo(window))&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Fo(){return jo||(Bo(qo),jo=Uo.now()+Lo)}function qo(){jo=0}function Ho(){this._call=this._time=this._next=null}function Yo(t,n,e){var r=new Ho;return r.restart(t,n,e),r}function Xo(){Fo(),++Ro;for(var t,n=Po;n;)(t=jo-n._time)>=0&&n._call.call(void 0,t),n=n._next;--Ro}function $o(){jo=(Do=Uo.now())+Lo,Ro=zo=0;try{Xo()}finally{Ro=0,function(){var t,n,e=Po,r=1/0;for(;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:Po=n);Io=t,Go(r)}(),jo=0}}function Wo(){var t=Uo.now(),n=t-Do;n>1e3&&(Lo-=n,Do=t)}function Go(t){Ro||(zo&&(zo=clearTimeout(zo)),t-jo>24?(t<1/0&&(zo=setTimeout($o,t-Uo.now()-Lo)),Vo&&(Vo=clearInterval(Vo))):(Vo||(Do=Uo.now(),Vo=setInterval(Wo,1e3)),Ro=1,Bo($o)))}function Qo(t,n,e){var r=new Ho;return n=null==n?0:+n,r.restart((function(e){r.stop(),t(e+n)}),n,e),r}Ho.prototype=Yo.prototype={constructor:Ho,restart:function(t,n,e){if("function"!=typeof t)throw new TypeError("callback is not a function");e=(null==e?Fo():+e)+(null==n?0:+n),this._next||Io===this||(Io?Io._next=this:Po=this,Io=this),this._call=t,this._time=e,Go()},stop:function(){this._call&&(this._call=null,this._time=1/0,Go())}};var Zo=Ze("start","end","cancel","interrupt"),Ko=[];function Jo(t,n,e,r,i,o){var a=t.__transition;if(a){if(e in a)return}else t.__transition={};!function(t,n,e){var r,i=t.__transition;function o(t){e.state=1,e.timer.restart(a,e.delay,e.time),e.delay<=t&&a(t-e.delay)}function a(o){var s,f,l,h;if(1!==e.state)return c();for(s in i)if((h=i[s]).name===e.name){if(3===h.state)return Qo(a);4===h.state?(h.state=6,h.timer.stop(),h.on.call("interrupt",t,t.__data__,h.index,h.group),delete i[s]):+s<n&&(h.state=6,h.timer.stop(),h.on.call("cancel",t,t.__data__,h.index,h.group),delete i[s])}if(Qo((function(){3===e.state&&(e.state=4,e.timer.restart(u,e.delay,e.time),u(o))})),e.state=2,e.on.call("start",t,t.__data__,e.index,e.group),2===e.state){for(e.state=3,r=new Array(l=e.tween.length),s=0,f=-1;s<l;++s)(h=e.tween[s].value.call(t,t.__data__,e.index,e.group))&&(r[++f]=h);r.length=f+1}}function u(n){for(var i=n<e.duration?e.ease.call(null,n/e.duration):(e.timer.restart(c),e.state=5,1),o=-1,a=r.length;++o<a;)r[o].call(t,i);5===e.state&&(e.on.call("end",t,t.__data__,e.index,e.group),c())}function c(){for(var r in e.state=6,e.timer.stop(),delete i[n],i)return;delete t.__transition}i[n]=e,e.timer=Yo(o,0,e.time)}(t,e,{name:n,index:r,group:i,on:Zo,tween:Ko,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:0})}function ta(t,n){var e=ea(t,n);if(e.state>0)throw new Error("too late; already scheduled");return e}function na(t,n){var e=ea(t,n);if(e.state>3)throw new Error("too late; already running");return e}function ea(t,n){var e=t.__transition;if(!e||!(e=e[n]))throw new Error("transition not found");return e}function ra(t,n){var e,r,i,o=t.__transition,a=!0;if(o){for(i in n=null==n?null:n+"",o)(e=o[i]).name===n?(r=e.state>2&&e.state<5,e.state=6,e.timer.stop(),e.on.call(r?"interrupt":"cancel",t,t.__data__,e.index,e.group),delete o[i]):a=!1;a&&delete t.__transition}}var ia,oa=180/Math.PI,aa={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function ua(t,n,e,r,i,o){var a,u,c;return(a=Math.sqrt(t*t+n*n))&&(t/=a,n/=a),(c=t*e+n*r)&&(e-=t*c,r-=n*c),(u=Math.sqrt(e*e+r*r))&&(e/=u,r/=u,c/=u),t*r<n*e&&(t=-t,n=-n,c=-c,a=-a),{translateX:i,translateY:o,rotate:Math.atan2(n,t)*oa,skewX:Math.atan(c)*oa,scaleX:a,scaleY:u}}function ca(t,n,e,r){function i(t){return t.length?t.pop()+" ":""}return function(o,a){var u=[],c=[];return o=t(o),a=t(a),function(t,r,i,o,a,u){if(t!==i||r!==o){var c=a.push("translate(",null,n,null,e);u.push({i:c-4,x:_o(t,i)},{i:c-2,x:_o(r,o)})}else(i||o)&&a.push("translate("+i+n+o+e)}(o.translateX,o.translateY,a.translateX,a.translateY,u,c),function(t,n,e,o){t!==n?(t-n>180?n+=360:n-t>180&&(t+=360),o.push({i:e.push(i(e)+"rotate(",null,r)-2,x:_o(t,n)})):n&&e.push(i(e)+"rotate("+n+r)}(o.rotate,a.rotate,u,c),function(t,n,e,o){t!==n?o.push({i:e.push(i(e)+"skewX(",null,r)-2,x:_o(t,n)}):n&&e.push(i(e)+"skewX("+n+r)}(o.skewX,a.skewX,u,c),function(t,n,e,r,o,a){if(t!==e||n!==r){var u=o.push(i(o)+"scale(",null,",",null,")");a.push({i:u-4,x:_o(t,e)},{i:u-2,x:_o(n,r)})}else 1===e&&1===r||o.push(i(o)+"scale("+e+","+r+")")}(o.scaleX,o.scaleY,a.scaleX,a.scaleY,u,c),o=a=null,function(t){for(var n,e=-1,r=c.length;++e<r;)u[(n=c[e]).i]=n.x(t);return u.join("")}}}var sa=ca((function(t){var n=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return n.isIdentity?aa:ua(n.a,n.b,n.c,n.d,n.e,n.f)}),"px, ","px)","deg)"),fa=ca((function(t){return null==t?aa:(ia||(ia=document.createElementNS("http://www.w3.org/2000/svg","g")),ia.setAttribute("transform",t),(t=ia.transform.baseVal.consolidate())?ua((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):aa)}),", ",")",")");function la(t,n){var e,r;return function(){var i=na(this,t),o=i.tween;if(o!==e)for(var a=0,u=(r=e=o).length;a<u;++a)if(r[a].name===n){(r=r.slice()).splice(a,1);break}i.tween=r}}function ha(t,n,e){var r,i;if("function"!=typeof e)throw new Error;return function(){var o=na(this,t),a=o.tween;if(a!==r){i=(r=a).slice();for(var u={name:n,value:e},c=0,s=i.length;c<s;++c)if(i[c].name===n){i[c]=u;break}c===s&&i.push(u)}o.tween=i}}function da(t,n,e){var r=t._id;return t.each((function(){var t=na(this,r);(t.value||(t.value={}))[n]=e.apply(this,arguments)})),function(t){return ea(t,r).value[n]}}function pa(t,n){var e;return("number"==typeof n?_o:n instanceof qi?lo:(e=qi(n))?(n=e,lo):To)(t,n)}function ya(t){return function(){this.removeAttribute(t)}}function ga(t){return function(){this.removeAttributeNS(t.space,t.local)}}function va(t,n,e){var r,i,o=e+"";return function(){var a=this.getAttribute(t);return a===o?null:a===r?i:i=n(r=a,e)}}function ma(t,n,e){var r,i,o=e+"";return function(){var a=this.getAttributeNS(t.space,t.local);return a===o?null:a===r?i:i=n(r=a,e)}}function ba(t,n,e){var r,i,o;return function(){var a,u,c=e(this);if(null!=c)return(a=this.getAttribute(t))===(u=c+"")?null:a===r&&u===i?o:(i=u,o=n(r=a,c));this.removeAttribute(t)}}function xa(t,n,e){var r,i,o;return function(){var a,u,c=e(this);if(null!=c)return(a=this.getAttributeNS(t.space,t.local))===(u=c+"")?null:a===r&&u===i?o:(i=u,o=n(r=a,c));this.removeAttributeNS(t.space,t.local)}}function _a(t,n){return function(e){this.setAttribute(t,n.call(this,e))}}function wa(t,n){return function(e){this.setAttributeNS(t.space,t.local,n.call(this,e))}}function Aa(t,n){var e,r;function i(){var i=n.apply(this,arguments);return i!==r&&(e=(r=i)&&wa(t,i)),e}return i._value=n,i}function Sa(t,n){var e,r;function i(){var i=n.apply(this,arguments);return i!==r&&(e=(r=i)&&_a(t,i)),e}return i._value=n,i}function Ma(t,n){return function(){ta(this,t).delay=+n.apply(this,arguments)}}function Ta(t,n){return n=+n,function(){ta(this,t).delay=n}}function Ea(t,n){return function(){na(this,t).duration=+n.apply(this,arguments)}}function Ca(t,n){return n=+n,function(){na(this,t).duration=n}}function ka(t,n){if("function"!=typeof n)throw new Error;return function(){na(this,t).ease=n}}function Na(t,n,e){var r,i,o=function(t){return(t+"").trim().split(/^|\s+/).every((function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||"start"===t}))}(n)?ta:na;return function(){var a=o(this,t),u=a.on;u!==r&&(i=(r=u).copy()).on(n,e),a.on=i}}var Oa=vi.prototype.constructor;function Pa(t){return function(){this.style.removeProperty(t)}}function Ia(t,n,e){return function(r){this.style.setProperty(t,n.call(this,r),e)}}function Ra(t,n,e){var r,i;function o(){var o=n.apply(this,arguments);return o!==i&&(r=(i=o)&&Ia(t,o,e)),r}return o._value=n,o}function za(t){return function(n){this.textContent=t.call(this,n)}}function Va(t){var n,e;function r(){var r=t.apply(this,arguments);return r!==e&&(n=(e=r)&&za(r)),n}return r._value=t,r}var Da=0;function ja(t,n,e,r){this._groups=t,this._parents=n,this._name=e,this._id=r}function La(t){return vi().transition(t)}function Ua(){return++Da}var Ba=vi.prototype;function Fa(t){return t*t*t}function qa(t){return--t*t*t+1}function Ha(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}ja.prototype=La.prototype=function(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}({constructor:ja,select:function(t){var n=this._name,e=this._id;"function"!=typeof t&&(t=Je(t));for(var r=this._groups,i=r.length,o=new Array(i),a=0;a<i;++a)for(var u,c,s=r[a],f=s.length,l=o[a]=new Array(f),h=0;h<f;++h)(u=s[h])&&(c=t.call(u,u.__data__,h,s))&&("__data__"in u&&(c.__data__=u.__data__),l[h]=c,Jo(l[h],n,e,h,l,ea(u,e)));return new ja(o,this._parents,n,e)},selectAll:function(t){var n=this._name,e=this._id;"function"!=typeof t&&(t=er(t));for(var r=this._groups,i=r.length,o=[],a=[],u=0;u<i;++u)for(var c,s=r[u],f=s.length,l=0;l<f;++l)if(c=s[l]){for(var h,d=t.call(c,c.__data__,l,s),p=ea(c,e),y=0,g=d.length;y<g;++y)(h=d[y])&&Jo(h,n,e,y,d,p);o.push(d),a.push(c)}return new ja(o,a,n,e)},selectChild:Ba.selectChild,selectChildren:Ba.selectChildren,filter:function(t){"function"!=typeof t&&(t=rr(t));for(var n=this._groups,e=n.length,r=new Array(e),i=0;i<e;++i)for(var o,a=n[i],u=a.length,c=r[i]=[],s=0;s<u;++s)(o=a[s])&&t.call(o,o.__data__,s,a)&&c.push(o);return new ja(r,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var n=this._groups,e=t._groups,r=n.length,i=e.length,o=Math.min(r,i),a=new Array(r),u=0;u<o;++u)for(var c,s=n[u],f=e[u],l=s.length,h=a[u]=new Array(l),d=0;d<l;++d)(c=s[d]||f[d])&&(h[d]=c);for(;u<r;++u)a[u]=n[u];return new ja(a,this._parents,this._name,this._id)},selection:function(){return new Oa(this._groups,this._parents)},transition:function(){for(var t=this._name,n=this._id,e=Ua(),r=this._groups,i=r.length,o=0;o<i;++o)for(var a,u=r[o],c=u.length,s=0;s<c;++s)if(a=u[s]){var f=ea(a,n);Jo(a,t,e,s,u,{time:f.time+f.delay+f.duration,delay:0,duration:f.duration,ease:f.ease})}return new ja(r,this._parents,t,e)},call:Ba.call,nodes:Ba.nodes,node:Ba.node,size:Ba.size,empty:Ba.empty,each:Ba.each,on:function(t,n){var e=this._id;return arguments.length<2?ea(this.node(),e).on.on(t):this.each(Na(e,t,n))},attr:function(t,n){var e=wr(t),r="transform"===e?fa:pa;return this.attrTween(t,"function"==typeof n?(e.local?xa:ba)(e,r,da(this,"attr."+t,n)):null==n?(e.local?ga:ya)(e):(e.local?ma:va)(e,r,n))},attrTween:function(t,n){var e="attr."+t;if(arguments.length<2)return(e=this.tween(e))&&e._value;if(null==n)return this.tween(e,null);if("function"!=typeof n)throw new Error;var r=wr(t);return this.tween(e,(r.local?Aa:Sa)(r,n))},style:function(t,n,e){var r="transform"==(t+="")?sa:pa;return null==n?this.styleTween(t,function(t,n){var e,r,i;return function(){var o=Ir(this,t),a=(this.style.removeProperty(t),Ir(this,t));return o===a?null:o===e&&a===r?i:i=n(e=o,r=a)}}(t,r)).on("end.style."+t,Pa(t)):"function"==typeof n?this.styleTween(t,function(t,n,e){var r,i,o;return function(){var a=Ir(this,t),u=e(this),c=u+"";return null==u&&(this.style.removeProperty(t),c=u=Ir(this,t)),a===c?null:a===r&&c===i?o:(i=c,o=n(r=a,u))}}(t,r,da(this,"style."+t,n))).each(function(t,n){var e,r,i,o,a="style."+n,u="end."+a;return function(){var c=na(this,t),s=c.on,f=null==c.value[a]?o||(o=Pa(n)):void 0;s===e&&i===f||(r=(e=s).copy()).on(u,i=f),c.on=r}}(this._id,t)):this.styleTween(t,function(t,n,e){var r,i,o=e+"";return function(){var a=Ir(this,t);return a===o?null:a===r?i:i=n(r=a,e)}}(t,r,n),e).on("end.style."+t,null)},styleTween:function(t,n,e){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==n)return this.tween(r,null);if("function"!=typeof n)throw new Error;return this.tween(r,Ra(t,n,null==e?"":e))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var n=t(this);this.textContent=null==n?"":n}}(da(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var n="text";if(arguments.length<1)return(n=this.tween(n))&&n._value;if(null==t)return this.tween(n,null);if("function"!=typeof t)throw new Error;return this.tween(n,Va(t))},remove:function(){return this.on("end.remove",function(t){return function(){var n=this.parentNode;for(var e in this.__transition)if(+e!==t)return;n&&n.removeChild(this)}}(this._id))},tween:function(t,n){var e=this._id;if(t+="",arguments.length<2){for(var r,i=ea(this.node(),e).tween,o=0,a=i.length;o<a;++o)if((r=i[o]).name===t)return r.value;return null}return this.each((null==n?la:ha)(e,t,n))},delay:function(t){var n=this._id;return arguments.length?this.each(("function"==typeof t?Ma:Ta)(n,t)):ea(this.node(),n).delay},duration:function(t){var n=this._id;return arguments.length?this.each(("function"==typeof t?Ea:Ca)(n,t)):ea(this.node(),n).duration},ease:function(t){var n=this._id;return arguments.length?this.each(ka(n,t)):ea(this.node(),n).ease},easeVarying:function(t){if("function"!=typeof t)throw new Error;return this.each(function(t,n){return function(){var e=n.apply(this,arguments);if("function"!=typeof e)throw new Error;na(this,t).ease=e}}(this._id,t))},end:function(){var t,n,e=this,r=e._id,i=e.size();return new Promise((function(o,a){var u={value:a},c={value:function(){0==--i&&o()}};e.each((function(){var e=na(this,r),i=e.on;i!==t&&((n=(t=i).copy())._.cancel.push(u),n._.interrupt.push(u),n._.end.push(c)),e.on=n})),0===i&&o()}))}},Symbol.iterator,Ba[Symbol.iterator]);var Ya={time:null,delay:0,duration:250,ease:Ha};function Xa(t,n){for(var e;!(e=t.__transition)||!(e=e[n]);)if(!(t=t.parentNode))throw new Error("transition ".concat(n," not found"));return e}vi.prototype.interrupt=function(t){return this.each((function(){ra(this,t)}))},vi.prototype.transition=function(t){var n,e;t instanceof ja?(n=t._id,t=t._name):(n=Ua(),(e=Ya).time=Fo(),t=null==t?null:t+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var a,u=r[o],c=u.length,s=0;s<c;++s)(a=u[s])&&Jo(a,t,n,s,u,e||Xa(a,n));return new ja(r,this._parents,t,n)};var $a=[null];function Wa(t,n){var e,r,i=t.__transition;if(i)for(r in n=null==n?null:n+"",i)if((e=i[r]).state>1&&e.name===n)return new ja([[t]],$a,n,+r);return null}var Ga=function(t){return function(){return t}};function Qa(t,n){var e=n.sourceEvent,r=n.target,i=n.selection,o=n.mode,a=n.dispatch;Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},selection:{value:i,enumerable:!0,configurable:!0},mode:{value:o,enumerable:!0,configurable:!0},_:{value:a}})}function Za(t){t.stopImmediatePropagation()}function Ka(t){t.preventDefault(),t.stopImmediatePropagation()}function Ja(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return tu(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return tu(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function tu(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}var nu={name:"drag"},eu={name:"space"},ru={name:"handle"},iu={name:"center"},ou=Math.abs,au=Math.max,uu=Math.min;function cu(t){return[+t[0],+t[1]]}function su(t){return[cu(t[0]),cu(t[1])]}var fu={name:"x",handles:["w","e"].map(mu),input:function(t,n){return null==t?null:[[+t[0],n[0][1]],[+t[1],n[1][1]]]},output:function(t){return t&&[t[0][0],t[1][0]]}},lu={name:"y",handles:["n","s"].map(mu),input:function(t,n){return null==t?null:[[n[0][0],+t[0]],[n[1][0],+t[1]]]},output:function(t){return t&&[t[0][1],t[1][1]]}},hu={name:"xy",handles:["n","w","e","s","nw","ne","sw","se"].map(mu),input:function(t){return null==t?null:su(t)},output:function(t){return t}},du={overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},pu={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},yu={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},gu={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},vu={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1};function mu(t){return{type:t}}function bu(t){return!t.ctrlKey&&!t.button}function xu(){var t=this.ownerSVGElement||this;return t.hasAttribute("viewBox")?[[(t=t.viewBox.baseVal).x,t.y],[t.x+t.width,t.y+t.height]]:[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]}function _u(){return navigator.maxTouchPoints||"ontouchstart"in this}function wu(t){for(;!t.__brush;)if(!(t=t.parentNode))return;return t.__brush}function Au(t){return t[0][0]===t[1][0]||t[0][1]===t[1][1]}function Su(t){var n=t.__brush;return n?n.dim.output(n.selection):null}function Mu(){return Cu(fu)}function Tu(){return Cu(lu)}function Eu(){return Cu(hu)}function Cu(t){var n,e=xu,r=bu,i=_u,o=!0,a=Ze("start","brush","end"),u=6;function c(n){var e=n.property("__brush",y).selectAll(".overlay").data([mu("overlay")]);e.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",du.overlay).merge(e).each((function(){var t=wu(this).extent;mi(this).attr("x",t[0][0]).attr("y",t[0][1]).attr("width",t[1][0]-t[0][0]).attr("height",t[1][1]-t[0][1])})),n.selectAll(".selection").data([mu("selection")]).enter().append("rect").attr("class","selection").attr("cursor",du.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var r=n.selectAll(".handle").data(t.handles,(function(t){return t.type}));r.exit().remove(),r.enter().append("rect").attr("class",(function(t){return"handle handle--"+t.type})).attr("cursor",(function(t){return du[t.type]})),n.each(s).attr("fill","none").attr("pointer-events","all").on("mousedown.brush",h).filter(i).on("touchstart.brush",h).on("touchmove.brush",d).on("touchend.brush touchcancel.brush",p).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function s(){var t=mi(this),n=wu(this).selection;n?(t.selectAll(".selection").style("display",null).attr("x",n[0][0]).attr("y",n[0][1]).attr("width",n[1][0]-n[0][0]).attr("height",n[1][1]-n[0][1]),t.selectAll(".handle").style("display",null).attr("x",(function(t){return"e"===t.type[t.type.length-1]?n[1][0]-u/2:n[0][0]-u/2})).attr("y",(function(t){return"s"===t.type[0]?n[1][1]-u/2:n[0][1]-u/2})).attr("width",(function(t){return"n"===t.type||"s"===t.type?n[1][0]-n[0][0]+u:u})).attr("height",(function(t){return"e"===t.type||"w"===t.type?n[1][1]-n[0][1]+u:u}))):t.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function f(t,n,e){var r=t.__brush.emitter;return!r||e&&r.clean?new l(t,n,e):r}function l(t,n,e){this.that=t,this.args=n,this.state=t.__brush,this.active=0,this.clean=e}function h(e){if((!n||e.touches)&&r.apply(this,arguments)){var i,a,u,c,l,h,d,p,y,g,v,m=this,b=e.target.__data__.type,x="selection"===(o&&e.metaKey?b="overlay":b)?nu:o&&e.altKey?iu:ru,_=t===lu?null:gu[b],w=t===fu?null:vu[b],A=wu(m),S=A.extent,M=A.selection,T=S[0][0],E=S[0][1],C=S[1][0],k=S[1][1],N=0,O=0,P=_&&w&&o&&e.shiftKey,I=Array.from(e.touches||[e],(function(t){var n=t.identifier;return(t=No(t,m)).point0=t.slice(),t.identifier=n,t}));ra(m);var R=f(m,arguments,!0).beforestart();if("overlay"===b){M&&(y=!0);var z=[I[0],I[1]||I[0]];A.selection=M=[[i=t===lu?T:uu(z[0][0],z[1][0]),u=t===fu?E:uu(z[0][1],z[1][1])],[l=t===lu?C:au(z[0][0],z[1][0]),d=t===fu?k:au(z[0][1],z[1][1])]],I.length>1&&U(e)}else i=M[0][0],u=M[0][1],l=M[1][0],d=M[1][1];a=i,c=u,h=l,p=d;var V=mi(m).attr("pointer-events","none"),D=V.selectAll(".overlay").attr("cursor",du[b]);if(e.touches)R.moved=L,R.ended=B;else{var j=mi(e.view).on("mousemove.brush",L,!0).on("mouseup.brush",B,!0);o&&j.on("keydown.brush",F,!0).on("keyup.brush",q,!0),Ai(e.view)}s.call(m),R.start(e,x.name)}function L(t){var n,e=Ja(t.changedTouches||[t]);try{for(e.s();!(n=e.n()).done;){var r,i=n.value,o=Ja(I);try{for(o.s();!(r=o.n()).done;){var a=r.value;a.identifier===i.identifier&&(a.cur=No(i,m))}}catch(t){o.e(t)}finally{o.f()}}}catch(t){e.e(t)}finally{e.f()}if(P&&!g&&!v&&1===I.length){var u=I[0];ou(u.cur[0]-u[0])>ou(u.cur[1]-u[1])?v=!0:g=!0}var c,s=Ja(I);try{for(s.s();!(c=s.n()).done;){var f=c.value;f.cur&&(f[0]=f.cur[0],f[1]=f.cur[1])}}catch(t){s.e(t)}finally{s.f()}y=!0,Ka(t),U(t)}function U(t){var n,e=I[0],r=e.point0;switch(N=e[0]-r[0],O=e[1]-r[1],x){case eu:case nu:_&&(N=au(T-i,uu(C-l,N)),a=i+N,h=l+N),w&&(O=au(E-u,uu(k-d,O)),c=u+O,p=d+O);break;case ru:I[1]?(_&&(a=au(T,uu(C,I[0][0])),h=au(T,uu(C,I[1][0])),_=1),w&&(c=au(E,uu(k,I[0][1])),p=au(E,uu(k,I[1][1])),w=1)):(_<0?(N=au(T-i,uu(C-i,N)),a=i+N,h=l):_>0&&(N=au(T-l,uu(C-l,N)),a=i,h=l+N),w<0?(O=au(E-u,uu(k-u,O)),c=u+O,p=d):w>0&&(O=au(E-d,uu(k-d,O)),c=u,p=d+O));break;case iu:_&&(a=au(T,uu(C,i-N*_)),h=au(T,uu(C,l+N*_))),w&&(c=au(E,uu(k,u-O*w)),p=au(E,uu(k,d+O*w)))}h<a&&(_*=-1,n=i,i=l,l=n,n=a,a=h,h=n,b in pu&&D.attr("cursor",du[b=pu[b]])),p<c&&(w*=-1,n=u,u=d,d=n,n=c,c=p,p=n,b in yu&&D.attr("cursor",du[b=yu[b]])),A.selection&&(M=A.selection),g&&(a=M[0][0],h=M[1][0]),v&&(c=M[0][1],p=M[1][1]),M[0][0]===a&&M[0][1]===c&&M[1][0]===h&&M[1][1]===p||(A.selection=[[a,c],[h,p]],s.call(m),R.brush(t,x.name))}function B(t){if(Za(t),t.touches){if(t.touches.length)return;n&&clearTimeout(n),n=setTimeout((function(){n=null}),500)}else Si(t.view,y),j.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);V.attr("pointer-events","all"),D.attr("cursor",du.overlay),A.selection&&(M=A.selection),Au(M)&&(A.selection=null,s.call(m)),R.end(t,x.name)}function F(t){switch(t.keyCode){case 16:P=_&&w;break;case 18:x===ru&&(_&&(l=h-N*_,i=a+N*_),w&&(d=p-O*w,u=c+O*w),x=iu,U(t));break;case 32:x!==ru&&x!==iu||(_<0?l=h-N:_>0&&(i=a-N),w<0?d=p-O:w>0&&(u=c-O),x=eu,D.attr("cursor",du.selection),U(t));break;default:return}Ka(t)}function q(t){switch(t.keyCode){case 16:P&&(g=v=P=!1,U(t));break;case 18:x===iu&&(_<0?l=h:_>0&&(i=a),w<0?d=p:w>0&&(u=c),x=ru,U(t));break;case 32:x===eu&&(t.altKey?(_&&(l=h-N*_,i=a+N*_),w&&(d=p-O*w,u=c+O*w),x=iu):(_<0?l=h:_>0&&(i=a),w<0?d=p:w>0&&(u=c),x=ru),D.attr("cursor",du[b]),U(t));break;default:return}Ka(t)}}function d(t){f(this,arguments).moved(t)}function p(t){f(this,arguments).ended(t)}function y(){var n=this.__brush||{selection:null};return n.extent=su(e.apply(this,arguments)),n.dim=t,n}return c.move=function(n,e,r){n.tween?n.on("start.brush",(function(t){f(this,arguments).beforestart().start(t)})).on("interrupt.brush end.brush",(function(t){f(this,arguments).end(t)})).tween("brush",(function(){var n=this,r=n.__brush,i=f(n,arguments),o=r.selection,a=t.input("function"==typeof e?e.apply(this,arguments):e,r.extent),u=Co(o,a);function c(t){r.selection=1===t&&null===a?null:u(t),s.call(n),i.brush()}return null!==o&&null!==a?c:c(1)})):n.each((function(){var n=this,i=arguments,o=n.__brush,a=t.input("function"==typeof e?e.apply(n,i):e,o.extent),u=f(n,i).beforestart();ra(n),o.selection=null===a?null:a,s.call(n),u.start(r).brush(r).end(r)}))},c.clear=function(t,n){c.move(t,null,n)},l.prototype={beforestart:function(){return 1==++this.active&&(this.state.emitter=this,this.starting=!0),this},start:function(t,n){return this.starting?(this.starting=!1,this.emit("start",t,n)):this.emit("brush",t),this},brush:function(t,n){return this.emit("brush",t,n),this},end:function(t,n){return 0==--this.active&&(delete this.state.emitter,this.emit("end",t,n)),this},emit:function(n,e,r){var i=mi(this.that).datum();a.call(n,this.that,new Qa(n,{sourceEvent:e,target:c,selection:t.output(this.state.selection),mode:r,dispatch:a}),i)}},c.extent=function(t){return arguments.length?(e="function"==typeof t?t:Ga(su(t)),c):e},c.filter=function(t){return arguments.length?(r="function"==typeof t?t:Ga(!!t),c):r},c.touchable=function(t){return arguments.length?(i="function"==typeof t?t:Ga(!!t),c):i},c.handleSize=function(t){return arguments.length?(u=+t,c):u},c.keyModifiers=function(t){return arguments.length?(o=!!t,c):o},c.on=function(){var t=a.on.apply(a,arguments);return t===a?c:t},c}var ku=Math.abs,Nu=Math.cos,Ou=Math.sin,Pu=Math.PI,Iu=Pu/2,Ru=2*Pu,zu=Math.max,Vu=1e-12;function Du(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return ju(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return ju(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function ju(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function Lu(t,n){return Array.from({length:n-t},(function(n,e){return t+e}))}function Uu(t){return function(n,e){return t(n.source.value+n.target.value,e.source.value+e.target.value)}}function Bu(){return Hu(!1,!1)}function Fu(){return Hu(!1,!0)}function qu(){return Hu(!0,!1)}function Hu(t,n){var e=0,r=null,i=null,o=null;function a(a){var u,c=a.length,s=new Array(c),f=Lu(0,c),l=new Array(c*c),h=new Array(c),d=0;a=Float64Array.from({length:c*c},n?function(t,n){return a[n%c][n/c|0]}:function(t,n){return a[n/c|0][n%c]});for(var p=0;p<c;++p){for(var y=0,g=0;g<c;++g)y+=a[p*c+g]+t*a[g*c+p];d+=s[p]=y}d=zu(0,Ru-e*c)/d,u=d?e:Ru/c;var v=0;r&&f.sort((function(t,n){return r(s[t],s[n])}));var m,b=Du(f);try{var x=function(){var n=m.value,e=v;if(t){var r=Lu(1+~c,c).filter((function(t){return t<0?a[~t*c+n]:a[n*c+t]}));i&&r.sort((function(t,e){return i(t<0?-a[~t*c+n]:a[n*c+t],e<0?-a[~e*c+n]:a[n*c+e])}));var o,f=Du(r);try{for(f.s();!(o=f.n()).done;){var p=o.value;if(p<0)(l[~p*c+n]||(l[~p*c+n]={source:null,target:null})).target={index:n,startAngle:v,endAngle:v+=a[~p*c+n]*d,value:a[~p*c+n]};else(l[n*c+p]||(l[n*c+p]={source:null,target:null})).source={index:n,startAngle:v,endAngle:v+=a[n*c+p]*d,value:a[n*c+p]}}}catch(t){f.e(t)}finally{f.f()}h[n]={index:n,startAngle:e,endAngle:v,value:s[n]}}else{var y=Lu(0,c).filter((function(t){return a[n*c+t]||a[t*c+n]}));i&&y.sort((function(t,e){return i(a[n*c+t],a[n*c+e])}));var g,b=Du(y);try{for(b.s();!(g=b.n()).done;){var x=g.value,_=void 0;if(n<x?(_=l[n*c+x]||(l[n*c+x]={source:null,target:null})).source={index:n,startAngle:v,endAngle:v+=a[n*c+x]*d,value:a[n*c+x]}:((_=l[x*c+n]||(l[x*c+n]={source:null,target:null})).target={index:n,startAngle:v,endAngle:v+=a[n*c+x]*d,value:a[n*c+x]},n===x&&(_.source=_.target)),_.source&&_.target&&_.source.value<_.target.value){var w=_.source;_.source=_.target,_.target=w}}}catch(t){b.e(t)}finally{b.f()}h[n]={index:n,startAngle:e,endAngle:v,value:s[n]}}v+=u};for(b.s();!(m=b.n()).done;)x()}catch(t){b.e(t)}finally{b.f()}return(l=Object.values(l)).groups=h,o?l.sort(o):l}return a.padAngle=function(t){return arguments.length?(e=zu(0,t),a):e},a.sortGroups=function(t){return arguments.length?(r=t,a):r},a.sortSubgroups=function(t){return arguments.length?(i=t,a):i},a.sortChords=function(t){return arguments.length?(null==t?o=null:(o=Uu(t))._=t,a):o&&o._},a}var Yu=Math.PI,Xu=2*Yu,$u=1e-6,Wu=Xu-$u;function Gu(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function Qu(){return new Gu}Gu.prototype=Qu.prototype={constructor:Gu,moveTo:function(t,n){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+n)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,n){this._+="L"+(this._x1=+t)+","+(this._y1=+n)},quadraticCurveTo:function(t,n,e,r){this._+="Q"+ +t+","+ +n+","+(this._x1=+e)+","+(this._y1=+r)},bezierCurveTo:function(t,n,e,r,i,o){this._+="C"+ +t+","+ +n+","+ +e+","+ +r+","+(this._x1=+i)+","+(this._y1=+o)},arcTo:function(t,n,e,r,i){t=+t,n=+n,e=+e,r=+r,i=+i;var o=this._x1,a=this._y1,u=e-t,c=r-n,s=o-t,f=a-n,l=s*s+f*f;if(i<0)throw new Error("negative radius: "+i);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=n);else if(l>$u)if(Math.abs(f*u-c*s)>$u&&i){var h=e-o,d=r-a,p=u*u+c*c,y=h*h+d*d,g=Math.sqrt(p),v=Math.sqrt(l),m=i*Math.tan((Yu-Math.acos((p+l-y)/(2*g*v)))/2),b=m/v,x=m/g;Math.abs(b-1)>$u&&(this._+="L"+(t+b*s)+","+(n+b*f)),this._+="A"+i+","+i+",0,0,"+ +(f*h>s*d)+","+(this._x1=t+x*u)+","+(this._y1=n+x*c)}else this._+="L"+(this._x1=t)+","+(this._y1=n);else;},arc:function(t,n,e,r,i,o){t=+t,n=+n,o=!!o;var a=(e=+e)*Math.cos(r),u=e*Math.sin(r),c=t+a,s=n+u,f=1^o,l=o?r-i:i-r;if(e<0)throw new Error("negative radius: "+e);null===this._x1?this._+="M"+c+","+s:(Math.abs(this._x1-c)>$u||Math.abs(this._y1-s)>$u)&&(this._+="L"+c+","+s),e&&(l<0&&(l=l%Xu+Xu),l>Wu?this._+="A"+e+","+e+",0,1,"+f+","+(t-a)+","+(n-u)+"A"+e+","+e+",0,1,"+f+","+(this._x1=c)+","+(this._y1=s):l>$u&&(this._+="A"+e+","+e+",0,"+ +(l>=Yu)+","+f+","+(this._x1=t+e*Math.cos(i))+","+(this._y1=n+e*Math.sin(i))))},rect:function(t,n,e,r){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+n)+"h"+ +e+"v"+ +r+"h"+-e+"Z"},toString:function(){return this._}};var Zu=Qu,Ku=Array.prototype.slice;function Ju(t){return function(){return t}}function tc(t){return t.source}function nc(t){return t.target}function ec(t){return t.radius}function rc(t){return t.startAngle}function ic(t){return t.endAngle}function oc(){return 0}function ac(){return 10}function uc(t){var n=tc,e=nc,r=ec,i=ec,o=rc,a=ic,u=oc,c=null;function s(){var s,f=n.apply(this,arguments),l=e.apply(this,arguments),h=u.apply(this,arguments)/2,d=Ku.call(arguments),p=+r.apply(this,(d[0]=f,d)),y=o.apply(this,d)-Iu,g=a.apply(this,d)-Iu,v=+i.apply(this,(d[0]=l,d)),m=o.apply(this,d)-Iu,b=a.apply(this,d)-Iu;if(c||(c=s=Zu()),h>Vu&&(ku(g-y)>2*h+Vu?g>y?(y+=h,g-=h):(y-=h,g+=h):y=g=(y+g)/2,ku(b-m)>2*h+Vu?b>m?(m+=h,b-=h):(m-=h,b+=h):m=b=(m+b)/2),c.moveTo(p*Nu(y),p*Ou(y)),c.arc(0,0,p,y,g),y!==m||g!==b)if(t){var x=+t.apply(this,arguments),_=v-x,w=(m+b)/2;c.quadraticCurveTo(0,0,_*Nu(m),_*Ou(m)),c.lineTo(v*Nu(w),v*Ou(w)),c.lineTo(_*Nu(b),_*Ou(b))}else c.quadraticCurveTo(0,0,v*Nu(m),v*Ou(m)),c.arc(0,0,v,m,b);if(c.quadraticCurveTo(0,0,p*Nu(y),p*Ou(y)),c.closePath(),s)return c=null,s+""||null}return t&&(s.headRadius=function(n){return arguments.length?(t="function"==typeof n?n:Ju(+n),s):t}),s.radius=function(t){return arguments.length?(r=i="function"==typeof t?t:Ju(+t),s):r},s.sourceRadius=function(t){return arguments.length?(r="function"==typeof t?t:Ju(+t),s):r},s.targetRadius=function(t){return arguments.length?(i="function"==typeof t?t:Ju(+t),s):i},s.startAngle=function(t){return arguments.length?(o="function"==typeof t?t:Ju(+t),s):o},s.endAngle=function(t){return arguments.length?(a="function"==typeof t?t:Ju(+t),s):a},s.padAngle=function(t){return arguments.length?(u="function"==typeof t?t:Ju(+t),s):u},s.source=function(t){return arguments.length?(n=t,s):n},s.target=function(t){return arguments.length?(e=t,s):e},s.context=function(t){return arguments.length?(c=null==t?null:t,s):c},s}function cc(){return uc()}function sc(){return uc(ac)}var fc=Math.PI/180,lc=180/Math.PI,hc=.96422,dc=.82521,pc=4/29,yc=6/29,gc=3*yc*yc;function vc(t){if(t instanceof xc)return new xc(t.l,t.a,t.b,t.opacity);if(t instanceof Cc)return kc(t);t instanceof Wi||(t=Xi(t));var n,e,r=Sc(t.r),i=Sc(t.g),o=Sc(t.b),a=_c((.2225045*r+.7168786*i+.0606169*o)/1);return r===i&&i===o?n=e=a:(n=_c((.4360747*r+.3850649*i+.1430804*o)/hc),e=_c((.0139322*r+.0971045*i+.7141733*o)/dc)),new xc(116*a-16,500*(n-a),200*(a-e),t.opacity)}function mc(t,n){return new xc(t,0,0,null==n?1:n)}function bc(t,n,e,r){return 1===arguments.length?vc(t):new xc(t,n,e,null==r?1:r)}function xc(t,n,e,r){this.l=+t,this.a=+n,this.b=+e,this.opacity=+r}function _c(t){return t>.008856451679035631?Math.pow(t,1/3):t/gc+pc}function wc(t){return t>yc?t*t*t:gc*(t-pc)}function Ac(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function Sc(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Mc(t){if(t instanceof Cc)return new Cc(t.h,t.c,t.l,t.opacity);if(t instanceof xc||(t=vc(t)),0===t.a&&0===t.b)return new Cc(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var n=Math.atan2(t.b,t.a)*lc;return new Cc(n<0?n+360:n,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function Tc(t,n,e,r){return 1===arguments.length?Mc(t):new Cc(e,n,t,null==r?1:r)}function Ec(t,n,e,r){return 1===arguments.length?Mc(t):new Cc(t,n,e,null==r?1:r)}function Cc(t,n,e,r){this.h=+t,this.c=+n,this.l=+e,this.opacity=+r}function kc(t){if(isNaN(t.h))return new xc(t.l,0,0,t.opacity);var n=t.h*fc;return new xc(t.l,Math.cos(n)*t.c,Math.sin(n)*t.c,t.opacity)}Mi(xc,bc,Ti(Ei,{brighter:function(t){return new xc(this.l+18*(null==t?1:t),this.a,this.b,this.opacity)},darker:function(t){return new xc(this.l-18*(null==t?1:t),this.a,this.b,this.opacity)},rgb:function(){var t=(this.l+16)/116,n=isNaN(this.a)?t:t+this.a/500,e=isNaN(this.b)?t:t-this.b/200;return new Wi(Ac(3.1338561*(n=hc*wc(n))-1.6168667*(t=1*wc(t))-.4906146*(e=dc*wc(e))),Ac(-.9787684*n+1.9161415*t+.033454*e),Ac(.0719453*n-.2289914*t+1.4052427*e),this.opacity)}})),Mi(Cc,Ec,Ti(Ei,{brighter:function(t){return new Cc(this.h,this.c,this.l+18*(null==t?1:t),this.opacity)},darker:function(t){return new Cc(this.h,this.c,this.l-18*(null==t?1:t),this.opacity)},rgb:function(){return kc(this).rgb()}}));var Nc=-.14861,Oc=1.78277,Pc=-.29227,Ic=-.90649,Rc=1.97294,zc=Rc*Ic,Vc=Rc*Oc,Dc=Oc*Pc-Ic*Nc;function jc(t){if(t instanceof Uc)return new Uc(t.h,t.s,t.l,t.opacity);t instanceof Wi||(t=Xi(t));var n=t.r/255,e=t.g/255,r=t.b/255,i=(Dc*r+zc*n-Vc*e)/(Dc+zc-Vc),o=r-i,a=(Rc*(e-i)-Pc*o)/Ic,u=Math.sqrt(a*a+o*o)/(Rc*i*(1-i)),c=u?Math.atan2(a,o)*lc-120:NaN;return new Uc(c<0?c+360:c,u,i,t.opacity)}function Lc(t,n,e,r){return 1===arguments.length?jc(t):new Uc(t,n,e,null==r?1:r)}function Uc(t,n,e,r){this.h=+t,this.s=+n,this.l=+e,this.opacity=+r}Mi(Uc,Lc,Ti(Ei,{brighter:function(t){return t=null==t?ki:Math.pow(ki,t),new Uc(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?Ci:Math.pow(Ci,t),new Uc(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=isNaN(this.h)?0:(this.h+120)*fc,n=+this.l,e=isNaN(this.s)?0:this.s*n*(1-n),r=Math.cos(t),i=Math.sin(t);return new Wi(255*(n+e*(Nc*r+Oc*i)),255*(n+e*(Pc*r+Ic*i)),255*(n+e*(Rc*r)),this.opacity)}}));var Bc=Array.prototype.slice;function Fc(t,n){return t-n}var qc=function(t){return function(){return t}};function Hc(t,n){for(var e,r=-1,i=n.length;++r<i;)if(e=Yc(t,n[r]))return e;return 0}function Yc(t,n){for(var e=n[0],r=n[1],i=-1,o=0,a=t.length,u=a-1;o<a;u=o++){var c=t[o],s=c[0],f=c[1],l=t[u],h=l[0],d=l[1];if(Xc(c,l,n))return 0;f>r!=d>r&&e<(h-s)*(r-f)/(d-f)+s&&(i=-i)}return i}function Xc(t,n,e){var r,i,o,a;return function(t,n,e){return(n[0]-t[0])*(e[1]-t[1])==(e[0]-t[0])*(n[1]-t[1])}(t,n,e)&&(i=t[r=+(t[0]===n[0])],o=e[r],a=n[r],i<=o&&o<=a||a<=o&&o<=i)}function $c(){}var Wc=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function Gc(){var t=1,n=1,e=Gt,r=u;function i(t){var n=e(t);if(Array.isArray(n))n=n.slice().sort(Fc);else{var r=z(t),i=$t(r[0],r[1],n);n=Yt(Math.floor(r[0]/i)*i,Math.floor(r[1]/i-1)*i,n)}return n.map((function(n){return o(t,n)}))}function o(e,i){var o=[],u=[];return function(e,r,i){var o,u,c,s,f,l,h=new Array,d=new Array;o=u=-1,s=e[0]>=r,Wc[s<<1].forEach(p);for(;++o<t-1;)c=s,s=e[o+1]>=r,Wc[c|s<<1].forEach(p);Wc[s<<0].forEach(p);for(;++u<n-1;){for(o=-1,s=e[u*t+t]>=r,f=e[u*t]>=r,Wc[s<<1|f<<2].forEach(p);++o<t-1;)c=s,s=e[u*t+t+o+1]>=r,l=f,f=e[u*t+o+1]>=r,Wc[c|s<<1|f<<2|l<<3].forEach(p);Wc[s|f<<3].forEach(p)}o=-1,f=e[u*t]>=r,Wc[f<<2].forEach(p);for(;++o<t-1;)l=f,f=e[u*t+o+1]>=r,Wc[f<<2|l<<3].forEach(p);function p(t){var n,e,r=[t[0][0]+o,t[0][1]+u],c=[t[1][0]+o,t[1][1]+u],s=a(r),f=a(c);(n=d[s])?(e=h[f])?(delete d[n.end],delete h[e.start],n===e?(n.ring.push(c),i(n.ring)):h[n.start]=d[e.end]={start:n.start,end:e.end,ring:n.ring.concat(e.ring)}):(delete d[n.end],n.ring.push(c),d[n.end=f]=n):(n=h[f])?(e=d[s])?(delete h[n.start],delete d[e.end],n===e?(n.ring.push(c),i(n.ring)):h[e.start]=d[n.end]={start:e.start,end:n.end,ring:e.ring.concat(n.ring)}):(delete h[n.start],n.ring.unshift(r),h[n.start=s]=n):h[s]=d[f]={start:s,end:f,ring:[r,c]}}Wc[f<<3].forEach(p)}(e,i,(function(t){r(t,e,i),function(t){for(var n=0,e=t.length,r=t[e-1][1]*t[0][0]-t[e-1][0]*t[0][1];++n<e;)r+=t[n-1][1]*t[n][0]-t[n-1][0]*t[n][1];return r}(t)>0?o.push([t]):u.push(t)})),u.forEach((function(t){for(var n,e=0,r=o.length;e<r;++e)if(-1!==Hc((n=o[e])[0],t))return void n.push(t)})),{type:"MultiPolygon",value:i,coordinates:o}}function a(n){return 2*n[0]+n[1]*(t+1)*4}function u(e,r,i){e.forEach((function(e){var o,a=e[0],u=e[1],c=0|a,s=0|u,f=r[s*t+c];a>0&&a<t&&c===a&&(o=r[s*t+c-1],e[0]=a+(i-o)/(f-o)-.5),u>0&&u<n&&s===u&&(o=r[(s-1)*t+c],e[1]=u+(i-o)/(f-o)-.5)}))}return i.contour=o,i.size=function(e){if(!arguments.length)return[t,n];var r=Math.floor(e[0]),o=Math.floor(e[1]);if(!(r>=0&&o>=0))throw new Error("invalid size");return t=r,n=o,i},i.thresholds=function(t){return arguments.length?(e="function"==typeof t?t:Array.isArray(t)?qc(Bc.call(t)):qc(t),i):e},i.smooth=function(t){return arguments.length?(r=t?u:$c,i):r===u},i}function Qc(t,n,e){for(var r=t.width,i=t.height,o=1+(e<<1),a=0;a<i;++a)for(var u=0,c=0;u<r+e;++u)u<r&&(c+=t.data[u+a*r]),u>=e&&(u>=o&&(c-=t.data[u-o+a*r]),n.data[u-e+a*r]=c/Math.min(u+1,r-1+o-u,o))}function Zc(t,n,e){for(var r=t.width,i=t.height,o=1+(e<<1),a=0;a<r;++a)for(var u=0,c=0;u<i+e;++u)u<i&&(c+=t.data[a+u*r]),u>=e&&(u>=o&&(c-=t.data[a+(u-o)*r]),n.data[a+(u-e)*r]=c/Math.min(u+1,i-1+o-u,o))}function Kc(t){return t[0]}function Jc(t){return t[1]}function ts(){return 1}function ns(){var t=Kc,n=Jc,e=ts,r=960,i=500,o=20,a=2,u=3*o,c=r+2*u>>a,s=i+2*u>>a,f=qc(20);function l(r){var i=new Float32Array(c*s),l=new Float32Array(c*s),d=Math.pow(2,-a);r.forEach((function(r,o,a){var f=(t(r,o,a)+u)*d,l=(n(r,o,a)+u)*d,h=+e(r,o,a);if(f>=0&&f<c&&l>=0&&l<s){var p=Math.floor(f),y=Math.floor(l),g=f-p-.5,v=l-y-.5;i[p+y*c]+=(1-g)*(1-v)*h,i[p+1+y*c]+=g*(1-v)*h,i[p+1+(y+1)*c]+=g*v*h,i[p+(y+1)*c]+=(1-g)*v*h}})),Qc({width:c,height:s,data:i},{width:c,height:s,data:l},o>>a),Zc({width:c,height:s,data:l},{width:c,height:s,data:i},o>>a),Qc({width:c,height:s,data:i},{width:c,height:s,data:l},o>>a),Zc({width:c,height:s,data:l},{width:c,height:s,data:i},o>>a),Qc({width:c,height:s,data:i},{width:c,height:s,data:l},o>>a),Zc({width:c,height:s,data:l},{width:c,height:s,data:i},o>>a);var p=f(i);if(!Array.isArray(p)){var y=nn(i);p=$t(0,y,p),(p=Vn(0,Math.floor(y/p)*p,p)).shift()}return Gc().thresholds(p).size([c,s])(i).map(h)}function h(t){return t.value*=Math.pow(2,-2*a),t.coordinates.forEach(d),t}function d(t){t.forEach(p)}function p(t){t.forEach(y)}function y(t){t[0]=t[0]*Math.pow(2,a)-u,t[1]=t[1]*Math.pow(2,a)-u}function g(){return c=r+2*(u=3*o)>>a,s=i+2*u>>a,l}return l.x=function(n){return arguments.length?(t="function"==typeof n?n:qc(+n),l):t},l.y=function(t){return arguments.length?(n="function"==typeof t?t:qc(+t),l):n},l.weight=function(t){return arguments.length?(e="function"==typeof t?t:qc(+t),l):e},l.size=function(t){if(!arguments.length)return[r,i];var n=+t[0],e=+t[1];if(!(n>=0&&e>=0))throw new Error("invalid size");return r=n,i=e,g()},l.cellSize=function(t){if(!arguments.length)return 1<<a;if(!((t=+t)>=1))throw new Error("invalid cell size");return a=Math.floor(Math.log(t)/Math.LN2),g()},l.thresholds=function(t){return arguments.length?(f="function"==typeof t?t:Array.isArray(t)?qc(Bc.call(t)):qc(t),l):f},l.bandwidth=function(t){if(!arguments.length)return Math.sqrt(o*(o+1));if(!((t=+t)>=0))throw new Error("invalid bandwidth");return o=Math.round((Math.sqrt(4*t*t+1)-1)/2),g()},l}const es=134217729,rs=33306690738754706e-32;function is(t,n,e,r,i){let o,a,u,c,s=n[0],f=r[0],l=0,h=0;f>s==f>-s?(o=s,s=n[++l]):(o=f,f=r[++h]);let d=0;if(l<t&&h<e)for(f>s==f>-s?(a=s+o,u=o-(a-s),s=n[++l]):(a=f+o,u=o-(a-f),f=r[++h]),o=a,0!==u&&(i[d++]=u);l<t&&h<e;)f>s==f>-s?(a=o+s,c=a-o,u=o-(a-c)+(s-c),s=n[++l]):(a=o+f,c=a-o,u=o-(a-c)+(f-c),f=r[++h]),o=a,0!==u&&(i[d++]=u);for(;l<t;)a=o+s,c=a-o,u=o-(a-c)+(s-c),s=n[++l],o=a,0!==u&&(i[d++]=u);for(;h<e;)a=o+f,c=a-o,u=o-(a-c)+(f-c),f=r[++h],o=a,0!==u&&(i[d++]=u);return 0===o&&0!==d||(i[d++]=o),d}function os(t,n){let e=n[0];for(let r=1;r<t;r++)e+=n[r];return e}function as(t){return new Float64Array(t)}const us=as(4),cs=as(8),ss=as(12),fs=as(16),ls=as(4);function hs(t,n,e,r,i,o){const a=(n-o)*(e-i),u=(t-i)*(r-o),c=a-u;if(0===a||0===u||a>0!=u>0)return c;const s=Math.abs(a+u);return Math.abs(c)>=33306690738754716e-32*s?c:-function(t,n,e,r,i,o,a){let u,c,s,f,l,h,d,p,y,g,v,m,b,x,_,w,A,S;const M=t-i,T=e-i,E=n-o,C=r-o;x=M*C,h=es*M,d=h-(h-M),p=M-d,h=es*C,y=h-(h-C),g=C-y,_=p*g-(x-d*y-p*y-d*g),w=E*T,h=es*E,d=h-(h-E),p=E-d,h=es*T,y=h-(h-T),g=T-y,A=p*g-(w-d*y-p*y-d*g),v=_-A,l=_-v,us[0]=_-(v+l)+(l-A),m=x+v,l=m-x,b=x-(m-l)+(v-l),v=b-w,l=b-v,us[1]=b-(v+l)+(l-w),S=m+v,l=S-m,us[2]=m-(S-l)+(v-l),us[3]=S;let k=os(4,us),N=22204460492503146e-32*a;if(k>=N||-k>=N)return k;if(l=t-M,u=t-(M+l)+(l-i),l=e-T,s=e-(T+l)+(l-i),l=n-E,c=n-(E+l)+(l-o),l=r-C,f=r-(C+l)+(l-o),0===u&&0===c&&0===s&&0===f)return k;if(N=11093356479670487e-47*a+rs*Math.abs(k),k+=M*f+C*u-(E*s+T*c),k>=N||-k>=N)return k;x=u*C,h=es*u,d=h-(h-u),p=u-d,h=es*C,y=h-(h-C),g=C-y,_=p*g-(x-d*y-p*y-d*g),w=c*T,h=es*c,d=h-(h-c),p=c-d,h=es*T,y=h-(h-T),g=T-y,A=p*g-(w-d*y-p*y-d*g),v=_-A,l=_-v,ls[0]=_-(v+l)+(l-A),m=x+v,l=m-x,b=x-(m-l)+(v-l),v=b-w,l=b-v,ls[1]=b-(v+l)+(l-w),S=m+v,l=S-m,ls[2]=m-(S-l)+(v-l),ls[3]=S;const O=is(4,us,4,ls,cs);x=M*f,h=es*M,d=h-(h-M),p=M-d,h=es*f,y=h-(h-f),g=f-y,_=p*g-(x-d*y-p*y-d*g),w=E*s,h=es*E,d=h-(h-E),p=E-d,h=es*s,y=h-(h-s),g=s-y,A=p*g-(w-d*y-p*y-d*g),v=_-A,l=_-v,ls[0]=_-(v+l)+(l-A),m=x+v,l=m-x,b=x-(m-l)+(v-l),v=b-w,l=b-v,ls[1]=b-(v+l)+(l-w),S=m+v,l=S-m,ls[2]=m-(S-l)+(v-l),ls[3]=S;const P=is(O,cs,4,ls,ss);x=u*f,h=es*u,d=h-(h-u),p=u-d,h=es*f,y=h-(h-f),g=f-y,_=p*g-(x-d*y-p*y-d*g),w=c*s,h=es*c,d=h-(h-c),p=c-d,h=es*s,y=h-(h-s),g=s-y,A=p*g-(w-d*y-p*y-d*g),v=_-A,l=_-v,ls[0]=_-(v+l)+(l-A),m=x+v,l=m-x,b=x-(m-l)+(v-l),v=b-w,l=b-v,ls[1]=b-(v+l)+(l-w),S=m+v,l=S-m,ls[2]=m-(S-l)+(v-l),ls[3]=S;const I=is(P,ss,4,ls,fs);return fs[I-1]}(t,n,e,r,i,o,s)}as(4),as(4),as(4),as(4),as(4),as(4),as(4),as(4),as(4),as(8),as(8),as(8),as(4),as(8),as(8),as(8),as(12);as(192),as(192);as(4),as(4),as(4),as(4),as(4),as(4),as(4),as(4),as(8),as(8),as(8),as(8),as(8),as(8),as(8),as(8),as(8),as(4),as(4),as(4),as(8),as(16),as(16),as(16),as(32),as(32),as(48),as(64);as(1152),as(1152);as(4),as(4),as(4),as(4),as(4),as(4),as(4),as(4),as(4),as(4),as(24),as(24),as(24),as(24),as(24),as(24),as(24),as(24),as(24),as(24),as(1152),as(1152),as(1152),as(1152),as(1152),as(2304),as(2304),as(3456),as(5760),as(8),as(8),as(8),as(16),as(24),as(48),as(48),as(96),as(192),as(384),as(384),as(384),as(768);as(96),as(96),as(96),as(1152);function ds(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ps=Math.pow(2,-52),ys=new Uint32Array(512),gs=function(){function t(n){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t);var e=n.length>>1;if(e>0&&"number"!=typeof n[0])throw new Error("Expected coords to contain numbers.");this.coords=n;var r=Math.max(2*e-5,0);this._triangles=new Uint32Array(3*r),this._halfedges=new Int32Array(3*r),this._hashSize=Math.ceil(Math.sqrt(e)),this._hullPrev=new Uint32Array(e),this._hullNext=new Uint32Array(e),this._hullTri=new Uint32Array(e),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(e),this._dists=new Float64Array(e),this.update()}var n,e,r;return n=t,r=[{key:"from",value:function(n){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:_s,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ws,i=n.length,o=new Float64Array(2*i),a=0;a<i;a++){var u=n[a];o[2*a]=e(u),o[2*a+1]=r(u)}return new t(o)}}],(e=[{key:"update",value:function(){for(var t=this.coords,n=this._hullPrev,e=this._hullNext,r=this._hullTri,i=this._hullHash,o=t.length>>1,a=1/0,u=1/0,c=-1/0,s=-1/0,f=0;f<o;f++){var l=t[2*f],h=t[2*f+1];l<a&&(a=l),h<u&&(u=h),l>c&&(c=l),h>s&&(s=h),this._ids[f]=f}for(var d,p,y,g=(a+c)/2,v=(u+s)/2,m=1/0,b=0;b<o;b++){var x=vs(g,v,t[2*b],t[2*b+1]);x<m&&(d=b,m=x)}var _=t[2*d],w=t[2*d+1];m=1/0;for(var A=0;A<o;A++)if(A!==d){var S=vs(_,w,t[2*A],t[2*A+1]);S<m&&S>0&&(p=A,m=S)}for(var M=t[2*p],T=t[2*p+1],E=1/0,C=0;C<o;C++)if(C!==d&&C!==p){var k=ms(_,w,M,T,t[2*C],t[2*C+1]);k<E&&(y=C,E=k)}var N=t[2*y],O=t[2*y+1];if(E===1/0){for(var P=0;P<o;P++)this._dists[P]=t[2*P]-t[0]||t[2*P+1]-t[1];bs(this._ids,this._dists,0,o-1);for(var I=new Uint32Array(o),R=0,z=0,V=-1/0;z<o;z++){var D=this._ids[z];this._dists[D]>V&&(I[R++]=D,V=this._dists[D])}return this.hull=I.subarray(0,R),this.triangles=new Uint32Array(0),void(this.halfedges=new Uint32Array(0))}if(hs(_,w,M,T,N,O)<0){var j=p,L=M,U=T;p=y,M=N,T=O,y=j,N=L,O=U}var B=function(t,n,e,r,i,o){var a=e-t,u=r-n,c=i-t,s=o-n,f=a*a+u*u,l=c*c+s*s,h=.5/(a*s-u*c);return{x:t+(s*f-u*l)*h,y:n+(a*l-c*f)*h}}(_,w,M,T,N,O);this._cx=B.x,this._cy=B.y;for(var F=0;F<o;F++)this._dists[F]=vs(t[2*F],t[2*F+1],B.x,B.y);bs(this._ids,this._dists,0,o-1),this._hullStart=d;var q=3;e[d]=n[y]=p,e[p]=n[d]=y,e[y]=n[p]=d,r[d]=0,r[p]=1,r[y]=2,i.fill(-1),i[this._hashKey(_,w)]=d,i[this._hashKey(M,T)]=p,i[this._hashKey(N,O)]=y,this.trianglesLen=0,this._addTriangle(d,p,y,-1,-1,-1);for(var H,Y,X=0;X<this._ids.length;X++){var $=this._ids[X],W=t[2*$],G=t[2*$+1];if(!(X>0&&Math.abs(W-H)<=ps&&Math.abs(G-Y)<=ps)&&(H=W,Y=G,$!==d&&$!==p&&$!==y)){for(var Q=0,Z=0,K=this._hashKey(W,G);Z<this._hashSize&&(-1===(Q=i[(K+Z)%this._hashSize])||Q===e[Q]);Z++);for(var J=Q=n[Q],tt=void 0;tt=e[J],hs(W,G,t[2*J],t[2*J+1],t[2*tt],t[2*tt+1])>=0;)if((J=tt)===Q){J=-1;break}if(-1!==J){var nt=this._addTriangle(J,$,e[J],-1,-1,r[J]);r[$]=this._legalize(nt+2),r[J]=nt,q++;for(var et=e[J];tt=e[et],hs(W,G,t[2*et],t[2*et+1],t[2*tt],t[2*tt+1])<0;)nt=this._addTriangle(et,$,tt,r[$],-1,r[et]),r[$]=this._legalize(nt+2),e[et]=et,q--,et=tt;if(J===Q)for(;hs(W,G,t[2*(tt=n[J])],t[2*tt+1],t[2*J],t[2*J+1])<0;)nt=this._addTriangle(tt,$,J,-1,r[J],r[tt]),this._legalize(nt+2),r[tt]=nt,e[J]=J,q--,J=tt;this._hullStart=n[$]=J,e[J]=n[et]=$,e[$]=et,i[this._hashKey(W,G)]=$,i[this._hashKey(t[2*J],t[2*J+1])]=J}}}this.hull=new Uint32Array(q);for(var rt=0,it=this._hullStart;rt<q;rt++)this.hull[rt]=it,it=e[it];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}},{key:"_hashKey",value:function(t,n){return Math.floor((e=t-this._cx,r=n-this._cy,i=e/(Math.abs(e)+Math.abs(r)),(r>0?3-i:1+i)/4*this._hashSize))%this._hashSize;var e,r,i}},{key:"_legalize",value:function(t){for(var n,e,r,i,o,a,u,c,s,f,l,h,d,p,y,g,v=this._triangles,m=this._halfedges,b=this.coords,x=0,_=0;;){var w=m[t],A=t-t%3;if(_=A+(t+2)%3,-1!==w){var S=w-w%3,M=A+(t+1)%3,T=S+(w+2)%3,E=v[_],C=v[t],k=v[M],N=v[T];if(n=b[2*E],e=b[2*E+1],r=b[2*C],i=b[2*C+1],o=b[2*k],a=b[2*k+1],u=b[2*N],c=b[2*N+1],s=void 0,f=void 0,l=void 0,h=void 0,d=void 0,p=void 0,y=void 0,g=void 0,(s=n-u)*((h=i-c)*(g=(d=o-u)*d+(p=a-c)*p)-(y=(l=r-u)*l+h*h)*p)-(f=e-c)*(l*g-y*d)+(s*s+f*f)*(l*p-h*d)<0){v[t]=N,v[w]=E;var O=m[T];if(-1===O){var P=this._hullStart;do{if(this._hullTri[P]===T){this._hullTri[P]=t;break}P=this._hullPrev[P]}while(P!==this._hullStart)}this._link(t,O),this._link(w,m[_]),this._link(_,T);var I=S+(w+1)%3;x<ys.length&&(ys[x++]=I)}else{if(0===x)break;t=ys[--x]}}else{if(0===x)break;t=ys[--x]}}return _}},{key:"_link",value:function(t,n){this._halfedges[t]=n,-1!==n&&(this._halfedges[n]=t)}},{key:"_addTriangle",value:function(t,n,e,r,i,o){var a=this.trianglesLen;return this._triangles[a]=t,this._triangles[a+1]=n,this._triangles[a+2]=e,this._link(a,r),this._link(a+1,i),this._link(a+2,o),this.trianglesLen+=3,a}}])&&ds(n.prototype,e),r&&ds(n,r),Object.defineProperty(n,"prototype",{writable:!1}),t}();function vs(t,n,e,r){var i=t-e,o=n-r;return i*i+o*o}function ms(t,n,e,r,i,o){var a=e-t,u=r-n,c=i-t,s=o-n,f=a*a+u*u,l=c*c+s*s,h=.5/(a*s-u*c),d=(s*f-u*l)*h,p=(a*l-c*f)*h;return d*d+p*p}function bs(t,n,e,r){if(r-e<=20)for(var i=e+1;i<=r;i++){for(var o=t[i],a=n[o],u=i-1;u>=e&&n[t[u]]>a;)t[u+1]=t[u--];t[u+1]=o}else{var c=e+1,s=r;xs(t,e+r>>1,c),n[t[e]]>n[t[r]]&&xs(t,e,r),n[t[c]]>n[t[r]]&&xs(t,c,r),n[t[e]]>n[t[c]]&&xs(t,e,c);for(var f=t[c],l=n[f];;){do{c++}while(n[t[c]]<l);do{s--}while(n[t[s]]>l);if(s<c)break;xs(t,c,s)}t[e+1]=t[s],t[s]=f,r-c+1>=s-e?(bs(t,n,c,r),bs(t,n,e,s-1)):(bs(t,n,e,s-1),bs(t,n,c,r))}}function xs(t,n,e){var r=t[n];t[n]=t[e],t[e]=r}function _s(t){return t[0]}function ws(t){return t[1]}function As(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ss=1e-6,Ms=function(){function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this._x0=this._y0=this._x1=this._y1=null,this._=""}var n,e,r;return n=t,(e=[{key:"moveTo",value:function(t,n){this._+="M".concat(this._x0=this._x1=+t,",").concat(this._y0=this._y1=+n)}},{key:"closePath",value:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}},{key:"lineTo",value:function(t,n){this._+="L".concat(this._x1=+t,",").concat(this._y1=+n)}},{key:"arc",value:function(t,n,e){var r=(t=+t)+(e=+e),i=n=+n;if(e<0)throw new Error("negative radius");null===this._x1?this._+="M".concat(r,",").concat(i):(Math.abs(this._x1-r)>Ss||Math.abs(this._y1-i)>Ss)&&(this._+="L"+r+","+i),e&&(this._+="A".concat(e,",").concat(e,",0,1,1,").concat(t-e,",").concat(n,"A").concat(e,",").concat(e,",0,1,1,").concat(this._x1=r,",").concat(this._y1=i))}},{key:"rect",value:function(t,n,e,r){this._+="M".concat(this._x0=this._x1=+t,",").concat(this._y0=this._y1=+n,"h").concat(+e,"v").concat(+r,"h").concat(-e,"Z")}},{key:"value",value:function(){return this._||null}}])&&As(n.prototype,e),r&&As(n,r),Object.defineProperty(n,"prototype",{writable:!1}),t}();function Ts(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Es=function(){function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this._=[]}var n,e,r;return n=t,(e=[{key:"moveTo",value:function(t,n){this._.push([t,n])}},{key:"closePath",value:function(){this._.push(this._[0].slice())}},{key:"lineTo",value:function(t,n){this._.push([t,n])}},{key:"value",value:function(){return this._.length?this._:null}}])&&Ts(n.prototype,e),r&&Ts(n,r),Object.defineProperty(n,"prototype",{writable:!1}),t}();function Cs(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=Ns(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function ks(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==e)return;var r,i,o=[],a=!0,u=!1;try{for(e=e.call(t);!(a=(r=e.next()).done)&&(o.push(r.value),!n||o.length!==n);a=!0);}catch(t){u=!0,i=t}finally{try{a||null==e.return||e.return()}finally{if(u)throw i}}return o}(t,n)||Ns(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ns(t,n){if(t){if("string"==typeof t)return Os(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?Os(t,n):void 0}}function Os(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function Ps(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function Is(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Rs=function(){function t(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,960,500],r=ks(e,4),i=r[0],o=r[1],a=r[2],u=r[3];if(Ps(this,t),!((a=+a)>=(i=+i)&&(u=+u)>=(o=+o)))throw new Error("invalid bounds");this.delaunay=n,this._circumcenters=new Float64Array(2*n.points.length),this.vectors=new Float64Array(2*n.points.length),this.xmax=a,this.xmin=i,this.ymax=u,this.ymin=o,this._init()}var n,e,r;return n=t,(e=[{key:"update",value:function(){return this.delaunay.update(),this._init(),this}},{key:"_init",value:function(){for(var t,n,e=this.delaunay,r=e.points,i=e.hull,o=e.triangles,a=this.vectors,u=this.circumcenters=this._circumcenters.subarray(0,o.length/3*2),c=0,s=0,f=o.length;c<f;c+=3,s+=2){var l=2*o[c],h=2*o[c+1],d=2*o[c+2],p=r[l],y=r[l+1],g=r[h],v=r[h+1],m=r[d],b=r[d+1],x=g-p,_=v-y,w=m-p,A=b-y,S=2*(x*A-_*w);if(Math.abs(S)<1e-9){var M=1e9,T=2*o[0];t=(p+m)/2-(M*=Math.sign((r[T]-p)*A-(r[T+1]-y)*w))*A,n=(y+b)/2+M*w}else{var E=1/S,C=x*x+_*_,k=w*w+A*A;t=p+(A*C-_*k)*E,n=y+(x*k-w*C)*E}u[s]=t,u[s+1]=n}var N,O,P,I=i[i.length-1],R=4*I,z=r[2*I],V=r[2*I+1];a.fill(0);for(var D=0;D<i.length;++D)N=R,O=z,P=V,R=4*(I=i[D]),z=r[2*I],V=r[2*I+1],a[N+2]=a[R]=P-V,a[N+3]=a[R+1]=z-O}},{key:"render",value:function(t){var n=null==t?t=new Ms:void 0,e=this.delaunay,r=e.halfedges,i=e.inedges,o=e.hull,a=this.circumcenters,u=this.vectors;if(o.length<=1)return null;for(var c=0,s=r.length;c<s;++c){var f=r[c];if(!(f<c)){var l=2*Math.floor(c/3),h=2*Math.floor(f/3),d=a[l],p=a[l+1],y=a[h],g=a[h+1];this._renderSegment(d,p,y,g,t)}}for(var v,m=o[o.length-1],b=0;b<o.length;++b){v=m,m=o[b];var x=2*Math.floor(i[m]/3),_=a[x],w=a[x+1],A=4*v,S=this._project(_,w,u[A+2],u[A+3]);S&&this._renderSegment(_,w,S[0],S[1],t)}return n&&n.value()}},{key:"renderBounds",value:function(t){var n=null==t?t=new Ms:void 0;return t.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),n&&n.value()}},{key:"renderCell",value:function(t,n){var e=null==n?n=new Ms:void 0,r=this._clip(t);if(null!==r&&r.length){n.moveTo(r[0],r[1]);for(var i=r.length;r[0]===r[i-2]&&r[1]===r[i-1]&&i>1;)i-=2;for(var o=2;o<i;o+=2)r[o]===r[o-2]&&r[o+1]===r[o-1]||n.lineTo(r[o],r[o+1]);return n.closePath(),e&&e.value()}}},{key:"cellPolygons",value:o.mark((function t(){var n,e,r,i;return o.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=this.delaunay.points,e=0,r=n.length/2;case 2:if(!(e<r)){t.next=11;break}if(!(i=this.cellPolygon(e))){t.next=8;break}return i.index=e,t.next=8,i;case 8:++e,t.next=2;break;case 11:case"end":return t.stop()}}),t,this)}))},{key:"cellPolygon",value:function(t){var n=new Es;return this.renderCell(t,n),n.value()}},{key:"_renderSegment",value:function(t,n,e,r,i){var o,a=this._regioncode(t,n),u=this._regioncode(e,r);0===a&&0===u?(i.moveTo(t,n),i.lineTo(e,r)):(o=this._clipSegment(t,n,e,r,a,u))&&(i.moveTo(o[0],o[1]),i.lineTo(o[2],o[3]))}},{key:"contains",value:function(t,n,e){return(n=+n)==n&&(e=+e)==e&&this.delaunay._step(t,n,e)===t}},{key:"neighbors",value:o.mark((function t(n){var e,r,i,a,u,c,s,f,l;return o.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e=this._clip(n))){t.next=33;break}r=Cs(this.delaunay.neighbors(n)),t.prev=3,r.s();case 5:if((i=r.n()).done){t.next=25;break}if(a=i.value,!(u=this._clip(a))){t.next=23;break}c=0,s=e.length;case 10:if(!(c<s)){t.next=23;break}f=0,l=u.length;case 12:if(!(f<l)){t.next=20;break}if(e[c]!=u[f]||e[c+1]!=u[f+1]||e[(c+2)%s]!=u[(f+l-2)%l]||e[(c+3)%s]!=u[(f+l-1)%l]){t.next=17;break}return t.next=16,a;case 16:return t.abrupt("break",23);case 17:f+=2,t.next=12;break;case 20:c+=2,t.next=10;break;case 23:t.next=5;break;case 25:t.next=30;break;case 27:t.prev=27,t.t0=t.catch(3),r.e(t.t0);case 30:return t.prev=30,r.f(),t.finish(30);case 33:case"end":return t.stop()}}),t,this,[[3,27,30,33]])}))},{key:"_cell",value:function(t){var n=this.circumcenters,e=this.delaunay,r=e.inedges,i=e.halfedges,o=e.triangles,a=r[t];if(-1===a)return null;var u=[],c=a;do{var s=Math.floor(c/3);if(u.push(n[2*s],n[2*s+1]),o[c=c%3==2?c-2:c+1]!==t)break;c=i[c]}while(c!==a&&-1!==c);return u}},{key:"_clip",value:function(t){if(0===t&&1===this.delaunay.hull.length)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];var n=this._cell(t);if(null===n)return null;var e=this.vectors,r=4*t;return e[r]||e[r+1]?this._clipInfinite(t,n,e[r],e[r+1],e[r+2],e[r+3]):this._clipFinite(t,n)}},{key:"_clipFinite",value:function(t,n){for(var e,r,i,o,a=n.length,u=null,c=n[a-2],s=n[a-1],f=this._regioncode(c,s),l=0,h=0;h<a;h+=2)if(e=c,r=s,c=n[h],s=n[h+1],i=f,f=this._regioncode(c,s),0===i&&0===f)o=l,l=0,u?u.push(c,s):u=[c,s];else{var d=void 0,p=void 0,y=void 0,g=void 0,v=void 0;if(0===i){if(null===(d=this._clipSegment(e,r,c,s,i,f)))continue;var m=ks(d,4);p=m[0],y=m[1],g=m[2],v=m[3]}else{if(null===(d=this._clipSegment(c,s,e,r,f,i)))continue;var b=ks(d,4);g=b[0],v=b[1],p=b[2],y=b[3],o=l,l=this._edgecode(p,y),o&&l&&this._edge(t,o,l,u,u.length),u?u.push(p,y):u=[p,y]}o=l,l=this._edgecode(g,v),o&&l&&this._edge(t,o,l,u,u.length),u?u.push(g,v):u=[g,v]}if(u)o=l,l=this._edgecode(u[0],u[1]),o&&l&&this._edge(t,o,l,u,u.length);else if(this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return u}},{key:"_clipSegment",value:function(t,n,e,r,i,o){for(;;){if(0===i&&0===o)return[t,n,e,r];if(i&o)return null;var a=void 0,u=void 0,c=i||o;8&c?(a=t+(e-t)*(this.ymax-n)/(r-n),u=this.ymax):4&c?(a=t+(e-t)*(this.ymin-n)/(r-n),u=this.ymin):2&c?(u=n+(r-n)*(this.xmax-t)/(e-t),a=this.xmax):(u=n+(r-n)*(this.xmin-t)/(e-t),a=this.xmin),i?(t=a,n=u,i=this._regioncode(t,n)):(e=a,r=u,o=this._regioncode(e,r))}}},{key:"_clipInfinite",value:function(t,n,e,r,i,o){var a,u=Array.from(n);if((a=this._project(u[0],u[1],e,r))&&u.unshift(a[0],a[1]),(a=this._project(u[u.length-2],u[u.length-1],i,o))&&u.push(a[0],a[1]),u=this._clipFinite(t,u))for(var c,s=0,f=u.length,l=this._edgecode(u[f-2],u[f-1]);s<f;s+=2)c=l,l=this._edgecode(u[s],u[s+1]),c&&l&&(s=this._edge(t,c,l,u,s),f=u.length);else this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(u=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return u}},{key:"_edge",value:function(t,n,e,r,i){for(;n!==e;){var o=void 0,a=void 0;switch(n){case 5:n=4;continue;case 4:n=6,o=this.xmax,a=this.ymin;break;case 6:n=2;continue;case 2:n=10,o=this.xmax,a=this.ymax;break;case 10:n=8;continue;case 8:n=9,o=this.xmin,a=this.ymax;break;case 9:n=1;continue;case 1:n=5,o=this.xmin,a=this.ymin}r[i]===o&&r[i+1]===a||!this.contains(t,o,a)||(r.splice(i,0,o,a),i+=2)}if(r.length>4)for(var u=0;u<r.length;u+=2){var c=(u+2)%r.length,s=(u+4)%r.length;(r[u]===r[c]&&r[c]===r[s]||r[u+1]===r[c+1]&&r[c+1]===r[s+1])&&(r.splice(c,2),u-=2)}return i}},{key:"_project",value:function(t,n,e,r){var i,o,a,u=1/0;if(r<0){if(n<=this.ymin)return null;(i=(this.ymin-n)/r)<u&&(a=this.ymin,o=t+(u=i)*e)}else if(r>0){if(n>=this.ymax)return null;(i=(this.ymax-n)/r)<u&&(a=this.ymax,o=t+(u=i)*e)}if(e>0){if(t>=this.xmax)return null;(i=(this.xmax-t)/e)<u&&(o=this.xmax,a=n+(u=i)*r)}else if(e<0){if(t<=this.xmin)return null;(i=(this.xmin-t)/e)<u&&(o=this.xmin,a=n+(u=i)*r)}return[o,a]}},{key:"_edgecode",value:function(t,n){return(t===this.xmin?1:t===this.xmax?2:0)|(n===this.ymin?4:n===this.ymax?8:0)}},{key:"_regioncode",value:function(t,n){return(t<this.xmin?1:t>this.xmax?2:0)|(n<this.ymin?4:n>this.ymax?8:0)}}])&&Is(n.prototype,e),r&&Is(n,r),Object.defineProperty(n,"prototype",{writable:!1}),t}(),zs=o.mark(Xs);function Vs(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return Ds(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Ds(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function Ds(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function js(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ls=2*Math.PI,Us=Math.pow;function Bs(t){return t[0]}function Fs(t){return t[1]}function qs(t,n,e){return[t+Math.sin(t+n)*e,n+Math.cos(t-n)*e]}var Hs=function(){function t(n){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this._delaunator=new gs(n),this.inedges=new Int32Array(n.length/2),this._hullIndex=new Int32Array(n.length/2),this.points=this._delaunator.coords,this._init()}var n,e,r;return n=t,r=[{key:"from",value:function(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Bs,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Fs,i=arguments.length>3?arguments[3]:void 0;return new t("length"in n?Ys(n,e,r,i):Float64Array.from(Xs(n,e,r,i)))}}],(e=[{key:"update",value:function(){return this._delaunator.update(),this._init(),this}},{key:"_init",value:function(){var t=this._delaunator,n=this.points;if(t.hull&&t.hull.length>2&&function(t){for(var n=t.triangles,e=t.coords,r=0;r<n.length;r+=3){var i=2*n[r],o=2*n[r+1],a=2*n[r+2];if((e[a]-e[i])*(e[o+1]-e[i+1])-(e[o]-e[i])*(e[a+1]-e[i+1])>1e-10)return!1}return!0}(t)){this.collinear=Int32Array.from({length:n.length/2},(function(t,n){return n})).sort((function(t,e){return n[2*t]-n[2*e]||n[2*t+1]-n[2*e+1]}));for(var e=this.collinear[0],r=this.collinear[this.collinear.length-1],i=[n[2*e],n[2*e+1],n[2*r],n[2*r+1]],o=1e-8*Math.hypot(i[3]-i[1],i[2]-i[0]),a=0,u=n.length/2;a<u;++a){var c=qs(n[2*a],n[2*a+1],o);n[2*a]=c[0],n[2*a+1]=c[1]}this._delaunator=new gs(n)}else delete this.collinear;for(var s=this.halfedges=this._delaunator.halfedges,f=this.hull=this._delaunator.hull,l=this.triangles=this._delaunator.triangles,h=this.inedges.fill(-1),d=this._hullIndex.fill(-1),p=0,y=s.length;p<y;++p){var g=l[p%3==2?p-2:p+1];-1!==s[p]&&-1!==h[g]||(h[g]=p)}for(var v=0,m=f.length;v<m;++v)d[f[v]]=v;f.length<=2&&f.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=f[0],h[f[0]]=1,2===f.length&&(h[f[1]]=0,this.triangles[1]=f[1],this.triangles[2]=f[1]))}},{key:"voronoi",value:function(t){return new Rs(this,t)}},{key:"neighbors",value:o.mark((function t(n){var e,r,i,a,u,c,s,f,l,h,d;return o.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=this.inedges,r=this.hull,i=this._hullIndex,a=this.halfedges,u=this.triangles,!(c=this.collinear)){t.next=10;break}if(!((s=c.indexOf(n))>0)){t.next=6;break}return t.next=6,c[s-1];case 6:if(!(s<c.length-1)){t.next=9;break}return t.next=9,c[s+1];case 9:return t.abrupt("return");case 10:if(-1!==(f=e[n])){t.next=13;break}return t.abrupt("return");case 13:l=f,h=-1;case 14:return t.next=16,h=u[l];case 16:if(u[l=l%3==2?l-2:l+1]===n){t.next=19;break}return t.abrupt("return");case 19:if(-1!==(l=a[l])){t.next=26;break}if((d=r[(i[n]+1)%r.length])===h){t.next=25;break}return t.next=25,d;case 25:return t.abrupt("return");case 26:if(l!==f){t.next=14;break}case 27:case"end":return t.stop()}}),t,this)}))},{key:"find",value:function(t,n){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if((t=+t)!=t||(n=+n)!=n)return-1;for(var r,i=e;(r=this._step(e,t,n))>=0&&r!==e&&r!==i;)e=r;return r}},{key:"_step",value:function(t,n,e){var r=this.inedges,i=this.hull,o=this._hullIndex,a=this.halfedges,u=this.triangles,c=this.points;if(-1===r[t]||!c.length)return(t+1)%(c.length>>1);var s=t,f=Us(n-c[2*t],2)+Us(e-c[2*t+1],2),l=r[t],h=l;do{var d=u[h],p=Us(n-c[2*d],2)+Us(e-c[2*d+1],2);if(p<f&&(f=p,s=d),u[h=h%3==2?h-2:h+1]!==t)break;if(-1===(h=a[h])){if((h=i[(o[t]+1)%i.length])!==d&&Us(n-c[2*h],2)+Us(e-c[2*h+1],2)<f)return h;break}}while(h!==l);return s}},{key:"render",value:function(t){for(var n=null==t?t=new Ms:void 0,e=this.points,r=this.halfedges,i=this.triangles,o=0,a=r.length;o<a;++o){var u=r[o];if(!(u<o)){var c=2*i[o],s=2*i[u];t.moveTo(e[c],e[c+1]),t.lineTo(e[s],e[s+1])}}return this.renderHull(t),n&&n.value()}},{key:"renderPoints",value:function(t,n){void 0!==n||t&&"function"==typeof t.moveTo||(n=t,t=null),n=null==n?2:+n;for(var e=null==t?t=new Ms:void 0,r=this.points,i=0,o=r.length;i<o;i+=2){var a=r[i],u=r[i+1];t.moveTo(a+n,u),t.arc(a,u,n,0,Ls)}return e&&e.value()}},{key:"renderHull",value:function(t){var n=null==t?t=new Ms:void 0,e=this.hull,r=this.points,i=2*e[0],o=e.length;t.moveTo(r[i],r[i+1]);for(var a=1;a<o;++a){var u=2*e[a];t.lineTo(r[u],r[u+1])}return t.closePath(),n&&n.value()}},{key:"hullPolygon",value:function(){var t=new Es;return this.renderHull(t),t.value()}},{key:"renderTriangle",value:function(t,n){var e=null==n?n=new Ms:void 0,r=this.points,i=this.triangles,o=2*i[t*=3],a=2*i[t+1],u=2*i[t+2];return n.moveTo(r[o],r[o+1]),n.lineTo(r[a],r[a+1]),n.lineTo(r[u],r[u+1]),n.closePath(),e&&e.value()}},{key:"trianglePolygons",value:o.mark((function t(){var n,e,r;return o.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=this.triangles,e=0,r=n.length/3;case 2:if(!(e<r)){t.next=8;break}return t.next=5,this.trianglePolygon(e);case 5:++e,t.next=2;break;case 8:case"end":return t.stop()}}),t,this)}))},{key:"trianglePolygon",value:function(t){var n=new Es;return this.renderTriangle(t,n),n.value()}}])&&js(n.prototype,e),r&&js(n,r),Object.defineProperty(n,"prototype",{writable:!1}),t}();function Ys(t,n,e,r){for(var i=t.length,o=new Float64Array(2*i),a=0;a<i;++a){var u=t[a];o[2*a]=n.call(r,u,a,t),o[2*a+1]=e.call(r,u,a,t)}return o}function Xs(t,n,e,r){var i,a,u,c;return o.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:i=0,a=Vs(t),o.prev=2,a.s();case 4:if((u=a.n()).done){o.next=13;break}return c=u.value,o.next=8,n.call(r,c,i,t);case 8:return o.next=10,e.call(r,c,i,t);case 10:++i;case 11:o.next=4;break;case 13:o.next=18;break;case 15:o.prev=15,o.t0=o.catch(2),a.e(o.t0);case 18:return o.prev=18,a.f(),o.finish(18);case 21:case"end":return o.stop()}}),zs,null,[[2,15,18,21]])}var $s=function(t){return function(){return t}};function Ws(t,n){var e=n.sourceEvent,r=n.subject,i=n.target,o=n.identifier,a=n.active,u=n.x,c=n.y,s=n.dx,f=n.dy,l=n.dispatch;Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:r,enumerable:!0,configurable:!0},target:{value:i,enumerable:!0,configurable:!0},identifier:{value:o,enumerable:!0,configurable:!0},active:{value:a,enumerable:!0,configurable:!0},x:{value:u,enumerable:!0,configurable:!0},y:{value:c,enumerable:!0,configurable:!0},dx:{value:s,enumerable:!0,configurable:!0},dy:{value:f,enumerable:!0,configurable:!0},_:{value:l}})}function Gs(t){return!t.ctrlKey&&!t.button}function Qs(){return this.parentNode}function Zs(t,n){return null==n?{x:t.x,y:t.y}:n}function Ks(){return navigator.maxTouchPoints||"ontouchstart"in this}function Js(){var t,n,e,r,i=Gs,o=Qs,a=Zs,u=Ks,c={},s=Ze("start","drag","end"),f=0,l=0;function h(t){t.on("mousedown.drag",d).filter(u).on("touchstart.drag",g).on("touchmove.drag",v,bi).on("touchend.drag touchcancel.drag",m).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function d(a,u){if(!r&&i.call(this,a,u)){var c=b(this,o.call(this,a,u),a,u,"mouse");c&&(mi(a.view).on("mousemove.drag",p,xi).on("mouseup.drag",y,xi),Ai(a.view),_i(a),e=!1,t=a.clientX,n=a.clientY,c("start",a))}}function p(r){if(wi(r),!e){var i=r.clientX-t,o=r.clientY-n;e=i*i+o*o>l}c.mouse("drag",r)}function y(t){mi(t.view).on("mousemove.drag mouseup.drag",null),Si(t.view,e),wi(t),c.mouse("end",t)}function g(t,n){if(i.call(this,t,n)){var e,r,a=t.changedTouches,u=o.call(this,t,n),c=a.length;for(e=0;e<c;++e)(r=b(this,u,t,n,a[e].identifier,a[e]))&&(_i(t),r("start",t,a[e]))}}function v(t){var n,e,r=t.changedTouches,i=r.length;for(n=0;n<i;++n)(e=c[r[n].identifier])&&(wi(t),e("drag",t,r[n]))}function m(t){var n,e,i=t.changedTouches,o=i.length;for(r&&clearTimeout(r),r=setTimeout((function(){r=null}),500),n=0;n<o;++n)(e=c[i[n].identifier])&&(_i(t),e("end",t,i[n]))}function b(t,n,e,r,i,o){var u,l,d,p=s.copy(),y=No(o||e,n);if(null!=(d=a.call(t,new Ws("beforestart",{sourceEvent:e,target:h,identifier:i,active:f,x:y[0],y:y[1],dx:0,dy:0,dispatch:p}),r)))return u=d.x-y[0]||0,l=d.y-y[1]||0,function e(o,a,s){var g,v=y;switch(o){case"start":c[i]=e,g=f++;break;case"end":delete c[i],--f;case"drag":y=No(s||a,n),g=f}p.call(o,t,new Ws(o,{sourceEvent:a,subject:d,target:h,identifier:i,active:g,x:y[0]+u,y:y[1]+l,dx:y[0]-v[0],dy:y[1]-v[1],dispatch:p}),r)}}return h.filter=function(t){return arguments.length?(i="function"==typeof t?t:$s(!!t),h):i},h.container=function(t){return arguments.length?(o="function"==typeof t?t:$s(t),h):o},h.subject=function(t){return arguments.length?(a="function"==typeof t?t:$s(t),h):a},h.touchable=function(t){return arguments.length?(u="function"==typeof t?t:$s(!!t),h):u},h.on=function(){var t=s.on.apply(s,arguments);return t===s?h:t},h.clickDistance=function(t){return arguments.length?(l=(t=+t)*t,h):Math.sqrt(l)},h}Ws.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};var tf={},nf={};function ef(t){return new Function("d","return {"+t.map((function(t,n){return JSON.stringify(t)+": d["+n+'] || ""'})).join(",")+"}")}function rf(t){var n=Object.create(null),e=[];return t.forEach((function(t){for(var r in t)r in n||e.push(n[r]=r)})),e}function of(t,n){var e=t+"",r=e.length;return r<n?new Array(n-r+1).join(0)+e:e}function af(t){var n=t.getUTCHours(),e=t.getUTCMinutes(),r=t.getUTCSeconds(),i=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":function(t){return t<0?"-"+of(-t,6):t>9999?"+"+of(t,6):of(t,4)}(t.getUTCFullYear())+"-"+of(t.getUTCMonth()+1,2)+"-"+of(t.getUTCDate(),2)+(i?"T"+of(n,2)+":"+of(e,2)+":"+of(r,2)+"."+of(i,3)+"Z":r?"T"+of(n,2)+":"+of(e,2)+":"+of(r,2)+"Z":e||n?"T"+of(n,2)+":"+of(e,2)+"Z":"")}function uf(t){var n=new RegExp('["'+t+"\n\r]"),e=t.charCodeAt(0);function r(t,n){var r,i=[],o=t.length,a=0,u=0,c=o<=0,s=!1;function f(){if(c)return nf;if(s)return s=!1,tf;var n,r,i=a;if(34===t.charCodeAt(i)){for(;a++<o&&34!==t.charCodeAt(a)||34===t.charCodeAt(++a););return(n=a)>=o?c=!0:10===(r=t.charCodeAt(a++))?s=!0:13===r&&(s=!0,10===t.charCodeAt(a)&&++a),t.slice(i+1,n-1).replace(/""/g,'"')}for(;a<o;){if(10===(r=t.charCodeAt(n=a++)))s=!0;else if(13===r)s=!0,10===t.charCodeAt(a)&&++a;else if(r!==e)continue;return t.slice(i,n)}return c=!0,t.slice(i,o)}for(10===t.charCodeAt(o-1)&&--o,13===t.charCodeAt(o-1)&&--o;(r=f())!==nf;){for(var l=[];r!==tf&&r!==nf;)l.push(r),r=f();n&&null==(l=n(l,u++))||i.push(l)}return i}function i(n,e){return n.map((function(n){return e.map((function(t){return a(n[t])})).join(t)}))}function o(n){return n.map(a).join(t)}function a(t){return null==t?"":t instanceof Date?af(t):n.test(t+="")?'"'+t.replace(/"/g,'""')+'"':t}return{parse:function(t,n){var e,i,o=r(t,(function(t,r){if(e)return e(t,r-1);i=t,e=n?function(t,n){var e=ef(t);return function(r,i){return n(e(r),i,t)}}(t,n):ef(t)}));return o.columns=i||[],o},parseRows:r,format:function(n,e){return null==e&&(e=rf(n)),[e.map(a).join(t)].concat(i(n,e)).join("\n")},formatBody:function(t,n){return null==n&&(n=rf(t)),i(t,n).join("\n")},formatRows:function(t){return t.map(o).join("\n")},formatRow:o,formatValue:a}}var cf=uf(","),sf=cf.parse,ff=cf.parseRows,lf=cf.format,hf=cf.formatBody,df=cf.formatRows,pf=cf.formatRow,yf=cf.formatValue,gf=uf("\t"),vf=gf.parse,mf=gf.parseRows,bf=gf.format,xf=gf.formatBody,_f=gf.formatRows,wf=gf.formatRow,Af=gf.formatValue;function Sf(t){for(var n in t){var e,r,i=t[n].trim();if(i)if("true"===i)i=!0;else if("false"===i)i=!1;else if("NaN"===i)i=NaN;else if(isNaN(e=+i)){if(!(r=i.match(/^([-+]\d{2})?\d{4}(-\d{2}(-\d{2})?)?(T\d{2}:\d{2}(:\d{2}(\.\d{3})?)?(Z|[-+]\d{2}:\d{2})?)?$/)))continue;Mf&&r[4]&&!r[7]&&(i=i.replace(/-/g,"/").replace(/T/," ")),i=new Date(i)}else i=e;else i=null;t[n]=i}return t}var Mf=new Date("2019-01-01T00:00").getHours()||new Date("2019-07-01T00:00").getHours(),Tf=function(t){return+t};function Ef(t){return t*t}function Cf(t){return t*(2-t)}function kf(t){return((t*=2)<=1?t*t:--t*(2-t)+1)/2}var Nf=function t(n){function e(t){return Math.pow(t,n)}return n=+n,e.exponent=t,e}(3),Of=function t(n){function e(t){return 1-Math.pow(1-t,n)}return n=+n,e.exponent=t,e}(3),Pf=function t(n){function e(t){return((t*=2)<=1?Math.pow(t,n):2-Math.pow(2-t,n))/2}return n=+n,e.exponent=t,e}(3),If=Math.PI,Rf=If/2;function zf(t){return 1==+t?1:1-Math.cos(t*Rf)}function Vf(t){return Math.sin(t*Rf)}function Df(t){return(1-Math.cos(If*t))/2}function jf(t){return 1.0009775171065494*(Math.pow(2,-10*t)-.0009765625)}function Lf(t){return jf(1-+t)}function Uf(t){return 1-jf(t)}function Bf(t){return((t*=2)<=1?jf(1-t):2-jf(t-1))/2}function Ff(t){return 1-Math.sqrt(1-t*t)}function qf(t){return Math.sqrt(1- --t*t)}function Hf(t){return((t*=2)<=1?1-Math.sqrt(1-t*t):Math.sqrt(1-(t-=2)*t)+1)/2}var Yf=4/11,Xf=7.5625;function $f(t){return 1-Wf(1-t)}function Wf(t){return(t=+t)<Yf?Xf*t*t:t<.7272727272727273?Xf*(t-=.5454545454545454)*t+.75:t<.9090909090909091?Xf*(t-=.8181818181818182)*t+.9375:Xf*(t-=.9545454545454546)*t+.984375}function Gf(t){return((t*=2)<=1?1-Wf(1-t):Wf(t-1)+1)/2}var Qf=1.70158,Zf=function t(n){function e(t){return(t=+t)*t*(n*(t-1)+t)}return n=+n,e.overshoot=t,e}(Qf),Kf=function t(n){function e(t){return--t*t*((t+1)*n+t)+1}return n=+n,e.overshoot=t,e}(Qf),Jf=function t(n){function e(t){return((t*=2)<1?t*t*((n+1)*t-n):(t-=2)*t*((n+1)*t+n)+2)/2}return n=+n,e.overshoot=t,e}(Qf),tl=2*Math.PI,nl=function t(n,e){var r=Math.asin(1/(n=Math.max(1,n)))*(e/=tl);function i(t){return n*jf(- --t)*Math.sin((r-t)/e)}return i.amplitude=function(n){return t(n,e*tl)},i.period=function(e){return t(n,e)},i}(1,.3),el=function t(n,e){var r=Math.asin(1/(n=Math.max(1,n)))*(e/=tl);function i(t){return 1-n*jf(t=+t)*Math.sin((t+r)/e)}return i.amplitude=function(n){return t(n,e*tl)},i.period=function(e){return t(n,e)},i}(1,.3),rl=function t(n,e){var r=Math.asin(1/(n=Math.max(1,n)))*(e/=tl);function i(t){return((t=2*t-1)<0?n*jf(-t)*Math.sin((r-t)/e):2-n*jf(t)*Math.sin((r+t)/e))/2}return i.amplitude=function(n){return t(n,e*tl)},i.period=function(e){return t(n,e)},i}(1,.3);function il(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.blob()}function ol(t,n){return fetch(t,n).then(il)}function al(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.arrayBuffer()}function ul(t,n){return fetch(t,n).then(al)}function cl(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.text()}function sl(t,n){return fetch(t,n).then(cl)}function fl(t){return function(n,e,r){return 2===arguments.length&&"function"==typeof e&&(r=e,e=void 0),sl(n,e).then((function(n){return t(n,r)}))}}function ll(t,n,e,r){3===arguments.length&&"function"==typeof e&&(r=e,e=void 0);var i=uf(t);return sl(n,e).then((function(t){return i.parse(t,r)}))}var hl=fl(sf),dl=fl(vf);function pl(t,n){return new Promise((function(e,r){var i=new Image;for(var o in n)i[o]=n[o];i.onerror=r,i.onload=function(){e(i)},i.src=t}))}function yl(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);if(204!==t.status&&205!==t.status)return t.json()}function gl(t,n){return fetch(t,n).then(yl)}function vl(t){return function(n,e){return sl(n,e).then((function(n){return(new DOMParser).parseFromString(n,t)}))}}var ml=vl("application/xml"),bl=vl("text/html"),xl=vl("image/svg+xml");function _l(t,n){var e,r=1;function i(){var i,o,a=e.length,u=0,c=0;for(i=0;i<a;++i)u+=(o=e[i]).x,c+=o.y;for(u=(u/a-t)*r,c=(c/a-n)*r,i=0;i<a;++i)(o=e[i]).x-=u,o.y-=c}return null==t&&(t=0),null==n&&(n=0),i.initialize=function(t){e=t},i.x=function(n){return arguments.length?(t=+n,i):t},i.y=function(t){return arguments.length?(n=+t,i):n},i.strength=function(t){return arguments.length?(r=+t,i):r},i}function wl(t,n,e,r){if(isNaN(n)||isNaN(e))return t;var i,o,a,u,c,s,f,l,h,d=t._root,p={data:r},y=t._x0,g=t._y0,v=t._x1,m=t._y1;if(!d)return t._root=p,t;for(;d.length;)if((s=n>=(o=(y+v)/2))?y=o:v=o,(f=e>=(a=(g+m)/2))?g=a:m=a,i=d,!(d=d[l=f<<1|s]))return i[l]=p,t;if(u=+t._x.call(null,d.data),c=+t._y.call(null,d.data),n===u&&e===c)return p.next=d,i?i[l]=p:t._root=p,t;do{i=i?i[l]=new Array(4):t._root=new Array(4),(s=n>=(o=(y+v)/2))?y=o:v=o,(f=e>=(a=(g+m)/2))?g=a:m=a}while((l=f<<1|s)==(h=(c>=a)<<1|u>=o));return i[h]=d,i[l]=p,t}function Al(t,n,e,r,i){this.node=t,this.x0=n,this.y0=e,this.x1=r,this.y1=i}function Sl(t){return t[0]}function Ml(t){return t[1]}function Tl(t,n,e){var r=new El(null==n?Sl:n,null==e?Ml:e,NaN,NaN,NaN,NaN);return null==t?r:r.addAll(t)}function El(t,n,e,r,i,o){this._x=t,this._y=n,this._x0=e,this._y0=r,this._x1=i,this._y1=o,this._root=void 0}function Cl(t){for(var n={data:t.data},e=n;t=t.next;)e=e.next={data:t.data};return n}var kl=Tl.prototype=El.prototype;function Nl(t){return function(){return t}}function Ol(t){return 1e-6*(t()-.5)}function Pl(t){return t.x+t.vx}function Il(t){return t.y+t.vy}function Rl(t){var n,e,r,i=1,o=1;function a(){for(var t,a,c,s,f,l,h,d=n.length,p=0;p<o;++p)for(a=Tl(n,Pl,Il).visitAfter(u),t=0;t<d;++t)c=n[t],l=e[c.index],h=l*l,s=c.x+c.vx,f=c.y+c.vy,a.visit(y);function y(t,n,e,o,a){var u=t.data,d=t.r,p=l+d;if(!u)return n>s+p||o<s-p||e>f+p||a<f-p;if(u.index>c.index){var y=s-u.x-u.vx,g=f-u.y-u.vy,v=y*y+g*g;v<p*p&&(0===y&&(v+=(y=Ol(r))*y),0===g&&(v+=(g=Ol(r))*g),v=(p-(v=Math.sqrt(v)))/v*i,c.vx+=(y*=v)*(p=(d*=d)/(h+d)),c.vy+=(g*=v)*p,u.vx-=y*(p=1-p),u.vy-=g*p)}}}function u(t){if(t.data)return t.r=e[t.data.index];for(var n=t.r=0;n<4;++n)t[n]&&t[n].r>t.r&&(t.r=t[n].r)}function c(){if(n){var r,i,o=n.length;for(e=new Array(o),r=0;r<o;++r)i=n[r],e[i.index]=+t(i,r,n)}}return"function"!=typeof t&&(t=Nl(null==t?1:+t)),a.initialize=function(t,e){n=t,r=e,c()},a.iterations=function(t){return arguments.length?(o=+t,a):o},a.strength=function(t){return arguments.length?(i=+t,a):i},a.radius=function(n){return arguments.length?(t="function"==typeof n?n:Nl(+n),c(),a):t},a}function zl(t){return(zl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Vl(t){return t.index}function Dl(t,n){var e=t.get(n);if(!e)throw new Error("node not found: "+n);return e}function jl(t){var n,e,r,i,o,a,u=Vl,c=function(t){return 1/Math.min(i[t.source.index],i[t.target.index])},s=Nl(30),f=1;function l(r){for(var i=0,u=t.length;i<f;++i)for(var c,s,l,h,d,p,y,g=0;g<u;++g)s=(c=t[g]).source,h=(l=c.target).x+l.vx-s.x-s.vx||Ol(a),d=l.y+l.vy-s.y-s.vy||Ol(a),h*=p=((p=Math.sqrt(h*h+d*d))-e[g])/p*r*n[g],d*=p,l.vx-=h*(y=o[g]),l.vy-=d*y,s.vx+=h*(y=1-y),s.vy+=d*y}function h(){if(r){var a,c,s=r.length,f=t.length,l=new Map(r.map((function(t,n){return[u(t,n,r),t]})));for(a=0,i=new Array(s);a<f;++a)(c=t[a]).index=a,"object"!==zl(c.source)&&(c.source=Dl(l,c.source)),"object"!==zl(c.target)&&(c.target=Dl(l,c.target)),i[c.source.index]=(i[c.source.index]||0)+1,i[c.target.index]=(i[c.target.index]||0)+1;for(a=0,o=new Array(f);a<f;++a)c=t[a],o[a]=i[c.source.index]/(i[c.source.index]+i[c.target.index]);n=new Array(f),d(),e=new Array(f),p()}}function d(){if(r)for(var e=0,i=t.length;e<i;++e)n[e]=+c(t[e],e,t)}function p(){if(r)for(var n=0,i=t.length;n<i;++n)e[n]=+s(t[n],n,t)}return null==t&&(t=[]),l.initialize=function(t,n){r=t,a=n,h()},l.links=function(n){return arguments.length?(t=n,h(),l):t},l.id=function(t){return arguments.length?(u=t,l):u},l.iterations=function(t){return arguments.length?(f=+t,l):f},l.strength=function(t){return arguments.length?(c="function"==typeof t?t:Nl(+t),d(),l):c},l.distance=function(t){return arguments.length?(s="function"==typeof t?t:Nl(+t),p(),l):s},l}kl.copy=function(){var t,n,e=new El(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return e;if(!r.length)return e._root=Cl(r),e;for(t=[{source:r,target:e._root=new Array(4)}];r=t.pop();)for(var i=0;i<4;++i)(n=r.source[i])&&(n.length?t.push({source:n,target:r.target[i]=new Array(4)}):r.target[i]=Cl(n));return e},kl.add=function(t){var n=+this._x.call(null,t),e=+this._y.call(null,t);return wl(this.cover(n,e),n,e,t)},kl.addAll=function(t){var n,e,r,i,o=t.length,a=new Array(o),u=new Array(o),c=1/0,s=1/0,f=-1/0,l=-1/0;for(e=0;e<o;++e)isNaN(r=+this._x.call(null,n=t[e]))||isNaN(i=+this._y.call(null,n))||(a[e]=r,u[e]=i,r<c&&(c=r),r>f&&(f=r),i<s&&(s=i),i>l&&(l=i));if(c>f||s>l)return this;for(this.cover(c,s).cover(f,l),e=0;e<o;++e)wl(this,a[e],u[e],t[e]);return this},kl.cover=function(t,n){if(isNaN(t=+t)||isNaN(n=+n))return this;var e=this._x0,r=this._y0,i=this._x1,o=this._y1;if(isNaN(e))i=(e=Math.floor(t))+1,o=(r=Math.floor(n))+1;else{for(var a,u,c=i-e||1,s=this._root;e>t||t>=i||r>n||n>=o;)switch(u=(n<r)<<1|t<e,(a=new Array(4))[u]=s,s=a,c*=2,u){case 0:i=e+c,o=r+c;break;case 1:e=i-c,o=r+c;break;case 2:i=e+c,r=o-c;break;case 3:e=i-c,r=o-c}this._root&&this._root.length&&(this._root=s)}return this._x0=e,this._y0=r,this._x1=i,this._y1=o,this},kl.data=function(){var t=[];return this.visit((function(n){if(!n.length)do{t.push(n.data)}while(n=n.next)})),t},kl.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},kl.find=function(t,n,e){var r,i,o,a,u,c,s,f=this._x0,l=this._y0,h=this._x1,d=this._y1,p=[],y=this._root;for(y&&p.push(new Al(y,f,l,h,d)),null==e?e=1/0:(f=t-e,l=n-e,h=t+e,d=n+e,e*=e);c=p.pop();)if(!(!(y=c.node)||(i=c.x0)>h||(o=c.y0)>d||(a=c.x1)<f||(u=c.y1)<l))if(y.length){var g=(i+a)/2,v=(o+u)/2;p.push(new Al(y[3],g,v,a,u),new Al(y[2],i,v,g,u),new Al(y[1],g,o,a,v),new Al(y[0],i,o,g,v)),(s=(n>=v)<<1|t>=g)&&(c=p[p.length-1],p[p.length-1]=p[p.length-1-s],p[p.length-1-s]=c)}else{var m=t-+this._x.call(null,y.data),b=n-+this._y.call(null,y.data),x=m*m+b*b;if(x<e){var _=Math.sqrt(e=x);f=t-_,l=n-_,h=t+_,d=n+_,r=y.data}}return r},kl.remove=function(t){if(isNaN(o=+this._x.call(null,t))||isNaN(a=+this._y.call(null,t)))return this;var n,e,r,i,o,a,u,c,s,f,l,h,d=this._root,p=this._x0,y=this._y0,g=this._x1,v=this._y1;if(!d)return this;if(d.length)for(;;){if((s=o>=(u=(p+g)/2))?p=u:g=u,(f=a>=(c=(y+v)/2))?y=c:v=c,n=d,!(d=d[l=f<<1|s]))return this;if(!d.length)break;(n[l+1&3]||n[l+2&3]||n[l+3&3])&&(e=n,h=l)}for(;d.data!==t;)if(r=d,!(d=d.next))return this;return(i=d.next)&&delete d.next,r?(i?r.next=i:delete r.next,this):n?(i?n[l]=i:delete n[l],(d=n[0]||n[1]||n[2]||n[3])&&d===(n[3]||n[2]||n[1]||n[0])&&!d.length&&(e?e[h]=d:this._root=d),this):(this._root=i,this)},kl.removeAll=function(t){for(var n=0,e=t.length;n<e;++n)this.remove(t[n]);return this},kl.root=function(){return this._root},kl.size=function(){var t=0;return this.visit((function(n){if(!n.length)do{++t}while(n=n.next)})),t},kl.visit=function(t){var n,e,r,i,o,a,u=[],c=this._root;for(c&&u.push(new Al(c,this._x0,this._y0,this._x1,this._y1));n=u.pop();)if(!t(c=n.node,r=n.x0,i=n.y0,o=n.x1,a=n.y1)&&c.length){var s=(r+o)/2,f=(i+a)/2;(e=c[3])&&u.push(new Al(e,s,f,o,a)),(e=c[2])&&u.push(new Al(e,r,f,s,a)),(e=c[1])&&u.push(new Al(e,s,i,o,f)),(e=c[0])&&u.push(new Al(e,r,i,s,f))}return this},kl.visitAfter=function(t){var n,e=[],r=[];for(this._root&&e.push(new Al(this._root,this._x0,this._y0,this._x1,this._y1));n=e.pop();){var i=n.node;if(i.length){var o,a=n.x0,u=n.y0,c=n.x1,s=n.y1,f=(a+c)/2,l=(u+s)/2;(o=i[0])&&e.push(new Al(o,a,u,f,l)),(o=i[1])&&e.push(new Al(o,f,u,c,l)),(o=i[2])&&e.push(new Al(o,a,l,f,s)),(o=i[3])&&e.push(new Al(o,f,l,c,s))}r.push(n)}for(;n=r.pop();)t(n.node,n.x0,n.y0,n.x1,n.y1);return this},kl.x=function(t){return arguments.length?(this._x=t,this):this._x},kl.y=function(t){return arguments.length?(this._y=t,this):this._y};var Ll=4294967296;function Ul(t){return t.x}function Bl(t){return t.y}var Fl=Math.PI*(3-Math.sqrt(5));function ql(t){var n,e=1,r=.001,i=1-Math.pow(r,1/300),o=0,a=.6,u=new Map,c=Yo(l),s=Ze("tick","end"),f=function(){var t=1;return function(){return(t=(1664525*t+1013904223)%Ll)/Ll}}();function l(){h(),s.call("tick",n),e<r&&(c.stop(),s.call("end",n))}function h(r){var c,s,f=t.length;void 0===r&&(r=1);for(var l=0;l<r;++l)for(e+=(o-e)*i,u.forEach((function(t){t(e)})),c=0;c<f;++c)null==(s=t[c]).fx?s.x+=s.vx*=a:(s.x=s.fx,s.vx=0),null==s.fy?s.y+=s.vy*=a:(s.y=s.fy,s.vy=0);return n}function d(){for(var n,e=0,r=t.length;e<r;++e){if((n=t[e]).index=e,null!=n.fx&&(n.x=n.fx),null!=n.fy&&(n.y=n.fy),isNaN(n.x)||isNaN(n.y)){var i=10*Math.sqrt(.5+e),o=e*Fl;n.x=i*Math.cos(o),n.y=i*Math.sin(o)}(isNaN(n.vx)||isNaN(n.vy))&&(n.vx=n.vy=0)}}function p(n){return n.initialize&&n.initialize(t,f),n}return null==t&&(t=[]),d(),n={tick:h,restart:function(){return c.restart(l),n},stop:function(){return c.stop(),n},nodes:function(e){return arguments.length?(t=e,d(),u.forEach(p),n):t},alpha:function(t){return arguments.length?(e=+t,n):e},alphaMin:function(t){return arguments.length?(r=+t,n):r},alphaDecay:function(t){return arguments.length?(i=+t,n):+i},alphaTarget:function(t){return arguments.length?(o=+t,n):o},velocityDecay:function(t){return arguments.length?(a=1-t,n):1-a},randomSource:function(t){return arguments.length?(f=t,u.forEach(p),n):f},force:function(t,e){return arguments.length>1?(null==e?u.delete(t):u.set(t,p(e)),n):u.get(t)},find:function(n,e,r){var i,o,a,u,c,s=0,f=t.length;for(null==r?r=1/0:r*=r,s=0;s<f;++s)(a=(i=n-(u=t[s]).x)*i+(o=e-u.y)*o)<r&&(c=u,r=a);return c},on:function(t,e){return arguments.length>1?(s.on(t,e),n):s.on(t)}}}function Hl(){var t,n,e,r,i,o=Nl(-30),a=1,u=1/0,c=.81;function s(e){var i,o=t.length,a=Tl(t,Ul,Bl).visitAfter(l);for(r=e,i=0;i<o;++i)n=t[i],a.visit(h)}function f(){if(t){var n,e,r=t.length;for(i=new Array(r),n=0;n<r;++n)e=t[n],i[e.index]=+o(e,n,t)}}function l(t){var n,e,r,o,a,u=0,c=0;if(t.length){for(r=o=a=0;a<4;++a)(n=t[a])&&(e=Math.abs(n.value))&&(u+=n.value,c+=e,r+=e*n.x,o+=e*n.y);t.x=r/c,t.y=o/c}else{(n=t).x=n.data.x,n.y=n.data.y;do{u+=i[n.data.index]}while(n=n.next)}t.value=u}function h(t,o,s,f){if(!t.value)return!0;var l=t.x-n.x,h=t.y-n.y,d=f-o,p=l*l+h*h;if(d*d/c<p)return p<u&&(0===l&&(p+=(l=Ol(e))*l),0===h&&(p+=(h=Ol(e))*h),p<a&&(p=Math.sqrt(a*p)),n.vx+=l*t.value*r/p,n.vy+=h*t.value*r/p),!0;if(!(t.length||p>=u)){(t.data!==n||t.next)&&(0===l&&(p+=(l=Ol(e))*l),0===h&&(p+=(h=Ol(e))*h),p<a&&(p=Math.sqrt(a*p)));do{t.data!==n&&(d=i[t.data.index]*r/p,n.vx+=l*d,n.vy+=h*d)}while(t=t.next)}}return s.initialize=function(n,r){t=n,e=r,f()},s.strength=function(t){return arguments.length?(o="function"==typeof t?t:Nl(+t),f(),s):o},s.distanceMin=function(t){return arguments.length?(a=t*t,s):Math.sqrt(a)},s.distanceMax=function(t){return arguments.length?(u=t*t,s):Math.sqrt(u)},s.theta=function(t){return arguments.length?(c=t*t,s):Math.sqrt(c)},s}function Yl(t,n,e){var r,i,o,a=Nl(.1);function u(t){for(var a=0,u=r.length;a<u;++a){var c=r[a],s=c.x-n||1e-6,f=c.y-e||1e-6,l=Math.sqrt(s*s+f*f),h=(o[a]-l)*i[a]*t/l;c.vx+=s*h,c.vy+=f*h}}function c(){if(r){var n,e=r.length;for(i=new Array(e),o=new Array(e),n=0;n<e;++n)o[n]=+t(r[n],n,r),i[n]=isNaN(o[n])?0:+a(r[n],n,r)}}return"function"!=typeof t&&(t=Nl(+t)),null==n&&(n=0),null==e&&(e=0),u.initialize=function(t){r=t,c()},u.strength=function(t){return arguments.length?(a="function"==typeof t?t:Nl(+t),c(),u):a},u.radius=function(n){return arguments.length?(t="function"==typeof n?n:Nl(+n),c(),u):t},u.x=function(t){return arguments.length?(n=+t,u):n},u.y=function(t){return arguments.length?(e=+t,u):e},u}function Xl(t){var n,e,r,i=Nl(.1);function o(t){for(var i,o=0,a=n.length;o<a;++o)(i=n[o]).vx+=(r[o]-i.x)*e[o]*t}function a(){if(n){var o,a=n.length;for(e=new Array(a),r=new Array(a),o=0;o<a;++o)e[o]=isNaN(r[o]=+t(n[o],o,n))?0:+i(n[o],o,n)}}return"function"!=typeof t&&(t=Nl(null==t?0:+t)),o.initialize=function(t){n=t,a()},o.strength=function(t){return arguments.length?(i="function"==typeof t?t:Nl(+t),a(),o):i},o.x=function(n){return arguments.length?(t="function"==typeof n?n:Nl(+n),a(),o):t},o}function $l(t){var n,e,r,i=Nl(.1);function o(t){for(var i,o=0,a=n.length;o<a;++o)(i=n[o]).vy+=(r[o]-i.y)*e[o]*t}function a(){if(n){var o,a=n.length;for(e=new Array(a),r=new Array(a),o=0;o<a;++o)e[o]=isNaN(r[o]=+t(n[o],o,n))?0:+i(n[o],o,n)}}return"function"!=typeof t&&(t=Nl(null==t?0:+t)),o.initialize=function(t){n=t,a()},o.strength=function(t){return arguments.length?(i="function"==typeof t?t:Nl(+t),a(),o):i},o.y=function(n){return arguments.length?(t="function"==typeof n?n:Nl(+n),a(),o):t},o}function Wl(t,n){if((e=(t=n?t.toExponential(n-1):t.toExponential()).indexOf("e"))<0)return null;var e,r=t.slice(0,e);return[r.length>1?r[0]+r.slice(2):r,+t.slice(e+1)]}function Gl(t){return(t=Wl(Math.abs(t)))?t[1]:NaN}var Ql,Zl=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Kl(t){if(!(n=Zl.exec(t)))throw new Error("invalid format: "+t);var n;return new Jl({fill:n[1],align:n[2],sign:n[3],symbol:n[4],zero:n[5],width:n[6],comma:n[7],precision:n[8]&&n[8].slice(1),trim:n[9],type:n[10]})}function Jl(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function th(t,n){var e=Wl(t,n);if(!e)return t+"";var r=e[0],i=e[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}Kl.prototype=Jl.prototype,Jl.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var nh={"%":function(t,n){return(100*t).toFixed(n)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:function(t,n){return t.toExponential(n)},f:function(t,n){return t.toFixed(n)},g:function(t,n){return t.toPrecision(n)},o:function(t){return Math.round(t).toString(8)},p:function(t,n){return th(100*t,n)},r:th,s:function(t,n){var e=Wl(t,n);if(!e)return t+"";var r=e[0],i=e[1],o=i-(Ql=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,a=r.length;return o===a?r:o>a?r+new Array(o-a+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+Wl(t,Math.max(0,n+o-1))[0]},X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}};function eh(t){return t}var rh,ih,oh,ah=Array.prototype.map,uh=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function ch(t){var n,e,r=void 0===t.grouping||void 0===t.thousands?eh:(n=ah.call(t.grouping,Number),e=t.thousands+"",function(t,r){for(var i=t.length,o=[],a=0,u=n[0],c=0;i>0&&u>0&&(c+u+1>r&&(u=Math.max(1,r-c)),o.push(t.substring(i-=u,i+u)),!((c+=u+1)>r));)u=n[a=(a+1)%n.length];return o.reverse().join(e)}),i=void 0===t.currency?"":t.currency[0]+"",o=void 0===t.currency?"":t.currency[1]+"",a=void 0===t.decimal?".":t.decimal+"",u=void 0===t.numerals?eh:function(t){return function(n){return n.replace(/[0-9]/g,(function(n){return t[+n]}))}}(ah.call(t.numerals,String)),c=void 0===t.percent?"%":t.percent+"",s=void 0===t.minus?"":t.minus+"",f=void 0===t.nan?"NaN":t.nan+"";function l(t){var n=(t=Kl(t)).fill,e=t.align,l=t.sign,h=t.symbol,d=t.zero,p=t.width,y=t.comma,g=t.precision,v=t.trim,m=t.type;"n"===m?(y=!0,m="g"):nh[m]||(void 0===g&&(g=12),v=!0,m="g"),(d||"0"===n&&"="===e)&&(d=!0,n="0",e="=");var b="$"===h?i:"#"===h&&/[boxX]/.test(m)?"0"+m.toLowerCase():"",x="$"===h?o:/[%p]/.test(m)?c:"",_=nh[m],w=/[defgprs%]/.test(m);function A(t){var i,o,c,h=b,A=x;if("c"===m)A=_(t)+A,t="";else{var S=(t=+t)<0||1/t<0;if(t=isNaN(t)?f:_(Math.abs(t),g),v&&(t=function(t){t:for(var n,e=t.length,r=1,i=-1;r<e;++r)switch(t[r]){case".":i=n=r;break;case"0":0===i&&(i=r),n=r;break;default:if(!+t[r])break t;i>0&&(i=0)}return i>0?t.slice(0,i)+t.slice(n+1):t}(t)),S&&0==+t&&"+"!==l&&(S=!1),h=(S?"("===l?l:s:"-"===l||"("===l?"":l)+h,A=("s"===m?uh[8+Ql/3]:"")+A+(S&&"("===l?")":""),w)for(i=-1,o=t.length;++i<o;)if(48>(c=t.charCodeAt(i))||c>57){A=(46===c?a+t.slice(i+1):t.slice(i))+A,t=t.slice(0,i);break}}y&&!d&&(t=r(t,1/0));var M=h.length+t.length+A.length,T=M<p?new Array(p-M+1).join(n):"";switch(y&&d&&(t=r(T+t,T.length?p-A.length:1/0),T=""),e){case"<":t=h+t+A+T;break;case"=":t=h+T+t+A;break;case"^":t=T.slice(0,M=T.length>>1)+h+t+A+T.slice(M);break;default:t=T+h+t+A}return u(t)}return g=void 0===g?6:/[gprs]/.test(m)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),A.toString=function(){return t+""},A}return{format:l,formatPrefix:function(t,n){var e=l(((t=Kl(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(Gl(n)/3))),i=Math.pow(10,-r),o=uh[8+r/3];return function(t){return e(i*t)+o}}}}function sh(t){return rh=ch(t),ih=rh.format,oh=rh.formatPrefix,rh}function fh(t){return Math.max(0,-Gl(Math.abs(t)))}function lh(t,n){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Gl(n)/3)))-Gl(Math.abs(t)))}function hh(t,n){return t=Math.abs(t),n=Math.abs(n)-t,Math.max(0,Gl(n)-Gl(t))+1}sh({thousands:",",grouping:[3],currency:["$",""]});var dh=1e-6,ph=1e-12,yh=Math.PI,gh=yh/2,vh=yh/4,mh=2*yh,bh=180/yh,xh=yh/180,_h=Math.abs,wh=Math.atan,Ah=Math.atan2,Sh=Math.cos,Mh=Math.ceil,Th=Math.exp,Eh=(Math.floor,Math.hypot),Ch=Math.log,kh=Math.pow,Nh=Math.sin,Oh=Math.sign||function(t){return t>0?1:t<0?-1:0},Ph=Math.sqrt,Ih=Math.tan;function Rh(t){return t>1?0:t<-1?yh:Math.acos(t)}function zh(t){return t>1?gh:t<-1?-gh:Math.asin(t)}function Vh(t){return(t=Nh(t/2))*t}function Dh(){}function jh(t,n){t&&Uh.hasOwnProperty(t.type)&&Uh[t.type](t,n)}var Lh={Feature:function(t,n){jh(t.geometry,n)},FeatureCollection:function(t,n){for(var e=t.features,r=-1,i=e.length;++r<i;)jh(e[r].geometry,n)}},Uh={Sphere:function(t,n){n.sphere()},Point:function(t,n){t=t.coordinates,n.point(t[0],t[1],t[2])},MultiPoint:function(t,n){for(var e=t.coordinates,r=-1,i=e.length;++r<i;)t=e[r],n.point(t[0],t[1],t[2])},LineString:function(t,n){Bh(t.coordinates,n,0)},MultiLineString:function(t,n){for(var e=t.coordinates,r=-1,i=e.length;++r<i;)Bh(e[r],n,0)},Polygon:function(t,n){Fh(t.coordinates,n)},MultiPolygon:function(t,n){for(var e=t.coordinates,r=-1,i=e.length;++r<i;)Fh(e[r],n)},GeometryCollection:function(t,n){for(var e=t.geometries,r=-1,i=e.length;++r<i;)jh(e[r],n)}};function Bh(t,n,e){var r,i=-1,o=t.length-e;for(n.lineStart();++i<o;)r=t[i],n.point(r[0],r[1],r[2]);n.lineEnd()}function Fh(t,n){var e=-1,r=t.length;for(n.polygonStart();++e<r;)Bh(t[e],n,1);n.polygonEnd()}function qh(t,n){t&&Lh.hasOwnProperty(t.type)?Lh[t.type](t,n):jh(t,n)}var Hh,Yh,Xh,$h,Wh,Gh,Qh,Zh,Kh,Jh,td,nd,ed,rd,id,od,ad=new L,ud=new L,cd={point:Dh,lineStart:Dh,lineEnd:Dh,polygonStart:function(){ad=new L,cd.lineStart=sd,cd.lineEnd=fd},polygonEnd:function(){var t=+ad;ud.add(t<0?mh+t:t),this.lineStart=this.lineEnd=this.point=Dh},sphere:function(){ud.add(mh)}};function sd(){cd.point=ld}function fd(){hd(Hh,Yh)}function ld(t,n){cd.point=hd,Hh=t,Yh=n,Xh=t*=xh,$h=Sh(n=(n*=xh)/2+vh),Wh=Nh(n)}function hd(t,n){var e=(t*=xh)-Xh,r=e>=0?1:-1,i=r*e,o=Sh(n=(n*=xh)/2+vh),a=Nh(n),u=Wh*a,c=$h*o+u*Sh(i),s=u*r*Nh(i);ad.add(Ah(s,c)),Xh=t,$h=o,Wh=a}function dd(t){return ud=new L,qh(t,cd),2*ud}function pd(t){return[Ah(t[1],t[0]),zh(t[2])]}function yd(t){var n=t[0],e=t[1],r=Sh(e);return[r*Sh(n),r*Nh(n),Nh(e)]}function gd(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]}function vd(t,n){return[t[1]*n[2]-t[2]*n[1],t[2]*n[0]-t[0]*n[2],t[0]*n[1]-t[1]*n[0]]}function md(t,n){t[0]+=n[0],t[1]+=n[1],t[2]+=n[2]}function bd(t,n){return[t[0]*n,t[1]*n,t[2]*n]}function xd(t){var n=Ph(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=n,t[1]/=n,t[2]/=n}var _d,wd,Ad,Sd,Md,Td,Ed,Cd,kd,Nd,Od,Pd,Id,Rd,zd,Vd,Dd={point:jd,lineStart:Ud,lineEnd:Bd,polygonStart:function(){Dd.point=Fd,Dd.lineStart=qd,Dd.lineEnd=Hd,rd=new L,cd.polygonStart()},polygonEnd:function(){cd.polygonEnd(),Dd.point=jd,Dd.lineStart=Ud,Dd.lineEnd=Bd,ad<0?(Gh=-(Zh=180),Qh=-(Kh=90)):rd>dh?Kh=90:rd<-1e-6&&(Qh=-90),od[0]=Gh,od[1]=Zh},sphere:function(){Gh=-(Zh=180),Qh=-(Kh=90)}};function jd(t,n){id.push(od=[Gh=t,Zh=t]),n<Qh&&(Qh=n),n>Kh&&(Kh=n)}function Ld(t,n){var e=yd([t*xh,n*xh]);if(ed){var r=vd(ed,e),i=vd([r[1],-r[0],0],r);xd(i),i=pd(i);var o,a=t-Jh,u=a>0?1:-1,c=i[0]*bh*u,s=_h(a)>180;s^(u*Jh<c&&c<u*t)?(o=i[1]*bh)>Kh&&(Kh=o):s^(u*Jh<(c=(c+360)%360-180)&&c<u*t)?(o=-i[1]*bh)<Qh&&(Qh=o):(n<Qh&&(Qh=n),n>Kh&&(Kh=n)),s?t<Jh?Yd(Gh,t)>Yd(Gh,Zh)&&(Zh=t):Yd(t,Zh)>Yd(Gh,Zh)&&(Gh=t):Zh>=Gh?(t<Gh&&(Gh=t),t>Zh&&(Zh=t)):t>Jh?Yd(Gh,t)>Yd(Gh,Zh)&&(Zh=t):Yd(t,Zh)>Yd(Gh,Zh)&&(Gh=t)}else id.push(od=[Gh=t,Zh=t]);n<Qh&&(Qh=n),n>Kh&&(Kh=n),ed=e,Jh=t}function Ud(){Dd.point=Ld}function Bd(){od[0]=Gh,od[1]=Zh,Dd.point=jd,ed=null}function Fd(t,n){if(ed){var e=t-Jh;rd.add(_h(e)>180?e+(e>0?360:-360):e)}else td=t,nd=n;cd.point(t,n),Ld(t,n)}function qd(){cd.lineStart()}function Hd(){Fd(td,nd),cd.lineEnd(),_h(rd)>dh&&(Gh=-(Zh=180)),od[0]=Gh,od[1]=Zh,ed=null}function Yd(t,n){return(n-=t)<0?n+360:n}function Xd(t,n){return t[0]-n[0]}function $d(t,n){return t[0]<=t[1]?t[0]<=n&&n<=t[1]:n<t[0]||t[1]<n}function Wd(t){var n,e,r,i,o,a,u;if(Kh=Zh=-(Gh=Qh=1/0),id=[],qh(t,Dd),e=id.length){for(id.sort(Xd),n=1,o=[r=id[0]];n<e;++n)$d(r,(i=id[n])[0])||$d(r,i[1])?(Yd(r[0],i[1])>Yd(r[0],r[1])&&(r[1]=i[1]),Yd(i[0],r[1])>Yd(r[0],r[1])&&(r[0]=i[0])):o.push(r=i);for(a=-1/0,n=0,r=o[e=o.length-1];n<=e;r=i,++n)i=o[n],(u=Yd(r[1],i[0]))>a&&(a=u,Gh=i[0],Zh=r[1])}return id=od=null,Gh===1/0||Qh===1/0?[[NaN,NaN],[NaN,NaN]]:[[Gh,Qh],[Zh,Kh]]}var Gd={sphere:Dh,point:Qd,lineStart:Kd,lineEnd:np,polygonStart:function(){Gd.lineStart=ep,Gd.lineEnd=rp},polygonEnd:function(){Gd.lineStart=Kd,Gd.lineEnd=np}};function Qd(t,n){t*=xh;var e=Sh(n*=xh);Zd(e*Sh(t),e*Nh(t),Nh(n))}function Zd(t,n,e){++_d,Ad+=(t-Ad)/_d,Sd+=(n-Sd)/_d,Md+=(e-Md)/_d}function Kd(){Gd.point=Jd}function Jd(t,n){t*=xh;var e=Sh(n*=xh);Rd=e*Sh(t),zd=e*Nh(t),Vd=Nh(n),Gd.point=tp,Zd(Rd,zd,Vd)}function tp(t,n){t*=xh;var e=Sh(n*=xh),r=e*Sh(t),i=e*Nh(t),o=Nh(n),a=Ah(Ph((a=zd*o-Vd*i)*a+(a=Vd*r-Rd*o)*a+(a=Rd*i-zd*r)*a),Rd*r+zd*i+Vd*o);wd+=a,Td+=a*(Rd+(Rd=r)),Ed+=a*(zd+(zd=i)),Cd+=a*(Vd+(Vd=o)),Zd(Rd,zd,Vd)}function np(){Gd.point=Qd}function ep(){Gd.point=ip}function rp(){op(Pd,Id),Gd.point=Qd}function ip(t,n){Pd=t,Id=n,t*=xh,n*=xh,Gd.point=op;var e=Sh(n);Rd=e*Sh(t),zd=e*Nh(t),Vd=Nh(n),Zd(Rd,zd,Vd)}function op(t,n){t*=xh;var e=Sh(n*=xh),r=e*Sh(t),i=e*Nh(t),o=Nh(n),a=zd*o-Vd*i,u=Vd*r-Rd*o,c=Rd*i-zd*r,s=Eh(a,u,c),f=zh(s),l=s&&-f/s;kd.add(l*a),Nd.add(l*u),Od.add(l*c),wd+=f,Td+=f*(Rd+(Rd=r)),Ed+=f*(zd+(zd=i)),Cd+=f*(Vd+(Vd=o)),Zd(Rd,zd,Vd)}function ap(t){_d=wd=Ad=Sd=Md=Td=Ed=Cd=0,kd=new L,Nd=new L,Od=new L,qh(t,Gd);var n=+kd,e=+Nd,r=+Od,i=Eh(n,e,r);return i<ph&&(n=Td,e=Ed,r=Cd,wd<dh&&(n=Ad,e=Sd,r=Md),(i=Eh(n,e,r))<ph)?[NaN,NaN]:[Ah(e,n)*bh,zh(r/i)*bh]}function up(t){return function(){return t}}function cp(t,n){function e(e,r){return e=t(e,r),n(e[0],e[1])}return t.invert&&n.invert&&(e.invert=function(e,r){return(e=n.invert(e,r))&&t.invert(e[0],e[1])}),e}function sp(t,n){return[_h(t)>yh?t+Math.round(-t/mh)*mh:t,n]}function fp(t,n,e){return(t%=mh)?n||e?cp(hp(t),dp(n,e)):hp(t):n||e?dp(n,e):sp}function lp(t){return function(n,e){return[(n+=t)>yh?n-mh:n<-yh?n+mh:n,e]}}function hp(t){var n=lp(t);return n.invert=lp(-t),n}function dp(t,n){var e=Sh(t),r=Nh(t),i=Sh(n),o=Nh(n);function a(t,n){var a=Sh(n),u=Sh(t)*a,c=Nh(t)*a,s=Nh(n),f=s*e+u*r;return[Ah(c*i-f*o,u*e-s*r),zh(f*i+c*o)]}return a.invert=function(t,n){var a=Sh(n),u=Sh(t)*a,c=Nh(t)*a,s=Nh(n),f=s*i-c*o;return[Ah(c*i+s*o,u*e+f*r),zh(f*e-u*r)]},a}function pp(t){function n(n){return(n=t(n[0]*xh,n[1]*xh))[0]*=bh,n[1]*=bh,n}return t=fp(t[0]*xh,t[1]*xh,t.length>2?t[2]*xh:0),n.invert=function(n){return(n=t.invert(n[0]*xh,n[1]*xh))[0]*=bh,n[1]*=bh,n},n}function yp(t,n,e,r,i,o){if(e){var a=Sh(n),u=Nh(n),c=r*e;null==i?(i=n+r*mh,o=n-c/2):(i=gp(a,i),o=gp(a,o),(r>0?i<o:i>o)&&(i+=r*mh));for(var s,f=i;r>0?f>o:f<o;f-=c)s=pd([a,-u*Sh(f),-u*Nh(f)]),t.point(s[0],s[1])}}function gp(t,n){(n=yd(n))[0]-=t,xd(n);var e=Rh(-n[1]);return((-n[2]<0?-e:e)+mh-dh)%mh}function vp(){var t,n,e=up([0,0]),r=up(90),i=up(6),o={point:function(e,r){t.push(e=n(e,r)),e[0]*=bh,e[1]*=bh}};function a(){var a=e.apply(this,arguments),u=r.apply(this,arguments)*xh,c=i.apply(this,arguments)*xh;return t=[],n=fp(-a[0]*xh,-a[1]*xh,0).invert,yp(o,u,c,1),a={type:"Polygon",coordinates:[t]},t=n=null,a}return a.center=function(t){return arguments.length?(e="function"==typeof t?t:up([+t[0],+t[1]]),a):e},a.radius=function(t){return arguments.length?(r="function"==typeof t?t:up(+t),a):r},a.precision=function(t){return arguments.length?(i="function"==typeof t?t:up(+t),a):i},a}function mp(){var t,n=[];return{point:function(n,e,r){t.push([n,e,r])},lineStart:function(){n.push(t=[])},lineEnd:Dh,rejoin:function(){n.length>1&&n.push(n.pop().concat(n.shift()))},result:function(){var e=n;return n=[],t=null,e}}}function bp(t,n){return _h(t[0]-n[0])<dh&&_h(t[1]-n[1])<dh}function xp(t,n,e,r){this.x=t,this.z=n,this.o=e,this.e=r,this.v=!1,this.n=this.p=null}function _p(t,n,e,r,i){var o,a,u=[],c=[];if(t.forEach((function(t){if(!((n=t.length-1)<=0)){var n,e,r=t[0],a=t[n];if(bp(r,a)){if(!r[2]&&!a[2]){for(i.lineStart(),o=0;o<n;++o)i.point((r=t[o])[0],r[1]);return void i.lineEnd()}a[0]+=2e-6}u.push(e=new xp(r,t,null,!0)),c.push(e.o=new xp(r,null,e,!1)),u.push(e=new xp(a,t,null,!1)),c.push(e.o=new xp(a,null,e,!0))}})),u.length){for(c.sort(n),wp(u),wp(c),o=0,a=c.length;o<a;++o)c[o].e=e=!e;for(var s,f,l=u[0];;){for(var h=l,d=!0;h.v;)if((h=h.n)===l)return;s=h.z,i.lineStart();do{if(h.v=h.o.v=!0,h.e){if(d)for(o=0,a=s.length;o<a;++o)i.point((f=s[o])[0],f[1]);else r(h.x,h.n.x,1,i);h=h.n}else{if(d)for(s=h.p.z,o=s.length-1;o>=0;--o)i.point((f=s[o])[0],f[1]);else r(h.x,h.p.x,-1,i);h=h.p}s=(h=h.o).z,d=!d}while(!h.v);i.lineEnd()}}}function wp(t){if(n=t.length){for(var n,e,r=0,i=t[0];++r<n;)i.n=e=t[r],e.p=i,i=e;i.n=e=t[0],e.p=i}}function Ap(t){return _h(t[0])<=yh?t[0]:Oh(t[0])*((_h(t[0])+yh)%mh-yh)}function Sp(t,n){var e=Ap(n),r=n[1],i=Nh(r),o=[Nh(e),-Sh(e),0],a=0,u=0,c=new L;1===i?r=gh+dh:-1===i&&(r=-gh-dh);for(var s=0,f=t.length;s<f;++s)if(h=(l=t[s]).length)for(var l,h,d=l[h-1],p=Ap(d),y=d[1]/2+vh,g=Nh(y),v=Sh(y),m=0;m<h;++m,p=x,g=w,v=A,d=b){var b=l[m],x=Ap(b),_=b[1]/2+vh,w=Nh(_),A=Sh(_),S=x-p,M=S>=0?1:-1,T=M*S,E=T>yh,C=g*w;if(c.add(Ah(C*M*Nh(T),v*A+C*Sh(T))),a+=E?S+M*mh:S,E^p>=e^x>=e){var k=vd(yd(d),yd(b));xd(k);var N=vd(o,k);xd(N);var O=(E^S>=0?-1:1)*zh(N[2]);(r>O||r===O&&(k[0]||k[1]))&&(u+=E^S>=0?1:-1)}}return(a<-1e-6||a<dh&&c<-1e-12)^1&u}function Mp(t,n,e,r){return function(i){var o,a,u,c=n(i),s=mp(),f=n(s),l=!1,h={point:d,lineStart:y,lineEnd:g,polygonStart:function(){h.point=v,h.lineStart=m,h.lineEnd=b,a=[],o=[]},polygonEnd:function(){h.point=d,h.lineStart=y,h.lineEnd=g,a=An(a);var t=Sp(o,r);a.length?(l||(i.polygonStart(),l=!0),_p(a,Ep,t,e,i)):t&&(l||(i.polygonStart(),l=!0),i.lineStart(),e(null,null,1,i),i.lineEnd()),l&&(i.polygonEnd(),l=!1),a=o=null},sphere:function(){i.polygonStart(),i.lineStart(),e(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function d(n,e){t(n,e)&&i.point(n,e)}function p(t,n){c.point(t,n)}function y(){h.point=p,c.lineStart()}function g(){h.point=d,c.lineEnd()}function v(t,n){u.push([t,n]),f.point(t,n)}function m(){f.lineStart(),u=[]}function b(){v(u[0][0],u[0][1]),f.lineEnd();var t,n,e,r,c=f.clean(),h=s.result(),d=h.length;if(u.pop(),o.push(u),u=null,d)if(1&c){if((n=(e=h[0]).length-1)>0){for(l||(i.polygonStart(),l=!0),i.lineStart(),t=0;t<n;++t)i.point((r=e[t])[0],r[1]);i.lineEnd()}}else d>1&&2&c&&h.push(h.pop().concat(h.shift())),a.push(h.filter(Tp))}return h}}function Tp(t){return t.length>1}function Ep(t,n){return((t=t.x)[0]<0?t[1]-gh-dh:gh-t[1])-((n=n.x)[0]<0?n[1]-gh-dh:gh-n[1])}sp.invert=sp;var Cp=Mp((function(){return!0}),(function(t){var n,e=NaN,r=NaN,i=NaN;return{lineStart:function(){t.lineStart(),n=1},point:function(o,a){var u=o>0?yh:-yh,c=_h(o-e);_h(c-yh)<dh?(t.point(e,r=(r+a)/2>0?gh:-gh),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(u,r),t.point(o,r),n=0):i!==u&&c>=yh&&(_h(e-i)<dh&&(e-=i*dh),_h(o-u)<dh&&(o-=u*dh),r=function(t,n,e,r){var i,o,a=Nh(t-e);return _h(a)>dh?wh((Nh(n)*(o=Sh(r))*Nh(e)-Nh(r)*(i=Sh(n))*Nh(t))/(i*o*a)):(n+r)/2}(e,r,o,a),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(u,r),n=0),t.point(e=o,r=a),i=u},lineEnd:function(){t.lineEnd(),e=r=NaN},clean:function(){return 2-n}}}),(function(t,n,e,r){var i;if(null==t)i=e*gh,r.point(-yh,i),r.point(0,i),r.point(yh,i),r.point(yh,0),r.point(yh,-i),r.point(0,-i),r.point(-yh,-i),r.point(-yh,0),r.point(-yh,i);else if(_h(t[0]-n[0])>dh){var o=t[0]<n[0]?yh:-yh;i=e*o/2,r.point(-o,i),r.point(0,i),r.point(o,i)}else r.point(n[0],n[1])}),[-yh,-gh]);function kp(t){var n=Sh(t),e=6*xh,r=n>0,i=_h(n)>dh;function o(t,e){return Sh(t)*Sh(e)>n}function a(t,e,r){var i=[1,0,0],o=vd(yd(t),yd(e)),a=gd(o,o),u=o[0],c=a-u*u;if(!c)return!r&&t;var s=n*a/c,f=-n*u/c,l=vd(i,o),h=bd(i,s);md(h,bd(o,f));var d=l,p=gd(h,d),y=gd(d,d),g=p*p-y*(gd(h,h)-1);if(!(g<0)){var v=Ph(g),m=bd(d,(-p-v)/y);if(md(m,h),m=pd(m),!r)return m;var b,x=t[0],_=e[0],w=t[1],A=e[1];_<x&&(b=x,x=_,_=b);var S=_-x,M=_h(S-yh)<dh;if(!M&&A<w&&(b=w,w=A,A=b),M||S<dh?M?w+A>0^m[1]<(_h(m[0]-x)<dh?w:A):w<=m[1]&&m[1]<=A:S>yh^(x<=m[0]&&m[0]<=_)){var T=bd(d,(-p+v)/y);return md(T,h),[m,pd(T)]}}}function u(n,e){var i=r?t:yh-t,o=0;return n<-i?o|=1:n>i&&(o|=2),e<-i?o|=4:e>i&&(o|=8),o}return Mp(o,(function(t){var n,e,c,s,f;return{lineStart:function(){s=c=!1,f=1},point:function(l,h){var d,p=[l,h],y=o(l,h),g=r?y?0:u(l,h):y?u(l+(l<0?yh:-yh),h):0;if(!n&&(s=c=y)&&t.lineStart(),y!==c&&(!(d=a(n,p))||bp(n,d)||bp(p,d))&&(p[2]=1),y!==c)f=0,y?(t.lineStart(),d=a(p,n),t.point(d[0],d[1])):(d=a(n,p),t.point(d[0],d[1],2),t.lineEnd()),n=d;else if(i&&n&&r^y){var v;g&e||!(v=a(p,n,!0))||(f=0,r?(t.lineStart(),t.point(v[0][0],v[0][1]),t.point(v[1][0],v[1][1]),t.lineEnd()):(t.point(v[1][0],v[1][1]),t.lineEnd(),t.lineStart(),t.point(v[0][0],v[0][1],3)))}!y||n&&bp(n,p)||t.point(p[0],p[1]),n=p,c=y,e=g},lineEnd:function(){c&&t.lineEnd(),n=null},clean:function(){return f|(s&&c)<<1}}}),(function(n,r,i,o){yp(o,t,e,i,n,r)}),r?[0,-t]:[-yh,t-yh])}var Np,Op,Pp,Ip,Rp=1e9,zp=-Rp;function Vp(t,n,e,r){function i(i,o){return t<=i&&i<=e&&n<=o&&o<=r}function o(i,o,u,s){var f=0,l=0;if(null==i||(f=a(i,u))!==(l=a(o,u))||c(i,o)<0^u>0)do{s.point(0===f||3===f?t:e,f>1?r:n)}while((f=(f+u+4)%4)!==l);else s.point(o[0],o[1])}function a(r,i){return _h(r[0]-t)<dh?i>0?0:3:_h(r[0]-e)<dh?i>0?2:1:_h(r[1]-n)<dh?i>0?1:0:i>0?3:2}function u(t,n){return c(t.x,n.x)}function c(t,n){var e=a(t,1),r=a(n,1);return e!==r?e-r:0===e?n[1]-t[1]:1===e?t[0]-n[0]:2===e?t[1]-n[1]:n[0]-t[0]}return function(a){var c,s,f,l,h,d,p,y,g,v,m,b=a,x=mp(),_={point:w,lineStart:function(){_.point=A,s&&s.push(f=[]);v=!0,g=!1,p=y=NaN},lineEnd:function(){c&&(A(l,h),d&&g&&x.rejoin(),c.push(x.result()));_.point=w,g&&b.lineEnd()},polygonStart:function(){b=x,c=[],s=[],m=!0},polygonEnd:function(){var n=function(){for(var n=0,e=0,i=s.length;e<i;++e)for(var o,a,u=s[e],c=1,f=u.length,l=u[0],h=l[0],d=l[1];c<f;++c)o=h,a=d,h=(l=u[c])[0],d=l[1],a<=r?d>r&&(h-o)*(r-a)>(d-a)*(t-o)&&++n:d<=r&&(h-o)*(r-a)<(d-a)*(t-o)&&--n;return n}(),e=m&&n,i=(c=An(c)).length;(e||i)&&(a.polygonStart(),e&&(a.lineStart(),o(null,null,1,a),a.lineEnd()),i&&_p(c,u,n,o,a),a.polygonEnd());b=a,c=s=f=null}};function w(t,n){i(t,n)&&b.point(t,n)}function A(o,a){var u=i(o,a);if(s&&f.push([o,a]),v)l=o,h=a,d=u,v=!1,u&&(b.lineStart(),b.point(o,a));else if(u&&g)b.point(o,a);else{var c=[p=Math.max(zp,Math.min(Rp,p)),y=Math.max(zp,Math.min(Rp,y))],x=[o=Math.max(zp,Math.min(Rp,o)),a=Math.max(zp,Math.min(Rp,a))];!function(t,n,e,r,i,o){var a,u=t[0],c=t[1],s=0,f=1,l=n[0]-u,h=n[1]-c;if(a=e-u,l||!(a>0)){if(a/=l,l<0){if(a<s)return;a<f&&(f=a)}else if(l>0){if(a>f)return;a>s&&(s=a)}if(a=i-u,l||!(a<0)){if(a/=l,l<0){if(a>f)return;a>s&&(s=a)}else if(l>0){if(a<s)return;a<f&&(f=a)}if(a=r-c,h||!(a>0)){if(a/=h,h<0){if(a<s)return;a<f&&(f=a)}else if(h>0){if(a>f)return;a>s&&(s=a)}if(a=o-c,h||!(a<0)){if(a/=h,h<0){if(a>f)return;a>s&&(s=a)}else if(h>0){if(a<s)return;a<f&&(f=a)}return s>0&&(t[0]=u+s*l,t[1]=c+s*h),f<1&&(n[0]=u+f*l,n[1]=c+f*h),!0}}}}}(c,x,t,n,e,r)?u&&(b.lineStart(),b.point(o,a),m=!1):(g||(b.lineStart(),b.point(c[0],c[1])),b.point(x[0],x[1]),u||b.lineEnd(),m=!1)}p=o,y=a,g=u}return _}}function Dp(){var t,n,e,r=0,i=0,o=960,a=500;return e={stream:function(e){return t&&n===e?t:t=Vp(r,i,o,a)(n=e)},extent:function(u){return arguments.length?(r=+u[0][0],i=+u[0][1],o=+u[1][0],a=+u[1][1],t=n=null,e):[[r,i],[o,a]]}}}var jp={sphere:Dh,point:Dh,lineStart:function(){jp.point=Up,jp.lineEnd=Lp},lineEnd:Dh,polygonStart:Dh,polygonEnd:Dh};function Lp(){jp.point=jp.lineEnd=Dh}function Up(t,n){Op=t*=xh,Pp=Nh(n*=xh),Ip=Sh(n),jp.point=Bp}function Bp(t,n){t*=xh;var e=Nh(n*=xh),r=Sh(n),i=_h(t-Op),o=Sh(i),a=r*Nh(i),u=Ip*e-Pp*r*o,c=Pp*e+Ip*r*o;Np.add(Ah(Ph(a*a+u*u),c)),Op=t,Pp=e,Ip=r}function Fp(t){return Np=new L,qh(t,jp),+Np}var qp=[null,null],Hp={type:"LineString",coordinates:qp};function Yp(t,n){return qp[0]=t,qp[1]=n,Fp(Hp)}var Xp={Feature:function(t,n){return Wp(t.geometry,n)},FeatureCollection:function(t,n){for(var e=t.features,r=-1,i=e.length;++r<i;)if(Wp(e[r].geometry,n))return!0;return!1}},$p={Sphere:function(){return!0},Point:function(t,n){return Gp(t.coordinates,n)},MultiPoint:function(t,n){for(var e=t.coordinates,r=-1,i=e.length;++r<i;)if(Gp(e[r],n))return!0;return!1},LineString:function(t,n){return Qp(t.coordinates,n)},MultiLineString:function(t,n){for(var e=t.coordinates,r=-1,i=e.length;++r<i;)if(Qp(e[r],n))return!0;return!1},Polygon:function(t,n){return Zp(t.coordinates,n)},MultiPolygon:function(t,n){for(var e=t.coordinates,r=-1,i=e.length;++r<i;)if(Zp(e[r],n))return!0;return!1},GeometryCollection:function(t,n){for(var e=t.geometries,r=-1,i=e.length;++r<i;)if(Wp(e[r],n))return!0;return!1}};function Wp(t,n){return!(!t||!$p.hasOwnProperty(t.type))&&$p[t.type](t,n)}function Gp(t,n){return 0===Yp(t,n)}function Qp(t,n){for(var e,r,i,o=0,a=t.length;o<a;o++){if(0===(r=Yp(t[o],n)))return!0;if(o>0&&(i=Yp(t[o],t[o-1]))>0&&e<=i&&r<=i&&(e+r-i)*(1-Math.pow((e-r)/i,2))<ph*i)return!0;e=r}return!1}function Zp(t,n){return!!Sp(t.map(Kp),Jp(n))}function Kp(t){return(t=t.map(Jp)).pop(),t}function Jp(t){return[t[0]*xh,t[1]*xh]}function ty(t,n){return(t&&Xp.hasOwnProperty(t.type)?Xp[t.type]:Wp)(t,n)}function ny(t,n,e){var r=Vn(t,n-dh,e).concat(n);return function(t){return r.map((function(n){return[t,n]}))}}function ey(t,n,e){var r=Vn(t,n-dh,e).concat(n);return function(t){return r.map((function(n){return[n,t]}))}}function ry(){var t,n,e,r,i,o,a,u,c,s,f,l,h=10,d=h,p=90,y=360,g=2.5;function v(){return{type:"MultiLineString",coordinates:m()}}function m(){return Vn(Mh(r/p)*p,e,p).map(f).concat(Vn(Mh(u/y)*y,a,y).map(l)).concat(Vn(Mh(n/h)*h,t,h).filter((function(t){return _h(t%p)>dh})).map(c)).concat(Vn(Mh(o/d)*d,i,d).filter((function(t){return _h(t%y)>dh})).map(s))}return v.lines=function(){return m().map((function(t){return{type:"LineString",coordinates:t}}))},v.outline=function(){return{type:"Polygon",coordinates:[f(r).concat(l(a).slice(1),f(e).reverse().slice(1),l(u).reverse().slice(1))]}},v.extent=function(t){return arguments.length?v.extentMajor(t).extentMinor(t):v.extentMinor()},v.extentMajor=function(t){return arguments.length?(r=+t[0][0],e=+t[1][0],u=+t[0][1],a=+t[1][1],r>e&&(t=r,r=e,e=t),u>a&&(t=u,u=a,a=t),v.precision(g)):[[r,u],[e,a]]},v.extentMinor=function(e){return arguments.length?(n=+e[0][0],t=+e[1][0],o=+e[0][1],i=+e[1][1],n>t&&(e=n,n=t,t=e),o>i&&(e=o,o=i,i=e),v.precision(g)):[[n,o],[t,i]]},v.step=function(t){return arguments.length?v.stepMajor(t).stepMinor(t):v.stepMinor()},v.stepMajor=function(t){return arguments.length?(p=+t[0],y=+t[1],v):[p,y]},v.stepMinor=function(t){return arguments.length?(h=+t[0],d=+t[1],v):[h,d]},v.precision=function(h){return arguments.length?(g=+h,c=ny(o,i,90),s=ey(n,t,g),f=ny(u,a,90),l=ey(r,e,g),v):g},v.extentMajor([[-180,-89.999999],[180,89.999999]]).extentMinor([[-180,-80.000001],[180,80.000001]])}function iy(){return ry()()}function oy(t,n){var e=t[0]*xh,r=t[1]*xh,i=n[0]*xh,o=n[1]*xh,a=Sh(r),u=Nh(r),c=Sh(o),s=Nh(o),f=a*Sh(e),l=a*Nh(e),h=c*Sh(i),d=c*Nh(i),p=2*zh(Ph(Vh(o-r)+a*c*Vh(i-e))),y=Nh(p),g=p?function(t){var n=Nh(t*=p)/y,e=Nh(p-t)/y,r=e*f+n*h,i=e*l+n*d,o=e*u+n*s;return[Ah(i,r)*bh,Ah(o,Ph(r*r+i*i))*bh]}:function(){return[e*bh,r*bh]};return g.distance=p,g}var ay,uy,cy,sy,fy=function(t){return t},ly=new L,hy=new L,dy={point:Dh,lineStart:Dh,lineEnd:Dh,polygonStart:function(){dy.lineStart=py,dy.lineEnd=vy},polygonEnd:function(){dy.lineStart=dy.lineEnd=dy.point=Dh,ly.add(_h(hy)),hy=new L},result:function(){var t=ly/2;return ly=new L,t}};function py(){dy.point=yy}function yy(t,n){dy.point=gy,ay=cy=t,uy=sy=n}function gy(t,n){hy.add(sy*t-cy*n),cy=t,sy=n}function vy(){gy(ay,uy)}var my=dy,by=1/0,xy=by,_y=-by,wy=_y;var Ay,Sy,My,Ty,Ey={point:function(t,n){t<by&&(by=t);t>_y&&(_y=t);n<xy&&(xy=n);n>wy&&(wy=n)},lineStart:Dh,lineEnd:Dh,polygonStart:Dh,polygonEnd:Dh,result:function(){var t=[[by,xy],[_y,wy]];return _y=wy=-(xy=by=1/0),t}},Cy=0,ky=0,Ny=0,Oy=0,Py=0,Iy=0,Ry=0,zy=0,Vy=0,Dy={point:jy,lineStart:Ly,lineEnd:Fy,polygonStart:function(){Dy.lineStart=qy,Dy.lineEnd=Hy},polygonEnd:function(){Dy.point=jy,Dy.lineStart=Ly,Dy.lineEnd=Fy},result:function(){var t=Vy?[Ry/Vy,zy/Vy]:Iy?[Oy/Iy,Py/Iy]:Ny?[Cy/Ny,ky/Ny]:[NaN,NaN];return Cy=ky=Ny=Oy=Py=Iy=Ry=zy=Vy=0,t}};function jy(t,n){Cy+=t,ky+=n,++Ny}function Ly(){Dy.point=Uy}function Uy(t,n){Dy.point=By,jy(My=t,Ty=n)}function By(t,n){var e=t-My,r=n-Ty,i=Ph(e*e+r*r);Oy+=i*(My+t)/2,Py+=i*(Ty+n)/2,Iy+=i,jy(My=t,Ty=n)}function Fy(){Dy.point=jy}function qy(){Dy.point=Yy}function Hy(){Xy(Ay,Sy)}function Yy(t,n){Dy.point=Xy,jy(Ay=My=t,Sy=Ty=n)}function Xy(t,n){var e=t-My,r=n-Ty,i=Ph(e*e+r*r);Oy+=i*(My+t)/2,Py+=i*(Ty+n)/2,Iy+=i,Ry+=(i=Ty*t-My*n)*(My+t),zy+=i*(Ty+n),Vy+=3*i,jy(My=t,Ty=n)}var $y=Dy;function Wy(t){this._context=t}Wy.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(t,n){switch(this._point){case 0:this._context.moveTo(t,n),this._point=1;break;case 1:this._context.lineTo(t,n);break;default:this._context.moveTo(t+this._radius,n),this._context.arc(t,n,this._radius,0,mh)}},result:Dh};var Gy,Qy,Zy,Ky,Jy,tg=new L,ng={point:Dh,lineStart:function(){ng.point=eg},lineEnd:function(){Gy&&rg(Qy,Zy),ng.point=Dh},polygonStart:function(){Gy=!0},polygonEnd:function(){Gy=null},result:function(){var t=+tg;return tg=new L,t}};function eg(t,n){ng.point=rg,Qy=Ky=t,Zy=Jy=n}function rg(t,n){Ky-=t,Jy-=n,tg.add(Ph(Ky*Ky+Jy*Jy)),Ky=t,Jy=n}var ig=ng;function og(){this._string=[]}function ag(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}function ug(t,n){var e,r,i=4.5;function o(t){return t&&("function"==typeof i&&r.pointRadius(+i.apply(this,arguments)),qh(t,e(r))),r.result()}return o.area=function(t){return qh(t,e(my)),my.result()},o.measure=function(t){return qh(t,e(ig)),ig.result()},o.bounds=function(t){return qh(t,e(Ey)),Ey.result()},o.centroid=function(t){return qh(t,e($y)),$y.result()},o.projection=function(n){return arguments.length?(e=null==n?(t=null,fy):(t=n).stream,o):t},o.context=function(t){return arguments.length?(r=null==t?(n=null,new og):new Wy(n=t),"function"!=typeof i&&r.pointRadius(i),o):n},o.pointRadius=function(t){return arguments.length?(i="function"==typeof t?t:(r.pointRadius(+t),+t),o):i},o.projection(t).context(n)}function cg(t){return{stream:sg(t)}}function sg(t){return function(n){var e=new fg;for(var r in t)e[r]=t[r];return e.stream=n,e}}function fg(){}function lg(t,n,e){var r=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),null!=r&&t.clipExtent(null),qh(e,t.stream(Ey)),n(Ey.result()),null!=r&&t.clipExtent(r),t}function hg(t,n,e){return lg(t,(function(e){var r=n[1][0]-n[0][0],i=n[1][1]-n[0][1],o=Math.min(r/(e[1][0]-e[0][0]),i/(e[1][1]-e[0][1])),a=+n[0][0]+(r-o*(e[1][0]+e[0][0]))/2,u=+n[0][1]+(i-o*(e[1][1]+e[0][1]))/2;t.scale(150*o).translate([a,u])}),e)}function dg(t,n,e){return hg(t,[[0,0],n],e)}function pg(t,n,e){return lg(t,(function(e){var r=+n,i=r/(e[1][0]-e[0][0]),o=(r-i*(e[1][0]+e[0][0]))/2,a=-i*e[0][1];t.scale(150*i).translate([o,a])}),e)}function yg(t,n,e){return lg(t,(function(e){var r=+n,i=r/(e[1][1]-e[0][1]),o=-i*e[0][0],a=(r-i*(e[1][1]+e[0][1]))/2;t.scale(150*i).translate([o,a])}),e)}og.prototype={_radius:4.5,_circle:ag(4.5),pointRadius:function(t){return(t=+t)!==this._radius&&(this._radius=t,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(t,n){switch(this._point){case 0:this._string.push("M",t,",",n),this._point=1;break;case 1:this._string.push("L",t,",",n);break;default:null==this._circle&&(this._circle=ag(this._radius)),this._string.push("M",t,",",n,this._circle)}},result:function(){if(this._string.length){var t=this._string.join("");return this._string=[],t}return null}},fg.prototype={constructor:fg,point:function(t,n){this.stream.point(t,n)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var gg=Sh(30*xh);function vg(t,n){return+n?function(t,n){function e(r,i,o,a,u,c,s,f,l,h,d,p,y,g){var v=s-r,m=f-i,b=v*v+m*m;if(b>4*n&&y--){var x=a+h,_=u+d,w=c+p,A=Ph(x*x+_*_+w*w),S=zh(w/=A),M=_h(_h(w)-1)<dh||_h(o-l)<dh?(o+l)/2:Ah(_,x),T=t(M,S),E=T[0],C=T[1],k=E-r,N=C-i,O=m*k-v*N;(O*O/b>n||_h((v*k+m*N)/b-.5)>.3||a*h+u*d+c*p<gg)&&(e(r,i,o,a,u,c,E,C,M,x/=A,_/=A,w,y,g),g.point(E,C),e(E,C,M,x,_,w,s,f,l,h,d,p,y,g))}}return function(n){var r,i,o,a,u,c,s,f,l,h,d,p,y={point:g,lineStart:v,lineEnd:b,polygonStart:function(){n.polygonStart(),y.lineStart=x},polygonEnd:function(){n.polygonEnd(),y.lineStart=v}};function g(e,r){e=t(e,r),n.point(e[0],e[1])}function v(){f=NaN,y.point=m,n.lineStart()}function m(r,i){var o=yd([r,i]),a=t(r,i);e(f,l,s,h,d,p,f=a[0],l=a[1],s=r,h=o[0],d=o[1],p=o[2],16,n),n.point(f,l)}function b(){y.point=g,n.lineEnd()}function x(){v(),y.point=_,y.lineEnd=w}function _(t,n){m(r=t,n),i=f,o=l,a=h,u=d,c=p,y.point=m}function w(){e(f,l,s,h,d,p,i,o,r,a,u,c,16,n),y.lineEnd=b,b()}return y}}(t,n):function(t){return sg({point:function(n,e){n=t(n,e),this.stream.point(n[0],n[1])}})}(t)}var mg=sg({point:function(t,n){this.stream.point(t*xh,n*xh)}});function bg(t,n,e,r,i,o){if(!o)return function(t,n,e,r,i){function o(o,a){return[n+t*(o*=r),e-t*(a*=i)]}return o.invert=function(o,a){return[(o-n)/t*r,(e-a)/t*i]},o}(t,n,e,r,i);var a=Sh(o),u=Nh(o),c=a*t,s=u*t,f=a/t,l=u/t,h=(u*e-a*n)/t,d=(u*n+a*e)/t;function p(t,o){return[c*(t*=r)-s*(o*=i)+n,e-s*t-c*o]}return p.invert=function(t,n){return[r*(f*t-l*n+h),i*(d-l*t-f*n)]},p}function xg(t){return _g((function(){return t}))()}function _g(t){var n,e,r,i,o,a,u,c,s,f,l=150,h=480,d=250,p=0,y=0,g=0,v=0,m=0,b=0,x=1,_=1,w=null,A=Cp,S=null,M=fy,T=.5;function E(t){return c(t[0]*xh,t[1]*xh)}function C(t){return(t=c.invert(t[0],t[1]))&&[t[0]*bh,t[1]*bh]}function k(){var t=bg(l,0,0,x,_,b).apply(null,n(p,y)),r=bg(l,h-t[0],d-t[1],x,_,b);return e=fp(g,v,m),u=cp(n,r),c=cp(e,u),a=vg(u,T),N()}function N(){return s=f=null,E}return E.stream=function(t){return s&&f===t?s:s=mg(function(t){return sg({point:function(n,e){var r=t(n,e);return this.stream.point(r[0],r[1])}})}(e)(A(a(M(f=t)))))},E.preclip=function(t){return arguments.length?(A=t,w=void 0,N()):A},E.postclip=function(t){return arguments.length?(M=t,S=r=i=o=null,N()):M},E.clipAngle=function(t){return arguments.length?(A=+t?kp(w=t*xh):(w=null,Cp),N()):w*bh},E.clipExtent=function(t){return arguments.length?(M=null==t?(S=r=i=o=null,fy):Vp(S=+t[0][0],r=+t[0][1],i=+t[1][0],o=+t[1][1]),N()):null==S?null:[[S,r],[i,o]]},E.scale=function(t){return arguments.length?(l=+t,k()):l},E.translate=function(t){return arguments.length?(h=+t[0],d=+t[1],k()):[h,d]},E.center=function(t){return arguments.length?(p=t[0]%360*xh,y=t[1]%360*xh,k()):[p*bh,y*bh]},E.rotate=function(t){return arguments.length?(g=t[0]%360*xh,v=t[1]%360*xh,m=t.length>2?t[2]%360*xh:0,k()):[g*bh,v*bh,m*bh]},E.angle=function(t){return arguments.length?(b=t%360*xh,k()):b*bh},E.reflectX=function(t){return arguments.length?(x=t?-1:1,k()):x<0},E.reflectY=function(t){return arguments.length?(_=t?-1:1,k()):_<0},E.precision=function(t){return arguments.length?(a=vg(u,T=t*t),N()):Ph(T)},E.fitExtent=function(t,n){return hg(E,t,n)},E.fitSize=function(t,n){return dg(E,t,n)},E.fitWidth=function(t,n){return pg(E,t,n)},E.fitHeight=function(t,n){return yg(E,t,n)},function(){return n=t.apply(this,arguments),E.invert=n.invert&&C,k()}}function wg(t){var n=0,e=yh/3,r=_g(t),i=r(n,e);return i.parallels=function(t){return arguments.length?r(n=t[0]*xh,e=t[1]*xh):[n*bh,e*bh]},i}function Ag(t,n){var e=Nh(t),r=(e+Nh(n))/2;if(_h(r)<dh)return function(t){var n=Sh(t);function e(t,e){return[t*n,Nh(e)/n]}return e.invert=function(t,e){return[t/n,zh(e*n)]},e}(t);var i=1+e*(2*r-e),o=Ph(i)/r;function a(t,n){var e=Ph(i-2*r*Nh(n))/r;return[e*Nh(t*=r),o-e*Sh(t)]}return a.invert=function(t,n){var e=o-n,a=Ah(t,_h(e))*Oh(e);return e*r<0&&(a-=yh*Oh(t)*Oh(e)),[a/r,zh((i-(t*t+e*e)*r*r)/(2*r))]},a}function Sg(){return wg(Ag).scale(155.424).center([0,33.6442])}function Mg(){return Sg().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function Tg(){var t,n,e,r,i,o,a=Mg(),u=Sg().rotate([154,0]).center([-2,58.5]).parallels([55,65]),c=Sg().rotate([157,0]).center([-3,19.9]).parallels([8,18]),s={point:function(t,n){o=[t,n]}};function f(t){var n=t[0],a=t[1];return o=null,e.point(n,a),o||(r.point(n,a),o)||(i.point(n,a),o)}function l(){return t=n=null,f}return f.invert=function(t){var n=a.scale(),e=a.translate(),r=(t[0]-e[0])/n,i=(t[1]-e[1])/n;return(i>=.12&&i<.234&&r>=-.425&&r<-.214?u:i>=.166&&i<.234&&r>=-.214&&r<-.115?c:a).invert(t)},f.stream=function(e){return t&&n===e?t:(r=[a.stream(n=e),u.stream(e),c.stream(e)],i=r.length,t={point:function(t,n){for(var e=-1;++e<i;)r[e].point(t,n)},sphere:function(){for(var t=-1;++t<i;)r[t].sphere()},lineStart:function(){for(var t=-1;++t<i;)r[t].lineStart()},lineEnd:function(){for(var t=-1;++t<i;)r[t].lineEnd()},polygonStart:function(){for(var t=-1;++t<i;)r[t].polygonStart()},polygonEnd:function(){for(var t=-1;++t<i;)r[t].polygonEnd()}});var r,i},f.precision=function(t){return arguments.length?(a.precision(t),u.precision(t),c.precision(t),l()):a.precision()},f.scale=function(t){return arguments.length?(a.scale(t),u.scale(.35*t),c.scale(t),f.translate(a.translate())):a.scale()},f.translate=function(t){if(!arguments.length)return a.translate();var n=a.scale(),o=+t[0],f=+t[1];return e=a.translate(t).clipExtent([[o-.455*n,f-.238*n],[o+.455*n,f+.238*n]]).stream(s),r=u.translate([o-.307*n,f+.201*n]).clipExtent([[o-.425*n+dh,f+.12*n+dh],[o-.214*n-dh,f+.234*n-dh]]).stream(s),i=c.translate([o-.205*n,f+.212*n]).clipExtent([[o-.214*n+dh,f+.166*n+dh],[o-.115*n-dh,f+.234*n-dh]]).stream(s),l()},f.fitExtent=function(t,n){return hg(f,t,n)},f.fitSize=function(t,n){return dg(f,t,n)},f.fitWidth=function(t,n){return pg(f,t,n)},f.fitHeight=function(t,n){return yg(f,t,n)},f.scale(1070)}function Eg(t){return function(n,e){var r=Sh(n),i=Sh(e),o=t(r*i);return o===1/0?[2,0]:[o*i*Nh(n),o*Nh(e)]}}function Cg(t){return function(n,e){var r=Ph(n*n+e*e),i=t(r),o=Nh(i),a=Sh(i);return[Ah(n*o,r*a),zh(r&&e*o/r)]}}var kg=Eg((function(t){return Ph(2/(1+t))}));function Ng(){return xg(kg).scale(124.75).clipAngle(179.999)}kg.invert=Cg((function(t){return 2*zh(t/2)}));var Og=Eg((function(t){return(t=Rh(t))&&t/Nh(t)}));function Pg(){return xg(Og).scale(79.4188).clipAngle(179.999)}function Ig(t,n){return[t,Ch(Ih((gh+n)/2))]}function Rg(){return zg(Ig).scale(961/mh)}function zg(t){var n,e,r,i=xg(t),o=i.center,a=i.scale,u=i.translate,c=i.clipExtent,s=null;function f(){var o=yh*a(),u=i(pp(i.rotate()).invert([0,0]));return c(null==s?[[u[0]-o,u[1]-o],[u[0]+o,u[1]+o]]:t===Ig?[[Math.max(u[0]-o,s),n],[Math.min(u[0]+o,e),r]]:[[s,Math.max(u[1]-o,n)],[e,Math.min(u[1]+o,r)]])}return i.scale=function(t){return arguments.length?(a(t),f()):a()},i.translate=function(t){return arguments.length?(u(t),f()):u()},i.center=function(t){return arguments.length?(o(t),f()):o()},i.clipExtent=function(t){return arguments.length?(null==t?s=n=e=r=null:(s=+t[0][0],n=+t[0][1],e=+t[1][0],r=+t[1][1]),f()):null==s?null:[[s,n],[e,r]]},f()}function Vg(t){return Ih((gh+t)/2)}function Dg(t,n){var e=Sh(t),r=t===n?Nh(t):Ch(e/Sh(n))/Ch(Vg(n)/Vg(t)),i=e*kh(Vg(t),r)/r;if(!r)return Ig;function o(t,n){i>0?n<-gh+dh&&(n=-gh+dh):n>gh-dh&&(n=gh-dh);var e=i/kh(Vg(n),r);return[e*Nh(r*t),i-e*Sh(r*t)]}return o.invert=function(t,n){var e=i-n,o=Oh(r)*Ph(t*t+e*e),a=Ah(t,_h(e))*Oh(e);return e*r<0&&(a-=yh*Oh(t)*Oh(e)),[a/r,2*wh(kh(i/o,1/r))-gh]},o}function jg(){return wg(Dg).scale(109.5).parallels([30,30])}function Lg(t,n){return[t,n]}function Ug(){return xg(Lg).scale(152.63)}function Bg(t,n){var e=Sh(t),r=t===n?Nh(t):(e-Sh(n))/(n-t),i=e/r+t;if(_h(r)<dh)return Lg;function o(t,n){var e=i-n,o=r*t;return[e*Nh(o),i-e*Sh(o)]}return o.invert=function(t,n){var e=i-n,o=Ah(t,_h(e))*Oh(e);return e*r<0&&(o-=yh*Oh(t)*Oh(e)),[o/r,i-Oh(r)*Ph(t*t+e*e)]},o}function Fg(){return wg(Bg).scale(131.154).center([0,13.9389])}Og.invert=Cg((function(t){return t})),Ig.invert=function(t,n){return[t,2*wh(Th(n))-gh]},Lg.invert=Lg;var qg=1.340264,Hg=-.081106,Yg=893e-6,Xg=.003796,$g=Ph(3)/2;function Wg(t,n){var e=zh($g*Nh(n)),r=e*e,i=r*r*r;return[t*Sh(e)/($g*(qg+3*Hg*r+i*(7*Yg+9*Xg*r))),e*(qg+Hg*r+i*(Yg+Xg*r))]}function Gg(){return xg(Wg).scale(177.158)}function Qg(t,n){var e=Sh(n),r=Sh(t)*e;return[e*Nh(t)/r,Nh(n)/r]}function Zg(){return xg(Qg).scale(144.049).clipAngle(60)}function Kg(){var t,n,e,r,i,o,a,u=1,c=0,s=0,f=1,l=1,h=0,d=null,p=1,y=1,g=sg({point:function(t,n){var e=b([t,n]);this.stream.point(e[0],e[1])}}),v=fy;function m(){return p=u*f,y=u*l,o=a=null,b}function b(e){var r=e[0]*p,i=e[1]*y;if(h){var o=i*t-r*n;r=r*t+i*n,i=o}return[r+c,i+s]}return b.invert=function(e){var r=e[0]-c,i=e[1]-s;if(h){var o=i*t+r*n;r=r*t-i*n,i=o}return[r/p,i/y]},b.stream=function(t){return o&&a===t?o:o=g(v(a=t))},b.postclip=function(t){return arguments.length?(v=t,d=e=r=i=null,m()):v},b.clipExtent=function(t){return arguments.length?(v=null==t?(d=e=r=i=null,fy):Vp(d=+t[0][0],e=+t[0][1],r=+t[1][0],i=+t[1][1]),m()):null==d?null:[[d,e],[r,i]]},b.scale=function(t){return arguments.length?(u=+t,m()):u},b.translate=function(t){return arguments.length?(c=+t[0],s=+t[1],m()):[c,s]},b.angle=function(e){return arguments.length?(n=Nh(h=e%360*xh),t=Sh(h),m()):h*bh},b.reflectX=function(t){return arguments.length?(f=t?-1:1,m()):f<0},b.reflectY=function(t){return arguments.length?(l=t?-1:1,m()):l<0},b.fitExtent=function(t,n){return hg(b,t,n)},b.fitSize=function(t,n){return dg(b,t,n)},b.fitWidth=function(t,n){return pg(b,t,n)},b.fitHeight=function(t,n){return yg(b,t,n)},b}function Jg(t,n){var e=n*n,r=e*e;return[t*(.8707-.131979*e+r*(r*(.003971*e-.001529*r)-.013791)),n*(1.007226+e*(.015085+r*(.028874*e-.044475-.005916*r)))]}function tv(){return xg(Jg).scale(175.295)}function nv(t,n){return[Sh(n)*Nh(t),Nh(n)]}function ev(){return xg(nv).scale(249.5).clipAngle(90.000001)}function rv(t,n){var e=Sh(n),r=1+Sh(t)*e;return[e*Nh(t)/r,Nh(n)/r]}function iv(){return xg(rv).scale(250).clipAngle(142)}function ov(t,n){return[Ch(Ih((gh+n)/2)),-t]}function av(){var t=zg(ov),n=t.center,e=t.rotate;return t.center=function(t){return arguments.length?n([-t[1],t[0]]):[(t=n())[1],-t[0]]},t.rotate=function(t){return arguments.length?e([t[0],t[1],t.length>2?t[2]+90:90]):[(t=e())[0],t[1],t[2]-90]},e([0,0,90]).scale(159.155)}function uv(t,n){return t.parent===n.parent?1:2}function cv(t,n){return t+n.x}function sv(t,n){return Math.max(t,n.y)}function fv(){var t=uv,n=1,e=1,r=!1;function i(i){var o,a=0;i.eachAfter((function(n){var e=n.children;e?(n.x=function(t){return t.reduce(cv,0)/t.length}(e),n.y=function(t){return 1+t.reduce(sv,0)}(e)):(n.x=o?a+=t(n,o):0,n.y=0,o=n)}));var u=function(t){for(var n;n=t.children;)t=n[0];return t}(i),c=function(t){for(var n;n=t.children;)t=n[n.length-1];return t}(i),s=u.x-t(u,c)/2,f=c.x+t(c,u)/2;return i.eachAfter(r?function(t){t.x=(t.x-i.x)*n,t.y=(i.y-t.y)*e}:function(t){t.x=(t.x-s)/(f-s)*n,t.y=(1-(i.y?t.y/i.y:1))*e})}return i.separation=function(n){return arguments.length?(t=n,i):t},i.size=function(t){return arguments.length?(r=!1,n=+t[0],e=+t[1],i):r?null:[n,e]},i.nodeSize=function(t){return arguments.length?(r=!0,n=+t[0],e=+t[1],i):r?[n,e]:null},i}function lv(t){var n=0,e=t.children,r=e&&e.length;if(r)for(;--r>=0;)n+=e[r].value;else n=1;t.value=n}function hv(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return dv(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return dv(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function dv(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function pv(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return yv(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return yv(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function yv(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}Wg.invert=function(t,n){for(var e,r=n,i=r*r,o=i*i*i,a=0;a<12&&(o=(i=(r-=e=(r*(qg+Hg*i+o*(Yg+Xg*i))-n)/(qg+3*Hg*i+o*(7*Yg+9*Xg*i)))*r)*i*i,!(_h(e)<ph));++a);return[$g*t*(qg+3*Hg*i+o*(7*Yg+9*Xg*i))/Sh(r),zh(Nh(r)/$g)]},Qg.invert=Cg(wh),Jg.invert=function(t,n){var e,r=n,i=25;do{var o=r*r,a=o*o;r-=e=(r*(1.007226+o*(.015085+a*(.028874*o-.044475-.005916*a)))-n)/(1.007226+o*(.045255+a*(.259866*o-.311325-.005916*11*a)))}while(_h(e)>dh&&--i>0);return[t/(.8707+(o=r*r)*(o*(o*o*o*(.003971-.001529*o)-.013791)-.131979)),r]},nv.invert=Cg(zh),rv.invert=Cg((function(t){return 2*wh(t)})),ov.invert=function(t,n){return[-n,2*wh(Th(t))-gh]};var gv=o.mark(vv);function vv(){var t,n,e,r,i,a;return o.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:e=[t=this];case 1:n=e.reverse(),e=[];case 2:if(!(t=n.pop())){o.next=8;break}return o.next=5,t;case 5:if(r=t.children)for(i=0,a=r.length;i<a;++i)e.push(r[i]);o.next=2;break;case 8:if(e.length){o.next=1;break}case 9:case"end":return o.stop()}}),gv,this)}function mv(t,n){t instanceof Map?(t=[void 0,t],void 0===n&&(n=xv)):void 0===n&&(n=bv);for(var e,r,i,o,a,u=new Av(t),c=[u];e=c.pop();)if((i=n(e.data))&&(a=(i=Array.from(i)).length))for(e.children=i,o=a-1;o>=0;--o)c.push(r=i[o]=new Av(i[o])),r.parent=e,r.depth=e.depth+1;return u.eachBefore(wv)}function bv(t){return t.children}function xv(t){return Array.isArray(t)?t[1]:null}function _v(t){void 0!==t.data.value&&(t.value=t.data.value),t.data=t.data.data}function wv(t){var n=0;do{t.height=n}while((t=t.parent)&&t.height<++n)}function Av(t){this.data=t,this.depth=this.height=0,this.parent=null}function Sv(t){return(Sv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Mv(t){for(var n,e,r=0,i=(t=function(t){for(var n,e,r=t.length;r;)e=Math.random()*r--|0,n=t[r],t[r]=t[e],t[e]=n;return t}(Array.from(t))).length,o=[];r<i;)n=t[r],e&&Cv(e,n)?++r:(e=Nv(o=Tv(o,n)),r=0);return e}function Tv(t,n){var e,r;if(kv(n,t))return[n];for(e=0;e<t.length;++e)if(Ev(n,t[e])&&kv(Ov(t[e],n),t))return[t[e],n];for(e=0;e<t.length-1;++e)for(r=e+1;r<t.length;++r)if(Ev(Ov(t[e],t[r]),n)&&Ev(Ov(t[e],n),t[r])&&Ev(Ov(t[r],n),t[e])&&kv(Pv(t[e],t[r],n),t))return[t[e],t[r],n];throw new Error}function Ev(t,n){var e=t.r-n.r,r=n.x-t.x,i=n.y-t.y;return e<0||e*e<r*r+i*i}function Cv(t,n){var e=t.r-n.r+1e-9*Math.max(t.r,n.r,1),r=n.x-t.x,i=n.y-t.y;return e>0&&e*e>r*r+i*i}function kv(t,n){for(var e=0;e<n.length;++e)if(!Cv(t,n[e]))return!1;return!0}function Nv(t){switch(t.length){case 1:return function(t){return{x:t.x,y:t.y,r:t.r}}(t[0]);case 2:return Ov(t[0],t[1]);case 3:return Pv(t[0],t[1],t[2])}}function Ov(t,n){var e=t.x,r=t.y,i=t.r,o=n.x,a=n.y,u=n.r,c=o-e,s=a-r,f=u-i,l=Math.sqrt(c*c+s*s);return{x:(e+o+c/l*f)/2,y:(r+a+s/l*f)/2,r:(l+i+u)/2}}function Pv(t,n,e){var r=t.x,i=t.y,o=t.r,a=n.x,u=n.y,c=n.r,s=e.x,f=e.y,l=e.r,h=r-a,d=r-s,p=i-u,y=i-f,g=c-o,v=l-o,m=r*r+i*i-o*o,b=m-a*a-u*u+c*c,x=m-s*s-f*f+l*l,_=d*p-h*y,w=(p*x-y*b)/(2*_)-r,A=(y*g-p*v)/_,S=(d*b-h*x)/(2*_)-i,M=(h*v-d*g)/_,T=A*A+M*M-1,E=2*(o+w*A+S*M),C=w*w+S*S-o*o,k=-(T?(E+Math.sqrt(E*E-4*T*C))/(2*T):C/E);return{x:r+w+A*k,y:i+S+M*k,r:k}}function Iv(t,n,e){var r,i,o,a,u=t.x-n.x,c=t.y-n.y,s=u*u+c*c;s?(i=n.r+e.r,i*=i,a=t.r+e.r,i>(a*=a)?(r=(s+a-i)/(2*s),o=Math.sqrt(Math.max(0,a/s-r*r)),e.x=t.x-r*u-o*c,e.y=t.y-r*c+o*u):(r=(s+i-a)/(2*s),o=Math.sqrt(Math.max(0,i/s-r*r)),e.x=n.x+r*u-o*c,e.y=n.y+r*c+o*u)):(e.x=n.x+e.r,e.y=n.y)}function Rv(t,n){var e=t.r+n.r-1e-6,r=n.x-t.x,i=n.y-t.y;return e>0&&e*e>r*r+i*i}function zv(t){var n=t._,e=t.next._,r=n.r+e.r,i=(n.x*e.r+e.x*n.r)/r,o=(n.y*e.r+e.y*n.r)/r;return i*i+o*o}function Vv(t){this._=t,this.next=null,this.previous=null}function Dv(t){if(!(i=(t=function(t){return"object"===Sv(t)&&"length"in t?t:Array.from(t)}(t)).length))return 0;var n,e,r,i,o,a,u,c,s,f,l;if((n=t[0]).x=0,n.y=0,!(i>1))return n.r;if(e=t[1],n.x=-e.r,e.x=n.r,e.y=0,!(i>2))return n.r+e.r;Iv(e,n,r=t[2]),n=new Vv(n),e=new Vv(e),r=new Vv(r),n.next=r.previous=e,e.next=n.previous=r,r.next=e.previous=n;t:for(u=3;u<i;++u){Iv(n._,e._,r=t[u]),r=new Vv(r),c=e.next,s=n.previous,f=e._.r,l=n._.r;do{if(f<=l){if(Rv(c._,r._)){e=c,n.next=e,e.previous=n,--u;continue t}f+=c._.r,c=c.next}else{if(Rv(s._,r._)){(n=s).next=e,e.previous=n,--u;continue t}l+=s._.r,s=s.previous}}while(c!==s.next);for(r.previous=n,r.next=e,n.next=e.previous=e=r,o=zv(n);(r=r.next)!==e;)(a=zv(r))<o&&(n=r,o=a);e=n.next}for(n=[e._],r=e;(r=r.next)!==e;)n.push(r._);for(r=Mv(n),u=0;u<i;++u)(n=t[u]).x-=r.x,n.y-=r.y;return r.r}function jv(t){return Dv(t),t}function Lv(t){return null==t?null:Uv(t)}function Uv(t){if("function"!=typeof t)throw new Error;return t}function Bv(){return 0}function Fv(t){return function(){return t}}function qv(t){return Math.sqrt(t.value)}function Hv(){var t=null,n=1,e=1,r=Bv;function i(i){return i.x=n/2,i.y=e/2,t?i.eachBefore(Yv(t)).eachAfter(Xv(r,.5)).eachBefore($v(1)):i.eachBefore(Yv(qv)).eachAfter(Xv(Bv,1)).eachAfter(Xv(r,i.r/Math.min(n,e))).eachBefore($v(Math.min(n,e)/(2*i.r))),i}return i.radius=function(n){return arguments.length?(t=Lv(n),i):t},i.size=function(t){return arguments.length?(n=+t[0],e=+t[1],i):[n,e]},i.padding=function(t){return arguments.length?(r="function"==typeof t?t:Fv(+t),i):r},i}function Yv(t){return function(n){n.children||(n.r=Math.max(0,+t(n)||0))}}function Xv(t,n){return function(e){if(r=e.children){var r,i,o,a=r.length,u=t(e)*n||0;if(u)for(i=0;i<a;++i)r[i].r+=u;if(o=Dv(r),u)for(i=0;i<a;++i)r[i].r-=u;e.r=o+u}}}function $v(t){return function(n){var e=n.parent;n.r*=t,e&&(n.x=e.x+t*n.x,n.y=e.y+t*n.y)}}function Wv(t){t.x0=Math.round(t.x0),t.y0=Math.round(t.y0),t.x1=Math.round(t.x1),t.y1=Math.round(t.y1)}function Gv(t,n,e,r,i){for(var o,a=t.children,u=-1,c=a.length,s=t.value&&(r-n)/t.value;++u<c;)(o=a[u]).y0=e,o.y1=i,o.x0=n,o.x1=n+=o.value*s}function Qv(){var t=1,n=1,e=0,r=!1;function i(i){var o=i.height+1;return i.x0=i.y0=e,i.x1=t,i.y1=n/o,i.eachBefore(function(t,n){return function(r){r.children&&Gv(r,r.x0,t*(r.depth+1)/n,r.x1,t*(r.depth+2)/n);var i=r.x0,o=r.y0,a=r.x1-e,u=r.y1-e;a<i&&(i=a=(i+a)/2),u<o&&(o=u=(o+u)/2),r.x0=i,r.y0=o,r.x1=a,r.y1=u}}(n,o)),r&&i.eachBefore(Wv),i}return i.round=function(t){return arguments.length?(r=!!t,i):r},i.size=function(e){return arguments.length?(t=+e[0],n=+e[1],i):[t,n]},i.padding=function(t){return arguments.length?(e=+t,i):e},i}Av.prototype=mv.prototype=function(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}({constructor:Av,count:function(){return this.eachAfter(lv)},each:function(t,n){var e,r=-1,i=hv(this);try{for(i.s();!(e=i.n()).done;){var o=e.value;t.call(n,o,++r,this)}}catch(t){i.e(t)}finally{i.f()}return this},eachAfter:function(t,n){for(var e,r,i,o=this,a=[o],u=[],c=-1;o=a.pop();)if(u.push(o),e=o.children)for(r=0,i=e.length;r<i;++r)a.push(e[r]);for(;o=u.pop();)t.call(n,o,++c,this);return this},eachBefore:function(t,n){for(var e,r,i=this,o=[i],a=-1;i=o.pop();)if(t.call(n,i,++a,this),e=i.children)for(r=e.length-1;r>=0;--r)o.push(e[r]);return this},find:function(t,n){var e,r=-1,i=pv(this);try{for(i.s();!(e=i.n()).done;){var o=e.value;if(t.call(n,o,++r,this))return o}}catch(t){i.e(t)}finally{i.f()}},sum:function(t){return this.eachAfter((function(n){for(var e=+t(n.data)||0,r=n.children,i=r&&r.length;--i>=0;)e+=r[i].value;n.value=e}))},sort:function(t){return this.eachBefore((function(n){n.children&&n.children.sort(t)}))},path:function(t){for(var n=this,e=function(t,n){if(t===n)return t;var e=t.ancestors(),r=n.ancestors(),i=null;t=e.pop(),n=r.pop();for(;t===n;)i=t,t=e.pop(),n=r.pop();return i}(n,t),r=[n];n!==e;)n=n.parent,r.push(n);for(var i=r.length;t!==e;)r.splice(i,0,t),t=t.parent;return r},ancestors:function(){for(var t=this,n=[t];t=t.parent;)n.push(t);return n},descendants:function(){return Array.from(this)},leaves:function(){var t=[];return this.eachBefore((function(n){n.children||t.push(n)})),t},links:function(){var t=this,n=[];return t.each((function(e){e!==t&&n.push({source:e.parent,target:e})})),n},copy:function(){return mv(this).eachBefore(_v)}},Symbol.iterator,vv);var Zv={depth:-1},Kv={};function Jv(t){return t.id}function tm(t){return t.parentId}function nm(){var t=Jv,n=tm;function e(e){var r,i,o,a,u,c,s,f=Array.from(e),l=f.length,h=new Map;for(i=0;i<l;++i)r=f[i],u=f[i]=new Av(r),null!=(c=t(r,i,e))&&(c+="")&&(s=u.id=c,h.set(s,h.has(s)?Kv:u)),null!=(c=n(r,i,e))&&(c+="")&&(u.parent=c);for(i=0;i<l;++i)if(c=(u=f[i]).parent){if(!(a=h.get(c)))throw new Error("missing: "+c);if(a===Kv)throw new Error("ambiguous: "+c);a.children?a.children.push(u):a.children=[u],u.parent=a}else{if(o)throw new Error("multiple roots");o=u}if(!o)throw new Error("no root");if(o.parent=Zv,o.eachBefore((function(t){t.depth=t.parent.depth+1,--l})).eachBefore(wv),o.parent=null,l>0)throw new Error("cycle");return o}return e.id=function(n){return arguments.length?(t=Uv(n),e):t},e.parentId=function(t){return arguments.length?(n=Uv(t),e):n},e}function em(t,n){return t.parent===n.parent?1:2}function rm(t){var n=t.children;return n?n[0]:t.t}function im(t){var n=t.children;return n?n[n.length-1]:t.t}function om(t,n,e){var r=e/(n.i-t.i);n.c-=r,n.s+=e,t.c+=r,n.z+=e,n.m+=e}function am(t,n,e){return t.a.parent===n.parent?t.a:e}function um(t,n){this._=t,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=n}function cm(){var t=em,n=1,e=1,r=null;function i(i){var c=function(t){for(var n,e,r,i,o,a=new um(t,0),u=[a];n=u.pop();)if(r=n._.children)for(n.children=new Array(o=r.length),i=o-1;i>=0;--i)u.push(e=n.children[i]=new um(r[i],i)),e.parent=n;return(a.parent=new um(null,0)).children=[a],a}(i);if(c.eachAfter(o),c.parent.m=-c.z,c.eachBefore(a),r)i.eachBefore(u);else{var s=i,f=i,l=i;i.eachBefore((function(t){t.x<s.x&&(s=t),t.x>f.x&&(f=t),t.depth>l.depth&&(l=t)}));var h=s===f?1:t(s,f)/2,d=h-s.x,p=n/(f.x+h+d),y=e/(l.depth||1);i.eachBefore((function(t){t.x=(t.x+d)*p,t.y=t.depth*y}))}return i}function o(n){var e=n.children,r=n.parent.children,i=n.i?r[n.i-1]:null;if(e){!function(t){for(var n,e=0,r=0,i=t.children,o=i.length;--o>=0;)(n=i[o]).z+=e,n.m+=e,e+=n.s+(r+=n.c)}(n);var o=(e[0].z+e[e.length-1].z)/2;i?(n.z=i.z+t(n._,i._),n.m=n.z-o):n.z=o}else i&&(n.z=i.z+t(n._,i._));n.parent.A=function(n,e,r){if(e){for(var i,o=n,a=n,u=e,c=o.parent.children[0],s=o.m,f=a.m,l=u.m,h=c.m;u=im(u),o=rm(o),u&&o;)c=rm(c),(a=im(a)).a=n,(i=u.z+l-o.z-s+t(u._,o._))>0&&(om(am(u,n,r),n,i),s+=i,f+=i),l+=u.m,s+=o.m,h+=c.m,f+=a.m;u&&!im(a)&&(a.t=u,a.m+=l-f),o&&!rm(c)&&(c.t=o,c.m+=s-h,r=n)}return r}(n,i,n.parent.A||r[0])}function a(t){t._.x=t.z+t.parent.m,t.m+=t.parent.m}function u(t){t.x*=n,t.y=t.depth*e}return i.separation=function(n){return arguments.length?(t=n,i):t},i.size=function(t){return arguments.length?(r=!1,n=+t[0],e=+t[1],i):r?null:[n,e]},i.nodeSize=function(t){return arguments.length?(r=!0,n=+t[0],e=+t[1],i):r?[n,e]:null},i}function sm(t,n,e,r,i){for(var o,a=t.children,u=-1,c=a.length,s=t.value&&(i-e)/t.value;++u<c;)(o=a[u]).x0=n,o.x1=r,o.y0=e,o.y1=e+=o.value*s}um.prototype=Object.create(Av.prototype);var fm=(1+Math.sqrt(5))/2;function lm(t,n,e,r,i,o){for(var a,u,c,s,f,l,h,d,p,y,g,v=[],m=n.children,b=0,x=0,_=m.length,w=n.value;b<_;){c=i-e,s=o-r;do{f=m[x++].value}while(!f&&x<_);for(l=h=f,g=f*f*(y=Math.max(s/c,c/s)/(w*t)),p=Math.max(h/g,g/l);x<_;++x){if(f+=u=m[x].value,u<l&&(l=u),u>h&&(h=u),g=f*f*y,(d=Math.max(h/g,g/l))>p){f-=u;break}p=d}v.push(a={value:f,dice:c<s,children:m.slice(b,x)}),a.dice?Gv(a,e,r,i,w?r+=s*f/w:o):sm(a,e,r,w?e+=c*f/w:i,o),w-=f,b=x}return v}var hm=function t(n){function e(t,e,r,i,o){lm(n,t,e,r,i,o)}return e.ratio=function(n){return t((n=+n)>1?n:1)},e}(fm);function dm(){var t=hm,n=!1,e=1,r=1,i=[0],o=Bv,a=Bv,u=Bv,c=Bv,s=Bv;function f(t){return t.x0=t.y0=0,t.x1=e,t.y1=r,t.eachBefore(l),i=[0],n&&t.eachBefore(Wv),t}function l(n){var e=i[n.depth],r=n.x0+e,f=n.y0+e,l=n.x1-e,h=n.y1-e;l<r&&(r=l=(r+l)/2),h<f&&(f=h=(f+h)/2),n.x0=r,n.y0=f,n.x1=l,n.y1=h,n.children&&(e=i[n.depth+1]=o(n)/2,r+=s(n)-e,f+=a(n)-e,(l-=u(n)-e)<r&&(r=l=(r+l)/2),(h-=c(n)-e)<f&&(f=h=(f+h)/2),t(n,r,f,l,h))}return f.round=function(t){return arguments.length?(n=!!t,f):n},f.size=function(t){return arguments.length?(e=+t[0],r=+t[1],f):[e,r]},f.tile=function(n){return arguments.length?(t=Uv(n),f):t},f.padding=function(t){return arguments.length?f.paddingInner(t).paddingOuter(t):f.paddingInner()},f.paddingInner=function(t){return arguments.length?(o="function"==typeof t?t:Fv(+t),f):o},f.paddingOuter=function(t){return arguments.length?f.paddingTop(t).paddingRight(t).paddingBottom(t).paddingLeft(t):f.paddingTop()},f.paddingTop=function(t){return arguments.length?(a="function"==typeof t?t:Fv(+t),f):a},f.paddingRight=function(t){return arguments.length?(u="function"==typeof t?t:Fv(+t),f):u},f.paddingBottom=function(t){return arguments.length?(c="function"==typeof t?t:Fv(+t),f):c},f.paddingLeft=function(t){return arguments.length?(s="function"==typeof t?t:Fv(+t),f):s},f}function pm(t,n,e,r,i){var o,a,u=t.children,c=u.length,s=new Array(c+1);for(s[0]=a=o=0;o<c;++o)s[o+1]=a+=u[o].value;!function t(n,e,r,i,o,a,c){if(n>=e-1){var f=u[n];return f.x0=i,f.y0=o,f.x1=a,void(f.y1=c)}var l=s[n],h=r/2+l,d=n+1,p=e-1;for(;d<p;){var y=d+p>>>1;s[y]<h?d=y+1:p=y}h-s[d-1]<s[d]-h&&n+1<d&&--d;var g=s[d]-l,v=r-g;if(a-i>c-o){var m=r?(i*v+a*g)/r:a;t(n,d,g,i,o,m,c),t(d,e,v,m,o,a,c)}else{var b=r?(o*v+c*g)/r:c;t(n,d,g,i,o,a,b),t(d,e,v,i,b,a,c)}}(0,c,t.value,n,e,r,i)}function ym(t,n,e,r,i){(1&t.depth?sm:Gv)(t,n,e,r,i)}var gm=function t(n){function e(t,e,r,i,o){if((a=t._squarify)&&a.ratio===n)for(var a,u,c,s,f,l=-1,h=a.length,d=t.value;++l<h;){for(c=(u=a[l]).children,s=u.value=0,f=c.length;s<f;++s)u.value+=c[s].value;u.dice?Gv(u,e,r,i,d?r+=(o-r)*u.value/d:o):sm(u,e,r,d?e+=(i-e)*u.value/d:i,o),d-=u.value}else t._squarify=a=lm(n,t,e,r,i,o),a.ratio=n}return e.ratio=function(n){return t((n=+n)>1?n:1)},e}(fm);function vm(t){var n=t.length;return function(e){return t[Math.max(0,Math.min(n-1,Math.floor(e*n)))]}}function mm(t,n){var e=co(+t,+n);return function(t){var n=e(t);return n-360*Math.floor(n/360)}}function bm(t,n){return t=+t,n=+n,function(e){return Math.round(t*(1-e)+n*e)}}function xm(t){return((t=Math.exp(t))+1/t)/2}var _m=function t(n,e,r){function i(t,i){var o,a,u=t[0],c=t[1],s=t[2],f=i[0],l=i[1],h=i[2],d=f-u,p=l-c,y=d*d+p*p;if(y<1e-12)a=Math.log(h/s)/n,o=function(t){return[u+t*d,c+t*p,s*Math.exp(n*t*a)]};else{var g=Math.sqrt(y),v=(h*h-s*s+r*y)/(2*s*e*g),m=(h*h-s*s-r*y)/(2*h*e*g),b=Math.log(Math.sqrt(v*v+1)-v),x=Math.log(Math.sqrt(m*m+1)-m);a=(x-b)/n,o=function(t){var r=t*a,i=xm(b),o=s/(e*g)*(i*function(t){return((t=Math.exp(2*t))-1)/(t+1)}(n*r+b)-function(t){return((t=Math.exp(t))-1/t)/2}(b));return[u+o*d,c+o*p,s*i/xm(n*r+b)]}}return o.duration=1e3*a*n/Math.SQRT2,o}return i.rho=function(n){var e=Math.max(.001,+n),r=e*e;return t(e,r,r*r)},i}(Math.SQRT2,2,4);function wm(t){return function(n,e){var r=t((n=to(n)).h,(e=to(e)).h),i=fo(n.s,e.s),o=fo(n.l,e.l),a=fo(n.opacity,e.opacity);return function(t){return n.h=r(t),n.s=i(t),n.l=o(t),n.opacity=a(t),n+""}}}var Am=wm(co),Sm=wm(fo);function Mm(t,n){var e=fo((t=bc(t)).l,(n=bc(n)).l),r=fo(t.a,n.a),i=fo(t.b,n.b),o=fo(t.opacity,n.opacity);return function(n){return t.l=e(n),t.a=r(n),t.b=i(n),t.opacity=o(n),t+""}}function Tm(t){return function(n,e){var r=t((n=Ec(n)).h,(e=Ec(e)).h),i=fo(n.c,e.c),o=fo(n.l,e.l),a=fo(n.opacity,e.opacity);return function(t){return n.h=r(t),n.c=i(t),n.l=o(t),n.opacity=a(t),n+""}}}var Em=Tm(co),Cm=Tm(fo);function km(t){return function n(e){function r(n,r){var i=t((n=Lc(n)).h,(r=Lc(r)).h),o=fo(n.s,r.s),a=fo(n.l,r.l),u=fo(n.opacity,r.opacity);return function(t){return n.h=i(t),n.s=o(t),n.l=a(Math.pow(t,e)),n.opacity=u(t),n+""}}return e=+e,r.gamma=n,r}(1)}var Nm=km(co),Om=km(fo);function Pm(t,n){void 0===n&&(n=t,t=Co);for(var e=0,r=n.length-1,i=n[0],o=new Array(r<0?0:r);e<r;)o[e]=t(i,i=n[++e]);return function(t){var n=Math.max(0,Math.min(r-1,Math.floor(t*=r)));return o[n](t-n)}}function Im(t,n){for(var e=new Array(n),r=0;r<n;++r)e[r]=t(r/(n-1));return e}function Rm(t){for(var n,e=-1,r=t.length,i=t[r-1],o=0;++e<r;)n=i,i=t[e],o+=n[1]*i[0]-n[0]*i[1];return o/2}function zm(t){for(var n,e,r=-1,i=t.length,o=0,a=0,u=t[i-1],c=0;++r<i;)n=u,u=t[r],c+=e=n[0]*u[1]-u[0]*n[1],o+=(n[0]+u[0])*e,a+=(n[1]+u[1])*e;return[o/(c*=3),a/c]}function Vm(t,n,e){return(n[0]-t[0])*(e[1]-t[1])-(n[1]-t[1])*(e[0]-t[0])}function Dm(t,n){return t[0]-n[0]||t[1]-n[1]}function jm(t){var n,e=t.length,r=[0,1],i=2;for(n=2;n<e;++n){for(;i>1&&Vm(t[r[i-2]],t[r[i-1]],t[n])<=0;)--i;r[i++]=n}return r.slice(0,i)}function Lm(t){if((e=t.length)<3)return null;var n,e,r=new Array(e),i=new Array(e);for(n=0;n<e;++n)r[n]=[+t[n][0],+t[n][1],n];for(r.sort(Dm),n=0;n<e;++n)i[n]=[r[n][0],-r[n][1]];var o=jm(r),a=jm(i),u=a[0]===o[0],c=a[a.length-1]===o[o.length-1],s=[];for(n=o.length-1;n>=0;--n)s.push(t[r[o[n]][2]]);for(n=+u;n<a.length-c;++n)s.push(t[r[a[n]][2]]);return s}function Um(t,n){for(var e,r,i=t.length,o=t[i-1],a=n[0],u=n[1],c=o[0],s=o[1],f=!1,l=0;l<i;++l)e=(o=t[l])[0],(r=o[1])>u!=s>u&&a<(c-e)*(u-r)/(s-r)+e&&(f=!f),c=e,s=r;return f}function Bm(t){for(var n,e,r=-1,i=t.length,o=t[i-1],a=o[0],u=o[1],c=0;++r<i;)n=a,e=u,n-=a=(o=t[r])[0],e-=u=o[1],c+=Math.hypot(n,e);return c}var Fm=Math.random,qm=function t(n){function e(t,e){return t=null==t?0:+t,e=null==e?1:+e,1===arguments.length?(e=t,t=0):e-=t,function(){return n()*e+t}}return e.source=t,e}(Fm),Hm=function t(n){function e(t,e){return arguments.length<2&&(e=t,t=0),t=Math.floor(t),e=Math.floor(e)-t,function(){return Math.floor(n()*e+t)}}return e.source=t,e}(Fm),Ym=function t(n){function e(t,e){var r,i;return t=null==t?0:+t,e=null==e?1:+e,function(){var o;if(null!=r)o=r,r=null;else do{r=2*n()-1,o=2*n()-1,i=r*r+o*o}while(!i||i>1);return t+e*o*Math.sqrt(-2*Math.log(i)/i)}}return e.source=t,e}(Fm),Xm=function t(n){var e=Ym.source(n);function r(){var t=e.apply(this,arguments);return function(){return Math.exp(t())}}return r.source=t,r}(Fm),$m=function t(n){function e(t){return(t=+t)<=0?function(){return 0}:function(){for(var e=0,r=t;r>1;--r)e+=n();return e+r*n()}}return e.source=t,e}(Fm),Wm=function t(n){var e=$m.source(n);function r(t){if(0==(t=+t))return n;var r=e(t);return function(){return r()/t}}return r.source=t,r}(Fm),Gm=function t(n){function e(t){return function(){return-Math.log1p(-n())/t}}return e.source=t,e}(Fm),Qm=function t(n){function e(t){if((t=+t)<0)throw new RangeError("invalid alpha");return t=1/-t,function(){return Math.pow(1-n(),t)}}return e.source=t,e}(Fm),Zm=function t(n){function e(t){if((t=+t)<0||t>1)throw new RangeError("invalid p");return function(){return Math.floor(n()+t)}}return e.source=t,e}(Fm),Km=function t(n){function e(t){if((t=+t)<0||t>1)throw new RangeError("invalid p");return 0===t?function(){return 1/0}:1===t?function(){return 1}:(t=Math.log1p(-t),function(){return 1+Math.floor(Math.log1p(-n())/t)})}return e.source=t,e}(Fm),Jm=function t(n){var e=Ym.source(n)();function r(t,r){if((t=+t)<0)throw new RangeError("invalid k");if(0===t)return function(){return 0};if(r=null==r?1:+r,1===t)return function(){return-Math.log1p(-n())*r};var i=(t<1?t+1:t)-1/3,o=1/(3*Math.sqrt(i)),a=t<1?function(){return Math.pow(n(),1/t)}:function(){return 1};return function(){do{do{var t=e(),u=1+o*t}while(u<=0);u*=u*u;var c=1-n()}while(c>=1-.0331*t*t*t*t&&Math.log(c)>=.5*t*t+i*(1-u+Math.log(u)));return i*u*a()*r}}return r.source=t,r}(Fm),tb=function t(n){var e=Jm.source(n);function r(t,n){var r=e(t),i=e(n);return function(){var t=r();return 0===t?0:t/(t+i())}}return r.source=t,r}(Fm),nb=function t(n){var e=Km.source(n),r=tb.source(n);function i(t,n){return t=+t,(n=+n)>=1?function(){return t}:n<=0?function(){return 0}:function(){for(var i=0,o=t,a=n;o*a>16&&o*(1-a)>16;){var u=Math.floor((o+1)*a),c=r(u,o-u+1)();c<=a?(i+=u,o-=u,a=(a-c)/(1-c)):(o=u-1,a/=c)}for(var s=a<.5,f=e(s?a:1-a),l=f(),h=0;l<=o;++h)l+=f();return i+(s?h:o-h)}}return i.source=t,i}(Fm),eb=function t(n){function e(t,e,r){var i;return 0==(t=+t)?i=function(t){return-Math.log(t)}:(t=1/t,i=function(n){return Math.pow(n,t)}),e=null==e?0:+e,r=null==r?1:+r,function(){return e+r*i(-Math.log1p(-n()))}}return e.source=t,e}(Fm),rb=function t(n){function e(t,e){return t=null==t?0:+t,e=null==e?1:+e,function(){return t+e*Math.tan(Math.PI*n())}}return e.source=t,e}(Fm),ib=function t(n){function e(t,e){return t=null==t?0:+t,e=null==e?1:+e,function(){var r=n();return t+e*Math.log(r/(1-r))}}return e.source=t,e}(Fm),ob=function t(n){var e=Jm.source(n),r=nb.source(n);function i(t){return function(){for(var i=0,o=t;o>16;){var a=Math.floor(.875*o),u=e(a)();if(u>o)return i+r(a-1,o/u)();i+=a,o-=u}for(var c=-Math.log1p(-n()),s=0;c<=o;++s)c-=Math.log1p(-n());return i+s}}return i.source=t,i}(Fm),ab=1664525,ub=1013904223,cb=1/4294967296;function sb(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Math.random(),n=0|(0<=t&&t<1?t/cb:Math.abs(t));return function(){return cb*((n=ab*n+ub|0)>>>0)}}function fb(t,n){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(n).domain(t)}return this}function lb(t,n){switch(arguments.length){case 0:break;case 1:"function"==typeof t?this.interpolator(t):this.range(t);break;default:this.domain(t),"function"==typeof n?this.interpolator(n):this.range(n)}return this}function hb(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return db(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return db(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function db(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}var pb=Symbol("implicit");function yb(){var t=new ut,n=[],e=[],r=pb;function i(i){var o=t.get(i);if(void 0===o){if(r!==pb)return r;t.set(i,o=n.push(i)-1)}return e[o%e.length]}return i.domain=function(e){if(!arguments.length)return n.slice();n=[],t=new ut;var r,o=hb(e);try{for(o.s();!(r=o.n()).done;){var a=r.value;t.has(a)||t.set(a,n.push(a)-1)}}catch(t){o.e(t)}finally{o.f()}return i},i.range=function(t){return arguments.length?(e=Array.from(t),i):e.slice()},i.unknown=function(t){return arguments.length?(r=t,i):r},i.copy=function(){return yb(n,e).unknown(r)},fb.apply(i,arguments),i}function gb(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==e)return;var r,i,o=[],a=!0,u=!1;try{for(e=e.call(t);!(a=(r=e.next()).done)&&(o.push(r.value),!n||o.length!==n);a=!0);}catch(t){u=!0,i=t}finally{try{a||null==e.return||e.return()}finally{if(u)throw i}}return o}(t,n)||function(t,n){if(!t)return;if("string"==typeof t)return vb(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return vb(t,n)}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function vb(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function mb(){var t,n,e=yb().unknown(void 0),r=e.domain,i=e.range,o=0,a=1,u=!1,c=0,s=0,f=.5;function l(){var e=r().length,l=a<o,h=l?a:o,d=l?o:a;t=(d-h)/Math.max(1,e-c+2*s),u&&(t=Math.floor(t)),h+=(d-h-t*(e-c))*f,n=t*(1-c),u&&(h=Math.round(h),n=Math.round(n));var p=Vn(e).map((function(n){return h+t*n}));return i(l?p.reverse():p)}return delete e.unknown,e.domain=function(t){return arguments.length?(r(t),l()):r()},e.range=function(t){var n;return arguments.length?(n=gb(t,2),o=n[0],a=n[1],o=+o,a=+a,l()):[o,a]},e.rangeRound=function(t){var n;return n=gb(t,2),o=n[0],a=n[1],o=+o,a=+a,u=!0,l()},e.bandwidth=function(){return n},e.step=function(){return t},e.round=function(t){return arguments.length?(u=!!t,l()):u},e.padding=function(t){return arguments.length?(c=Math.min(1,s=+t),l()):c},e.paddingInner=function(t){return arguments.length?(c=Math.min(1,t),l()):c},e.paddingOuter=function(t){return arguments.length?(s=+t,l()):s},e.align=function(t){return arguments.length?(f=Math.max(0,Math.min(1,t)),l()):f},e.copy=function(){return mb(r(),[o,a]).round(u).paddingInner(c).paddingOuter(s).align(f)},fb.apply(l(),arguments)}function bb(t){var n=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return bb(n())},t}function xb(){return bb(mb.apply(null,arguments).paddingInner(1))}function _b(t){return+t}var wb=[0,1];function Ab(t){return t}function Sb(t,n){return(n-=t=+t)?function(e){return(e-t)/n}:function(t){return function(){return t}}(isNaN(n)?NaN:.5)}function Mb(t,n,e){var r=t[0],i=t[1],o=n[0],a=n[1];return i<r?(r=Sb(i,r),o=e(a,o)):(r=Sb(r,i),o=e(o,a)),function(t){return o(r(t))}}function Tb(t,n,e){var r=Math.min(t.length,n.length)-1,i=new Array(r),o=new Array(r),a=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),n=n.slice().reverse());++a<r;)i[a]=Sb(t[a],t[a+1]),o[a]=e(n[a],n[a+1]);return function(n){var e=y(t,n,1,r)-1;return o[e](i[e](n))}}function Eb(t,n){return n.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function Cb(){var t,n,e,r,i,o,a=wb,u=wb,c=Co,s=Ab;function f(){var t=Math.min(a.length,u.length);return s!==Ab&&(s=function(t,n){var e;return t>n&&(e=t,t=n,n=e),function(e){return Math.max(t,Math.min(n,e))}}(a[0],a[t-1])),r=t>2?Tb:Mb,i=o=null,l}function l(n){return null==n||isNaN(n=+n)?e:(i||(i=r(a.map(t),u,c)))(t(s(n)))}return l.invert=function(e){return s(n((o||(o=r(u,a.map(t),_o)))(e)))},l.domain=function(t){return arguments.length?(a=Array.from(t,_b),f()):a.slice()},l.range=function(t){return arguments.length?(u=Array.from(t),f()):u.slice()},l.rangeRound=function(t){return u=Array.from(t),c=bm,f()},l.clamp=function(t){return arguments.length?(s=!!t||Ab,f()):s!==Ab},l.interpolate=function(t){return arguments.length?(c=t,f()):c},l.unknown=function(t){return arguments.length?(e=t,l):e},function(e,r){return t=e,n=r,f()}}function kb(){return Cb()(Ab,Ab)}function Nb(t,n,e,r){var i,o=$t(t,n,e);switch((r=Kl(null==r?",f":r)).type){case"s":var a=Math.max(Math.abs(t),Math.abs(n));return null!=r.precision||isNaN(i=lh(o,a))||(r.precision=i),oh(r,a);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=hh(o,Math.max(Math.abs(t),Math.abs(n))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=fh(o))||(r.precision=i-2*("%"===r.type))}return ih(r)}function Ob(t){var n=t.domain;return t.ticks=function(t){var e=n();return Yt(e[0],e[e.length-1],null==t?10:t)},t.tickFormat=function(t,e){var r=n();return Nb(r[0],r[r.length-1],null==t?10:t,e)},t.nice=function(e){null==e&&(e=10);var r,i,o=n(),a=0,u=o.length-1,c=o[a],s=o[u],f=10;for(s<c&&(i=c,c=s,s=i,i=a,a=u,u=i);f-- >0;){if((i=Xt(c,s,e))===r)return o[a]=c,o[u]=s,n(o);if(i>0)c=Math.floor(c/i)*i,s=Math.ceil(s/i)*i;else{if(!(i<0))break;c=Math.ceil(c*i)/i,s=Math.floor(s*i)/i}r=i}return t},t}function Pb(){var t=kb();return t.copy=function(){return Eb(t,Pb())},fb.apply(t,arguments),Ob(t)}function Ib(t){var n;function e(t){return null==t||isNaN(t=+t)?n:t}return e.invert=e,e.domain=e.range=function(n){return arguments.length?(t=Array.from(n,_b),e):t.slice()},e.unknown=function(t){return arguments.length?(n=t,e):n},e.copy=function(){return Ib(t).unknown(n)},t=arguments.length?Array.from(t,_b):[0,1],Ob(e)}function Rb(t,n){var e,r=0,i=(t=t.slice()).length-1,o=t[r],a=t[i];return a<o&&(e=r,r=i,i=e,e=o,o=a,a=e),t[r]=n.floor(o),t[i]=n.ceil(a),t}function zb(t){return Math.log(t)}function Vb(t){return Math.exp(t)}function Db(t){return-Math.log(-t)}function jb(t){return-Math.exp(-t)}function Lb(t){return isFinite(t)?+("1e"+t):t<0?0:t}function Ub(t){return function(n){return-t(-n)}}function Bb(t){var n,e,r=t(zb,Vb),i=r.domain,o=10;function a(){return n=function(t){return t===Math.E?Math.log:10===t&&Math.log10||2===t&&Math.log2||(t=Math.log(t),function(n){return Math.log(n)/t})}(o),e=function(t){return 10===t?Lb:t===Math.E?Math.exp:function(n){return Math.pow(t,n)}}(o),i()[0]<0?(n=Ub(n),e=Ub(e),t(Db,jb)):t(zb,Vb),r}return r.base=function(t){return arguments.length?(o=+t,a()):o},r.domain=function(t){return arguments.length?(i(t),a()):i()},r.ticks=function(t){var r,a=i(),u=a[0],c=a[a.length-1];(r=c<u)&&(h=u,u=c,c=h);var s,f,l,h=n(u),d=n(c),p=null==t?10:+t,y=[];if(!(o%1)&&d-h<p){if(h=Math.floor(h),d=Math.ceil(d),u>0){for(;h<=d;++h)for(f=1,s=e(h);f<o;++f)if(!((l=s*f)<u)){if(l>c)break;y.push(l)}}else for(;h<=d;++h)for(f=o-1,s=e(h);f>=1;--f)if(!((l=s*f)<u)){if(l>c)break;y.push(l)}2*y.length<p&&(y=Yt(u,c,p))}else y=Yt(h,d,Math.min(d-h,p)).map(e);return r?y.reverse():y},r.tickFormat=function(t,i){if(null==i&&(i=10===o?".0e":","),"function"!=typeof i&&(i=ih(i)),t===1/0)return i;null==t&&(t=10);var a=Math.max(1,o*t/r.ticks().length);return function(t){var r=t/e(Math.round(n(t)));return r*o<o-.5&&(r*=o),r<=a?i(t):""}},r.nice=function(){return i(Rb(i(),{floor:function(t){return e(Math.floor(n(t)))},ceil:function(t){return e(Math.ceil(n(t)))}}))},r}function Fb(){var t=Bb(Cb()).domain([1,10]);return t.copy=function(){return Eb(t,Fb()).base(t.base())},fb.apply(t,arguments),t}function qb(t){return function(n){return Math.sign(n)*Math.log1p(Math.abs(n/t))}}function Hb(t){return function(n){return Math.sign(n)*Math.expm1(Math.abs(n))*t}}function Yb(t){var n=1,e=t(qb(n),Hb(n));return e.constant=function(e){return arguments.length?t(qb(n=+e),Hb(n)):n},Ob(e)}function Xb(){var t=Yb(Cb());return t.copy=function(){return Eb(t,Xb()).constant(t.constant())},fb.apply(t,arguments)}function $b(t){return function(n){return n<0?-Math.pow(-n,t):Math.pow(n,t)}}function Wb(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function Gb(t){return t<0?-t*t:t*t}function Qb(t){var n=t(Ab,Ab),e=1;function r(){return 1===e?t(Ab,Ab):.5===e?t(Wb,Gb):t($b(e),$b(1/e))}return n.exponent=function(t){return arguments.length?(e=+t,r()):e},Ob(n)}function Zb(){var t=Qb(Cb());return t.copy=function(){return Eb(t,Zb()).exponent(t.exponent())},fb.apply(t,arguments),t}function Kb(){return Zb.apply(null,arguments).exponent(.5)}function Jb(t){return Math.sign(t)*t*t}function tx(t){return Math.sign(t)*Math.sqrt(Math.abs(t))}function nx(){var t,n=kb(),e=[0,1],r=!1;function i(e){var i=tx(n(e));return isNaN(i)?t:r?Math.round(i):i}return i.invert=function(t){return n.invert(Jb(t))},i.domain=function(t){return arguments.length?(n.domain(t),i):n.domain()},i.range=function(t){return arguments.length?(n.range((e=Array.from(t,_b)).map(Jb)),i):e.slice()},i.rangeRound=function(t){return i.range(t).round(!0)},i.round=function(t){return arguments.length?(r=!!t,i):r},i.clamp=function(t){return arguments.length?(n.clamp(t),i):n.clamp()},i.unknown=function(n){return arguments.length?(t=n,i):t},i.copy=function(){return nx(n.domain(),e).round(r).clamp(n.clamp()).unknown(t)},fb.apply(i,arguments),Ob(i)}function ex(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return rx(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return rx(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function rx(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function ix(){var t,n=[],e=[],i=[];function o(){var t=0,r=Math.max(1,e.length);for(i=new Array(r-1);++t<r;)i[t-1]=sn(n,t/r);return a}function a(n){return null==n||isNaN(n=+n)?t:e[y(i,n)]}return a.invertExtent=function(t){var r=e.indexOf(t);return r<0?[NaN,NaN]:[r>0?i[r-1]:n[0],r<i.length?i[r]:n[n.length-1]]},a.domain=function(t){if(!arguments.length)return n.slice();n=[];var e,i=ex(t);try{for(i.s();!(e=i.n()).done;){var a=e.value;null==a||isNaN(a=+a)||n.push(a)}}catch(t){i.e(t)}finally{i.f()}return n.sort(r),o()},a.range=function(t){return arguments.length?(e=Array.from(t),o()):e.slice()},a.unknown=function(n){return arguments.length?(t=n,a):t},a.quantiles=function(){return i.slice()},a.copy=function(){return ix().domain(n).range(e).unknown(t)},fb.apply(a,arguments)}function ox(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==e)return;var r,i,o=[],a=!0,u=!1;try{for(e=e.call(t);!(a=(r=e.next()).done)&&(o.push(r.value),!n||o.length!==n);a=!0);}catch(t){u=!0,i=t}finally{try{a||null==e.return||e.return()}finally{if(u)throw i}}return o}(t,n)||function(t,n){if(!t)return;if("string"==typeof t)return ax(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return ax(t,n)}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ax(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function ux(){var t,n=0,e=1,r=1,i=[.5],o=[0,1];function a(n){return null!=n&&n<=n?o[y(i,n,0,r)]:t}function u(){var t=-1;for(i=new Array(r);++t<r;)i[t]=((t+1)*e-(t-r)*n)/(r+1);return a}return a.domain=function(t){var r;return arguments.length?(r=ox(t,2),n=r[0],e=r[1],n=+n,e=+e,u()):[n,e]},a.range=function(t){return arguments.length?(r=(o=Array.from(t)).length-1,u()):o.slice()},a.invertExtent=function(t){var a=o.indexOf(t);return a<0?[NaN,NaN]:a<1?[n,i[0]]:a>=r?[i[r-1],e]:[i[a-1],i[a]]},a.unknown=function(n){return arguments.length?(t=n,a):a},a.thresholds=function(){return i.slice()},a.copy=function(){return ux().domain([n,e]).range(o).unknown(t)},fb.apply(Ob(a),arguments)}function cx(){var t,n=[.5],e=[0,1],r=1;function i(i){return null!=i&&i<=i?e[y(n,i,0,r)]:t}return i.domain=function(t){return arguments.length?(n=Array.from(t),r=Math.min(n.length,e.length-1),i):n.slice()},i.range=function(t){return arguments.length?(e=Array.from(t),r=Math.min(n.length,e.length-1),i):e.slice()},i.invertExtent=function(t){var r=e.indexOf(t);return[n[r-1],n[r]]},i.unknown=function(n){return arguments.length?(t=n,i):t},i.copy=function(){return cx().domain(n).range(e).unknown(t)},fb.apply(i,arguments)}var sx=1e3,fx=6e4,lx=36e5,hx=864e5,dx=6048e5,px=2592e6,yx=31536e6,gx=new Date,vx=new Date;function mx(t,n,e,r){function i(n){return t(n=0===arguments.length?new Date:new Date(+n)),n}return i.floor=function(n){return t(n=new Date(+n)),n},i.ceil=function(e){return t(e=new Date(e-1)),n(e,1),t(e),e},i.round=function(t){var n=i(t),e=i.ceil(t);return t-n<e-t?n:e},i.offset=function(t,e){return n(t=new Date(+t),null==e?1:Math.floor(e)),t},i.range=function(e,r,o){var a,u=[];if(e=i.ceil(e),o=null==o?1:Math.floor(o),!(e<r&&o>0))return u;do{u.push(a=new Date(+e)),n(e,o),t(e)}while(a<e&&e<r);return u},i.filter=function(e){return mx((function(n){if(n>=n)for(;t(n),!e(n);)n.setTime(n-1)}),(function(t,r){if(t>=t)if(r<0)for(;++r<=0;)for(;n(t,-1),!e(t););else for(;--r>=0;)for(;n(t,1),!e(t););}))},e&&(i.count=function(n,r){return gx.setTime(+n),vx.setTime(+r),t(gx),t(vx),Math.floor(e(gx,vx))},i.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?i.filter(r?function(n){return r(n)%t==0}:function(n){return i.count(0,n)%t==0}):i:null}),i}var bx=mx((function(){}),(function(t,n){t.setTime(+t+n)}),(function(t,n){return n-t}));bx.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?mx((function(n){n.setTime(Math.floor(n/t)*t)}),(function(n,e){n.setTime(+n+e*t)}),(function(n,e){return(e-n)/t})):bx:null};var xx=bx,_x=bx.range,wx=mx((function(t){t.setTime(t-t.getMilliseconds())}),(function(t,n){t.setTime(+t+n*sx)}),(function(t,n){return(n-t)/sx}),(function(t){return t.getUTCSeconds()})),Ax=wx,Sx=wx.range,Mx=mx((function(t){t.setTime(t-t.getMilliseconds()-t.getSeconds()*sx)}),(function(t,n){t.setTime(+t+n*fx)}),(function(t,n){return(n-t)/fx}),(function(t){return t.getMinutes()})),Tx=Mx,Ex=Mx.range,Cx=mx((function(t){t.setTime(t-t.getMilliseconds()-t.getSeconds()*sx-t.getMinutes()*fx)}),(function(t,n){t.setTime(+t+n*lx)}),(function(t,n){return(n-t)/lx}),(function(t){return t.getHours()})),kx=Cx,Nx=Cx.range,Ox=mx((function(t){return t.setHours(0,0,0,0)}),(function(t,n){return t.setDate(t.getDate()+n)}),(function(t,n){return(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*fx)/hx}),(function(t){return t.getDate()-1})),Px=Ox,Ix=Ox.range;function Rx(t){return mx((function(n){n.setDate(n.getDate()-(n.getDay()+7-t)%7),n.setHours(0,0,0,0)}),(function(t,n){t.setDate(t.getDate()+7*n)}),(function(t,n){return(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*fx)/dx}))}var zx=Rx(0),Vx=Rx(1),Dx=Rx(2),jx=Rx(3),Lx=Rx(4),Ux=Rx(5),Bx=Rx(6),Fx=zx.range,qx=Vx.range,Hx=Dx.range,Yx=jx.range,Xx=Lx.range,$x=Ux.range,Wx=Bx.range,Gx=mx((function(t){t.setDate(1),t.setHours(0,0,0,0)}),(function(t,n){t.setMonth(t.getMonth()+n)}),(function(t,n){return n.getMonth()-t.getMonth()+12*(n.getFullYear()-t.getFullYear())}),(function(t){return t.getMonth()})),Qx=Gx,Zx=Gx.range,Kx=mx((function(t){t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,n){t.setFullYear(t.getFullYear()+n)}),(function(t,n){return n.getFullYear()-t.getFullYear()}),(function(t){return t.getFullYear()}));Kx.every=function(t){return isFinite(t=Math.floor(t))&&t>0?mx((function(n){n.setFullYear(Math.floor(n.getFullYear()/t)*t),n.setMonth(0,1),n.setHours(0,0,0,0)}),(function(n,e){n.setFullYear(n.getFullYear()+e*t)})):null};var Jx=Kx,t_=Kx.range,n_=mx((function(t){t.setUTCSeconds(0,0)}),(function(t,n){t.setTime(+t+n*fx)}),(function(t,n){return(n-t)/fx}),(function(t){return t.getUTCMinutes()})),e_=n_,r_=n_.range,i_=mx((function(t){t.setUTCMinutes(0,0,0)}),(function(t,n){t.setTime(+t+n*lx)}),(function(t,n){return(n-t)/lx}),(function(t){return t.getUTCHours()})),o_=i_,a_=i_.range,u_=mx((function(t){t.setUTCHours(0,0,0,0)}),(function(t,n){t.setUTCDate(t.getUTCDate()+n)}),(function(t,n){return(n-t)/hx}),(function(t){return t.getUTCDate()-1})),c_=u_,s_=u_.range;function f_(t){return mx((function(n){n.setUTCDate(n.getUTCDate()-(n.getUTCDay()+7-t)%7),n.setUTCHours(0,0,0,0)}),(function(t,n){t.setUTCDate(t.getUTCDate()+7*n)}),(function(t,n){return(n-t)/dx}))}var l_=f_(0),h_=f_(1),d_=f_(2),p_=f_(3),y_=f_(4),g_=f_(5),v_=f_(6),m_=l_.range,b_=h_.range,x_=d_.range,__=p_.range,w_=y_.range,A_=g_.range,S_=v_.range,M_=mx((function(t){t.setUTCDate(1),t.setUTCHours(0,0,0,0)}),(function(t,n){t.setUTCMonth(t.getUTCMonth()+n)}),(function(t,n){return n.getUTCMonth()-t.getUTCMonth()+12*(n.getUTCFullYear()-t.getUTCFullYear())}),(function(t){return t.getUTCMonth()})),T_=M_,E_=M_.range,C_=mx((function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n)}),(function(t,n){return n.getUTCFullYear()-t.getUTCFullYear()}),(function(t){return t.getUTCFullYear()}));C_.every=function(t){return isFinite(t=Math.floor(t))&&t>0?mx((function(n){n.setUTCFullYear(Math.floor(n.getUTCFullYear()/t)*t),n.setUTCMonth(0,1),n.setUTCHours(0,0,0,0)}),(function(n,e){n.setUTCFullYear(n.getUTCFullYear()+e*t)})):null};var k_=C_,N_=C_.range;function O_(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==e)return;var r,i,o=[],a=!0,u=!1;try{for(e=e.call(t);!(a=(r=e.next()).done)&&(o.push(r.value),!n||o.length!==n);a=!0);}catch(t){u=!0,i=t}finally{try{a||null==e.return||e.return()}finally{if(u)throw i}}return o}(t,n)||function(t,n){if(!t)return;if("string"==typeof t)return P_(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return P_(t,n)}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function P_(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function I_(t,n,e,r,o,a){var u=[[Ax,1,sx],[Ax,5,5e3],[Ax,15,15e3],[Ax,30,3e4],[a,1,fx],[a,5,3e5],[a,15,9e5],[a,30,18e5],[o,1,lx],[o,3,108e5],[o,6,216e5],[o,12,432e5],[r,1,hx],[r,2,1728e5],[e,1,dx],[n,1,px],[n,3,7776e6],[t,1,yx]];function c(n,e,r){var o=Math.abs(e-n)/r,a=i((function(t){return O_(t,3)[2]})).right(u,o);if(a===u.length)return t.every($t(n/yx,e/yx,r));if(0===a)return xx.every(Math.max($t(n,e,r),1));var c=O_(u[o/u[a-1][2]<u[a][2]/o?a-1:a],2),s=c[0],f=c[1];return s.every(f)}return[function(t,n,e){var r=n<t;if(r){var i=[n,t];t=i[0],n=i[1]}var o=e&&"function"==typeof e.range?e:c(t,n,e),a=o?o.range(t,+n+1):[];return r?a.reverse():a},c]}var R_=O_(I_(k_,T_,l_,c_,o_,e_),2),z_=R_[0],V_=R_[1],D_=O_(I_(Jx,Qx,zx,Px,kx,Tx),2),j_=D_[0],L_=D_[1];function U_(t){if(0<=t.y&&t.y<100){var n=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return n.setFullYear(t.y),n}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function B_(t){if(0<=t.y&&t.y<100){var n=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return n.setUTCFullYear(t.y),n}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function F_(t,n,e){return{y:t,m:n,d:e,H:0,M:0,S:0,L:0}}function q_(t){var n=t.dateTime,e=t.date,r=t.time,i=t.periods,o=t.days,a=t.shortDays,u=t.months,c=t.shortMonths,s=nw(i),f=ew(i),l=nw(o),h=ew(o),d=nw(a),p=ew(a),y=nw(u),g=ew(u),v=nw(c),m=ew(c),b={a:function(t){return a[t.getDay()]},A:function(t){return o[t.getDay()]},b:function(t){return c[t.getMonth()]},B:function(t){return u[t.getMonth()]},c:null,d:Aw,e:Aw,f:Cw,g:Lw,G:Bw,H:Sw,I:Mw,j:Tw,L:Ew,m:kw,M:Nw,p:function(t){return i[+(t.getHours()>=12)]},q:function(t){return 1+~~(t.getMonth()/3)},Q:fA,s:lA,S:Ow,u:Pw,U:Iw,V:zw,w:Vw,W:Dw,x:null,X:null,y:jw,Y:Uw,Z:Fw,"%":sA},x={a:function(t){return a[t.getUTCDay()]},A:function(t){return o[t.getUTCDay()]},b:function(t){return c[t.getUTCMonth()]},B:function(t){return u[t.getUTCMonth()]},c:null,d:qw,e:qw,f:Ww,g:oA,G:uA,H:Hw,I:Yw,j:Xw,L:$w,m:Gw,M:Qw,p:function(t){return i[+(t.getUTCHours()>=12)]},q:function(t){return 1+~~(t.getUTCMonth()/3)},Q:fA,s:lA,S:Zw,u:Kw,U:Jw,V:nA,w:eA,W:rA,x:null,X:null,y:iA,Y:aA,Z:cA,"%":sA},_={a:function(t,n,e){var r=d.exec(n.slice(e));return r?(t.w=p.get(r[0].toLowerCase()),e+r[0].length):-1},A:function(t,n,e){var r=l.exec(n.slice(e));return r?(t.w=h.get(r[0].toLowerCase()),e+r[0].length):-1},b:function(t,n,e){var r=v.exec(n.slice(e));return r?(t.m=m.get(r[0].toLowerCase()),e+r[0].length):-1},B:function(t,n,e){var r=y.exec(n.slice(e));return r?(t.m=g.get(r[0].toLowerCase()),e+r[0].length):-1},c:function(t,e,r){return S(t,n,e,r)},d:dw,e:dw,f:bw,g:sw,G:cw,H:yw,I:yw,j:pw,L:mw,m:hw,M:gw,p:function(t,n,e){var r=s.exec(n.slice(e));return r?(t.p=f.get(r[0].toLowerCase()),e+r[0].length):-1},q:lw,Q:_w,s:ww,S:vw,u:iw,U:ow,V:aw,w:rw,W:uw,x:function(t,n,r){return S(t,e,n,r)},X:function(t,n,e){return S(t,r,n,e)},y:sw,Y:cw,Z:fw,"%":xw};function w(t,n){return function(e){var r,i,o,a=[],u=-1,c=0,s=t.length;for(e instanceof Date||(e=new Date(+e));++u<s;)37===t.charCodeAt(u)&&(a.push(t.slice(c,u)),null!=(i=G_[r=t.charAt(++u)])?r=t.charAt(++u):i="e"===r?" ":"0",(o=n[r])&&(r=o(e,i)),a.push(r),c=u+1);return a.push(t.slice(c,u)),a.join("")}}function A(t,n){return function(e){var r,i,o=F_(1900,void 0,1);if(S(o,t,e+="",0)!=e.length)return null;if("Q"in o)return new Date(o.Q);if("s"in o)return new Date(1e3*o.s+("L"in o?o.L:0));if(n&&!("Z"in o)&&(o.Z=0),"p"in o&&(o.H=o.H%12+12*o.p),void 0===o.m&&(o.m="q"in o?o.q:0),"V"in o){if(o.V<1||o.V>53)return null;"w"in o||(o.w=1),"Z"in o?(i=(r=B_(F_(o.y,0,1))).getUTCDay(),r=i>4||0===i?h_.ceil(r):h_(r),r=c_.offset(r,7*(o.V-1)),o.y=r.getUTCFullYear(),o.m=r.getUTCMonth(),o.d=r.getUTCDate()+(o.w+6)%7):(i=(r=U_(F_(o.y,0,1))).getDay(),r=i>4||0===i?Vx.ceil(r):Vx(r),r=Px.offset(r,7*(o.V-1)),o.y=r.getFullYear(),o.m=r.getMonth(),o.d=r.getDate()+(o.w+6)%7)}else("W"in o||"U"in o)&&("w"in o||(o.w="u"in o?o.u%7:"W"in o?1:0),i="Z"in o?B_(F_(o.y,0,1)).getUTCDay():U_(F_(o.y,0,1)).getDay(),o.m=0,o.d="W"in o?(o.w+6)%7+7*o.W-(i+5)%7:o.w+7*o.U-(i+6)%7);return"Z"in o?(o.H+=o.Z/100|0,o.M+=o.Z%100,B_(o)):U_(o)}}function S(t,n,e,r){for(var i,o,a=0,u=n.length,c=e.length;a<u;){if(r>=c)return-1;if(37===(i=n.charCodeAt(a++))){if(i=n.charAt(a++),!(o=_[i in G_?n.charAt(a++):i])||(r=o(t,e,r))<0)return-1}else if(i!=e.charCodeAt(r++))return-1}return r}return b.x=w(e,b),b.X=w(r,b),b.c=w(n,b),x.x=w(e,x),x.X=w(r,x),x.c=w(n,x),{format:function(t){var n=w(t+="",b);return n.toString=function(){return t},n},parse:function(t){var n=A(t+="",!1);return n.toString=function(){return t},n},utcFormat:function(t){var n=w(t+="",x);return n.toString=function(){return t},n},utcParse:function(t){var n=A(t+="",!0);return n.toString=function(){return t},n}}}var H_,Y_,X_,$_,W_,G_={"-":"",_:" ",0:"0"},Q_=/^\s*\d+/,Z_=/^%/,K_=/[\\^$*+?|[\]().{}]/g;function J_(t,n,e){var r=t<0?"-":"",i=(r?-t:t)+"",o=i.length;return r+(o<e?new Array(e-o+1).join(n)+i:i)}function tw(t){return t.replace(K_,"\\$&")}function nw(t){return new RegExp("^(?:"+t.map(tw).join("|")+")","i")}function ew(t){return new Map(t.map((function(t,n){return[t.toLowerCase(),n]})))}function rw(t,n,e){var r=Q_.exec(n.slice(e,e+1));return r?(t.w=+r[0],e+r[0].length):-1}function iw(t,n,e){var r=Q_.exec(n.slice(e,e+1));return r?(t.u=+r[0],e+r[0].length):-1}function ow(t,n,e){var r=Q_.exec(n.slice(e,e+2));return r?(t.U=+r[0],e+r[0].length):-1}function aw(t,n,e){var r=Q_.exec(n.slice(e,e+2));return r?(t.V=+r[0],e+r[0].length):-1}function uw(t,n,e){var r=Q_.exec(n.slice(e,e+2));return r?(t.W=+r[0],e+r[0].length):-1}function cw(t,n,e){var r=Q_.exec(n.slice(e,e+4));return r?(t.y=+r[0],e+r[0].length):-1}function sw(t,n,e){var r=Q_.exec(n.slice(e,e+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),e+r[0].length):-1}function fw(t,n,e){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(n.slice(e,e+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),e+r[0].length):-1}function lw(t,n,e){var r=Q_.exec(n.slice(e,e+1));return r?(t.q=3*r[0]-3,e+r[0].length):-1}function hw(t,n,e){var r=Q_.exec(n.slice(e,e+2));return r?(t.m=r[0]-1,e+r[0].length):-1}function dw(t,n,e){var r=Q_.exec(n.slice(e,e+2));return r?(t.d=+r[0],e+r[0].length):-1}function pw(t,n,e){var r=Q_.exec(n.slice(e,e+3));return r?(t.m=0,t.d=+r[0],e+r[0].length):-1}function yw(t,n,e){var r=Q_.exec(n.slice(e,e+2));return r?(t.H=+r[0],e+r[0].length):-1}function gw(t,n,e){var r=Q_.exec(n.slice(e,e+2));return r?(t.M=+r[0],e+r[0].length):-1}function vw(t,n,e){var r=Q_.exec(n.slice(e,e+2));return r?(t.S=+r[0],e+r[0].length):-1}function mw(t,n,e){var r=Q_.exec(n.slice(e,e+3));return r?(t.L=+r[0],e+r[0].length):-1}function bw(t,n,e){var r=Q_.exec(n.slice(e,e+6));return r?(t.L=Math.floor(r[0]/1e3),e+r[0].length):-1}function xw(t,n,e){var r=Z_.exec(n.slice(e,e+1));return r?e+r[0].length:-1}function _w(t,n,e){var r=Q_.exec(n.slice(e));return r?(t.Q=+r[0],e+r[0].length):-1}function ww(t,n,e){var r=Q_.exec(n.slice(e));return r?(t.s=+r[0],e+r[0].length):-1}function Aw(t,n){return J_(t.getDate(),n,2)}function Sw(t,n){return J_(t.getHours(),n,2)}function Mw(t,n){return J_(t.getHours()%12||12,n,2)}function Tw(t,n){return J_(1+Px.count(Jx(t),t),n,3)}function Ew(t,n){return J_(t.getMilliseconds(),n,3)}function Cw(t,n){return Ew(t,n)+"000"}function kw(t,n){return J_(t.getMonth()+1,n,2)}function Nw(t,n){return J_(t.getMinutes(),n,2)}function Ow(t,n){return J_(t.getSeconds(),n,2)}function Pw(t){var n=t.getDay();return 0===n?7:n}function Iw(t,n){return J_(zx.count(Jx(t)-1,t),n,2)}function Rw(t){var n=t.getDay();return n>=4||0===n?Lx(t):Lx.ceil(t)}function zw(t,n){return t=Rw(t),J_(Lx.count(Jx(t),t)+(4===Jx(t).getDay()),n,2)}function Vw(t){return t.getDay()}function Dw(t,n){return J_(Vx.count(Jx(t)-1,t),n,2)}function jw(t,n){return J_(t.getFullYear()%100,n,2)}function Lw(t,n){return J_((t=Rw(t)).getFullYear()%100,n,2)}function Uw(t,n){return J_(t.getFullYear()%1e4,n,4)}function Bw(t,n){var e=t.getDay();return J_((t=e>=4||0===e?Lx(t):Lx.ceil(t)).getFullYear()%1e4,n,4)}function Fw(t){var n=t.getTimezoneOffset();return(n>0?"-":(n*=-1,"+"))+J_(n/60|0,"0",2)+J_(n%60,"0",2)}function qw(t,n){return J_(t.getUTCDate(),n,2)}function Hw(t,n){return J_(t.getUTCHours(),n,2)}function Yw(t,n){return J_(t.getUTCHours()%12||12,n,2)}function Xw(t,n){return J_(1+c_.count(k_(t),t),n,3)}function $w(t,n){return J_(t.getUTCMilliseconds(),n,3)}function Ww(t,n){return $w(t,n)+"000"}function Gw(t,n){return J_(t.getUTCMonth()+1,n,2)}function Qw(t,n){return J_(t.getUTCMinutes(),n,2)}function Zw(t,n){return J_(t.getUTCSeconds(),n,2)}function Kw(t){var n=t.getUTCDay();return 0===n?7:n}function Jw(t,n){return J_(l_.count(k_(t)-1,t),n,2)}function tA(t){var n=t.getUTCDay();return n>=4||0===n?y_(t):y_.ceil(t)}function nA(t,n){return t=tA(t),J_(y_.count(k_(t),t)+(4===k_(t).getUTCDay()),n,2)}function eA(t){return t.getUTCDay()}function rA(t,n){return J_(h_.count(k_(t)-1,t),n,2)}function iA(t,n){return J_(t.getUTCFullYear()%100,n,2)}function oA(t,n){return J_((t=tA(t)).getUTCFullYear()%100,n,2)}function aA(t,n){return J_(t.getUTCFullYear()%1e4,n,4)}function uA(t,n){var e=t.getUTCDay();return J_((t=e>=4||0===e?y_(t):y_.ceil(t)).getUTCFullYear()%1e4,n,4)}function cA(){return"+0000"}function sA(){return"%"}function fA(t){return+t}function lA(t){return Math.floor(+t/1e3)}function hA(t){return H_=q_(t),Y_=H_.format,X_=H_.parse,$_=H_.utcFormat,W_=H_.utcParse,H_}function dA(t){return new Date(t)}function pA(t){return t instanceof Date?+t:+new Date(+t)}function yA(t,n,e,r,i,o,a,u,c,s){var f=kb(),l=f.invert,h=f.domain,d=s(".%L"),p=s(":%S"),y=s("%I:%M"),g=s("%I %p"),v=s("%a %d"),m=s("%b %d"),b=s("%B"),x=s("%Y");function _(t){return(c(t)<t?d:u(t)<t?p:a(t)<t?y:o(t)<t?g:r(t)<t?i(t)<t?v:m:e(t)<t?b:x)(t)}return f.invert=function(t){return new Date(l(t))},f.domain=function(t){return arguments.length?h(Array.from(t,pA)):h().map(dA)},f.ticks=function(n){var e=h();return t(e[0],e[e.length-1],null==n?10:n)},f.tickFormat=function(t,n){return null==n?_:s(n)},f.nice=function(t){var e=h();return t&&"function"==typeof t.range||(t=n(e[0],e[e.length-1],null==t?10:t)),t?h(Rb(e,t)):f},f.copy=function(){return Eb(f,yA(t,n,e,r,i,o,a,u,c,s))},f}function gA(){return fb.apply(yA(j_,L_,Jx,Qx,zx,Px,kx,Tx,Ax,Y_).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function vA(){return fb.apply(yA(z_,V_,k_,T_,l_,c_,o_,e_,Ax,$_).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function mA(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==e)return;var r,i,o=[],a=!0,u=!1;try{for(e=e.call(t);!(a=(r=e.next()).done)&&(o.push(r.value),!n||o.length!==n);a=!0);}catch(t){u=!0,i=t}finally{try{a||null==e.return||e.return()}finally{if(u)throw i}}return o}(t,n)||function(t,n){if(!t)return;if("string"==typeof t)return bA(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return bA(t,n)}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function bA(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function xA(){var t,n,e,r,i,o=0,a=1,u=Ab,c=!1;function s(n){return null==n||isNaN(n=+n)?i:u(0===e?.5:(n=(r(n)-t)*e,c?Math.max(0,Math.min(1,n)):n))}function f(t){return function(n){var e,r,i;return arguments.length?(r=(e=mA(n,2))[0],i=e[1],u=t(r,i),s):[u(0),u(1)]}}return s.domain=function(i){var u;return arguments.length?(u=mA(i,2),o=u[0],a=u[1],t=r(o=+o),n=r(a=+a),e=t===n?0:1/(n-t),s):[o,a]},s.clamp=function(t){return arguments.length?(c=!!t,s):c},s.interpolator=function(t){return arguments.length?(u=t,s):u},s.range=f(Co),s.rangeRound=f(bm),s.unknown=function(t){return arguments.length?(i=t,s):i},function(i){return r=i,t=i(o),n=i(a),e=t===n?0:1/(n-t),s}}function _A(t,n){return n.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function wA(){var t=Ob(xA()(Ab));return t.copy=function(){return _A(t,wA())},lb.apply(t,arguments)}function AA(){var t=Bb(xA()).domain([1,10]);return t.copy=function(){return _A(t,AA()).base(t.base())},lb.apply(t,arguments)}function SA(){var t=Yb(xA());return t.copy=function(){return _A(t,SA()).constant(t.constant())},lb.apply(t,arguments)}function MA(){var t=Qb(xA());return t.copy=function(){return _A(t,MA()).exponent(t.exponent())},lb.apply(t,arguments)}function TA(){return MA.apply(null,arguments).exponent(.5)}function EA(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return CA(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return CA(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function CA(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function kA(){var t=[],n=Ab;function e(e){if(null!=e&&!isNaN(e=+e))return n((y(t,e,1)-1)/(t.length-1))}return e.domain=function(n){if(!arguments.length)return t.slice();t=[];var i,o=EA(n);try{for(o.s();!(i=o.n()).done;){var a=i.value;null==a||isNaN(a=+a)||t.push(a)}}catch(t){o.e(t)}finally{o.f()}return t.sort(r),e},e.interpolator=function(t){return arguments.length?(n=t,e):n},e.range=function(){return t.map((function(e,r){return n(r/(t.length-1))}))},e.quantiles=function(n){return Array.from({length:n+1},(function(e,r){return cn(t,r/n)}))},e.copy=function(){return kA(n).domain(t)},lb.apply(e,arguments)}function NA(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==e)return;var r,i,o=[],a=!0,u=!1;try{for(e=e.call(t);!(a=(r=e.next()).done)&&(o.push(r.value),!n||o.length!==n);a=!0);}catch(t){u=!0,i=t}finally{try{a||null==e.return||e.return()}finally{if(u)throw i}}return o}(t,n)||function(t,n){if(!t)return;if("string"==typeof t)return OA(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return OA(t,n)}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function OA(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function PA(){var t,n,e,r,i,o,a,u=0,c=.5,s=1,f=1,l=Ab,h=!1;function d(t){return isNaN(t=+t)?a:(t=.5+((t=+o(t))-n)*(f*t<f*n?r:i),l(h?Math.max(0,Math.min(1,t)):t))}function p(t){return function(n){var e,r,i,o;return arguments.length?(r=(e=NA(n,3))[0],i=e[1],o=e[2],l=Pm(t,[r,i,o]),d):[l(0),l(.5),l(1)]}}return d.domain=function(a){var l;return arguments.length?(l=NA(a,3),u=l[0],c=l[1],s=l[2],t=o(u=+u),n=o(c=+c),e=o(s=+s),r=t===n?0:.5/(n-t),i=n===e?0:.5/(e-n),f=n<t?-1:1,d):[u,c,s]},d.clamp=function(t){return arguments.length?(h=!!t,d):h},d.interpolator=function(t){return arguments.length?(l=t,d):l},d.range=p(Co),d.rangeRound=p(bm),d.unknown=function(t){return arguments.length?(a=t,d):a},function(a){return o=a,t=a(u),n=a(c),e=a(s),r=t===n?0:.5/(n-t),i=n===e?0:.5/(e-n),f=n<t?-1:1,d}}function IA(){var t=Ob(PA()(Ab));return t.copy=function(){return _A(t,IA())},lb.apply(t,arguments)}function RA(){var t=Bb(PA()).domain([.1,1,10]);return t.copy=function(){return _A(t,RA()).base(t.base())},lb.apply(t,arguments)}function zA(){var t=Yb(PA());return t.copy=function(){return _A(t,zA()).constant(t.constant())},lb.apply(t,arguments)}function VA(){var t=Qb(PA());return t.copy=function(){return _A(t,VA()).exponent(t.exponent())},lb.apply(t,arguments)}function DA(){return VA.apply(null,arguments).exponent(.5)}function jA(t){for(var n=t.length/6|0,e=new Array(n),r=0;r<n;)e[r]="#"+t.slice(6*r,6*++r);return e}hA({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var LA=jA("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),UA=jA("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666"),BA=jA("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666"),FA=jA("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),qA=jA("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2"),HA=jA("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc"),YA=jA("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999"),XA=jA("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),$A=jA("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"),WA=jA("4e79a7f28e2ce1575976b7b259a14fedc949af7aa1ff9da79c755fbab0ab"),GA=function(t){return po(t[t.length-1])},QA=new Array(3).concat("d8b365f5f5f55ab4ac","a6611adfc27d80cdc1018571","a6611adfc27df5f5f580cdc1018571","8c510ad8b365f6e8c3c7eae55ab4ac01665e","8c510ad8b365f6e8c3f5f5f5c7eae55ab4ac01665e","8c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e","8c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e","5430058c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e003c30","5430058c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e003c30").map(jA),ZA=GA(QA),KA=new Array(3).concat("af8dc3f7f7f77fbf7b","7b3294c2a5cfa6dba0008837","7b3294c2a5cff7f7f7a6dba0008837","762a83af8dc3e7d4e8d9f0d37fbf7b1b7837","762a83af8dc3e7d4e8f7f7f7d9f0d37fbf7b1b7837","762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b7837","762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b7837","40004b762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b783700441b","40004b762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b783700441b").map(jA),JA=GA(KA),tS=new Array(3).concat("e9a3c9f7f7f7a1d76a","d01c8bf1b6dab8e1864dac26","d01c8bf1b6daf7f7f7b8e1864dac26","c51b7de9a3c9fde0efe6f5d0a1d76a4d9221","c51b7de9a3c9fde0eff7f7f7e6f5d0a1d76a4d9221","c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221","c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221","8e0152c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221276419","8e0152c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221276419").map(jA),nS=GA(tS),eS=new Array(3).concat("998ec3f7f7f7f1a340","5e3c99b2abd2fdb863e66101","5e3c99b2abd2f7f7f7fdb863e66101","542788998ec3d8daebfee0b6f1a340b35806","542788998ec3d8daebf7f7f7fee0b6f1a340b35806","5427888073acb2abd2d8daebfee0b6fdb863e08214b35806","5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b35806","2d004b5427888073acb2abd2d8daebfee0b6fdb863e08214b358067f3b08","2d004b5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b358067f3b08").map(jA),rS=GA(eS),iS=new Array(3).concat("ef8a62f7f7f767a9cf","ca0020f4a58292c5de0571b0","ca0020f4a582f7f7f792c5de0571b0","b2182bef8a62fddbc7d1e5f067a9cf2166ac","b2182bef8a62fddbc7f7f7f7d1e5f067a9cf2166ac","b2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac","b2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac","67001fb2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac053061","67001fb2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac053061").map(jA),oS=GA(iS),aS=new Array(3).concat("ef8a62ffffff999999","ca0020f4a582bababa404040","ca0020f4a582ffffffbababa404040","b2182bef8a62fddbc7e0e0e09999994d4d4d","b2182bef8a62fddbc7ffffffe0e0e09999994d4d4d","b2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d","b2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d","67001fb2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d1a1a1a","67001fb2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d1a1a1a").map(jA),uS=GA(aS),cS=new Array(3).concat("fc8d59ffffbf91bfdb","d7191cfdae61abd9e92c7bb6","d7191cfdae61ffffbfabd9e92c7bb6","d73027fc8d59fee090e0f3f891bfdb4575b4","d73027fc8d59fee090ffffbfe0f3f891bfdb4575b4","d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4","d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4","a50026d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4313695","a50026d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4313695").map(jA),sS=GA(cS),fS=new Array(3).concat("fc8d59ffffbf91cf60","d7191cfdae61a6d96a1a9641","d7191cfdae61ffffbfa6d96a1a9641","d73027fc8d59fee08bd9ef8b91cf601a9850","d73027fc8d59fee08bffffbfd9ef8b91cf601a9850","d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850","d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850","a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837","a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837").map(jA),lS=GA(fS),hS=new Array(3).concat("fc8d59ffffbf99d594","d7191cfdae61abdda42b83ba","d7191cfdae61ffffbfabdda42b83ba","d53e4ffc8d59fee08be6f59899d5943288bd","d53e4ffc8d59fee08bffffbfe6f59899d5943288bd","d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd","d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd","9e0142d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd5e4fa2","9e0142d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd5e4fa2").map(jA),dS=GA(hS),pS=new Array(3).concat("e5f5f999d8c92ca25f","edf8fbb2e2e266c2a4238b45","edf8fbb2e2e266c2a42ca25f006d2c","edf8fbccece699d8c966c2a42ca25f006d2c","edf8fbccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45006d2c00441b").map(jA),yS=GA(pS),gS=new Array(3).concat("e0ecf49ebcda8856a7","edf8fbb3cde38c96c688419d","edf8fbb3cde38c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d810f7c4d004b").map(jA),vS=GA(gS),mS=new Array(3).concat("e0f3dba8ddb543a2ca","f0f9e8bae4bc7bccc42b8cbe","f0f9e8bae4bc7bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe0868ac084081").map(jA),bS=GA(mS),xS=new Array(3).concat("fee8c8fdbb84e34a33","fef0d9fdcc8afc8d59d7301f","fef0d9fdcc8afc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301fb300007f0000").map(jA),_S=GA(xS),wS=new Array(3).concat("ece2f0a6bddb1c9099","f6eff7bdc9e167a9cf02818a","f6eff7bdc9e167a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016c59014636").map(jA),AS=GA(wS),SS=new Array(3).concat("ece7f2a6bddb2b8cbe","f1eef6bdc9e174a9cf0570b0","f1eef6bdc9e174a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0045a8d023858").map(jA),MS=GA(SS),TS=new Array(3).concat("e7e1efc994c7dd1c77","f1eef6d7b5d8df65b0ce1256","f1eef6d7b5d8df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125698004367001f").map(jA),ES=GA(TS),CS=new Array(3).concat("fde0ddfa9fb5c51b8a","feebe2fbb4b9f768a1ae017e","feebe2fbb4b9f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a017749006a").map(jA),kS=GA(CS),NS=new Array(3).concat("edf8b17fcdbb2c7fb8","ffffcca1dab441b6c4225ea8","ffffcca1dab441b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea8253494081d58").map(jA),OS=GA(NS),PS=new Array(3).concat("f7fcb9addd8e31a354","ffffccc2e69978c679238443","ffffccc2e69978c67931a354006837","ffffccd9f0a3addd8e78c67931a354006837","ffffccd9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443006837004529").map(jA),IS=GA(PS),RS=new Array(3).concat("fff7bcfec44fd95f0e","ffffd4fed98efe9929cc4c02","ffffd4fed98efe9929d95f0e993404","ffffd4fee391fec44ffe9929d95f0e993404","ffffd4fee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c02993404662506").map(jA),zS=GA(RS),VS=new Array(3).concat("ffeda0feb24cf03b20","ffffb2fecc5cfd8d3ce31a1c","ffffb2fecc5cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026").map(jA),DS=GA(VS),jS=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(jA),LS=GA(jS),US=new Array(3).concat("e5f5e0a1d99b31a354","edf8e9bae4b374c476238b45","edf8e9bae4b374c47631a354006d2c","edf8e9c7e9c0a1d99b74c47631a354006d2c","edf8e9c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45006d2c00441b").map(jA),BS=GA(US),FS=new Array(3).concat("f0f0f0bdbdbd636363","f7f7f7cccccc969696525252","f7f7f7cccccc969696636363252525","f7f7f7d9d9d9bdbdbd969696636363252525","f7f7f7d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000").map(jA),qS=GA(FS),HS=new Array(3).concat("efedf5bcbddc756bb1","f2f0f7cbc9e29e9ac86a51a3","f2f0f7cbc9e29e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a354278f3f007d").map(jA),YS=GA(HS),XS=new Array(3).concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map(jA),$S=GA(XS),WS=new Array(3).concat("fee6cefdae6be6550d","feeddefdbe85fd8d3cd94701","feeddefdbe85fd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704").map(jA),GS=GA(WS);function QS(t){return t=Math.max(0,Math.min(1,t)),"rgb("+Math.max(0,Math.min(255,Math.round(-4.54-t*(35.34-t*(2381.73-t*(6402.7-t*(7024.72-2710.57*t)))))))+", "+Math.max(0,Math.min(255,Math.round(32.49+t*(170.73+t*(52.82-t*(131.46-t*(176.58-67.37*t)))))))+", "+Math.max(0,Math.min(255,Math.round(81.24+t*(442.36-t*(2482.43-t*(6167.24-t*(6614.94-2475.67*t)))))))+")"}var ZS=Om(Lc(300,.5,0),Lc(-240,.5,1)),KS=Om(Lc(-100,.75,.35),Lc(80,1.5,.8)),JS=Om(Lc(260,.75,.35),Lc(80,1.5,.8)),tM=Lc();function nM(t){(t<0||t>1)&&(t-=Math.floor(t));var n=Math.abs(t-.5);return tM.h=360*t-100,tM.s=1.5-1.5*n,tM.l=.8-.9*n,tM+""}var eM=$i(),rM=Math.PI/3,iM=2*Math.PI/3;function oM(t){var n;return t=(.5-t)*Math.PI,eM.r=255*(n=Math.sin(t))*n,eM.g=255*(n=Math.sin(t+rM))*n,eM.b=255*(n=Math.sin(t+iM))*n,eM+""}function aM(t){return t=Math.max(0,Math.min(1,t)),"rgb("+Math.max(0,Math.min(255,Math.round(34.61+t*(1172.33-t*(10793.56-t*(33300.12-t*(38394.49-14825.05*t)))))))+", "+Math.max(0,Math.min(255,Math.round(23.31+t*(557.33+t*(1225.33-t*(3574.96-t*(1073.77+707.56*t)))))))+", "+Math.max(0,Math.min(255,Math.round(27.2+t*(3211.1-t*(15327.97-t*(27814-t*(22569.18-6838.66*t)))))))+")"}function uM(t){var n=t.length;return function(e){return t[Math.max(0,Math.min(n-1,Math.floor(e*n)))]}}var cM=uM(jA("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725")),sM=uM(jA("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),fM=uM(jA("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),lM=uM(jA("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921"));function hM(t){return mi(ni(t).call(document.documentElement))}var dM=0;function pM(){return new yM}function yM(){this._="@"+(++dM).toString(36)}function gM(t,n){return t.target&&(t=ko(t),void 0===n&&(n=t.currentTarget),t=t.touches||[t]),Array.from(t,(function(t){return No(t,n)}))}function vM(t){return"string"==typeof t?new yi([document.querySelectorAll(t)],[document.documentElement]):new yi([tr(t)],pi)}function mM(t){return function(){return t}}yM.prototype=pM.prototype={constructor:yM,get:function(t){for(var n=this._;!(n in t);)if(!(t=t.parentNode))return;return t[n]},set:function(t,n){return t[this._]=n},remove:function(t){return this._ in t&&delete t[this._]},toString:function(){return this._}};var bM=Math.abs,xM=Math.atan2,_M=Math.cos,wM=Math.max,AM=Math.min,SM=Math.sin,MM=Math.sqrt,TM=1e-12,EM=Math.PI,CM=EM/2,kM=2*EM;function NM(t){return t>1?0:t<-1?EM:Math.acos(t)}function OM(t){return t>=1?CM:t<=-1?-CM:Math.asin(t)}function PM(t){return t.innerRadius}function IM(t){return t.outerRadius}function RM(t){return t.startAngle}function zM(t){return t.endAngle}function VM(t){return t&&t.padAngle}function DM(t,n,e,r,i,o,a,u){var c=e-t,s=r-n,f=a-i,l=u-o,h=l*c-f*s;if(!(h*h<TM))return[t+(h=(f*(n-o)-l*(t-i))/h)*c,n+h*s]}function jM(t,n,e,r,i,o,a){var u=t-e,c=n-r,s=(a?o:-o)/MM(u*u+c*c),f=s*c,l=-s*u,h=t+f,d=n+l,p=e+f,y=r+l,g=(h+p)/2,v=(d+y)/2,m=p-h,b=y-d,x=m*m+b*b,_=i-o,w=h*y-p*d,A=(b<0?-1:1)*MM(wM(0,_*_*x-w*w)),S=(w*b-m*A)/x,M=(-w*m-b*A)/x,T=(w*b+m*A)/x,E=(-w*m+b*A)/x,C=S-g,k=M-v,N=T-g,O=E-v;return C*C+k*k>N*N+O*O&&(S=T,M=E),{cx:S,cy:M,x01:-f,y01:-l,x11:S*(i/_-1),y11:M*(i/_-1)}}function LM(){var t=PM,n=IM,e=mM(0),r=null,i=RM,o=zM,a=VM,u=null;function c(){var c,s,f=+t.apply(this,arguments),l=+n.apply(this,arguments),h=i.apply(this,arguments)-CM,d=o.apply(this,arguments)-CM,p=bM(d-h),y=d>h;if(u||(u=c=Zu()),l<f&&(s=l,l=f,f=s),l>TM)if(p>kM-TM)u.moveTo(l*_M(h),l*SM(h)),u.arc(0,0,l,h,d,!y),f>TM&&(u.moveTo(f*_M(d),f*SM(d)),u.arc(0,0,f,d,h,y));else{var g,v,m=h,b=d,x=h,_=d,w=p,A=p,S=a.apply(this,arguments)/2,M=S>TM&&(r?+r.apply(this,arguments):MM(f*f+l*l)),T=AM(bM(l-f)/2,+e.apply(this,arguments)),E=T,C=T;if(M>TM){var k=OM(M/f*SM(S)),N=OM(M/l*SM(S));(w-=2*k)>TM?(x+=k*=y?1:-1,_-=k):(w=0,x=_=(h+d)/2),(A-=2*N)>TM?(m+=N*=y?1:-1,b-=N):(A=0,m=b=(h+d)/2)}var O=l*_M(m),P=l*SM(m),I=f*_M(_),R=f*SM(_);if(T>TM){var z,V=l*_M(b),D=l*SM(b),j=f*_M(x),L=f*SM(x);if(p<EM&&(z=DM(O,P,j,L,V,D,I,R))){var U=O-z[0],B=P-z[1],F=V-z[0],q=D-z[1],H=1/SM(NM((U*F+B*q)/(MM(U*U+B*B)*MM(F*F+q*q)))/2),Y=MM(z[0]*z[0]+z[1]*z[1]);E=AM(T,(f-Y)/(H-1)),C=AM(T,(l-Y)/(H+1))}}A>TM?C>TM?(g=jM(j,L,O,P,l,C,y),v=jM(V,D,I,R,l,C,y),u.moveTo(g.cx+g.x01,g.cy+g.y01),C<T?u.arc(g.cx,g.cy,C,xM(g.y01,g.x01),xM(v.y01,v.x01),!y):(u.arc(g.cx,g.cy,C,xM(g.y01,g.x01),xM(g.y11,g.x11),!y),u.arc(0,0,l,xM(g.cy+g.y11,g.cx+g.x11),xM(v.cy+v.y11,v.cx+v.x11),!y),u.arc(v.cx,v.cy,C,xM(v.y11,v.x11),xM(v.y01,v.x01),!y))):(u.moveTo(O,P),u.arc(0,0,l,m,b,!y)):u.moveTo(O,P),f>TM&&w>TM?E>TM?(g=jM(I,R,V,D,f,-E,y),v=jM(O,P,j,L,f,-E,y),u.lineTo(g.cx+g.x01,g.cy+g.y01),E<T?u.arc(g.cx,g.cy,E,xM(g.y01,g.x01),xM(v.y01,v.x01),!y):(u.arc(g.cx,g.cy,E,xM(g.y01,g.x01),xM(g.y11,g.x11),!y),u.arc(0,0,f,xM(g.cy+g.y11,g.cx+g.x11),xM(v.cy+v.y11,v.cx+v.x11),y),u.arc(v.cx,v.cy,E,xM(v.y11,v.x11),xM(v.y01,v.x01),!y))):u.arc(0,0,f,_,x,y):u.lineTo(I,R)}else u.moveTo(0,0);if(u.closePath(),c)return u=null,c+""||null}return c.centroid=function(){var e=(+t.apply(this,arguments)+ +n.apply(this,arguments))/2,r=(+i.apply(this,arguments)+ +o.apply(this,arguments))/2-EM/2;return[_M(r)*e,SM(r)*e]},c.innerRadius=function(n){return arguments.length?(t="function"==typeof n?n:mM(+n),c):t},c.outerRadius=function(t){return arguments.length?(n="function"==typeof t?t:mM(+t),c):n},c.cornerRadius=function(t){return arguments.length?(e="function"==typeof t?t:mM(+t),c):e},c.padRadius=function(t){return arguments.length?(r=null==t?null:"function"==typeof t?t:mM(+t),c):r},c.startAngle=function(t){return arguments.length?(i="function"==typeof t?t:mM(+t),c):i},c.endAngle=function(t){return arguments.length?(o="function"==typeof t?t:mM(+t),c):o},c.padAngle=function(t){return arguments.length?(a="function"==typeof t?t:mM(+t),c):a},c.context=function(t){return arguments.length?(u=null==t?null:t,c):u},c}function UM(t){return(UM="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var BM=Array.prototype.slice;function FM(t){return"object"===UM(t)&&"length"in t?t:Array.from(t)}function qM(t){this._context=t}function HM(t){return new qM(t)}function YM(t){return t[0]}function XM(t){return t[1]}function $M(t,n){var e=mM(!0),r=null,i=HM,o=null;function a(a){var u,c,s,f=(a=FM(a)).length,l=!1;for(null==r&&(o=i(s=Zu())),u=0;u<=f;++u)!(u<f&&e(c=a[u],u,a))===l&&((l=!l)?o.lineStart():o.lineEnd()),l&&o.point(+t(c,u,a),+n(c,u,a));if(s)return o=null,s+""||null}return t="function"==typeof t?t:void 0===t?YM:mM(t),n="function"==typeof n?n:void 0===n?XM:mM(n),a.x=function(n){return arguments.length?(t="function"==typeof n?n:mM(+n),a):t},a.y=function(t){return arguments.length?(n="function"==typeof t?t:mM(+t),a):n},a.defined=function(t){return arguments.length?(e="function"==typeof t?t:mM(!!t),a):e},a.curve=function(t){return arguments.length?(i=t,null!=r&&(o=i(r)),a):i},a.context=function(t){return arguments.length?(null==t?r=o=null:o=i(r=t),a):r},a}function WM(t,n,e){var r=null,i=mM(!0),o=null,a=HM,u=null;function c(c){var s,f,l,h,d,p=(c=FM(c)).length,y=!1,g=new Array(p),v=new Array(p);for(null==o&&(u=a(d=Zu())),s=0;s<=p;++s){if(!(s<p&&i(h=c[s],s,c))===y)if(y=!y)f=s,u.areaStart(),u.lineStart();else{for(u.lineEnd(),u.lineStart(),l=s-1;l>=f;--l)u.point(g[l],v[l]);u.lineEnd(),u.areaEnd()}y&&(g[s]=+t(h,s,c),v[s]=+n(h,s,c),u.point(r?+r(h,s,c):g[s],e?+e(h,s,c):v[s]))}if(d)return u=null,d+""||null}function s(){return $M().defined(i).curve(a).context(o)}return t="function"==typeof t?t:void 0===t?YM:mM(+t),n="function"==typeof n?n:mM(void 0===n?0:+n),e="function"==typeof e?e:void 0===e?XM:mM(+e),c.x=function(n){return arguments.length?(t="function"==typeof n?n:mM(+n),r=null,c):t},c.x0=function(n){return arguments.length?(t="function"==typeof n?n:mM(+n),c):t},c.x1=function(t){return arguments.length?(r=null==t?null:"function"==typeof t?t:mM(+t),c):r},c.y=function(t){return arguments.length?(n="function"==typeof t?t:mM(+t),e=null,c):n},c.y0=function(t){return arguments.length?(n="function"==typeof t?t:mM(+t),c):n},c.y1=function(t){return arguments.length?(e=null==t?null:"function"==typeof t?t:mM(+t),c):e},c.lineX0=c.lineY0=function(){return s().x(t).y(n)},c.lineY1=function(){return s().x(t).y(e)},c.lineX1=function(){return s().x(r).y(n)},c.defined=function(t){return arguments.length?(i="function"==typeof t?t:mM(!!t),c):i},c.curve=function(t){return arguments.length?(a=t,null!=o&&(u=a(o)),c):a},c.context=function(t){return arguments.length?(null==t?o=u=null:u=a(o=t),c):o},c}function GM(t,n){return n<t?-1:n>t?1:n>=t?0:NaN}function QM(t){return t}function ZM(){var t=QM,n=GM,e=null,r=mM(0),i=mM(kM),o=mM(0);function a(a){var u,c,s,f,l,h=(a=FM(a)).length,d=0,p=new Array(h),y=new Array(h),g=+r.apply(this,arguments),v=Math.min(kM,Math.max(-kM,i.apply(this,arguments)-g)),m=Math.min(Math.abs(v)/h,o.apply(this,arguments)),b=m*(v<0?-1:1);for(u=0;u<h;++u)(l=y[p[u]=u]=+t(a[u],u,a))>0&&(d+=l);for(null!=n?p.sort((function(t,e){return n(y[t],y[e])})):null!=e&&p.sort((function(t,n){return e(a[t],a[n])})),u=0,s=d?(v-h*b)/d:0;u<h;++u,g=f)c=p[u],f=g+((l=y[c])>0?l*s:0)+b,y[c]={data:a[c],index:u,value:l,startAngle:g,endAngle:f,padAngle:m};return y}return a.value=function(n){return arguments.length?(t="function"==typeof n?n:mM(+n),a):t},a.sortValues=function(t){return arguments.length?(n=t,e=null,a):n},a.sort=function(t){return arguments.length?(e=t,n=null,a):e},a.startAngle=function(t){return arguments.length?(r="function"==typeof t?t:mM(+t),a):r},a.endAngle=function(t){return arguments.length?(i="function"==typeof t?t:mM(+t),a):i},a.padAngle=function(t){return arguments.length?(o="function"==typeof t?t:mM(+t),a):o},a}qM.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2;default:this._context.lineTo(t,n)}}};var KM=tT(HM);function JM(t){this._curve=t}function tT(t){function n(n){return new JM(t(n))}return n._curve=t,n}function nT(t){var n=t.curve;return t.angle=t.x,delete t.x,t.radius=t.y,delete t.y,t.curve=function(t){return arguments.length?n(tT(t)):n()._curve},t}function eT(){return nT($M().curve(KM))}function rT(){var t=WM().curve(KM),n=t.curve,e=t.lineX0,r=t.lineX1,i=t.lineY0,o=t.lineY1;return t.angle=t.x,delete t.x,t.startAngle=t.x0,delete t.x0,t.endAngle=t.x1,delete t.x1,t.radius=t.y,delete t.y,t.innerRadius=t.y0,delete t.y0,t.outerRadius=t.y1,delete t.y1,t.lineStartAngle=function(){return nT(e())},delete t.lineX0,t.lineEndAngle=function(){return nT(r())},delete t.lineX1,t.lineInnerRadius=function(){return nT(i())},delete t.lineY0,t.lineOuterRadius=function(){return nT(o())},delete t.lineY1,t.curve=function(t){return arguments.length?n(tT(t)):n()._curve},t}function iT(t,n){return[(n=+n)*Math.cos(t-=Math.PI/2),n*Math.sin(t)]}function oT(t){return t.source}function aT(t){return t.target}function uT(t){var n=oT,e=aT,r=YM,i=XM,o=null;function a(){var a,u=BM.call(arguments),c=n.apply(this,u),s=e.apply(this,u);if(o||(o=a=Zu()),t(o,+r.apply(this,(u[0]=c,u)),+i.apply(this,u),+r.apply(this,(u[0]=s,u)),+i.apply(this,u)),a)return o=null,a+""||null}return a.source=function(t){return arguments.length?(n=t,a):n},a.target=function(t){return arguments.length?(e=t,a):e},a.x=function(t){return arguments.length?(r="function"==typeof t?t:mM(+t),a):r},a.y=function(t){return arguments.length?(i="function"==typeof t?t:mM(+t),a):i},a.context=function(t){return arguments.length?(o=null==t?null:t,a):o},a}function cT(t,n,e,r,i){t.moveTo(n,e),t.bezierCurveTo(n=(n+r)/2,e,n,i,r,i)}function sT(t,n,e,r,i){t.moveTo(n,e),t.bezierCurveTo(n,e=(e+i)/2,r,e,r,i)}function fT(t,n,e,r,i){var o=iT(n,e),a=iT(n,e=(e+i)/2),u=iT(r,e),c=iT(r,i);t.moveTo(o[0],o[1]),t.bezierCurveTo(a[0],a[1],u[0],u[1],c[0],c[1])}function lT(){return uT(cT)}function hT(){return uT(sT)}function dT(){var t=uT(fT);return t.angle=t.x,delete t.x,t.radius=t.y,delete t.y,t}JM.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(t,n){this._curve.point(n*Math.sin(t),n*-Math.cos(t))}};var pT={draw:function(t,n){var e=Math.sqrt(n/EM);t.moveTo(e,0),t.arc(0,0,e,0,kM)}},yT={draw:function(t,n){var e=Math.sqrt(n/5)/2;t.moveTo(-3*e,-e),t.lineTo(-e,-e),t.lineTo(-e,-3*e),t.lineTo(e,-3*e),t.lineTo(e,-e),t.lineTo(3*e,-e),t.lineTo(3*e,e),t.lineTo(e,e),t.lineTo(e,3*e),t.lineTo(-e,3*e),t.lineTo(-e,e),t.lineTo(-3*e,e),t.closePath()}},gT=Math.sqrt(1/3),vT=2*gT,mT={draw:function(t,n){var e=Math.sqrt(n/vT),r=e*gT;t.moveTo(0,-e),t.lineTo(r,0),t.lineTo(0,e),t.lineTo(-r,0),t.closePath()}},bT=Math.sin(EM/10)/Math.sin(7*EM/10),xT=Math.sin(kM/10)*bT,_T=-Math.cos(kM/10)*bT,wT={draw:function(t,n){var e=Math.sqrt(.8908130915292852*n),r=xT*e,i=_T*e;t.moveTo(0,-e),t.lineTo(r,i);for(var o=1;o<5;++o){var a=kM*o/5,u=Math.cos(a),c=Math.sin(a);t.lineTo(c*e,-u*e),t.lineTo(u*r-c*i,c*r+u*i)}t.closePath()}},AT={draw:function(t,n){var e=Math.sqrt(n),r=-e/2;t.rect(r,r,e,e)}},ST=Math.sqrt(3),MT={draw:function(t,n){var e=-Math.sqrt(n/(3*ST));t.moveTo(0,2*e),t.lineTo(-ST*e,-e),t.lineTo(ST*e,-e),t.closePath()}},TT=-.5,ET=Math.sqrt(3)/2,CT=1/Math.sqrt(12),kT=3*(CT/2+1),NT={draw:function(t,n){var e=Math.sqrt(n/kT),r=e/2,i=e*CT,o=r,a=e*CT+e,u=-o,c=a;t.moveTo(r,i),t.lineTo(o,a),t.lineTo(u,c),t.lineTo(TT*r-ET*i,ET*r+TT*i),t.lineTo(TT*o-ET*a,ET*o+TT*a),t.lineTo(TT*u-ET*c,ET*u+TT*c),t.lineTo(TT*r+ET*i,TT*i-ET*r),t.lineTo(TT*o+ET*a,TT*a-ET*o),t.lineTo(TT*u+ET*c,TT*c-ET*u),t.closePath()}},OT=[pT,yT,mT,AT,wT,MT,NT];function PT(t,n){var e=null;function r(){var r;if(e||(e=r=Zu()),t.apply(this,arguments).draw(e,+n.apply(this,arguments)),r)return e=null,r+""||null}return t="function"==typeof t?t:mM(t||pT),n="function"==typeof n?n:mM(void 0===n?64:+n),r.type=function(n){return arguments.length?(t="function"==typeof n?n:mM(n),r):t},r.size=function(t){return arguments.length?(n="function"==typeof t?t:mM(+t),r):n},r.context=function(t){return arguments.length?(e=null==t?null:t,r):e},r}function IT(){}function RT(t,n,e){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+n)/6,(t._y0+4*t._y1+e)/6)}function zT(t){this._context=t}function VT(t){return new zT(t)}function DT(t){this._context=t}function jT(t){return new DT(t)}function LT(t){this._context=t}function UT(t){return new LT(t)}function BT(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}zT.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:RT(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:RT(this,t,n)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=n}},DT.prototype={areaStart:IT,areaEnd:IT,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._x2=t,this._y2=n;break;case 1:this._point=2,this._x3=t,this._y3=n;break;case 2:this._point=3,this._x4=t,this._y4=n,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+n)/6);break;default:RT(this,t,n)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=n}},LT.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var e=(this._x0+4*this._x1+t)/6,r=(this._y0+4*this._y1+n)/6;this._line?this._context.lineTo(e,r):this._context.moveTo(e,r);break;case 3:this._point=4;default:RT(this,t,n)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=n}};var FT=function(){function t(n,e){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this._context=n,this._x=e}var n,e,r;return n=t,(e=[{key:"areaStart",value:function(){this._line=0}},{key:"areaEnd",value:function(){this._line=NaN}},{key:"lineStart",value:function(){this._point=0}},{key:"lineEnd",value:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line}},{key:"point",value:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2;default:this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,n,t,n):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+n)/2,t,this._y0,t,n)}this._x0=t,this._y0=n}}])&&BT(n.prototype,e),r&&BT(n,r),Object.defineProperty(n,"prototype",{writable:!1}),t}();function qT(t){return new FT(t,!0)}function HT(t){return new FT(t,!1)}function YT(t,n){this._basis=new zT(t),this._beta=n}YT.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var t=this._x,n=this._y,e=t.length-1;if(e>0)for(var r,i=t[0],o=n[0],a=t[e]-i,u=n[e]-o,c=-1;++c<=e;)r=c/e,this._basis.point(this._beta*t[c]+(1-this._beta)*(i+r*a),this._beta*n[c]+(1-this._beta)*(o+r*u));this._x=this._y=null,this._basis.lineEnd()},point:function(t,n){this._x.push(+t),this._y.push(+n)}};var XT=function t(n){function e(t){return 1===n?new zT(t):new YT(t,n)}return e.beta=function(n){return t(+n)},e}(.85);function $T(t,n,e){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-n),t._y2+t._k*(t._y1-e),t._x2,t._y2)}function WT(t,n){this._context=t,this._k=(1-n)/6}WT.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:$T(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2,this._x1=t,this._y1=n;break;case 2:this._point=3;default:$T(this,t,n)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=n}};var GT=function t(n){function e(t){return new WT(t,n)}return e.tension=function(n){return t(+n)},e}(0);function QT(t,n){this._context=t,this._k=(1-n)/6}QT.prototype={areaStart:IT,areaEnd:IT,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._x3=t,this._y3=n;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=n);break;case 2:this._point=3,this._x5=t,this._y5=n;break;default:$T(this,t,n)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=n}};var ZT=function t(n){function e(t){return new QT(t,n)}return e.tension=function(n){return t(+n)},e}(0);function KT(t,n){this._context=t,this._k=(1-n)/6}KT.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:$T(this,t,n)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=n}};var JT=function t(n){function e(t){return new KT(t,n)}return e.tension=function(n){return t(+n)},e}(0);function tE(t,n,e){var r=t._x1,i=t._y1,o=t._x2,a=t._y2;if(t._l01_a>TM){var u=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,c=3*t._l01_a*(t._l01_a+t._l12_a);r=(r*u-t._x0*t._l12_2a+t._x2*t._l01_2a)/c,i=(i*u-t._y0*t._l12_2a+t._y2*t._l01_2a)/c}if(t._l23_a>TM){var s=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,f=3*t._l23_a*(t._l23_a+t._l12_a);o=(o*s+t._x1*t._l23_2a-n*t._l12_2a)/f,a=(a*s+t._y1*t._l23_2a-e*t._l12_2a)/f}t._context.bezierCurveTo(r,i,o,a,t._x2,t._y2)}function nE(t,n){this._context=t,this._alpha=n}nE.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){if(t=+t,n=+n,this._point){var e=this._x2-t,r=this._y2-n;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(e*e+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2;break;case 2:this._point=3;default:tE(this,t,n)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=n}};var eE=function t(n){function e(t){return n?new nE(t,n):new WT(t,0)}return e.alpha=function(n){return t(+n)},e}(.5);function rE(t,n){this._context=t,this._alpha=n}rE.prototype={areaStart:IT,areaEnd:IT,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,n){if(t=+t,n=+n,this._point){var e=this._x2-t,r=this._y2-n;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(e*e+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=t,this._y3=n;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=n);break;case 2:this._point=3,this._x5=t,this._y5=n;break;default:tE(this,t,n)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=n}};var iE=function t(n){function e(t){return n?new rE(t,n):new QT(t,0)}return e.alpha=function(n){return t(+n)},e}(.5);function oE(t,n){this._context=t,this._alpha=n}oE.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){if(t=+t,n=+n,this._point){var e=this._x2-t,r=this._y2-n;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(e*e+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:tE(this,t,n)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=n}};var aE=function t(n){function e(t){return n?new oE(t,n):new KT(t,0)}return e.alpha=function(n){return t(+n)},e}(.5);function uE(t){this._context=t}function cE(t){return new uE(t)}function sE(t){return t<0?-1:1}function fE(t,n,e){var r=t._x1-t._x0,i=n-t._x1,o=(t._y1-t._y0)/(r||i<0&&-0),a=(e-t._y1)/(i||r<0&&-0),u=(o*i+a*r)/(r+i);return(sE(o)+sE(a))*Math.min(Math.abs(o),Math.abs(a),.5*Math.abs(u))||0}function lE(t,n){var e=t._x1-t._x0;return e?(3*(t._y1-t._y0)/e-n)/2:n}function hE(t,n,e){var r=t._x0,i=t._y0,o=t._x1,a=t._y1,u=(o-r)/3;t._context.bezierCurveTo(r+u,i+u*n,o-u,a-u*e,o,a)}function dE(t){this._context=t}function pE(t){this._context=new yE(t)}function yE(t){this._context=t}function gE(t){return new dE(t)}function vE(t){return new pE(t)}function mE(t){this._context=t}function bE(t){var n,e,r=t.length-1,i=new Array(r),o=new Array(r),a=new Array(r);for(i[0]=0,o[0]=2,a[0]=t[0]+2*t[1],n=1;n<r-1;++n)i[n]=1,o[n]=4,a[n]=4*t[n]+2*t[n+1];for(i[r-1]=2,o[r-1]=7,a[r-1]=8*t[r-1]+t[r],n=1;n<r;++n)e=i[n]/o[n-1],o[n]-=e,a[n]-=e*a[n-1];for(i[r-1]=a[r-1]/o[r-1],n=r-2;n>=0;--n)i[n]=(a[n]-i[n+1])/o[n];for(o[r-1]=(t[r]+i[r-1])/2,n=0;n<r-1;++n)o[n]=2*t[n+1]-i[n+1];return[i,o]}function xE(t){return new mE(t)}function _E(t,n){this._context=t,this._t=n}function wE(t){return new _E(t,.5)}function AE(t){return new _E(t,0)}function SE(t){return new _E(t,1)}function ME(t,n){if((i=t.length)>1)for(var e,r,i,o=1,a=t[n[0]],u=a.length;o<i;++o)for(r=a,a=t[n[o]],e=0;e<u;++e)a[e][1]+=a[e][0]=isNaN(r[e][1])?r[e][0]:r[e][1]}function TE(t){for(var n=t.length,e=new Array(n);--n>=0;)e[n]=n;return e}function EE(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return CE(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return CE(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function CE(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function kE(t,n){return t[n]}function NE(t){var n=[];return n.key=t,n}function OE(){var t=mM([]),n=TE,e=ME,r=kE;function i(i){var o,a,u,c=Array.from(t.apply(this,arguments),NE),s=c.length,f=-1,l=EE(i);try{for(l.s();!(u=l.n()).done;){var h=u.value;for(o=0,++f;o<s;++o)(c[o][f]=[0,+r(h,c[o].key,f,i)]).data=h}}catch(t){l.e(t)}finally{l.f()}for(o=0,a=FM(n(c));o<s;++o)c[a[o]].index=o;return e(c,a),c}return i.keys=function(n){return arguments.length?(t="function"==typeof n?n:mM(Array.from(n)),i):t},i.value=function(t){return arguments.length?(r="function"==typeof t?t:mM(+t),i):r},i.order=function(t){return arguments.length?(n=null==t?TE:"function"==typeof t?t:mM(Array.from(t)),i):n},i.offset=function(t){return arguments.length?(e=null==t?ME:t,i):e},i}function PE(t,n){if((r=t.length)>0){for(var e,r,i,o=0,a=t[0].length;o<a;++o){for(i=e=0;e<r;++e)i+=t[e][o][1]||0;if(i)for(e=0;e<r;++e)t[e][o][1]/=i}ME(t,n)}}function IE(t,n){if((u=t.length)>0)for(var e,r,i,o,a,u,c=0,s=t[n[0]].length;c<s;++c)for(o=a=0,e=0;e<u;++e)(i=(r=t[n[e]][c])[1]-r[0])>0?(r[0]=o,r[1]=o+=i):i<0?(r[1]=a,r[0]=a+=i):(r[0]=0,r[1]=i)}function RE(t,n){if((e=t.length)>0){for(var e,r=0,i=t[n[0]],o=i.length;r<o;++r){for(var a=0,u=0;a<e;++a)u+=t[a][r][1]||0;i[r][1]+=i[r][0]=-u/2}ME(t,n)}}function zE(t,n){if((i=t.length)>0&&(r=(e=t[n[0]]).length)>0){for(var e,r,i,o=0,a=1;a<r;++a){for(var u=0,c=0,s=0;u<i;++u){for(var f=t[n[u]],l=f[a][1]||0,h=(l-(f[a-1][1]||0))/2,d=0;d<u;++d){var p=t[n[d]];h+=(p[a][1]||0)-(p[a-1][1]||0)}c+=l,s+=h*l}e[a-1][1]+=e[a-1][0]=o,c&&(o-=s/c)}e[a-1][1]+=e[a-1][0]=o,ME(t,n)}}function VE(t){var n=t.map(DE);return TE(t).sort((function(t,e){return n[t]-n[e]}))}function DE(t){for(var n,e=-1,r=0,i=t.length,o=-1/0;++e<i;)(n=+t[e][1])>o&&(o=n,r=e);return r}function jE(t){var n=t.map(LE);return TE(t).sort((function(t,e){return n[t]-n[e]}))}function LE(t){for(var n,e=0,r=-1,i=t.length;++r<i;)(n=+t[r][1])&&(e+=n);return e}function UE(t){return jE(t).reverse()}function BE(t){var n,e,r=t.length,i=t.map(LE),o=VE(t),a=0,u=0,c=[],s=[];for(n=0;n<r;++n)e=o[n],a<u?(a+=i[e],c.push(e)):(u+=i[e],s.push(e));return s.reverse().concat(c)}function FE(t){return TE(t).reverse()}uE.prototype={areaStart:IT,areaEnd:IT,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,n){t=+t,n=+n,this._point?this._context.lineTo(t,n):(this._point=1,this._context.moveTo(t,n))}},dE.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:hE(this,this._t0,lE(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){var e=NaN;if(n=+n,(t=+t)!==this._x1||n!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2;break;case 2:this._point=3,hE(this,lE(this,e=fE(this,t,n)),e);break;default:hE(this,this._t0,e=fE(this,t,n))}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=n,this._t0=e}}},(pE.prototype=Object.create(dE.prototype)).point=function(t,n){dE.prototype.point.call(this,n,t)},yE.prototype={moveTo:function(t,n){this._context.moveTo(n,t)},closePath:function(){this._context.closePath()},lineTo:function(t,n){this._context.lineTo(n,t)},bezierCurveTo:function(t,n,e,r,i,o){this._context.bezierCurveTo(n,t,r,e,o,i)}},mE.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,n=this._y,e=t.length;if(e)if(this._line?this._context.lineTo(t[0],n[0]):this._context.moveTo(t[0],n[0]),2===e)this._context.lineTo(t[1],n[1]);else for(var r=bE(t),i=bE(n),o=0,a=1;a<e;++o,++a)this._context.bezierCurveTo(r[0][o],i[0][o],r[1][o],i[1][o],t[a],n[a]);(this._line||0!==this._line&&1===e)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,n){this._x.push(+t),this._y.push(+n)}},_E.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,n),this._context.lineTo(t,n);else{var e=this._x*(1-this._t)+t*this._t;this._context.lineTo(e,this._y),this._context.lineTo(e,n)}}this._x=t,this._y=n}};var qE="%Y-%m-%dT%H:%M:%S.%LZ";var HE=Date.prototype.toISOString?function(t){return t.toISOString()}:$_(qE);var YE=+new Date("2000-01-01T00:00:00.000Z")?function(t){var n=new Date(t);return isNaN(n)?null:n}:W_(qE);function XE(t,n,e){var r=new Ho,i=n;return null==n?(r.restart(t,n,e),r):(r._restart=r.restart,r.restart=function(t,n,e){n=+n,e=null==e?Fo():+e,r._restart((function o(a){a+=i,r._restart(o,i+=n,e),t(a)}),n,e)},r.restart(t,n,e),r)}var $E=function(t){return function(){return t}};function WE(t,n){var e=n.sourceEvent,r=n.target,i=n.transform,o=n.dispatch;Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},transform:{value:i,enumerable:!0,configurable:!0},_:{value:o}})}function GE(t,n,e){this.k=t,this.x=n,this.y=e}GE.prototype={constructor:GE,scale:function(t){return 1===t?this:new GE(this.k*t,this.x,this.y)},translate:function(t,n){return 0===t&0===n?this:new GE(this.k,this.x+this.k*t,this.y+this.k*n)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var QE=new GE(1,0,0);function ZE(t){for(;!t.__zoom;)if(!(t=t.parentNode))return QE;return t.__zoom}function KE(t){t.stopImmediatePropagation()}function JE(t){t.preventDefault(),t.stopImmediatePropagation()}function tC(t){return!(t.ctrlKey&&"wheel"!==t.type||t.button)}function nC(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t).hasAttribute("viewBox")?[[(t=t.viewBox.baseVal).x,t.y],[t.x+t.width,t.y+t.height]]:[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]:[[0,0],[t.clientWidth,t.clientHeight]]}function eC(){return this.__zoom||QE}function rC(t){return-t.deltaY*(1===t.deltaMode?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function iC(){return navigator.maxTouchPoints||"ontouchstart"in this}function oC(t,n,e){var r=t.invertX(n[0][0])-e[0][0],i=t.invertX(n[1][0])-e[1][0],o=t.invertY(n[0][1])-e[0][1],a=t.invertY(n[1][1])-e[1][1];return t.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),a>o?(o+a)/2:Math.min(0,o)||Math.max(0,a))}function aC(){var t,n,e,r=tC,i=nC,o=oC,a=rC,u=iC,c=[0,1/0],s=[[-1/0,-1/0],[1/0,1/0]],f=250,l=_m,h=Ze("start","zoom","end"),d=500,p=0,y=10;function g(t){t.property("__zoom",eC).on("wheel.zoom",A,{passive:!1}).on("mousedown.zoom",S).on("dblclick.zoom",M).filter(u).on("touchstart.zoom",T).on("touchmove.zoom",E).on("touchend.zoom touchcancel.zoom",C).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function v(t,n){return(n=Math.max(c[0],Math.min(c[1],n)))===t.k?t:new GE(n,t.x,t.y)}function m(t,n,e){var r=n[0]-e[0]*t.k,i=n[1]-e[1]*t.k;return r===t.x&&i===t.y?t:new GE(t.k,r,i)}function b(t){return[(+t[0][0]+ +t[1][0])/2,(+t[0][1]+ +t[1][1])/2]}function x(t,n,e,r){t.on("start.zoom",(function(){_(this,arguments).event(r).start()})).on("interrupt.zoom end.zoom",(function(){_(this,arguments).event(r).end()})).tween("zoom",(function(){var t=this,o=arguments,a=_(t,o).event(r),u=i.apply(t,o),c=null==e?b(u):"function"==typeof e?e.apply(t,o):e,s=Math.max(u[1][0]-u[0][0],u[1][1]-u[0][1]),f=t.__zoom,h="function"==typeof n?n.apply(t,o):n,d=l(f.invert(c).concat(s/f.k),h.invert(c).concat(s/h.k));return function(t){if(1===t)t=h;else{var n=d(t),e=s/n[2];t=new GE(e,c[0]-n[0]*e,c[1]-n[1]*e)}a.zoom(null,t)}}))}function _(t,n,e){return!e&&t.__zooming||new w(t,n)}function w(t,n){this.that=t,this.args=n,this.active=0,this.sourceEvent=null,this.extent=i.apply(t,n),this.taps=0}function A(t){for(var n=arguments.length,e=new Array(n>1?n-1:0),i=1;i<n;i++)e[i-1]=arguments[i];if(r.apply(this,arguments)){var u=_(this,e).event(t),f=this.__zoom,l=Math.max(c[0],Math.min(c[1],f.k*Math.pow(2,a.apply(this,arguments)))),h=No(t);if(u.wheel)u.mouse[0][0]===h[0]&&u.mouse[0][1]===h[1]||(u.mouse[1]=f.invert(u.mouse[0]=h)),clearTimeout(u.wheel);else{if(f.k===l)return;u.mouse=[h,f.invert(h)],ra(this),u.start()}JE(t),u.wheel=setTimeout(d,150),u.zoom("mouse",o(m(v(f,l),u.mouse[0],u.mouse[1]),u.extent,s))}function d(){u.wheel=null,u.end()}}function S(t){for(var n=arguments.length,i=new Array(n>1?n-1:0),a=1;a<n;a++)i[a-1]=arguments[a];if(!e&&r.apply(this,arguments)){var u=t.currentTarget,c=_(this,i,!0).event(t),f=mi(t.view).on("mousemove.zoom",y,!0).on("mouseup.zoom",g,!0),l=No(t,u),h=t.clientX,d=t.clientY;Ai(t.view),KE(t),c.mouse=[l,this.__zoom.invert(l)],ra(this),c.start()}function y(t){if(JE(t),!c.moved){var n=t.clientX-h,e=t.clientY-d;c.moved=n*n+e*e>p}c.event(t).zoom("mouse",o(m(c.that.__zoom,c.mouse[0]=No(t,u),c.mouse[1]),c.extent,s))}function g(t){f.on("mousemove.zoom mouseup.zoom",null),Si(t.view,c.moved),JE(t),c.event(t).end()}}function M(t){for(var n=arguments.length,e=new Array(n>1?n-1:0),a=1;a<n;a++)e[a-1]=arguments[a];if(r.apply(this,arguments)){var u=this.__zoom,c=No(t.changedTouches?t.changedTouches[0]:t,this),l=u.invert(c),h=u.k*(t.shiftKey?.5:2),d=o(m(v(u,h),c,l),i.apply(this,e),s);JE(t),f>0?mi(this).transition().duration(f).call(x,d,c,t):mi(this).call(g.transform,d,c,t)}}function T(e){for(var i=arguments.length,o=new Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];if(r.apply(this,arguments)){var u,c,s,f,l=e.touches,h=l.length,p=_(this,o,e.changedTouches.length===h).event(e);for(KE(e),c=0;c<h;++c)f=[f=No(s=l[c],this),this.__zoom.invert(f),s.identifier],p.touch0?p.touch1||p.touch0[2]===f[2]||(p.touch1=f,p.taps=0):(p.touch0=f,u=!0,p.taps=1+!!t);t&&(t=clearTimeout(t)),u&&(p.taps<2&&(n=f[0],t=setTimeout((function(){t=null}),d)),ra(this),p.start())}}function E(t){if(this.__zooming){for(var n=arguments.length,e=new Array(n>1?n-1:0),r=1;r<n;r++)e[r-1]=arguments[r];var i,a,u,c,f=_(this,e).event(t),l=t.changedTouches,h=l.length;for(JE(t),i=0;i<h;++i)u=No(a=l[i],this),f.touch0&&f.touch0[2]===a.identifier?f.touch0[0]=u:f.touch1&&f.touch1[2]===a.identifier&&(f.touch1[0]=u);if(a=f.that.__zoom,f.touch1){var d=f.touch0[0],p=f.touch0[1],y=f.touch1[0],g=f.touch1[1],b=(b=y[0]-d[0])*b+(b=y[1]-d[1])*b,x=(x=g[0]-p[0])*x+(x=g[1]-p[1])*x;a=v(a,Math.sqrt(b/x)),u=[(d[0]+y[0])/2,(d[1]+y[1])/2],c=[(p[0]+g[0])/2,(p[1]+g[1])/2]}else{if(!f.touch0)return;u=f.touch0[0],c=f.touch0[1]}f.zoom("touch",o(m(a,u,c),f.extent,s))}}function C(t){for(var r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];if(this.__zooming){var a,u,c=_(this,i).event(t),s=t.changedTouches,f=s.length;for(KE(t),e&&clearTimeout(e),e=setTimeout((function(){e=null}),d),a=0;a<f;++a)u=s[a],c.touch0&&c.touch0[2]===u.identifier?delete c.touch0:c.touch1&&c.touch1[2]===u.identifier&&delete c.touch1;if(c.touch1&&!c.touch0&&(c.touch0=c.touch1,delete c.touch1),c.touch0)c.touch0[1]=this.__zoom.invert(c.touch0[0]);else if(c.end(),2===c.taps&&(u=No(u,this),Math.hypot(n[0]-u[0],n[1]-u[1])<y)){var l=mi(this).on("dblclick.zoom");l&&l.apply(this,arguments)}}}return g.transform=function(t,n,e,r){var i=t.selection?t.selection():t;i.property("__zoom",eC),t!==i?x(t,n,e,r):i.interrupt().each((function(){_(this,arguments).event(r).start().zoom(null,"function"==typeof n?n.apply(this,arguments):n).end()}))},g.scaleBy=function(t,n,e,r){g.scaleTo(t,(function(){var t=this.__zoom.k,e="function"==typeof n?n.apply(this,arguments):n;return t*e}),e,r)},g.scaleTo=function(t,n,e,r){g.transform(t,(function(){var t=i.apply(this,arguments),r=this.__zoom,a=null==e?b(t):"function"==typeof e?e.apply(this,arguments):e,u=r.invert(a),c="function"==typeof n?n.apply(this,arguments):n;return o(m(v(r,c),a,u),t,s)}),e,r)},g.translateBy=function(t,n,e,r){g.transform(t,(function(){return o(this.__zoom.translate("function"==typeof n?n.apply(this,arguments):n,"function"==typeof e?e.apply(this,arguments):e),i.apply(this,arguments),s)}),null,r)},g.translateTo=function(t,n,e,r,a){g.transform(t,(function(){var t=i.apply(this,arguments),a=this.__zoom,u=null==r?b(t):"function"==typeof r?r.apply(this,arguments):r;return o(QE.translate(u[0],u[1]).scale(a.k).translate("function"==typeof n?-n.apply(this,arguments):-n,"function"==typeof e?-e.apply(this,arguments):-e),t,s)}),r,a)},w.prototype={event:function(t){return t&&(this.sourceEvent=t),this},start:function(){return 1==++this.active&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(t,n){return this.mouse&&"mouse"!==t&&(this.mouse[1]=n.invert(this.mouse[0])),this.touch0&&"touch"!==t&&(this.touch0[1]=n.invert(this.touch0[0])),this.touch1&&"touch"!==t&&(this.touch1[1]=n.invert(this.touch1[0])),this.that.__zoom=n,this.emit("zoom"),this},end:function(){return 0==--this.active&&(delete this.that.__zooming,this.emit("end")),this},emit:function(t){var n=mi(this.that).datum();h.call(t,this.that,new WE(t,{sourceEvent:this.sourceEvent,target:g,type:t,transform:this.that.__zoom,dispatch:h}),n)}},g.wheelDelta=function(t){return arguments.length?(a="function"==typeof t?t:$E(+t),g):a},g.filter=function(t){return arguments.length?(r="function"==typeof t?t:$E(!!t),g):r},g.touchable=function(t){return arguments.length?(u="function"==typeof t?t:$E(!!t),g):u},g.extent=function(t){return arguments.length?(i="function"==typeof t?t:$E([[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]]),g):i},g.scaleExtent=function(t){return arguments.length?(c[0]=+t[0],c[1]=+t[1],g):[c[0],c[1]]},g.translateExtent=function(t){return arguments.length?(s[0][0]=+t[0][0],s[1][0]=+t[1][0],s[0][1]=+t[0][1],s[1][1]=+t[1][1],g):[[s[0][0],s[0][1]],[s[1][0],s[1][1]]]},g.constrain=function(t){return arguments.length?(o=t,g):o},g.duration=function(t){return arguments.length?(f=+t,g):f},g.interpolate=function(t){return arguments.length?(l=t,g):l},g.on=function(){var t=h.on.apply(h,arguments);return t===h?g:t},g.clickDistance=function(t){return arguments.length?(p=(t=+t)*t,g):Math.sqrt(p)},g.tapDistance=function(t){return arguments.length?(y=+t,g):y},g}ZE.prototype=GE.prototype},5214:function(t,n,e){"use strict";e.r(n),e.d(n,{AElement:function(){return sn},AnimateColorElement:function(){return nn},AnimateElement:function(){return tn},AnimateTransformElement:function(){return en},BoundingBox:function(){return Pt},CB1:function(){return tt},CB2:function(){return nt},CB3:function(){return et},CB4:function(){return rt},Canvg:function(){return Rn},CircleElement:function(){return Bt},ClipPathElement:function(){return Sn},DefsElement:function(){return Wt},DescElement:function(){return On},Document:function(){return In},Element:function(){return Tt},EllipseElement:function(){return Ft},FeColorMatrixElement:function(){return _n},FeCompositeElement:function(){return Cn},FeDropShadowElement:function(){return Tn},FeGaussianBlurElement:function(){return kn},FeMorphologyElement:function(){return En},FilterElement:function(){return Mn},Font:function(){return Ot},FontElement:function(){return un},FontFaceElement:function(){return rn},GElement:function(){return Gt},GlyphElement:function(){return on},GradientElement:function(){return Qt},ImageElement:function(){return hn},LineElement:function(){return qt},LinearGradientElement:function(){return Zt},MarkerElement:function(){return $t},MaskElement:function(){return wn},Matrix:function(){return _t},MissingGlyphElement:function(){return an},Mouse:function(){return lt},PSEUDO_ZERO:function(){return Q},Parser:function(){return vt},PathElement:function(){return jt},PathParser:function(){return Dt},PatternElement:function(){return Xt},Point:function(){return ft},PolygonElement:function(){return Yt},PolylineElement:function(){return Ht},Property:function(){return ut},QB1:function(){return it},QB2:function(){return ot},QB3:function(){return at},RadialGradientElement:function(){return Kt},RectElement:function(){return Ut},RenderedElement:function(){return It},Rotate:function(){return bt},SVGElement:function(){return Lt},SVGFontLoader:function(){return pn},Scale:function(){return xt},Screen:function(){return pt},Skew:function(){return wt},SkewX:function(){return At},SkewY:function(){return St},StopElement:function(){return Jt},StyleElement:function(){return yn},SymbolElement:function(){return dn},TRefElement:function(){return cn},TSpanElement:function(){return zt},TextElement:function(){return Rt},TextPathElement:function(){return fn},TitleElement:function(){return Nn},Transform:function(){return Mt},Translate:function(){return mt},UnknownElement:function(){return Et},UseElement:function(){return gn},ViewPort:function(){return ct},compressSpaces:function(){return P},elements:function(){return Pn},getSelectorSpecificity:function(){return G},normalizeAttributeName:function(){return j},normalizeColor:function(){return U},parseExternalUrl:function(){return L},presets:function(){return O},toMatrixValue:function(){return V},toNumbers:function(){return z},trimLeft:function(){return I},trimRight:function(){return R},vectorMagnitude:function(){return Z},vectorsAngle:function(){return J},vectorsRatio:function(){return K}});var r=e(8729),i=e(1091),o=function(t,n){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(t,n)};function a(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}o(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}function u(t,n){var e=t[0],r=t[1];return[e*Math.cos(n)-r*Math.sin(n),e*Math.sin(n)+r*Math.cos(n)]}function c(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var e=0;e<t.length;e++)if("number"!=typeof t[e])throw new Error("assertNumbers arguments["+e+"] is not a number. "+typeof t[e]+" == typeof "+t[e]);return!0}var s=Math.PI;function f(t,n,e){t.lArcFlag=0===t.lArcFlag?0:1,t.sweepFlag=0===t.sweepFlag?0:1;var r=t.rX,i=t.rY,o=t.x,a=t.y;r=Math.abs(t.rX),i=Math.abs(t.rY);var c=u([(n-o)/2,(e-a)/2],-t.xRot/180*s),f=c[0],l=c[1],h=Math.pow(f,2)/Math.pow(r,2)+Math.pow(l,2)/Math.pow(i,2);1<h&&(r*=Math.sqrt(h),i*=Math.sqrt(h)),t.rX=r,t.rY=i;var d=Math.pow(r,2)*Math.pow(l,2)+Math.pow(i,2)*Math.pow(f,2),p=(t.lArcFlag!==t.sweepFlag?1:-1)*Math.sqrt(Math.max(0,(Math.pow(r,2)*Math.pow(i,2)-d)/d)),y=r*l/i*p,g=-i*f/r*p,v=u([y,g],t.xRot/180*s);t.cX=v[0]+(n+o)/2,t.cY=v[1]+(e+a)/2,t.phi1=Math.atan2((l-g)/i,(f-y)/r),t.phi2=Math.atan2((-l-g)/i,(-f-y)/r),0===t.sweepFlag&&t.phi2>t.phi1&&(t.phi2-=2*s),1===t.sweepFlag&&t.phi2<t.phi1&&(t.phi2+=2*s),t.phi1*=180/s,t.phi2*=180/s}function l(t,n,e){c(t,n,e);var r=t*t+n*n-e*e;if(0>r)return[];if(0===r)return[[t*e/(t*t+n*n),n*e/(t*t+n*n)]];var i=Math.sqrt(r);return[[(t*e+n*i)/(t*t+n*n),(n*e-t*i)/(t*t+n*n)],[(t*e-n*i)/(t*t+n*n),(n*e+t*i)/(t*t+n*n)]]}var h,d=Math.PI/180;function p(t,n,e){return(1-e)*t+e*n}function y(t,n,e,r){return t+Math.cos(r/180*s)*n+Math.sin(r/180*s)*e}function g(t,n,e,r){var i=1e-6,o=n-t,a=e-n,u=3*o+3*(r-e)-6*a,c=6*(a-o),s=3*o;return Math.abs(u)<i?[-s/c]:function(t,n,e){void 0===e&&(e=1e-6);var r=t*t/4-n;if(r<-e)return[];if(r<=e)return[-t/2];var i=Math.sqrt(r);return[-t/2-i,-t/2+i]}(c/u,s/u,i)}function v(t,n,e,r,i){var o=1-i;return t*(o*o*o)+n*(3*o*o*i)+e*(3*o*i*i)+r*(i*i*i)}!function(t){function n(){return i((function(t,n,e){return t.relative&&(void 0!==t.x1&&(t.x1+=n),void 0!==t.y1&&(t.y1+=e),void 0!==t.x2&&(t.x2+=n),void 0!==t.y2&&(t.y2+=e),void 0!==t.x&&(t.x+=n),void 0!==t.y&&(t.y+=e),t.relative=!1),t}))}function e(){var t=NaN,n=NaN,e=NaN,r=NaN;return i((function(i,o,a){return i.type&A.SMOOTH_CURVE_TO&&(i.type=A.CURVE_TO,t=isNaN(t)?o:t,n=isNaN(n)?a:n,i.x1=i.relative?o-t:2*o-t,i.y1=i.relative?a-n:2*a-n),i.type&A.CURVE_TO?(t=i.relative?o+i.x2:i.x2,n=i.relative?a+i.y2:i.y2):(t=NaN,n=NaN),i.type&A.SMOOTH_QUAD_TO&&(i.type=A.QUAD_TO,e=isNaN(e)?o:e,r=isNaN(r)?a:r,i.x1=i.relative?o-e:2*o-e,i.y1=i.relative?a-r:2*a-r),i.type&A.QUAD_TO?(e=i.relative?o+i.x1:i.x1,r=i.relative?a+i.y1:i.y1):(e=NaN,r=NaN),i}))}function r(){var t=NaN,n=NaN;return i((function(e,r,i){if(e.type&A.SMOOTH_QUAD_TO&&(e.type=A.QUAD_TO,t=isNaN(t)?r:t,n=isNaN(n)?i:n,e.x1=e.relative?r-t:2*r-t,e.y1=e.relative?i-n:2*i-n),e.type&A.QUAD_TO){t=e.relative?r+e.x1:e.x1,n=e.relative?i+e.y1:e.y1;var o=e.x1,a=e.y1;e.type=A.CURVE_TO,e.x1=((e.relative?0:r)+2*o)/3,e.y1=((e.relative?0:i)+2*a)/3,e.x2=(e.x+2*o)/3,e.y2=(e.y+2*a)/3}else t=NaN,n=NaN;return e}))}function i(t){var n=0,e=0,r=NaN,i=NaN;return function(o){if(isNaN(r)&&!(o.type&A.MOVE_TO))throw new Error("path must start with moveto");var a=t(o,n,e,r,i);return o.type&A.CLOSE_PATH&&(n=r,e=i),void 0!==o.x&&(n=o.relative?n+o.x:o.x),void 0!==o.y&&(e=o.relative?e+o.y:o.y),o.type&A.MOVE_TO&&(r=n,i=e),a}}function o(t,n,e,r,o,a){return c(t,n,e,r,o,a),i((function(i,u,c,s){var f=i.x1,l=i.x2,h=i.relative&&!isNaN(s),d=void 0!==i.x?i.x:h?0:u,p=void 0!==i.y?i.y:h?0:c;function y(t){return t*t}i.type&A.HORIZ_LINE_TO&&0!==n&&(i.type=A.LINE_TO,i.y=i.relative?0:c),i.type&A.VERT_LINE_TO&&0!==e&&(i.type=A.LINE_TO,i.x=i.relative?0:u),void 0!==i.x&&(i.x=i.x*t+p*e+(h?0:o)),void 0!==i.y&&(i.y=d*n+i.y*r+(h?0:a)),void 0!==i.x1&&(i.x1=i.x1*t+i.y1*e+(h?0:o)),void 0!==i.y1&&(i.y1=f*n+i.y1*r+(h?0:a)),void 0!==i.x2&&(i.x2=i.x2*t+i.y2*e+(h?0:o)),void 0!==i.y2&&(i.y2=l*n+i.y2*r+(h?0:a));var g=t*r-n*e;if(void 0!==i.xRot&&(1!==t||0!==n||0!==e||1!==r))if(0===g)delete i.rX,delete i.rY,delete i.xRot,delete i.lArcFlag,delete i.sweepFlag,i.type=A.LINE_TO;else{var v=i.xRot*Math.PI/180,m=Math.sin(v),b=Math.cos(v),x=1/y(i.rX),_=1/y(i.rY),w=y(b)*x+y(m)*_,S=2*m*b*(x-_),M=y(m)*x+y(b)*_,T=w*r*r-S*n*r+M*n*n,E=S*(t*r+n*e)-2*(w*e*r+M*t*n),C=w*e*e-S*t*e+M*t*t,k=(Math.atan2(E,T-C)+Math.PI)%Math.PI/2,N=Math.sin(k),O=Math.cos(k);i.rX=Math.abs(g)/Math.sqrt(T*y(O)+E*N*O+C*y(N)),i.rY=Math.abs(g)/Math.sqrt(T*y(N)-E*N*O+C*y(O)),i.xRot=180*k/Math.PI}return void 0!==i.sweepFlag&&0>g&&(i.sweepFlag=+!i.sweepFlag),i}))}t.ROUND=function(t){function n(n){return Math.round(n*t)/t}return void 0===t&&(t=1e13),c(t),function(t){return void 0!==t.x1&&(t.x1=n(t.x1)),void 0!==t.y1&&(t.y1=n(t.y1)),void 0!==t.x2&&(t.x2=n(t.x2)),void 0!==t.y2&&(t.y2=n(t.y2)),void 0!==t.x&&(t.x=n(t.x)),void 0!==t.y&&(t.y=n(t.y)),void 0!==t.rX&&(t.rX=n(t.rX)),void 0!==t.rY&&(t.rY=n(t.rY)),t}},t.TO_ABS=n,t.TO_REL=function(){return i((function(t,n,e){return t.relative||(void 0!==t.x1&&(t.x1-=n),void 0!==t.y1&&(t.y1-=e),void 0!==t.x2&&(t.x2-=n),void 0!==t.y2&&(t.y2-=e),void 0!==t.x&&(t.x-=n),void 0!==t.y&&(t.y-=e),t.relative=!0),t}))},t.NORMALIZE_HVZ=function(t,n,e){return void 0===t&&(t=!0),void 0===n&&(n=!0),void 0===e&&(e=!0),i((function(r,i,o,a,u){if(isNaN(a)&&!(r.type&A.MOVE_TO))throw new Error("path must start with moveto");return n&&r.type&A.HORIZ_LINE_TO&&(r.type=A.LINE_TO,r.y=r.relative?0:o),e&&r.type&A.VERT_LINE_TO&&(r.type=A.LINE_TO,r.x=r.relative?0:i),t&&r.type&A.CLOSE_PATH&&(r.type=A.LINE_TO,r.x=r.relative?a-i:a,r.y=r.relative?u-o:u),r.type&A.ARC&&(0===r.rX||0===r.rY)&&(r.type=A.LINE_TO,delete r.rX,delete r.rY,delete r.xRot,delete r.lArcFlag,delete r.sweepFlag),r}))},t.NORMALIZE_ST=e,t.QT_TO_C=r,t.INFO=i,t.SANITIZE=function(t){void 0===t&&(t=0),c(t);var n=NaN,e=NaN,r=NaN,o=NaN;return i((function(i,a,u,c,s){var f=Math.abs,l=!1,h=0,d=0;if(i.type&A.SMOOTH_CURVE_TO&&(h=isNaN(n)?0:a-n,d=isNaN(e)?0:u-e),i.type&(A.CURVE_TO|A.SMOOTH_CURVE_TO)?(n=i.relative?a+i.x2:i.x2,e=i.relative?u+i.y2:i.y2):(n=NaN,e=NaN),i.type&A.SMOOTH_QUAD_TO?(r=isNaN(r)?a:2*a-r,o=isNaN(o)?u:2*u-o):i.type&A.QUAD_TO?(r=i.relative?a+i.x1:i.x1,o=i.relative?u+i.y1:i.y2):(r=NaN,o=NaN),i.type&A.LINE_COMMANDS||i.type&A.ARC&&(0===i.rX||0===i.rY||!i.lArcFlag)||i.type&A.CURVE_TO||i.type&A.SMOOTH_CURVE_TO||i.type&A.QUAD_TO||i.type&A.SMOOTH_QUAD_TO){var p=void 0===i.x?0:i.relative?i.x:i.x-a,y=void 0===i.y?0:i.relative?i.y:i.y-u;h=isNaN(r)?void 0===i.x1?h:i.relative?i.x:i.x1-a:r-a,d=isNaN(o)?void 0===i.y1?d:i.relative?i.y:i.y1-u:o-u;var g=void 0===i.x2?0:i.relative?i.x:i.x2-a,v=void 0===i.y2?0:i.relative?i.y:i.y2-u;f(p)<=t&&f(y)<=t&&f(h)<=t&&f(d)<=t&&f(g)<=t&&f(v)<=t&&(l=!0)}return i.type&A.CLOSE_PATH&&f(a-c)<=t&&f(u-s)<=t&&(l=!0),l?[]:i}))},t.MATRIX=o,t.ROTATE=function(t,n,e){void 0===n&&(n=0),void 0===e&&(e=0),c(t,n,e);var r=Math.sin(t),i=Math.cos(t);return o(i,r,-r,i,n-n*i+e*r,e-n*r-e*i)},t.TRANSLATE=function(t,n){return void 0===n&&(n=0),c(t,n),o(1,0,0,1,t,n)},t.SCALE=function(t,n){return void 0===n&&(n=t),c(t,n),o(t,0,0,n,0,0)},t.SKEW_X=function(t){return c(t),o(1,0,Math.atan(t),1,0,0)},t.SKEW_Y=function(t){return c(t),o(1,Math.atan(t),0,1,0,0)},t.X_AXIS_SYMMETRY=function(t){return void 0===t&&(t=0),c(t),o(-1,0,0,1,t,0)},t.Y_AXIS_SYMMETRY=function(t){return void 0===t&&(t=0),c(t),o(1,0,0,-1,0,t)},t.A_TO_C=function(){return i((function(t,n,e){return A.ARC===t.type?function(t,n,e){var r,i,o,a;t.cX||f(t,n,e);for(var c=Math.min(t.phi1,t.phi2),s=Math.max(t.phi1,t.phi2)-c,l=Math.ceil(s/90),h=new Array(l),y=n,g=e,v=0;v<l;v++){var m=p(t.phi1,t.phi2,v/l),b=p(t.phi1,t.phi2,(v+1)/l),x=b-m,_=4/3*Math.tan(x*d/4),w=[Math.cos(m*d)-_*Math.sin(m*d),Math.sin(m*d)+_*Math.cos(m*d)],S=w[0],M=w[1],T=[Math.cos(b*d),Math.sin(b*d)],E=T[0],C=T[1],k=[E+_*Math.sin(b*d),C-_*Math.cos(b*d)],N=k[0],O=k[1];h[v]={relative:t.relative,type:A.CURVE_TO};var P=function(n,e){var r=u([n*t.rX,e*t.rY],t.xRot),i=r[0],o=r[1];return[t.cX+i,t.cY+o]};r=P(S,M),h[v].x1=r[0],h[v].y1=r[1],i=P(N,O),h[v].x2=i[0],h[v].y2=i[1],o=P(E,C),h[v].x=o[0],h[v].y=o[1],t.relative&&(h[v].x1-=y,h[v].y1-=g,h[v].x2-=y,h[v].y2-=g,h[v].x-=y,h[v].y-=g),y=(a=[h[v].x,h[v].y])[0],g=a[1]}return h}(t,t.relative?0:n,t.relative?0:e):t}))},t.ANNOTATE_ARCS=function(){return i((function(t,n,e){return t.relative&&(n=0,e=0),A.ARC===t.type&&f(t,n,e),t}))},t.CLONE=function(){return function(t){var n={};for(var e in t)n[e]=t[e];return n}},t.CALCULATE_BOUNDS=function(){var t=n(),o=r(),a=e(),u=i((function(n,e,r){var i=a(o(t(function(t){var n={};for(var e in t)n[e]=t[e];return n}(n))));function c(t){t>u.maxX&&(u.maxX=t),t<u.minX&&(u.minX=t)}function s(t){t>u.maxY&&(u.maxY=t),t<u.minY&&(u.minY=t)}if(i.type&A.DRAWING_COMMANDS&&(c(e),s(r)),i.type&A.HORIZ_LINE_TO&&c(i.x),i.type&A.VERT_LINE_TO&&s(i.y),i.type&A.LINE_TO&&(c(i.x),s(i.y)),i.type&A.CURVE_TO){c(i.x),s(i.y);for(var h=0,d=g(e,i.x1,i.x2,i.x);h<d.length;h++)0<(I=d[h])&&1>I&&c(v(e,i.x1,i.x2,i.x,I));for(var p=0,m=g(r,i.y1,i.y2,i.y);p<m.length;p++)0<(I=m[p])&&1>I&&s(v(r,i.y1,i.y2,i.y,I))}if(i.type&A.ARC){c(i.x),s(i.y),f(i,e,r);for(var b=i.xRot/180*Math.PI,x=Math.cos(b)*i.rX,_=Math.sin(b)*i.rX,w=-Math.sin(b)*i.rY,S=Math.cos(b)*i.rY,M=i.phi1<i.phi2?[i.phi1,i.phi2]:-180>i.phi2?[i.phi2+360,i.phi1+360]:[i.phi2,i.phi1],T=M[0],E=M[1],C=function(t){var n=t[0],e=t[1],r=180*Math.atan2(e,n)/Math.PI;return r<T?r+360:r},k=0,N=l(w,-x,0).map(C);k<N.length;k++)(I=N[k])>T&&I<E&&c(y(i.cX,x,w,I));for(var O=0,P=l(S,-_,0).map(C);O<P.length;O++){var I;(I=P[O])>T&&I<E&&s(y(i.cY,_,S,I))}}return n}));return u.minX=1/0,u.maxX=-1/0,u.minY=1/0,u.maxY=-1/0,u}}(h||(h={}));var m,b=function(){function t(){}return t.prototype.round=function(t){return this.transform(h.ROUND(t))},t.prototype.toAbs=function(){return this.transform(h.TO_ABS())},t.prototype.toRel=function(){return this.transform(h.TO_REL())},t.prototype.normalizeHVZ=function(t,n,e){return this.transform(h.NORMALIZE_HVZ(t,n,e))},t.prototype.normalizeST=function(){return this.transform(h.NORMALIZE_ST())},t.prototype.qtToC=function(){return this.transform(h.QT_TO_C())},t.prototype.aToC=function(){return this.transform(h.A_TO_C())},t.prototype.sanitize=function(t){return this.transform(h.SANITIZE(t))},t.prototype.translate=function(t,n){return this.transform(h.TRANSLATE(t,n))},t.prototype.scale=function(t,n){return this.transform(h.SCALE(t,n))},t.prototype.rotate=function(t,n,e){return this.transform(h.ROTATE(t,n,e))},t.prototype.matrix=function(t,n,e,r,i,o){return this.transform(h.MATRIX(t,n,e,r,i,o))},t.prototype.skewX=function(t){return this.transform(h.SKEW_X(t))},t.prototype.skewY=function(t){return this.transform(h.SKEW_Y(t))},t.prototype.xSymmetry=function(t){return this.transform(h.X_AXIS_SYMMETRY(t))},t.prototype.ySymmetry=function(t){return this.transform(h.Y_AXIS_SYMMETRY(t))},t.prototype.annotateArcs=function(){return this.transform(h.ANNOTATE_ARCS())},t}(),x=function(t){return" "===t||"\t"===t||"\r"===t||"\n"===t},_=function(t){return"0".charCodeAt(0)<=t.charCodeAt(0)&&t.charCodeAt(0)<="9".charCodeAt(0)},w=function(t){function n(){var n=t.call(this)||this;return n.curNumber="",n.curCommandType=-1,n.curCommandRelative=!1,n.canParseCommandOrComma=!0,n.curNumberHasExp=!1,n.curNumberHasExpDigits=!1,n.curNumberHasDecimal=!1,n.curArgs=[],n}return a(n,t),n.prototype.finish=function(t){if(void 0===t&&(t=[]),this.parse(" ",t),0!==this.curArgs.length||!this.canParseCommandOrComma)throw new SyntaxError("Unterminated command at the path end.");return t},n.prototype.parse=function(t,n){var e=this;void 0===n&&(n=[]);for(var r=function(t){n.push(t),e.curArgs.length=0,e.canParseCommandOrComma=!0},i=0;i<t.length;i++){var o=t[i],a=!(this.curCommandType!==A.ARC||3!==this.curArgs.length&&4!==this.curArgs.length||1!==this.curNumber.length||"0"!==this.curNumber&&"1"!==this.curNumber),u=_(o)&&("0"===this.curNumber&&"0"===o||a);if(!_(o)||u)if("e"!==o&&"E"!==o)if("-"!==o&&"+"!==o||!this.curNumberHasExp||this.curNumberHasExpDigits)if("."!==o||this.curNumberHasExp||this.curNumberHasDecimal||a){if(this.curNumber&&-1!==this.curCommandType){var c=Number(this.curNumber);if(isNaN(c))throw new SyntaxError("Invalid number ending at "+i);if(this.curCommandType===A.ARC)if(0===this.curArgs.length||1===this.curArgs.length){if(0>c)throw new SyntaxError('Expected positive number, got "'+c+'" at index "'+i+'"')}else if((3===this.curArgs.length||4===this.curArgs.length)&&"0"!==this.curNumber&&"1"!==this.curNumber)throw new SyntaxError('Expected a flag, got "'+this.curNumber+'" at index "'+i+'"');this.curArgs.push(c),this.curArgs.length===S[this.curCommandType]&&(A.HORIZ_LINE_TO===this.curCommandType?r({type:A.HORIZ_LINE_TO,relative:this.curCommandRelative,x:c}):A.VERT_LINE_TO===this.curCommandType?r({type:A.VERT_LINE_TO,relative:this.curCommandRelative,y:c}):this.curCommandType===A.MOVE_TO||this.curCommandType===A.LINE_TO||this.curCommandType===A.SMOOTH_QUAD_TO?(r({type:this.curCommandType,relative:this.curCommandRelative,x:this.curArgs[0],y:this.curArgs[1]}),A.MOVE_TO===this.curCommandType&&(this.curCommandType=A.LINE_TO)):this.curCommandType===A.CURVE_TO?r({type:A.CURVE_TO,relative:this.curCommandRelative,x1:this.curArgs[0],y1:this.curArgs[1],x2:this.curArgs[2],y2:this.curArgs[3],x:this.curArgs[4],y:this.curArgs[5]}):this.curCommandType===A.SMOOTH_CURVE_TO?r({type:A.SMOOTH_CURVE_TO,relative:this.curCommandRelative,x2:this.curArgs[0],y2:this.curArgs[1],x:this.curArgs[2],y:this.curArgs[3]}):this.curCommandType===A.QUAD_TO?r({type:A.QUAD_TO,relative:this.curCommandRelative,x1:this.curArgs[0],y1:this.curArgs[1],x:this.curArgs[2],y:this.curArgs[3]}):this.curCommandType===A.ARC&&r({type:A.ARC,relative:this.curCommandRelative,rX:this.curArgs[0],rY:this.curArgs[1],xRot:this.curArgs[2],lArcFlag:this.curArgs[3],sweepFlag:this.curArgs[4],x:this.curArgs[5],y:this.curArgs[6]})),this.curNumber="",this.curNumberHasExpDigits=!1,this.curNumberHasExp=!1,this.curNumberHasDecimal=!1,this.canParseCommandOrComma=!0}if(!x(o))if(","===o&&this.canParseCommandOrComma)this.canParseCommandOrComma=!1;else if("+"!==o&&"-"!==o&&"."!==o)if(u)this.curNumber=o,this.curNumberHasDecimal=!1;else{if(0!==this.curArgs.length)throw new SyntaxError("Unterminated command at index "+i+".");if(!this.canParseCommandOrComma)throw new SyntaxError('Unexpected character "'+o+'" at index '+i+". Command cannot follow comma");if(this.canParseCommandOrComma=!1,"z"!==o&&"Z"!==o)if("h"===o||"H"===o)this.curCommandType=A.HORIZ_LINE_TO,this.curCommandRelative="h"===o;else if("v"===o||"V"===o)this.curCommandType=A.VERT_LINE_TO,this.curCommandRelative="v"===o;else if("m"===o||"M"===o)this.curCommandType=A.MOVE_TO,this.curCommandRelative="m"===o;else if("l"===o||"L"===o)this.curCommandType=A.LINE_TO,this.curCommandRelative="l"===o;else if("c"===o||"C"===o)this.curCommandType=A.CURVE_TO,this.curCommandRelative="c"===o;else if("s"===o||"S"===o)this.curCommandType=A.SMOOTH_CURVE_TO,this.curCommandRelative="s"===o;else if("q"===o||"Q"===o)this.curCommandType=A.QUAD_TO,this.curCommandRelative="q"===o;else if("t"===o||"T"===o)this.curCommandType=A.SMOOTH_QUAD_TO,this.curCommandRelative="t"===o;else{if("a"!==o&&"A"!==o)throw new SyntaxError('Unexpected character "'+o+'" at index '+i+".");this.curCommandType=A.ARC,this.curCommandRelative="a"===o}else n.push({type:A.CLOSE_PATH}),this.canParseCommandOrComma=!0,this.curCommandType=-1}else this.curNumber=o,this.curNumberHasDecimal="."===o}else this.curNumber+=o,this.curNumberHasDecimal=!0;else this.curNumber+=o;else this.curNumber+=o,this.curNumberHasExp=!0;else this.curNumber+=o,this.curNumberHasExpDigits=this.curNumberHasExp}return n},n.prototype.transform=function(t){return Object.create(this,{parse:{value:function(n,e){void 0===e&&(e=[]);for(var r=0,i=Object.getPrototypeOf(this).parse.call(this,n);r<i.length;r++){var o=i[r],a=t(o);Array.isArray(a)?e.push.apply(e,a):e.push(a)}return e}}})},n}(b),A=function(t){function n(e){var r=t.call(this)||this;return r.commands="string"==typeof e?n.parse(e):e,r}return a(n,t),n.prototype.encode=function(){return n.encode(this.commands)},n.prototype.getBounds=function(){var t=h.CALCULATE_BOUNDS();return this.transform(t),t},n.prototype.transform=function(t){for(var n=[],e=0,r=this.commands;e<r.length;e++){var i=t(r[e]);Array.isArray(i)?n.push.apply(n,i):n.push(i)}return this.commands=n,this},n.encode=function(t){return function(t){var n="";Array.isArray(t)||(t=[t]);for(var e=0;e<t.length;e++){var r=t[e];if(r.type===A.CLOSE_PATH)n+="z";else if(r.type===A.HORIZ_LINE_TO)n+=(r.relative?"h":"H")+r.x;else if(r.type===A.VERT_LINE_TO)n+=(r.relative?"v":"V")+r.y;else if(r.type===A.MOVE_TO)n+=(r.relative?"m":"M")+r.x+" "+r.y;else if(r.type===A.LINE_TO)n+=(r.relative?"l":"L")+r.x+" "+r.y;else if(r.type===A.CURVE_TO)n+=(r.relative?"c":"C")+r.x1+" "+r.y1+" "+r.x2+" "+r.y2+" "+r.x+" "+r.y;else if(r.type===A.SMOOTH_CURVE_TO)n+=(r.relative?"s":"S")+r.x2+" "+r.y2+" "+r.x+" "+r.y;else if(r.type===A.QUAD_TO)n+=(r.relative?"q":"Q")+r.x1+" "+r.y1+" "+r.x+" "+r.y;else if(r.type===A.SMOOTH_QUAD_TO)n+=(r.relative?"t":"T")+r.x+" "+r.y;else{if(r.type!==A.ARC)throw new Error('Unexpected command type "'+r.type+'" at index '+e+".");n+=(r.relative?"a":"A")+r.rX+" "+r.rY+" "+r.xRot+" "+ +r.lArcFlag+" "+ +r.sweepFlag+" "+r.x+" "+r.y}}return n}(t)},n.parse=function(t){var n=new w,e=[];return n.parse(t,e),n.finish(e),e},n.CLOSE_PATH=1,n.MOVE_TO=2,n.HORIZ_LINE_TO=4,n.VERT_LINE_TO=8,n.LINE_TO=16,n.CURVE_TO=32,n.SMOOTH_CURVE_TO=64,n.QUAD_TO=128,n.SMOOTH_QUAD_TO=256,n.ARC=512,n.LINE_COMMANDS=n.LINE_TO|n.HORIZ_LINE_TO|n.VERT_LINE_TO,n.DRAWING_COMMANDS=n.HORIZ_LINE_TO|n.VERT_LINE_TO|n.LINE_TO|n.CURVE_TO|n.SMOOTH_CURVE_TO|n.QUAD_TO|n.SMOOTH_QUAD_TO|n.ARC,n}(b),S=((m={})[A.MOVE_TO]=2,m[A.LINE_TO]=2,m[A.HORIZ_LINE_TO]=1,m[A.VERT_LINE_TO]=1,m[A.CLOSE_PATH]=0,m[A.QUAD_TO]=4,m[A.SMOOTH_QUAD_TO]=2,m[A.CURVE_TO]=6,m[A.SMOOTH_CURVE_TO]=4,m[A.ARC]=7,m);function M(t){return(M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var T=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],E=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function C(t,n,e,r,i){if("string"==typeof t&&(t=document.getElementById(t)),!t||"object"!==M(t)||!("getContext"in t))throw new TypeError("Expecting canvas with `getContext` method in processCanvasRGB(A) calls!");var o=t.getContext("2d");try{return o.getImageData(n,e,r,i)}catch(t){throw new Error("unable to access image data: "+t)}}function k(t,n,e,r,i,o){if(!(isNaN(o)||o<1)){o|=0;var a=C(t,n,e,r,i);a=function(t,n,e,r,i,o){for(var a,u=t.data,c=2*o+1,s=r-1,f=i-1,l=o+1,h=l*(l+1)/2,d=new N,p=d,y=1;y<c;y++)p=p.next=new N,y===l&&(a=p);p.next=d;for(var g=null,v=null,m=0,b=0,x=T[o],_=E[o],w=0;w<i;w++){p=d;for(var A=u[b],S=u[b+1],M=u[b+2],C=u[b+3],k=0;k<l;k++)p.r=A,p.g=S,p.b=M,p.a=C,p=p.next;for(var O=0,P=0,I=0,R=0,z=l*A,V=l*S,D=l*M,j=l*C,L=h*A,U=h*S,B=h*M,F=h*C,q=1;q<l;q++){var H=b+((s<q?s:q)<<2),Y=u[H],X=u[H+1],$=u[H+2],W=u[H+3],G=l-q;L+=(p.r=Y)*G,U+=(p.g=X)*G,B+=(p.b=$)*G,F+=(p.a=W)*G,O+=Y,P+=X,I+=$,R+=W,p=p.next}g=d,v=a;for(var Q=0;Q<r;Q++){var Z=F*x>>_;if(u[b+3]=Z,0!==Z){var K=255/Z;u[b]=(L*x>>_)*K,u[b+1]=(U*x>>_)*K,u[b+2]=(B*x>>_)*K}else u[b]=u[b+1]=u[b+2]=0;L-=z,U-=V,B-=D,F-=j,z-=g.r,V-=g.g,D-=g.b,j-=g.a;var J=Q+o+1;J=m+(J<s?J:s)<<2,L+=O+=g.r=u[J],U+=P+=g.g=u[J+1],B+=I+=g.b=u[J+2],F+=R+=g.a=u[J+3],g=g.next;var tt=v,nt=tt.r,et=tt.g,rt=tt.b,it=tt.a;z+=nt,V+=et,D+=rt,j+=it,O-=nt,P-=et,I-=rt,R-=it,v=v.next,b+=4}m+=r}for(var ot=0;ot<r;ot++){var at=u[b=ot<<2],ut=u[b+1],ct=u[b+2],st=u[b+3],ft=l*at,lt=l*ut,ht=l*ct,dt=l*st,pt=h*at,yt=h*ut,gt=h*ct,vt=h*st;p=d;for(var mt=0;mt<l;mt++)p.r=at,p.g=ut,p.b=ct,p.a=st,p=p.next;for(var bt=r,xt=0,_t=0,wt=0,At=0,St=1;St<=o;St++){b=bt+ot<<2;var Mt=l-St;pt+=(p.r=at=u[b])*Mt,yt+=(p.g=ut=u[b+1])*Mt,gt+=(p.b=ct=u[b+2])*Mt,vt+=(p.a=st=u[b+3])*Mt,At+=at,xt+=ut,_t+=ct,wt+=st,p=p.next,St<f&&(bt+=r)}b=ot,g=d,v=a;for(var Tt=0;Tt<i;Tt++){var Et=b<<2;u[Et+3]=st=vt*x>>_,st>0?(st=255/st,u[Et]=(pt*x>>_)*st,u[Et+1]=(yt*x>>_)*st,u[Et+2]=(gt*x>>_)*st):u[Et]=u[Et+1]=u[Et+2]=0,pt-=ft,yt-=lt,gt-=ht,vt-=dt,ft-=g.r,lt-=g.g,ht-=g.b,dt-=g.a,Et=ot+((Et=Tt+l)<f?Et:f)*r<<2,pt+=At+=g.r=u[Et],yt+=xt+=g.g=u[Et+1],gt+=_t+=g.b=u[Et+2],vt+=wt+=g.a=u[Et+3],g=g.next,ft+=at=v.r,lt+=ut=v.g,ht+=ct=v.b,dt+=st=v.a,At-=at,xt-=ut,_t-=ct,wt-=st,v=v.next,b+=r}}return t}(a,0,0,r,i,o),t.getContext("2d").putImageData(a,n,e)}}var N=function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.r=0,this.g=0,this.b=0,this.a=0,this.next=null};var O=Object.freeze({__proto__:null,offscreen:function(){let{DOMParser:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n={window:null,ignoreAnimation:!0,ignoreMouse:!0,DOMParser:t,createCanvas:(t,n)=>new OffscreenCanvas(t,n),async createImage(t){const n=await fetch(t),e=await n.blob();return await createImageBitmap(e)}};return void 0===globalThis.DOMParser&&void 0!==t||Reflect.deleteProperty(n,"DOMParser"),n},node:function(t){let{DOMParser:n,canvas:e,fetch:r}=t;return{window:null,ignoreAnimation:!0,ignoreMouse:!0,DOMParser:n,fetch:r,createCanvas:e.createCanvas,createImage:e.loadImage}}});function P(t){return t.replace(/(?!\u3000)\s+/gm," ")}function I(t){return t.replace(/^[\n \t]+/,"")}function R(t){return t.replace(/[\n \t]+$/,"")}function z(t){const n=t.match(/-?(\d+(?:\.\d*(?:[eE][+-]?\d+)?)?|\.\d+)(?=\D|$)/gm);return n?n.map(parseFloat):[]}function V(t){const n=z(t);return[n[0]||0,n[1]||0,n[2]||0,n[3]||0,n[4]||0,n[5]||0]}const D=/^[A-Z-]+$/;function j(t){return D.test(t)?t.toLowerCase():t}function L(t){const n=/url\(('([^']+)'|"([^"]+)"|([^'")]+))\)/.exec(t);return n&&(n[2]||n[3]||n[4])||""}function U(t){if(!t.startsWith("rgb"))return t;let n=3;return t.replace(/\d+(\.\d+)?/g,((t,e)=>n--&&e?String(Math.round(parseFloat(t))):t))}const B=/(\[[^\]]+\])/g,F=/(#[^\s+>~.[:]+)/g,q=/(\.[^\s+>~.[:]+)/g,H=/(::[^\s+>~.[:]+|:first-line|:first-letter|:before|:after)/gi,Y=/(:[\w-]+\([^)]*\))/gi,X=/(:[^\s+>~.[:]+)/g,$=/([^\s+>~.[:]+)/g;function W(t,n){const e=n.exec(t);return e?[t.replace(n," "),e.length]:[t,0]}function G(t){const n=[0,0,0];let e=t.replace(/:not\(([^)]*)\)/g,"     $1 ").replace(/{[\s\S]*/gm," "),r=0;return[e,r]=W(e,B),n[1]+=r,[e,r]=W(e,F),n[0]+=r,[e,r]=W(e,q),n[1]+=r,[e,r]=W(e,H),n[2]+=r,[e,r]=W(e,Y),n[1]+=r,[e,r]=W(e,X),n[1]+=r,e=e.replace(/[*\s+>~]/g," ").replace(/[#.]/g," "),[e,r]=W(e,$),n[2]+=r,n.join("")}const Q=1e-8;function Z(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2))}function K(t,n){return(t[0]*n[0]+t[1]*n[1])/(Z(t)*Z(n))}function J(t,n){return(t[0]*n[1]<t[1]*n[0]?-1:1)*Math.acos(K(t,n))}function tt(t){return t*t*t}function nt(t){return 3*t*t*(1-t)}function et(t){return 3*t*(1-t)*(1-t)}function rt(t){return(1-t)*(1-t)*(1-t)}function it(t){return t*t}function ot(t){return 2*t*(1-t)}function at(t){return(1-t)*(1-t)}class ut{static empty(t){return new ut(t,"EMPTY","")}split(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:" ";const{document:n,name:e}=this;return P(this.getString()).trim().split(t).map((t=>new ut(n,e,t)))}hasValue(t){const n=this.value;return null!==n&&""!==n&&(t||0!==n)&&void 0!==n}isString(t){const{value:n}=this,e="string"==typeof n;return e&&t?t.test(n):e}isUrlDefinition(){return this.isString(/^url\(/)}isPixels(){if(!this.hasValue())return!1;const t=this.getString();switch(!0){case t.endsWith("px"):case/^[0-9]+$/.test(t):return!0;default:return!1}}setValue(t){return this.value=t,this}getValue(t){return void 0===t||this.hasValue()?this.value:t}getNumber(t){if(!this.hasValue())return void 0===t?0:parseFloat(t);const{value:n}=this;let e=parseFloat(n);return this.isString(/%$/)&&(e/=100),e}getString(t){return void 0===t||this.hasValue()?void 0===this.value?"":String(this.value):String(t)}getColor(t){let n=this.getString(t);return this.isNormalizedColor||(this.isNormalizedColor=!0,n=U(n),this.value=n),n}getDpi(){return 96}getRem(){return this.document.rootEmSize}getEm(){return this.document.emSize}getUnits(){return this.getString().replace(/[0-9.-]/g,"")}getPixels(t){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this.hasValue())return 0;const[e,r]="boolean"==typeof t?[void 0,t]:[t],{viewPort:i}=this.document.screen;switch(!0){case this.isString(/vmin$/):return this.getNumber()/100*Math.min(i.computeSize("x"),i.computeSize("y"));case this.isString(/vmax$/):return this.getNumber()/100*Math.max(i.computeSize("x"),i.computeSize("y"));case this.isString(/vw$/):return this.getNumber()/100*i.computeSize("x");case this.isString(/vh$/):return this.getNumber()/100*i.computeSize("y");case this.isString(/rem$/):return this.getNumber()*this.getRem();case this.isString(/em$/):return this.getNumber()*this.getEm();case this.isString(/ex$/):return this.getNumber()*this.getEm()/2;case this.isString(/px$/):return this.getNumber();case this.isString(/pt$/):return this.getNumber()*this.getDpi()*(1/72);case this.isString(/pc$/):return 15*this.getNumber();case this.isString(/cm$/):return this.getNumber()*this.getDpi()/2.54;case this.isString(/mm$/):return this.getNumber()*this.getDpi()/25.4;case this.isString(/in$/):return this.getNumber()*this.getDpi();case this.isString(/%$/)&&r:return this.getNumber()*this.getEm();case this.isString(/%$/):return this.getNumber()*i.computeSize(e);default:{const t=this.getNumber();return n&&t<1?t*i.computeSize(e):t}}}getMilliseconds(){return this.hasValue()?this.isString(/ms$/)?this.getNumber():1e3*this.getNumber():0}getRadians(){if(!this.hasValue())return 0;switch(!0){case this.isString(/deg$/):return this.getNumber()*(Math.PI/180);case this.isString(/grad$/):return this.getNumber()*(Math.PI/200);case this.isString(/rad$/):return this.getNumber();default:return this.getNumber()*(Math.PI/180)}}getDefinition(){const t=this.getString(),n=/#([^)'"]+)/.exec(t),e=(null==n?void 0:n[1])||t;return this.document.definitions[e]}getFillStyleDefinition(t,n){let e=this.getDefinition();if(!e)return null;if("function"==typeof e.createGradient&&"getBoundingBox"in t)return e.createGradient(this.document.ctx,t,n);if("function"==typeof e.createPattern){if(e.getHrefAttribute().hasValue()){const t=e.getAttribute("patternTransform");e=e.getHrefAttribute().getDefinition(),e&&t.hasValue()&&e.getAttribute("patternTransform",!0).setValue(t.value)}if(e)return e.createPattern(this.document.ctx,t,n)}return null}getTextBaseline(){if(!this.hasValue())return null;const t=this.getString();return ut.textBaselineMapping[t]||null}addOpacity(t){let n=this.getColor();const e=n.length;let r=0;for(let t=0;t<e&&(","===n[t]&&r++,3!==r);t++);if(t.hasValue()&&this.isString()&&3!==r){const e=new i(n);e.ok&&(e.alpha=t.getNumber(),n=e.toRGBA())}return new ut(this.document,this.name,n)}constructor(t,n,e){this.document=t,this.name=n,this.value=e,this.isNormalizedColor=!1}}ut.textBaselineMapping={baseline:"alphabetic","before-edge":"top","text-before-edge":"top",middle:"middle",central:"middle","after-edge":"bottom","text-after-edge":"bottom",ideographic:"ideographic",alphabetic:"alphabetic",hanging:"hanging",mathematical:"alphabetic"};class ct{clear(){this.viewPorts=[]}setCurrent(t,n){this.viewPorts.push({width:t,height:n})}removeCurrent(){this.viewPorts.pop()}getRoot(){const[t]=this.viewPorts;return t||st()}getCurrent(){const{viewPorts:t}=this,n=t[t.length-1];return n||st()}get width(){return this.getCurrent().width}get height(){return this.getCurrent().height}computeSize(t){return"number"==typeof t?t:"x"===t?this.width:"y"===t?this.height:Math.sqrt(Math.pow(this.width,2)+Math.pow(this.height,2))/Math.sqrt(2)}constructor(){this.viewPorts=[]}}function st(){return{width:ct.DEFAULT_VIEWPORT_WIDTH,height:ct.DEFAULT_VIEWPORT_HEIGHT}}ct.DEFAULT_VIEWPORT_WIDTH=800,ct.DEFAULT_VIEWPORT_HEIGHT=600;class ft{static parse(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const[e=n,r=n]=z(t);return new ft(e,r)}static parseScale(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const[e=n,r=e]=z(t);return new ft(e,r)}static parsePath(t){const n=z(t),e=n.length,r=[];for(let t=0;t<e;t+=2)r.push(new ft(n[t],n[t+1]));return r}angleTo(t){return Math.atan2(t.y-this.y,t.x-this.x)}applyTransform(t){const{x:n,y:e}=this,r=n*t[0]+e*t[2]+t[4],i=n*t[1]+e*t[3]+t[5];this.x=r,this.y=i}constructor(t,n){this.x=t,this.y=n}}class lt{isWorking(){return this.working}start(){if(this.working)return;const{screen:t,onClick:n,onMouseMove:e}=this,r=t.ctx.canvas;r.onclick=n,r.onmousemove=e,this.working=!0}stop(){if(!this.working)return;const t=this.screen.ctx.canvas;this.working=!1,t.onclick=null,t.onmousemove=null}hasEvents(){return this.working&&this.events.length>0}runEvents(){if(!this.working)return;const{screen:t,events:n,eventElements:e}=this,{style:r}=t.ctx.canvas;let i;r&&(r.cursor=""),n.forEach(((t,n)=>{let{run:r}=t;for(i=e[n];i;)r(i),i=i.parent})),this.events=[],this.eventElements=[]}checkPath(t,n){if(!this.working||!n)return;const{events:e,eventElements:r}=this;e.forEach(((e,i)=>{let{x:o,y:a}=e;!r[i]&&n.isPointInPath&&n.isPointInPath(o,a)&&(r[i]=t)}))}checkBoundingBox(t,n){if(!this.working||!n)return;const{events:e,eventElements:r}=this;e.forEach(((e,i)=>{let{x:o,y:a}=e;!r[i]&&n.isPointInBox(o,a)&&(r[i]=t)}))}mapXY(t,n){const{window:e,ctx:r}=this.screen,i=new ft(t,n);let o=r.canvas;for(;o;)i.x-=o.offsetLeft,i.y-=o.offsetTop,o=o.offsetParent;return(null==e?void 0:e.scrollX)&&(i.x+=e.scrollX),(null==e?void 0:e.scrollY)&&(i.y+=e.scrollY),i}onClick(t){const{x:n,y:e}=this.mapXY(t.clientX,t.clientY);this.events.push({type:"onclick",x:n,y:e,run(t){t.onClick&&t.onClick()}})}onMouseMove(t){const{x:n,y:e}=this.mapXY(t.clientX,t.clientY);this.events.push({type:"onmousemove",x:n,y:e,run(t){t.onMouseMove&&t.onMouseMove()}})}constructor(t){this.screen=t,this.working=!1,this.events=[],this.eventElements=[],this.onClick=this.onClick.bind(this),this.onMouseMove=this.onMouseMove.bind(this)}}const ht="undefined"!=typeof window?window:null,dt="undefined"!=typeof fetch?fetch.bind(void 0):void 0;class pt{wait(t){this.waits.push(t)}ready(){return this.readyPromise?this.readyPromise:Promise.resolve()}isReady(){if(this.isReadyLock)return!0;const t=this.waits.every((t=>t()));return t&&(this.waits=[],this.resolveReady&&this.resolveReady()),this.isReadyLock=t,t}setDefaults(t){t.strokeStyle="rgba(0,0,0,0)",t.lineCap="butt",t.lineJoin="miter",t.miterLimit=4}setViewBox(t){let{document:n,ctx:e,aspectRatio:r,width:i,desiredWidth:o,height:a,desiredHeight:u,minX:c=0,minY:s=0,refX:f,refY:l,clip:h=!1,clipX:d=0,clipY:p=0}=t;const y=P(r).replace(/^defer\s/,""),[g,v]=y.split(" "),m=g||"xMidYMid",b=v||"meet",x=i/o,_=a/u,w=Math.min(x,_),A=Math.max(x,_);let S=o,M=u;"meet"===b&&(S*=w,M*=w),"slice"===b&&(S*=A,M*=A);const T=new ut(n,"refX",f),E=new ut(n,"refY",l),C=T.hasValue()&&E.hasValue();if(C&&e.translate(-w*T.getPixels("x"),-w*E.getPixels("y")),h){const t=w*d,n=w*p;e.beginPath(),e.moveTo(t,n),e.lineTo(i,n),e.lineTo(i,a),e.lineTo(t,a),e.closePath(),e.clip()}if(!C){const t="meet"===b&&w===_,n="slice"===b&&A===_,r="meet"===b&&w===x,o="slice"===b&&A===x;m.startsWith("xMid")&&(t||n)&&e.translate(i/2-S/2,0),m.endsWith("YMid")&&(r||o)&&e.translate(0,a/2-M/2),m.startsWith("xMax")&&(t||n)&&e.translate(i-S,0),m.endsWith("YMax")&&(r||o)&&e.translate(0,a-M)}switch(!0){case"none"===m:e.scale(x,_);break;case"meet"===b:e.scale(w,w);break;case"slice"===b:e.scale(A,A)}e.translate(-c,-s)}start(t){let{enableRedraw:n=!1,ignoreMouse:e=!1,ignoreAnimation:i=!1,ignoreDimensions:o=!1,ignoreClear:a=!1,forceRedraw:u,scaleWidth:c,scaleHeight:s,offsetX:f,offsetY:l}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{mouse:h}=this,d=1e3/pt.FRAMERATE;if(this.frameDuration=d,this.readyPromise=new Promise((t=>{this.resolveReady=t})),this.isReady()&&this.render(t,o,a,c,s,f,l),!n)return;let p=Date.now(),y=p,g=0;const v=()=>{p=Date.now(),g=p-y,g>=d&&(y=p-g%d,this.shouldUpdate(i,u)&&(this.render(t,o,a,c,s,f,l),h.runEvents())),this.intervalId=r(v)};e||h.start(),this.intervalId=r(v)}stop(){this.intervalId&&(r.cancel(this.intervalId),this.intervalId=null),this.mouse.stop()}shouldUpdate(t,n){if(!t){const{frameDuration:t}=this;if(this.animations.reduce(((n,e)=>e.update(t)||n),!1))return!0}return!("function"!=typeof n||!n())||(!(this.isReadyLock||!this.isReady())||!!this.mouse.hasEvents())}render(t,n,e,r,i,o,a){const{viewPort:u,ctx:c,isFirstRender:s}=this,f=c.canvas;u.clear(),f.width&&f.height&&u.setCurrent(f.width,f.height);const l=t.getStyle("width"),h=t.getStyle("height");!n&&(s||"number"!=typeof r&&"number"!=typeof i)&&(l.hasValue()&&(f.width=l.getPixels("x"),f.style&&(f.style.width="".concat(f.width,"px"))),h.hasValue()&&(f.height=h.getPixels("y"),f.style&&(f.style.height="".concat(f.height,"px"))));let d=f.clientWidth||f.width,p=f.clientHeight||f.height;if(n&&l.hasValue()&&h.hasValue()&&(d=l.getPixels("x"),p=h.getPixels("y")),u.setCurrent(d,p),"number"==typeof o&&t.getAttribute("x",!0).setValue(o),"number"==typeof a&&t.getAttribute("y",!0).setValue(a),"number"==typeof r||"number"==typeof i){const n=z(t.getAttribute("viewBox").getString());let e=0,o=0;if("number"==typeof r){const i=t.getStyle("width");i.hasValue()?e=i.getPixels("x")/r:n[2]&&!isNaN(n[2])&&(e=n[2]/r)}if("number"==typeof i){const e=t.getStyle("height");e.hasValue()?o=e.getPixels("y")/i:n[3]&&!isNaN(n[3])&&(o=n[3]/i)}e||(e=o),o||(o=e),t.getAttribute("width",!0).setValue(r),t.getAttribute("height",!0).setValue(i);const a=t.getStyle("transform",!0,!0);a.setValue("".concat(a.getString()," scale(").concat(1/e,", ").concat(1/o,")"))}e||c.clearRect(0,0,d,p),t.render(c),s&&(this.isFirstRender=!1)}constructor(t,{fetch:n=dt,window:e=ht}={}){if(this.ctx=t,this.viewPort=new ct,this.mouse=new lt(this),this.animations=[],this.waits=[],this.frameDuration=0,this.isReadyLock=!1,this.isFirstRender=!0,this.intervalId=null,this.window=e,!n)throw new Error("Can't find 'fetch' in 'globalThis', please provide it via options");this.fetch=n}}pt.defaultWindow=ht,pt.defaultFetch=dt,pt.FRAMERATE=30,pt.MAX_VIRTUAL_PIXELS=3e4;const{defaultFetch:yt}=pt,gt="undefined"!=typeof DOMParser?DOMParser:void 0;class vt{async parse(t){return t.startsWith("<")?this.parseFromString(t):this.load(t)}parseFromString(t){const n=new this.DOMParser;try{return this.checkDocument(n.parseFromString(t,"image/svg+xml"))}catch(e){return this.checkDocument(n.parseFromString(t,"text/xml"))}}checkDocument(t){const n=t.getElementsByTagName("parsererror")[0];if(n)throw new Error(n.textContent||"Unknown parse error");return t}async load(t){const n=await this.fetch(t),e=await n.text();return this.parseFromString(e)}constructor({fetch:t=yt,DOMParser:n=gt}={}){if(!t)throw new Error("Can't find 'fetch' in 'globalThis', please provide it via options");if(!n)throw new Error("Can't find 'DOMParser' in 'globalThis', please provide it via options");this.fetch=t,this.DOMParser=n}}class mt{apply(t){const{x:n,y:e}=this.point;t.translate(n||0,e||0)}unapply(t){const{x:n,y:e}=this.point;t.translate(-1*n||0,-1*e||0)}applyToPoint(t){const{x:n,y:e}=this.point;t.applyTransform([1,0,0,1,n||0,e||0])}constructor(t,n){this.type="translate",this.point=ft.parse(n)}}class bt{apply(t){const{cx:n,cy:e,originX:r,originY:i,angle:o}=this,a=n+r.getPixels("x"),u=e+i.getPixels("y");t.translate(a,u),t.rotate(o.getRadians()),t.translate(-a,-u)}unapply(t){const{cx:n,cy:e,originX:r,originY:i,angle:o}=this,a=n+r.getPixels("x"),u=e+i.getPixels("y");t.translate(a,u),t.rotate(-1*o.getRadians()),t.translate(-a,-u)}applyToPoint(t){const{cx:n,cy:e,angle:r}=this,i=r.getRadians();t.applyTransform([1,0,0,1,n||0,e||0]),t.applyTransform([Math.cos(i),Math.sin(i),-Math.sin(i),Math.cos(i),0,0]),t.applyTransform([1,0,0,1,-n||0,-e||0])}constructor(t,n,e){this.type="rotate";const r=z(n);this.angle=new ut(t,"angle",r[0]),this.originX=e[0],this.originY=e[1],this.cx=r[1]||0,this.cy=r[2]||0}}class xt{apply(t){const{scale:{x:n,y:e},originX:r,originY:i}=this,o=r.getPixels("x"),a=i.getPixels("y");t.translate(o,a),t.scale(n,e||n),t.translate(-o,-a)}unapply(t){const{scale:{x:n,y:e},originX:r,originY:i}=this,o=r.getPixels("x"),a=i.getPixels("y");t.translate(o,a),t.scale(1/n,1/e||n),t.translate(-o,-a)}applyToPoint(t){const{x:n,y:e}=this.scale;t.applyTransform([n||0,0,0,e||0,0,0])}constructor(t,n,e){this.type="scale";const r=ft.parseScale(n);0!==r.x&&0!==r.y||(r.x=Q,r.y=Q),this.scale=r,this.originX=e[0],this.originY=e[1]}}class _t{apply(t){const{originX:n,originY:e,matrix:r}=this,i=n.getPixels("x"),o=e.getPixels("y");t.translate(i,o),t.transform(r[0],r[1],r[2],r[3],r[4],r[5]),t.translate(-i,-o)}unapply(t){const{originX:n,originY:e,matrix:r}=this,i=r[0],o=r[2],a=r[4],u=r[1],c=r[3],s=r[5],f=1/(i*(1*c-0*s)-o*(1*u-0*s)+a*(0*u-0*c)),l=n.getPixels("x"),h=e.getPixels("y");t.translate(l,h),t.transform(f*(1*c-0*s),f*(0*s-1*u),f*(0*a-1*o),f*(1*i-0*a),f*(o*s-a*c),f*(a*u-i*s)),t.translate(-l,-h)}applyToPoint(t){t.applyTransform(this.matrix)}constructor(t,n,e){this.type="matrix",this.matrix=V(n),this.originX=e[0],this.originY=e[1]}}class wt extends _t{constructor(t,n,e){super(t,n,e),this.type="skew",this.angle=new ut(t,"angle",n)}}class At extends wt{constructor(t,n,e){super(t,n,e),this.type="skewX",this.matrix=[1,0,Math.tan(this.angle.getRadians()),1,0,0]}}class St extends wt{constructor(t,n,e){super(t,n,e),this.type="skewY",this.matrix=[1,Math.tan(this.angle.getRadians()),0,1,0,0]}}class Mt{static fromElement(t,n){const e=n.getStyle("transform",!1,!0);if(e.hasValue()){const[r,i=r]=n.getStyle("transform-origin",!1,!0).split();if(r&&i){const n=[r,i];return new Mt(t,e.getString(),n)}}return null}apply(t){this.transforms.forEach((n=>n.apply(t)))}unapply(t){this.transforms.forEach((n=>n.unapply(t)))}applyToPoint(t){this.transforms.forEach((n=>n.applyToPoint(t)))}constructor(t,n,e){this.document=t,this.transforms=[];P(n).trim().replace(/\)([a-zA-Z])/g,") $1").replace(/\)(\s?,\s?)/g,") ").split(/\s(?=[a-z])/).forEach((t=>{if("none"===t)return;const[n,r]=function(t){const[n="",e=""]=t.split("(");return[n.trim(),e.trim().replace(")","")]}(t),i=Mt.transformTypes[n];i&&this.transforms.push(new i(this.document,r,e))}))}}Mt.transformTypes={translate:mt,rotate:bt,scale:xt,matrix:_t,skewX:At,skewY:St};class Tt{getAttribute(t){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const e=this.attributes[t];if(!e&&n){const n=new ut(this.document,t,"");return this.attributes[t]=n,n}return e||ut.empty(this.document)}getHrefAttribute(){let t;for(const n in this.attributes)if("href"===n||n.endsWith(":href")){t=this.attributes[n];break}return t||ut.empty(this.document)}getStyle(t){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],e=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=this.styles[t];if(r)return r;const i=this.getAttribute(t);if(i.hasValue())return this.styles[t]=i,i;if(!e){const{parent:n}=this;if(n){const e=n.getStyle(t);if(e.hasValue())return e}}if(n){const n=new ut(this.document,t,"");return this.styles[t]=n,n}return ut.empty(this.document)}render(t){if("none"!==this.getStyle("display").getString()&&"hidden"!==this.getStyle("visibility").getString()){if(t.save(),this.getStyle("mask").hasValue()){const n=this.getStyle("mask").getDefinition();n&&(this.applyEffects(t),n.apply(t,this))}else if("none"!==this.getStyle("filter").getValue("none")){const n=this.getStyle("filter").getDefinition();n&&(this.applyEffects(t),n.apply(t,this))}else this.setContext(t),this.renderChildren(t),this.clearContext(t);t.restore()}}setContext(t){}applyEffects(t){const n=Mt.fromElement(this.document,this);n&&n.apply(t);const e=this.getStyle("clip-path",!1,!0);if(e.hasValue()){const n=e.getDefinition();n&&n.apply(t)}}clearContext(t){}renderChildren(t){this.children.forEach((n=>{n.render(t)}))}addChild(t){const n=t instanceof Tt?t:this.document.createElement(t);n.parent=this,Tt.ignoreChildTypes.includes(n.type)||this.children.push(n)}matchesSelector(t){var n;const{node:e}=this;if("function"==typeof e.matches)return e.matches(t);const r=null===(n=e.getAttribute)||void 0===n?void 0:n.call(e,"class");return!(!r||""===r)&&r.split(" ").some((n=>".".concat(n)===t))}addStylesFromStyleDefinition(){const{styles:t,stylesSpecificity:n}=this.document;let e;for(const r in t)if(!r.startsWith("@")&&this.matchesSelector(r)){const i=t[r],o=n[r];if(i)for(const t in i){let n=this.stylesSpecificity[t];void 0===n&&(n="000"),o&&o>=n&&(e=i[t],e&&(this.styles[t]=e),this.stylesSpecificity[t]=o)}}}removeStyles(t,n){return n.reduce(((n,e)=>{const r=t.getStyle(e);if(!r.hasValue())return n;const i=r.getString();return r.setValue(""),[...n,[e,i]]}),[])}restoreStyles(t,n){n.forEach((n=>{let[e,r]=n;t.getStyle(e,!0).setValue(r)}))}isFirstChild(){var t;return 0===(null===(t=this.parent)||void 0===t?void 0:t.children.indexOf(this))}constructor(t,n,e=!1){if(this.document=t,this.node=n,this.captureTextNodes=e,this.type="",this.attributes={},this.styles={},this.stylesSpecificity={},this.animationFrozen=!1,this.animationFrozenValue="",this.parent=null,this.children=[],!n||1!==n.nodeType)return;if(Array.from(n.attributes).forEach((n=>{const e=j(n.nodeName);this.attributes[e]=new ut(t,e,n.value)})),this.addStylesFromStyleDefinition(),this.getAttribute("style").hasValue()){this.getAttribute("style").getString().split(";").map((t=>t.trim())).forEach((n=>{if(!n)return;const[e,r]=n.split(":").map((t=>t.trim()));e&&(this.styles[e]=new ut(t,e,r))}))}const{definitions:r}=t,i=this.getAttribute("id");i.hasValue()&&(r[i.getString()]||(r[i.getString()]=this)),Array.from(n.childNodes).forEach((n=>{if(1===n.nodeType)this.addChild(n);else if(e&&(3===n.nodeType||4===n.nodeType)){const e=t.createTextNode(n);e.getText().length>0&&this.addChild(e)}}))}}Tt.ignoreChildTypes=["title"];class Et extends Tt{constructor(t,n,e){super(t,n,e)}}function Ct(t){const n=t.trim();return/^('|")/.test(n)?n:'"'.concat(n,'"')}function kt(t){if(!t)return"";const n=t.trim().toLowerCase();switch(n){case"normal":case"italic":case"oblique":case"inherit":case"initial":case"unset":return n;default:return/^oblique\s+(-|)\d+deg$/.test(n)?n:""}}function Nt(t){if(!t)return"";const n=t.trim().toLowerCase();switch(n){case"normal":case"bold":case"lighter":case"bolder":case"inherit":case"initial":case"unset":return n;default:return/^[\d.]+$/.test(n)?n:""}}class Ot{static parse(){let t=arguments.length>1?arguments[1]:void 0,n="",e="",r="",i="",o="";const a=P(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").trim().split(" "),u={fontSize:!1,fontStyle:!1,fontWeight:!1,fontVariant:!1};return a.forEach((t=>{switch(!0){case!u.fontStyle&&Ot.styles.includes(t):"inherit"!==t&&(n=t),u.fontStyle=!0;break;case!u.fontVariant&&Ot.variants.includes(t):"inherit"!==t&&(e=t),u.fontStyle=!0,u.fontVariant=!0;break;case!u.fontWeight&&Ot.weights.includes(t):"inherit"!==t&&(r=t),u.fontStyle=!0,u.fontVariant=!0,u.fontWeight=!0;break;case!u.fontSize:"inherit"!==t&&(i=t.split("/")[0]||""),u.fontStyle=!0,u.fontVariant=!0,u.fontWeight=!0,u.fontSize=!0;break;default:"inherit"!==t&&(o+=t)}})),new Ot(n,e,r,i,o,t)}toString(){return[kt(this.fontStyle),this.fontVariant,Nt(this.fontWeight),this.fontSize,(t=this.fontFamily,"undefined"==typeof process?t:t.trim().split(",").map(Ct).join(","))].join(" ").trim();var t}constructor(t,n,e,r,i,o){const a=o?"string"==typeof o?Ot.parse(o):o:{};this.fontFamily=i||a.fontFamily,this.fontSize=r||a.fontSize,this.fontStyle=t||a.fontStyle,this.fontWeight=e||a.fontWeight,this.fontVariant=n||a.fontVariant}}Ot.styles="normal|italic|oblique|inherit",Ot.variants="normal|small-caps|inherit",Ot.weights="normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit";class Pt{get x(){return this.x1}get y(){return this.y1}get width(){return this.x2-this.x1}get height(){return this.y2-this.y1}addPoint(t,n){void 0!==t&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=t,this.x2=t),t<this.x1&&(this.x1=t),t>this.x2&&(this.x2=t)),void 0!==n&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=n,this.y2=n),n<this.y1&&(this.y1=n),n>this.y2&&(this.y2=n))}addX(t){this.addPoint(t,0)}addY(t){this.addPoint(0,t)}addBoundingBox(t){if(!t)return;const{x1:n,y1:e,x2:r,y2:i}=t;this.addPoint(n,e),this.addPoint(r,i)}sumCubic(t,n,e,r,i){return Math.pow(1-t,3)*n+3*Math.pow(1-t,2)*t*e+3*(1-t)*Math.pow(t,2)*r+Math.pow(t,3)*i}bezierCurveAdd(t,n,e,r,i){const o=6*n-12*e+6*r,a=-3*n+9*e-9*r+3*i,u=3*e-3*n;if(0===a){if(0===o)return;const a=-u/o;return void(0<a&&a<1&&(t?this.addX(this.sumCubic(a,n,e,r,i)):this.addY(this.sumCubic(a,n,e,r,i))))}const c=Math.pow(o,2)-4*u*a;if(c<0)return;const s=(-o+Math.sqrt(c))/(2*a);0<s&&s<1&&(t?this.addX(this.sumCubic(s,n,e,r,i)):this.addY(this.sumCubic(s,n,e,r,i)));const f=(-o-Math.sqrt(c))/(2*a);0<f&&f<1&&(t?this.addX(this.sumCubic(f,n,e,r,i)):this.addY(this.sumCubic(f,n,e,r,i)))}addBezierCurve(t,n,e,r,i,o,a,u){this.addPoint(t,n),this.addPoint(a,u),this.bezierCurveAdd(!0,t,e,i,a),this.bezierCurveAdd(!1,n,r,o,u)}addQuadraticCurve(t,n,e,r,i,o){const a=t+2/3*(e-t),u=n+2/3*(r-n),c=a+1/3*(i-t),s=u+1/3*(o-n);this.addBezierCurve(t,n,a,c,u,s,i,o)}isPointInBox(t,n){const{x1:e,y1:r,x2:i,y2:o}=this;return e<=t&&t<=i&&r<=n&&n<=o}constructor(t=Number.NaN,n=Number.NaN,e=Number.NaN,r=Number.NaN){this.x1=t,this.y1=n,this.x2=e,this.y2=r,this.addPoint(t,n),this.addPoint(e,r)}}class It extends Tt{calculateOpacity(){let t=1,n=this;for(;n;){const e=n.getStyle("opacity",!1,!0);e.hasValue(!0)&&(t*=e.getNumber()),n=n.parent}return t}setContext(t){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!n){const n=this.getStyle("fill"),e=this.getStyle("fill-opacity"),r=this.getStyle("stroke"),i=this.getStyle("stroke-opacity");if(n.isUrlDefinition()){const r=n.getFillStyleDefinition(this,e);r&&(t.fillStyle=r)}else if(n.hasValue()){"currentColor"===n.getString()&&n.setValue(this.getStyle("color").getColor());const e=n.getColor();"inherit"!==e&&(t.fillStyle="none"===e?"rgba(0,0,0,0)":e)}if(e.hasValue()){const n=new ut(this.document,"fill",t.fillStyle).addOpacity(e).getColor();t.fillStyle=n}if(r.isUrlDefinition()){const n=r.getFillStyleDefinition(this,i);n&&(t.strokeStyle=n)}else if(r.hasValue()){"currentColor"===r.getString()&&r.setValue(this.getStyle("color").getColor());const n=r.getString();"inherit"!==n&&(t.strokeStyle="none"===n?"rgba(0,0,0,0)":n)}if(i.hasValue()){const n=new ut(this.document,"stroke",t.strokeStyle).addOpacity(i).getString();t.strokeStyle=n}const o=this.getStyle("stroke-width");if(o.hasValue()){const n=o.getPixels();t.lineWidth=n||Q}const a=this.getStyle("stroke-linecap"),u=this.getStyle("stroke-linejoin"),c=this.getStyle("stroke-miterlimit"),s=this.getStyle("stroke-dasharray"),f=this.getStyle("stroke-dashoffset");if(a.hasValue()&&(t.lineCap=a.getString()),u.hasValue()&&(t.lineJoin=u.getString()),c.hasValue()&&(t.miterLimit=c.getNumber()),s.hasValue()&&"none"!==s.getString()){const n=z(s.getString());void 0!==t.setLineDash?t.setLineDash(n):void 0!==t.webkitLineDash?t.webkitLineDash=n:void 0===t.mozDash||1===n.length&&0===n[0]||(t.mozDash=n);const e=f.getPixels();void 0!==t.lineDashOffset?t.lineDashOffset=e:void 0!==t.webkitLineDashOffset?t.webkitLineDashOffset=e:void 0!==t.mozDashOffset&&(t.mozDashOffset=e)}}if(this.modifiedEmSizeStack=!1,void 0!==t.font){const n=this.getStyle("font"),e=this.getStyle("font-style"),r=this.getStyle("font-variant"),i=this.getStyle("font-weight"),o=this.getStyle("font-size"),a=this.getStyle("font-family"),u=new Ot(e.getString(),r.getString(),i.getString(),o.hasValue()?"".concat(o.getPixels(!0),"px"):"",a.getString(),Ot.parse(n.getString(),t.font));e.setValue(u.fontStyle),r.setValue(u.fontVariant),i.setValue(u.fontWeight),o.setValue(u.fontSize),a.setValue(u.fontFamily),t.font=u.toString(),o.isPixels()&&(this.document.emSize=o.getPixels(),this.modifiedEmSizeStack=!0)}n||(this.applyEffects(t),t.globalAlpha=this.calculateOpacity())}clearContext(t){super.clearContext(t),this.modifiedEmSizeStack&&this.document.popEmSize()}constructor(...t){super(...t),this.modifiedEmSizeStack=!1}}class Rt extends It{setContext(t){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super.setContext(t,n);const e=this.getStyle("dominant-baseline").getTextBaseline()||this.getStyle("alignment-baseline").getTextBaseline();e&&(t.textBaseline=e)}initializeCoordinates(){this.x=0,this.y=0,this.leafTexts=[],this.textChunkStart=0,this.minX=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY}getBoundingBox(t){if("text"!==this.type)return this.getTElementBoundingBox(t);this.initializeCoordinates(),this.adjustChildCoordinatesRecursive(t);let n=null;return this.children.forEach(((e,r)=>{const i=this.getChildBoundingBox(t,this,this,r);n?n.addBoundingBox(i):n=i})),n}getFontSize(){const{document:t,parent:n}=this,e=Ot.parse(t.ctx.font).fontSize;return n.getStyle("font-size").getNumber(e)}getTElementBoundingBox(t){const n=this.getFontSize();return new Pt(this.x,this.y-n,this.x+this.measureText(t),this.y)}getGlyph(t,n,e){const r=n[e];let i;if(t.isArabic){var o;const a=n.length,u=n[e-1],c=n[e+1];let s="isolated";(0===e||" "===u)&&e<a-1&&" "!==c&&(s="terminal"),e>0&&" "!==u&&e<a-1&&" "!==c&&(s="medial"),e>0&&" "!==u&&(e===a-1||" "===c)&&(s="initial"),i=(null===(o=t.arabicGlyphs[r])||void 0===o?void 0:o[s])||t.glyphs[r]}else i=t.glyphs[r];return i||(i=t.missingGlyph),i}getText(){return""}getTextFromNode(t){const n=t||this.node,e=Array.from(n.parentNode.childNodes),r=e.indexOf(n),i=e.length-1;let o=P(n.textContent||"");return 0===r&&(o=I(o)),r===i&&(o=R(o)),o}renderChildren(t){if("text"!==this.type)return void this.renderTElementChildren(t);this.initializeCoordinates(),this.adjustChildCoordinatesRecursive(t),this.children.forEach(((n,e)=>{this.renderChild(t,this,this,e)}));const{mouse:n}=this.document.screen;n.isWorking()&&n.checkBoundingBox(this,this.getBoundingBox(t))}renderTElementChildren(t){const{document:n,parent:e}=this,r=this.getText(),i=e.getStyle("font-family").getDefinition();if(i){const{unitsPerEm:o}=i.fontFace,a=Ot.parse(n.ctx.font),u=e.getStyle("font-size").getNumber(a.fontSize),c=e.getStyle("font-style").getString(a.fontStyle),s=u/o,f=i.isRTL?r.split("").reverse().join(""):r,l=z(e.getAttribute("dx").getString()),h=f.length;for(let n=0;n<h;n++){const e=this.getGlyph(i,f,n);t.translate(this.x,this.y),t.scale(s,-s);const r=t.lineWidth;t.lineWidth=t.lineWidth*o/u,"italic"===c&&t.transform(1,0,.4,1,0,0),e.render(t),"italic"===c&&t.transform(1,0,-.4,1,0,0),t.lineWidth=r,t.scale(1/s,-1/s),t.translate(-this.x,-this.y),this.x+=u*(e.horizAdvX||i.horizAdvX)/o,void 0===l[n]||isNaN(l[n])||(this.x+=l[n])}return}const{x:o,y:a}=this;t.fillStyle&&t.fillText(r,o,a),t.strokeStyle&&t.strokeText(r,o,a)}applyAnchoring(){if(this.textChunkStart>=this.leafTexts.length)return;const t=this.leafTexts[this.textChunkStart],n=t.getStyle("text-anchor").getString("start");let e=0;e="start"===n?t.x-this.minX:"end"===n?t.x-this.maxX:t.x-(this.minX+this.maxX)/2;for(let t=this.textChunkStart;t<this.leafTexts.length;t++)this.leafTexts[t].x+=e;this.minX=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.textChunkStart=this.leafTexts.length}adjustChildCoordinatesRecursive(t){this.children.forEach(((n,e)=>{this.adjustChildCoordinatesRecursiveCore(t,this,this,e)})),this.applyAnchoring()}adjustChildCoordinatesRecursiveCore(t,n,e,r){const i=e.children[r];i.children.length>0?i.children.forEach(((e,r)=>{n.adjustChildCoordinatesRecursiveCore(t,n,i,r)})):this.adjustChildCoordinates(t,n,e,r)}adjustChildCoordinates(t,n,e,r){const i=e.children[r];if("function"!=typeof i.measureText)return i;t.save(),i.setContext(t,!0);const o=i.getAttribute("x"),a=i.getAttribute("y"),u=i.getAttribute("dx"),c=i.getAttribute("dy"),s=i.getStyle("font-family").getDefinition(),f=Boolean(null==s?void 0:s.isRTL);0===r&&(o.hasValue()||o.setValue(i.getInheritedAttribute("x")),a.hasValue()||a.setValue(i.getInheritedAttribute("y")),u.hasValue()||u.setValue(i.getInheritedAttribute("dx")),c.hasValue()||c.setValue(i.getInheritedAttribute("dy")));const l=i.measureText(t);return f&&(n.x-=l),o.hasValue()?(n.applyAnchoring(),i.x=o.getPixels("x"),u.hasValue()&&(i.x+=u.getPixels("x"))):(u.hasValue()&&(n.x+=u.getPixels("x")),i.x=n.x),n.x=i.x,f||(n.x+=l),a.hasValue()?(i.y=a.getPixels("y"),c.hasValue()&&(i.y+=c.getPixels("y"))):(c.hasValue()&&(n.y+=c.getPixels("y")),i.y=n.y),n.y=i.y,n.leafTexts.push(i),n.minX=Math.min(n.minX,i.x,i.x+l),n.maxX=Math.max(n.maxX,i.x,i.x+l),i.clearContext(t),t.restore(),i}getChildBoundingBox(t,n,e,r){const i=e.children[r];if("function"!=typeof i.getBoundingBox)return null;const o=i.getBoundingBox(t);return o&&i.children.forEach(((e,r)=>{const a=n.getChildBoundingBox(t,n,i,r);o.addBoundingBox(a)})),o}renderChild(t,n,e,r){const i=e.children[r];i.render(t),i.children.forEach(((e,r)=>{n.renderChild(t,n,i,r)}))}measureText(t){const{measureCache:n}=this;if(~n)return n;const e=this.getText(),r=this.measureTargetText(t,e);return this.measureCache=r,r}measureTargetText(t,n){if(!n.length)return 0;const{parent:e}=this,r=e.getStyle("font-family").getDefinition();if(r){const t=this.getFontSize(),i=r.isRTL?n.split("").reverse().join(""):n,o=z(e.getAttribute("dx").getString()),a=i.length;let u=0;for(let n=0;n<a;n++){u+=(this.getGlyph(r,i,n).horizAdvX||r.horizAdvX)*t/r.fontFace.unitsPerEm,void 0===o[n]||isNaN(o[n])||(u+=o[n])}return u}if(!t.measureText)return 10*n.length;t.save(),this.setContext(t,!0);const{width:i}=t.measureText(n);return this.clearContext(t),t.restore(),i}getInheritedAttribute(t){let n=this;for(;n instanceof Rt&&n.isFirstChild()&&n.parent;){const e=n.parent.getAttribute(t);if(e.hasValue(!0))return e.getString("0");n=n.parent}return null}constructor(t,n,e){super(t,n,new.target===Rt||e),this.type="text",this.x=0,this.y=0,this.leafTexts=[],this.textChunkStart=0,this.minX=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.measureCache=-1}}class zt extends Rt{getText(){return this.text}constructor(t,n,e){super(t,n,new.target===zt||e),this.type="tspan",this.text=this.children.length>0?"":this.getTextFromNode()}}class Vt extends zt{constructor(...t){super(...t),this.type="textNode"}}class Dt extends A{reset(){this.i=-1,this.command=null,this.previousCommand=null,this.start=new ft(0,0),this.control=new ft(0,0),this.current=new ft(0,0),this.points=[],this.angles=[]}isEnd(){const{i:t,commands:n}=this;return t>=n.length-1}next(){const t=this.commands[++this.i];return this.previousCommand=this.command,this.command=t,t}getPoint(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"x",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"y";const e=new ft(this.command[t],this.command[n]);return this.makeAbsolute(e)}getAsControlPoint(t,n){const e=this.getPoint(t,n);return this.control=e,e}getAsCurrentPoint(t,n){const e=this.getPoint(t,n);return this.current=e,e}getReflectedControlPoint(){const t=this.previousCommand.type;if(t!==A.CURVE_TO&&t!==A.SMOOTH_CURVE_TO&&t!==A.QUAD_TO&&t!==A.SMOOTH_QUAD_TO)return this.current;const{current:{x:n,y:e},control:{x:r,y:i}}=this;return new ft(2*n-r,2*e-i)}makeAbsolute(t){if(this.command.relative){const{x:n,y:e}=this.current;t.x+=n,t.y+=e}return t}addMarker(t,n,e){const{points:r,angles:i}=this;e&&i.length>0&&!i[i.length-1]&&(i[i.length-1]=r[r.length-1].angleTo(e)),this.addMarkerAngle(t,n?n.angleTo(t):null)}addMarkerAngle(t,n){this.points.push(t),this.angles.push(n)}getMarkerPoints(){return this.points}getMarkerAngles(){const{angles:t}=this,n=t.length;for(let e=0;e<n;e++)if(!t[e])for(let r=e+1;r<n;r++)if(t[r]){t[e]=t[r];break}return t}constructor(t){super(t.replace(/([+\-.])\s+/gm,"$1").replace(/[^MmZzLlHhVvCcSsQqTtAae\d\s.,+-].*/g,"")),this.control=new ft(0,0),this.start=new ft(0,0),this.current=new ft(0,0),this.command=null,this.commands=this.commands,this.i=-1,this.previousCommand=null,this.points=[],this.angles=[]}}class jt extends It{path(t){const{pathParser:n}=this,e=new Pt;for(n.reset(),t&&t.beginPath();!n.isEnd();)switch(n.next().type){case Dt.MOVE_TO:this.pathM(t,e);break;case Dt.LINE_TO:this.pathL(t,e);break;case Dt.HORIZ_LINE_TO:this.pathH(t,e);break;case Dt.VERT_LINE_TO:this.pathV(t,e);break;case Dt.CURVE_TO:this.pathC(t,e);break;case Dt.SMOOTH_CURVE_TO:this.pathS(t,e);break;case Dt.QUAD_TO:this.pathQ(t,e);break;case Dt.SMOOTH_QUAD_TO:this.pathT(t,e);break;case Dt.ARC:this.pathA(t,e);break;case Dt.CLOSE_PATH:this.pathZ(t,e)}return e}getBoundingBox(t){return this.path()}getMarkers(){const{pathParser:t}=this,n=t.getMarkerPoints(),e=t.getMarkerAngles();return n.map(((t,n)=>[t,e[n]]))}renderChildren(t){this.path(t),this.document.screen.mouse.checkPath(this,t);const n=this.getStyle("fill-rule");""!==t.fillStyle&&("inherit"!==n.getString("inherit")?t.fill(n.getString()):t.fill()),""!==t.strokeStyle&&("non-scaling-stroke"===this.getAttribute("vector-effect").getString()?(t.save(),t.setTransform(1,0,0,1,0,0),t.stroke(),t.restore()):t.stroke());const e=this.getMarkers();if(e){const n=e.length-1,r=this.getStyle("marker-start"),i=this.getStyle("marker-mid"),o=this.getStyle("marker-end");if(r.isUrlDefinition()){const n=r.getDefinition(),[i,o]=e[0];n.render(t,i,o)}if(i.isUrlDefinition()){const r=i.getDefinition();for(let i=1;i<n;i++){const[n,o]=e[i];r.render(t,n,o)}}if(o.isUrlDefinition()){const r=o.getDefinition(),[i,a]=e[n];r.render(t,i,a)}}}static pathM(t){const n=t.getAsCurrentPoint();return t.start=t.current,{point:n}}pathM(t,n){const{pathParser:e}=this,{point:r}=jt.pathM(e),{x:i,y:o}=r;e.addMarker(r),n.addPoint(i,o),t&&t.moveTo(i,o)}static pathL(t){const{current:n}=t;return{current:n,point:t.getAsCurrentPoint()}}pathL(t,n){const{pathParser:e}=this,{current:r,point:i}=jt.pathL(e),{x:o,y:a}=i;e.addMarker(i,r),n.addPoint(o,a),t&&t.lineTo(o,a)}static pathH(t){const{current:n,command:e}=t,r=new ft((e.relative?n.x:0)+e.x,n.y);return t.current=r,{current:n,point:r}}pathH(t,n){const{pathParser:e}=this,{current:r,point:i}=jt.pathH(e),{x:o,y:a}=i;e.addMarker(i,r),n.addPoint(o,a),t&&t.lineTo(o,a)}static pathV(t){const{current:n,command:e}=t,r=new ft(n.x,(e.relative?n.y:0)+e.y);return t.current=r,{current:n,point:r}}pathV(t,n){const{pathParser:e}=this,{current:r,point:i}=jt.pathV(e),{x:o,y:a}=i;e.addMarker(i,r),n.addPoint(o,a),t&&t.lineTo(o,a)}static pathC(t){const{current:n}=t;return{current:n,point:t.getPoint("x1","y1"),controlPoint:t.getAsControlPoint("x2","y2"),currentPoint:t.getAsCurrentPoint()}}pathC(t,n){const{pathParser:e}=this,{current:r,point:i,controlPoint:o,currentPoint:a}=jt.pathC(e);e.addMarker(a,o,i),n.addBezierCurve(r.x,r.y,i.x,i.y,o.x,o.y,a.x,a.y),t&&t.bezierCurveTo(i.x,i.y,o.x,o.y,a.x,a.y)}static pathS(t){const{current:n}=t;return{current:n,point:t.getReflectedControlPoint(),controlPoint:t.getAsControlPoint("x2","y2"),currentPoint:t.getAsCurrentPoint()}}pathS(t,n){const{pathParser:e}=this,{current:r,point:i,controlPoint:o,currentPoint:a}=jt.pathS(e);e.addMarker(a,o,i),n.addBezierCurve(r.x,r.y,i.x,i.y,o.x,o.y,a.x,a.y),t&&t.bezierCurveTo(i.x,i.y,o.x,o.y,a.x,a.y)}static pathQ(t){const{current:n}=t;return{current:n,controlPoint:t.getAsControlPoint("x1","y1"),currentPoint:t.getAsCurrentPoint()}}pathQ(t,n){const{pathParser:e}=this,{current:r,controlPoint:i,currentPoint:o}=jt.pathQ(e);e.addMarker(o,i,i),n.addQuadraticCurve(r.x,r.y,i.x,i.y,o.x,o.y),t&&t.quadraticCurveTo(i.x,i.y,o.x,o.y)}static pathT(t){const{current:n}=t,e=t.getReflectedControlPoint();t.control=e;return{current:n,controlPoint:e,currentPoint:t.getAsCurrentPoint()}}pathT(t,n){const{pathParser:e}=this,{current:r,controlPoint:i,currentPoint:o}=jt.pathT(e);e.addMarker(o,i,i),n.addQuadraticCurve(r.x,r.y,i.x,i.y,o.x,o.y),t&&t.quadraticCurveTo(i.x,i.y,o.x,o.y)}static pathA(t){const{current:n,command:e}=t;let{rX:r,rY:i,xRot:o,lArcFlag:a,sweepFlag:u}=e;const c=o*(Math.PI/180),s=t.getAsCurrentPoint(),f=new ft(Math.cos(c)*(n.x-s.x)/2+Math.sin(c)*(n.y-s.y)/2,-Math.sin(c)*(n.x-s.x)/2+Math.cos(c)*(n.y-s.y)/2),l=Math.pow(f.x,2)/Math.pow(r,2)+Math.pow(f.y,2)/Math.pow(i,2);l>1&&(r*=Math.sqrt(l),i*=Math.sqrt(l));let h=(a===u?-1:1)*Math.sqrt((Math.pow(r,2)*Math.pow(i,2)-Math.pow(r,2)*Math.pow(f.y,2)-Math.pow(i,2)*Math.pow(f.x,2))/(Math.pow(r,2)*Math.pow(f.y,2)+Math.pow(i,2)*Math.pow(f.x,2)));isNaN(h)&&(h=0);const d=new ft(h*r*f.y/i,h*-i*f.x/r),p=new ft((n.x+s.x)/2+Math.cos(c)*d.x-Math.sin(c)*d.y,(n.y+s.y)/2+Math.sin(c)*d.x+Math.cos(c)*d.y),y=J([1,0],[(f.x-d.x)/r,(f.y-d.y)/i]),g=[(f.x-d.x)/r,(f.y-d.y)/i],v=[(-f.x-d.x)/r,(-f.y-d.y)/i];let m=J(g,v);return K(g,v)<=-1&&(m=Math.PI),K(g,v)>=1&&(m=0),{currentPoint:s,rX:r,rY:i,sweepFlag:u,xAxisRotation:c,centp:p,a1:y,ad:m}}pathA(t,n){const{pathParser:e}=this,{currentPoint:r,rX:i,rY:o,sweepFlag:a,xAxisRotation:u,centp:c,a1:s,ad:f}=jt.pathA(e),l=1-a?1:-1,h=s+l*(f/2),d=new ft(c.x+i*Math.cos(h),c.y+o*Math.sin(h));if(e.addMarkerAngle(d,h-l*Math.PI/2),e.addMarkerAngle(r,h-l*Math.PI),n.addPoint(r.x,r.y),t&&!isNaN(s)&&!isNaN(f)){const n=i>o?i:o,e=i>o?1:i/o,r=i>o?o/i:1;t.translate(c.x,c.y),t.rotate(u),t.scale(e,r),t.arc(0,0,n,s,s+f,Boolean(1-a)),t.scale(1/e,1/r),t.rotate(-u),t.translate(-c.x,-c.y)}}static pathZ(t){t.current=t.start}pathZ(t,n){jt.pathZ(this.pathParser),t&&n.x1!==n.x2&&n.y1!==n.y2&&t.closePath()}constructor(t,n,e){super(t,n,e),this.type="path",this.pathParser=new Dt(this.getAttribute("d").getString())}}class Lt extends It{setContext(t){var n;const{document:e}=this,{screen:r,window:i}=e,o=t.canvas;if(r.setDefaults(t),"style"in o&&void 0!==t.font&&i&&void 0!==i.getComputedStyle){t.font=i.getComputedStyle(o).getPropertyValue("font");const n=new ut(e,"fontSize",Ot.parse(t.font).fontSize);n.hasValue()&&(e.rootEmSize=n.getPixels("y"),e.emSize=e.rootEmSize)}this.getAttribute("x").hasValue()||this.getAttribute("x",!0).setValue(0),this.getAttribute("y").hasValue()||this.getAttribute("y",!0).setValue(0);let{width:a,height:u}=r.viewPort;this.getStyle("width").hasValue()||this.getStyle("width",!0).setValue("100%"),this.getStyle("height").hasValue()||this.getStyle("height",!0).setValue("100%"),this.getStyle("color").hasValue()||this.getStyle("color",!0).setValue("black");const c=this.getAttribute("refX"),s=this.getAttribute("refY"),f=this.getAttribute("viewBox"),l=f.hasValue()?z(f.getString()):null,h=!this.root&&"visible"!==this.getStyle("overflow").getValue("hidden");let d=0,p=0,y=0,g=0;l&&(d=l[0],p=l[1]),this.root||(a=this.getStyle("width").getPixels("x"),u=this.getStyle("height").getPixels("y"),"marker"===this.type&&(y=d,g=p,d=0,p=0)),r.viewPort.setCurrent(a,u),!this.node||this.parent&&"foreignObject"!==(null===(n=this.node.parentNode)||void 0===n?void 0:n.nodeName)||!this.getStyle("transform",!1,!0).hasValue()||this.getStyle("transform-origin",!1,!0).hasValue()||this.getStyle("transform-origin",!0,!0).setValue("50% 50%"),super.setContext(t),t.translate(this.getAttribute("x").getPixels("x"),this.getAttribute("y").getPixels("y")),l&&(a=l[2],u=l[3]),e.setViewBox({ctx:t,aspectRatio:this.getAttribute("preserveAspectRatio").getString(),width:r.viewPort.width,desiredWidth:a,height:r.viewPort.height,desiredHeight:u,minX:d,minY:p,refX:c.getValue(),refY:s.getValue(),clip:h,clipX:y,clipY:g}),l&&(r.viewPort.removeCurrent(),r.viewPort.setCurrent(a,u))}clearContext(t){super.clearContext(t),this.document.screen.viewPort.removeCurrent()}resize(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,e=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=this.getAttribute("width",!0),i=this.getAttribute("height",!0),o=this.getAttribute("viewBox"),a=this.getAttribute("style"),u=r.getNumber(0),c=i.getNumber(0);if(e)if("string"==typeof e)this.getAttribute("preserveAspectRatio",!0).setValue(e);else{const t=this.getAttribute("preserveAspectRatio");t.hasValue()&&t.setValue(t.getString().replace(/^\s*(\S.*\S)\s*$/,"$1"))}if(r.setValue(t),i.setValue(n),o.hasValue()||o.setValue("0 0 ".concat(u||t," ").concat(c||n)),a.hasValue()){const e=this.getStyle("width"),r=this.getStyle("height");e.hasValue()&&e.setValue("".concat(t,"px")),r.hasValue()&&r.setValue("".concat(n,"px"))}}constructor(...t){super(...t),this.type="svg",this.root=!1}}class Ut extends jt{path(t){const n=this.getAttribute("x").getPixels("x"),e=this.getAttribute("y").getPixels("y"),r=this.getStyle("width",!1,!0).getPixels("x"),i=this.getStyle("height",!1,!0).getPixels("y"),o=this.getAttribute("rx"),a=this.getAttribute("ry");let u=o.getPixels("x"),c=a.getPixels("y");if(o.hasValue()&&!a.hasValue()&&(c=u),a.hasValue()&&!o.hasValue()&&(u=c),u=Math.min(u,r/2),c=Math.min(c,i/2),t){const o=(Math.sqrt(2)-1)/3*4;t.beginPath(),i>0&&r>0&&(t.moveTo(n+u,e),t.lineTo(n+r-u,e),t.bezierCurveTo(n+r-u+o*u,e,n+r,e+c-o*c,n+r,e+c),t.lineTo(n+r,e+i-c),t.bezierCurveTo(n+r,e+i-c+o*c,n+r-u+o*u,e+i,n+r-u,e+i),t.lineTo(n+u,e+i),t.bezierCurveTo(n+u-o*u,e+i,n,e+i-c+o*c,n,e+i-c),t.lineTo(n,e+c),t.bezierCurveTo(n,e+c-o*c,n+u-o*u,e,n+u,e),t.closePath())}return new Pt(n,e,n+r,e+i)}getMarkers(){return null}constructor(...t){super(...t),this.type="rect"}}class Bt extends jt{path(t){const n=this.getAttribute("cx").getPixels("x"),e=this.getAttribute("cy").getPixels("y"),r=this.getAttribute("r").getPixels();return t&&r>0&&(t.beginPath(),t.arc(n,e,r,0,2*Math.PI,!1),t.closePath()),new Pt(n-r,e-r,n+r,e+r)}getMarkers(){return null}constructor(...t){super(...t),this.type="circle"}}class Ft extends jt{path(t){const n=(Math.sqrt(2)-1)/3*4,e=this.getAttribute("rx").getPixels("x"),r=this.getAttribute("ry").getPixels("y"),i=this.getAttribute("cx").getPixels("x"),o=this.getAttribute("cy").getPixels("y");return t&&e>0&&r>0&&(t.beginPath(),t.moveTo(i+e,o),t.bezierCurveTo(i+e,o+n*r,i+n*e,o+r,i,o+r),t.bezierCurveTo(i-n*e,o+r,i-e,o+n*r,i-e,o),t.bezierCurveTo(i-e,o-n*r,i-n*e,o-r,i,o-r),t.bezierCurveTo(i+n*e,o-r,i+e,o-n*r,i+e,o),t.closePath()),new Pt(i-e,o-r,i+e,o+r)}getMarkers(){return null}constructor(...t){super(...t),this.type="ellipse"}}class qt extends jt{getPoints(){return[new ft(this.getAttribute("x1").getPixels("x"),this.getAttribute("y1").getPixels("y")),new ft(this.getAttribute("x2").getPixels("x"),this.getAttribute("y2").getPixels("y"))]}path(t){const[{x:n,y:e},{x:r,y:i}]=this.getPoints();return t&&(t.beginPath(),t.moveTo(n,e),t.lineTo(r,i)),new Pt(n,e,r,i)}getMarkers(){const[t,n]=this.getPoints(),e=t.angleTo(n);return[[t,e],[n,e]]}constructor(...t){super(...t),this.type="line"}}class Ht extends jt{path(t){const{points:n}=this,[{x:e,y:r}]=n,i=new Pt(e,r);return t&&(t.beginPath(),t.moveTo(e,r)),n.forEach((n=>{let{x:e,y:r}=n;i.addPoint(e,r),t&&t.lineTo(e,r)})),i}getMarkers(){const{points:t}=this,n=t.length-1,e=[];return t.forEach(((r,i)=>{i!==n&&e.push([r,r.angleTo(t[i+1])])})),e.length>0&&e.push([t[t.length-1],e[e.length-1][1]]),e}constructor(t,n,e){super(t,n,e),this.type="polyline",this.points=[],this.points=ft.parsePath(this.getAttribute("points").getString())}}class Yt extends Ht{path(t){const n=super.path(t),[{x:e,y:r}]=this.points;return t&&(t.lineTo(e,r),t.closePath()),n}constructor(...t){super(...t),this.type="polygon"}}class Xt extends Tt{createPattern(t,n,e){const r=this.getStyle("width").getPixels("x",!0),i=this.getStyle("height").getPixels("y",!0),o=new Lt(this.document,null);o.attributes.viewBox=new ut(this.document,"viewBox",this.getAttribute("viewBox").getValue()),o.attributes.width=new ut(this.document,"width","".concat(r,"px")),o.attributes.height=new ut(this.document,"height","".concat(i,"px")),o.attributes.transform=new ut(this.document,"transform",this.getAttribute("patternTransform").getValue()),o.children=this.children;const a=this.document.createCanvas(r,i),u=a.getContext("2d"),c=this.getAttribute("x"),s=this.getAttribute("y");c.hasValue()&&s.hasValue()&&u.translate(c.getPixels("x",!0),s.getPixels("y",!0)),e.hasValue()?this.styles["fill-opacity"]=e:Reflect.deleteProperty(this.styles,"fill-opacity");for(let t=-1;t<=1;t++)for(let n=-1;n<=1;n++)u.save(),o.attributes.x=new ut(this.document,"x",t*a.width),o.attributes.y=new ut(this.document,"y",n*a.height),o.render(u),u.restore();return t.createPattern(a,"repeat")}constructor(...t){super(...t),this.type="pattern"}}class $t extends Tt{render(t,n,e){if(!n)return;const{x:r,y:i}=n,o=this.getAttribute("orient").getString("auto"),a=this.getAttribute("markerUnits").getString("strokeWidth");t.translate(r,i),"auto"===o&&t.rotate(e),"strokeWidth"===a&&t.scale(t.lineWidth,t.lineWidth),t.save();const u=new Lt(this.document);u.type=this.type,u.attributes.viewBox=new ut(this.document,"viewBox",this.getAttribute("viewBox").getValue()),u.attributes.refX=new ut(this.document,"refX",this.getAttribute("refX").getValue()),u.attributes.refY=new ut(this.document,"refY",this.getAttribute("refY").getValue()),u.attributes.width=new ut(this.document,"width",this.getAttribute("markerWidth").getValue()),u.attributes.height=new ut(this.document,"height",this.getAttribute("markerHeight").getValue()),u.attributes.overflow=new ut(this.document,"overflow",this.getAttribute("overflow").getValue()),u.attributes.fill=new ut(this.document,"fill",this.getAttribute("fill").getColor("black")),u.attributes.stroke=new ut(this.document,"stroke",this.getAttribute("stroke").getValue("none")),u.children=this.children,u.render(t),t.restore(),"strokeWidth"===a&&t.scale(1/t.lineWidth,1/t.lineWidth),"auto"===o&&t.rotate(-e),t.translate(-r,-i)}constructor(...t){super(...t),this.type="marker"}}class Wt extends Tt{render(){}constructor(...t){super(...t),this.type="defs"}}class Gt extends It{getBoundingBox(t){const n=new Pt;return this.children.forEach((e=>{n.addBoundingBox(e.getBoundingBox(t))})),n}constructor(...t){super(...t),this.type="g"}}class Qt extends Tt{getGradientUnits(){return this.getAttribute("gradientUnits").getString("objectBoundingBox")}createGradient(t,n,e){let r=this;this.getHrefAttribute().hasValue()&&(r=this.getHrefAttribute().getDefinition(),this.inheritStopContainer(r));const{stops:i}=r,o=this.getGradient(t,n);if(!o)return this.addParentOpacity(e,i[i.length-1].color);if(i.forEach((t=>{o.addColorStop(t.offset,this.addParentOpacity(e,t.color))})),this.getAttribute("gradientTransform").hasValue()){const{document:t}=this,{MAX_VIRTUAL_PIXELS:n}=pt,{viewPort:e}=t.screen,r=e.getRoot(),i=new Ut(t);i.attributes.x=new ut(t,"x",-n/3),i.attributes.y=new ut(t,"y",-n/3),i.attributes.width=new ut(t,"width",n),i.attributes.height=new ut(t,"height",n);const a=new Gt(t);a.attributes.transform=new ut(t,"transform",this.getAttribute("gradientTransform").getValue()),a.children=[i];const u=new Lt(t);u.attributes.x=new ut(t,"x",0),u.attributes.y=new ut(t,"y",0),u.attributes.width=new ut(t,"width",r.width),u.attributes.height=new ut(t,"height",r.height),u.children=[a];const c=t.createCanvas(r.width,r.height),s=c.getContext("2d");return s.fillStyle=o,u.render(s),s.createPattern(c,"no-repeat")}return o}inheritStopContainer(t){this.attributesToInherit.forEach((n=>{!this.getAttribute(n).hasValue()&&t.getAttribute(n).hasValue()&&this.getAttribute(n,!0).setValue(t.getAttribute(n).getValue())}))}addParentOpacity(t,n){if(t.hasValue()){return new ut(this.document,"color",n).addOpacity(t).getColor()}return n}constructor(t,n,e){super(t,n,e),this.attributesToInherit=["gradientUnits"],this.stops=[];const{stops:r,children:i}=this;i.forEach((t=>{"stop"===t.type&&r.push(t)}))}}class Zt extends Qt{getGradient(t,n){const e="objectBoundingBox"===this.getGradientUnits(),r=e?n.getBoundingBox(t):null;if(e&&!r)return null;this.getAttribute("x1").hasValue()||this.getAttribute("y1").hasValue()||this.getAttribute("x2").hasValue()||this.getAttribute("y2").hasValue()||(this.getAttribute("x1",!0).setValue(0),this.getAttribute("y1",!0).setValue(0),this.getAttribute("x2",!0).setValue(1),this.getAttribute("y2",!0).setValue(0));const i=e?r.x+r.width*this.getAttribute("x1").getNumber():this.getAttribute("x1").getPixels("x"),o=e?r.y+r.height*this.getAttribute("y1").getNumber():this.getAttribute("y1").getPixels("y"),a=e?r.x+r.width*this.getAttribute("x2").getNumber():this.getAttribute("x2").getPixels("x"),u=e?r.y+r.height*this.getAttribute("y2").getNumber():this.getAttribute("y2").getPixels("y");return i===a&&o===u?null:t.createLinearGradient(i,o,a,u)}constructor(t,n,e){super(t,n,e),this.type="linearGradient",this.attributesToInherit.push("x1","y1","x2","y2")}}class Kt extends Qt{getGradient(t,n){const e="objectBoundingBox"===this.getGradientUnits(),r=n.getBoundingBox(t);if(e&&!r)return null;this.getAttribute("cx").hasValue()||this.getAttribute("cx",!0).setValue("50%"),this.getAttribute("cy").hasValue()||this.getAttribute("cy",!0).setValue("50%"),this.getAttribute("r").hasValue()||this.getAttribute("r",!0).setValue("50%");const i=e?r.x+r.width*this.getAttribute("cx").getNumber():this.getAttribute("cx").getPixels("x"),o=e?r.y+r.height*this.getAttribute("cy").getNumber():this.getAttribute("cy").getPixels("y");let a=i,u=o;this.getAttribute("fx").hasValue()&&(a=e?r.x+r.width*this.getAttribute("fx").getNumber():this.getAttribute("fx").getPixels("x")),this.getAttribute("fy").hasValue()&&(u=e?r.y+r.height*this.getAttribute("fy").getNumber():this.getAttribute("fy").getPixels("y"));const c=e?(r.width+r.height)/2*this.getAttribute("r").getNumber():this.getAttribute("r").getPixels(),s=this.getAttribute("fr").getPixels();return t.createRadialGradient(a,u,s,i,o,c)}constructor(t,n,e){super(t,n,e),this.type="radialGradient",this.attributesToInherit.push("cx","cy","r","fx","fy","fr")}}class Jt extends Tt{constructor(t,n,e){super(t,n,e),this.type="stop";const r=Math.max(0,Math.min(1,this.getAttribute("offset").getNumber())),i=this.getStyle("stop-opacity");let o=this.getStyle("stop-color",!0);""===o.getString()&&o.setValue("#000"),i.hasValue()&&(o=o.addOpacity(i)),this.offset=r,this.color=o.getColor()}}class tn extends Tt{getProperty(){const t=this.getAttribute("attributeType").getString(),n=this.getAttribute("attributeName").getString();return"CSS"===t?this.parent.getStyle(n,!0):this.parent.getAttribute(n,!0)}calcValue(){const{initialUnits:t}=this,{progress:n,from:e,to:r}=this.getProgress();let i=e.getNumber()+(r.getNumber()-e.getNumber())*n;return"%"===t&&(i*=100),"".concat(i).concat(t)}update(t){const{parent:n}=this,e=this.getProperty();if(this.initialValue||(this.initialValue=e.getString(),this.initialUnits=e.getUnits()),this.duration>this.maxDuration){const t=this.getAttribute("fill").getString("remove");if("indefinite"===this.getAttribute("repeatCount").getString()||"indefinite"===this.getAttribute("repeatDur").getString())this.duration=0;else if("freeze"!==t||this.frozen){if("remove"===t&&!this.removed)return this.removed=!0,n&&e&&e.setValue(n.animationFrozen?n.animationFrozenValue:this.initialValue),!0}else this.frozen=!0,n&&e&&(n.animationFrozen=!0,n.animationFrozenValue=e.getString());return!1}this.duration+=t;let r=!1;if(this.begin<this.duration){let t=this.calcValue();const n=this.getAttribute("type");if(n.hasValue()){const e=n.getString();t="".concat(e,"(").concat(t,")")}e.setValue(t),r=!0}return r}getProgress(){const{document:t,values:n}=this;let e,r,i=(this.duration-this.begin)/(this.maxDuration-this.begin);if(n.hasValue()){const o=i*(n.getValue().length-1),a=Math.floor(o),u=Math.ceil(o);let c;c=n.getValue()[a],e=new ut(t,"from",c?parseFloat(c):0),c=n.getValue()[u],r=new ut(t,"to",c?parseFloat(c):0),i=(o-a)/(u-a)}else e=this.from,r=this.to;return{progress:i,from:e,to:r}}constructor(t,n,e){super(t,n,e),this.type="animate",this.duration=0,this.initialUnits="",this.removed=!1,this.frozen=!1,t.screen.animations.push(this),this.begin=this.getAttribute("begin").getMilliseconds(),this.maxDuration=this.begin+this.getAttribute("dur").getMilliseconds(),this.from=this.getAttribute("from"),this.to=this.getAttribute("to"),this.values=new ut(t,"values",null);const r=this.getAttribute("values");r.hasValue()&&this.values.setValue(r.getString().split(";"))}}class nn extends tn{calcValue(){const{progress:t,from:n,to:e}=this.getProgress(),r=new i(n.getColor()),o=new i(e.getColor());if(r.ok&&o.ok){const n=r.r+(o.r-r.r)*t,e=r.g+(o.g-r.g)*t,i=r.b+(o.b-r.b)*t;return"rgb(".concat(Math.floor(n),", ").concat(Math.floor(e),", ").concat(Math.floor(i),")")}return this.getAttribute("from").getColor()}constructor(...t){super(...t),this.type="animateColor"}}class en extends tn{calcValue(){const{progress:t,from:n,to:e}=this.getProgress(),r=z(n.getString()),i=z(e.getString());return r.map(((n,e)=>n+(i[e]-n)*t)).join(" ")}constructor(...t){super(...t),this.type="animateTransform"}}class rn extends Tt{constructor(t,n,e){super(t,n,e),this.type="font-face",this.ascent=this.getAttribute("ascent").getNumber(),this.descent=this.getAttribute("descent").getNumber(),this.unitsPerEm=this.getAttribute("units-per-em").getNumber()}}class on extends jt{constructor(t,n,e){super(t,n,e),this.type="glyph",this.horizAdvX=this.getAttribute("horiz-adv-x").getNumber(),this.unicode=this.getAttribute("unicode").getString(),this.arabicForm=this.getAttribute("arabic-form").getString()}}class an extends on{constructor(...t){super(...t),this.type="missing-glyph",this.horizAdvX=0}}class un extends Tt{render(){}constructor(t,n,e){super(t,n,e),this.type="font",this.isArabic=!1,this.glyphs={},this.arabicGlyphs={},this.isRTL=!1,this.horizAdvX=this.getAttribute("horiz-adv-x").getNumber();const{definitions:r}=t,{children:i}=this;for(const t of i)if(t instanceof rn){this.fontFace=t;const n=t.getStyle("font-family");n.hasValue()&&(r[n.getString()]=this)}else if(t instanceof an)this.missingGlyph=t;else if(t instanceof on)if(t.arabicForm){this.isRTL=!0,this.isArabic=!0;const n=this.arabicGlyphs[t.unicode];void 0===n?this.arabicGlyphs[t.unicode]={[t.arabicForm]:t}:n[t.arabicForm]=t}else this.glyphs[t.unicode]=t}}class cn extends Rt{getText(){const t=this.getHrefAttribute().getDefinition();if(t){const n=t.children[0];if(n)return n.getText()}return""}constructor(...t){super(...t),this.type="tref"}}class sn extends Rt{getText(){return this.text}renderChildren(t){if(this.hasText){super.renderChildren(t);const{document:n,x:e,y:r}=this,{mouse:i}=n.screen,o=new ut(n,"fontSize",Ot.parse(n.ctx.font).fontSize);i.isWorking()&&i.checkBoundingBox(this,new Pt(e,r-o.getPixels("y"),e+this.measureText(t),r))}else if(this.children.length>0){const n=new Gt(this.document);n.children=this.children,n.parent=this,n.render(t)}}onClick(){const{window:t}=this.document;t&&t.open(this.getHrefAttribute().getString())}onMouseMove(){this.document.ctx.canvas.style.cursor="pointer"}constructor(t,n,e){super(t,n,e),this.type="a";const{childNodes:r}=n,i=r[0],o=r.length>0&&Array.from(r).every((t=>3===t.nodeType));this.hasText=o,this.text=o?this.getTextFromNode(i):""}}class fn extends Rt{getText(){return this.text}path(t){const{dataArray:n}=this;t&&t.beginPath(),n.forEach((n=>{let{type:e,points:r}=n;switch(e){case Dt.LINE_TO:t&&t.lineTo(r[0],r[1]);break;case Dt.MOVE_TO:t&&t.moveTo(r[0],r[1]);break;case Dt.CURVE_TO:t&&t.bezierCurveTo(r[0],r[1],r[2],r[3],r[4],r[5]);break;case Dt.QUAD_TO:t&&t.quadraticCurveTo(r[0],r[1],r[2],r[3]);break;case Dt.ARC:{const[n,e,i,o,a,u,c,s]=r,f=i>o?i:o,l=i>o?1:i/o,h=i>o?o/i:1;t&&(t.translate(n,e),t.rotate(c),t.scale(l,h),t.arc(0,0,f,a,a+u,Boolean(1-s)),t.scale(1/l,1/h),t.rotate(-c),t.translate(-n,-e));break}case Dt.CLOSE_PATH:t&&t.closePath()}}))}renderChildren(t){this.setTextData(t),t.save();const n=this.parent.getStyle("text-decoration").getString(),e=this.getFontSize(),{glyphInfo:r}=this,i=t.fillStyle;"underline"===n&&t.beginPath(),r.forEach(((r,i)=>{const{p0:o,p1:a,rotation:u,text:c}=r;t.save(),t.translate(o.x,o.y),t.rotate(u),t.fillStyle&&t.fillText(c,0,0),t.strokeStyle&&t.strokeText(c,0,0),t.restore(),"underline"===n&&(0===i&&t.moveTo(o.x,o.y+e/8),t.lineTo(a.x,a.y+e/5))})),"underline"===n&&(t.lineWidth=e/20,t.strokeStyle=i,t.stroke(),t.closePath()),t.restore()}getLetterSpacingAt(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.letterSpacingCache[t]||0}findSegmentToFitChar(t,n,e,r,i,o,a,u,c){let s=o,f=this.measureText(t,u);" "===u&&"justify"===n&&e<r&&(f+=(r-e)/i),c>-1&&(s+=this.getLetterSpacingAt(c));const l=this.textHeight/20,h=this.getEquidistantPointOnPath(s,l,0),d=this.getEquidistantPointOnPath(s+f,l,0),p={p0:h,p1:d},y=h&&d?Math.atan2(d.y-h.y,d.x-h.x):0;if(a){const t=Math.cos(Math.PI/2+y)*a,n=Math.cos(-y)*a;p.p0={...h,x:h.x+t,y:h.y+n},p.p1={...d,x:d.x+t,y:d.y+n}}return s+=f,{offset:s,segment:p,rotation:y}}measureText(t,n){const{measuresCache:e}=this,r=n||this.getText();if(e.has(r))return e.get(r);const i=this.measureTargetText(t,r);return e.set(r,i),i}setTextData(t){if(this.glyphInfo)return;const n=this.getText(),e=n.split(""),r=n.split(" ").length-1,i=this.parent.getAttribute("dx").split().map((t=>t.getPixels("x"))),o=this.parent.getAttribute("dy").getPixels("y"),a=this.parent.getStyle("text-anchor").getString("start"),u=this.getStyle("letter-spacing"),c=this.parent.getStyle("letter-spacing");let s=0;u.hasValue()&&"inherit"!==u.getValue()?u.hasValue()&&"initial"!==u.getValue()&&"unset"!==u.getValue()&&(s=u.getPixels()):s=c.getPixels();const f=[],l=n.length;this.letterSpacingCache=f;for(let t=0;t<l;t++)f.push(void 0!==i[t]?i[t]:s);const h=f.reduce(((t,n,e)=>0===e?0:t+n||0),0),d=this.measureText(t),p=Math.max(d+h,0);this.textWidth=d,this.textHeight=this.getFontSize(),this.glyphInfo=[];const y=this.getPathLength(),g=this.getStyle("startOffset").getNumber(0)*y;let v=0;"middle"!==a&&"center"!==a||(v=-p/2),"end"!==a&&"right"!==a||(v=-p),v+=g,e.forEach(((n,i)=>{const{offset:u,segment:c,rotation:s}=this.findSegmentToFitChar(t,a,p,y,r,v,o,n,i);v=u,c.p0&&c.p1&&this.glyphInfo.push({text:e[i],p0:c.p0,p1:c.p1,rotation:s})}))}parsePathData(t){if(this.pathLength=-1,!t)return[];const n=[],{pathParser:e}=t;for(e.reset();!e.isEnd();){const{current:t}=e,r=t?t.x:0,i=t?t.y:0,o=e.next();let a=o.type,u=[];switch(o.type){case Dt.MOVE_TO:this.pathM(e,u);break;case Dt.LINE_TO:a=this.pathL(e,u);break;case Dt.HORIZ_LINE_TO:a=this.pathH(e,u);break;case Dt.VERT_LINE_TO:a=this.pathV(e,u);break;case Dt.CURVE_TO:this.pathC(e,u);break;case Dt.SMOOTH_CURVE_TO:a=this.pathS(e,u);break;case Dt.QUAD_TO:this.pathQ(e,u);break;case Dt.SMOOTH_QUAD_TO:a=this.pathT(e,u);break;case Dt.ARC:u=this.pathA(e);break;case Dt.CLOSE_PATH:jt.pathZ(e)}o.type!==Dt.CLOSE_PATH?n.push({type:a,points:u,start:{x:r,y:i},pathLength:this.calcLength(r,i,a,u)}):n.push({type:Dt.CLOSE_PATH,points:[],pathLength:0})}return n}pathM(t,n){const{x:e,y:r}=jt.pathM(t).point;n.push(e,r)}pathL(t,n){const{x:e,y:r}=jt.pathL(t).point;return n.push(e,r),Dt.LINE_TO}pathH(t,n){const{x:e,y:r}=jt.pathH(t).point;return n.push(e,r),Dt.LINE_TO}pathV(t,n){const{x:e,y:r}=jt.pathV(t).point;return n.push(e,r),Dt.LINE_TO}pathC(t,n){const{point:e,controlPoint:r,currentPoint:i}=jt.pathC(t);n.push(e.x,e.y,r.x,r.y,i.x,i.y)}pathS(t,n){const{point:e,controlPoint:r,currentPoint:i}=jt.pathS(t);return n.push(e.x,e.y,r.x,r.y,i.x,i.y),Dt.CURVE_TO}pathQ(t,n){const{controlPoint:e,currentPoint:r}=jt.pathQ(t);n.push(e.x,e.y,r.x,r.y)}pathT(t,n){const{controlPoint:e,currentPoint:r}=jt.pathT(t);return n.push(e.x,e.y,r.x,r.y),Dt.QUAD_TO}pathA(t){let{rX:n,rY:e,sweepFlag:r,xAxisRotation:i,centp:o,a1:a,ad:u}=jt.pathA(t);return 0===r&&u>0&&(u-=2*Math.PI),1===r&&u<0&&(u+=2*Math.PI),[o.x,o.y,n,e,a,u,i,r]}calcLength(t,n,e,r){let i=0,o=null,a=null,u=0;switch(e){case Dt.LINE_TO:return this.getLineLength(t,n,r[0],r[1]);case Dt.CURVE_TO:for(i=0,o=this.getPointOnCubicBezier(0,t,n,r[0],r[1],r[2],r[3],r[4],r[5]),u=.01;u<=1;u+=.01)a=this.getPointOnCubicBezier(u,t,n,r[0],r[1],r[2],r[3],r[4],r[5]),i+=this.getLineLength(o.x,o.y,a.x,a.y),o=a;return i;case Dt.QUAD_TO:for(i=0,o=this.getPointOnQuadraticBezier(0,t,n,r[0],r[1],r[2],r[3]),u=.01;u<=1;u+=.01)a=this.getPointOnQuadraticBezier(u,t,n,r[0],r[1],r[2],r[3]),i+=this.getLineLength(o.x,o.y,a.x,a.y),o=a;return i;case Dt.ARC:{i=0;const t=r[4],n=r[5],e=r[4]+n;let c=Math.PI/180;if(Math.abs(t-e)<c&&(c=Math.abs(t-e)),o=this.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],t,0),n<0)for(u=t-c;u>e;u-=c)a=this.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],u,0),i+=this.getLineLength(o.x,o.y,a.x,a.y),o=a;else for(u=t+c;u<e;u+=c)a=this.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],u,0),i+=this.getLineLength(o.x,o.y,a.x,a.y),o=a;return a=this.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],e,0),i+=this.getLineLength(o.x,o.y,a.x,a.y),i}}return 0}getPointOnLine(t,n,e,r,i){let o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:n,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:e;const u=(i-e)/(r-n+Q);let c=Math.sqrt(t*t/(1+u*u));r<n&&(c*=-1);let s=u*c,f=null;if(r===n)f={x:o,y:a+s};else if((a-e)/(o-n+Q)===u)f={x:o+c,y:a+s};else{let l=0,h=0;const d=this.getLineLength(n,e,r,i);if(d<Q)return null;let p=(o-n)*(r-n)+(a-e)*(i-e);p/=d*d,l=n+p*(r-n),h=e+p*(i-e);const y=this.getLineLength(o,a,l,h),g=Math.sqrt(t*t-y*y);c=Math.sqrt(g*g/(1+u*u)),r<n&&(c*=-1),s=u*c,f={x:l+c,y:h+s}}return f}getPointOnPath(t){const n=this.getPathLength();let e=0,r=null;if(t<-5e-5||t-5e-5>n)return null;const{dataArray:i}=this;for(const n of i){if(n&&(n.pathLength<5e-5||e+n.pathLength+5e-5<t)){e+=n.pathLength;continue}const i=t-e;let o=0;switch(n.type){case Dt.LINE_TO:r=this.getPointOnLine(i,n.start.x,n.start.y,n.points[0],n.points[1],n.start.x,n.start.y);break;case Dt.ARC:{const t=n.points[4],e=n.points[5],a=n.points[4]+e;if(o=t+i/n.pathLength*e,e<0&&o<a||e>=0&&o>a)break;r=this.getPointOnEllipticalArc(n.points[0],n.points[1],n.points[2],n.points[3],o,n.points[6]);break}case Dt.CURVE_TO:o=i/n.pathLength,o>1&&(o=1),r=this.getPointOnCubicBezier(o,n.start.x,n.start.y,n.points[0],n.points[1],n.points[2],n.points[3],n.points[4],n.points[5]);break;case Dt.QUAD_TO:o=i/n.pathLength,o>1&&(o=1),r=this.getPointOnQuadraticBezier(o,n.start.x,n.start.y,n.points[0],n.points[1],n.points[2],n.points[3])}if(r)return r;break}return null}getLineLength(t,n,e,r){return Math.sqrt((e-t)*(e-t)+(r-n)*(r-n))}getPathLength(){return-1===this.pathLength&&(this.pathLength=this.dataArray.reduce(((t,n)=>n.pathLength>0?t+n.pathLength:t),0)),this.pathLength}getPointOnCubicBezier(t,n,e,r,i,o,a,u,c){return{x:u*tt(t)+o*nt(t)+r*et(t)+n*rt(t),y:c*tt(t)+a*nt(t)+i*et(t)+e*rt(t)}}getPointOnQuadraticBezier(t,n,e,r,i,o,a){return{x:o*it(t)+r*ot(t)+n*at(t),y:a*it(t)+i*ot(t)+e*at(t)}}getPointOnEllipticalArc(t,n,e,r,i,o){const a=Math.cos(o),u=Math.sin(o),c=e*Math.cos(i),s=r*Math.sin(i);return{x:t+(c*a-s*u),y:n+(c*u+s*a)}}buildEquidistantCache(t,n){const e=this.getPathLength(),r=n||.25,i=t||e/100;if(!this.equidistantCache||this.equidistantCache.step!==i||this.equidistantCache.precision!==r){this.equidistantCache={step:i,precision:r,points:[]};let t=0;for(let n=0;n<=e;n+=r){const e=this.getPointOnPath(n),o=this.getPointOnPath(n+r);e&&o&&(t+=this.getLineLength(e.x,e.y,o.x,o.y),t>=i&&(this.equidistantCache.points.push({x:e.x,y:e.y,distance:n}),t-=i))}}}getEquidistantPointOnPath(t,n,e){if(this.buildEquidistantCache(n,e),t<0||t-this.getPathLength()>5e-5)return null;const r=Math.round(t/this.getPathLength()*(this.equidistantCache.points.length-1));return this.equidistantCache.points[r]||null}constructor(t,n,e){super(t,n,e),this.type="textPath",this.textWidth=0,this.textHeight=0,this.pathLength=-1,this.glyphInfo=null,this.letterSpacingCache=[],this.measuresCache=new Map([["",0]]);const r=this.getHrefAttribute().getDefinition();this.text=this.getTextFromNode(),this.dataArray=this.parsePathData(r)}}const ln=/^\s*data:(([^/,;]+\/[^/,;]+)(?:;([^,;=]+=[^,;=]+))?)?(?:;(base64))?,(.*)$/i;class hn extends It{async loadImage(t){try{const n=await this.document.createImage(t);this.image=n}catch(t){}this.loaded=!0}async loadSvg(t){const n=ln.exec(t);if(n){const t=n[5];t&&("base64"===n[4]?this.image=atob(t):this.image=decodeURIComponent(t))}else try{const n=await this.document.fetch(t),e=await n.text();this.image=e}catch(t){}this.loaded=!0}renderChildren(t){const{document:n,image:e,loaded:r}=this,i=this.getAttribute("x").getPixels("x"),o=this.getAttribute("y").getPixels("y"),a=this.getStyle("width").getPixels("x"),u=this.getStyle("height").getPixels("y");if(r&&e&&a&&u){if(t.save(),t.translate(i,o),"string"==typeof e){const r=n.canvg.forkString(t,e,{ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0,ignoreClear:!0,offsetX:0,offsetY:0,scaleWidth:a,scaleHeight:u}),{documentElement:i}=r.document;i&&(i.parent=this),r.render()}else n.setViewBox({ctx:t,aspectRatio:this.getAttribute("preserveAspectRatio").getString(),width:a,desiredWidth:e.width,height:u,desiredHeight:e.height}),this.loaded&&("complete"in e&&!e.complete||t.drawImage(e,0,0));t.restore()}}getBoundingBox(){const t=this.getAttribute("x").getPixels("x"),n=this.getAttribute("y").getPixels("y"),e=this.getStyle("width").getPixels("x"),r=this.getStyle("height").getPixels("y");return new Pt(t,n,t+e,n+r)}constructor(t,n,e){super(t,n,e),this.type="image",this.loaded=!1;const r=this.getHrefAttribute().getString();if(!r)return;const i=r.endsWith(".svg")||/^\s*data:image\/svg\+xml/i.test(r);t.images.push(this),i?this.loadSvg(r):this.loadImage(r)}}class dn extends It{render(t){}constructor(...t){super(...t),this.type="symbol"}}class pn{async load(t,n){try{const{document:e}=this,r=(await e.canvg.parser.load(n)).getElementsByTagName("font");Array.from(r).forEach((n=>{const r=e.createElement(n);e.definitions[t]=r}))}catch(t){}this.loaded=!0}constructor(t){this.document=t,this.loaded=!1,t.fonts.push(this)}}class yn extends Tt{constructor(t,n,e){super(t,n,e),this.type="style";P(Array.from(n.childNodes).map((t=>t.textContent)).join("").replace(/(\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*+\/)|(^[\s]*\/\/.*)/gm,"").replace(/@import.*;/g,"")).split("}").forEach((n=>{const e=n.trim();if(!e)return;const r=e.split("{"),i=r[0].split(","),o=r[1].split(";");i.forEach((n=>{const e=n.trim();if(!e)return;const r=t.styles[e]||{};if(o.forEach((n=>{const e=n.indexOf(":"),i=n.substr(0,e).trim(),o=n.substr(e+1,n.length-e).trim();i&&o&&(r[i]=new ut(t,i,o))})),t.styles[e]=r,t.stylesSpecificity[e]=G(e),"@font-face"===e){const n=r["font-family"].getString().replace(/"|'/g,"");r.src.getString().split(",").forEach((e=>{if(e.indexOf('format("svg")')>0){const r=L(e);r&&new pn(t).load(n,r)}}))}}))}))}}yn.parseExternalUrl=L;class gn extends It{setContext(t){super.setContext(t);const n=this.getAttribute("x"),e=this.getAttribute("y");n.hasValue()&&t.translate(n.getPixels("x"),0),e.hasValue()&&t.translate(0,e.getPixels("y"))}path(t){const{element:n}=this;n&&n.path(t)}renderChildren(t){const{document:n,element:e}=this;if(e){let r=e;if("symbol"===e.type&&(r=new Lt(n),r.attributes.viewBox=new ut(n,"viewBox",e.getAttribute("viewBox").getString()),r.attributes.preserveAspectRatio=new ut(n,"preserveAspectRatio",e.getAttribute("preserveAspectRatio").getString()),r.attributes.overflow=new ut(n,"overflow",e.getAttribute("overflow").getString()),r.children=e.children,e.styles.opacity=new ut(n,"opacity",this.calculateOpacity())),"svg"===r.type){const t=this.getStyle("width",!1,!0),e=this.getStyle("height",!1,!0);t.hasValue()&&(r.attributes.width=new ut(n,"width",t.getString())),e.hasValue()&&(r.attributes.height=new ut(n,"height",e.getString()))}const i=r.parent;r.parent=this,r.render(t),r.parent=i}}getBoundingBox(t){const{element:n}=this;return n?n.getBoundingBox(t):null}elementTransform(){const{document:t,element:n}=this;return n?Mt.fromElement(t,n):null}get element(){return this.cachedElement||(this.cachedElement=this.getHrefAttribute().getDefinition()),this.cachedElement}constructor(...t){super(...t),this.type="use"}}function vn(t,n,e,r,i,o){return t[e*r*4+4*n+o]}function mn(t,n,e,r,i,o,a){t[e*r*4+4*n+o]=a}function bn(t,n,e){return t[n]*e}function xn(t,n,e,r){return n+Math.cos(t)*e+Math.sin(t)*r}class _n extends Tt{apply(t,n,e,r,i){const{includeOpacity:o,matrix:a}=this,u=t.getImageData(0,0,r,i);for(let t=0;t<i;t++)for(let n=0;n<r;n++){const e=vn(u.data,n,t,r,0,0),i=vn(u.data,n,t,r,0,1),c=vn(u.data,n,t,r,0,2),s=vn(u.data,n,t,r,0,3);let f=bn(a,0,e)+bn(a,1,i)+bn(a,2,c)+bn(a,3,s)+bn(a,4,1),l=bn(a,5,e)+bn(a,6,i)+bn(a,7,c)+bn(a,8,s)+bn(a,9,1),h=bn(a,10,e)+bn(a,11,i)+bn(a,12,c)+bn(a,13,s)+bn(a,14,1),d=bn(a,15,e)+bn(a,16,i)+bn(a,17,c)+bn(a,18,s)+bn(a,19,1);o&&(f=0,l=0,h=0,d*=s/255),mn(u.data,n,t,r,0,0,f),mn(u.data,n,t,r,0,1,l),mn(u.data,n,t,r,0,2,h),mn(u.data,n,t,r,0,3,d)}t.clearRect(0,0,r,i),t.putImageData(u,0,0)}constructor(t,n,e){super(t,n,e),this.type="feColorMatrix";let r=z(this.getAttribute("values").getString());switch(this.getAttribute("type").getString("matrix")){case"saturate":{const t=r[0];r=[.213+.787*t,.715-.715*t,.072-.072*t,0,0,.213-.213*t,.715+.285*t,.072-.072*t,0,0,.213-.213*t,.715-.715*t,.072+.928*t,0,0,0,0,0,1,0,0,0,0,0,1];break}case"hueRotate":{const t=r[0]*Math.PI/180;r=[xn(t,.213,.787,-.213),xn(t,.715,-.715,-.715),xn(t,.072,-.072,.928),0,0,xn(t,.213,-.213,.143),xn(t,.715,.285,.14),xn(t,.072,-.072,-.283),0,0,xn(t,.213,-.213,-.787),xn(t,.715,-.715,.715),xn(t,.072,.928,.072),0,0,0,0,0,1,0,0,0,0,0,1];break}case"luminanceToAlpha":r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.2125,.7154,.0721,0,0,0,0,0,0,1]}this.matrix=r,this.includeOpacity=this.getAttribute("includeOpacity").hasValue()}}class wn extends Tt{apply(t,n){const{document:e}=this;let r=this.getAttribute("x").getPixels("x"),i=this.getAttribute("y").getPixels("y"),o=this.getStyle("width").getPixels("x"),a=this.getStyle("height").getPixels("y");if(!o&&!a){const n=new Pt;this.children.forEach((e=>{n.addBoundingBox(e.getBoundingBox(t))})),r=Math.floor(n.x1),i=Math.floor(n.y1),o=Math.floor(n.width),a=Math.floor(n.height)}const u=this.removeStyles(n,wn.ignoreStyles),c=e.createCanvas(r+o,i+a),s=c.getContext("2d");e.screen.setDefaults(s),this.renderChildren(s),new _n(e,{nodeType:1,childNodes:[],attributes:[{nodeName:"type",value:"luminanceToAlpha"},{nodeName:"includeOpacity",value:"true"}]}).apply(s,0,0,r+o,i+a);const f=e.createCanvas(r+o,i+a),l=f.getContext("2d");e.screen.setDefaults(l),n.render(l),l.globalCompositeOperation="destination-in",l.fillStyle=s.createPattern(c,"no-repeat"),l.fillRect(0,0,r+o,i+a),t.fillStyle=l.createPattern(f,"no-repeat"),t.fillRect(0,0,r+o,i+a),this.restoreStyles(n,u)}render(t){}constructor(...t){super(...t),this.type="mask"}}wn.ignoreStyles=["mask","transform","clip-path"];const An=()=>{};class Sn extends Tt{apply(t){const{document:n}=this,e=Reflect.getPrototypeOf(t),{beginPath:r,closePath:i}=t;e&&(e.beginPath=An,e.closePath=An),Reflect.apply(r,t,[]),this.children.forEach((r=>{if(!("path"in r))return;let o="elementTransform"in r?r.elementTransform():null;o||(o=Mt.fromElement(n,r)),o&&o.apply(t),r.path(t),e&&(e.closePath=i),o&&o.unapply(t)})),Reflect.apply(i,t,[]),t.clip(),e&&(e.beginPath=r,e.closePath=i)}render(t){}constructor(...t){super(...t),this.type="clipPath"}}class Mn extends Tt{apply(t,n){const{document:e,children:r}=this,i="getBoundingBox"in n?n.getBoundingBox(t):null;if(!i)return;let o=0,a=0;r.forEach((t=>{const n=t.extraFilterDistance||0;o=Math.max(o,n),a=Math.max(a,n)}));const u=Math.floor(i.width),c=Math.floor(i.height),s=u+2*o,f=c+2*a;if(s<1||f<1)return;const l=Math.floor(i.x),h=Math.floor(i.y),d=this.removeStyles(n,Mn.ignoreStyles),p=e.createCanvas(s,f),y=p.getContext("2d");e.screen.setDefaults(y),y.translate(-l+o,-h+a),n.render(y),r.forEach((t=>{"function"==typeof t.apply&&t.apply(y,0,0,s,f)})),t.drawImage(p,0,0,s,f,l-o,h-a,s,f),this.restoreStyles(n,d)}render(t){}constructor(...t){super(...t),this.type="filter"}}Mn.ignoreStyles=["filter","transform","clip-path"];class Tn extends Tt{apply(t,n,e,r,i){}constructor(t,n,e){super(t,n,e),this.type="feDropShadow",this.addStylesFromStyleDefinition()}}class En extends Tt{apply(t,n,e,r,i){}constructor(...t){super(...t),this.type="feMorphology"}}class Cn extends Tt{apply(t,n,e,r,i){}constructor(...t){super(...t),this.type="feComposite"}}class kn extends Tt{apply(t,n,e,r,i){const{document:o,blurRadius:a}=this,u=o.window?o.window.document.body:null,c=t.canvas;c.id=o.getUniqueId(),u&&(c.style.display="none",u.appendChild(c)),k(c,n,e,r,i,a),u&&u.removeChild(c)}constructor(t,n,e){super(t,n,e),this.type="feGaussianBlur",this.blurRadius=Math.floor(this.getAttribute("stdDeviation").getNumber()),this.extraFilterDistance=this.blurRadius}}class Nn extends Tt{constructor(...t){super(...t),this.type="title"}}class On extends Tt{constructor(...t){super(...t),this.type="desc"}}const Pn={svg:Lt,rect:Ut,circle:Bt,ellipse:Ft,line:qt,polyline:Ht,polygon:Yt,path:jt,pattern:Xt,marker:$t,defs:Wt,linearGradient:Zt,radialGradient:Kt,stop:Jt,animate:tn,animateColor:nn,animateTransform:en,font:un,"font-face":rn,"missing-glyph":an,glyph:on,text:Rt,tspan:zt,tref:cn,a:sn,textPath:fn,image:hn,g:Gt,symbol:dn,style:yn,use:gn,mask:wn,clipPath:Sn,filter:Mn,feDropShadow:Tn,feMorphology:En,feComposite:Cn,feColorMatrix:_n,feGaussianBlur:kn,title:Nn,desc:On};class In{bindCreateImage(t,n){return"boolean"==typeof n?(e,r)=>t(e,"boolean"==typeof r?r:n):t}get window(){return this.screen.window}get fetch(){return this.screen.fetch}get ctx(){return this.screen.ctx}get emSize(){const{emSizeStack:t}=this;return t[t.length-1]||12}set emSize(t){const{emSizeStack:n}=this;n.push(t)}popEmSize(){const{emSizeStack:t}=this;t.pop()}getUniqueId(){return"canvg".concat(++this.uniqueId)}isImagesLoaded(){return this.images.every((t=>t.loaded))}isFontsLoaded(){return this.fonts.every((t=>t.loaded))}createDocumentElement(t){const n=this.createElement(t.documentElement);return n.root=!0,n.addStylesFromStyleDefinition(),this.documentElement=n,n}createElement(t){const n=t.nodeName.replace(/^[^:]+:/,""),e=In.elementTypes[n];return e?new e(this,t):new Et(this,t)}createTextNode(t){return new Vt(this,t)}setViewBox(t){this.screen.setViewBox({document:this,...t})}constructor(t,{rootEmSize:n=12,emSize:e=12,createCanvas:r=In.createCanvas,createImage:i=In.createImage,anonymousCrossOrigin:o}={}){this.canvg=t,this.definitions={},this.styles={},this.stylesSpecificity={},this.images=[],this.fonts=[],this.emSizeStack=[],this.uniqueId=0,this.screen=t.screen,this.rootEmSize=n,this.emSize=e,this.createCanvas=r,this.createImage=this.bindCreateImage(i,o),this.screen.wait((()=>this.isImagesLoaded())),this.screen.wait((()=>this.isFontsLoaded()))}}In.createCanvas=function(t,n){const e=document.createElement("canvas");return e.width=t,e.height=n,e},In.createImage=async function(t){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const e=document.createElement("img");return n&&(e.crossOrigin="Anonymous"),new Promise(((n,r)=>{e.onload=()=>{n(e)},e.onerror=(t,n,e,i,o)=>{r(o)},e.src=t}))},In.elementTypes=Pn;class Rn{static async from(t,n){let e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new vt(e),i=await r.parse(n);return new Rn(t,i,e)}static fromString(t,n){let e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new vt(e).parseFromString(n);return new Rn(t,r,e)}fork(t,n){let e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return Rn.from(t,n,{...this.options,...e})}forkString(t,n){let e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return Rn.fromString(t,n,{...this.options,...e})}ready(){return this.screen.ready()}isReady(){return this.screen.isReady()}async render(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.start({enableRedraw:!0,ignoreAnimation:!0,ignoreMouse:!0,...t}),await this.ready(),this.stop()}start(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{documentElement:n,screen:e,options:r}=this;e.start(n,{enableRedraw:!0,...r,...t})}stop(){this.screen.stop()}resize(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,e=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.documentElement.resize(t,n,e)}constructor(t,n,e={}){this.parser=new vt(e),this.screen=new pt(t,e),this.options=e;const r=new In(this,e),i=r.createDocumentElement(n);this.document=r,this.documentElement=i}}}}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.stiltsoft.confluence.plugin.tablefilter.tablefilter:macro-browser-resources', location = 'build/macro-browser.js' */
!function(){var e,t={9476:function(e){if(void 0===(t=window.SpreadsheetTemplate=window.SpreadsheetTemplate||{}))var t={};t.macroDialog=function(e,a){return'<section id="spreadsheet-dialog" class="aui-layer aui-dialog2 aui-dialog2-fullscreen aui-dialog2-maximum ap-aui-dialog2" role="dialog" data-aui-modal="true" data-aui-remove-on-hide="true"><base target="_blank"><header class="aui-dialog2-header"><h2 class="aui-dialog2-header-main">'+(e.isInsert?soy.$$escapeHtml(AJS.format("Insert \u2018{0}\u2019 Macro","Table Spreadsheet")):soy.$$escapeHtml(AJS.format("Edit \u2018{0}\u2019 Macro","Table Spreadsheet")))+'</h2><div class="aui-dialog2-footer-actions"><button class="aui-button aui-button-primary save" aria-label="'+soy.$$escapeHtml("Save")+'"><span class="aui-icon aui-icon-small aui-iconfont-check"></span></button><button class="aui-button aui-button-subtle cancel" aria-label="'+soy.$$escapeHtml("Cancel")+'"><span class="aui-icon aui-icon-small aui-iconfont-cross"></span></button></div></header><div class="aui-dialog2-content">'+t.view(e)+"</div></section>"},goog.DEBUG&&(t.macroDialog.soyTemplateName="SpreadsheetTemplate.macroDialog"),t.view=function(e,t){return'<iframe src="'+soy.$$escapeHtml(AJS.contextPath())+'/spreadsheet/view.action" frameborder="0" width="100%" seamless allowfullscreen id="'+soy.$$escapeHtml(e.id)+'"></iframe>'},goog.DEBUG&&(t.view.soyTemplateName="SpreadsheetTemplate.view"),e.exports=t},7058:function(e,t,a){"use strict";a.r(t);a(8265);var r=a(7628);function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){e.find("option").each((function(){var e=$(this),a=e.attr("value");e.text(t[a].title)}))}function i(e,t,a,o,i){if(!t.__multiSelect){var c=Object.keys(t),u=a[o],p="#".concat(e.attr("id")),m=!0===a.isNew,d=r.default.initSelects(p,t[u]&&u,c[0],i,m),f=d.option,g=d.onChangeAppender;a[o]=f,e.change((function(){var a=e.val();n(a,o,t,"hidden"),n(a,o,t,"shown"),function(e,t,a){a.__default&&s(a.__default.labels);"object"!==l(e)&&s(a[e].labels)}(a,0,t)})).val(f).trigger("change"),g(e)}}function n(e,t,a,r){var l="tfac-"+r+"-"+t;$("."+l).removeClass(l);var o=a[e];if(o){var i=o[r+"Params"];if(i){var n=i.map((function(e){return"#macro-param-div-"+e}));$(n.join(",")).addClass(l)}}}function s(e){e&&$.each(e,(function(e,t){$("#macro-param-div-"+e).find("label").text(t)}))}var c={initSelects:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;$.each(e,(function(r){var l=$("#macro-param-"+r),n=e[r];o(l,n),i(l,n,t,r,a)}))}},u=a(3348),p=a(6631),m=a.n(p),d=a(2746),f=a(3931),g=a(3926);function b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var v=function(){function e(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){e()};b(this,e),this.url=t,this.requestAuth=a}var t,a,r;return t=e,(a=[{key:"transformElements",value:function(e){this.initSelects(e),this.initEncodingInput(),this.initAuthDialog(e),this.initHeaderDialog(e),this.initHeadersDialog(e),this.bindURL()}},{key:"initSelects",value:function(e){var t={source:{url:{title:"URL",hiddenParams:["attachment"]},attachment:{title:"Attachment",hiddenParams:["url","auth-type","set-auth","set-header","headers"]}},"auth-type":{basic:{title:"Login and password",hiddenParams:["set-header"]},header:{title:"Custom",hiddenParams:["set-auth"]}},format:{plain:{title:"Plain text"},wiki:{title:"Wiki markup"},markdown:{title:"Markdown"}}};c.initSelects(t,e)}},{key:"initEncodingInput",value:function(){f.default.inputAutocomplete($("#macro-param-encoding"),null,[{value:"UTF-8"},{value:"UTF-16"},{value:"UTF-16LE"},{value:"UTF-16BE"},{value:"UTF-32"},{value:"ISO-8859-1"},{value:"US-ASCII"}])}},{key:"initAuthDialog",value:function(e){var t=this,a="tf-auth-dialog",r=$("#macro-param-div-set-auth"),l=$("#macro-param-auth");e&&e.auth&&"header"!==e["auth-type"]&&r.find("label").text("Change login and password"),(0,d.initMacroBrowserAJSDialog)(r,{dialogName:a,dialogId:a,options:{persistent:!0,width:270,gravity:"w"},getContent:function(){var e=[{field:"Login",value:"",variant:u.default.FIELD_VARIANTS.TEXT},{field:"Password",value:"",variant:u.default.FIELD_VARIANTS.PASSWORD}];return m().inlineDialog({clazz:a,name:"auth",inputs:e,dialogId:a})},applyCallback:function(e){var r=e.popup.find("form").find("input"),o=r.eq(0).val().trim(),i=r.eq(1).val().trim(),n=$("#button-".concat(a," .name"));t.encodeAuth(o,i,(function(e){e?n.text("Change login and password"):n.text("Set login and password"),l.val(e)}))}})}},{key:"initHeaderDialog",value:function(e){this.initDialog({name:"header",btnName:"set-header",inputName:"auth",isSet:e&&e.auth&&"header"===e["auth-type"],setLabel:"Set authentication header",changeLabel:"Change authentication header",inputLabel:"Request header",inputType:u.default.FIELD_VARIANTS.TEXT})}},{key:"initHeadersDialog",value:function(e){this.initDialog({name:"headers",btnName:"headers",inputName:"headers",isSet:e&&e.headers,setLabel:"Set additional headers",changeLabel:"Change additional headers",inputLabel:"Request headers",inputType:u.default.FIELD_VARIANTS.TEXTAREA})}},{key:"initDialog",value:function(e){var t=e.name,a=e.btnName,r=e.inputName,l=e.isSet,o=e.setLabel,i=e.changeLabel,n=e.inputLabel,s=e.inputType,c=this,p="tf-".concat(t,"-dialog"),f=$("#macro-param-div-"+a),g=$("#macro-param-"+r),b=s===u.default.FIELD_VARIANTS.TEXT?"input":s;l&&f.find("label").text(i),(0,d.initMacroBrowserAJSDialog)(f,{dialogName:p,dialogId:p,options:{persistent:!0,width:270,gravity:"w"},getContent:function(){var e=[{field:n,value:"",variant:s}];return m().inlineDialog({clazz:p,name:a,inputs:e,dialogId:p})},applyCallback:function(e){var t=e.popup.find("form").find(b).val().trim(),a=$("#button-".concat(p," .name"));c.encodeHeader(t,(function(e){e?a.text(i):a.text(o),g.val(e)}))}})}},{key:"bindURL",value:function(){var e=this;$("#macro-param-url").change((function(){e.requestData&&e.makeRequest(e.requestData.url,e.requestData.data,e.requestData.callback)}))}},{key:"encodeAuth",value:function(e,t,a){e||t?this.makeRequest(this.url+"/auth",{login:e,password:t},a):(this.requestData=null,a(""))}},{key:"encodeHeader",value:function(e,t){e?this.makeRequest(this.url+"/header",{header:e},t):(this.requestData=null,t(""))}},{key:"makeRequest",value:function(e,t,a){this.requestData={url:e,data:t,callback:a};var r=$("#macro-param-url").val().trim();this.requestAuth((function(l){t.url=r,t.jwt=l,(0,g.makeAjax)({contentType:"application/x-www-form-urlencoded; charset=utf-8",type:"POST",cache:!1,async:!1,url:e,dataType:"text",data:t,success:a})}))}}])&&h(t.prototype,a),r&&h(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),S=a(9497),y={"csv-table":"CSV","json-from-table":"JSON"},x=function(){};x.isSaveClick=!1,x.isSetParams=!1,x.storedParams={},x.prototype.beforeParamsSet=function(e){$("#macro-browser-dialog .macro-desc .macro-doco-link").before("Post \u003ca href=\u0022https://stiltsoft.customercase.com/forums/table-filter-for-confluence/ideas/create?from=macro\u0022\u003eIdea\u003c/a\u003e or \u003ca href=\u0022https://jsd.stiltsoft.com/servicedesk/customer/portal/2?from=macro\u0022\u003eIssue\u003c/a\u003e.   ");var t,a=new v(Confluence.getContextPath()+"/rest/table-filter/1.0/csv/encode");return function(e,t){"header"===e["auth-type"]?e.header&&(e.auth=t.encodeHeader(e.header)):e.login&&e.password&&(e.auth=t.encodeAuth(e.login,e.password));e.header="",e.login="",e.password=""}(e,a),a.transformElements(e),(t=$("#macro-param-attachment")).addClass("autocomplete-attachment").attr("data-template","{wikiLink}").attr("data-none-message","Nothing found"),Confluence.Binder.autocompleteAttachment(t.parent()),t.bind("selected.autocomplete-content",(function(e,a){var r=a.content.wikiLink.substring(1,a.content.wikiLink.length-1);if(AJS.params.spaceKey===a.content.space.key){var l=a.content.datePath?"/".concat(a.content.datePath,"/").concat(a.content.parentTitle):a.content.parentTitle;AJS.params.pageTitle!==l&&-1!==l.indexOf(":")||(r=r.replace("".concat(AJS.params.spaceKey,":"),""),AJS.params.pageTitle===l&&(r=r.replace("".concat(AJS.params.pageTitle,"^"),"")))}t.val(r)})),x.isSaveClick=!1,x.isSetParams=!0,e},x.prototype.postPreview=function(){x.isSaveClick=!1,x.isSetParams=!1},x.prototype.manipulateMarkup=function(e){return x.isSaveClick=!0,x.isSetParams=!1,e},x.prototype.beforeParamsRetrieved=function(e,t){return x.isSaveClick&&S.default.gaEditorDataSource(e,x.storedParams,y[t.macroName]),x.isSetParams&&(x.storedParams=e),e};var w=x;function T(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var C=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.params=t}var t,a,r;return t=e,(a=[{key:"initSelects",value:function(){var e={type:{this:{title:"Current page",hiddenParams:["page","labels","labels-operator","space","merge-tables"]},page:{title:"Specific page",hiddenParams:["copytable","labels","labels-operator","space","merge-tables"]},"page-children":{title:"Page and child pages",hiddenParams:["copytable","labels","labels-operator","space"]},"page-descendants":{title:"Page and all descendants",hiddenParams:["copytable","labels","labels-operator","space"]},labels:{title:"Pages with labels",hiddenParams:["copytable","page"]}},"labels-operator":{OR:{title:"at least one label"},AND:{title:"all the labels above"}}};c.initSelects(e,this.params)}},{key:"initMetaSelect",value:function(){var e=this.params["page-title"]||"";"true"===e&&(e="Page"),e=e.split(",").filter((function(e){return e}));var t=$("#macro-param-meta-view");t.find("option[value='']").remove(),t.attr("multiple",!0),e.length?t.val(e):t.find("option:selected").prop("selected",!1);var a=$("#macro-param-page-title");t.chosenTF({placeholder_text_multiple:"Click and start typing...",width:"100%",display_selected_options:!1}).change((function(t,r){r.selected?e.push(r.selected):r.deselected&&e.splice(e.indexOf(r.deselected),1),a.val(e.join(","))})),f.default.sortSelectedOptions(t,e)}},{key:"initMergeTablesParam",value:function(){this.params.name||$("#macro-param-merge-tables").prop("checked",!0)}}])&&T(t.prototype,a),r&&T(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),P=function(){};P.isSaveClick=!1,P.isSetParams=!1,P.storedParams={},P.prototype.beforeParamsSet=function(e){var t=new C(e);return function(e){var t=$("#macro-param-labels");e&&e.labels&&t.val(e.labels);t.auiSelect2(Confluence.UI.Components.LabelPicker.build({separator:",",queryOpts:{spaceKey:AJS.Meta.get("space-key")}}))}(e),t.initSelects(),t.initMetaSelect(),t.initMergeTablesParam(),P.isSaveClick=!1,P.isSetParams=!0,e},P.prototype.postPreview=function(){P.isSaveClick=!1,P.isSetParams=!1},P.prototype.manipulateMarkup=function(e){return P.isSaveClick=!0,P.isSetParams=!1,e},P.prototype.beforeParamsRetrieved=function(e){return P.isSaveClick&&S.default.gaEditorExcerptInclude(e,P.storedParams),P.isSetParams&&(P.storedParams=e),e["meta-view"]=void 0,e};var A=new P,I=a(2381),J={convertStorageToView:function(e){var t=e.body,a=t.indexOf('<table class="merged-header')>=0&&t.indexOf('data-tf-ready="true"')>=0,r=!1;if(t.indexOf(' data-macro-name="')>=0&&t.indexOf(' data-macro-parameters="')>=0&&(0,g.makeAjax)({type:"POST",async:!1,url:Confluence.getContextPath()+"/rest/api/contentbody/convert/storage",contentType:"application/json",dataType:"json",data:JSON.stringify({value:t,representation:"editor"}),success:function(e){t=e.value,r=!0}}),(t.indexOf("<ac:structured-macro")>=0||t.indexOf("<time")>=0)&&(0,g.makeAjax)({type:"POST",async:!1,url:Confluence.getContextPath()+"/rest/tinymce/1/macro/preview",contentType:"application/json; charset=utf-8",dataType:"html",data:JSON.stringify({contentId:f.default.getContentId(),macro:{name:e.name||"table-filter",body:t,params:{id:0}}}),success:function(e){t=e,r=!0}}),r&&a)for(var l,o=/<table class="merged-header/g;l=o.exec(t);){var i=l[0].length,n='<table data-tf-ready="true" class="merged-header';t=t.replace(l[0],n),o.lastIndex+=n.length-i}return t},showTabsParam:function(e){f.default.hasTabs($(e))||-1!==e.indexOf("macro 'spreadsheets'")||$("#macro-param-div-tabs").addClass("tf-very-hidden-param")}},O=a(1706),k=function(e){var t=new I.default;if(!e.body){var a=tinymce.activeEditor.selection.getContent();$("<div></div>").html(a).children().length?e.body=a:e.body=""}e.bodyHtml=e.body,e.bodyView=J.convertStorageToView(e),e.params=e.params?e.params:{},e.params.id=(new Date).getTime()+"_"+(0,O.hashCode)(e.bodyView),e.params.hasTable=e.body.indexOf("table")>0,e.params.isFirstTimeEnter=e.params.hasTable?void 0===e.params.isFirstTimeEnter:void 0,t.showDialog(e,M,D,F,_),AJS.MacroBrowser.dialog&&(AJS.MacroBrowser.dialog.activeMetadata=null)};function M(e,t){e.params.isFirstTimeEnter=t,S.default.gaEditorTransformer(e.params,e.storedParams),tinymce.confluence.macrobrowser.macroBrowserComplete(e)}function D(){tinymce.confluence.macrobrowser.macroBrowserCancel()}function F(e,t){var a={contentId:f.default.getContentId(),macroName:e.name,params:e.params,body:e.bodyHtml,successCallback:function(e){t(e)},errorCallback:function(e){AJS.logError(e)}};AJS.MacroBrowser.Rest.fetchMacroPreviewData(a)}function _(){return AJS.params.staticResourceUrlPrefix+"/blank.html"}var j=AJS.MacroBrowser.previewOnload;AJS.MacroBrowser.previewOnload=function(e){if(AJS.MacroBrowser.dialog&&AJS.MacroBrowser.dialog.activeMetadata)return j(e)};var B=a(9086),R=a.n(B),N=a(6951),E=a.n(N),L=a(479),V=a(4121),H=a(8299),K=function(){var e=this;e.tables=[],e.iconTables=[],e.tableColumns=[],e.sortColumns=[],e.columnSelect=null,e.userfilterSelect=null,e.numberfilterSelect=null,e.datefilterSelect=null,e.iconfilterSelect=null,e.sortSelect=null,e.columnParams=[],e.userfilterParams=[],e.numberfilterParams=[],e.datefilterParams=[],e.iconfilterParams=[],e.sortParams=[],e.dateFormatInput=null,e.dateFormatContainer=null,e.separatorContainer=null,e.tfBody="",e.defaults={},e.widths={},e.inverse={},e.gotBody=!1,e.order={},e.labels={},e.ddSeparators={},e.ddOperators={},e.totalRow=[],e.locale=AJS.Meta.get("user-locale").replace("-","_")};function U(e,t){return!!e.val()&&-1!==e.val().indexOf(t)}K.prototype.getMacroDetails=function(e){var t=this;t.columnParams=[],t.userfilterParams=[],t.numberfilterParams=[],t.datefilterParams=[],t.iconfilterParams=[],t.sortParams=[],t.chosenUpdated=!1,t.gotBody=!0,t.tfBody=e,t.body=$('<div><div class="tablefilter-table-wrapper">'+e+"</div></div>"),t.tables=f.default.getTables(t.body),t.iconTables=f.default.getTables(t.body,f.default.visualType),t.tableColumns=f.default.getColumns(t.tables),t.sortColumns=[],$.each(t.tableColumns,(function(e,a){$.trim(a).length&&(t.sortColumns.push(a+" "),t.sortColumns.push(a+" "))}))},K.prototype.transformElements=function(e){var t=this;L.default.adaptOldParamsTF(e);var a={thousandSeparator:{"":{title:""},"\\u0020":{title:"Space ( )"},".":{title:"Point (.)"},",":{title:"Comma (,)"}},separator:{"Point (.)":{title:"Point (.)"},"Comma (,)":{title:"Comma (,)"}},isOR:{AND:{title:"AND"},OR:{title:"OR"}},numbering:{"":{title:""},"Dynamic Ascending":{title:"Dynamic Ascending"},"Static Ascending":{title:"Static Ascending"},"Dynamic Descending":{title:"Dynamic Descending"},"Static Descending":{title:"Static Descending"}},totalcol:{"":{title:"",hiddenParams:["totalColName","thousandSeparator"]},Sum:{title:"Sum",shownParams:["thousandSeparator"]},Average:{title:"Average",shownParams:["thousandSeparator"]},Multiplication:{title:"Multiplication",shownParams:["thousandSeparator"]},Min:{title:"Min",shownParams:["thousandSeparator"]},Max:{title:"Max",shownParams:["thousandSeparator"]}},hidePane:{"Filtration panel":{title:"Filtration panel"},"Table header":{title:"Table header",hiddenParams:["hidelabels","labels","disabled"]},true:{title:"Hidden",hiddenParams:["hidelabels","disableSave","hideControls"]}}};$("#macro-browser-dialog .macro-desc .macro-doco-link").before("Post \u003ca href=\u0022https://stiltsoft.customercase.com/forums/table-filter-for-confluence/ideas/create?from=macro\u0022\u003eIdea\u003c/a\u003e or \u003ca href=\u0022https://jsd.stiltsoft.com/servicedesk/customer/portal/2?from=macro\u0022\u003eIssue\u003c/a\u003e.   "),$("#macro-param-div-id").hide(),t.setTypeNumbers($("#macro-param-limitHeight"));var l=$("#macro-param-limitHeight");t.setTypeNumbers($("#macro-param-fixedCols")),t.setTypeNumbers($("#macro-param-rowsPerPage")),t.setTypeNumbers($("#macro-param-showNRowsifNotFiltered")),t.setTypeNumbers($("#macro-param-ignoreFirstNrows"));var o=[],i=[],n=[],s=[],u=[],p=[];null!=e.column&&(o=e.column.split(",")),null!=e.userfilter&&(i=e.userfilter.split(",")),e.sort&&(e.sort=e.sort.replace(/ \(\u200DDesc\)/g," ").replace(/ \(\u200DAsc\)/g," "),p=e.sort.split(",")),null!=e.iconfilter&&(u=e.iconfilter.split(",")),null!=e.totalrow?t.totalRow=e.totalrow.split(","):t.totalRow=[],e.limitHeight="true"==e.limitHeight?1:e.limitHeight,Object.prototype.hasOwnProperty.call(e,"isNew")||(e.isNew=!e.datepattern),function(e){e.globalFilter&&$("#macro-param-globalFilter").prop("checked",!0);e.hideColumns&&$("#macro-param-hideColumns").prop("checked",!0);e.hidePane&&$("#macro-param-hidePane").val(e.hidePane);e.hidelabels&&$("#macro-param-hidelabels").prop("checked",!0);e.hideControls&&$("#macro-param-hideControls").prop("checked",!0);e.disableSave&&$("#macro-param-disableSave").prop("checked",!0);e.separator&&$("#macro-param-separator").val(e.separator);e.showNRowsifNotFiltered&&$("#macro-param-showNRowsifNotFiltered").val(e.showNRowsifNotFiltered);e.rowsPerPage&&$("#macro-param-rowsPerPage").val(e.rowsPerPage);e.ignoreFirstNrows&&$("#macro-param-ignoreFirstNrows").val(e.ignoreFirstNrows);e.numbering&&$("#macro-param-numbering").val(e.numbering);e.limitHeight&&$("#macro-param-limitHeight").val(e.limitHeight);e.fixedCols&&$("#macro-param-fixedCols").val(e.fixedCols);e.ddSeparator&&$("#macro-param-ddSeparator").val(e.ddSeparator);e.ddOperator&&$("#macro-param-ddOperator").val(e.ddOperator);e.isOR&&$("#macro-param-isOR").val(e.isOR);e.totalcol&&$("#macro-param-totalcol").val(e.totalcol);e.totalColName&&$("#macro-param-totalColName").val(e.totalColName);e.totalrow&&$("#macro-param-totalrow").val(e.totalrow);e.totalRowName&&$("#macro-param-totalRowName").val(e.totalRowName);"true"==e.disabled&&$("#macro-param-disabled").prop("checked",!0);e.tabs&&$("#macro-param-tabs").prop("checked",!0);e.updateSelectOptions&&$("#macro-param-updateSelectOptions").prop(e.updateSelectOptions)}(e),t.separatorContainer=$("#macro-param-div-separator"),t.dateFormatInput=$("#macro-param-datepattern"),t.totalRowInput=$("#macro-param-totalrow"),null!=e.datefilter&&(s=e.datefilter.split(",")),null!=e.numberfilter&&(n=e.numberfilter.split(",")),r.default.initDateFormatInput(e),r.default.initCheckBoxesParams(e),d.default.initMacroBrowserWorklogDialog(e.worklog);var m=$("#macro-param-column"),g=$("#macro-param-userfilter"),b=$("#macro-param-datefilter"),h=$("#macro-param-numberfilter"),v=$("#macro-param-iconfilter"),S=$("#macro-param-sort"),y=$.merge([],o);$.merge(y,i),$.merge(y,s),$.merge(y,n),$.merge(y,u),$.each(y,(function(e,a){var r=$.trim(a.replace(/\/g,",")).replace("","");-1==$.inArray(r,t.tableColumns)&&(t.tableColumns.push(r),t.sortColumns.push(r+" "),t.sortColumns.push(r+" "))})),$.each(p,(function(e,a){var r=$.trim(a.replace(/\/g,","));-1==$.inArray(r,t.sortColumns)&&t.sortColumns.push(r)})),t.tableColumns.sort((function(e,t){return e.localeCompare(t)})),t.sortColumns.sort((function(e,t){return e.localeCompare(t)})),t.columnSelect=t.createSelect(m,t.tableColumns,o,t.columnParams,(function(){return V.default.macrobrowserFilterAdded("dropdown","normal")})),t.userfilterSelect=t.createSelect(g,t.tableColumns,i,t.userfilterParams,(function(){return V.default.macrobrowserFilterAdded("freeText","normal")})),t.datefilterSelect=t.createSelect(b,t.tableColumns,s,t.datefilterParams,(function(){return V.default.macrobrowserFilterAdded("date","normal")})),t.numberfilterSelect=t.createSelect(h,t.tableColumns,n,t.numberfilterParams,(function(){return V.default.macrobrowserFilterAdded("number","normal")})),t.iconfilterSelect=t.createSelect(v,t.tableColumns,u,t.iconfilterParams,(function(){return V.default.macrobrowserFilterAdded("icon","normal")})),t.sortSelect=t.createSelect(S,t.sortColumns,p,t.sortParams,null,!0),$("#macro-param-globalFilter").change((function(){return V.default.macrobrowserFilterAdded("global","normal")})),$("#macro-param-hideColumns").change((function(){return V.default.macrobrowserFilterAdded("hideColumns","normal")})),t.chosenUpdated||(t.columnSelect.trigger("chosen:updated"),t.userfilterSelect.trigger("chosen:updated"),t.datefilterSelect.trigger("chosen:updated"),t.numberfilterSelect.trigger("chosen:updated"),t.iconfilterSelect.trigger("chosen:updated"),t.sortSelect.trigger("chosen:updated"),f.default.sortSelectedOptions(t.columnSelect,t.columnParams),f.default.sortSelectedOptions(t.userfilterSelect,t.userfilterParams),f.default.sortSelectedOptions(t.datefilterSelect,t.datefilterParams),f.default.sortSelectedOptions(t.numberfilterSelect,t.numberfilterParams),f.default.sortSelectedOptions(t.iconfilterSelect,t.iconfilterParams),f.default.sortSelectedOptions(t.sortSelect,t.sortParams),t.chosenUpdated=!0),$(".search-field input").one("focus",(function(){$(".search-choice").css("max-width",$(".chosen-container").width()-40)})),d.default.initMacroBrowserDefaultValueDialog(t,$("#macro-param-div-default")),d.default.initMacroBrowserCellWidthDialog(t,$("#macro-param-div-cell-width")),d.default.initMacroBrowserInverseFilterDialog(t,$("#macro-param-div-inverse")),d.default.initMacroBrowserFilterLabelsDialog(t,$("#macro-param-div-labels")),d.default.initMacroBrowserDDSeparatorDialog(t,$("#macro-param-div-ddSeparator")),d.default.initMacroBrowserDDOperatorDialog(t,$("#macro-param-div-ddOperator")),d.default.initMacroBrowserTotalRowDialog(t,$("#macro-param-div-totalrow"));var x=e.default?e.default.split(","):[],w=e["cell-width"]?e["cell-width"].split(","):[],T=e.inverse?e.inverse.split(","):[],C=e.order?e.order.split(","):[],P=e.labels?e.labels.split(""):[],A=e.ddSeparator?e.ddSeparator.split(""):[],I=e.ddOperator?e.ddOperator.split(","):[],J=0,O=0,k=0,M=0,D=0,F=0,_=0,j=1!==A.length||e.ddSeparators?"":A[0];e.ddSeparators=!0,f.default.i18nFilterValues(x),t.order.select_=[],$.each(o,(function(e,a){var r=a.replace("","");t.defaults["select_"+r]=x.length>J?x[J++]:"",t.inverse["select_"+r]=T.length>M&&"true"==T[M++],t.widths["select_"+r]=w.length>O?w[O++]:"",t.labels["select_"+r]=P.length>k?P[k++]:"",t.ddSeparators["select_"+r]=A.length>F?A[F++]:j,t.ddOperators["select_"+r]=I.length>_?I[_++]:"OR",t.order.select_.push(C.length>D?parseInt(C[D++]):D++)})),t.order.freetext_=[],$.each(i,(function(e,a){var r=a.replace("","");t.defaults["freetext_"+r]=x.length>J?x[J++]:"",t.inverse["freetext_"+r]=T.length>M&&"true"==T[M++],t.widths["freetext_"+r]=w.length>O?w[O++]:"",t.labels["freetext_"+r]=P.length>k?P[k++]:"",t.order.freetext_.push(C.length>D?parseInt(C[D++]):D++)})),t.order.number_=[],$.each(n,(function(e,a){var r=a.replace("","");t.defaults["number_"+r]=x.length>J?x[J++]:"",t.inverse["number_"+r]=T.length>M&&"true"==T[M++],t.labels["number_"+r]=P.length>k?P[k++]:"",t.order.number_.push(C.length>D?parseInt(C[D++]):D++)})),t.order.date_=[],$.each(s,(function(e,a){var r=a.replace("","");t.defaults["date_"+r]=x.length>J?x[J++]:"",t.inverse["date_"+r]=T.length>M&&"true"==T[M++],t.labels["date_"+r]=P.length>k?P[k++]:"",t.order.date_.push(C.length>D?parseInt(C[D++]):D++)})),t.order.global=[],e.globalFilter&&(t.defaults.global=x.length>J?x[J++]:"",t.inverse.global=T.length>M&&"true"==T[M++],t.widths.global=w.length>O?w[O++]:"",t.labels.global=P.length>k?P[k++]:"",t.order.global.push(C.length>D?parseInt(C[D++]):D+++u.length)),t.order.hideColumns=[],e.hideColumns&&(t.defaults.hideColumns=x.length>J?x[J++]:"",t.inverse.hideColumns=T.length>M&&"true"==T[M++],t.widths.hideColumns=w.length>O?w[O++]:"",t.labels.hideColumns=P.length>k?P[k++]:"",t.order.hideColumns.push(C.length>D?parseInt(C[D++]):D+++u.length)),t.order.icon=[],$.each(u,(function(e,a){var r=a.replace("","");t.defaults["icon"+r]=x.length>J?x[J++]:"",t.inverse["icon"+r]=T.length>M&&"true"==T[M++],t.widths["icon"+r]=w.length>O?w[O++]:"",t.labels["icon"+r]=P.length>k?P[k++]:"",t.ddOperators["icon"+r]=I.length>_?I[_++]:"OR",t.order.icon.push(C.length>D?parseInt(C[D++]):D++-t.order.hideColumns.length-t.order.global.length)})),t.columnSelect.one("chosen:showing_dropdown",(function(){t.columnSelect.click()}));var B=$("#macro-param-sparkline"),N=$("#macro-param-sparkName");N.val("Sparkline");var E=N.parent();E.addClass("tf-always-hidden"),e.sparkline&&"false"!==e.sparkline&&(B.prop("checked",!0),E.removeClass("tf-always-hidden"),N.val(e.sparkName)),B.change((function(){$(this).prop("checked")?($(".macro-input-fields").animate({scrollTop:$(".macro-input-fields form.aui").height()},750),E.removeClass("tf-always-hidden")):E.addClass("tf-always-hidden")}));var K=$("#macro-param-heightValue"),U=K.parent();U.addClass("tf-always-hidden"),e.limitHeight&&(l.val(e.limitHeight),U.removeClass("tf-always-hidden"),K.val(e.heightValue)),l.bind("keyup keydown change",(function(){l.val()>0?($(".macro-input-fields").animate({scrollTop:$(".macro-input-fields form.aui").height()},750),U.removeClass("tf-always-hidden")):U.addClass("tf-always-hidden")})),t.totaRowNameInput=$("#macro-param-div-totalRowName"),t.thousandSeparatorSelect=$("#macro-param-div-thousandSeparator"),t.totalRowInput.change((function(){t.totalRowInput.val().replace(/,/g,"")?(t.totaRowNameInput.removeClass("tf-always-hidden"),t.thousandSeparatorSelect.removeClass("tfac-hidden-totalrow"),t.thousandSeparatorSelect.addClass("tfac-shown-totalrow")):(t.totaRowNameInput.addClass("tf-always-hidden"),t.thousandSeparatorSelect.addClass("tfac-hidden-totalrow"),t.thousandSeparatorSelect.removeClass("tfac-shown-totalrow"))})),e.totalrow&&e.totalrow.replace(/,/g,"")?t.thousandSeparatorSelect.addClass("tfac-shown-totalrow"):(t.totaRowNameInput.addClass("tf-always-hidden"),t.thousandSeparatorSelect.addClass("tfac-hidden-totalrow")),c.initSelects(a,e,H.TABLE_FILTER),function(e){$("#macro-param-div-column").before(R().tableFilterTabs());var t=[$("#macro-param-div-column"),$("#macro-param-div-userfilter"),$("#macro-param-div-numberfilter"),$("#macro-param-div-datefilter"),$("#macro-param-div-iconfilter"),$("#macro-param-div-globalFilter"),$("#macro-param-div-hideColumns")],a=[$("#macro-param-div-separator"),$("#macro-param-div-datepattern"),$("#macro-param-div-default"),$("#macro-param-div-cell-width"),$("#macro-param-div-inverse"),$("#macro-param-div-disableSave"),$("#macro-param-div-hidelabels"),$("#macro-param-div-hidePane"),$("#macro-param-div-hideControls"),$("#macro-param-div-isOR"),$("#macro-param-div-ddSeparator"),$("#macro-param-div-ddOperator"),$("#macro-param-div-ignoreFirstNrows"),$("#macro-param-div-labels"),$("#macro-param-div-disabled"),$("#macro-param-div-worklog"),$("#macro-param-div-updateSelectOptions"),$("#macro-param-div-enabledInEditor"),$("#macro-param-div-tabs")],r=[$("#macro-param-div-showNRowsifNotFiltered"),$("#macro-param-div-rowsPerPage"),$("#macro-param-div-numbering"),$("#macro-param-div-sort"),$("#macro-param-div-fixedCols"),$("#macro-param-div-limitHeight"),$("#macro-param-div-sparkline"),$("#macro-param-div-sparkName"),$("#macro-param-div-totalrow"),$("#macro-param-div-totalcol"),$("#macro-param-div-totalColName"),$("#macro-param-div-totalRowName"),$("#macro-param-div-thousandSeparator"),$("#macro-param-div-heightValue")];$(".tf-macrobrowser-tabs a").attr("disabled","disabled");var l=$("#tab-filters"),o=$("#tab-filter-options"),i=$("#tab-table-options"),n=[l,o,i];function s(e){a(e[0],"in");for(var t=1;t<e.length;t++)a(e[t],"out");function a(e,t){for(var a=0;a<e.length;a++)"in"==t?e[a].show():e[a].hide()}}function c(e){e.hasClass("active-tab")||(n.forEach((function(e){e.removeClass("active-tab")})),e.addClass("active-tab"))}l.click((function(){c(l),s([t,a,r])})),o.click((function(){c(o),s([a,t,r])})),i.click((function(){c(i),s([r,t,a])})),l.trigger("click")}(t.isCloud)},K.prototype.createSelect=function(e,t,a,r,l,o){e.hide(),$.each(a,(function(e,t){r.push($.trim(t))})),$.each(a,(function(e,t){a[e]=$.trim(t.replace(/\/g,",")).replace("","")}));var i=$("<select multiple/>");$.each(t,(function(t,r){var l=-1==$.inArray(r,a)?"":'selected="selected" ',o="";if(e.is("#macro-param-sort")){var n=r;n=-1!=n.indexOf("")?n.replace("",""):n.replace("",""),-1!=$.inArray(n,a)&&(o='style="display: none"')}i.append($("<option "+l+o+"></option>").text(r))})),e.after(i),i.chosenTF({no_results_text:o?"No matches found":"No matches found. Press \u0027Enter\u0027 to add",placeholder_text_multiple:"Click and start typing...",width:"100%",display_selected_options:!1,addUserOption:!o}).change((function(t,a){if(null!=a.selected){if(i.find("option").filter((function(){return this.textContent===a.selected})).prop("selected",!0),""==(s=a.selected)&&(s=""),r.push(s.replace(/\,/g,"")),e.is("#macro-param-sort")){c=-1!=(c=a.selected).indexOf("")?c.replace("",""):c.replace("",""),i.find("option").filter((function(){return this.textContent==c})).hide(),i.trigger("chosen:updated");for(var o=i.parent().find("ul.chosen-choices"),n=r.length-1;n>=0;n--)o.prepend(o.find("li").filter((function(){return this.textContent==r[n].replace(/\/g,",")})))}}else if(null!=a.deselected){var s;if($(this).find("option").filter((function(){return this.textContent==a.deselected})).prop("selected",!1),""==(s=a.deselected)&&(s=""),r.splice($.inArray(s.replace(/\,/g,""),r),1),e.is("#macro-param-sort")){var c;c=-1!=(c=a.deselected).indexOf("")?c.replace("",""):c.replace("",""),i.find("option").filter((function(){return this.textContent==c})).show(),i.trigger("chosen:updated");for(o=i.parent().find("ul.chosen-choices"),n=r.length-1;n>=0;n--)o.prepend(o.find("li").filter((function(e){return this.textContent==r[n].replace(/\/g,",")})))}}e.val(r.join(",")),l&&l()}));var n=f.default.sortSelectedOptions(i,r);return n.sortable({tolerance:"pointer",cursor:"move",helper:"clone",items:".search-choice",stop:function(){r=[],n.find(".search-choice").each((function(){var e=this.textContent;""==e&&(e=""),r.push(e.replace(/\,/g,""))})),e.val(r.join(","))}}),i},K.prototype.getSelectFilterOptions=function(e,t){var a=this,r=[],l=[],o=!0,i=a.ddSeparators["select_"+e];return i=i?i.replace(/\,/g,"").replace(/\\u0020/g," "):i,$.each(a.tables,(function(n,s){$.each(s[0],(function(c,u){if(e.toLocaleLowerCase()===f.default.clearString(u).toLocaleLowerCase()){var p=t?a.iconTables[n]:s;if($.each(p,(function(e,a){if(0!==e)if(t&&a[c]){var n=$(a[c]);n.filter("img").each((function(){var e=f.default.clearIconSrc(this.src);-1===$.inArray(e,l)&&(l.push(e),r.push(E().sanitize(this.outerHTML)))})),n.filter("ul").length&&o&&(o=!1,-1===$.inArray('<ul class="inline-task-list"><li></li></ul>',l)&&(r.push('<ul class="inline-task-list"><li></li></ul>'),l.push('<ul class="inline-task-list"><li></li></ul>')),-1===$.inArray('<ul class="inline-task-list"><li class="checked"></li></ul>',l)&&(r.push('<ul class="inline-task-list"><li class="checked"></li></ul>'),l.push('<ul class="inline-task-list"><li class="checked"></li></ul>')))}else if(null!=a[c]){var s=a[c].replace(/\,/g,"");(s=i?s.split(i):[s]).forEach((function(e){e=e.trim(),-1===$.inArray(e,r)&&r.push(e)}))}})),!t&&-1===$.inArray("@currentUser",r)){var m=c+1;a.body.find("table").eq(n).find("tr td:nth-child("+m+"), tr th:nth-child("+m+")").find(".confluence-userlink, ri\\:user").length&&r.push("@currentUser")}}}))})),{allSelects:r,options:l}},K.prototype.updateColumns=function(e){var t=this;function a(e){t.body=e;var a=!1,r=!1;f.default.normalizeTable(f.default.getTableNodes(e)),t.tables=f.default.getTables(e),t.iconTables=f.default.getTables(e,f.default.visualType),$.each(f.default.getRawColumns(t.tables),(function(e,l){if(-1===$.inArray(l,t.tableColumns)&&(a=!0,t.tableColumns.push(l),t.columnSelect.append($("<option></option>").val(l).text(l)),t.userfilterSelect.append($("<option></option>").val(l).text(l)),t.datefilterSelect.append($("<option></option>").val(l).text(l)),t.numberfilterSelect.append($("<option></option>").val(l).text(l)),t.iconfilterSelect.append($("<option></option>").val(l).text(l))),$.trim(l).length){if(-1==$.inArray(l+" ",t.sortColumns)){r=!0,t.sortColumns.push(l+" ");var o="";U(t.sortSelect,l+" ")&&(o=' style="display:none"'),t.sortSelect.append($("<option"+o+"></option>").val(l+" ").text(l+" "))}if(-1==$.inArray(l+" ",t.sortColumns)){r=!0,t.sortColumns.push(l+" ");o="";U(t.sortSelect,l+" ")&&(o=' style="display:none"'),t.sortSelect.append($("<option"+o+"></option>").val(l+" ").text(l+" "))}}})),a&&(f.default.sortSelectOptions(t.columnSelect),f.default.sortSelectOptions(t.userfilterSelect),f.default.sortSelectOptions(t.datefilterSelect),f.default.sortSelectOptions(t.numberfilterSelect),f.default.sortSelectOptions(t.iconfilterSelect),t.columnSelect.trigger("chosen:updated"),t.userfilterSelect.trigger("chosen:updated"),t.datefilterSelect.trigger("chosen:updated"),t.numberfilterSelect.trigger("chosen:updated"),t.iconfilterSelect.trigger("chosen:updated"),f.default.sortSelectedOptions(t.columnSelect,t.columnParams),f.default.sortSelectedOptions(t.userfilterSelect,t.userfilterParams),f.default.sortSelectedOptions(t.datefilterSelect,t.datefilterParams),f.default.sortSelectedOptions(t.numberfilterSelect,t.numberfilterParams),f.default.sortSelectedOptions(t.iconfilterSelect,t.iconfilterParams)),r&&(f.default.sortSelectOptions(t.sortSelect),t.sortSelect.trigger("chosen:updated"),f.default.sortSelectedOptions(t.sortSelect,t.sortParams))}t.body=e,r.default.bindPreview(e,a),f.default.addIframe(t.body,"tablefilter-table-wrapper",a),a(e)},K.prototype.getComputationalParams=function(e){var t=this,a=null!=e.column?e.column.split(","):[],r=null!=e.userfilter?e.userfilter.split(","):[],l=null!=e.numberfilter?e.numberfilter.split(","):[],o=null!=e.datefilter?e.datefilter.split(","):[],i=null!=e.iconfilter?e.iconfilter.split(","):[],n=[],s=[],c=[],u=[],p=[],m=[],d=[],g={},b=0;return b=h(t,a,"select_"),b=h(t,r,"freetext_"),b=h(t,l,"number_"),b=h(t,o,"date_"),e.globalFilter&&(b=h(t,[""],"global")),e.hideColumns&&(b=h(t,[""],"hideColumns")),h(t,i,"icon",(e.globalFilter?1:0)+(e.hideColumns?1:0)),p.slice().sort((function(e,t){return e-t})).forEach((function(e,t){p[$.inArray(e,p)]=t})),f.default.unI18nFilterValues(n),e.default=n.join(","),e["cell-width"]=s.join(","),e.inverse=c.join(","),e.labels=u.join(""),e.order=p.join(","),e.ddSeparator=m.join(""),e.ddOperator=d.join(","),e;function h(e,t,a,r){return $.each(t,(function(t,l){var o=$.trim(l.replace(/\/g,",")).replace("","");n.push(e.defaults[a+o]),"number_"!=a&&"date_"!=a&&s.push(e.widths[a+o]),c.push(e.inverse[a+o]),u.push(e.labels[a+o]),"select_"===a&&m.push(e.ddSeparators[a+o]),"select_"!==a&&"icon"!==a||d.push(e.ddOperators[a+o]);var i=e.order[a][t];if(null==i){if(0==p.length)i=0;else{b=0;var f=p.length-1;"icon"==a&&0==t&&(f-=r),i=f>=0?p[f]+1:0}var h=i-b,v=h;$.each(g,(function(e,t){v>e&&(h-=t)})),g[h]?g[h]++:g[h]=1,p.forEach((function(e,t){e>=i-b&&t<p.length-b&&(p[t]+=1)})),b++}else{b=0;for(var S=i;S>=0;S--)g[S]&&(i+=g[S])}p.push(i)})),b}},K.prototype.getSelectedFilters=function(){var e=[];if($("div.macro-param-div:not(#macro-param-div-sort) .chosen-choices .search-choice").each((function(){var t=$(this),a=t.parents("#macro-param-div-column").length>0,r=t.parents("#macro-param-div-datefilter").length>0,l=t.parents("#macro-param-div-numberfilter").length>0,o=t.parents("#macro-param-div-userfilter").length>0,i=t.parents("#macro-param-div-iconfilter").length>0,n=i?"icon":r?"date_":l?"number_":o?"freetext_":"select_";e.push({field:t.text(),isSelect:a,isDate:r,isNumber:l,isText:o,isIcon:i,type:n})})),$("#macro-param-globalFilter").prop("checked")){var t="Filter whole table";e.push({field:t,type:"global"})}if($("#macro-param-hideColumns").prop("checked")){var a="Columns to hide";e.push({field:a,type:"hideColumns"})}return e},K.prototype.setTypeNumbers=function(e){e.replaceWith(e.clone().attr("type","number").attr("min","0"))};var q,z=K,G=a(4874),W=function(){this.tableFilterMacro=new z,this.tableFilterMacro.storedParams={},this.tableFilterMacro.isSaveClick=!1,this.tableFilterMacro.isSetParams=!1,this.tableFilterMacro.hasTable=!1};W.prototype.getMacroDetailsFromSelectedMacro=function(e,t){var a=q.tableFilterMacro;q.bodyView=J.convertStorageToView(t),a.getMacroDetails(q.bodyView),J.showTabsParam(q.bodyView),a.hasTable=q.bodyView.indexOf("table")>0},W.prototype.postPreview=function(e){var t=q.tableFilterMacro;t.updateColumns($(e).contents().find(".tablefilter-table-wrapper")),t.isSaveClick=!1,t.isSetParams=!1,window.TableBinderWasBind||(window.TableBinderWasBind=!0,G.default.bindFilterActions(),G.default.bindOptionsEvents())},W.prototype.beforeParamsSet=function(e){var t=q.tableFilterMacro;return t.gotBody||q.getMacroDetailsFromSelectedMacro(null,{body:tinymce.activeEditor.selection.getContent()}),t.gotBody=!1,("true"==e.numbering||"Dynamic"==e.numbering)&&(e.numbering="Dynamic Ascending"),e.id=(new Date).getTime()+"_"+(0,O.hashCode)(t.tfBody),t.transformElements(e),""==e.column&&(e.column=""),""==e.userfilter&&(e.userfilter=""),""==e.iconfilter&&(e.iconfilter=""),""==e.datefilter&&(e.datefilter=""),""==e.numberfilter&&(e.numberfilter=""),J.showTabsParam(q.bodyView),t.isSaveClick=!1,t.isSetParams=!0,e.isFirstTimeEnter=t.hasTable?void 0===e.isFirstTimeEnter:void 0,e},W.prototype.manipulateMarkup=function(e){return q.tableFilterMacro.isSaveClick=!0,q.tableFilterMacro.isSetParams=!1,e},W.prototype.beforeParamsRetrieved=function(e){var t=q.tableFilterMacro;return t.chosenUpdated||(t.columnSelect.trigger("chosen:updated"),t.userfilterSelect.trigger("chosen:updated"),t.datefilterSelect.trigger("chosen:updated"),t.numberfilterSelect.trigger("chosen:updated"),t.iconfilterSelect.trigger("chosen:updated"),t.sortSelect.trigger("chosen:updated"),f.default.sortSelectedOptions(t.columnSelect,t.columnParams),f.default.sortSelectedOptions(t.userfilterSelect,t.userfilterParams),f.default.sortSelectedOptions(t.datefilterSelect,t.datefilterParams),f.default.sortSelectedOptions(t.numberfilterSelect,t.numberfilterParams),f.default.sortSelectedOptions(t.iconfilterSelect,t.iconfilterParams),f.default.sortSelectedOptions(t.sortSelect,t.sortParams),t.chosenUpdated=!0),e.limitHeight=$("#macro-param-limitHeight").val(),e=t.getComputationalParams(e),t.isSaveClick&&(e.isFirstTimeEnter&&S.default.gaTFInsert("TF Saved in Macro Browser",t.tables.length),G.default.triggerFilterMacroBrowserEvents(e,t.storedParams),S.default.gaEditorTF(e,t.storedParams)),t.isSetParams&&(t.storedParams=e||{}),e};var X=q=new W,Q=a(7718),Y=function(){this.tables=[],this.tableColumns=[],this.columnSelect=null,this.aggregateSelect=null,this.typeSelect=null,this.tfBody="",this.columnParams=[],this.aggregateParams=[],this.isPivot=!1,this.gotBody=!1,this.transpose=!1,this.colors=[],this.pieKeys=[],this.isCloud=!1};function Z(e,t,a,r,l,o){e.hide();var i=$("<select multiple/>");return $.each(a,(function(e,a){a=$.trim(a).replace("",""),-1==$.inArray(a,t)&&t.push(a)})),t.sort((function(e,t){return e.localeCompare(t)})),$.each(t,(function(e,t){i.append($("<option></option>").text(t))})),$.each(r,(function(e,a){a=$.trim(a).replace("",""),-1==$.inArray(a,t)&&(t.push(a),i.append($("<option></option>").text(a)))})),e.after(i),function(e,t,a,r,l){e.chosenTF({no_results_text:"No matches found. Press \u0027Enter\u0027 to add",placeholder_text_multiple:"Click and start typing...",width:"100%",display_selected_options:!1,addUserOption:!0}).change((function(r,o){if(null!=o.selected)e.find("option").filter((function(){return this.textContent==o.selected})).prop("selected",!0),""==(i=o.selected)&&(i=""),a.push(i);else if(null!=o.deselected){var i;e.find("option").filter((function(){return this.textContent==o.deselected})).prop("selected",!1),""==(i=o.deselected)&&(i=""),a.splice($.inArray(i,a),1)}t.val(a.join("")),l&&l.updatePieKeys()}));var o=f.default.sortSelectedOptions(e,a);o.sortable({tolerance:"pointer",cursor:"move",helper:"clone",items:".search-choice",stop:function(){var e=a.slice();a.length=0,o.find(".search-choice").each((function(){var e=this.textContent;""==e&&(e=""),a.push(e)}));var l=r.slice();e.forEach((function(e,t){var o=$.inArray(e,a);o>=0&&l.length>o&&(r[o]=l[t])})),t.val(a.join(""))}});var i=[];a.forEach((function(e){i.push(e.replace("",""))})),e.val(i),e.trigger("chosen:updated"),t.val(a.join(""))}(i,e,a,l,o),i}function ee(e){e.hasClass("chart-browser-hidden")||e.addClass("chart-browser-hidden")}function te(e){e.hasClass("chart-browser-hidden")&&e.removeClass("chart-browser-hidden")}Y.prototype.getMacroDetails=function(e,t,a,r){var l=this;l.isCloud=r,l.transpose="Horizontal"==t.dataorientation,l.gotBody=!0,l.isPivot=a||!1,l.tfBody=e,l.initTableChart(t),l.setTables(l.tfBody),l.tables=l.TableChart.tables,l.tableColumns=f.default.getColumns(l.tables)},Y.prototype.transformElements=function(e){var t=this,a={type:{Pie:{title:"Pie",hiddenParams:["line-settings","xlog","datepattern","scalestep","log","xminvalue","xmaxvalue","grid","xscalestep","trendline","legend","interpolation","minvalue","maxvalue","xtitle","ytitle"]},Donut:{title:"Donut",hiddenParams:["line-settings","xlog","datepattern","scalestep","log","xminvalue","xmaxvalue","grid","xscalestep","trendline","legend","interpolation","minvalue","maxvalue","xtitle","ytitle"]},Column:{title:"Column",hiddenParams:["line-settings","xlog","datepattern","xminvalue","xmaxvalue","grid","xscalestep","interpolation","outerLabels"]},"Stacked Column":{title:"Stacked Column",hiddenParams:["line-settings","xlog","datepattern","xminvalue","xmaxvalue","grid","xscalestep","interpolation","outerLabels"]},Bar:{title:"Bar",hiddenParams:["line-settings","xlog","datepattern","xminvalue","xmaxvalue","grid","xscalestep","interpolation","outerLabels"]},"Stacked Bar":{title:"Stacked Bar",hiddenParams:["line-settings","xlog","datepattern","xminvalue","xmaxvalue","grid","xscalestep","interpolation","outerLabels"]},"Bubble Pie":{title:"Bubble Pie",hiddenParams:["line-settings","is3d","trendline","interpolation","xlog","log","outerLabels"],labels:{column:"X-axis and Y-axis columns",xtitle:"X-axis label",ytitle:"Y-axis label"}},Line:{title:"Line",hiddenParams:["datepattern","innerlabels","is3d","outerLabels"],labels:{aggregation:"Y-axis value column",column:"X-axis value column",xtitle:"X-axis label",log:"Logarithmic scale Y",xlog:"Logarithmic scale X",scalestep:"Scale Y step",minvalue:"Minimal Y value",maxvalue:"Maximal Y value",ytitle:"Y-axis label"}},Area:{title:"Area",hiddenParams:["line-settings","datepattern","innerlabels","is3d","outerLabels"],labels:{aggregation:"Y-axis value column",column:"X-axis value column",xtitle:"X-axis label",log:"Logarithmic scale Y",xlog:"Logarithmic scale X",scalestep:"Scale Y step",minvalue:"Minimal Y value",maxvalue:"Maximal Y value",ytitle:"Y-axis label"}},"Stacked Area":{title:"Stacked Area",hiddenParams:["line-settings","datepattern","innerlabels","is3d","outerLabels"],labels:{aggregation:"Y-axis value column",column:"X-axis value column",xtitle:"X-axis label",log:"Logarithmic scale Y",xlog:"Logarithmic scale X",scalestep:"Scale Y step",minvalue:"Minimal Y value",maxvalue:"Maximal Y value",ytitle:"Y-axis label"}},"Time Line":{title:"Time Line",hiddenParams:["xlog","innerlabels","is3d","outerLabels"],labels:{column:"Dates column",xtitle:"Date axis label",scalestep:"Scale Y step",minvalue:"Minimal Y value",maxvalue:"Maximal Y value",ytitle:"Y-axis label"}},"Time Area":{title:"Time Area",hiddenParams:["line-settings","xlog","innerlabels","is3d","outerLabels"],labels:{column:"Dates column",xtitle:"Date axis label",scalestep:"Scale Y step",minvalue:"Minimal Y value",maxvalue:"Maximal Y value",ytitle:"Y-axis label"}},"Stacked Time Area":{title:"Stacked Time Area",hiddenParams:["line-settings","xlog","innerlabels","is3d","outerLabels"],labels:{column:"Dates column",xtitle:"Date axis label",scalestep:"Scale Y step",minvalue:"Minimal Y value",maxvalue:"Maximal Y value",ytitle:"Y-axis label"}},Gantt:{title:"Gantt",hiddenParams:["line-settings","xlog","log","innerlabels","is3d","trendline","legend","scalestep","interpolation","minvalue","maxvalue","outerLabels"],labels:{ytitle:"Date axis label",xscalestep:"Scale step",xminvalue:"Minimal value",xmaxvalue:"Maximal value"}},Radar:{title:"Radar",hiddenParams:["line-settings","xlog","log","innerlabels","is3d","trendline","xscalestep","interpolation","minvalue","datepattern","xminvalue","xmaxvalue","xtitle","ytitle","outerLabels"]},__default:{labels:{aggregation:"Values column",column:"Labels column",xtitle:"Row axis label",log:"Logarithmic scale",xscalestep:"Scale X step",xminvalue:"Minimal X value",xmaxvalue:"Maximal X value",scalestep:"Scale step",minvalue:"Minimal value",maxvalue:"Maximal value",ytitle:"Value axis label"}}},align:{Center:{title:"Center"},Left:{title:"Left"},Right:{title:"Right"}},hide:{false:{title:"Show all content"},true:{title:"Hide tables"},all:{title:"Hide all content"}},outerLabels:{Label:{title:"Label"},None:{title:"None"}},legend:{right:{title:"Right"},under:{title:"Bottom"},none:{title:"None"}},innerlabels:{Value:{title:"Number"},None:{title:"None"},Percentage:{title:"Percentage"},"Value (Percentage)":{title:"Number (Percentage)"},"Percentage (Value)":{title:"Percentage (Number)"}},dataorientation:{Vertical:{title:"Vertical"},Horizontal:{title:"Horizontal"}},separator:{"Point (.)":{title:"Point (.)"},"Comma (,)":{title:"Comma (,)"}}};if(0===Object.getOwnPropertyNames(e).length&&(e.isNew=!0),!e.version&&!e.formatVersion&&(e.version=2,e.formatVersion=2,e.type&&(e.type.indexOf("Line")>=0||e.type.indexOf("Area")>=0))){var l=e.column;e.column=e.aggregation,e.aggregation=l}e.type&&e.type.indexOf("3D ")>=0&&(e.type=e.type.replace("3D ",""),e.is3d=!0),Q.default.initParamBarColoringType(e),t.transpose="Horizontal"==e.dataorientation,$("#macro-browser-dialog .macro-desc .macro-doco-link").before("Post \u003ca href=\u0022https://stiltsoft.customercase.com/forums/table-filter-for-confluence/ideas/create?from=macro\u0022\u003eIdea\u003c/a\u003e or \u003ca href=\u0022https://jsd.stiltsoft.com/servicedesk/customer/portal/2?from=macro\u0022\u003eIssue\u003c/a\u003e.   "),$("#macro-param-div-id").hide(),e.column?(t.columnParams=e.column.split(""),$.each(t.columnParams,(function(e,a){t.columnParams[e]=$.trim(a)}))):t.columnParams=t.tableColumns.length?[f.default.getRawColumns(t.tables)[0]]:[],e.aggregation?(t.aggregateParams=e.aggregation.split(""),$.each(t.aggregateParams,(function(e,a){t.aggregateParams[e]=$.trim(a)}))):t.aggregateParams=t.tableColumns.length>1?[f.default.getRawColumns(t.tables)[1]]:[],e.colors&&(t.colors=e.colors.split(",")),f.default.chartColors.forEach((function(e){-1==$.inArray(e,t.colors)&&t.colors.push(e)})),e.pieKeys&&(t.pieKeys=e.pieKeys.split("")),2!=e.version&&2!=e.formatVersion||(e.version=3,e.formatVersion=3,"false"===e.innerlabels?e.innerlabels="None":e.type&&"Pie"!==e.type&&-1===e.type.indexOf("Donut")||(e.innerlabels="Percentage")),Object.prototype.hasOwnProperty.call(e,"isNew")||(e.isNew=!e.datepattern),function(e){(e.dateFormat||e.datepattern)&&$("#macro-param-datepattern").val(e.dateFormat||e.datepattern);(e["tfc-height"]||e.height)&&$("#macro-param-tfc-height").val(e["tfc-height"]||e.height);(e["tfc-width"]||e.width)&&$("#macro-param-tfc-width").val(e["tfc-width"]||e.width);(e.separator||e.decimalSeparator)&&$("#macro-param-separator").val(e.separator||e.decimalSeparator);$("#macro-param-hide").val(e.hide||e.hideSource||"false"),("true"==e.hideControls||"true"==e.hidecontrols)&&$("#macro-param-hidecontrols").prop("checked",!0);"false"==e.grid?$("#macro-param-grid").prop("checked",!1):$("#macro-param-grid").prop("checked",!0);"string"==typeof e.legend?"false"==e.legend?e.legend="none":"true"==e.legend&&(e.legend="right"):e.legend||void 0===e.legend?e.legend="right":e.legend="none";$("#macro-param-legend").val(e.legend),e.minvalue&&$("#macro-param-minvalue").val(e.minvalue);e.maxvalue&&$("#macro-param-maxvalue").val(e.maxvalue);e.xminvalue&&$("#macro-param-xminvalue").val(e.xminvalue);e.xmaxvalue&&$("#macro-param-xmaxvalue").val(e.xmaxvalue);e.scalestep&&$("#macro-param-scalestep").val(e.scalestep);e.xscalestep&&$("#macro-param-xscalestep").val(e.xscalestep);e.title&&$("#macro-param-title").val(e.title);e.xtitle&&$("#macro-param-xtitle").val(e.xtitle);e.ytitle&&$("#macro-param-ytitle").val(e.ytitle);"true"==e.log&&$("#macro-param-log").prop("checked",!0);"true"==e.xlog&&$("#macro-param-xlog").prop("checked",!0);"true"==e.trendline&&$("#macro-param-trendline").prop("checked",!0);e.tabs&&$("#macro-param-tabs").prop("checked",!0);e.is3d&&$("#macro-param-is3d").prop("checked",!0);e.interpolation&&$("#macro-param-interpolation").val(e.interpolation);e["line-settings"]&&$("#macro-param-line-settings").val(e["line-settings"])}(e),t.columnInput=$("#macro-param-column"),t.aggregateInput=$("#macro-param-aggregation"),t.columnSelect=Z(t.columnInput,t.tableColumns,t.columnParams,t.aggregateParams,[],t),t.aggregateSelect=Z(t.aggregateInput,t.tableColumns,t.aggregateParams,[],t.colors,t),t.typeSelect=$("#macro-param-type"),$(".search-field input").one("focus",(function(){$(".search-choice").css("max-width",$(".chosen-container").width()-40)})),t.dateFormatInput=$("#macro-param-datepattern"),r.default.initDateFormatInput(e),d.default.initMacroBrowserWorklogDialog(e.worklog);var o=$("#macro-param-div-colors"),i=$("#macro-param-div-column"),n=$("#macro-param-div-aggregation"),s=$("#macro-param-div-scalestep"),u=$("#macro-param-div-xscalestep"),p=$("#macro-param-div-type"),m=$("#macro-param-div-maxvalue");s.find(".macro-param-desc").addClass("chart-browser-hidden");var g="Gantt"===e.type;t.typeSelect.change((function(){var e=!0;t.isPie="Pie"===t.typeSelect.val()||"Donut"===t.typeSelect.val(),t.isBar=t.typeSelect.val().indexOf("Bar")>=0||t.typeSelect.val().indexOf("Column")>=0,t.isGantt="Gantt"===t.typeSelect.val(),t.isBubblePie="Bubble Pie"===t.typeSelect.val(),t.isMultipleChoice=t.isBar||t.typeSelect.val().indexOf("Line")>=0||t.typeSelect.val().indexOf("Area")>=0||t.isGantt,s.find(".macro-param-desc").text("For scale X enter number of days (X), weeks (Xw), months (Xm) or years (Xy)"),t.isBubblePie?te(s.find(".macro-param-desc").text("For time scales enter number of hours (Xh/Yh), days (X/Y), months (Xm/Ym) or years (Xy/Yy)").removeClass("gantt")):t.typeSelect.val().indexOf("Time")>=0?te(s.find(".macro-param-desc").removeClass("gantt")):(t.isGantt?te(s.find(".macro-param-desc").addClass("gantt")):ee(s.find(".macro-param-desc")),e="Line"===t.typeSelect.val()||"Area"===t.typeSelect.val()||"Stacked Area"===t.typeSelect.val()),t.isPivot&&(ee(i),t.tableColumns.length>2?n.show():ee(n)),(t.isGantt?!g:g)&&(g&&t.columnParams.length>1&&(t.columnParams.length=1,t.columnSelect.find("option:selected").removeAttr("selected"),t.columnSelect.find("option").filter((function(){return this.textContent==t.columnParams[0]})).attr("selected","selected"),t.columnInput.val(t.columnParams[0]),t.columnSelect.trigger("chosen:updated")),g=t.isGantt),u.removeClass("gantt"),p.removeClass("short"),e||t.isBubblePie?s.addClass("multiple").css("display",""):(t.isGantt?u.addClass("gantt"):p.addClass("short"),s.removeClass("multiple")),-1!==t.typeSelect.val().indexOf("Radar")?m.addClass("wide"):m.removeClass("wide")})),e.type||(e.type="Pie"),c.initSelects(a,e,H.CHART),$("#macro-param-dataorientation").change((function(){t.transpose="Horizontal"==$(this).val(),t.tables=f.default.transpose(t.tables),t.tableColumns=f.default.getColumns(t.tables);var e=f.default.getRawColumns(t.tables);t.columnSelect.find("option").remove(),t.aggregateSelect.find("option").remove(),t.columnParams.length=0,t.aggregateParams.length=0,$.each(t.tableColumns,(function(e,a){t.columnSelect.append($("<option></option>").text(a)),t.aggregateSelect.append($("<option></option>").text(a))})),t.columnSelect.val(e[0]).trigger("change",{selected:e[0]}).trigger("chosen:updated"),t.aggregateSelect.val(e[1]).trigger("change",{selected:e[1]}).trigger("chosen:updated")})),t.TableChart.typeSelect=t.typeSelect,t.updatePieKeys(),d.default.initMacroBrowserChartColorsDialog(t,o),t.initInterpolationDialog(),t.initLineSettingsDialog(),function(){$("#macro-param-div-type").before(R().chartTabs());var e=[$("#macro-param-div-column"),$("#macro-param-div-aggregation"),$("#macro-param-div-type"),$("#macro-param-div-is3d")],t=[$("#macro-param-div-tfc-height"),$("#macro-param-div-tfc-width"),$("#macro-param-div-colors"),$("#macro-param-div-align"),$("#macro-param-div-legend"),$("#macro-param-div-grid"),$("#macro-param-div-hide"),$("#macro-param-div-hidecontrols"),$("#macro-param-div-title"),$("#macro-param-div-xtitle"),$("#macro-param-div-ytitle"),$("#macro-param-div-innerlabels"),$("#macro-param-div-outerLabels"),$("#macro-param-div-line-settings")],a=[$("#macro-param-div-datepattern"),$("#macro-param-div-separator"),$("#macro-param-div-dataorientation"),$("#macro-param-div-xminvalue"),$("#macro-param-div-xmaxvalue"),$("#macro-param-div-minvalue"),$("#macro-param-div-maxvalue"),$("#macro-param-div-xscalestep"),$("#macro-param-div-scalestep"),$("#macro-param-div-log"),$("#macro-param-div-xlog"),$("#macro-param-div-interpolation"),$("#macro-param-div-trendline"),$("#macro-param-div-worklog"),$("#macro-param-div-tabs")];$(".tf-macrobrowser-tabs a").attr("disabled","disabled");var r=$("#tab-columns"),l=$("#tab-display-options"),o=$("#tab-advanced-options"),i=[r,l,o];function n(e){a(e[0],"in");for(var t=1;t<e.length;t++)a(e[t],"out");function a(e,t){for(var a=0;a<e.length;a++)"in"==t?e[a].removeClass("chart-browser-hidden-by-tab"):e[a].addClass("chart-browser-hidden-by-tab")}}function s(e){e.hasClass("active-tab")||(i.forEach((function(e){e.removeClass("active-tab")})),e.addClass("active-tab"))}r.click((function(){r.hasClass("active-tab")||(s(r),n([e,t,a]))})),l.click((function(){l.hasClass("active-tab")||(s(l),n([t,e,a]))})),o.click((function(){o.hasClass("active-tab")||(s(o),n([a,e,t]))})),r.trigger("click")}()},Y.prototype.initInterpolationDialog=function(){d.default.initMacroBrowserInterpolationDialog(this,$("#macro-param-div-interpolation"))},Y.prototype.initLineSettingsDialog=function(){d.default.initMacroBrowserLineSettingsDialog(this,$("#macro-param-div-line-settings"))},Y.prototype.initTableChart=function(e){var t=this;t.TableChart=new Q.default({macroId:"editor",type:e.type,columns:e.column,aggregation:e.aggregation,dateFormat:e.datepattern,separator:e.separator,pageId:0,dataorientation:e.dataorientation,colors:e.colors,colorColumns:e.colorColumns,pieKeys:e.pieKeys,worklog:e.worklog,sessionId:0,barColoringType:e.barColoringType,lineSettings:e["line-settings"],interpolation:e.interpolation,ganttArrows:e.ganttArrows}),t.TableChart.content=$(),t.TableChart.wrapper=$(),t.TableChart.is3DWrapper=$()},Y.prototype.calculateColors=function(){var e=this,t=this.TableChart;t.colors=e.colors,t.pieKeys=e.pieKeys,t.columns=e.columnParams.slice(),t.columnsCache=e.columnParams.slice(),t.aggregation=e.aggregateParams.slice(),t.aggregationCache=e.aggregateParams.slice(),t.transpose=e.transpose,t.dateFormat=e.dateFormatInput.val(),t.getType(),f.default.updateI18nSettings([f.default.getRawColumns(t.tables)],[t.columns,t.columnsCache,t.aggregation,t.aggregationCache],f.default.getLocale(),t.chartBody),t.setIsMultiColorColumn(),t.resetDateFormats();var a=f.default.getRawColumns(t.tables);return 1===t.columns.length&&-1===a.indexOf(t.columns[0])&&(t.columns=[]),1===t.aggregation.length&&-1===a.indexOf(t.aggregation[0])&&(t.aggregation=[]),0===t.columns.length&&void 0!==a[0]&&t.columns.push(a[0]),t.isPivot?0===t.aggregation.length&&void 0!==a[a.length-1]&&t.aggregation.push(a[a.length-1]):0===t.aggregation.length&&t.aggregation.push(a[1]),t.calculate(),t.getColorsData()},Y.prototype.applyColors=function(e){this.pieKeys=e.pieKeys,this.colors=e.colors,this.chartKeys=e.chartKeys},Y.prototype.updatePieKeys=function(){this.TableChart.resetColorKeyMap();var e=this.calculateColors();this.applyColors(e)},Y.prototype.getTrimmedColors=function(){var e=this;e.TableChart.columnsCache=e.columnParams.slice(),e.TableChart.aggregationCache=e.aggregateParams.slice();var t=e.TableChart.getAllChartColorLabels(),a=e.TableChart.getColorsFromMap(e.TableChart.colorKeyMap,t,e.TableChart.palette);return(a=a.slice(0,t.length)).length&&(e.colors=a),e.colors},Y.prototype.setTables=function(e){var t=this;t.TableChart.chartBody=$('<div class="chart-body">'+e+"</div>"),t.TableChart.checkPivotContent(),t.TableChart.getOriginalTable()},Y.prototype.updateColumns=function(e,t){var a=this;function l(e){var r=!1;a.setTables(t?e:e.html());var l=f.default.getRelevantRows(a.TableChart.rows,a.transpose);a.tables=[];var o=a.TableChart.tables;$.each(o,(function(e,t){var r=[];$.each(t,(function(t,a){l[e][t]&&r.push(a)})),a.tables.push(r)})),$.each(f.default.getRawColumns(a.tables),(function(e,t){if(-1==$.inArray(t,a.tableColumns)){var l;r=!0,a.tableColumns.push(t),0===a.columnParams.length&&0===e?(a.columnParams.push(t),a.columnInput.val(t),l=!0):l=$.inArray(t,a.columnParams)>=0;var o=l?'selected="selected"':"";a.columnSelect.append($("<option "+o+"></option>").text(t)),0===a.aggregateParams.length&&1===e?(a.aggregateParams.push(t),a.aggregateInput.val(t),l=!0):l=$.inArray(t,a.aggregateParams)>=0,o=l?'selected="selected"':"",a.aggregateSelect.append($("<option "+o+"></option>").text(t))}})),a.isPivot&&a.tableColumns.length>2&&($("#macro-param-div-aggregation").removeClass("chart-browser-hidden"),a.typeSelect.find("option").each((function(){var e=$(this);"Line"!=e.val()&&"Area"!=e.val()&&"Stacked Area"!=e.val()||e.show()}))),r&&(a.columnSelect.trigger("chosen:updated"),a.aggregateSelect.trigger("chosen:updated"),f.default.sortSelectedOptions(a.columnSelect,a.columnParams),f.default.sortSelectedOptions(a.aggregateSelect,a.aggregateParams)),a.typeSelect.trigger("change"),a.updatePieKeys()}r.default.bindPreview(e,l),f.default.addIframe(e,"chart-body",(function(e){a.updateColumns(e.parent())})),l(e)};var ae,re=Y,le=!1,oe=function(){this.tableChartMacro=null};function ie(e){return null==e.tableChartMacro&&(e.tableChartMacro=new re,e.tableChartMacro.storedParams={},e.tableChartMacro.isSaveClick=!1,e.tableChartMacro.isSetParams=!1,e.tableChartMacro.hasTable=!1),e.tableChartMacro}oe.prototype.getMacroDetailsFromSelectedMacro=function(e,t){le=!1,ae.bodyView=J.convertStorageToView(t),ie(ae).getMacroDetails(ae.bodyView,t.params,!1),J.showTabsParam(ae.bodyView),ae.tableChartMacro.hasTable=ae.bodyView.indexOf("table")>0},oe.prototype.beforeParamsRetrieved=function(e){var t=ae.tableChartMacro;return le||(t.columnSelect.trigger("chosen:updated"),t.aggregateSelect.trigger("chosen:updated"),f.default.sortSelectedOptions(t.columnSelect,t.columnParams),f.default.sortSelectedOptions(t.aggregateSelect,t.aggregateParams),le=!0),e.barColoringType=t.TableChart.barColoringType,e.colors=t.getTrimmedColors().join(","),e.colorColumns=t.TableChart.colorColumns.join(","),e.pieKeys=t.pieKeys.join(""),t.isSaveClick&&(e.isFirstTimeEnter&&S.default.gaChartInsert(t.tables.length),S.default.gaEditorChart(e,t.storedParams)),t.isSetParams&&(t.storedParams=e||{}),e},oe.prototype.postPreview=function(e){var t=ae.tableChartMacro;t.updateColumns($(e).contents().find(".chart-body")),t.isSaveClick=!1,t.isSetParams=!1},oe.prototype.manipulateMarkup=function(e){return ae.tableChartMacro.isSaveClick=!0,ae.tableChartMacro.isSetParams=!1,e},oe.prototype.beforeParamsSet=function(e){$(".tfc-container").remove();var t=ie(ae);return t.gotBody||ae.getMacroDetailsFromSelectedMacro(null,{body:tinymce.activeEditor.selection.getContent(),params:e}),t.gotBody=!1,t.transformElements(e),e.id=(new Date).getTime()+"_"+(0,O.hashCode)(t.tfBody),J.showTabsParam(ae.bodyView),t.isSaveClick=!1,t.isSetParams=!0,e.isFirstTimeEnter=t.hasTable?void 0===e.isFirstTimeEnter:void 0,e};var ne=ae=new oe,se=function(){this.tables=[],this.tableColumns=[],this.columnSelect=null,this.rowSelect=null,this.aggregateSelect=null,this.tfBody="",this.typeParams=[],this.columnParams=[],this.rowParams=[],this.aggregateParams=[],this.sortColumns=[],this.gotBody=!1};function ce(e,t,a,r,l){e.hide();var o=[];a.forEach((function(e){o.push(e.replace("",""))}));var i=$("<select multiple/>");return $.each(o,(function(e,a){a=$.trim(a),-1==$.inArray(a,t)&&t.push(a)})),t.sort((function(e,t){return e.localeCompare(t)})),$.each(t,(function(e,t){var a=-1==$.inArray(t,o)?"":'selected="selected" ';i.append($("<option "+a+"></option>").text(t))})),e.after(i),ue(i,e,a,r,l),i}function ue(e,t,a,r,l){e.chosenTF({no_results_text:r?"No matches found. Press \u0027Enter\u0027 to add":"No matches for",placeholder_text_multiple:"Click and start typing...",width:"100%",display_selected_options:!1,addUserOption:r}).change((function(r,o){if(null!=o.selected)e.find("option").filter((function(){return this.textContent==o.selected})).prop("selected",!0),""==(i=o.selected)&&(i=""),a.push(i);else if(null!=o.deselected){var i;e.find("option").filter((function(){return this.textContent==o.deselected})).prop("selected",!1),""==(i=o.deselected)&&(i=""),a.splice($.inArray(i,a),1)}if("macro-param-column"==t.attr("id")){var n=l.sortSelect.parent();null!=e.val()&&e.val().length>1&&!n.hasClass("tf-always-hidden")?n.addClass("tf-always-hidden"):(null==e.val()||e.val().length<=1)&&n.removeClass("tf-always-hidden")}l.updateSortOptions(),t.val(a.join(""))}));var o=f.default.sortSelectedOptions(e,a);o.sortable({tolerance:"pointer",cursor:"move",helper:"clone",items:".search-choice",stop:function(){a.length=0,o.find(".search-choice").each((function(){var e=this.textContent;""==e&&(e=""),a.push(e)})),t.val(a.join(""))}})}se.prototype.getMacroDetails=function(e){var t=this;t.gotBody=!0,t.tfBody=e;var a=$('<div class="original-table">'+e+"</div>");t.tables=f.default.getTables(a,f.default.textType,"tf-numbering"),t.tableColumns=f.default.getColumns(t.tables)},se.prototype.transformElements=function(e){var t=this,a={vvpattern:{v:{title:"Number"},p:{title:"Percentage"},vp:{title:"Number (Percentage)"},pv:{title:"Percentage (Number)"}},decimalseparator:{"Point (.)":{title:"Point (.)"},"Comma (,)":{title:"Comma (,)"}},separator:{"":{title:""},"Space ( )":{title:"Space ( )"},"Point (.)":{title:"Point (.)"},"Comma (,)":{title:"Comma (,)"}},dateaccuracy:{Day:{title:"Day"},None:{title:"None"},Hour:{title:"Hour"},Week:{title:"Week"},Month:{title:"Month"},Quarter:{title:"Quarter"},Year:{title:"Year"}},type:{"":{title:""},Count:{title:"Count"},Sum:{title:"Sum"},Average:{title:"Average"},Multiplication:{title:"Multiplication"},Max:{title:"Max"},Min:{title:"Min"},Literal:{title:"Literal"},__multiSelect:!0},showrawdata:{false:{title:"Hide tables"},true:{title:"Show all content"},all:{title:"Hide all content"}}};if($("#macro-browser-dialog .macro-desc .macro-doco-link").before("Post \u003ca href=\u0022https://stiltsoft.customercase.com/forums/table-filter-for-confluence/ideas/create?from=macro\u0022\u003eIdea\u003c/a\u003e or \u003ca href=\u0022https://jsd.stiltsoft.com/servicedesk/customer/portal/2?from=macro\u0022\u003eIssue\u003c/a\u003e.   "),$("#macro-param-div-id").hide(),e.column?(t.columnParams=e.column.split(""),$.each(t.columnParams,(function(e,a){t.columnParams[e]=$.trim(a)}))):t.columnParams=[],e.row?(t.rowParams=e.row.split(""),$.each(t.rowParams,(function(e,a){t.rowParams[e]=$.trim(a)}))):t.rowParams=[],e.aggregation?(t.aggregateParams=e.aggregation.split(""),$.each(t.aggregateParams,(function(e,a){t.aggregateParams[e]=$.trim(a)}))):t.aggregateParams=[],t.typeParams=["Count"],e.type&&(t.typeParams=e.type.split("")),e.version||2==t.columnParams.length&&(t.rowParams=[t.columnParams[1]],t.columnParams.length=1),e.sort&&(e.sort=e.sort.replace(" (Desc)"," ").replace(" (Asc)"," ").split(",")),!e.version||1==e.version){e.version=2;var l=t.typeParams[t.typeParams.length-1];"Count"==l||0==t.aggregateParams.length?e.sort=l+" ":e.sort=l+" of "+t.aggregateParams[t.aggregateParams.length-1]+" "}Object.prototype.hasOwnProperty.call(e,"isNew")||(e.isNew=!e.datepattern),function(e){(e.decimalSeparator||e.decimalseparator)&&$("#macro-param-decimalseparator").val(e.decimalSeparator||e.decimalseparator);e.decimals&&$("#macro-param-decimals").val(e.decimals);e.separator&&$("#macro-param-separator").val(e.separator);$("#macro-param-showrawdata").val(e.showrawdata||"false"),"true"==e.hidePane&&$("#macro-param-hidePane").prop("checked",!0);e.ddSeparator&&$("#macro-param-ddSeparator").val(e.ddSeparator);e.dateaccuracy&&$("#macro-param-dateaccuracy").val(e.dateaccuracy);"true"==e.hideTotal&&$("#macro-param-hideTotal").prop("checked",!0);e.numberaccuracy&&$("#macro-param-numberaccuracy").val(e.numberaccuracy);"true"===e.cumulative&&$("#macro-param-cumulative").prop("checked",!0);e.literalseparator&&$("#macro-param-literalseparator").val(e.literalseparator);e.tabs&&$("#macro-param-tabs").prop("checked",!0);e.vvpattern&&$("#macro-param-vvpattern").val(e.vvpattern)}(e);var o=$.merge([],t.columnParams);$.merge(o,t.rowParams),$.merge(o,t.aggregateParams),$.each(o,(function(e,a){a=a.replace("",""),-1==$.inArray(a,t.tableColumns)&&t.tableColumns.push(a)})),t.columnSelect=ce($("#macro-param-column"),t.tableColumns,t.columnParams,!0,t),t.rowSelect=ce($("#macro-param-row"),t.tableColumns,t.rowParams,!0,t),t.aggregateSelect=ce($("#macro-param-aggregation"),t.tableColumns,t.aggregateParams,!0,t),t.sortSelect=$("#macro-param-sort"),t.sortSelect.chosenTF(),$(".search-field input").one("focus",(function(){$(".search-choice").css("max-width",$(".chosen-container").width()-40)})),r.default.initDateFormatInput(e),r.default.initDecimalPlacesInput(e),d.default.initMacroBrowserWorklogDialog(e.worklog),f.default.inputAutocomplete($("#macro-param-literalseparator"),null,[{label:"None",value:""},{label:"Comma",value:", "},{label:"Semicolon",value:"; "},{label:"Space",value:"\\u0020"},{label:"Line break",value:"\\n"},{label:"Bulleted list",value:"<ul>"},{label:"Numbered list",value:"<ol>"}]);var i=$("#macro-param-type");i.attr("multiple","multiple"),i.find("option").each((function(){var e=$(this);-1==$.inArray(e.val(),t.typeParams)?e.prop("selected",!1):e.prop("selected",!0)})),c.initSelects(a,e,H.PIVOT),ue(i,$("<input>"),t.typeParams,!1,t),function(){$("#macro-param-div-column").before(R().pivotTabs());var e=[$("#macro-param-div-column"),$("#macro-param-div-row"),$("#macro-param-div-aggregation"),$("#macro-param-div-type")],t=[$("#macro-param-div-sort"),$("#macro-param-div-decimalseparator"),$("#macro-param-div-separator"),$("#macro-param-div-decimals"),$("#macro-param-div-showrawdata"),$("#macro-param-div-hidePane"),$("#macro-param-div-ddSeparator"),$("#macro-param-div-vvpattern"),$("#macro-param-div-datepattern"),$("#macro-param-div-dateaccuracy"),$("#macro-param-div-numberaccuracy"),$("#macro-param-div-cumulative"),$("#macro-param-div-worklog"),$("#macro-param-div-hideTotal"),$("#macro-param-div-tabs"),$("#macro-param-div-literalseparator")];$(".tf-macrobrowser-tabs a").attr("disabled","disabled");var a=$("#tab-columns"),r=$("#tab-options"),l=[a,r];function o(e){function t(e,t){for(var a=0;a<e.length;a++)"in"==t?e[a].show():e[a].hide()}t(e[0],"in"),t(e[1],"out")}function i(e){e.hasClass("active-tab")||(l.forEach((function(e){e.removeClass("active-tab")})),e.addClass("active-tab"))}a.click((function(){i(a),o([e,t])})),r.click((function(){i(r),o([t,e])})),a.trigger("click")}(),t.updateSortOptions(e.sort);var n=$("#macro-param-div-literalseparator");-1===t.typeParams.indexOf("Literal")&&n.addClass("tf-always-hidden"),i.change((function(){-1===t.typeParams.indexOf("Literal")?n.addClass("tf-always-hidden"):n.removeClass("tf-always-hidden")})),i.on("chosen:showing_dropdown",(function(){$(".macro-input-fields").animate({scrollTop:$(".macro-input-fields form.aui").height()},750)})),2==e.version&&($("#macro-param-literalseparator").val(", "),e.version=3)},se.prototype.updateSortOptions=function(e){var t=this,a=e||t.sortSelect.val();function r(e,a,i){var n=f.default.getCellPosition(i,t.rowParams[a]);null!=n?$.each(i,(function(s,c){0!=s&&(a+1<t.rowParams.length?(r(e+" "+c[n],a+1,l(i,n,c[n])),r(e,a+1,l(i,n,c[n]))):o(e+" "+c[n]))})):a+1<t.rowParams.length&&r(e,a+1,i),o(e)}function l(e,t,a){var r=[];return $.each(e,(function(e,l){0!=e&&l[t]!=a||r.push(l)})),r}function o(e){$.trim(e).length&&(-1==$.inArray(e+" ",t.sortColumns)&&t.sortColumns.push(e+" "),-1==$.inArray(e+" ",t.sortColumns)&&t.sortColumns.push(e+" "))}t.sortColumns=[],t.sortSelect.empty().append('<option selected="selected" value="false"></option>').append('<option value="-as_is-">'+"Preserve the original sorting order"+"</option>"),t.columnParams.length<=1&&(o(t.columnParams[0]),$.each(t.tables,(function(e,a){$.each(t.typeParams,(function(e,l){t.rowParams.length>0?"Count"==l?r(l,0,a):$.each(t.aggregateParams,(function(e,t){r(l+" of "+t,0,a)})):"Count"==l?o(l):$.each(t.aggregateParams,(function(e,t){o(l+" of "+t)}))}))}))),$.each(t.sortColumns.sort((function(e,t){return e.localeCompare(t)})),(function(e,a){t.sortSelect.append($("<option></option>").val(a).text(a))})),t.sortSelect.val(a),t.sortSelect.trigger("chosen:updated")},se.prototype.updateColumns=function(e){var t=this;function a(e){var a=!1;f.default.normalizeTable(e,"data-tf-ready"),t.tables=f.default.getTables(e,f.default.textType,"tf-numbering"),$.each(f.default.getRawColumns(t.tables),(function(e,r){-1==$.inArray(r,t.tableColumns)&&(a=!0,t.tableColumns.push(r),t.columnSelect.append($("<option></option>").val(r).text(r)),t.rowSelect.append($("<option></option>").val(r).text(r)),t.aggregateSelect.append($("<option></option>").val(r).text(r)))})),a&&(f.default.sortSelectOptions(t.columnSelect),f.default.sortSelectOptions(t.rowSelect),f.default.sortSelectOptions(t.aggregateSelect),t.columnSelect.trigger("chosen:updated"),t.rowSelect.trigger("chosen:updated"),t.aggregateSelect.trigger("chosen:updated"),f.default.sortSelectedOptions(t.columnSelect,t.columnParams),f.default.sortSelectedOptions(t.rowSelect,t.rowParams),f.default.sortSelectedOptions(t.aggregateSelect,t.aggregateParams))}t.body=e,r.default.bindPreview(e,a),f.default.addIframe(e,"original-table",(function(e){a(e.parent())})),a(e)};var pe,me=se,de=!1,fe=function(){this.pivotTableMacro=new me,this.pivotTableMacro.storedParams={},this.pivotTableMacro.isSaveClick=!1,this.pivotTableMacro.isSetParams=!1,this.pivotTableMacro.hasTable=!1};fe.prototype.getMacroDetailsFromSelectedMacro=function(e,t){de=!1,pe.bodyView=J.convertStorageToView({body:t.body}),pe.pivotTableMacro.getMacroDetails(pe.bodyView),J.showTabsParam(pe.bodyView),pe.pivotTableMacro.hasTable=pe.bodyView.indexOf("table")>0},fe.prototype.postPreview=function(e){var t=pe.pivotTableMacro;t.updateColumns($(e).contents().find(".original-table")),t.isSaveClick=!1,t.isSetParams=!1},fe.prototype.beforeParamsSet=function(e){var t=pe.pivotTableMacro;return t.gotBody||pe.getMacroDetailsFromSelectedMacro(null,{body:tinymce.activeEditor.selection.getContent()}),t.gotBody=!1,t.transformElements(e),e.id=(new Date).getTime()+"_"+(0,O.hashCode)(t.tfBody),J.showTabsParam(pe.bodyView),t.isSaveClick=!1,t.isSetParams=!0,e.isFirstTimeEnter=t.hasTable?void 0===e.isFirstTimeEnter:void 0,e},fe.prototype.manipulateMarkup=function(e){return pe.pivotTableMacro.isSaveClick=!0,pe.pivotTableMacro.isSetParams=!1,e},fe.prototype.beforeParamsRetrieved=function(e){var t=pe.pivotTableMacro;return de||(t.columnSelect.trigger("chosen:updated"),t.rowSelect.trigger("chosen:updated"),t.aggregateSelect.trigger("chosen:updated"),f.default.sortSelectedOptions(t.columnSelect,t.columnParams),f.default.sortSelectedOptions(t.rowSelect,t.rowParams),f.default.sortSelectedOptions(t.aggregateSelect,t.aggregateParams),de=!0),e.type=t.typeParams.join(""),t.isSaveClick&&(e.isFirstTimeEnter&&S.default.gaPivotInsert(t.tables.length),S.default.gaEditorPivot(e,t.storedParams)),t.isSetParams&&(t.storedParams=e||{}),e};var ge=pe=new fe,be=a(7945),he=a.n(be),ve=a(6834),Se=a(9476),ye=a.n(Se),xe=a(5689);function $e(e){return($e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function we(e,t,a,r,l,o,i){try{var n=e[o](i),s=n.value}catch(e){return void a(e)}n.done?t(s):Promise.resolve(s).then(r,l)}function Te(e){return function(){var t=this,a=arguments;return new Promise((function(r,l){var o=e.apply(t,a);function i(e){we(o,r,l,i,n,"next",e)}function n(e){we(o,r,l,i,n,"throw",e)}i(void 0)}))}}function Ce(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function Pe(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Ce(Object(a),!0).forEach((function(t){Ae(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Ce(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Ae(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Ie(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Je(){return(Je="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,a){var r=Oe(e,t);if(r){var l=Object.getOwnPropertyDescriptor(r,t);return l.get?l.get.call(arguments.length<3?e:a):l.value}}).apply(this,arguments)}function Oe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Fe(e)););return e}function ke(e,t){return(ke=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Me(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=Fe(e);if(t){var l=Fe(this).constructor;a=Reflect.construct(r,arguments,l)}else a=r.apply(this,arguments);return De(this,a)}}function De(e,t){if(t&&("object"===$e(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Fe(e){return(Fe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var _e=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ke(e,t)}(n,e);var t,a,r,l,o,i=Me(n);function n(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);var a=function(e){e.params=e.params?e.params:{};var t=!(e.params.attachment||e.params.data),a=$(ye().macroDialog({isInsert:t,id:"spreadsheet"+(new Date).getTime()}));return AJS.dialog2(a).show(),{dialog:a,isInsert:t}}(e),r=a.dialog,l=a.isInsert,o=f.default.getContentId(),s=AJS.params.spaceKey;return(t=i.call(this,Pe(Pe({},e.params),{},{pageId:o,spaceKey:s,exit:function(){return t.onCancel()},save:function(){var e;return(e=t).saveAttachment.apply(e,arguments)}}),r.find("iframe"))).isInsert=l,t.dialog=r,t.macro=e,t.title=e.params.attachment,t.saved=!1,t}return t=n,(a=[{key:"init",value:(o=Te(he().mark((function e(){var t=this;return he().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Je(Fe(n.prototype),"init",this).call(this),this.dialog.find("button.cancel").one("click",(function(){t.title!==t.macro.params.attachment||t.macro.params.data?t.onSave():t.onCancel()})),this.dialog.find("button.save").one("click",(function(){t.spreadsheetModule&&t.saveAttachment(t.spreadsheetModule.dataString,t.spreadsheetModule.name,!0)}));case 3:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"saveAttachment",value:function(e,t,a){"template"===AJS.params.contentType?this.macro.params={data:e}:((0,xe.storeAttachment)(this.params.pageId,this.params.spaceKey,e,t,AJS.params.newPage),this.macro.params={attachment:t}),this.saved=!0,a&&this.onSave()}},{key:"onSave",value:function(){this.isInsert?S.default.gaSpreadsheetCreate(this.spreadsheetModule.data.length):(S.default.gaSpreadsheetUpdateMacro(this.spreadsheetModule.data.length),this.title!==this.macro.params.attachment&&S.default.gaSpreadsheetSaveAsMacro()),tinymce.confluence.macrobrowser.macroBrowserComplete(this.macro),AJS.dialog2(this.dialog).hide()}},{key:"onCancel",value:function(){this.saved&&S.default.gaSpreadsheetUpdateMacro(this.spreadsheetModule.data.length),tinymce.confluence.macrobrowser.macroBrowserCancel(),AJS.dialog2(this.dialog).hide()}},{key:"openFile",value:(l=Te(he().mark((function e(){var t,a,r,l,o=arguments;return he().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(S.default.gaSpreadsheetOpenMacro(),a=o.length,r=new Array(a),l=0;l<a;l++)r[l]=o[l];return e.next=4,(t=Je(Fe(n.prototype),"openFile",this)).call.apply(t,[this].concat(r));case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})}])&&Ie(t.prototype,a),r&&Ie(t,r),Object.defineProperty(t,"prototype",{writable:!1}),n}(ve.default);function je(e,t,a,r,l,o,i){try{var n=e[o](i),s=n.value}catch(e){return void a(e)}n.done?t(s):Promise.resolve(s).then(r,l)}var Be=function(){var e,t=(e=he().mark((function e(t){return he().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:new _e(t).init();case 2:case"end":return e.stop()}}),e)})),function(){var t=this,a=arguments;return new Promise((function(r,l){var o=e.apply(t,a);function i(e){je(o,r,l,i,n,"next",e)}function n(e){je(o,r,l,i,n,"throw",e)}i(void 0)}))});return function(e){return t.apply(this,arguments)}}();AJS.toInit((function(){AJS.MacroBrowser.setMacroJsOverride("csv-table",new w),AJS.MacroBrowser.setMacroJsOverride("json-from-table",new w),AJS.MacroBrowser.setMacroJsOverride("table-excerpt-include",A),AJS.MacroBrowser.setMacroJsOverride("table-joiner",{opener:k}),AJS.MacroBrowser.setMacroJsOverride("table-filter",X),AJS.MacroBrowser.setMacroJsOverride("table-chart",ne),AJS.MacroBrowser.setMacroJsOverride("pivot-table",ge),AJS.MacroBrowser.setMacroJsOverride("spreadsheet-table",{opener:Be})}))}},a={};function r(e){var l=a[e];if(void 0!==l)return l.exports;var o=a[e]={id:e,loaded:!1,exports:{}};return t[e].call(o.exports,o,o.exports,r),o.loaded=!0,o.exports}r.m=t,r.amdD=function(){throw new Error("define cannot be used indirect")},r.amdO={},e=[],r.O=function(t,a,l,o){if(!a){var i=1/0;for(u=0;u<e.length;u++){a=e[u][0],l=e[u][1],o=e[u][2];for(var n=!0,s=0;s<a.length;s++)(!1&o||i>=o)&&Object.keys(r.O).every((function(e){return r.O[e](a[s])}))?a.splice(s--,1):(n=!1,o<i&&(i=o));if(n){e.splice(u--,1);var c=l();void 0!==c&&(t=c)}}return t}o=o||0;for(var u=e.length;u>0&&e[u-1][2]>o;u--)e[u]=e[u-1];e[u]=[a,l,o]},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,{a:t}),t},r.d=function(e,t){for(var a in t)r.o(t,a)&&!r.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},function(){var e={2560:0,177:0};r.O.j=function(t){return 0===e[t]};var t=function(t,a){var l,o,i=a[0],n=a[1],s=a[2],c=0;if(i.some((function(t){return 0!==e[t]}))){for(l in n)r.o(n,l)&&(r.m[l]=n[l]);if(s)var u=s(r)}for(t&&t(a);c<i.length;c++)o=i[c],r.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return r.O(u)},a=self.webpackChunk=self.webpackChunk||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var l=r.O(void 0,[7945,5546,8342,2166,2434,3926,4818,8353,1706,8265,479,177,7718,9490,4874,6834],(function(){return r(7058)}));l=r.O(l)}();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.tngtech.confluence.plugins.tableenhancer:tableenhancer-macro-browser', location = 'js/tableenhancer-macro-browser.js' */
function setupProject(a){setTimeout(()=>{const b=AJS.$("select#macro-param-sortColumn"),c=a?a.split(","):null;b.val(c).change();const d=AJS.$("#macro-param-div-sortColumn ul.select2-choices");c&&c.reverse().forEach(function(a){const c=d.find(`li.select2-search-choice:contains(${a})`);d.prepend(c);toggleDisabledState(b,a,!0)})},0)}function getOptions(){var a=AJS.MacroBrowser.getMacroBody();a=AJS.$(a).find("tr:first th").length;const b=[];for(let c=1;c<=a;c++)b.push(c+" ASC",c+" DESC");return b}
function loadPossibilities(a){a.empty();getOptions().forEach(b=>{a.append($(`<option value="${b}">${b}</option>`))})}function toggleDisabledState(a,b,c){const [d,e]=b.split(" ");a.find(`option[value="${d+" "+("DESC"===e?"ASC":"DESC")}"]`).attr("disabled",c)}function addSelectListener(a){a.on("change",function(b){b.added&&toggleDisabledState(a,b.added.id,!0);b.removed&&toggleDisabledState(a,b.removed.id,!1)})}
AJS.MacroBrowser.setMacroJsOverride("tableenhancer",{fields:{string:{sortColumn:function(a,b){a=AJS.$(Confluence.Templates.MacroBrowser.macroParameterSelect());const c=AJS.$("select",a);loadPossibilities(c);c.attr("multiple","");c.auiSelect2();addSelectListener(c);return AJS.MacroBrowser.Field(a,c,b)}},boolean:{sortDescending:function(a){return AJS.MacroBrowser.ParameterFields._hidden(a,{})}}},beforeParamsRetrieved:function(a){if(a.sortColumn){const b=AJS.$("#macro-param-div-sortColumn li.select2-search-choice").map((a,
b)=>b.innerText).get();a.sortColumn=b.join(",")}return a},beforeParamsSet:function(a){let b=a.sortColumn;isNaN(b)||(b+="true"===a.sortDescending?" DESC":" ASC");a.sortColumn=b;setupProject(b);return a}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.masterdetail:master-details-macro-browser', location = 'com/atlassian/confluence/extra/masterdetail/js/macro-browser-options.js' */
AJS.toInit(function(a){AJS.MacroBrowser.setMacroJsOverride("detailssummary",{fields:{cqlSelect2CustomOptions:{maximumSelectionSize:"60"}}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'de.scandio.confluence.plugins.hideelements-macro:hideelements-resources-macrobrowser', location = '/hideelements/bundles/bundle-macrobrowser.js' */
(()=>{var e={362:(e,n,t)=>{"use strict";t.r(n);var a=t(222),o=t(34);o.registerHelper("eq",(function(e,n,t){return e===n?t.fn(this):t.inverse(this)})),o.registerHelper("noteq",(function(e,n,t){return e!==n?t.fn(this):t.inverse(this)})),o.registerHelper("hyphenate",(function(){var e=Array.prototype.slice.call(arguments);return e.pop(),e.join("-")})),o.registerHelper("getContextPath",(function(){return a.Hw()})),o.registerHelper("getElementText",(function(e){switch(e){case"confluencelogo":return"Confluence Logo";case"pagehistory":return"Page History";case"jiraissue":return"Jira Issue Link";case"inlinecomment":return"Inline Comment";default:return e[0].toUpperCase()+e.substring(1)}})),o.registerHelper("hasSpaceKey",(function(e){return a.fW()?e.fn(this):e.inverse(this)})),o.registerHelper("notEmpty",(function(e,n){return function(e){return!e||0===function(e){return e?$.isArray(e)?e.length:Object.keys(e).length:0}(e)}(e)?n.inverse(this):n.fn(this)}))},455:(e,n,t)=>{"use strict";t.d(n,{Jb:()=>o,NP:()=>l,Lw:()=>i,Dg:()=>a});var a={ULUL:"L1E1",ULUU:"L2E3",ULVL:"L1E1",ULVU:"L2E3",ULHL:"L1E6",ULHU:"L2E4",UUUL:"L1E1",UUUU:"L3E3",UUVL:"L1E1",UUVU:"L3E3",UUHL:"L1E6",UUHU:"L3E4",VLUL:"L1E1",VLUU:"L2E5",VLVL:"L1E1",VLVU:"L2E5",VLHL:"L1E6",VLHU:"L2E5",VUUL:"L1E1",VUUU:"L3E5",VUVL:"L1E1",VUVU:"L3E5",VUHL:"L1E6",VUHU:"L3E5",HLUL:"L1E1",HLUU:"L2E2",HLVL:"L1E1",HLVU:"L2E2",HLHL:"L1E6",HLHU:"L2E2",HUUL:"L1E1",HUUU:"L3E2",HUVL:"L1E1",HUVU:"L3E2",HUHL:"L1E6",HUHU:"L3E2"};function o(e){return a[e]}function i(e,n,t,a){return e[0].toUpperCase()+n[0].toUpperCase()+t[0].toUpperCase()+a[0].toUpperCase()}function l(e){return o(i(e.attr("data-visibility"),e.attr("data-locked"),e.attr("data-parent-visibility"),e.attr("data-locked-in-parent")))}},222:(e,n,t)=>{"use strict";t.d(n,{Hw:()=>f,OX:()=>k,ew:()=>g,LP:()=>h,fW:()=>y,Cd:()=>b,OH:()=>x,bh:()=>L,wI:()=>E,ZV:()=>v});var a={};t.r(a),t.d(a,{getHiddenElements:()=>r,getInheritedSettings:()=>l});var o=t(968);function i(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,a=new Array(n);t<n;t++)a[t]=e[t];return a}function l(e){var n,t=h(),a=g(),l=e.globalSettings,r=t?e.spaceSettings[t]:null,s={},c=function(e,n){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,n){if(e){if("string"==typeof e)return i(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?i(e,n):void 0}}(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var a=0,o=function(){};return{s:o,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,r=!0,s=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return r=e.done,e},e:function(e){s=!0,l=e},f:function(){try{r||null==t.return||t.return()}finally{if(s)throw l}}}}(e.allElementKeys);try{for(c.s();!(n=c.n()).done;){var u=n.value,d={},p=l.elements[u]||{},f=r&&r.elements[u]||{};a?(d.hidden=null,d.locked=null,d.parentHidden=o.Es(p.hidden),d.lockedInParent=o.jk(p.locked),d.lockedInParent||(o.le(f.hidden)&&(d.parentHidden=o.Es(f.hidden)),d.lockedInParent=o.jk(f.locked))):t?(d.hidden=o.Es(f.hidden),d.locked=o.jk(f.locked),d.parentHidden=o.Es(p.hidden),d.lockedInParent=o.jk(p.locked)):(d.hidden=o.Es(p.hidden),d.locked=o.jk(p.locked),d.parentHidden=null,d.lockedInParent=!1),s[u]=d}}catch(e){c.e(e)}finally{c.f()}var m={value:l.cssSelector,locked:o.jk(l.cssSelectorLocked),lockedInParent:o.jk(null)};return t&&(m.lockedInParent=m.locked,m.locked=o.jk(r&&r.cssSelectorLocked),r&&r.cssSelector&&!m.lockedInParent&&(m.value=r.cssSelector)),a&&(m.lockedInParent=m.locked,m.locked=null),{elements:s,cssSelector:m}}function r(e,n){var t=[];for(var a in e.elements){var o=e.elements[a];if(o.lockedInParent&&o.parentHidden)t.push(a);else if(o.lockedInParent&&!o.parentHidden);else{var i=n.elements[a];void 0!==i?(!0===i.hidden||!1!==i.hidden&&o.hidden)&&t.push(a):(o.hidden||!1!==o.hidden&&o.parentHidden)&&t.push(a)}}return t}function s(e,n,t,a,o,i,l){try{var r=e[i](l),s=r.value}catch(e){return void t(e)}r.done?n(s):Promise.resolve(s).then(a,o)}function c(e){return function(){var n=this,t=arguments;return new Promise((function(a,o){var i=e.apply(n,t);function l(e){s(i,a,o,l,r,"next",e)}function r(e){s(i,a,o,l,r,"throw",e)}l(void 0)}))}}var u={warn:p()?AJS.warn:function(){},log:p()?AJS.log:function(){}},d={};function p(){return"undefined"!=typeof AJS}function f(){return m("context-path")}function h(){return m("space-key")}function m(e){return p()&&void 0!==AJS.Meta?AJS.Meta.get(e):""}function v(e){var n="hideelements-resources-".concat(e),t="".concat("de.scandio.confluence.plugins",".").concat("hideelements-macro",":").concat(n,".").concat(n,"-data"),a=null;return d[e]&&(a=d[e]),"WRM"in window&&WRM.data&&WRM.data.claim&&(a=WRM.data.claim(t)),a}function g(){return m("page-id")}function y(){return!!h()}function b(e){p()&&AJS.toInit?AJS.toInit(e):$(document).ready(e)}function k(){return a}function w(e){p()?AJS.flag(e):u.error("Missing AJS for `AJS.flag()`")}function P(e,n){return"<div><strong>".concat(e,"</strong><br/>").concat(n,"</div>")}function L(e){w({body:P(e.title,e.body),type:"error",close:"manual"})}function E(e){w({body:P(e.title,e.body),type:"success",close:"auto"})}function x(e,n,t){return _.apply(this,arguments)}function _(){return(_=c(regeneratorRuntime.mark((function e(n,t,a){var o,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=$(n.target),i=o.closest("form"),o.attr("disabled","disabled"),i.attr("data-status","loading"),e.abrupt("return",$.ajax({type:"POST",url:a,data:JSON.stringify(t),dataType:"json",contentType:"application/json"}).done((function(e){return i.removeAttr("data-status"),o.removeAttr("disabled"),Promise.resolve(e)})).fail((function(e){return i.removeAttr("data-status"),o.removeAttr("disabled"),Promise.reject(e)})));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},898:(e,n,t)=>{"use strict";t.d(n,{m:()=>m,i:()=>v});var a=t(968),o=t(455),i=t(222),l=t(605),r=t.n(l),s=t(966),c=t.n(s),u=t(398),d=t.n(u),p=t(633),f=t.n(p),h=i.OX(),m={config:r(),settings:c(),error:d(),preview:f()};function v(e,n,t){var i=h.getInheritedSettings(e),l={};$.each(i.elements,(function(e,n){var t=a.oI(n.hidden),i=a.oI(n.parentHidden),r=a.CA(n.locked),s=a.CA(n.lockedInParent),c=o.Lw(t,r,i,s);l[e]={visibility:t,parentVisibility:i,locked:r,lockedInParent:s,key:e,iconComboKey:o.Jb(c)}}));var r={value:i.cssSelector.value,locked:a.CA(i.cssSelector.locked),lockedInParent:a.CA(i.cssSelector.lockedInParent)};return r.iconComboKey=o.Jb(o.Lw("visible",r.locked,"visible",r.lockedInParent)),{lockingEnabled:n,scope:t,cssSelector:r,elements:l,warnings:e.warnings}}},968:(e,n,t)=>{"use strict";function a(e){switch(e){case!0:return"hidden";case!1:return"visible";default:return"unset"}}function o(e){return e?"locked":"unlocked"}function i(e){return"locked"===e.attr("data-locked")}function l(e){switch(e.attr("data-visibility")){case"visible":return!1;case"hidden":return!0;default:return null}}function r(e){return"true"===e||"false"!==e&&null}function s(e){return!1===e||!0===e?e:null}function c(e){return e||!1}function u(e){return null!=e}t.d(n,{oI:()=>a,CA:()=>o,p1:()=>i,xj:()=>l,eU:()=>r,Es:()=>s,jk:()=>c,le:()=>u}),t(222)},978:(e,n,t)=>{"use strict";t.d(n,{S:()=>Y});var a,o,i,l,r,s,c=t(968),u=t(222),d=t(455),p=t(898),f={title:".title-text, h1.content-title, h1.with-breadcrumbs",breadcrumb:".breadcrumb-section, .page-metadata-banner",comments:".comments-section, .container > div > .comments",likes:".likes-section, .container > div > .likes",labels:".labels-section",metas:"div.page-metadata > ul, .page-metadata-banner, .content-meta-outer > .content-meta",share:".shareContentLink",sidebar:"div.vsplitbar, .splitter-sidebar, .ia-splitter-left, .ia-splitter-left",watch:".watch-content-button, .content-meta-outer > .content-watch",tools:".action-menu-link, .add-menu-link",favorite:".page-favourite",edit:".editPageLink",create:".create-page-button-preview, .quick-create-page-button-preview",confluencelogo:"div.left.confluence-logo",spaces:"div.left.confluence-spaces-menu",people:"div.left.confluence-people-menu",search:"div.confluence-header-right .confluence-search-bar",help:"div.confluence-header-right .confluence-help-button",admin:"div.confluence-header-right .confluence-admin-button",notifications:"div.confluence-header-right .confluence-notifications-button",profile:"div.confluence-header-right .confluence-profile-button",header:"div.confluence-header",jiraissue:'.inline-dialog-selection-action-panel button[data-key="com.atlassian.confluence.plugins.confluence-jira-content:create-Jira-issue-summary"]',inlinecomment:'.inline-dialog-selection-action-panel button[data-key="com.atlassian.confluence.plugins.confluence-inline-comments:create-inline-comment"]'};function h(){var e=r.position();s.css({top:e.top-38,left:e.left+5})}function m(e,n,t){a&&n&&a(e);var o,i,l,r=$('.he-item-div[data-he-key="'.concat(e,'"]')),s=$('[data-he-key-for="'.concat(e,'"]'));i=(o=r).attr("data-visibility"),l=o.attr("data-parent-visibility"),"hidden"===i||"unset"===i&&"hidden"===l?s.addClass("he-hidden"):s.removeClass("he-hidden"),t&&h()}function v(){for(var e in f)m(e,!1,!1);h()}function g(){i.removeClass("active")}function y(e){i.filter('[data-he-key-for="'.concat(e,'"][data-locked-in-parent="unlocked"]')).addClass("active")}var b,k,w,P,L={E1:{name:"Eye Grey",desc:"Element was made visible by an admin (can NOT be changed)",type:"visibility"},E2:{name:"Eye Red Strikethrough",desc:"Element was explicitly hidden here (can be changed)",type:"visibility"},E3:{name:"Eye Blue",desc:"Element has NOT been set by an admin (can be changed)",type:"visibility"},E4:{name:"Eye Blue Strikethrough",desc:"Element was hidden by an admin (can be changed)",type:"visibility"},E5:{name:"Eye Green",desc:"Element was explicitly made visible here (can be changed)",type:"visibility"},E6:{name:"Eye Grey Strikethrough",desc:"Element was hidden by an admin (can NOT be changed)",type:"visibility"},L1:{name:"Locked Grey",desc:"Visibility was locked by an admin (visibility can NOT be changed)",type:"locking"},L2:{name:"Locked Red",desc:"Visibility was locked here (visibility can be changed here but NOT on levels below)",type:"locking"},L3:{name:"Unlocked Blue",desc:"Visibility has NOT been locked (can be locked here and levels below will NOT be able to change visibility)",type:"locking"},L4:{name:"Unlocked Grey",desc:"Visibility has NOT been locked (and can NOT be locked here)",type:"locking"}};function E(e,n,t,a,o,i,l){try{var r=e[i](l),s=r.value}catch(e){return void t(e)}r.done?n(s):Promise.resolve(s).then(a,o)}function x(e){return function(){var n=this,t=arguments;return new Promise((function(a,o){var i=e.apply(n,t);function l(e){E(i,a,o,l,r,"next",e)}function r(e){E(i,a,o,l,r,"throw",e)}l(void 0)}))}}t(362);var _={title:function(){var e,n=$(this),t=n.closest(".he-icon-container").attr("data-icon-key");return e=n.hasClass("icon-locking")?t.substring(0,2):t.substring(2,4),L[e].desc},delayIn:1e3,gravity:"e"},S={delayIn:500,gravity:$(void 0).attr("data-tooltip-gravity")||"e"};function C(e,n){e.find(".he-icon-container").attr("data-icon-key",d.NP(e)),n||P.removeAttr("disabled")}function O(e){$('.he-item-div:not([data-he-key="cssselector"])').each((function(){e($(this))}))}function I(){var e={};return O((function(n){var t=n.attr("data-he-key");e[t]={hidden:c.xj(n),locked:c.p1(n)}})),{elements:e,cssSelector:w.find("input").val(),cssSelectorLocked:c.p1(w)}}function H(){var e=u.LP();return e?"".concat(u.Hw(),"/rest/hideelements/1.0/spacesettings?spaceKey=").concat(e):"".concat(u.Hw(),"/rest/hideelements/1.0/globalsettings")}function M(e,n){if("locked"!==e.attr("data-locked-in-parent")){var t=e.closest(".he-form"),a=["unset","hidden","visible"],o=e.attr("data-visibility");if(!n){var i=(a.indexOf(o)+1)%a.length;n=a[i]}e.attr("data-visibility",n),t.hasClass("locking-disabled")||e.attr("data-locked","unset"===n?"unlocked":"locked"),C(e)}}function j(){k.removeClass("active")}function U(e){k.filter('[data-he-key="'.concat(e,'"][data-locked-in-parent="unlocked"]')).addClass("active")}function A(e){var n=$(e.target).closest("[data-he-key]");if(e.preventDefault(),"locked"!==n.attr("data-locked-in-parent")&&!$(".he-form").hasClass("locking-disabled")){var t="locked"===n.attr("data-locked")?"unlocked":"locked";n.attr("data-locked",t),C(n)}}function V(e){var n=$(e.target).closest("div[data-he-key]"),t=n.attr("data-he-key");e.preventDefault(),M(n),m(t,!1,!0)}function T(e){e.preventDefault(),O((function(e){$.each(["visibility","parent-visibility","locked","locked-in-parent"],(function(n,t){e.attr("data-"+t,e.attr("data-original-"+t)),C(e,!0)}))})),w.attr("data-locked",w.attr("data-original-locked")).find("input").val(w.attr("data-original-value")),C(w),v()}function D(e){e.preventDefault(),O((function(e){e.attr({"data-visibility":"unset","data-locked":"unlocked"}),C(e,!0)})),w.attr("data-locked","unlocked").find("input").val(""),C(w),v()}function q(e){M($('.he-item-div[data-he-key="'.concat(e,'"]')),"hidden")}function N(e,n){var t=$(this).attr("data-he-key");j(),g(),"mouseenter"!==e.type&&"mouseover"!==e.type||(U(t),y(t))}function R(e,n){j(),"mouseenter"!==e.type&&"mouseover"!==e.type||U(n)}function J(e){var n=$(".he-form");e.preventDefault(),n.hasClass("legend-active")?n.removeClass("legend-active"):n.addClass("legend-active")}function F(e){e.preventDefault(),$(".he-form").removeClass("legend-active")}function B(e){e.preventDefault(),$(e.target).closest(".aui-message").remove()}function W(e){C($(e.target).closest(".he-item-div"))}function G(e){return K.apply(this,arguments)}function K(){return(K=x(regeneratorRuntime.mark((function e(n){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.prev=1,e.next=4,u.OH(n,I(),H());case 4:(t=e.sent).error?u.bh({title:"Error Occurred",body:"".concat(t.error)}):u.wI({title:"Success!",body:"Your settings were saved successfully."}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),u.bh({title:"Error Occurred",body:"Are you connected and logged in?"});case 11:case"end":return e.stop()}}),e,null,[[1,8]])})))).apply(this,arguments)}function Y(e,n){var t;e.append(p.m.settings(n)),k=$("[data-he-key]"),P=$(".aui-button-primary"),function(e,n,t){for(var c in l=$(".hideelements-preview"),r=$(".preview-jiraissue-highlight-text"),s=$(".inline-dialog-selection-action-panel"),a=e,o=n,f)l.find(f[c]).attr({"data-he-key-for":c,"data-locked-in-parent":t.filter('[data-he-key="'.concat(c,'"]')).attr("data-locked-in-parent")});var u,d;i=$("[data-he-key-for]"),v(),u=$(".confluence-header"),d=function(e,n){o&&o(e,n),g(),"mouseenter"!==e.type&&"mouseover"!==e.type||y(n)},$("[data-he-key-for]").on("mouseenter mouseleave",(function(e){d(e,$(this).attr("data-he-key-for"))})),$('[data-he-key-for="header"]').on("mouseover",(function(e){$(e.target).closest(".header-part",u).length||d(e,"header")})),$("[data-he-key-for]").click((function(e){e.preventDefault(),e.stopPropagation(),m($(this).attr("data-he-key-for"),!0,!0)})),$(".hideelements-preview button").click((function(e){e.preventDefault()}))}(q,R,k),t=$(".legend-table-icons tbody"),$.each(L,(function(e,n){t.append('<tr data-name="'.concat(n.name,'" data-key="').concat(e,'">\n\t\t\t\t<td class="he-icon-container" data-icon-key="').concat(e,'">\n\t\t\t\t\t<span class="aui-icon icon-locking icon-locked aui-icon-small aui-iconfont-lock"></span>\n\t\t\t\t\t<span class="aui-icon icon-locking icon-unlocked aui-icon-small aui-iconfont-unlock"></span>\n\t\t\t\t\t<span class="aui-icon icon-eye aui-icon-small aui-iconfont-watch-filled"></span>\n\t\t\t\t</td>\n            \t<td>').concat(n.desc,"</td>\n            </tr>"))})),$.each(d.Dg,(function(e,n){$(".legend-table-states tbody").append("<tr>\n\t\t\t\t<td>".concat(e,'</td>\n\t\t\t\t<td class="he-icon-container" \n\t\t\t\t\tdata-icon-key="').concat(d.Jb(e),'">\n\t\t\t\t\t<span class="aui-icon icon-locking icon-locked aui-icon-small aui-iconfont-lock"></span>\n\t\t\t\t\t<span class="aui-icon icon-locking icon-unlocked aui-icon-small aui-iconfont-unlock"></span>\n\t\t\t\t\t<span class="aui-icon icon-eye aui-icon-small aui-iconfont-watch-filled"></span>\n\t\t\t\t</td>\n\t\t\t</tr>'))})),w=$(".he-item-div-cssselector"),$(".settings-save-button").on("click",G),$("div[data-he-key] .icon-locking").click(A),$("div[data-he-key]").find(".icon-eye, .element-text").click(V),$(".reset-menu .reset-link").click(T),$(".reset-menu .clear-link").click(D),$(".he-legend-button").click(J),$(".hide-legend-button").click(F),$(".he-item-div-cssselector input").on("keyup",W),$(".he-form:not(.locking-disabled) .icon-locking, .icon-eye").tooltip(_),$(".he-markup-based-tooltip").tooltip(S),$(".aui-message .icon-close").click(B),k.on("mouseenter mouseleave",N)}u.Cd((function(){b=u.ZV("settings");var e=$(".hideelements-container");if("settings"===e.attr("data-view")){var n=u.fW()?"space":"global";Y(e,p.i(b,!0,n))}}))},181:(e,n,t)=>{var a=t(655);e.exports=(a.default||a).template({compiler:[8,">= 4.3.0"],main:function(e,n,t,a,o){var i=e.lookupProperty||function(e,n){if(Object.prototype.hasOwnProperty.call(e,n))return e[n]};return'<div class="he-info aui-message aui-message-info closeable">\n    <p class="title">\n        <strong>Welcome to the HideElements configuration!</strong>\n    </p>\n    <p> This is the global HideElements Configuration that contains options for how HideElements\n        can be used with your Confluence instance. If you want to specify the elements to hide, please go to the\n        global <a href="'+e.escapeExpression(i(t,"getContextPath").call(null!=n?n:e.nullContext||{},{name:"getContextPath",hash:{},data:o,loc:{start:{line:7,column:24},end:{line:7,column:42}}}))+'/plugins/servlet/hideelements/settings">HideElements Settings</a>. Please visit our\n        <a href="https://help.livelyapps.com/hideelements-for-confluence-server/" target="_blank">documentation</a> for more information.\n        Don\'t hesitate to <a href="https://go.livelyapps.com/support" target="_blank">raise a ticket</a>\n        if you need additional assistance (or just want to say hello to the <strong>Lively Apps</strong> team)!\n    </p>\n    <span class="aui-icon icon-close" role="button"></span>\n</div>\n'},useData:!0})},605:(e,n,t)=>{var a=t(655);e.exports=(a.default||a).template({1:function(e,n,t,a,o){return"checked"},3:function(e,n,t,a,o){return"error"},compiler:[8,">= 4.3.0"],main:function(e,n,a,o,i){var l,r=null!=n?n:e.nullContext||{},s=e.lookupProperty||function(e,n){if(Object.prototype.hasOwnProperty.call(e,n))return e[n]};return'<form class="aui he-form">\n    <div class="he-content">\n'+(null!=(l=e.invokePartial(t(181),n,{name:"config-info",data:i,indent:"        ",helpers:a,partials:o,decorators:e.decorators}))?l:"")+'        <div class="he-config">\n            <aui-toggle id="space-tools-config-toggle" label="Show Space Tools Menu in Cog Wheel Menu"\n            '+(null!=(l=s(a,"eq").call(r,null!=n?s(n,"spaceToolsItemEnabled"):n,!0,{name:"eq",hash:{},fn:e.program(1,i,0),inverse:e.noop,data:i,loc:{start:{line:6,column:12},end:{line:6,column:60}}}))?l:"")+'></aui-toggle>\n            <aui-label for="space-tools-config-toggle">Add space tools link in administration menu for space administrators\n            </aui-label>\n            <div class="description">When the sidebar is hidden using HideElements, space administrators will lose the\n                Space Tools link at the bottom of the sidebar. If you enable this setting, space administrators will be\n                provided an additional Space Tools link in the global administration menu in the Confluence header.\n                Note that this menu will appear with a single link item Space Tools to space administrators\n                that are not Confluence administrators.</div>\n        </div>\n        <div class="he-config">\n            <aui-toggle id="allow-query-params-settings-config-toggle" label="Allow Hiding Elements Using Query Parameters"\n                        '+(null!=(l=s(a,"eq").call(r,null!=n?s(n,"allowUrlOverrides"):n,!0,{name:"eq",hash:{},fn:e.program(1,i,0),inverse:e.noop,data:i,loc:{start:{line:17,column:24},end:{line:17,column:68}}}))?l:"")+'></aui-toggle>\n            <aui-label for="allow-query-params-settings-config-toggle">Allow passing settings using query parameters\n            </aui-label>\n            <div class="description">When this option is enabled, you can hide additional elements using the \'he_elements\'\n                query parameter and additional selectors using the \'he_selector\' query parameter. These settings are applied\n                only when these parameters are present in your URL. Please, note that you can hide elements that are\n                set to \'always visible\' in the space/global administration.</div>\n        </div>\n        <div class="buttons-container">\n            <div class="buttons">\n                <span class="aui-icon aui-icon-success aui-icon-small aui-iconfont-approve"></span>\n                <span class="aui-icon aui-icon-wait"></span>\n                <span class="aui-icon aui-icon-error"></span>\n                <button class="config-save-button aui-button aui-button-primary" disabled>Save</button>\n            </div>\n            <span class="status '+(null!=(l=s(a,"if").call(r,null!=n?s(n,"error"):n,{name:"if",hash:{},fn:e.program(3,i,0),inverse:e.noop,data:i,loc:{start:{line:32,column:32},end:{line:32,column:57}}}))?l:"")+'"></span>\n        </div>\n    </div>\n</form>\n'},usePartial:!0,useData:!0})},567:(e,n,t)=>{var a=t(655);e.exports=(a.default||a).template({1:function(e,n,t,a,o){return"disabled"},compiler:[8,">= 4.3.0"],main:function(e,n,t,a,o){var i,l,r=null!=n?n:e.nullContext||{},s=e.hooks.helperMissing,c="function",u=e.escapeExpression,d=e.lookupProperty||function(e,n){if(Object.prototype.hasOwnProperty.call(e,n))return e[n]};return'<div class="he-item-div he-item-div-cssselector"\n     data-visibility="visible"\n     data-parent-visibility="visible"\n     data-locked="'+u(typeof(l=null!=(l=d(t,"locked")||(null!=n?d(n,"locked"):n))?l:s)===c?l.call(r,{name:"locked",hash:{},data:o,loc:{start:{line:4,column:18},end:{line:4,column:28}}}):l)+'"\n     data-locked-in-parent="'+u(typeof(l=null!=(l=d(t,"lockedInParent")||(null!=n?d(n,"lockedInParent"):n))?l:s)===c?l.call(r,{name:"lockedInParent",hash:{},data:o,loc:{start:{line:5,column:28},end:{line:5,column:46}}}):l)+'"\n     data-original-locked="'+u(typeof(l=null!=(l=d(t,"locked")||(null!=n?d(n,"locked"):n))?l:s)===c?l.call(r,{name:"locked",hash:{},data:o,loc:{start:{line:6,column:27},end:{line:6,column:37}}}):l)+'"\n     data-original-locked-in-parent="'+u(typeof(l=null!=(l=d(t,"lockedInParent")||(null!=n?d(n,"lockedInParent"):n))?l:s)===c?l.call(r,{name:"lockedInParent",hash:{},data:o,loc:{start:{line:7,column:37},end:{line:7,column:55}}}):l)+'"\n     data-original-value="'+u(typeof(l=null!=(l=d(t,"value")||(null!=n?d(n,"value"):n))?l:s)===c?l.call(r,{name:"value",hash:{},data:o,loc:{start:{line:8,column:26},end:{line:8,column:35}}}):l)+'"\n     data-he-key="cssselector"\n     data-from-macro="'+u(typeof(l=null!=(l=d(t,"fromMacro")||(null!=n?d(n,"fromMacro"):n))?l:s)===c?l.call(r,{name:"fromMacro",hash:{},data:o,loc:{start:{line:10,column:22},end:{line:10,column:35}}}):l)+'"\n>\n    <div class="he-icon-container" data-icon-key="'+u(typeof(l=null!=(l=d(t,"iconComboKey")||(null!=n?d(n,"iconComboKey"):n))?l:s)===c?l.call(r,{name:"iconComboKey",hash:{},data:o,loc:{start:{line:12,column:50},end:{line:12,column:66}}}):l)+'">\n        <a href="#" class="aui-icon icon-locking icon-this icon-locked aui-icon-small aui-iconfont-lock"></a>\n        <a href="#" class="aui-icon icon-locking icon-this icon-unlocked aui-icon-small aui-iconfont-unlock"></a>\n    </div>\n    <input type="text" class="text he-item-input he-item-cssselector"\n           autocomplete="off" value="'+u(typeof(l=null!=(l=d(t,"value")||(null!=n?d(n,"value"):n))?l:s)===c?l.call(r,{name:"value",hash:{},data:o,loc:{start:{line:17,column:37},end:{line:17,column:46}}}):l)+'" '+(null!=(i=d(t,"eq").call(r,null!=n?d(n,"lockedInParent"):n,"locked",{name:"eq",hash:{},fn:e.program(1,o,0),inverse:e.noop,data:o,loc:{start:{line:17,column:48},end:{line:17,column:94}}}))?i:"")+'>\n    <span class="aui-icon icon-question aui-icon-small aui-iconfont-question-filled he-markup-based-tooltip"\n          title="A CSS selector for hidden elements that will be applied in addition to the elements above. Note that this will not apply to administration screens"></span>\n</div>'},useData:!0})},881:(e,n,t)=>{var a=t(655);e.exports=(a.default||a).template({compiler:[8,">= 4.3.0"],main:function(e,n,t,a,o){var i,l=null!=n?n:e.nullContext||{},r=e.hooks.helperMissing,s="function",c=e.escapeExpression,u=e.lookupProperty||function(e,n){if(Object.prototype.hasOwnProperty.call(e,n))return e[n]};return'<div class="he-item-div he-item-div-'+c(typeof(i=null!=(i=u(t,"key")||(null!=n?u(n,"key"):n))?i:r)===s?i.call(l,{name:"key",hash:{},data:o,loc:{start:{line:1,column:36},end:{line:1,column:43}}}):i)+'"\n     data-visibility="'+c(typeof(i=null!=(i=u(t,"visibility")||(null!=n?u(n,"visibility"):n))?i:r)===s?i.call(l,{name:"visibility",hash:{},data:o,loc:{start:{line:2,column:22},end:{line:2,column:36}}}):i)+'"\n     data-parent-visibility="'+c(typeof(i=null!=(i=u(t,"parentVisibility")||(null!=n?u(n,"parentVisibility"):n))?i:r)===s?i.call(l,{name:"parentVisibility",hash:{},data:o,loc:{start:{line:3,column:29},end:{line:3,column:49}}}):i)+'"\n     data-locked="'+c(typeof(i=null!=(i=u(t,"locked")||(null!=n?u(n,"locked"):n))?i:r)===s?i.call(l,{name:"locked",hash:{},data:o,loc:{start:{line:4,column:18},end:{line:4,column:28}}}):i)+'"\n     data-locked-in-parent="'+c(typeof(i=null!=(i=u(t,"lockedInParent")||(null!=n?u(n,"lockedInParent"):n))?i:r)===s?i.call(l,{name:"lockedInParent",hash:{},data:o,loc:{start:{line:5,column:28},end:{line:5,column:46}}}):i)+'"\n     data-original-visibility="'+c(typeof(i=null!=(i=u(t,"visibility")||(null!=n?u(n,"visibility"):n))?i:r)===s?i.call(l,{name:"visibility",hash:{},data:o,loc:{start:{line:6,column:31},end:{line:6,column:45}}}):i)+'"\n     data-original-parent-visibility="'+c(typeof(i=null!=(i=u(t,"parentVisibility")||(null!=n?u(n,"parentVisibility"):n))?i:r)===s?i.call(l,{name:"parentVisibility",hash:{},data:o,loc:{start:{line:7,column:38},end:{line:7,column:58}}}):i)+'"\n     data-original-locked-in-parent="'+c(typeof(i=null!=(i=u(t,"lockedInParent")||(null!=n?u(n,"lockedInParent"):n))?i:r)===s?i.call(l,{name:"lockedInParent",hash:{},data:o,loc:{start:{line:8,column:37},end:{line:8,column:55}}}):i)+'"\n     data-original-locked="'+c(typeof(i=null!=(i=u(t,"locked")||(null!=n?u(n,"locked"):n))?i:r)===s?i.call(l,{name:"locked",hash:{},data:o,loc:{start:{line:9,column:27},end:{line:9,column:37}}}):i)+'"\n     data-he-key="'+c(typeof(i=null!=(i=u(t,"key")||(null!=n?u(n,"key"):n))?i:r)===s?i.call(l,{name:"key",hash:{},data:o,loc:{start:{line:10,column:18},end:{line:10,column:25}}}):i)+'"\n>\n\n    <div class="he-icon-container" data-icon-key="'+c(typeof(i=null!=(i=u(t,"iconComboKey")||(null!=n?u(n,"iconComboKey"):n))?i:r)===s?i.call(l,{name:"iconComboKey",hash:{},data:o,loc:{start:{line:13,column:50},end:{line:13,column:66}}}):i)+'">\n        <a href="#" class="aui-icon icon-locking icon-this icon-locked aui-icon-small aui-iconfont-lock"></a>\n        <a href="#" class="aui-icon icon-locking icon-this icon-unlocked aui-icon-small aui-iconfont-unlock"></a>\n        <a href="#" class="aui-icon icon-this icon-eye aui-icon-small aui-iconfont-watch-filled"></a>\n    </div>\n    <span class="element-text">'+c((u(t,"getElementText")||n&&u(n,"getElementText")||r).call(l,null!=n?u(n,"key"):n,{name:"getElementText",hash:{},data:o,loc:{start:{line:18,column:31},end:{line:18,column:53}}}))+"</span>\n</div>"},useData:!0})},398:(e,n,t)=>{var a=t(655);e.exports=(a.default||a).template({1:function(e,n,t,a,o){var i,l=e.lookupProperty||function(e,n){if(Object.prototype.hasOwnProperty.call(e,n))return e[n]};return"        <p>"+e.escapeExpression("function"==typeof(i=null!=(i=l(t,"error")||(null!=n?l(n,"error"):n))?i:e.hooks.helperMissing)?i.call(null!=n?n:e.nullContext||{},{name:"error",hash:{},data:o,loc:{start:{line:6,column:11},end:{line:6,column:20}}}):i)+"</p>\n"},compiler:[8,">= 4.3.0"],main:function(e,n,t,a,o){var i,l=e.lookupProperty||function(e,n){if(Object.prototype.hasOwnProperty.call(e,n))return e[n]};return'<div class="aui-message aui-message-error">\n    <p class="title">\n        <strong>Something strange happened.</strong>\n    </p>\n'+(null!=(i=l(t,"if").call(null!=n?n:e.nullContext||{},null!=n?l(n,"error"):n,{name:"if",hash:{},fn:e.program(1,o,0),inverse:e.noop,data:o,loc:{start:{line:5,column:4},end:{line:7,column:11}}}))?i:"")+'    <p>\n        Since this is something unexpected, it might be best to contact your Confluence administrator. Or feel free to\n        create a <a href="https://help.scandio.de/servicedesk/customer/portal/9">support ticket</a>.\n    </p>\n    <p>\n        <a class="browser-back-link" href="#">&lt;&lt; back</a>\n    </p>\n</div>'},useData:!0})},681:(e,n,t)=>{var a=t(655);e.exports=(a.default||a).template({compiler:[8,">= 4.3.0"],main:function(e,n,t,a,o){return'<table class="aui legend-table-icons">\n    <thead>\n        <tr>\n            <th>Icon</th>\n            <th>Description</th>\n        </tr>\n    </thead>\n    <tbody>\n        \x3c!-- FILLED BY JS --\x3e\n    </tbody>\n</table>\n<table class="aui legend-table-states">\n    <thead>\n        <tr>\n            <th>State Key</th>\n            <th>Icon Combo</th>\n        </tr>\n    </thead>\n    <tbody>\n        \x3c!-- FILLED BY JS --\x3e\n    </tbody>\n</table>'},useData:!0})},633:(e,n,t)=>{var a=t(655);e.exports=(a.default||a).template({compiler:[8,">= 4.3.0"],main:function(e,n,t,a,o){return'<div class="hideelements-preview">\n    <div class="confluence-header" data-id="confluence-header">\n        <div data-id="confluence-header-left" class="confluence-header-left left header-part">\n            <div data-id="logo" class="left confluence-logo">Confluence</div>\n            <div data-id="space-menu-link" class="header-menu left confluence-spaces-menu">Spaces</div>\n            <div data-id="people-directory-link" class="header-menu left confluence-people-menu">People</div>\n            <div data-id="quick-create-page-button" class="header-menu create-button left create-page-button-preview">Create</div>\n            <div data-id="create-page-button" class="header-menu create-button left quick-create-page-button-preview">\n                <span class="overflow-icon">...</span>\n            </div>\n        </div>\n        <div class="confluence-header-right right header-part">\n            <div data-id="confluence-profile-button" class="header-menu right confluence-profile-button">\n                <span class="aui-icon aui-icon-small aui-iconfont-person-circle"></span>\n            </div>\n            <div data-id="confluence-notifications-button" class="header-menu right confluence-notifications-button">\n                <span class="aui-icon aui-icon-small aui-iconfont-notification"></span>\n            </div>\n            <div data-id="confluence-admin-button" class="header-menu right confluence-admin-button">\n                <span class="aui-icon aui-icon-small aui-iconfont-settings"></span>\n            </div>\n            <div data-id="confluence-help-button" class="header-menu right confluence-help-button">\n                <span class="right aui-icon aui-icon-small aui-iconfont-question-filled"></span>\n            </div>\n            <div data-id="confluence-search-bar" class="header-menu right confluence-search-bar">\n                Search\n                <span class="right aui-icon aui-icon-small aui-iconfont-search"></span>\n            </div>\n        </div>\n    </div>\n\n    <div data-id="splitter-sidebar" class="splitter-sidebar left"></div>\n\n    <div class="hideelements-main">\n        <div class="right">\n            <div data-id="action-menu-link" class="action-menu-link rounded right button">\n                <span class="overflow-icon">...</span>\n            </div>\n            <div data-id="shareContentLink" class="shareContentLink rounded right button">Share</div>\n            <div data-id="watch-content-button" class="watch-content-button rounded right button">Watch</div>\n            <div data-id="page-favourite" class="page-favourite rounded right button">Save for later</div>\n            <div data-id="editPageLink" class="editPageLink rounded right button">Edit</div>\n        </div>\n\n        <div data-id="title-heading" class="title-heading content-meta-outer">\n            <div data-id="breadcrumb-section" class="breadcrumb-section link breadcrumb">\n                Lorem / ipsum / dolor / sit <div class="meta icon rounded"></div>\n            </div>\n            <div data-id="title-text" class="title-text title">Lorem ipsum dolor</div>\n            <div class="metas content-meta">Lorem ipsum dolor, sit amet consetetur sadipscing elitr</div>\n        </div>\n\n        <div class="content">\n            <p>Lorem ipsum dolor sit amet, consetetur sadipscing elitr\n                , sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua\n                . At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren\n                , no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet\n                , consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat\n                , sed diam voluptua\n                . At vero eos et accusam et justo duo <span class="preview-jiraissue-highlight-text">dolores</span> et ea rebum.</p>\n            <div data-id="inline-dialog-selection-action-panel" class="inline-dialog-selection-action-panel aui-inline-dialog">\n                <div class="aui-inline-dialog-contents contents">\n                    <button class="preview-inline-block"\n                            data-key="com.atlassian.confluence.plugins.confluence-inline-comments:create-inline-comment">\n                        <span class="aui-icon aui-icon-small aui-iconfont-comment"></span>\n                    </button>\n                    <button class="preview-inline-block"\n                            data-key="com.atlassian.confluence.plugins.confluence-jira-content:create-Jira-issue-summary">\n                        <span class="aui-icon aui-icon-small aui-iconfont-jira"></span>\n                    </button>\n                    <div data-id="arrow-selection-action-panel" class="arrow-selection-action-panel aui-inline-dialog-arrow arrow aui-css-arrow aui-bottom-arrow"></div>\n                </div>\n            </div>\n        </div>\n\n        <div data-id="likes-section" class="likes-section likes left">\n            <div class="icon rounded left"></div>\n            <div class="link left">Unlike</div>\n            You like this\n        </div>\n\n        <div data-id="labels-section" class="labels-section right labels">\n            <div class="aui-label">Lorem</div>\n            <div class="aui-label">Ipsum</div>\n            <div class="icon rounded"></div>\n        </div>\n\n        <div data-id="comments-section" class="comments-section comments clear">\n            <div class="comment-title">2 comments</div>\n            <div class="comment">\n                <div class="userimg left"></div>\n                <div class="comment-content">\n                    <div class="link">John Doe</div>\n                    <div>Lorem ipsum dolor sit amet?</div>\n                    <div class="metas">Lorem ipsum dolor, sit amet consetetur sadipscing elitr</div>\n                </div>\n            </div>\n            <div class="comment">\n                <div class="userimg left"></div>\n                <div class="comment-content">\n                    <div class="link">Jane Doe</div>\n                    <div>Lorem Ipsum!</div>\n                    <div class="metas">Lorem ipsum dolor, sit amet consetetur sadipscing elitr</div>\n                </div>\n            </div>\n            <div class="comment no-border">\n                <div class="userimg left"></div>\n                <div class="comment-content">\n                    <div class="add-comment">Write a comment...</div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>'},useData:!0})},275:(e,n,t)=>{var a=t(655);e.exports=(a.default||a).template({1:function(e,n,t,a,o){return"            You are on the <strong>SPACE</strong> level, which means these settings will be applied\n            everywhere in this space.\n"},3:function(e,n,t,a,o){return"            You are on the <strong>GLOBAL</strong> level, which means these settings will be applied\n            <i>Confluence-wide</i>.\n"},compiler:[8,">= 4.3.0"],main:function(e,n,t,a,o){var i,l=null!=n?n:e.nullContext||{},r=e.lookupProperty||function(e,n){if(Object.prototype.hasOwnProperty.call(e,n))return e[n]};return'<div class="he-info aui-message aui-message-info closeable">\n    <p class="title">\n        <strong>Welcome to the HideElements settings!</strong>\n    </p>\n    <p>\n        Below is a preview of your settings.\n'+(null!=(i=r(t,"eq").call(l,null!=n?r(n,"scope"):n,"space",{name:"eq",hash:{},fn:e.program(1,o,0),inverse:e.noop,data:o,loc:{start:{line:7,column:8},end:{line:10,column:15}}}))?i:"")+(null!=(i=r(t,"eq").call(l,null!=n?r(n,"scope"):n,"global",{name:"eq",hash:{},fn:e.program(3,o,0),inverse:e.noop,data:o,loc:{start:{line:11,column:8},end:{line:14,column:15}}}))?i:"")+'        Click the question mark on the left for an explanation of each icon and please\n        visit our <a href="https://help.livelyapps.com/hideelements-for-confluence-server/" target="_blank">documentation</a> for more information.\n        Don\'t hesitate to <a href="https://go.livelyapps.com/support" target="_blank">raise a ticket</a> if\n        you need additional assistance (or just want to say hello to the <Strong>Lively Apps</Strong> team)!\n    </p>\n    <span class="aui-icon icon-close" role="button"></span>\n</div>'},useData:!0})},966:(e,n,t)=>{var a=t(655);e.exports=(a.default||a).template({1:function(e,n,t,a,o){var i,l=e.lookupProperty||function(e,n){if(Object.prototype.hasOwnProperty.call(e,n))return e[n]};return null!=(i=l(t,"notEmpty").call(null!=n?n:e.nullContext||{},null!=n?l(n,"warnings"):n,{name:"notEmpty",hash:{},fn:e.program(2,o,0),inverse:e.noop,data:o,loc:{start:{line:2,column:4},end:{line:15,column:17}}}))?i:""},2:function(e,n,t,a,o){var i,l=e.lookupProperty||function(e,n){if(Object.prototype.hasOwnProperty.call(e,n))return e[n]};return'        <div class="aui-message aui-message-warning">\n            <p class="title">\n                <strong>You currently have warnings</strong>\n            </p>\n            <ul>\n'+(null!=(i=l(t,"each").call(null!=n?n:e.nullContext||{},null!=n?l(n,"warnings"):n,{name:"each",hash:{},fn:e.program(3,o,0),inverse:e.noop,data:o,loc:{start:{line:8,column:16},end:{line:12,column:25}}}))?i:"")+"            </ul>\n        </div>\n"},3:function(e,n,t,a,o){var i;return null!=(i=(e.lookupProperty||function(e,n){if(Object.prototype.hasOwnProperty.call(e,n))return e[n]})(t,"eq").call(null!=n?n:e.nullContext||{},n,"GROUSE",{name:"eq",hash:{},fn:e.program(4,o,0),inverse:e.noop,data:o,loc:{start:{line:9,column:20},end:{line:11,column:27}}}))?i:""},4:function(e,n,t,a,o){return'                        <li>There are cache inconsistencies on your instance (error code "Grouse"). This may affect performance. Please visit <a href="https://go.livelyapps.com/hideelements-warning-grouse">this troubleshooting article</a>.</li>\n'},6:function(e,n,t,a,o){return"locking-disabled"},8:function(e,n,a,o,i){var l;return null!=(l=e.invokePartial(t(881),n,{name:"element-item",data:i,indent:"            ",helpers:a,partials:o,decorators:e.decorators}))?l:""},10:function(e,n,a,o,i){var l;return null!=(l=e.invokePartial(t(275),n,{name:"settings-info",data:i,indent:"            ",helpers:a,partials:o,decorators:e.decorators}))?l:""},12:function(e,n,t,a,o){return'                <div class="buttons-container">\n                    <div class="buttons">\n                        <span class="aui-icon aui-icon-success aui-icon-small aui-iconfont-approve"> </span>\n                        <span class="aui-icon aui-icon-wait"> </span>\n                        <span class="aui-icon aui-icon-error"> </span>\n                        <button class="settings-save-button aui-button aui-button-primary" disabled>Save</button>\n                    </div>\n                    <span class="status"></span>\n                </div>\n'},compiler:[8,">= 4.3.0"],main:function(e,n,a,o,i){var l,r=null!=n?n:e.nullContext||{},s=e.lookupProperty||function(e,n){if(Object.prototype.hasOwnProperty.call(e,n))return e[n]};return(null!=(l=s(a,"eq").call(r,null!=n?s(n,"scope"):n,"global",{name:"eq",hash:{},fn:e.program(1,i,0),inverse:e.noop,data:i,loc:{start:{line:1,column:0},end:{line:16,column:7}}}))?l:"")+'\n<form action="#" class="he-form aui '+(null!=(l=s(a,"unless").call(r,null!=n?s(n,"lockingEnabled"):n,{name:"unless",hash:{},fn:e.program(6,i,0),inverse:e.noop,data:i,loc:{start:{line:18,column:36},end:{line:18,column:89}}}))?l:"")+'" data-scope="'+e.escapeExpression(e.lambda(null!=n?s(n,"scope"):n,n))+'">\n    <div class="he-menu">\n'+(null!=(l=s(a,"each").call(r,null!=n?s(n,"elements"):n,{name:"each",hash:{},fn:e.program(8,i,0),inverse:e.noop,data:i,loc:{start:{line:20,column:8},end:{line:22,column:17}}}))?l:"")+"\n"+(null!=(l=e.invokePartial(t(567),null!=n?s(n,"cssSelector"):n,{name:"cssselector-field",data:i,indent:"        ",helpers:a,partials:o,decorators:e.decorators}))?l:"")+'\n        <a href="#" class="he-legend-button">\n            <span class="aui-icon icon-question aui-icon-small aui-iconfont-question-filled"></span>\n        </a>\n    </div>\n\n    <div class="he-content">\n'+(null!=(l=s(a,"eq").call(r,null!=n?s(n,"scope"):n,"global",{name:"eq",hash:{},fn:e.program(10,i,0),inverse:e.noop,data:i,loc:{start:{line:32,column:8},end:{line:34,column:15}}}))?l:"")+(null!=(l=s(a,"eq").call(r,null!=n?s(n,"scope"):n,"space",{name:"eq",hash:{},fn:e.program(10,i,0),inverse:e.noop,data:i,loc:{start:{line:35,column:8},end:{line:37,column:15}}}))?l:"")+'\n        <div class="he-preview">\n'+(null!=(l=e.invokePartial(t(633),n,{name:"preview",data:i,indent:"            ",helpers:a,partials:o,decorators:e.decorators}))?l:"")+'\n            <ul class="reset-menu">\n                <li>\n                    <a href="#" class="reset-link he-markup-based-tooltip" data-tooltip-gravity="e"\n                       title="This will reset the state to the initial state on page load.">Reset</a></li>\n                <li>\n                    <a href="#" class="clear-link he-markup-based-tooltip" data-tooltip-gravity="e"\n                       title="This will completely clear all settings made here.">Clear</a></li>\n            </ul>\n\n'+(null!=(l=s(a,"noteq").call(r,null!=n?s(n,"scope"):n,"page",{name:"noteq",hash:{},fn:e.program(12,i,0),inverse:e.noop,data:i,loc:{start:{line:51,column:12},end:{line:61,column:22}}}))?l:"")+'        </div>\n\n        <div class="he-legend">\n'+(null!=(l=e.invokePartial(t(681),n,{name:"legend",data:i,indent:"            ",helpers:a,partials:o,decorators:e.decorators}))?l:"")+'            <a href="#" class="hide-legend-button">\n                <span class="aui-icon icon-hide-legend aui-icon-small aui-iconfont-chevron-double-left"></span>\n            </a>\n        </div>\n\n    </div>\n\n\n</form>'},usePartial:!0,useData:!0})},34:(e,n,t)=>{"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=e[t]);return n.default=e,n}n.__esModule=!0;var i=o(t(207)),l=a(t(586)),r=a(t(24)),s=o(t(704)),c=o(t(546)),u=a(t(179));function d(){var e=new i.HandlebarsEnvironment;return s.extend(e,i),e.SafeString=l.default,e.Exception=r.default,e.Utils=s,e.escapeExpression=s.escapeExpression,e.VM=c,e.template=function(n){return c.template(n,e)},e}var p=d();p.create=d,u.default(p),p.default=p,n.default=p,e.exports=n.default},207:(e,n,t)=>{"use strict";function a(e){return e&&e.__esModule?e:{default:e}}n.__esModule=!0,n.HandlebarsEnvironment=d;var o=t(704),i=a(t(24)),l=t(870),r=t(576),s=a(t(765)),c=t(467);n.VERSION="4.7.7",n.COMPILER_REVISION=8,n.LAST_COMPATIBLE_COMPILER_REVISION=7,n.REVISION_CHANGES={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:"== 1.x.x",5:"== 2.0.0-alpha.x",6:">= 2.0.0-beta.1",7:">= 4.0.0 <4.3.0",8:">= 4.3.0"};var u="[object Object]";function d(e,n,t){this.helpers=e||{},this.partials=n||{},this.decorators=t||{},l.registerDefaultHelpers(this),r.registerDefaultDecorators(this)}d.prototype={constructor:d,logger:s.default,log:s.default.log,registerHelper:function(e,n){if(o.toString.call(e)===u){if(n)throw new i.default("Arg not supported with multiple helpers");o.extend(this.helpers,e)}else this.helpers[e]=n},unregisterHelper:function(e){delete this.helpers[e]},registerPartial:function(e,n){if(o.toString.call(e)===u)o.extend(this.partials,e);else{if(void 0===n)throw new i.default('Attempting to register a partial called "'+e+'" as undefined');this.partials[e]=n}},unregisterPartial:function(e){delete this.partials[e]},registerDecorator:function(e,n){if(o.toString.call(e)===u){if(n)throw new i.default("Arg not supported with multiple decorators");o.extend(this.decorators,e)}else this.decorators[e]=n},unregisterDecorator:function(e){delete this.decorators[e]},resetLoggedPropertyAccesses:function(){c.resetLoggedProperties()}};var p=s.default.log;n.log=p,n.createFrame=o.createFrame,n.logger=s.default},576:(e,n,t)=>{"use strict";n.__esModule=!0,n.registerDefaultDecorators=function(e){o.default(e)};var a,o=(a=t(642))&&a.__esModule?a:{default:a}},642:(e,n,t)=>{"use strict";n.__esModule=!0;var a=t(704);n.default=function(e){e.registerDecorator("inline",(function(e,n,t,o){var i=e;return n.partials||(n.partials={},i=function(o,i){var l=t.partials;t.partials=a.extend({},l,n.partials);var r=e(o,i);return t.partials=l,r}),n.partials[o.args[0]]=o.fn,i}))},e.exports=n.default},24:(e,n)=>{"use strict";n.__esModule=!0;var t=["description","fileName","lineNumber","endLineNumber","message","name","number","stack"];function a(e,n){var o=n&&n.loc,i=void 0,l=void 0,r=void 0,s=void 0;o&&(i=o.start.line,l=o.end.line,r=o.start.column,s=o.end.column,e+=" - "+i+":"+r);for(var c=Error.prototype.constructor.call(this,e),u=0;u<t.length;u++)this[t[u]]=c[t[u]];Error.captureStackTrace&&Error.captureStackTrace(this,a);try{o&&(this.lineNumber=i,this.endLineNumber=l,Object.defineProperty?(Object.defineProperty(this,"column",{value:r,enumerable:!0}),Object.defineProperty(this,"endColumn",{value:s,enumerable:!0})):(this.column=r,this.endColumn=s))}catch(e){}}a.prototype=new Error,n.default=a,e.exports=n.default},870:(e,n,t)=>{"use strict";function a(e){return e&&e.__esModule?e:{default:e}}n.__esModule=!0,n.registerDefaultHelpers=function(e){o.default(e),i.default(e),l.default(e),r.default(e),s.default(e),c.default(e),u.default(e)},n.moveHelperToHooks=function(e,n,t){e.helpers[n]&&(e.hooks[n]=e.helpers[n],t||delete e.helpers[n])};var o=a(t(810)),i=a(t(847)),l=a(t(780)),r=a(t(229)),s=a(t(328)),c=a(t(124)),u=a(t(89))},810:(e,n,t)=>{"use strict";n.__esModule=!0;var a=t(704);n.default=function(e){e.registerHelper("blockHelperMissing",(function(n,t){var o=t.inverse,i=t.fn;if(!0===n)return i(this);if(!1===n||null==n)return o(this);if(a.isArray(n))return n.length>0?(t.ids&&(t.ids=[t.name]),e.helpers.each(n,t)):o(this);if(t.data&&t.ids){var l=a.createFrame(t.data);l.contextPath=a.appendContextPath(t.data.contextPath,t.name),t={data:l}}return i(n,t)}))},e.exports=n.default},847:(e,n,t)=>{"use strict";n.__esModule=!0;var a,o=t(704),i=(a=t(24))&&a.__esModule?a:{default:a};n.default=function(e){e.registerHelper("each",(function(e,n){if(!n)throw new i.default("Must pass iterator to #each");var a,l=n.fn,r=n.inverse,s=0,c="",u=void 0,d=void 0;function p(n,t,a){u&&(u.key=n,u.index=t,u.first=0===t,u.last=!!a,d&&(u.contextPath=d+n)),c+=l(e[n],{data:u,blockParams:o.blockParams([e[n],n],[d+n,null])})}if(n.data&&n.ids&&(d=o.appendContextPath(n.data.contextPath,n.ids[0])+"."),o.isFunction(e)&&(e=e.call(this)),n.data&&(u=o.createFrame(n.data)),e&&"object"==typeof e)if(o.isArray(e))for(var f=e.length;s<f;s++)s in e&&p(s,s,s===e.length-1);else if(t.g.Symbol&&e[t.g.Symbol.iterator]){for(var h=[],m=e[t.g.Symbol.iterator](),v=m.next();!v.done;v=m.next())h.push(v.value);for(f=(e=h).length;s<f;s++)p(s,s,s===e.length-1)}else a=void 0,Object.keys(e).forEach((function(e){void 0!==a&&p(a,s-1),a=e,s++})),void 0!==a&&p(a,s-1,!0);return 0===s&&(c=r(this)),c}))},e.exports=n.default},780:(e,n,t)=>{"use strict";n.__esModule=!0;var a,o=(a=t(24))&&a.__esModule?a:{default:a};n.default=function(e){e.registerHelper("helperMissing",(function(){if(1!==arguments.length)throw new o.default('Missing helper: "'+arguments[arguments.length-1].name+'"')}))},e.exports=n.default},229:(e,n,t)=>{"use strict";n.__esModule=!0;var a,o=t(704),i=(a=t(24))&&a.__esModule?a:{default:a};n.default=function(e){e.registerHelper("if",(function(e,n){if(2!=arguments.length)throw new i.default("#if requires exactly one argument");return o.isFunction(e)&&(e=e.call(this)),!n.hash.includeZero&&!e||o.isEmpty(e)?n.inverse(this):n.fn(this)})),e.registerHelper("unless",(function(n,t){if(2!=arguments.length)throw new i.default("#unless requires exactly one argument");return e.helpers.if.call(this,n,{fn:t.inverse,inverse:t.fn,hash:t.hash})}))},e.exports=n.default},328:(e,n)=>{"use strict";n.__esModule=!0,n.default=function(e){e.registerHelper("log",(function(){for(var n=[void 0],t=arguments[arguments.length-1],a=0;a<arguments.length-1;a++)n.push(arguments[a]);var o=1;null!=t.hash.level?o=t.hash.level:t.data&&null!=t.data.level&&(o=t.data.level),n[0]=o,e.log.apply(e,n)}))},e.exports=n.default},124:(e,n)=>{"use strict";n.__esModule=!0,n.default=function(e){e.registerHelper("lookup",(function(e,n,t){return e?t.lookupProperty(e,n):e}))},e.exports=n.default},89:(e,n,t)=>{"use strict";n.__esModule=!0;var a,o=t(704),i=(a=t(24))&&a.__esModule?a:{default:a};n.default=function(e){e.registerHelper("with",(function(e,n){if(2!=arguments.length)throw new i.default("#with requires exactly one argument");o.isFunction(e)&&(e=e.call(this));var t=n.fn;if(o.isEmpty(e))return n.inverse(this);var a=n.data;return n.data&&n.ids&&((a=o.createFrame(n.data)).contextPath=o.appendContextPath(n.data.contextPath,n.ids[0])),t(e,{data:a,blockParams:o.blockParams([e],[a&&a.contextPath])})}))},e.exports=n.default},943:(e,n,t)=>{"use strict";n.__esModule=!0,n.createNewLookupObject=function(){for(var e=arguments.length,n=Array(e),t=0;t<e;t++)n[t]=arguments[t];return a.extend.apply(void 0,[Object.create(null)].concat(n))};var a=t(704)},467:(e,n,t)=>{"use strict";n.__esModule=!0,n.createProtoAccessControl=function(e){var n=Object.create(null);n.constructor=!1,n.__defineGetter__=!1,n.__defineSetter__=!1,n.__lookupGetter__=!1;var t=Object.create(null);return t.__proto__=!1,{properties:{whitelist:a.createNewLookupObject(t,e.allowedProtoProperties),defaultValue:e.allowProtoPropertiesByDefault},methods:{whitelist:a.createNewLookupObject(n,e.allowedProtoMethods),defaultValue:e.allowProtoMethodsByDefault}}},n.resultIsAllowed=function(e,n,t){return function(e,n){return void 0!==e.whitelist[n]?!0===e.whitelist[n]:void 0!==e.defaultValue?e.defaultValue:(function(e){!0!==i[e]&&(i[e]=!0,o.log("error",'Handlebars: Access has been denied to resolve the property "'+e+'" because it is not an "own property" of its parent.\nYou can add a runtime option to disable the check or this warning:\nSee https://handlebarsjs.com/api-reference/runtime-options.html#options-to-control-prototype-access for details'))}(n),!1)}("function"==typeof e?n.methods:n.properties,t)},n.resetLoggedProperties=function(){Object.keys(i).forEach((function(e){delete i[e]}))};var a=t(943),o=function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=e[t]);return n.default=e,n}(t(765)),i=Object.create(null)},205:(e,n)=>{"use strict";n.__esModule=!0,n.wrapHelper=function(e,n){return"function"!=typeof e?e:function(){return arguments[arguments.length-1]=n(arguments[arguments.length-1]),e.apply(this,arguments)}}},765:(e,n,t)=>{"use strict";n.__esModule=!0;var a=t(704),o={methodMap:["debug","info","warn","error"],level:"info",lookupLevel:function(e){if("string"==typeof e){var n=a.indexOf(o.methodMap,e.toLowerCase());e=n>=0?n:parseInt(e,10)}return e},log:function(e){if(e=o.lookupLevel(e),"undefined"!=typeof console&&o.lookupLevel(o.level)<=e){var n=o.methodMap[e];console[n]||(n="log");for(var t=arguments.length,a=Array(t>1?t-1:0),i=1;i<t;i++)a[i-1]=arguments[i];console[n].apply(console,a)}}};n.default=o,e.exports=n.default},179:(e,n,t)=>{"use strict";n.__esModule=!0,n.default=function(e){var n=void 0!==t.g?t.g:window,a=n.Handlebars;e.noConflict=function(){return n.Handlebars===e&&(n.Handlebars=a),e}},e.exports=n.default},546:(e,n,t)=>{"use strict";n.__esModule=!0,n.checkRevision=function(e){var n=e&&e[0]||1,t=l.COMPILER_REVISION;if(!(n>=l.LAST_COMPATIBLE_COMPILER_REVISION&&n<=l.COMPILER_REVISION)){if(n<l.LAST_COMPATIBLE_COMPILER_REVISION){var a=l.REVISION_CHANGES[t],o=l.REVISION_CHANGES[n];throw new i.default("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+a+") or downgrade your runtime to an older version ("+o+").")}throw new i.default("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+e[1]+").")}},n.template=function(e,n){if(!n)throw new i.default("No environment passed to template");if(!e||!e.main)throw new i.default("Unknown template object: "+typeof e);e.main.decorator=e.main_d,n.VM.checkRevision(e.compiler);var t=e.compiler&&7===e.compiler[0],a={strict:function(e,n,t){if(!e||!(n in e))throw new i.default('"'+n+'" not defined in '+e,{loc:t});return a.lookupProperty(e,n)},lookupProperty:function(e,n){var t=e[n];return null==t||Object.prototype.hasOwnProperty.call(e,n)||c.resultIsAllowed(t,a.protoAccessControl,n)?t:void 0},lookup:function(e,n){for(var t=e.length,o=0;o<t;o++)if(null!=(e[o]&&a.lookupProperty(e[o],n)))return e[o][n]},lambda:function(e,n){return"function"==typeof e?e.call(n):e},escapeExpression:o.escapeExpression,invokePartial:function(t,a,l){l.hash&&(a=o.extend({},a,l.hash),l.ids&&(l.ids[0]=!0)),t=n.VM.resolvePartial.call(this,t,a,l);var r=o.extend({},l,{hooks:this.hooks,protoAccessControl:this.protoAccessControl}),s=n.VM.invokePartial.call(this,t,a,r);if(null==s&&n.compile&&(l.partials[l.name]=n.compile(t,e.compilerOptions,n),s=l.partials[l.name](a,r)),null!=s){if(l.indent){for(var c=s.split("\n"),u=0,d=c.length;u<d&&(c[u]||u+1!==d);u++)c[u]=l.indent+c[u];s=c.join("\n")}return s}throw new i.default("The partial "+l.name+" could not be compiled when running in runtime-only mode")},fn:function(n){var t=e[n];return t.decorator=e[n+"_d"],t},programs:[],program:function(e,n,t,a,o){var i=this.programs[e],l=this.fn(e);return n||o||a||t?i=u(this,e,l,n,t,a,o):i||(i=this.programs[e]=u(this,e,l)),i},data:function(e,n){for(;e&&n--;)e=e._parent;return e},mergeIfNeeded:function(e,n){var t=e||n;return e&&n&&e!==n&&(t=o.extend({},n,e)),t},nullContext:Object.seal({}),noop:n.VM.noop,compilerInfo:e.compiler};function l(n){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],o=t.data;l._setup(t),!t.partial&&e.useData&&(o=p(n,o));var i=void 0,r=e.useBlockParams?[]:void 0;function s(n){return""+e.main(a,n,a.helpers,a.partials,o,r,i)}return e.useDepths&&(i=t.depths?n!=t.depths[0]?[n].concat(t.depths):t.depths:[n]),(s=f(e.main,s,a,t.depths||[],o,r))(n,t)}return l.isTop=!0,l._setup=function(i){if(i.partial)a.protoAccessControl=i.protoAccessControl,a.helpers=i.helpers,a.partials=i.partials,a.decorators=i.decorators,a.hooks=i.hooks;else{var l=o.extend({},n.helpers,i.helpers);!function(e,n){Object.keys(e).forEach((function(t){var a=e[t];e[t]=function(e,n){var t=n.lookupProperty;return s.wrapHelper(e,(function(e){return o.extend({lookupProperty:t},e)}))}(a,n)}))}(l,a),a.helpers=l,e.usePartial&&(a.partials=a.mergeIfNeeded(i.partials,n.partials)),(e.usePartial||e.useDecorators)&&(a.decorators=o.extend({},n.decorators,i.decorators)),a.hooks={},a.protoAccessControl=c.createProtoAccessControl(i);var u=i.allowCallsToHelperMissing||t;r.moveHelperToHooks(a,"helperMissing",u),r.moveHelperToHooks(a,"blockHelperMissing",u)}},l._child=function(n,t,o,l){if(e.useBlockParams&&!o)throw new i.default("must pass block params");if(e.useDepths&&!l)throw new i.default("must pass parent depths");return u(a,n,e[n],t,0,o,l)},l},n.wrapProgram=u,n.resolvePartial=function(e,n,t){return e?e.call||t.name||(t.name=e,e=t.partials[e]):e="@partial-block"===t.name?t.data["partial-block"]:t.partials[t.name],e},n.invokePartial=function(e,n,t){var a=t.data&&t.data["partial-block"];t.partial=!0,t.ids&&(t.data.contextPath=t.ids[0]||t.data.contextPath);var r=void 0;if(t.fn&&t.fn!==d&&function(){t.data=l.createFrame(t.data);var e=t.fn;r=t.data["partial-block"]=function(n){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return t.data=l.createFrame(t.data),t.data["partial-block"]=a,e(n,t)},e.partials&&(t.partials=o.extend({},t.partials,e.partials))}(),void 0===e&&r&&(e=r),void 0===e)throw new i.default("The partial "+t.name+" could not be found");if(e instanceof Function)return e(n,t)},n.noop=d;var a,o=function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=e[t]);return n.default=e,n}(t(704)),i=(a=t(24))&&a.__esModule?a:{default:a},l=t(207),r=t(870),s=t(205),c=t(467);function u(e,n,t,a,o,i,l){function r(n){var o=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],r=l;return!l||n==l[0]||n===e.nullContext&&null===l[0]||(r=[n].concat(l)),t(e,n,e.helpers,e.partials,o.data||a,i&&[o.blockParams].concat(i),r)}return(r=f(t,r,e,l,a,i)).program=n,r.depth=l?l.length:0,r.blockParams=o||0,r}function d(){return""}function p(e,n){return n&&"root"in n||((n=n?l.createFrame(n):{}).root=e),n}function f(e,n,t,a,i,l){if(e.decorator){var r={};n=e.decorator(n,r,t,a&&a[0],i,l,a),o.extend(n,r)}return n}},586:(e,n)=>{"use strict";function t(e){this.string=e}n.__esModule=!0,t.prototype.toString=t.prototype.toHTML=function(){return""+this.string},n.default=t,e.exports=n.default},704:(e,n)=>{"use strict";n.__esModule=!0,n.extend=l,n.indexOf=function(e,n){for(var t=0,a=e.length;t<a;t++)if(e[t]===n)return t;return-1},n.escapeExpression=function(e){if("string"!=typeof e){if(e&&e.toHTML)return e.toHTML();if(null==e)return"";if(!e)return e+"";e=""+e}return o.test(e)?e.replace(a,i):e},n.isEmpty=function(e){return!e&&0!==e||!(!c(e)||0!==e.length)},n.createFrame=function(e){var n=l({},e);return n._parent=e,n},n.blockParams=function(e,n){return e.path=n,e},n.appendContextPath=function(e,n){return(e?e+".":"")+n};var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;","=":"&#x3D;"},a=/[&<>"'`=]/g,o=/[&<>"'`=]/;function i(e){return t[e]}function l(e){for(var n=1;n<arguments.length;n++)for(var t in arguments[n])Object.prototype.hasOwnProperty.call(arguments[n],t)&&(e[t]=arguments[n][t]);return e}var r=Object.prototype.toString;n.toString=r;var s=function(e){return"function"==typeof e};s(/x/)&&(n.isFunction=s=function(e){return"function"==typeof e&&"[object Function]"===r.call(e)}),n.isFunction=s;var c=Array.isArray||function(e){return!(!e||"object"!=typeof e)&&"[object Array]"===r.call(e)};n.isArray=c},655:(e,n,t)=>{e.exports=t(34).default}},n={};function t(a){var o=n[a];if(void 0!==o)return o.exports;var i=n[a]={exports:{}};return e[a](i,i.exports,t),i.exports}t.n=e=>{var n=e&&e.__esModule?()=>e.default:()=>e;return t.d(n,{a:n}),n},t.d=(e,n)=>{for(var a in n)t.o(n,a)&&!t.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:n[a]})},t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),t.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),t.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{"use strict";var e=t(978),n=t(968),a=t(898),o=t(455),i=t(222);t(362);var l,r="hideelements-container";function s(){$("#macro-details-page").removeClass(r)}function c(e,n){n&&n.dialog&&n.dialog.activeMetadata&&"hideelements-macro"===n.dialog.activeMetadata.macroName&&($(".he-form").remove(),s())}function u(e){var n=$(".he-form"),t=n.hasClass("macrobrowser-opened");if(n.length&&($('.he-item-div:not([data-he-key="cssselector"])').each((function(){var n=$(this),a=n.attr("data-visibility");if(t){var o=n.attr("data-he-key");"unset"===a?delete e[o]:e[o]="hidden"===a}})),t)){var a=$('.he-item-div[data-he-key="cssselector"]'),o=a.find("input").val(),i="true"===a.attr("data-from-macro"),l=a.attr("data-original-value");o&&(i||o!==l)?e.cssselector=o:delete e.cssselector}return n.addClass("macrobrowser-opened"),e}function d(t){var i,c,u=$("#macro-details-page");return u.addClass(r),u.find(".dialog-back-link").one("click",s),$(".he-form").remove(),e.S(u.find(".dialog-panel-body"),(i=t,c=a.i(l,!1,"page"),$.each(i,(function(e,t){var a=c.elements[e];if(a&&"cssselector"!==e&&"locked"!==a.lockedInParent){var i=n.eU(t),l=n.oI(i);a.visibility=l;var r=o.Lw(l,a.locked,a.parentVisibility,a.lockedInParent);a.iconComboKey=o.Jb(r)}})),"cssselector"in i&&"locked"!==c.cssSelector.lockedInParent&&(c.cssSelector.value=i.cssselector,c.cssSelector.fromMacro=!0),c)),t}AJS.bind("init.rte",(function(){l=i.ZV("macrobrowser"),AJS.MacroBrowser&&AJS.MacroBrowser.setMacroJsOverride("hideelements-macro",{beforeParamsRetrieved:u,beforeParamsSet:d}),AJS.bind("hide.dialog",c)}))})()})();
//# sourceMappingURL=bundle-macrobrowser.js.map
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'nl.avisi.confluence.plugins.numberedheadings:split_nh-macro-browser-plugin', location = 'nh-macro-browser-plugin.3df9976fe535214983d7.js' */
(window.atlassianWebpackJsonp981e0f4effab173567f2d6cf31d7b23b=window.atlassianWebpackJsonp981e0f4effab173567f2d6cf31d7b23b||[]).push([[5],{139:function(a,b,c){"use strict";c.r(b);var d=c(140),e=c.n(d),f=c(2),g=c.n(f),h=function(){this.headingFields=["h1","h2","h3","h4","h5","h6"]};h.prototype.beforeParamsSet=function(a){var b=a["number-format"];if("custom"!==b)for(var c=0;c<this.headingFields.length;c++)g.a.$("#macro-param-div-"+this.headingFields[c]).hide();return a},h.prototype.fields={enum:{"number-format":function(a){var b=g.a.MacroBrowser.ParameterFields["enum"](a);return g.a.$(b.input[0]).on("change",function(){for(var a=1;6>=a;a++)"custom"===this.value?g.a.$("#macro-param-div-h"+a).show():g.a.$("#macro-param-div-h"+a).hide()}),b}}},"function"==typeof g.a.MacroBrowser.setMacroJsOverride?g.a.MacroBrowser.setMacroJsOverride("numberedheadings",new h):g.a.MacroBrowser.Macros={numberedheadings:new h}},140:function(a){a.exports=void 0}},[[139,10,0]]]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'nl.avisi.confluence.plugins.numberedheadings:entrypoint-nh-macro-browser-plugin', location = 'bundled.runtime~nh-macro-browser-plugin.b1f5e0ea85005dc029a1.js' */
(function(a){function b(b){for(var d,e,h=b[0],j=b[1],k=b[2],l=0,m=[];l<h.length;l++)e=h[l],f[e]&&m.push(f[e][0]),f[e]=0;for(d in j)Object.prototype.hasOwnProperty.call(j,d)&&(a[d]=j[d]);for(i&&i(b);m.length;)m.shift()();return g.push.apply(g,k||[]),c()}function c(){for(var a,b=0;b<g.length;b++){for(var c,e=g[b],h=!0,i=1;i<e.length;i++)c=e[i],0!==f[c]&&(h=!1);h&&(g.splice(b--,1),a=d(d.s=e[0]))}return a}function d(b){if(e[b])return e[b].exports;var c=e[b]={i:b,l:!1,exports:{}};return a[b].call(c.exports,c,c.exports,d),c.l=!0,c.exports}var e={},f={10:0},g=[];d.m=a,d.c=e,d.d=function(a,b,c){d.o(a,b)||Object.defineProperty(a,b,{enumerable:!0,get:c})},d.r=function(a){'undefined'!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:'Module'}),Object.defineProperty(a,'__esModule',{value:!0})},d.t=function(a,b){if(1&b&&(a=d(a)),8&b)return a;if(4&b&&'object'==typeof a&&a&&a.__esModule)return a;var c=Object.create(null);if(d.r(c),Object.defineProperty(c,'default',{enumerable:!0,value:a}),2&b&&'string'!=typeof a)for(var e in a)d.d(c,e,function(b){return a[b]}.bind(null,e));return c},d.n=function(a){var b=a&&a.__esModule?function(){return a['default']}:function(){return a};return d.d(b,'a',b),b},d.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},d.p='','undefined'!=typeof AJS&&(d.p=AJS.contextPath()+'/s/2585692b-d6e2-436b-ba22-c8f4b00be189/_/download/resources/nl.avisi.confluence.plugins.numberedheadings:assets-2585692b-d6e2-436b-ba22-c8f4b00be189/');var h=window.atlassianWebpackJsonp981e0f4effab173567f2d6cf31d7b23b=window.atlassianWebpackJsonp981e0f4effab173567f2d6cf31d7b23b||[],j=h.push.bind(h);h.push=b,h=h.slice();for(var k=0;k<h.length;k++)b(h[k]);var i=j;c()})([]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.ext.newcode-macro-plugin:code-macro-editor', location = '/scripts/code-macro-languages.js' */
/**
 * Provides custom behaviour in the macro browser for the code macro.
 */
(function($) {

    var CodeMacroConfig = function() {};

    CodeMacroConfig.prototype.fields = {
        "string" : {
            "language" : function(param, options) {

                var paramDiv = $(Confluence.Templates.MacroBrowser.macroParameterSelect());
                var input = $("select", paramDiv);

                // we need to do some trickery when the value is first set, and when the value is subsequently changed,
                // so set this up.
                if (options == null)
                    options = {};
                options.setValue = function(value) {

                    var targetOption = input.find("option[value='" + value + "']");
                    if (targetOption.length == 0) {
                        var option = $("<option/>");
                        option.val(value);
                        option.text(value);
                        input.append(option);
                    }
                };

                bindAsyncDropDown(input);
                return new AJS.MacroBrowser.Field(paramDiv, input, options);
            }
        }
    };

    AJS.MacroBrowser.Macros["code"] = new CodeMacroConfig();

    /**
     * Populates an HTML Select element with the list of configured syntax highlighters.
     * @param dropDown JQuery selector for the HTML select element to be populated.
     */
    function bindAsyncDropDown(dropDown) {
        // Load the languages from Confluence
        getLanguagesAsync(function(languages) {
                    if (!languages.length)
                    {
                        AJS.log("Configured code macro languages result was not in the expected format.");
                        return;
                    }

                    var currentValue = dropDown.val();

                    dropDown.empty();
                    dropDown.append($("<option/>").attr("value", ""));

                    $.each(languages, function(index, lang) {
                        var option = $("<option />");
                        option.val(lang.aliases[0]);
                        option.text(lang.friendlyName);

                        dropDown.append(option);
                    });

                    // restore the currently selected value.
                    dropDown.val(currentValue);
                },
                function(xhr, textStatus, errorThrown) {
                    AJS.log("Failed to retrieve syntax highlighters from Confluence " + textStatus + " - " + errorThrown);
                });
    }

    /**
     * Asynchronously retrieves the current set of syntax highlighters currently installed for the Code macro.
     *
     * @param successHandler Callback to invoke if the retrieval is successful
     * @param errorHandler Callback to invoke if the retrieval fails.
     */
    function getLanguagesAsync(successHandler, errorHandler) {
        AJS.$.ajax({
            async: true,
            url: AJS.contextPath() + "/plugins/newcode/getlanguages.action",
            dataType: "json",
            timeout: 10000, // 10 seconds,
            error: function(xhr, textStatus, errorThrown) {
                if (errorHandler && typeof(errorHandler) == "function") {
                    errorHandler(xhr, textStatus, errorThrown);
                }
            },
            success: function(data) {
                if (successHandler && typeof(successHandler) == "function") {
                    successHandler(data);
                }
            }
        });
    }
})(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'de.griffel.confluence.plugins.plant-uml:macro-browser-fields', location = 'js/macro.js' */
AJS.MacroBrowser.activateSmartFieldsAttachmentsOnPage("svg",["svg","svgz"]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.seuqra.confluence.pivot-table:pivot-macro-browser-resources', location = 'js/pivot-macro-browser.js' */
(function(e){var a=[];var d=function(){};d.prototype.getMacroDetailsFromSelectedMacro=function(g,h){e("body").append("<table id='inputTable'>");e("#inputTable").html(h.body);var f=e("#inputTable").tableToJSON();if(f[0]){a=Object.keys(f[0])}a.sort()};d.prototype.beforeParamsSet=function(f){b(f,"columnNameForValues",a,false,true);b(f,"columnNameForRows",a,false,true);b(f,"columnNameForColumns",a,false,true);c(f);return f};function c(g){var f=JSON.parse(JSON.stringify(g));e.ajax({type:"GET",url:AJS.contextPath()+"/rest/pivot/1.0/usermacros/pivot-values-rendering",contentType:"application/json",async:false}).done(function(l){var j=l.parameters;for(var h=0;h<j.length;++h){var m=j[h];if(m.name==="typeOfRendering"){var k=m.enumValues;b(f,"typeOfCalculation",k,true,false);break}}}).fail(function(){})}function b(f,s,r,n,l){var q,o,p;var h=r.length;if(f[s]){q=e.trim(f[s])}else{if(n){if(r.length>0){q=r[0]}else{q="-"}}}p="macro-param-"+s;o=e("#"+p);if(r.length===0){if(!e(o).is("select")){if(q){o.attr("value",q)}}else{o.replaceWith('<input type="text" class="text macro-param-input" id="'+p+'" value="'+q+'">')}return}else{if(!e(o).is("select")){o.replaceWith('<select class="select macro-param-input" id="'+p+'">');o=e("#"+p)}}if(!n){o.append(e("<option></option>").text(""))}var m=false;var k=false;for(var j=0;j<h;j++){k=false;if(q==r[j]){k=true;m=true}var g=k?'selected="selected"':"";o.append(e('<option value="'+r[j]+'" '+g+"></option>").text(r[j]))}if(l&&q&&!m){o.append(e('<option selected="selected"></option>').text(q))}}AJS.MacroBrowser.setMacroJsOverride("pivot-table",new d())})(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.seuqra.confluence.pivot-table:pivot-macro-browser-resources', location = 'js/jquery.tabletojson.min.js' */
/*! tabletojson - v0.11.1 - Daniel White */
!function(a){"use strict";a.fn.tableToJSON=function(b){var c={ignoreColumns:[],onlyColumns:null,ignoreHiddenRows:!0,ignoreEmptyRows:!1,headings:null,allowHTML:!1,includeRowId:!1,textDataOverride:"data-override",textExtractor:null};b=a.extend(c,b);var d=function(a){return void 0!==a&&null!==a},e=function(c){return d(b.onlyColumns)?-1===a.inArray(c,b.onlyColumns):-1!==a.inArray(c,b.ignoreColumns)},f=function(b,c){var e={},f=0;return a.each(c,function(a,c){f<b.length&&d(c)&&(e[b[f]]=c,f++)}),e},g=function(c,d,e){var f=a(d),g=b.textExtractor,h=f.attr(b.textDataOverride);return null===g||e?a.trim(h||(b.allowHTML?f.html():d.textContent||f.text())||""):a.isFunction(g)?a.trim(h||g(c,f)):"object"==typeof g&&a.isFunction(g[c])?a.trim(h||g[c](c,f)):a.trim(h||(b.allowHTML?f.html():d.textContent||f.text())||"")},h=function(c,d){var e=[],f=b.includeRowId,h="boolean"==typeof f?f:"string"==typeof f?!0:!1,i="string"==typeof f==!0?f:"rowId";return h&&"undefined"==typeof a(c).attr("id")&&e.push(i),a(c).children("td,th").each(function(a,b){e.push(g(a,b,d))}),e},i=function(a){var c=a.find("tr:first").first();return d(b.headings)?b.headings:h(c,!0)},j=function(c,h){var i,j,k,l,m,n,o,p=[],q=0,r=[];return c.children("tbody,*").children("tr").each(function(c,e){if(c>0||d(b.headings)){var f=b.includeRowId,h="boolean"==typeof f?f:"string"==typeof f?!0:!1;n=a(e);var r=n.find("td").length===n.find("td:empty").length?!0:!1;!n.is(":visible")&&b.ignoreHiddenRows||r&&b.ignoreEmptyRows||n.data("ignore")&&"false"!==n.data("ignore")||(q=0,p[c]||(p[c]=[]),h&&(q+=1,"undefined"!=typeof n.attr("id")?p[c].push(n.attr("id")):p[c].push("")),n.children().each(function(){for(o=a(this);p[c][q];)q++;if(o.filter("[rowspan]").length)for(k=parseInt(o.attr("rowspan"),10)-1,m=g(q,o),i=1;k>=i;i++)p[c+i]||(p[c+i]=[]),p[c+i][q]=m;if(o.filter("[colspan]").length)for(k=parseInt(o.attr("colspan"),10)-1,m=g(q,o),i=1;k>=i;i++)if(o.filter("[rowspan]").length)for(l=parseInt(o.attr("rowspan"),10),j=0;l>j;j++)p[c+j][q+i]=m;else p[c][q+i]=m;m=p[c][q]||g(q,o),d(m)&&(p[c][q]=m),q++}))}}),a.each(p,function(c,g){if(d(g)){var i=d(b.onlyColumns)||b.ignoreColumns.length?a.grep(g,function(a,b){return!e(b)}):g,j=d(b.headings)?h:a.grep(h,function(a,b){return!e(b)});m=f(j,i),r[r.length]=m}}),r},k=i(this);return j(this,k)}}(jQuery);
}catch(e){WRMCB(e)};